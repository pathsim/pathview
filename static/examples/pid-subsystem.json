{
  "version": "1.0.0",
  "metadata": {
    "created": "2025-12-22T23:03:32.436Z",
    "modified": "2025-12-22T23:03:32.436Z",
    "name": "PID Subsystem",
    "description": "PID control with plant as subsystem"
  },
  "graph": {
    "nodes": [
      {
        "id": "setpoint",
        "type": "StepSource",
        "name": "Setpoint",
        "position": {
          "x": 660,
          "y": 450
        },
        "inputs": [],
        "outputs": [
          {
            "id": "setpoint-output-0",
            "nodeId": "setpoint",
            "name": "out 0",
            "direction": "output",
            "index": 0
          }
        ],
        "params": {
          "amplitude": "[1, 0.5]",
          "t_step": 1,
          "tau": "[20+tau_1, 40+tau_2]",
          "_rotation": 3
        }
      },
      {
        "id": "error",
        "type": "Adder",
        "name": "Error",
        "position": {
          "x": 795,
          "y": 300
        },
        "inputs": [
          {
            "id": "error-input-0",
            "nodeId": "error",
            "name": "in 0",
            "direction": "input",
            "index": 0
          },
          {
            "id": "error-input-1",
            "nodeId": "error",
            "name": "in 1",
            "direction": "input",
            "index": 1
          }
        ],
        "outputs": [
          {
            "id": "error-output-0",
            "nodeId": "error",
            "name": "out 0",
            "direction": "output",
            "index": 0
          }
        ],
        "params": {
          "operations": "\"+-\"",
          "_rotation": 0
        }
      },
      {
        "id": "pid",
        "type": "PID",
        "name": "PID",
        "position": {
          "x": 990,
          "y": 300
        },
        "inputs": [
          {
            "id": "pid-input-0",
            "nodeId": "pid",
            "name": "in 0",
            "direction": "input",
            "index": 0
          }
        ],
        "outputs": [
          {
            "id": "pid-output-0",
            "nodeId": "pid",
            "name": "out 0",
            "direction": "output",
            "index": 0
          }
        ],
        "params": {
          "Kp": "1.5",
          "Ki": "0.5",
          "Kd": "0.1",
          "f_max": "10"
        }
      },
      {
        "id": "scope",
        "type": "Scope",
        "name": "Setpoint vs Plant",
        "position": {
          "x": 855,
          "y": 450
        },
        "inputs": [
          {
            "id": "scope-input-0",
            "nodeId": "scope",
            "name": "setpoint",
            "direction": "input",
            "index": 0
          },
          {
            "id": "scope-input-1",
            "nodeId": "scope",
            "name": "in 1",
            "direction": "input",
            "index": 1,
            "color": "#969696"
          }
        ],
        "outputs": [],
        "params": {
          "sampling_rate": null,
          "_rotation": 1
        }
      },
      {
        "id": "98bd8eae-5636-43fa-bdd8-0eace540da0b",
        "type": "Scope",
        "name": "Error",
        "position": {
          "x": 885,
          "y": 240
        },
        "inputs": [
          {
            "id": "98bd8eae-5636-43fa-bdd8-0eace540da0b-input-0",
            "nodeId": "98bd8eae-5636-43fa-bdd8-0eace540da0b",
            "name": "setpoint",
            "direction": "input",
            "index": 0
          }
        ],
        "outputs": [],
        "params": {
          "sampling_rate": null,
          "_rotation": 3
        }
      },
      {
        "id": "367985a4-df42-46b1-97af-94302aaf3234",
        "type": "Subsystem",
        "name": "Plant",
        "position": {
          "x": 990,
          "y": 375
        },
        "inputs": [
          {
            "id": "367985a4-df42-46b1-97af-94302aaf3234-input-0",
            "nodeId": "367985a4-df42-46b1-97af-94302aaf3234",
            "name": "in 0",
            "direction": "input",
            "index": 0,
            "color": "#969696"
          }
        ],
        "outputs": [
          {
            "id": "367985a4-df42-46b1-97af-94302aaf3234-output-0",
            "nodeId": "367985a4-df42-46b1-97af-94302aaf3234",
            "name": "out 0",
            "direction": "output",
            "index": 0,
            "color": "#969696"
          }
        ],
        "params": {
          "_rotation": 2
        },
        "graph": {
          "nodes": [
            {
              "id": "160f6744-e691-44b9-aac4-49c0a65f76e1",
              "type": "Interface",
              "name": "Subsystem",
              "position": {
                "x": 165,
                "y": -15
              },
              "inputs": [],
              "outputs": [],
              "params": {}
            },
            {
              "id": "3a36165c-154d-4dc2-9744-e20fa06c99b6",
              "type": "Integrator",
              "name": "Quantity",
              "position": {
                "x": 240,
                "y": 150
              },
              "inputs": [
                {
                  "id": "3a36165c-154d-4dc2-9744-e20fa06c99b6-input-0",
                  "nodeId": "3a36165c-154d-4dc2-9744-e20fa06c99b6",
                  "name": "in 0",
                  "direction": "input",
                  "index": 0,
                  "color": "#969696"
                }
              ],
              "outputs": [
                {
                  "id": "3a36165c-154d-4dc2-9744-e20fa06c99b6-output-0",
                  "nodeId": "3a36165c-154d-4dc2-9744-e20fa06c99b6",
                  "name": "out 0",
                  "direction": "output",
                  "index": 0,
                  "color": "#969696"
                }
              ],
              "params": {
                "initial_value": "0.0",
                "_rotation": 1
              }
            },
            {
              "id": "5b62efdd-3988-462c-a240-7c45e938d15c",
              "type": "Amplifier",
              "name": "Gain",
              "position": {
                "x": 240,
                "y": 270
              },
              "inputs": [
                {
                  "id": "5b62efdd-3988-462c-a240-7c45e938d15c-input-0",
                  "nodeId": "5b62efdd-3988-462c-a240-7c45e938d15c",
                  "name": "in 0",
                  "direction": "input",
                  "index": 0,
                  "color": "#969696"
                }
              ],
              "outputs": [
                {
                  "id": "5b62efdd-3988-462c-a240-7c45e938d15c-output-0",
                  "nodeId": "5b62efdd-3988-462c-a240-7c45e938d15c",
                  "name": "out 0",
                  "direction": "output",
                  "index": 0,
                  "color": "#969696"
                }
              ],
              "params": {
                "gain": "g_rng",
                "_rotation": 1
              }
            },
            {
              "id": "ec16ee5e-e904-47d0-b322-7098b2808e9e",
              "type": "Scope",
              "name": "Plant Quantity",
              "position": {
                "x": 345,
                "y": 210
              },
              "inputs": [
                {
                  "id": "ec16ee5e-e904-47d0-b322-7098b2808e9e-input-0",
                  "nodeId": "ec16ee5e-e904-47d0-b322-7098b2808e9e",
                  "name": "in 0",
                  "direction": "input",
                  "index": 0,
                  "color": "#969696"
                }
              ],
              "outputs": [],
              "params": {
                "sampling_rate": null,
                "t_wait": "0.0",
                "labels": null,
                "_rotation": 0
              }
            },
            {
              "id": "b77166e8-665a-4dca-8081-6947e445d0ba",
              "type": "Tanh",
              "name": "Saturation",
              "position": {
                "x": 240,
                "y": 60
              },
              "inputs": [
                {
                  "id": "b77166e8-665a-4dca-8081-6947e445d0ba-input-0",
                  "nodeId": "b77166e8-665a-4dca-8081-6947e445d0ba",
                  "name": "in 0",
                  "direction": "input",
                  "index": 0,
                  "color": "#969696"
                }
              ],
              "outputs": [
                {
                  "id": "b77166e8-665a-4dca-8081-6947e445d0ba-output-0",
                  "nodeId": "b77166e8-665a-4dca-8081-6947e445d0ba",
                  "name": "out 0",
                  "direction": "output",
                  "index": 0,
                  "color": "#969696"
                }
              ],
              "params": {
                "_rotation": 1
              }
            }
          ],
          "connections": [
            {
              "id": "4c86a8d3-a6d7-49ac-b24b-5488cb89dd1e",
              "sourceNodeId": "3a36165c-154d-4dc2-9744-e20fa06c99b6",
              "sourcePortIndex": 0,
              "targetNodeId": "ec16ee5e-e904-47d0-b322-7098b2808e9e",
              "targetPortIndex": 0
            },
            {
              "id": "98694a13-71df-491b-aee9-77c6c75a8bb2",
              "sourceNodeId": "3a36165c-154d-4dc2-9744-e20fa06c99b6",
              "sourcePortIndex": 0,
              "targetNodeId": "5b62efdd-3988-462c-a240-7c45e938d15c",
              "targetPortIndex": 0
            },
            {
              "id": "223ff17e-05f3-467b-816c-121896812807",
              "sourceNodeId": "b77166e8-665a-4dca-8081-6947e445d0ba",
              "sourcePortIndex": 0,
              "targetNodeId": "3a36165c-154d-4dc2-9744-e20fa06c99b6",
              "targetPortIndex": 0
            },
            {
              "id": "55d2ccca-0e0a-4360-9be0-4f43638c0f68",
              "sourceNodeId": "160f6744-e691-44b9-aac4-49c0a65f76e1",
              "sourcePortIndex": 0,
              "targetNodeId": "b77166e8-665a-4dca-8081-6947e445d0ba",
              "targetPortIndex": 0
            },
            {
              "id": "976f3788-0d0f-4133-a8b3-ee43000d5b61",
              "sourceNodeId": "5b62efdd-3988-462c-a240-7c45e938d15c",
              "sourcePortIndex": 0,
              "targetNodeId": "160f6744-e691-44b9-aac4-49c0a65f76e1",
              "targetPortIndex": 0
            }
          ]
        }
      },
      {
        "id": "4674b251-a882-45b9-baf1-01db4d0f7a22",
        "type": "Scope",
        "name": "Control Signal",
        "position": {
          "x": 1125,
          "y": 240
        },
        "inputs": [
          {
            "id": "4674b251-a882-45b9-baf1-01db4d0f7a22-input-0",
            "nodeId": "4674b251-a882-45b9-baf1-01db4d0f7a22",
            "name": "setpoint",
            "direction": "input",
            "index": 0
          }
        ],
        "outputs": [],
        "params": {
          "sampling_rate": null,
          "_rotation": 3
        }
      }
    ],
    "connections": [
      {
        "id": "c1",
        "sourceNodeId": "setpoint",
        "sourcePortIndex": 0,
        "targetNodeId": "error",
        "targetPortIndex": 0
      },
      {
        "id": "c5",
        "sourceNodeId": "error",
        "sourcePortIndex": 0,
        "targetNodeId": "pid",
        "targetPortIndex": 0
      },
      {
        "id": "ec0a2ed4-9d00-4c64-abc0-3126ecee69c8",
        "sourceNodeId": "error",
        "sourcePortIndex": 0,
        "targetNodeId": "98bd8eae-5636-43fa-bdd8-0eace540da0b",
        "targetPortIndex": 0
      },
      {
        "id": "d4dbaa0f-2b25-4612-b1e9-7173e1c2e7a4",
        "sourceNodeId": "pid",
        "sourcePortIndex": 0,
        "targetNodeId": "367985a4-df42-46b1-97af-94302aaf3234",
        "targetPortIndex": 0
      },
      {
        "id": "fb1602fb-661a-49d5-ad24-c95bdea2f328",
        "sourceNodeId": "367985a4-df42-46b1-97af-94302aaf3234",
        "sourcePortIndex": 0,
        "targetNodeId": "error",
        "targetPortIndex": 1
      },
      {
        "id": "73846b60-c98b-4933-9a79-02b17b439af7",
        "sourceNodeId": "setpoint",
        "sourcePortIndex": 0,
        "targetNodeId": "scope",
        "targetPortIndex": 0
      },
      {
        "id": "b82afa70-4a3e-4b10-8adb-4c162bcafce8",
        "sourceNodeId": "367985a4-df42-46b1-97af-94302aaf3234",
        "sourcePortIndex": 0,
        "targetNodeId": "scope",
        "targetPortIndex": 1
      },
      {
        "id": "bf75489a-0404-41ac-b709-bc0579e2a217",
        "sourceNodeId": "pid",
        "sourcePortIndex": 0,
        "targetNodeId": "4674b251-a882-45b9-baf1-01db4d0f7a22",
        "targetPortIndex": 0
      }
    ]
  },
  "events": [],
  "codeContext": {
    "code": "# randomized feedback gaing\ng_rng = 0.4 + 0.3*np.random.rand()\n\n# randomized step delay\ntau_1, tau_2 = 5*np.random.rand(2)"
  },
  "simulationSettings": {
    "duration": "60",
    "dt": "0.1",
    "solver": "SSPRK22",
    "adaptive": true,
    "atol": "1e-8",
    "rtol": "1e-5",
    "ftol": "1e-9",
    "dt_min": "",
    "dt_max": "",
    "ghostTraces": 6,
    "plotResults": true
  }
}
