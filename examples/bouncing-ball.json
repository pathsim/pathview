{
  "version": "1.0.0",
  "metadata": {
    "created": "2026-01-19T16:03:09.415Z",
    "modified": "2026-01-19T16:03:09.415Z",
    "name": "bouncing-ball"
  },
  "graph": {
    "nodes": [
      {
        "id": "1642f372-0929-4a73-a786-11a5a9b2ce0b",
        "type": "Integrator",
        "name": "pos",
        "position": {
          "x": 750,
          "y": 250
        },
        "inputs": [
          {
            "id": "1642f372-0929-4a73-a786-11a5a9b2ce0b-input-0",
            "nodeId": "1642f372-0929-4a73-a786-11a5a9b2ce0b",
            "name": "in 0",
            "direction": "input",
            "index": 0,
            "color": "#969696"
          }
        ],
        "outputs": [
          {
            "id": "1642f372-0929-4a73-a786-11a5a9b2ce0b-output-0",
            "nodeId": "1642f372-0929-4a73-a786-11a5a9b2ce0b",
            "name": "out 0",
            "direction": "output",
            "index": 0,
            "color": "#969696"
          }
        ],
        "params": {
          "initial_value": "x0 "
        }
      },
      {
        "id": "d6b8ebf1-173b-4f71-a160-d86545a80cb9",
        "type": "Integrator",
        "name": "vel",
        "position": {
          "x": 530,
          "y": 250
        },
        "inputs": [
          {
            "id": "d6b8ebf1-173b-4f71-a160-d86545a80cb9-input-0",
            "nodeId": "d6b8ebf1-173b-4f71-a160-d86545a80cb9",
            "name": "in 0",
            "direction": "input",
            "index": 0,
            "color": "#969696"
          }
        ],
        "outputs": [
          {
            "id": "d6b8ebf1-173b-4f71-a160-d86545a80cb9-output-0",
            "nodeId": "d6b8ebf1-173b-4f71-a160-d86545a80cb9",
            "name": "out 0",
            "direction": "output",
            "index": 0,
            "color": "#969696"
          }
        ],
        "params": {}
      },
      {
        "id": "c76c21f3-21cd-453e-9437-8e8af946d1c7",
        "type": "Scope",
        "name": "x(t)",
        "position": {
          "x": 860,
          "y": 340
        },
        "inputs": [
          {
            "id": "c76c21f3-21cd-453e-9437-8e8af946d1c7-input-0",
            "nodeId": "c76c21f3-21cd-453e-9437-8e8af946d1c7",
            "name": "in 0",
            "direction": "input",
            "index": 0,
            "color": "#969696"
          }
        ],
        "outputs": [],
        "params": {
          "_rotation": 1
        }
      },
      {
        "id": "49a2f6d3-5327-485a-8f1b-b98a3d425a57",
        "type": "Constant",
        "name": "gravity",
        "position": {
          "x": 430,
          "y": 160
        },
        "inputs": [],
        "outputs": [
          {
            "id": "49a2f6d3-5327-485a-8f1b-b98a3d425a57-output-0",
            "nodeId": "49a2f6d3-5327-485a-8f1b-b98a3d425a57",
            "name": "out 0",
            "direction": "output",
            "index": 0,
            "color": "#969696"
          }
        ],
        "params": {
          "value": "-g",
          "_rotation": 1
        }
      },
      {
        "id": "d73713d6-eb61-442e-a69b-c4d168180ef4",
        "type": "Scope",
        "name": "v(t)",
        "position": {
          "x": 620,
          "y": 340
        },
        "inputs": [
          {
            "id": "d73713d6-eb61-442e-a69b-c4d168180ef4-input-0",
            "nodeId": "d73713d6-eb61-442e-a69b-c4d168180ef4",
            "name": "in 0",
            "direction": "input",
            "index": 0,
            "color": "#969696"
          }
        ],
        "outputs": [],
        "params": {
          "_rotation": 1
        }
      },
      {
        "id": "db488fa8-9004-40f7-a724-bc9846dd2f85",
        "type": "Function",
        "name": "total energy",
        "position": {
          "x": 750,
          "y": 160
        },
        "inputs": [
          {
            "id": "db488fa8-9004-40f7-a724-bc9846dd2f85-input-0",
            "nodeId": "db488fa8-9004-40f7-a724-bc9846dd2f85",
            "name": "in 0",
            "direction": "input",
            "index": 0,
            "color": "#969696"
          },
          {
            "id": "db488fa8-9004-40f7-a724-bc9846dd2f85-input-1",
            "nodeId": "db488fa8-9004-40f7-a724-bc9846dd2f85",
            "name": "in 1",
            "direction": "input",
            "index": 1,
            "color": "#969696"
          }
        ],
        "outputs": [
          {
            "id": "db488fa8-9004-40f7-a724-bc9846dd2f85-output-0",
            "nodeId": "db488fa8-9004-40f7-a724-bc9846dd2f85",
            "name": "out 0",
            "direction": "output",
            "index": 0,
            "color": "#969696"
          }
        ],
        "params": {
          "func": "lambda v, x: m*(v**2/2 + g*x)",
          "_rotation": 0
        }
      },
      {
        "id": "78f720fe-8774-42c3-be6b-5a4ef30e00df",
        "type": "Scope",
        "name": "E(t)",
        "position": {
          "x": 1100,
          "y": 340
        },
        "inputs": [
          {
            "id": "78f720fe-8774-42c3-be6b-5a4ef30e00df-input-0",
            "nodeId": "78f720fe-8774-42c3-be6b-5a4ef30e00df",
            "name": "in 0",
            "direction": "input",
            "index": 0,
            "color": "#969696"
          }
        ],
        "outputs": [],
        "params": {
          "_rotation": 1
        }
      }
    ],
    "connections": [
      {
        "id": "0d6afb9a-6b40-4876-8f3d-7581eada74b2",
        "sourceNodeId": "49a2f6d3-5327-485a-8f1b-b98a3d425a57",
        "sourcePortIndex": 0,
        "targetNodeId": "d6b8ebf1-173b-4f71-a160-d86545a80cb9",
        "targetPortIndex": 0
      },
      {
        "id": "c7eb09ad-9d1e-474b-8b7b-c80d397bc6dd",
        "sourceNodeId": "d6b8ebf1-173b-4f71-a160-d86545a80cb9",
        "sourcePortIndex": 0,
        "targetNodeId": "1642f372-0929-4a73-a786-11a5a9b2ce0b",
        "targetPortIndex": 0
      },
      {
        "id": "3c8a8e3c-794f-4c56-a6f8-334e03104190",
        "sourceNodeId": "1642f372-0929-4a73-a786-11a5a9b2ce0b",
        "sourcePortIndex": 0,
        "targetNodeId": "c76c21f3-21cd-453e-9437-8e8af946d1c7",
        "targetPortIndex": 0
      },
      {
        "id": "a789aac8-e368-4894-b2a9-0637d7bef482",
        "sourceNodeId": "d6b8ebf1-173b-4f71-a160-d86545a80cb9",
        "sourcePortIndex": 0,
        "targetNodeId": "d73713d6-eb61-442e-a69b-c4d168180ef4",
        "targetPortIndex": 0
      },
      {
        "id": "0a585f0c-93fb-4fb2-ade0-0843d5ad15a4",
        "sourceNodeId": "d6b8ebf1-173b-4f71-a160-d86545a80cb9",
        "sourcePortIndex": 0,
        "targetNodeId": "db488fa8-9004-40f7-a724-bc9846dd2f85",
        "targetPortIndex": 0
      },
      {
        "id": "b7bb9b2f-06ea-4bfa-a739-1ded869eeef6",
        "sourceNodeId": "1642f372-0929-4a73-a786-11a5a9b2ce0b",
        "sourcePortIndex": 0,
        "targetNodeId": "db488fa8-9004-40f7-a724-bc9846dd2f85",
        "targetPortIndex": 1
      },
      {
        "id": "e2c930e9-e3a1-46bb-8ac9-0061b4530440",
        "sourceNodeId": "db488fa8-9004-40f7-a724-bc9846dd2f85",
        "sourcePortIndex": 0,
        "targetNodeId": "78f720fe-8774-42c3-be6b-5a4ef30e00df",
        "targetPortIndex": 0
      }
    ],
    "annotations": [
      {
        "id": "deeecd86-71ac-4a13-a289-c64c946e667c",
        "position": {
          "x": -50,
          "y": 60
        },
        "content": "# Bouncing Ball Physics\n\nThis is an example of a hybrid system with continuous dynamics (free falling ball) and discrete events (bounces).\n\nIntegrating the gravitational acceleration gives the ball velocity in free fall:\n\n$$ v(t) = - \\int_0^t g \\, d\\tau $$\n\nAnd the position is the integrated velocity:\n\n$$ x(t) = \\int_0^t v(\\tau) \\, d\\tau $$\n\nWe use an event node to define the discrete dynamics of the ball hitting the ground. Whenever the position crosses zero\n\n$$ |x(t)| = 0 $$\n\nthe sign of the velocity is flipped and a coefficient of restitution ($b$) is applied to model the energy loss from the deformation of the ball:\n\n$$ y(t) \\leftarrow -b \\, y(t)  $$\n\nWhen the total energy drops below a certain threshold we consider that a Zeno state and stop the simulation.",
        "width": 425,
        "height": 370
      }
    ]
  },
  "events": [
    {
      "id": "1455e789-9e7d-4139-8a4e-896feecff3d3",
      "type": "pathsim.events.ZeroCrossing",
      "name": "Bounce",
      "position": {
        "x": 980,
        "y": 260
      },
      "params": {
        "func_evt": "bounce_detect",
        "func_act": "bounce_resolve"
      }
    },
    {
      "id": "eda13d11-f264-4861-ba54-e17c48884905",
      "type": "pathsim.events.Condition",
      "name": "Zeno",
      "position": {
        "x": 1200,
        "y": 260
      },
      "params": {
        "func_evt": "zeno_detect",
        "func_act": "zeno_resolve"
      }
    }
  ],
  "codeContext": {
    "code": "# initial position \nx0 = 1\n\n# mass\nm = 1\n\n# gravity\ng = 9.81\n\n# bounce back coefficient (randomized)\nb = 0.85 + 0.1*np.random.rand()\n\n# zeno energy threshold\ne_th = 0.5\n\n# event detection function\ndef bounce_detect(t):\n    return pos.engine.state\n\n# event resolution function\ndef bounce_resolve(t):\n    pos.engine.set(-pos.engine.state)\n    vel.engine.set(-b*vel.engine.state)\n\n# zeno state detection\ndef zeno_detect(t):\n    e = total_energy.outputs[0]\n    return e < e_th\n\n# stop simulation \ndef zeno_resolve(t):\n    sim.stop()\n"
  },
  "simulationSettings": {
    "duration": "50",
    "dt": "",
    "solver": "RKBS32",
    "adaptive": true,
    "atol": "",
    "rtol": "",
    "ftol": "",
    "dt_min": "",
    "dt_max": "0.05",
    "ghostTraces": 8,
    "plotResults": true
  }
}