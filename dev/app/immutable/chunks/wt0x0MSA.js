const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["./BaLj8HaF.js","./BJrbMhgq.js","./zngUhAbX.js","./bH9uCY5d.js","./DSDy7V6L.js","./D6bpRoeh.js","./AwXmWqiV.js","./-suHlTGB.js"])))=>i.map(i=>d[i]);
import{b as Y0,d as r3,f as Me,a as j,e as rt,t as vb,c as $e}from"./Dh0e_9WD.js";import{a as Ei,o as ju,w as ln,g as Je,d as Ta}from"./DaVItsBB.js";import{aJ as g1,aK as yb,aL as s3,h as Fi,M as _h,aM as a3,b as m1,O as gu,H as fu,a as nh,n as h,aA as o3,au as l3,a2 as c3,ab as K0,an as Sc,f as bc,a1 as v1,as as u3,a9 as Z0,c as ou,e as Ld,s as d3,aN as bb,aq as y1,Z as J0,U as f3,aO as h3,aP as p3,aQ as g3,aR as Qo,r as wb,p as xb,aS as cg,a0 as b1,al as Sh,aT as m3,ap as v3,d as kh,x as _e,K as _b,aU as y3,at as b3,am as w3,E as x3,aV as _3,L as S3,av as Hu,aW as k3,ai as Sb,aG as A3,C as ta,j as ia,aX as N3,_ as kb,o as C3,D as P3,aY as Ab,aZ as E3,a_ as I3,ah as L3,a$ as M3,b0 as T3,b1 as D3,b2 as O3,b3 as F3,b4 as R3,b5 as B3,b6 as z3,b7 as q3,W as Nb,b8 as j3,b9 as Cb,ba as H3,bb as w1,v as Tt,u as Pb,y as Dt,z as se,A as Q,X as ne,bc as Rc,w as Ue,B as be,aa as Ri,bd as Eb,i as mn,V as Oe,P as J,be as ns,bf as ii,bg as U3,aB as Rn,bh as W3,bi as V3}from"./Dz8CYQ9q.js";import{a as G3,i as X3,c as Y3,d as Kn,n as K3,b as Z3,s as Wt,e as J3,o as km,f as yn,r as Q3}from"./DCnzmz8z.js";import{p as ct,r as Bc,i as ke,b as ji,c as x1,s as Ah,_ as hs,a as $3,d as ug}from"./DpeF_9q4.js";import{b as _d}from"./CBnEYkKQ.js";import{B as eS}from"./Caco3cvs.js";import{s as gs}from"./Cp1wa9Lc.js";import{i as tS}from"./DDVJuJtO.js";const nS=[];function Ib(t,e=!1,n=!1){return ih(t,new Map,"",nS,null,n)}function ih(t,e,n,i,r=null,s=!1){if(typeof t=="object"&&t!==null){var a=e.get(t);if(a!==void 0)return a;if(t instanceof Map)return new Map(t);if(t instanceof Set)return new Set(t);if(g1(t)){var o=Array(t.length);e.set(t,o),r!==null&&e.set(r,o);for(var l=0;l<t.length;l+=1){var c=t[l];l in t&&(o[l]=ih(c,e,n,i,null,s))}return o}if(yb(t)===s3){o={},e.set(t,o),r!==null&&e.set(r,o);for(var u in t)o[u]=ih(t[u],e,n,i,null,s);return o}if(t instanceof Date)return structuredClone(t);if(typeof t.toJSON=="function"&&!s)return ih(t.toJSON(),e,n,i,t)}if(t instanceof EventTarget)return t;try{return structuredClone(t)}catch{return t}}function Q0(t,e,n){Fi&&_h();var i=new eS(t),r=!a3();m1(()=>{var s=e();r&&s!==null&&typeof s=="object"&&(s={}),i.ensure(s,n)})}function Nn(t,e){return e}function iS(t,e,n){for(var i=[],r=e.length,s,a=e.length,o=0;o<r;o++){let f=e[o];xb(f,()=>{if(s){if(s.pending.delete(f),s.done.add(f),s.pending.size===0){var p=t.outrogroups;Am(y1(s.done)),p.delete(s),p.size===0&&(t.outrogroups=null)}}else a-=1},!1)}if(a===0){var l=i.length===0&&n!==null;if(l){var c=n,u=c.parentNode;v3(u),u.append(c),t.items.clear()}Am(e,!l)}else s={pending:new Set(e),done:new Set},(t.outrogroups??=new Set).add(s)}function Am(t,e=!0){for(var n=0;n<t.length;n++)kh(t[n],e)}var $0;function fn(t,e,n,i,r,s=null){var a=t,o=new Map,l=(e&bb)!==0;if(l){var c=t;a=Fi?gu(fu(c)):c.appendChild(nh())}Fi&&_h();var u=null,f=o3(()=>{var b=n();return g1(b)?b:b==null?[]:y1(b)}),p,d=!0;function y(){w.fallback=u,rS(w,p,a,e,i),u!==null&&(p.length===0?(u.f&Qo)===0?wb(u):(u.f^=Qo,fd(u,null,a)):xb(u,()=>{u=null}))}var m=m1(()=>{p=h(f);var b=p.length;let S=!1;if(Fi){var A=l3(a)===c3;A!==(b===0)&&(a=K0(),gu(a),Sc(!1),S=!0)}for(var _=new Set,I=ou,E=d3(),M=0;M<b;M+=1){Fi&&bc.nodeType===v1&&bc.data===u3&&(a=bc,S=!0,Sc(!1));var T=p[M],D=i(T,M),U=d?null:o.get(D);U?(U.v&&Z0(U.v,T),U.i&&Z0(U.i,M),E&&I.skipped_effects.delete(U.e)):(U=sS(o,d?a:$0??=nh(),T,D,M,r,e,n),d||(U.e.f|=Qo),o.set(D,U)),_.add(D)}if(b===0&&s&&!u&&(d?u=Ld(()=>s(a)):(u=Ld(()=>s($0??=nh())),u.f|=Qo)),Fi&&b>0&&gu(K0()),!d)if(E){for(const[C,N]of o)_.has(C)||I.skipped_effects.add(N.e);I.oncommit(y),I.ondiscard(()=>{})}else y();S&&Sc(!0),h(f)}),w={effect:m,items:o,outrogroups:null,fallback:u};d=!1,Fi&&(a=bc)}function rS(t,e,n,i,r){var s=(i&m3)!==0,a=e.length,o=t.items,l=t.effect.first,c,u=null,f,p=[],d=[],y,m,w,b;if(s)for(b=0;b<a;b+=1)y=e[b],m=r(y,b),w=o.get(m).e,(w.f&Qo)===0&&(w.nodes?.a?.measure(),(f??=new Set).add(w));for(b=0;b<a;b+=1){if(y=e[b],m=r(y,b),w=o.get(m).e,t.outrogroups!==null)for(const U of t.outrogroups)U.pending.delete(w),U.done.delete(w);if((w.f&Qo)!==0)if(w.f^=Qo,w===l)fd(w,null,n);else{var S=u?u.next:l;w===t.effect.last&&(t.effect.last=w.prev),w.prev&&(w.prev.next=w.next),w.next&&(w.next.prev=w.prev),Il(t,u,w),Il(t,w,S),fd(w,S,n),u=w,p=[],d=[],l=u.next;continue}if((w.f&cg)!==0&&(wb(w),s&&(w.nodes?.a?.unfix(),(f??=new Set).delete(w))),w!==l){if(c!==void 0&&c.has(w)){if(p.length<d.length){var A=d[0],_;u=A.prev;var I=p[0],E=p[p.length-1];for(_=0;_<p.length;_+=1)fd(p[_],A,n);for(_=0;_<d.length;_+=1)c.delete(d[_]);Il(t,I.prev,E.next),Il(t,u,I),Il(t,E,A),l=A,u=E,b-=1,p=[],d=[]}else c.delete(w),fd(w,l,n),Il(t,w.prev,w.next),Il(t,w,u===null?t.effect.first:u.next),Il(t,u,w),u=w;continue}for(p=[],d=[];l!==null&&l!==w;)(c??=new Set).add(l),d.push(l),l=l.next;if(l===null)continue}(w.f&Qo)===0&&p.push(w),u=w,l=w.next}if(t.outrogroups!==null){for(const U of t.outrogroups)U.pending.size===0&&(Am(y1(U.done)),t.outrogroups?.delete(U));t.outrogroups.size===0&&(t.outrogroups=null)}if(l!==null||c!==void 0){var M=[];if(c!==void 0)for(w of c)(w.f&cg)===0&&M.push(w);for(;l!==null;)(l.f&cg)===0&&l!==t.fallback&&M.push(l),l=l.next;var T=M.length;if(T>0){var D=(i&bb)!==0&&a===0?n:null;if(s){for(b=0;b<T;b+=1)M[b].nodes?.a?.measure();for(b=0;b<T;b+=1)M[b].nodes?.a?.fix()}iS(t,M,D)}}s&&b1(()=>{if(f!==void 0)for(w of f)w.nodes?.a?.apply()})}function sS(t,e,n,i,r,s,a,o){var l=(a&p3)!==0?(a&g3)===0?f3(n,!1,!1):J0(n):null,c=(a&h3)!==0?J0(r):null;return{v:l,i:c,e:Ld(()=>(s(e,l??n,c??r,o),()=>{t.delete(i)}))}}function fd(t,e,n){if(t.nodes)for(var i=t.nodes.start,r=t.nodes.end,s=e&&(e.f&Qo)===0?e.nodes.start:n;i!==null;){var a=Sh(i);if(s.before(i),i===r)return;i=a}}function Il(t,e,n){e===null?t.effect.first=n:e.next=n,n===null?t.effect.last=e:n.prev=e}function _1(t,e,n=!1,i=!1,r=!1){var s=t,a="";_e(()=>{var o=_b;if(a===(a=e()??"")){Fi&&_h();return}if(o.nodes!==null&&(y3(o.nodes.start,o.nodes.end),o.nodes=null),a!==""){if(Fi){bc.data;for(var l=_h(),c=l;l!==null&&(l.nodeType!==v1||l.data!=="");)c=l,l=Sh(l);if(l===null)throw b3(),w3;Y0(bc,c),s=gu(l);return}var u=a+"";n?u=`<svg>${u}</svg>`:i&&(u=`<math>${u}</math>`);var f=r3(u);if((n||i)&&(f=fu(f)),Y0(fu(f),f.lastChild),n||i)for(;fu(f);)s.before(fu(f));else s.before(f)}})}const aS=()=>performance.now(),Zo={tick:t=>requestAnimationFrame(t),now:()=>aS(),tasks:new Set};function Lb(){const t=Zo.now();Zo.tasks.forEach(e=>{e.c(t)||(Zo.tasks.delete(e),e.f())}),Zo.tasks.size!==0&&Zo.tick(Lb)}function oS(t){let e;return Zo.tasks.size===0&&Zo.tick(Lb),{promise:new Promise(n=>{Zo.tasks.add(e={c:t,f:n})}),abort(){Zo.tasks.delete(e)}}}function Cf(t,e){Sb(()=>{t.dispatchEvent(new CustomEvent(e))})}function lS(t){if(t==="float")return"cssFloat";if(t==="offset")return"cssOffset";if(t.startsWith("--"))return t;const e=t.split("-");return e.length===1?e[0]:e[0]+e.slice(1).map(n=>n[0].toUpperCase()+n.slice(1)).join("")}function ev(t){const e={},n=t.split(";");for(const i of n){const[r,s]=i.split(":");if(!r||s===void 0)break;const a=lS(r.trim());e[a]=s.trim()}return e}const cS=t=>t;function Si(t,e,n,i){var r=(t&k3)!==0,s="both",a,o=e.inert,l=e.style.overflow,c,u;function f(){return Sb(()=>a??=n()(e,i?.()??{},{direction:s}))}var p={is_global:r,in(){e.inert=o,Cf(e,"introstart"),c=Nm(e,f(),u,1,()=>{Cf(e,"introend"),c?.abort(),c=a=void 0,e.style.overflow=l})},out(w){e.inert=!0,Cf(e,"outrostart"),u=Nm(e,f(),c,0,()=>{Cf(e,"outroend"),w?.()})},stop:()=>{c?.abort(),u?.abort()}},d=_b;if((d.nodes.t??=[]).push(p),G3){var y=r;if(!y){for(var m=d.parent;m&&(m.f&x3)!==0;)for(;(m=m.parent)&&(m.f&_3)===0;);y=!m||(m.f&S3)!==0}y&&Hu(()=>{ia(()=>p.in())})}}function Nm(t,e,n,i,r){var s=i===1;if(A3(e)){var a,o=!1;return b1(()=>{if(!o){var w=e({direction:s?"in":"out"});a=Nm(t,w,n,i,r)}}),{abort:()=>{o=!0,a?.abort()},deactivate:()=>a.deactivate(),reset:()=>a.reset(),t:()=>a.t()}}if(n?.deactivate(),!e?.duration)return r(),{abort:ta,deactivate:ta,reset:ta,t:()=>i};const{delay:l=0,css:c,tick:u,easing:f=cS}=e;var p=[];if(s&&n===void 0&&(u&&u(0,1),c)){var d=ev(c(0,1));p.push(d,d)}var y=()=>1-i,m=t.animate(p,{duration:l,fill:"forwards"});return m.onfinish=()=>{m.cancel();var w=n?.t()??1-i;n?.abort();var b=i-w,S=e.duration*Math.abs(b),A=[];if(S>0){var _=!1;if(c)for(var I=Math.ceil(S/16.666666666666668),E=0;E<=I;E+=1){var M=w+b*f(E/I),T=ev(c(M,1-M));A.push(T),_||=T.overflow==="hidden"}_&&(t.style.overflow="hidden"),y=()=>{var D=m.currentTime;return w+b*f(D/S)},u&&oS(()=>{if(m.playState!=="running")return!1;var D=y();return u(D,1-D),!0})}m=t.animate(A,{duration:S,fill:"forwards"}),m.onfinish=()=>{y=()=>i,u?.(i,1-i),r()}},{abort:()=>{m&&(m.cancel(),m.effect=null,m.onfinish=ta)},deactivate:()=>{r=ta},reset:()=>{i===0&&u?.(1,0)},t:()=>y()}}function rp(t,e){let n=null,i=Fi;var r;if(Fi){n=bc;for(var s=fu(document.head);s!==null&&(s.nodeType!==v1||s.data!==t);)s=Sh(s);if(s===null)Sc(!1);else{var a=Sh(s);s.remove(),gu(a)}}Fi||(r=document.head.appendChild(nh()));try{m1(()=>e(r),N3)}finally{i&&(Sc(!0),gu(n))}}function wt(t,e,n){Hu(()=>{var i=ia(()=>e(t,n?.())||{});if(n&&i?.update){var r=!1,s={};kb(()=>{var a=n();C3(a),r&&P3(s,a)&&(s=a,i.update(a))}),r=!0}if(i?.destroy)return()=>i.destroy()})}function uS(t,e){var n=void 0,i;Ab(()=>{n!==(n=e())&&(i&&(kh(i),i=null),n&&(i=Ld(()=>{Hu(()=>n(t))})))})}function Mb(t){var e,n,i="";if(typeof t=="string"||typeof t=="number")i+=t;else if(typeof t=="object")if(Array.isArray(t)){var r=t.length;for(e=0;e<r;e++)t[e]&&(n=Mb(t[e]))&&(i&&(i+=" "),i+=n)}else for(n in t)t[n]&&(i&&(i+=" "),i+=n);return i}function dS(){for(var t,e,n=0,i="",r=arguments.length;n<r;n++)(t=arguments[n])&&(e=Mb(t))&&(i&&(i+=" "),i+=e);return i}function zc(t){return typeof t=="object"?dS(t):t??""}const tv=[...` 	
\r\fÂ \v\uFEFF`];function fS(t,e,n){var i=t==null?"":""+t;if(e&&(i=i?i+" "+e:e),n){for(var r in n)if(n[r])i=i?i+" "+r:r;else if(i.length)for(var s=r.length,a=0;(a=i.indexOf(r,a))>=0;){var o=a+s;(a===0||tv.includes(i[a-1]))&&(o===i.length||tv.includes(i[o]))?i=(a===0?"":i.substring(0,a))+i.substring(o+1):a=o}}return i===""?null:i}function nv(t,e=!1){var n=e?" !important;":";",i="";for(var r in t){var s=t[r];s!=null&&s!==""&&(i+=" "+r+": "+s+n)}return i}function dg(t){return t[0]!=="-"||t[1]!=="-"?t.toLowerCase():t}function hS(t,e){if(e){var n="",i,r;if(Array.isArray(e)?(i=e[0],r=e[1]):i=e,t){t=String(t).replaceAll(/\s*\/\*.*?\*\/\s*/g,"").trim();var s=!1,a=0,o=!1,l=[];i&&l.push(...Object.keys(i).map(dg)),r&&l.push(...Object.keys(r).map(dg));var c=0,u=-1;const m=t.length;for(var f=0;f<m;f++){var p=t[f];if(o?p==="/"&&t[f-1]==="*"&&(o=!1):s?s===p&&(s=!1):p==="/"&&t[f+1]==="*"?o=!0:p==='"'||p==="'"?s=p:p==="("?a++:p===")"&&a--,!o&&s===!1&&a===0){if(p===":"&&u===-1)u=f;else if(p===";"||f===m-1){if(u!==-1){var d=dg(t.substring(c,u).trim());if(!l.includes(d)){p!==";"&&f++;var y=t.substring(c,f).trim();n+=" "+y+";"}}c=f+1,u=-1}}}}return i&&(n+=nv(i)),r&&(n+=nv(r,!0)),n=n.trim(),n===""?null:n}return t==null?null:String(t)}function Xt(t,e,n,i,r,s){var a=t.__className;if(Fi||a!==n||a===void 0){var o=fS(n,i,s);(!Fi||o!==t.getAttribute("class"))&&(o==null?t.removeAttribute("class"):e?t.className=o:t.setAttribute("class",o)),t.__className=n}else if(s&&r!==s)for(var l in s){var c=!!s[l];(r==null||c!==!!r[l])&&t.classList.toggle(l,c)}return s}function fg(t,e={},n,i){for(var r in n){var s=n[r];e[r]!==s&&(n[r]==null?t.style.removeProperty(r):t.style.setProperty(r,s,i))}}function An(t,e,n,i){var r=t.__style;if(Fi||r!==e){var s=hS(e,i);(!Fi||s!==t.getAttribute("style"))&&(s==null?t.removeAttribute("style"):t.style.cssText=s),t.__style=e}else i&&(Array.isArray(i)?(fg(t,n?.[0],i[0]),fg(t,n?.[1],i[1],"important")):fg(t,n,i));return i}function Nh(t,e,n=!1){if(t.multiple){if(e==null)return;if(!g1(e))return E3();for(var i of t.options)i.selected=e.includes(iv(i));return}for(i of t.options){var r=iv(i);if(I3(r,e)){i.selected=!0;return}}(!n||e!==void 0)&&(t.selectedIndex=-1)}function Tb(t){var e=new MutationObserver(()=>{Nh(t,t.__value)});e.observe(t,{childList:!0,subtree:!0,attributes:!0,attributeFilter:["value"]}),L3(()=>{e.disconnect()})}function iv(t){return"__value"in t?t.__value:t.value}const ql=Symbol("class"),Jo=Symbol("style"),Db=Symbol("is custom element"),Ob=Symbol("is html");function Br(t){if(Fi){var e=!1,n=()=>{if(!e){if(e=!0,t.hasAttribute("value")){var i=t.value;fe(t,"value",null),t.value=i}if(t.hasAttribute("checked")){var r=t.checked;fe(t,"checked",null),t.checked=r}}};t.__on_r=n,b1(n),F3()}}function ps(t,e){var n=S1(t);n.value===(n.value=e??void 0)||t.value===e&&(e!==0||t.nodeName!=="PROGRESS")||(t.value=e??"")}function pS(t,e){e?t.hasAttribute("selected")||t.setAttribute("selected",""):t.removeAttribute("selected")}function fe(t,e,n,i){var r=S1(t);Fi&&(r[e]=t.getAttribute(e),e==="src"||e==="srcset"||e==="href"&&t.nodeName==="LINK")||r[e]!==(r[e]=n)&&(e==="loading"&&(t[B3]=n),n==null?t.removeAttribute(e):typeof n!="string"&&Fb(t).includes(e)?t[e]=n:t.setAttribute(e,n))}function gS(t,e,n,i,r=!1,s=!1){if(Fi&&r&&t.tagName==="INPUT"){var a=t,o=a.type==="checkbox"?"defaultChecked":"defaultValue";o in n||Br(a)}var l=S1(t),c=l[Db],u=!l[Ob];let f=Fi&&c;f&&Sc(!1);var p=e||{},d=t.tagName==="OPTION";for(var y in e)y in n||(n[y]=null);n.class?n.class=zc(n.class):(i||n[ql])&&(n.class=null),n[Jo]&&(n.style??=null);var m=Fb(t);for(const E in n){let M=n[E];if(d&&E==="value"&&M==null){t.value=t.__value="",p[E]=M;continue}if(E==="class"){var w=t.namespaceURI==="http://www.w3.org/1999/xhtml";Xt(t,w,M,i,e?.[ql],n[ql]),p[E]=M,p[ql]=n[ql];continue}if(E==="style"){An(t,M,e?.[Jo],n[Jo]),p[E]=M,p[Jo]=n[Jo];continue}var b=p[E];if(!(M===b&&!(M===void 0&&t.hasAttribute(E)))){p[E]=M;var S=E[0]+E[1];if(S!=="$$")if(S==="on"){const T={},D="$$"+E;let U=E.slice(2);var A=Z3(U);if(X3(U)&&(U=U.slice(0,-7),T.capture=!0),!A&&b){if(M!=null)continue;t.removeEventListener(U,p[D],T),p[D]=null}if(M!=null)if(A)t[`__${U}`]=M,Kn([U]);else{let C=function(N){p[E].call(this,N)};p[D]=Y3(U,t,C,T)}else A&&(t[`__${U}`]=void 0)}else if(E==="style")fe(t,E,M);else if(E==="autofocus")D3(t,!!M);else if(!c&&(E==="__value"||E==="value"&&M!=null))t.value=t.__value=M;else if(E==="selected"&&d)pS(t,M);else{var _=E;u||(_=K3(_));var I=_==="defaultValue"||_==="defaultChecked";if(M==null&&!c&&!I)if(l[E]=null,_==="value"||_==="checked"){let T=t;const D=e===void 0;if(_==="value"){let U=T.defaultValue;T.removeAttribute(_),T.defaultValue=U,T.value=T.__value=D?U:null}else{let U=T.defaultChecked;T.removeAttribute(_),T.defaultChecked=U,T.checked=D?U:!1}}else t.removeAttribute(E);else I||m.includes(_)&&(c||typeof M!="string")?(t[_]=M,_ in l&&(l[_]=O3)):typeof M!="function"&&fe(t,_,M)}}}return f&&Sc(!0),p}function Jl(t,e,n=[],i=[],r=[],s,a=!1,o=!1){M3(r,n,i,l=>{var c=void 0,u={},f=t.nodeName==="SELECT",p=!1;if(Ab(()=>{var y=e(...l.map(h)),m=gS(t,c,y,s,a,o);p&&f&&"value"in y&&Nh(t,y.value);for(let b of Object.getOwnPropertySymbols(u))y[b]||kh(u[b]);for(let b of Object.getOwnPropertySymbols(y)){var w=y[b];b.description===T3&&(!c||w!==c[b])&&(u[b]&&kh(u[b]),u[b]=Ld(()=>uS(t,()=>w))),m[b]=w}c=m}),f){var d=t;Hu(()=>{Nh(d,c.value,!0),Tb(d)})}p=!0})}function S1(t){return t.__attributes??={[Db]:t.nodeName.includes("-"),[Ob]:t.namespaceURI===R3}}var rv=new Map;function Fb(t){var e=t.getAttribute("is")||t.nodeName,n=rv.get(e);if(n)return n;rv.set(e,n=[]);for(var i,r=t,s=Element.prototype;s!==r;){i=z3(r);for(var a in i)i[a].set&&n.push(a);r=yb(r)}return n}function Rb(t,e,n=e){var i=new WeakSet;q3(t,"input",async r=>{var s=r?t.defaultValue:t.value;if(s=hg(t)?pg(s):s,n(s),ou!==null&&i.add(ou),await Nb(),s!==(s=e())){var a=t.selectionStart,o=t.selectionEnd,l=t.value.length;if(t.value=s??"",o!==null){var c=t.value.length;a===o&&o===l&&c>l?(t.selectionStart=c,t.selectionEnd=c):(t.selectionStart=a,t.selectionEnd=Math.min(o,c))}}}),(Fi&&t.defaultValue!==t.value||ia(e)==null&&t.value)&&(n(hg(t)?pg(t.value):t.value),ou!==null&&i.add(ou)),kb(()=>{var r=e();if(t===document.activeElement){var s=j3??ou;if(i.has(s))return}hg(t)&&r===pg(t.value)||t.type==="date"&&!r&&!t.value||r!==t.value&&(t.value=r??"")})}function hg(t){var e=t.type;return e==="number"||e==="range"}function pg(t){return t===""?null:+t}class k1{#e=new WeakMap;#t;#n;static entries=new WeakMap;constructor(e){this.#n=e}observe(e,n){var i=this.#e.get(e)||new Set;return i.add(n),this.#e.set(e,i),this.#i().observe(e,this.#n),()=>{var r=this.#e.get(e);r.delete(n),r.size===0&&(this.#e.delete(e),this.#t.unobserve(e))}}#i(){return this.#t??(this.#t=new ResizeObserver(e=>{for(var n of e){k1.entries.set(n.target,n);for(var i of this.#e.get(n.target)||[])i(n)}}))}}var mS=new k1({box:"border-box"});function sv(t,e,n){var i=mS.observe(t,()=>n(t[e]));Hu(()=>(ia(()=>n(t[e])),i))}const vS=t=>t;function A1(t){const e=t-1;return e*e*e+1}function av(t){const e=typeof t=="string"&&t.match(/^\s*(-?[\d.]+)([^\s]*)\s*$/);return e?[parseFloat(e[1]),e[2]||"px"]:[t,"px"]}function dl(t,{delay:e=0,duration:n=400,easing:i=vS}={}){const r=+getComputedStyle(t).opacity;return{delay:e,duration:n,easing:i,css:s=>`opacity: ${s*r}`}}function N1(t,{delay:e=0,duration:n=400,easing:i=A1,x:r=0,y:s=0,opacity:a=0}={}){const o=getComputedStyle(t),l=+o.opacity,c=o.transform==="none"?"":o.transform,u=l*(1-a),[f,p]=av(r),[d,y]=av(s);return{delay:e,duration:n,easing:i,css:(m,w)=>`
			transform: ${c} translate(${(1-m)*f}${p}, ${(1-m)*d}${y});
			opacity: ${l-u*w}`}}function yS(t,{delay:e=0,duration:n=400,easing:i=A1,axis:r="y"}={}){const s=getComputedStyle(t),a=+s.opacity,o=r==="y"?"height":"width",l=parseFloat(s[o]),c=r==="y"?["top","bottom"]:["left","right"],u=c.map(b=>`${b[0].toUpperCase()}${b.slice(1)}`),f=parseFloat(s[`padding${u[0]}`]),p=parseFloat(s[`padding${u[1]}`]),d=parseFloat(s[`margin${u[0]}`]),y=parseFloat(s[`margin${u[1]}`]),m=parseFloat(s[`border${u[0]}Width`]),w=parseFloat(s[`border${u[1]}Width`]);return{delay:e,duration:n,easing:i,css:b=>`overflow: hidden;opacity: ${Math.min(b*20,1)*a};${o}: ${b*l}px;padding-${c[0]}: ${b*f}px;padding-${c[1]}: ${b*p}px;margin-${c[0]}: ${b*d}px;margin-${c[1]}: ${b*y}px;border-${c[0]}-width: ${b*m}px;border-${c[1]}-width: ${b*w}px;min-${o}: 0`}}function po(t,{delay:e=0,duration:n=400,easing:i=A1,start:r=0,opacity:s=0}={}){const a=getComputedStyle(t),o=+a.opacity,l=a.transform==="none"?"":a.transform,c=1-r,u=o*(1-s);return{delay:e,duration:n,easing:i,css:(f,p)=>`
			transform: ${l} scale(${1-c*p});
			opacity: ${o-u*p}
		`}}function Da(t){const e=t-1;return e*e*e+1}var bS={value:()=>{}};function sp(){for(var t=0,e=arguments.length,n={},i;t<e;++t){if(!(i=arguments[t]+"")||i in n||/[\s.]/.test(i))throw new Error("illegal type: "+i);n[i]=[]}return new rh(n)}function rh(t){this._=t}function wS(t,e){return t.trim().split(/^|\s+/).map(function(n){var i="",r=n.indexOf(".");if(r>=0&&(i=n.slice(r+1),n=n.slice(0,r)),n&&!e.hasOwnProperty(n))throw new Error("unknown type: "+n);return{type:n,name:i}})}rh.prototype=sp.prototype={constructor:rh,on:function(t,e){var n=this._,i=wS(t+"",n),r,s=-1,a=i.length;if(arguments.length<2){for(;++s<a;)if((r=(t=i[s]).type)&&(r=xS(n[r],t.name)))return r;return}if(e!=null&&typeof e!="function")throw new Error("invalid callback: "+e);for(;++s<a;)if(r=(t=i[s]).type)n[r]=ov(n[r],t.name,e);else if(e==null)for(r in n)n[r]=ov(n[r],t.name,null);return this},copy:function(){var t={},e=this._;for(var n in e)t[n]=e[n].slice();return new rh(t)},call:function(t,e){if((r=arguments.length-2)>0)for(var n=new Array(r),i=0,r,s;i<r;++i)n[i]=arguments[i+2];if(!this._.hasOwnProperty(t))throw new Error("unknown type: "+t);for(s=this._[t],i=0,r=s.length;i<r;++i)s[i].value.apply(e,n)},apply:function(t,e,n){if(!this._.hasOwnProperty(t))throw new Error("unknown type: "+t);for(var i=this._[t],r=0,s=i.length;r<s;++r)i[r].value.apply(e,n)}};function xS(t,e){for(var n=0,i=t.length,r;n<i;++n)if((r=t[n]).name===e)return r.value}function ov(t,e,n){for(var i=0,r=t.length;i<r;++i)if(t[i].name===e){t[i]=bS,t=t.slice(0,i).concat(t.slice(i+1));break}return n!=null&&t.push({name:e,value:n}),t}var Cm="http://www.w3.org/1999/xhtml";const lv={svg:"http://www.w3.org/2000/svg",xhtml:Cm,xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/"};function ap(t){var e=t+="",n=e.indexOf(":");return n>=0&&(e=t.slice(0,n))!=="xmlns"&&(t=t.slice(n+1)),lv.hasOwnProperty(e)?{space:lv[e],local:t}:t}function _S(t){return function(){var e=this.ownerDocument,n=this.namespaceURI;return n===Cm&&e.documentElement.namespaceURI===Cm?e.createElement(t):e.createElementNS(n,t)}}function SS(t){return function(){return this.ownerDocument.createElementNS(t.space,t.local)}}function Bb(t){var e=ap(t);return(e.local?SS:_S)(e)}function kS(){}function C1(t){return t==null?kS:function(){return this.querySelector(t)}}function AS(t){typeof t!="function"&&(t=C1(t));for(var e=this._groups,n=e.length,i=new Array(n),r=0;r<n;++r)for(var s=e[r],a=s.length,o=i[r]=new Array(a),l,c,u=0;u<a;++u)(l=s[u])&&(c=t.call(l,l.__data__,u,s))&&("__data__"in l&&(c.__data__=l.__data__),o[u]=c);return new Fs(i,this._parents)}function NS(t){return t==null?[]:Array.isArray(t)?t:Array.from(t)}function CS(){return[]}function zb(t){return t==null?CS:function(){return this.querySelectorAll(t)}}function PS(t){return function(){return NS(t.apply(this,arguments))}}function ES(t){typeof t=="function"?t=PS(t):t=zb(t);for(var e=this._groups,n=e.length,i=[],r=[],s=0;s<n;++s)for(var a=e[s],o=a.length,l,c=0;c<o;++c)(l=a[c])&&(i.push(t.call(l,l.__data__,c,a)),r.push(l));return new Fs(i,r)}function qb(t){return function(){return this.matches(t)}}function jb(t){return function(e){return e.matches(t)}}var IS=Array.prototype.find;function LS(t){return function(){return IS.call(this.children,t)}}function MS(){return this.firstElementChild}function TS(t){return this.select(t==null?MS:LS(typeof t=="function"?t:jb(t)))}var DS=Array.prototype.filter;function OS(){return Array.from(this.children)}function FS(t){return function(){return DS.call(this.children,t)}}function RS(t){return this.selectAll(t==null?OS:FS(typeof t=="function"?t:jb(t)))}function BS(t){typeof t!="function"&&(t=qb(t));for(var e=this._groups,n=e.length,i=new Array(n),r=0;r<n;++r)for(var s=e[r],a=s.length,o=i[r]=[],l,c=0;c<a;++c)(l=s[c])&&t.call(l,l.__data__,c,s)&&o.push(l);return new Fs(i,this._parents)}function Hb(t){return new Array(t.length)}function zS(){return new Fs(this._enter||this._groups.map(Hb),this._parents)}function Ch(t,e){this.ownerDocument=t.ownerDocument,this.namespaceURI=t.namespaceURI,this._next=null,this._parent=t,this.__data__=e}Ch.prototype={constructor:Ch,appendChild:function(t){return this._parent.insertBefore(t,this._next)},insertBefore:function(t,e){return this._parent.insertBefore(t,e)},querySelector:function(t){return this._parent.querySelector(t)},querySelectorAll:function(t){return this._parent.querySelectorAll(t)}};function qS(t){return function(){return t}}function jS(t,e,n,i,r,s){for(var a=0,o,l=e.length,c=s.length;a<c;++a)(o=e[a])?(o.__data__=s[a],i[a]=o):n[a]=new Ch(t,s[a]);for(;a<l;++a)(o=e[a])&&(r[a]=o)}function HS(t,e,n,i,r,s,a){var o,l,c=new Map,u=e.length,f=s.length,p=new Array(u),d;for(o=0;o<u;++o)(l=e[o])&&(p[o]=d=a.call(l,l.__data__,o,e)+"",c.has(d)?r[o]=l:c.set(d,l));for(o=0;o<f;++o)d=a.call(t,s[o],o,s)+"",(l=c.get(d))?(i[o]=l,l.__data__=s[o],c.delete(d)):n[o]=new Ch(t,s[o]);for(o=0;o<u;++o)(l=e[o])&&c.get(p[o])===l&&(r[o]=l)}function US(t){return t.__data__}function WS(t,e){if(!arguments.length)return Array.from(this,US);var n=e?HS:jS,i=this._parents,r=this._groups;typeof t!="function"&&(t=qS(t));for(var s=r.length,a=new Array(s),o=new Array(s),l=new Array(s),c=0;c<s;++c){var u=i[c],f=r[c],p=f.length,d=VS(t.call(u,u&&u.__data__,c,i)),y=d.length,m=o[c]=new Array(y),w=a[c]=new Array(y),b=l[c]=new Array(p);n(u,f,m,w,b,d,e);for(var S=0,A=0,_,I;S<y;++S)if(_=m[S]){for(S>=A&&(A=S+1);!(I=w[A])&&++A<y;);_._next=I||null}}return a=new Fs(a,i),a._enter=o,a._exit=l,a}function VS(t){return typeof t=="object"&&"length"in t?t:Array.from(t)}function GS(){return new Fs(this._exit||this._groups.map(Hb),this._parents)}function XS(t,e,n){var i=this.enter(),r=this,s=this.exit();return typeof t=="function"?(i=t(i),i&&(i=i.selection())):i=i.append(t+""),e!=null&&(r=e(r),r&&(r=r.selection())),n==null?s.remove():n(s),i&&r?i.merge(r).order():r}function YS(t){for(var e=t.selection?t.selection():t,n=this._groups,i=e._groups,r=n.length,s=i.length,a=Math.min(r,s),o=new Array(r),l=0;l<a;++l)for(var c=n[l],u=i[l],f=c.length,p=o[l]=new Array(f),d,y=0;y<f;++y)(d=c[y]||u[y])&&(p[y]=d);for(;l<r;++l)o[l]=n[l];return new Fs(o,this._parents)}function KS(){for(var t=this._groups,e=-1,n=t.length;++e<n;)for(var i=t[e],r=i.length-1,s=i[r],a;--r>=0;)(a=i[r])&&(s&&a.compareDocumentPosition(s)^4&&s.parentNode.insertBefore(a,s),s=a);return this}function ZS(t){t||(t=JS);function e(f,p){return f&&p?t(f.__data__,p.__data__):!f-!p}for(var n=this._groups,i=n.length,r=new Array(i),s=0;s<i;++s){for(var a=n[s],o=a.length,l=r[s]=new Array(o),c,u=0;u<o;++u)(c=a[u])&&(l[u]=c);l.sort(e)}return new Fs(r,this._parents).order()}function JS(t,e){return t<e?-1:t>e?1:t>=e?0:NaN}function QS(){var t=arguments[0];return arguments[0]=this,t.apply(null,arguments),this}function $S(){return Array.from(this)}function ek(){for(var t=this._groups,e=0,n=t.length;e<n;++e)for(var i=t[e],r=0,s=i.length;r<s;++r){var a=i[r];if(a)return a}return null}function tk(){let t=0;for(const e of this)++t;return t}function nk(){return!this.node()}function ik(t){for(var e=this._groups,n=0,i=e.length;n<i;++n)for(var r=e[n],s=0,a=r.length,o;s<a;++s)(o=r[s])&&t.call(o,o.__data__,s,r);return this}function rk(t){return function(){this.removeAttribute(t)}}function sk(t){return function(){this.removeAttributeNS(t.space,t.local)}}function ak(t,e){return function(){this.setAttribute(t,e)}}function ok(t,e){return function(){this.setAttributeNS(t.space,t.local,e)}}function lk(t,e){return function(){var n=e.apply(this,arguments);n==null?this.removeAttribute(t):this.setAttribute(t,n)}}function ck(t,e){return function(){var n=e.apply(this,arguments);n==null?this.removeAttributeNS(t.space,t.local):this.setAttributeNS(t.space,t.local,n)}}function uk(t,e){var n=ap(t);if(arguments.length<2){var i=this.node();return n.local?i.getAttributeNS(n.space,n.local):i.getAttribute(n)}return this.each((e==null?n.local?sk:rk:typeof e=="function"?n.local?ck:lk:n.local?ok:ak)(n,e))}function Ub(t){return t.ownerDocument&&t.ownerDocument.defaultView||t.document&&t||t.defaultView}function dk(t){return function(){this.style.removeProperty(t)}}function fk(t,e,n){return function(){this.style.setProperty(t,e,n)}}function hk(t,e,n){return function(){var i=e.apply(this,arguments);i==null?this.style.removeProperty(t):this.style.setProperty(t,i,n)}}function pk(t,e,n){return arguments.length>1?this.each((e==null?dk:typeof e=="function"?hk:fk)(t,e,n??"")):Pu(this.node(),t)}function Pu(t,e){return t.style.getPropertyValue(e)||Ub(t).getComputedStyle(t,null).getPropertyValue(e)}function gk(t){return function(){delete this[t]}}function mk(t,e){return function(){this[t]=e}}function vk(t,e){return function(){var n=e.apply(this,arguments);n==null?delete this[t]:this[t]=n}}function yk(t,e){return arguments.length>1?this.each((e==null?gk:typeof e=="function"?vk:mk)(t,e)):this.node()[t]}function Wb(t){return t.trim().split(/^|\s+/)}function P1(t){return t.classList||new Vb(t)}function Vb(t){this._node=t,this._names=Wb(t.getAttribute("class")||"")}Vb.prototype={add:function(t){var e=this._names.indexOf(t);e<0&&(this._names.push(t),this._node.setAttribute("class",this._names.join(" ")))},remove:function(t){var e=this._names.indexOf(t);e>=0&&(this._names.splice(e,1),this._node.setAttribute("class",this._names.join(" ")))},contains:function(t){return this._names.indexOf(t)>=0}};function Gb(t,e){for(var n=P1(t),i=-1,r=e.length;++i<r;)n.add(e[i])}function Xb(t,e){for(var n=P1(t),i=-1,r=e.length;++i<r;)n.remove(e[i])}function bk(t){return function(){Gb(this,t)}}function wk(t){return function(){Xb(this,t)}}function xk(t,e){return function(){(e.apply(this,arguments)?Gb:Xb)(this,t)}}function _k(t,e){var n=Wb(t+"");if(arguments.length<2){for(var i=P1(this.node()),r=-1,s=n.length;++r<s;)if(!i.contains(n[r]))return!1;return!0}return this.each((typeof e=="function"?xk:e?bk:wk)(n,e))}function Sk(){this.textContent=""}function kk(t){return function(){this.textContent=t}}function Ak(t){return function(){var e=t.apply(this,arguments);this.textContent=e??""}}function Nk(t){return arguments.length?this.each(t==null?Sk:(typeof t=="function"?Ak:kk)(t)):this.node().textContent}function Ck(){this.innerHTML=""}function Pk(t){return function(){this.innerHTML=t}}function Ek(t){return function(){var e=t.apply(this,arguments);this.innerHTML=e??""}}function Ik(t){return arguments.length?this.each(t==null?Ck:(typeof t=="function"?Ek:Pk)(t)):this.node().innerHTML}function Lk(){this.nextSibling&&this.parentNode.appendChild(this)}function Mk(){return this.each(Lk)}function Tk(){this.previousSibling&&this.parentNode.insertBefore(this,this.parentNode.firstChild)}function Dk(){return this.each(Tk)}function Ok(t){var e=typeof t=="function"?t:Bb(t);return this.select(function(){return this.appendChild(e.apply(this,arguments))})}function Fk(){return null}function Rk(t,e){var n=typeof t=="function"?t:Bb(t),i=e==null?Fk:typeof e=="function"?e:C1(e);return this.select(function(){return this.insertBefore(n.apply(this,arguments),i.apply(this,arguments)||null)})}function Bk(){var t=this.parentNode;t&&t.removeChild(this)}function zk(){return this.each(Bk)}function qk(){var t=this.cloneNode(!1),e=this.parentNode;return e?e.insertBefore(t,this.nextSibling):t}function jk(){var t=this.cloneNode(!0),e=this.parentNode;return e?e.insertBefore(t,this.nextSibling):t}function Hk(t){return this.select(t?jk:qk)}function Uk(t){return arguments.length?this.property("__data__",t):this.node().__data__}function Wk(t){return function(e){t.call(this,e,this.__data__)}}function Vk(t){return t.trim().split(/^|\s+/).map(function(e){var n="",i=e.indexOf(".");return i>=0&&(n=e.slice(i+1),e=e.slice(0,i)),{type:e,name:n}})}function Gk(t){return function(){var e=this.__on;if(e){for(var n=0,i=-1,r=e.length,s;n<r;++n)s=e[n],(!t.type||s.type===t.type)&&s.name===t.name?this.removeEventListener(s.type,s.listener,s.options):e[++i]=s;++i?e.length=i:delete this.__on}}}function Xk(t,e,n){return function(){var i=this.__on,r,s=Wk(e);if(i){for(var a=0,o=i.length;a<o;++a)if((r=i[a]).type===t.type&&r.name===t.name){this.removeEventListener(r.type,r.listener,r.options),this.addEventListener(r.type,r.listener=s,r.options=n),r.value=e;return}}this.addEventListener(t.type,s,n),r={type:t.type,name:t.name,value:e,listener:s,options:n},i?i.push(r):this.__on=[r]}}function Yk(t,e,n){var i=Vk(t+""),r,s=i.length,a;if(arguments.length<2){var o=this.node().__on;if(o){for(var l=0,c=o.length,u;l<c;++l)for(r=0,u=o[l];r<s;++r)if((a=i[r]).type===u.type&&a.name===u.name)return u.value}return}for(o=e?Xk:Gk,r=0;r<s;++r)this.each(o(i[r],e,n));return this}function Yb(t,e,n){var i=Ub(t),r=i.CustomEvent;typeof r=="function"?r=new r(e,n):(r=i.document.createEvent("Event"),n?(r.initEvent(e,n.bubbles,n.cancelable),r.detail=n.detail):r.initEvent(e,!1,!1)),t.dispatchEvent(r)}function Kk(t,e){return function(){return Yb(this,t,e)}}function Zk(t,e){return function(){return Yb(this,t,e.apply(this,arguments))}}function Jk(t,e){return this.each((typeof e=="function"?Zk:Kk)(t,e))}function*Qk(){for(var t=this._groups,e=0,n=t.length;e<n;++e)for(var i=t[e],r=0,s=i.length,a;r<s;++r)(a=i[r])&&(yield a)}var Kb=[null];function Fs(t,e){this._groups=t,this._parents=e}function Gd(){return new Fs([[document.documentElement]],Kb)}function $k(){return this}Fs.prototype=Gd.prototype={constructor:Fs,select:AS,selectAll:ES,selectChild:TS,selectChildren:RS,filter:BS,data:WS,enter:zS,exit:GS,join:XS,merge:YS,selection:$k,order:KS,sort:ZS,call:QS,nodes:$S,node:ek,size:tk,empty:nk,each:ik,attr:uk,style:pk,property:yk,classed:_k,text:Nk,html:Ik,raise:Mk,lower:Dk,append:Ok,insert:Rk,remove:zk,clone:Hk,datum:Uk,on:Yk,dispatch:Jk,[Symbol.iterator]:Qk};function na(t){return typeof t=="string"?new Fs([[document.querySelector(t)]],[document.documentElement]):new Fs([[t]],Kb)}function e4(t){let e;for(;e=t.sourceEvent;)t=e;return t}function io(t,e){if(t=e4(t),e===void 0&&(e=t.currentTarget),e){var n=e.ownerSVGElement||e;if(n.createSVGPoint){var i=n.createSVGPoint();return i.x=t.clientX,i.y=t.clientY,i=i.matrixTransform(e.getScreenCTM().inverse()),[i.x,i.y]}if(e.getBoundingClientRect){var r=e.getBoundingClientRect();return[t.clientX-r.left-e.clientLeft,t.clientY-r.top-e.clientTop]}}return[t.pageX,t.pageY]}const t4={passive:!1},Md={capture:!0,passive:!1};function gg(t){t.stopImmediatePropagation()}function mu(t){t.preventDefault(),t.stopImmediatePropagation()}function Zb(t){var e=t.document.documentElement,n=na(t).on("dragstart.drag",mu,Md);"onselectstart"in e?n.on("selectstart.drag",mu,Md):(e.__noselect=e.style.MozUserSelect,e.style.MozUserSelect="none")}function Jb(t,e){var n=t.document.documentElement,i=na(t).on("dragstart.drag",null);e&&(i.on("click.drag",mu,Md),setTimeout(function(){i.on("click.drag",null)},0)),"onselectstart"in n?i.on("selectstart.drag",null):(n.style.MozUserSelect=n.__noselect,delete n.__noselect)}const Pf=t=>()=>t;function Pm(t,{sourceEvent:e,subject:n,target:i,identifier:r,active:s,x:a,y:o,dx:l,dy:c,dispatch:u}){Object.defineProperties(this,{type:{value:t,enumerable:!0,configurable:!0},sourceEvent:{value:e,enumerable:!0,configurable:!0},subject:{value:n,enumerable:!0,configurable:!0},target:{value:i,enumerable:!0,configurable:!0},identifier:{value:r,enumerable:!0,configurable:!0},active:{value:s,enumerable:!0,configurable:!0},x:{value:a,enumerable:!0,configurable:!0},y:{value:o,enumerable:!0,configurable:!0},dx:{value:l,enumerable:!0,configurable:!0},dy:{value:c,enumerable:!0,configurable:!0},_:{value:u}})}Pm.prototype.on=function(){var t=this._.on.apply(this._,arguments);return t===this._?this:t};function n4(t){return!t.ctrlKey&&!t.button}function i4(){return this.parentNode}function r4(t,e){return e??{x:t.x,y:t.y}}function s4(){return navigator.maxTouchPoints||"ontouchstart"in this}function Qb(){var t=n4,e=i4,n=r4,i=s4,r={},s=sp("start","drag","end"),a=0,o,l,c,u,f=0;function p(_){_.on("mousedown.drag",d).filter(i).on("touchstart.drag",w).on("touchmove.drag",b,t4).on("touchend.drag touchcancel.drag",S).style("touch-action","none").style("-webkit-tap-highlight-color","rgba(0,0,0,0)")}function d(_,I){if(!(u||!t.call(this,_,I))){var E=A(this,e.call(this,_,I),_,I,"mouse");E&&(na(_.view).on("mousemove.drag",y,Md).on("mouseup.drag",m,Md),Zb(_.view),gg(_),c=!1,o=_.clientX,l=_.clientY,E("start",_))}}function y(_){if(mu(_),!c){var I=_.clientX-o,E=_.clientY-l;c=I*I+E*E>f}r.mouse("drag",_)}function m(_){na(_.view).on("mousemove.drag mouseup.drag",null),Jb(_.view,c),mu(_),r.mouse("end",_)}function w(_,I){if(t.call(this,_,I)){var E=_.changedTouches,M=e.call(this,_,I),T=E.length,D,U;for(D=0;D<T;++D)(U=A(this,M,_,I,E[D].identifier,E[D]))&&(gg(_),U("start",_,E[D]))}}function b(_){var I=_.changedTouches,E=I.length,M,T;for(M=0;M<E;++M)(T=r[I[M].identifier])&&(mu(_),T("drag",_,I[M]))}function S(_){var I=_.changedTouches,E=I.length,M,T;for(u&&clearTimeout(u),u=setTimeout(function(){u=null},500),M=0;M<E;++M)(T=r[I[M].identifier])&&(gg(_),T("end",_,I[M]))}function A(_,I,E,M,T,D){var U=s.copy(),C=io(D||E,I),N,B,P;if((P=n.call(_,new Pm("beforestart",{sourceEvent:E,target:p,identifier:T,active:a,x:C[0],y:C[1],dx:0,dy:0,dispatch:U}),M))!=null)return N=P.x-C[0]||0,B=P.y-C[1]||0,function F(q,Z,W){var Y=C,ue;switch(q){case"start":r[T]=F,ue=a++;break;case"end":delete r[T],--a;case"drag":C=io(W||Z,I),ue=a;break}U.call(q,_,new Pm(q,{sourceEvent:Z,subject:P,target:p,identifier:T,active:ue,x:C[0]+N,y:C[1]+B,dx:C[0]-Y[0],dy:C[1]-Y[1],dispatch:U}),M)}}return p.filter=function(_){return arguments.length?(t=typeof _=="function"?_:Pf(!!_),p):t},p.container=function(_){return arguments.length?(e=typeof _=="function"?_:Pf(_),p):e},p.subject=function(_){return arguments.length?(n=typeof _=="function"?_:Pf(_),p):n},p.touchable=function(_){return arguments.length?(i=typeof _=="function"?_:Pf(!!_),p):i},p.on=function(){var _=s.on.apply(s,arguments);return _===s?p:_},p.clickDistance=function(_){return arguments.length?(f=(_=+_)*_,p):Math.sqrt(f)},p}function E1(t,e,n){t.prototype=e.prototype=n,n.constructor=t}function $b(t,e){var n=Object.create(t.prototype);for(var i in e)n[i]=e[i];return n}function Xd(){}var Td=.7,Ph=1/Td,vu="\\s*([+-]?\\d+)\\s*",Dd="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)\\s*",co="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)%\\s*",a4=/^#([0-9a-f]{3,8})$/,o4=new RegExp(`^rgb\\(${vu},${vu},${vu}\\)$`),l4=new RegExp(`^rgb\\(${co},${co},${co}\\)$`),c4=new RegExp(`^rgba\\(${vu},${vu},${vu},${Dd}\\)$`),u4=new RegExp(`^rgba\\(${co},${co},${co},${Dd}\\)$`),d4=new RegExp(`^hsl\\(${Dd},${co},${co}\\)$`),f4=new RegExp(`^hsla\\(${Dd},${co},${co},${Dd}\\)$`),cv={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};E1(Xd,Nc,{copy(t){return Object.assign(new this.constructor,this,t)},displayable(){return this.rgb().displayable()},hex:uv,formatHex:uv,formatHex8:h4,formatHsl:p4,formatRgb:dv,toString:dv});function uv(){return this.rgb().formatHex()}function h4(){return this.rgb().formatHex8()}function p4(){return e5(this).formatHsl()}function dv(){return this.rgb().formatRgb()}function Nc(t){var e,n;return t=(t+"").trim().toLowerCase(),(e=a4.exec(t))?(n=e[1].length,e=parseInt(e[1],16),n===6?fv(e):n===3?new ms(e>>8&15|e>>4&240,e>>4&15|e&240,(e&15)<<4|e&15,1):n===8?Ef(e>>24&255,e>>16&255,e>>8&255,(e&255)/255):n===4?Ef(e>>12&15|e>>8&240,e>>8&15|e>>4&240,e>>4&15|e&240,((e&15)<<4|e&15)/255):null):(e=o4.exec(t))?new ms(e[1],e[2],e[3],1):(e=l4.exec(t))?new ms(e[1]*255/100,e[2]*255/100,e[3]*255/100,1):(e=c4.exec(t))?Ef(e[1],e[2],e[3],e[4]):(e=u4.exec(t))?Ef(e[1]*255/100,e[2]*255/100,e[3]*255/100,e[4]):(e=d4.exec(t))?gv(e[1],e[2]/100,e[3]/100,1):(e=f4.exec(t))?gv(e[1],e[2]/100,e[3]/100,e[4]):cv.hasOwnProperty(t)?fv(cv[t]):t==="transparent"?new ms(NaN,NaN,NaN,0):null}function fv(t){return new ms(t>>16&255,t>>8&255,t&255,1)}function Ef(t,e,n,i){return i<=0&&(t=e=n=NaN),new ms(t,e,n,i)}function g4(t){return t instanceof Xd||(t=Nc(t)),t?(t=t.rgb(),new ms(t.r,t.g,t.b,t.opacity)):new ms}function Em(t,e,n,i){return arguments.length===1?g4(t):new ms(t,e,n,i??1)}function ms(t,e,n,i){this.r=+t,this.g=+e,this.b=+n,this.opacity=+i}E1(ms,Em,$b(Xd,{brighter(t){return t=t==null?Ph:Math.pow(Ph,t),new ms(this.r*t,this.g*t,this.b*t,this.opacity)},darker(t){return t=t==null?Td:Math.pow(Td,t),new ms(this.r*t,this.g*t,this.b*t,this.opacity)},rgb(){return this},clamp(){return new ms(kc(this.r),kc(this.g),kc(this.b),Eh(this.opacity))},displayable(){return-.5<=this.r&&this.r<255.5&&-.5<=this.g&&this.g<255.5&&-.5<=this.b&&this.b<255.5&&0<=this.opacity&&this.opacity<=1},hex:hv,formatHex:hv,formatHex8:m4,formatRgb:pv,toString:pv}));function hv(){return`#${wc(this.r)}${wc(this.g)}${wc(this.b)}`}function m4(){return`#${wc(this.r)}${wc(this.g)}${wc(this.b)}${wc((isNaN(this.opacity)?1:this.opacity)*255)}`}function pv(){const t=Eh(this.opacity);return`${t===1?"rgb(":"rgba("}${kc(this.r)}, ${kc(this.g)}, ${kc(this.b)}${t===1?")":`, ${t})`}`}function Eh(t){return isNaN(t)?1:Math.max(0,Math.min(1,t))}function kc(t){return Math.max(0,Math.min(255,Math.round(t)||0))}function wc(t){return t=kc(t),(t<16?"0":"")+t.toString(16)}function gv(t,e,n,i){return i<=0?t=e=n=NaN:n<=0||n>=1?t=e=NaN:e<=0&&(t=NaN),new Pa(t,e,n,i)}function e5(t){if(t instanceof Pa)return new Pa(t.h,t.s,t.l,t.opacity);if(t instanceof Xd||(t=Nc(t)),!t)return new Pa;if(t instanceof Pa)return t;t=t.rgb();var e=t.r/255,n=t.g/255,i=t.b/255,r=Math.min(e,n,i),s=Math.max(e,n,i),a=NaN,o=s-r,l=(s+r)/2;return o?(e===s?a=(n-i)/o+(n<i)*6:n===s?a=(i-e)/o+2:a=(e-n)/o+4,o/=l<.5?s+r:2-s-r,a*=60):o=l>0&&l<1?0:a,new Pa(a,o,l,t.opacity)}function v4(t,e,n,i){return arguments.length===1?e5(t):new Pa(t,e,n,i??1)}function Pa(t,e,n,i){this.h=+t,this.s=+e,this.l=+n,this.opacity=+i}E1(Pa,v4,$b(Xd,{brighter(t){return t=t==null?Ph:Math.pow(Ph,t),new Pa(this.h,this.s,this.l*t,this.opacity)},darker(t){return t=t==null?Td:Math.pow(Td,t),new Pa(this.h,this.s,this.l*t,this.opacity)},rgb(){var t=this.h%360+(this.h<0)*360,e=isNaN(t)||isNaN(this.s)?0:this.s,n=this.l,i=n+(n<.5?n:1-n)*e,r=2*n-i;return new ms(mg(t>=240?t-240:t+120,r,i),mg(t,r,i),mg(t<120?t+240:t-120,r,i),this.opacity)},clamp(){return new Pa(mv(this.h),If(this.s),If(this.l),Eh(this.opacity))},displayable(){return(0<=this.s&&this.s<=1||isNaN(this.s))&&0<=this.l&&this.l<=1&&0<=this.opacity&&this.opacity<=1},formatHsl(){const t=Eh(this.opacity);return`${t===1?"hsl(":"hsla("}${mv(this.h)}, ${If(this.s)*100}%, ${If(this.l)*100}%${t===1?")":`, ${t})`}`}}));function mv(t){return t=(t||0)%360,t<0?t+360:t}function If(t){return Math.max(0,Math.min(1,t||0))}function mg(t,e,n){return(t<60?e+(n-e)*t/60:t<180?n:t<240?e+(n-e)*(240-t)/60:e)*255}const I1=t=>()=>t;function y4(t,e){return function(n){return t+n*e}}function b4(t,e,n){return t=Math.pow(t,n),e=Math.pow(e,n)-t,n=1/n,function(i){return Math.pow(t+i*e,n)}}function w4(t){return(t=+t)==1?t5:function(e,n){return n-e?b4(e,n,t):I1(isNaN(e)?n:e)}}function t5(t,e){var n=e-t;return n?y4(t,n):I1(isNaN(t)?e:t)}const Ih=(function t(e){var n=w4(e);function i(r,s){var a=n((r=Em(r)).r,(s=Em(s)).r),o=n(r.g,s.g),l=n(r.b,s.b),c=t5(r.opacity,s.opacity);return function(u){return r.r=a(u),r.g=o(u),r.b=l(u),r.opacity=c(u),r+""}}return i.gamma=t,i})(1);function x4(t,e){e||(e=[]);var n=t?Math.min(e.length,t.length):0,i=e.slice(),r;return function(s){for(r=0;r<n;++r)i[r]=t[r]*(1-s)+e[r]*s;return i}}function _4(t){return ArrayBuffer.isView(t)&&!(t instanceof DataView)}function S4(t,e){var n=e?e.length:0,i=t?Math.min(n,t.length):0,r=new Array(i),s=new Array(n),a;for(a=0;a<i;++a)r[a]=Sd(t[a],e[a]);for(;a<n;++a)s[a]=e[a];return function(o){for(a=0;a<i;++a)s[a]=r[a](o);return s}}function k4(t,e){var n=new Date;return t=+t,e=+e,function(i){return n.setTime(t*(1-i)+e*i),n}}function ro(t,e){return t=+t,e=+e,function(n){return t*(1-n)+e*n}}function A4(t,e){var n={},i={},r;(t===null||typeof t!="object")&&(t={}),(e===null||typeof e!="object")&&(e={});for(r in e)r in t?n[r]=Sd(t[r],e[r]):i[r]=e[r];return function(s){for(r in n)i[r]=n[r](s);return i}}var Im=/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g,vg=new RegExp(Im.source,"g");function N4(t){return function(){return t}}function C4(t){return function(e){return t(e)+""}}function n5(t,e){var n=Im.lastIndex=vg.lastIndex=0,i,r,s,a=-1,o=[],l=[];for(t=t+"",e=e+"";(i=Im.exec(t))&&(r=vg.exec(e));)(s=r.index)>n&&(s=e.slice(n,s),o[a]?o[a]+=s:o[++a]=s),(i=i[0])===(r=r[0])?o[a]?o[a]+=r:o[++a]=r:(o[++a]=null,l.push({i:a,x:ro(i,r)})),n=vg.lastIndex;return n<e.length&&(s=e.slice(n),o[a]?o[a]+=s:o[++a]=s),o.length<2?l[0]?C4(l[0].x):N4(e):(e=l.length,function(c){for(var u=0,f;u<e;++u)o[(f=l[u]).i]=f.x(c);return o.join("")})}function Sd(t,e){var n=typeof e,i;return e==null||n==="boolean"?I1(e):(n==="number"?ro:n==="string"?(i=Nc(e))?(e=i,Ih):n5:e instanceof Nc?Ih:e instanceof Date?k4:_4(e)?x4:Array.isArray(e)?S4:typeof e.valueOf!="function"&&typeof e.toString!="function"||isNaN(e)?A4:ro)(t,e)}var vv=180/Math.PI,Lm={translateX:0,translateY:0,rotate:0,skewX:0,scaleX:1,scaleY:1};function i5(t,e,n,i,r,s){var a,o,l;return(a=Math.sqrt(t*t+e*e))&&(t/=a,e/=a),(l=t*n+e*i)&&(n-=t*l,i-=e*l),(o=Math.sqrt(n*n+i*i))&&(n/=o,i/=o,l/=o),t*i<e*n&&(t=-t,e=-e,l=-l,a=-a),{translateX:r,translateY:s,rotate:Math.atan2(e,t)*vv,skewX:Math.atan(l)*vv,scaleX:a,scaleY:o}}var Lf;function P4(t){const e=new(typeof DOMMatrix=="function"?DOMMatrix:WebKitCSSMatrix)(t+"");return e.isIdentity?Lm:i5(e.a,e.b,e.c,e.d,e.e,e.f)}function E4(t){return t==null||(Lf||(Lf=document.createElementNS("http://www.w3.org/2000/svg","g")),Lf.setAttribute("transform",t),!(t=Lf.transform.baseVal.consolidate()))?Lm:(t=t.matrix,i5(t.a,t.b,t.c,t.d,t.e,t.f))}function r5(t,e,n,i){function r(c){return c.length?c.pop()+" ":""}function s(c,u,f,p,d,y){if(c!==f||u!==p){var m=d.push("translate(",null,e,null,n);y.push({i:m-4,x:ro(c,f)},{i:m-2,x:ro(u,p)})}else(f||p)&&d.push("translate("+f+e+p+n)}function a(c,u,f,p){c!==u?(c-u>180?u+=360:u-c>180&&(c+=360),p.push({i:f.push(r(f)+"rotate(",null,i)-2,x:ro(c,u)})):u&&f.push(r(f)+"rotate("+u+i)}function o(c,u,f,p){c!==u?p.push({i:f.push(r(f)+"skewX(",null,i)-2,x:ro(c,u)}):u&&f.push(r(f)+"skewX("+u+i)}function l(c,u,f,p,d,y){if(c!==f||u!==p){var m=d.push(r(d)+"scale(",null,",",null,")");y.push({i:m-4,x:ro(c,f)},{i:m-2,x:ro(u,p)})}else(f!==1||p!==1)&&d.push(r(d)+"scale("+f+","+p+")")}return function(c,u){var f=[],p=[];return c=t(c),u=t(u),s(c.translateX,c.translateY,u.translateX,u.translateY,f,p),a(c.rotate,u.rotate,f,p),o(c.skewX,u.skewX,f,p),l(c.scaleX,c.scaleY,u.scaleX,u.scaleY,f,p),c=u=null,function(d){for(var y=-1,m=p.length,w;++y<m;)f[(w=p[y]).i]=w.x(d);return f.join("")}}}var I4=r5(P4,"px, ","px)","deg)"),L4=r5(E4,", ",")",")"),M4=1e-12;function yv(t){return((t=Math.exp(t))+1/t)/2}function T4(t){return((t=Math.exp(t))-1/t)/2}function D4(t){return((t=Math.exp(2*t))-1)/(t+1)}const sh=(function t(e,n,i){function r(s,a){var o=s[0],l=s[1],c=s[2],u=a[0],f=a[1],p=a[2],d=u-o,y=f-l,m=d*d+y*y,w,b;if(m<M4)b=Math.log(p/c)/e,w=function(M){return[o+M*d,l+M*y,c*Math.exp(e*M*b)]};else{var S=Math.sqrt(m),A=(p*p-c*c+i*m)/(2*c*n*S),_=(p*p-c*c-i*m)/(2*p*n*S),I=Math.log(Math.sqrt(A*A+1)-A),E=Math.log(Math.sqrt(_*_+1)-_);b=(E-I)/e,w=function(M){var T=M*b,D=yv(I),U=c/(n*S)*(D*D4(e*T+I)-T4(I));return[o+U*d,l+U*y,c*D/yv(e*T+I)]}}return w.duration=b*1e3*e/Math.SQRT2,w}return r.rho=function(s){var a=Math.max(.001,+s),o=a*a,l=o*o;return t(a,o,l)},r})(Math.SQRT2,2,4);var Eu=0,hd=0,rd=0,s5=1e3,Lh,pd,Mh=0,Cc=0,op=0,Od=typeof performance=="object"&&performance.now?performance:Date,a5=typeof window=="object"&&window.requestAnimationFrame?window.requestAnimationFrame.bind(window):function(t){setTimeout(t,17)};function L1(){return Cc||(a5(O4),Cc=Od.now()+op)}function O4(){Cc=0}function Th(){this._call=this._time=this._next=null}Th.prototype=o5.prototype={constructor:Th,restart:function(t,e,n){if(typeof t!="function")throw new TypeError("callback is not a function");n=(n==null?L1():+n)+(e==null?0:+e),!this._next&&pd!==this&&(pd?pd._next=this:Lh=this,pd=this),this._call=t,this._time=n,Mm()},stop:function(){this._call&&(this._call=null,this._time=1/0,Mm())}};function o5(t,e,n){var i=new Th;return i.restart(t,e,n),i}function F4(){L1(),++Eu;for(var t=Lh,e;t;)(e=Cc-t._time)>=0&&t._call.call(void 0,e),t=t._next;--Eu}function bv(){Cc=(Mh=Od.now())+op,Eu=hd=0;try{F4()}finally{Eu=0,B4(),Cc=0}}function R4(){var t=Od.now(),e=t-Mh;e>s5&&(op-=e,Mh=t)}function B4(){for(var t,e=Lh,n,i=1/0;e;)e._call?(i>e._time&&(i=e._time),t=e,e=e._next):(n=e._next,e._next=null,e=t?t._next=n:Lh=n);pd=t,Mm(i)}function Mm(t){if(!Eu){hd&&(hd=clearTimeout(hd));var e=t-Cc;e>24?(t<1/0&&(hd=setTimeout(bv,t-Od.now()-op)),rd&&(rd=clearInterval(rd))):(rd||(Mh=Od.now(),rd=setInterval(R4,s5)),Eu=1,a5(bv))}}function wv(t,e,n){var i=new Th;return e=e==null?0:+e,i.restart(r=>{i.stop(),t(r+e)},e,n),i}var z4=sp("start","end","cancel","interrupt"),q4=[],l5=0,xv=1,Tm=2,ah=3,_v=4,Dm=5,oh=6;function lp(t,e,n,i,r,s){var a=t.__transition;if(!a)t.__transition={};else if(n in a)return;j4(t,n,{name:e,index:i,group:r,on:z4,tween:q4,time:s.time,delay:s.delay,duration:s.duration,ease:s.ease,timer:null,state:l5})}function M1(t,e){var n=Oa(t,e);if(n.state>l5)throw new Error("too late; already scheduled");return n}function go(t,e){var n=Oa(t,e);if(n.state>ah)throw new Error("too late; already running");return n}function Oa(t,e){var n=t.__transition;if(!n||!(n=n[e]))throw new Error("transition not found");return n}function j4(t,e,n){var i=t.__transition,r;i[e]=n,n.timer=o5(s,0,n.time);function s(c){n.state=xv,n.timer.restart(a,n.delay,n.time),n.delay<=c&&a(c-n.delay)}function a(c){var u,f,p,d;if(n.state!==xv)return l();for(u in i)if(d=i[u],d.name===n.name){if(d.state===ah)return wv(a);d.state===_v?(d.state=oh,d.timer.stop(),d.on.call("interrupt",t,t.__data__,d.index,d.group),delete i[u]):+u<e&&(d.state=oh,d.timer.stop(),d.on.call("cancel",t,t.__data__,d.index,d.group),delete i[u])}if(wv(function(){n.state===ah&&(n.state=_v,n.timer.restart(o,n.delay,n.time),o(c))}),n.state=Tm,n.on.call("start",t,t.__data__,n.index,n.group),n.state===Tm){for(n.state=ah,r=new Array(p=n.tween.length),u=0,f=-1;u<p;++u)(d=n.tween[u].value.call(t,t.__data__,n.index,n.group))&&(r[++f]=d);r.length=f+1}}function o(c){for(var u=c<n.duration?n.ease.call(null,c/n.duration):(n.timer.restart(l),n.state=Dm,1),f=-1,p=r.length;++f<p;)r[f].call(t,u);n.state===Dm&&(n.on.call("end",t,t.__data__,n.index,n.group),l())}function l(){n.state=oh,n.timer.stop(),delete i[e];for(var c in i)return;delete t.__transition}}function lh(t,e){var n=t.__transition,i,r,s=!0,a;if(n){e=e==null?null:e+"";for(a in n){if((i=n[a]).name!==e){s=!1;continue}r=i.state>Tm&&i.state<Dm,i.state=oh,i.timer.stop(),i.on.call(r?"interrupt":"cancel",t,t.__data__,i.index,i.group),delete n[a]}s&&delete t.__transition}}function H4(t){return this.each(function(){lh(this,t)})}function U4(t,e){var n,i;return function(){var r=go(this,t),s=r.tween;if(s!==n){i=n=s;for(var a=0,o=i.length;a<o;++a)if(i[a].name===e){i=i.slice(),i.splice(a,1);break}}r.tween=i}}function W4(t,e,n){var i,r;if(typeof n!="function")throw new Error;return function(){var s=go(this,t),a=s.tween;if(a!==i){r=(i=a).slice();for(var o={name:e,value:n},l=0,c=r.length;l<c;++l)if(r[l].name===e){r[l]=o;break}l===c&&r.push(o)}s.tween=r}}function V4(t,e){var n=this._id;if(t+="",arguments.length<2){for(var i=Oa(this.node(),n).tween,r=0,s=i.length,a;r<s;++r)if((a=i[r]).name===t)return a.value;return null}return this.each((e==null?U4:W4)(n,t,e))}function T1(t,e,n){var i=t._id;return t.each(function(){var r=go(this,i);(r.value||(r.value={}))[e]=n.apply(this,arguments)}),function(r){return Oa(r,i).value[e]}}function c5(t,e){var n;return(typeof e=="number"?ro:e instanceof Nc?Ih:(n=Nc(e))?(e=n,Ih):n5)(t,e)}function G4(t){return function(){this.removeAttribute(t)}}function X4(t){return function(){this.removeAttributeNS(t.space,t.local)}}function Y4(t,e,n){var i,r=n+"",s;return function(){var a=this.getAttribute(t);return a===r?null:a===i?s:s=e(i=a,n)}}function K4(t,e,n){var i,r=n+"",s;return function(){var a=this.getAttributeNS(t.space,t.local);return a===r?null:a===i?s:s=e(i=a,n)}}function Z4(t,e,n){var i,r,s;return function(){var a,o=n(this),l;return o==null?void this.removeAttribute(t):(a=this.getAttribute(t),l=o+"",a===l?null:a===i&&l===r?s:(r=l,s=e(i=a,o)))}}function J4(t,e,n){var i,r,s;return function(){var a,o=n(this),l;return o==null?void this.removeAttributeNS(t.space,t.local):(a=this.getAttributeNS(t.space,t.local),l=o+"",a===l?null:a===i&&l===r?s:(r=l,s=e(i=a,o)))}}function Q4(t,e){var n=ap(t),i=n==="transform"?L4:c5;return this.attrTween(t,typeof e=="function"?(n.local?J4:Z4)(n,i,T1(this,"attr."+t,e)):e==null?(n.local?X4:G4)(n):(n.local?K4:Y4)(n,i,e))}function $4(t,e){return function(n){this.setAttribute(t,e.call(this,n))}}function e6(t,e){return function(n){this.setAttributeNS(t.space,t.local,e.call(this,n))}}function t6(t,e){var n,i;function r(){var s=e.apply(this,arguments);return s!==i&&(n=(i=s)&&e6(t,s)),n}return r._value=e,r}function n6(t,e){var n,i;function r(){var s=e.apply(this,arguments);return s!==i&&(n=(i=s)&&$4(t,s)),n}return r._value=e,r}function i6(t,e){var n="attr."+t;if(arguments.length<2)return(n=this.tween(n))&&n._value;if(e==null)return this.tween(n,null);if(typeof e!="function")throw new Error;var i=ap(t);return this.tween(n,(i.local?t6:n6)(i,e))}function r6(t,e){return function(){M1(this,t).delay=+e.apply(this,arguments)}}function s6(t,e){return e=+e,function(){M1(this,t).delay=e}}function a6(t){var e=this._id;return arguments.length?this.each((typeof t=="function"?r6:s6)(e,t)):Oa(this.node(),e).delay}function o6(t,e){return function(){go(this,t).duration=+e.apply(this,arguments)}}function l6(t,e){return e=+e,function(){go(this,t).duration=e}}function c6(t){var e=this._id;return arguments.length?this.each((typeof t=="function"?o6:l6)(e,t)):Oa(this.node(),e).duration}function u6(t,e){if(typeof e!="function")throw new Error;return function(){go(this,t).ease=e}}function d6(t){var e=this._id;return arguments.length?this.each(u6(e,t)):Oa(this.node(),e).ease}function f6(t,e){return function(){var n=e.apply(this,arguments);if(typeof n!="function")throw new Error;go(this,t).ease=n}}function h6(t){if(typeof t!="function")throw new Error;return this.each(f6(this._id,t))}function p6(t){typeof t!="function"&&(t=qb(t));for(var e=this._groups,n=e.length,i=new Array(n),r=0;r<n;++r)for(var s=e[r],a=s.length,o=i[r]=[],l,c=0;c<a;++c)(l=s[c])&&t.call(l,l.__data__,c,s)&&o.push(l);return new ll(i,this._parents,this._name,this._id)}function g6(t){if(t._id!==this._id)throw new Error;for(var e=this._groups,n=t._groups,i=e.length,r=n.length,s=Math.min(i,r),a=new Array(i),o=0;o<s;++o)for(var l=e[o],c=n[o],u=l.length,f=a[o]=new Array(u),p,d=0;d<u;++d)(p=l[d]||c[d])&&(f[d]=p);for(;o<i;++o)a[o]=e[o];return new ll(a,this._parents,this._name,this._id)}function m6(t){return(t+"").trim().split(/^|\s+/).every(function(e){var n=e.indexOf(".");return n>=0&&(e=e.slice(0,n)),!e||e==="start"})}function v6(t,e,n){var i,r,s=m6(e)?M1:go;return function(){var a=s(this,t),o=a.on;o!==i&&(r=(i=o).copy()).on(e,n),a.on=r}}function y6(t,e){var n=this._id;return arguments.length<2?Oa(this.node(),n).on.on(t):this.each(v6(n,t,e))}function b6(t){return function(){var e=this.parentNode;for(var n in this.__transition)if(+n!==t)return;e&&e.removeChild(this)}}function w6(){return this.on("end.remove",b6(this._id))}function x6(t){var e=this._name,n=this._id;typeof t!="function"&&(t=C1(t));for(var i=this._groups,r=i.length,s=new Array(r),a=0;a<r;++a)for(var o=i[a],l=o.length,c=s[a]=new Array(l),u,f,p=0;p<l;++p)(u=o[p])&&(f=t.call(u,u.__data__,p,o))&&("__data__"in u&&(f.__data__=u.__data__),c[p]=f,lp(c[p],e,n,p,c,Oa(u,n)));return new ll(s,this._parents,e,n)}function _6(t){var e=this._name,n=this._id;typeof t!="function"&&(t=zb(t));for(var i=this._groups,r=i.length,s=[],a=[],o=0;o<r;++o)for(var l=i[o],c=l.length,u,f=0;f<c;++f)if(u=l[f]){for(var p=t.call(u,u.__data__,f,l),d,y=Oa(u,n),m=0,w=p.length;m<w;++m)(d=p[m])&&lp(d,e,n,m,p,y);s.push(p),a.push(u)}return new ll(s,a,e,n)}var S6=Gd.prototype.constructor;function k6(){return new S6(this._groups,this._parents)}function A6(t,e){var n,i,r;return function(){var s=Pu(this,t),a=(this.style.removeProperty(t),Pu(this,t));return s===a?null:s===n&&a===i?r:r=e(n=s,i=a)}}function u5(t){return function(){this.style.removeProperty(t)}}function N6(t,e,n){var i,r=n+"",s;return function(){var a=Pu(this,t);return a===r?null:a===i?s:s=e(i=a,n)}}function C6(t,e,n){var i,r,s;return function(){var a=Pu(this,t),o=n(this),l=o+"";return o==null&&(l=o=(this.style.removeProperty(t),Pu(this,t))),a===l?null:a===i&&l===r?s:(r=l,s=e(i=a,o))}}function P6(t,e){var n,i,r,s="style."+e,a="end."+s,o;return function(){var l=go(this,t),c=l.on,u=l.value[s]==null?o||(o=u5(e)):void 0;(c!==n||r!==u)&&(i=(n=c).copy()).on(a,r=u),l.on=i}}function E6(t,e,n){var i=(t+="")=="transform"?I4:c5;return e==null?this.styleTween(t,A6(t,i)).on("end.style."+t,u5(t)):typeof e=="function"?this.styleTween(t,C6(t,i,T1(this,"style."+t,e))).each(P6(this._id,t)):this.styleTween(t,N6(t,i,e),n).on("end.style."+t,null)}function I6(t,e,n){return function(i){this.style.setProperty(t,e.call(this,i),n)}}function L6(t,e,n){var i,r;function s(){var a=e.apply(this,arguments);return a!==r&&(i=(r=a)&&I6(t,a,n)),i}return s._value=e,s}function M6(t,e,n){var i="style."+(t+="");if(arguments.length<2)return(i=this.tween(i))&&i._value;if(e==null)return this.tween(i,null);if(typeof e!="function")throw new Error;return this.tween(i,L6(t,e,n??""))}function T6(t){return function(){this.textContent=t}}function D6(t){return function(){var e=t(this);this.textContent=e??""}}function O6(t){return this.tween("text",typeof t=="function"?D6(T1(this,"text",t)):T6(t==null?"":t+""))}function F6(t){return function(e){this.textContent=t.call(this,e)}}function R6(t){var e,n;function i(){var r=t.apply(this,arguments);return r!==n&&(e=(n=r)&&F6(r)),e}return i._value=t,i}function B6(t){var e="text";if(arguments.length<1)return(e=this.tween(e))&&e._value;if(t==null)return this.tween(e,null);if(typeof t!="function")throw new Error;return this.tween(e,R6(t))}function z6(){for(var t=this._name,e=this._id,n=d5(),i=this._groups,r=i.length,s=0;s<r;++s)for(var a=i[s],o=a.length,l,c=0;c<o;++c)if(l=a[c]){var u=Oa(l,e);lp(l,t,n,c,a,{time:u.time+u.delay+u.duration,delay:0,duration:u.duration,ease:u.ease})}return new ll(i,this._parents,t,n)}function q6(){var t,e,n=this,i=n._id,r=n.size();return new Promise(function(s,a){var o={value:a},l={value:function(){--r===0&&s()}};n.each(function(){var c=go(this,i),u=c.on;u!==t&&(e=(t=u).copy(),e._.cancel.push(o),e._.interrupt.push(o),e._.end.push(l)),c.on=e}),r===0&&s()})}var j6=0;function ll(t,e,n,i){this._groups=t,this._parents=e,this._name=n,this._id=i}function d5(){return++j6}var jo=Gd.prototype;ll.prototype={constructor:ll,select:x6,selectAll:_6,selectChild:jo.selectChild,selectChildren:jo.selectChildren,filter:p6,merge:g6,selection:k6,transition:z6,call:jo.call,nodes:jo.nodes,node:jo.node,size:jo.size,empty:jo.empty,each:jo.each,on:y6,attr:Q4,attrTween:i6,style:E6,styleTween:M6,text:O6,textTween:B6,remove:w6,tween:V4,delay:a6,duration:c6,ease:d6,easeVarying:h6,end:q6,[Symbol.iterator]:jo[Symbol.iterator]};function H6(t){return((t*=2)<=1?t*t*t:(t-=2)*t*t+2)/2}var U6={time:null,delay:0,duration:250,ease:H6};function W6(t,e){for(var n;!(n=t.__transition)||!(n=n[e]);)if(!(t=t.parentNode))throw new Error(`transition ${e} not found`);return n}function V6(t){var e,n;t instanceof ll?(e=t._id,t=t._name):(e=d5(),(n=U6).time=L1(),t=t==null?null:t+"");for(var i=this._groups,r=i.length,s=0;s<r;++s)for(var a=i[s],o=a.length,l,c=0;c<o;++c)(l=a[c])&&lp(l,t,e,c,a,n||W6(l,e));return new ll(i,this._parents,t,e)}Gd.prototype.interrupt=H4;Gd.prototype.transition=V6;const Mf=t=>()=>t;function G6(t,{sourceEvent:e,target:n,transform:i,dispatch:r}){Object.defineProperties(this,{type:{value:t,enumerable:!0,configurable:!0},sourceEvent:{value:e,enumerable:!0,configurable:!0},target:{value:n,enumerable:!0,configurable:!0},transform:{value:i,enumerable:!0,configurable:!0},_:{value:r}})}function $o(t,e,n){this.k=t,this.x=e,this.y=n}$o.prototype={constructor:$o,scale:function(t){return t===1?this:new $o(this.k*t,this.x,this.y)},translate:function(t,e){return t===0&e===0?this:new $o(this.k,this.x+this.k*t,this.y+this.k*e)},apply:function(t){return[t[0]*this.k+this.x,t[1]*this.k+this.y]},applyX:function(t){return t*this.k+this.x},applyY:function(t){return t*this.k+this.y},invert:function(t){return[(t[0]-this.x)/this.k,(t[1]-this.y)/this.k]},invertX:function(t){return(t-this.x)/this.k},invertY:function(t){return(t-this.y)/this.k},rescaleX:function(t){return t.copy().domain(t.range().map(this.invertX,this).map(t.invert,t))},rescaleY:function(t){return t.copy().domain(t.range().map(this.invertY,this).map(t.invert,t))},toString:function(){return"translate("+this.x+","+this.y+") scale("+this.k+")"}};var cp=new $o(1,0,0);f5.prototype=$o.prototype;function f5(t){for(;!t.__zoom;)if(!(t=t.parentNode))return cp;return t.__zoom}function yg(t){t.stopImmediatePropagation()}function sd(t){t.preventDefault(),t.stopImmediatePropagation()}function X6(t){return(!t.ctrlKey||t.type==="wheel")&&!t.button}function Y6(){var t=this;return t instanceof SVGElement?(t=t.ownerSVGElement||t,t.hasAttribute("viewBox")?(t=t.viewBox.baseVal,[[t.x,t.y],[t.x+t.width,t.y+t.height]]):[[0,0],[t.width.baseVal.value,t.height.baseVal.value]]):[[0,0],[t.clientWidth,t.clientHeight]]}function Sv(){return this.__zoom||cp}function K6(t){return-t.deltaY*(t.deltaMode===1?.05:t.deltaMode?1:.002)*(t.ctrlKey?10:1)}function Z6(){return navigator.maxTouchPoints||"ontouchstart"in this}function J6(t,e,n){var i=t.invertX(e[0][0])-n[0][0],r=t.invertX(e[1][0])-n[1][0],s=t.invertY(e[0][1])-n[0][1],a=t.invertY(e[1][1])-n[1][1];return t.translate(r>i?(i+r)/2:Math.min(0,i)||Math.max(0,r),a>s?(s+a)/2:Math.min(0,s)||Math.max(0,a))}function Q6(){var t=X6,e=Y6,n=J6,i=K6,r=Z6,s=[0,1/0],a=[[-1/0,-1/0],[1/0,1/0]],o=250,l=sh,c=sp("start","zoom","end"),u,f,p,d=500,y=150,m=0,w=10;function b(P){P.property("__zoom",Sv).on("wheel.zoom",T,{passive:!1}).on("mousedown.zoom",D).on("dblclick.zoom",U).filter(r).on("touchstart.zoom",C).on("touchmove.zoom",N).on("touchend.zoom touchcancel.zoom",B).style("-webkit-tap-highlight-color","rgba(0,0,0,0)")}b.transform=function(P,F,q,Z){var W=P.selection?P.selection():P;W.property("__zoom",Sv),P!==W?I(P,F,q,Z):W.interrupt().each(function(){E(this,arguments).event(Z).start().zoom(null,typeof F=="function"?F.apply(this,arguments):F).end()})},b.scaleBy=function(P,F,q,Z){b.scaleTo(P,function(){var W=this.__zoom.k,Y=typeof F=="function"?F.apply(this,arguments):F;return W*Y},q,Z)},b.scaleTo=function(P,F,q,Z){b.transform(P,function(){var W=e.apply(this,arguments),Y=this.__zoom,ue=q==null?_(W):typeof q=="function"?q.apply(this,arguments):q,le=Y.invert(ue),O=typeof F=="function"?F.apply(this,arguments):F;return n(A(S(Y,O),ue,le),W,a)},q,Z)},b.translateBy=function(P,F,q,Z){b.transform(P,function(){return n(this.__zoom.translate(typeof F=="function"?F.apply(this,arguments):F,typeof q=="function"?q.apply(this,arguments):q),e.apply(this,arguments),a)},null,Z)},b.translateTo=function(P,F,q,Z,W){b.transform(P,function(){var Y=e.apply(this,arguments),ue=this.__zoom,le=Z==null?_(Y):typeof Z=="function"?Z.apply(this,arguments):Z;return n(cp.translate(le[0],le[1]).scale(ue.k).translate(typeof F=="function"?-F.apply(this,arguments):-F,typeof q=="function"?-q.apply(this,arguments):-q),Y,a)},Z,W)};function S(P,F){return F=Math.max(s[0],Math.min(s[1],F)),F===P.k?P:new $o(F,P.x,P.y)}function A(P,F,q){var Z=F[0]-q[0]*P.k,W=F[1]-q[1]*P.k;return Z===P.x&&W===P.y?P:new $o(P.k,Z,W)}function _(P){return[(+P[0][0]+ +P[1][0])/2,(+P[0][1]+ +P[1][1])/2]}function I(P,F,q,Z){P.on("start.zoom",function(){E(this,arguments).event(Z).start()}).on("interrupt.zoom end.zoom",function(){E(this,arguments).event(Z).end()}).tween("zoom",function(){var W=this,Y=arguments,ue=E(W,Y).event(Z),le=e.apply(W,Y),O=q==null?_(le):typeof q=="function"?q.apply(W,Y):q,V=Math.max(le[1][0]-le[0][0],le[1][1]-le[0][1]),G=W.__zoom,re=typeof F=="function"?F.apply(W,Y):F,ae=l(G.invert(O).concat(V/G.k),re.invert(O).concat(V/re.k));return function(ee){if(ee===1)ee=re;else{var de=ae(ee),he=V/de[2];ee=new $o(he,O[0]-de[0]*he,O[1]-de[1]*he)}ue.zoom(null,ee)}})}function E(P,F,q){return!q&&P.__zooming||new M(P,F)}function M(P,F){this.that=P,this.args=F,this.active=0,this.sourceEvent=null,this.extent=e.apply(P,F),this.taps=0}M.prototype={event:function(P){return P&&(this.sourceEvent=P),this},start:function(){return++this.active===1&&(this.that.__zooming=this,this.emit("start")),this},zoom:function(P,F){return this.mouse&&P!=="mouse"&&(this.mouse[1]=F.invert(this.mouse[0])),this.touch0&&P!=="touch"&&(this.touch0[1]=F.invert(this.touch0[0])),this.touch1&&P!=="touch"&&(this.touch1[1]=F.invert(this.touch1[0])),this.that.__zoom=F,this.emit("zoom"),this},end:function(){return--this.active===0&&(delete this.that.__zooming,this.emit("end")),this},emit:function(P){var F=na(this.that).datum();c.call(P,this.that,new G6(P,{sourceEvent:this.sourceEvent,target:b,transform:this.that.__zoom,dispatch:c}),F)}};function T(P,...F){if(!t.apply(this,arguments))return;var q=E(this,F).event(P),Z=this.__zoom,W=Math.max(s[0],Math.min(s[1],Z.k*Math.pow(2,i.apply(this,arguments)))),Y=io(P);if(q.wheel)(q.mouse[0][0]!==Y[0]||q.mouse[0][1]!==Y[1])&&(q.mouse[1]=Z.invert(q.mouse[0]=Y)),clearTimeout(q.wheel);else{if(Z.k===W)return;q.mouse=[Y,Z.invert(Y)],lh(this),q.start()}sd(P),q.wheel=setTimeout(ue,y),q.zoom("mouse",n(A(S(Z,W),q.mouse[0],q.mouse[1]),q.extent,a));function ue(){q.wheel=null,q.end()}}function D(P,...F){if(p||!t.apply(this,arguments))return;var q=P.currentTarget,Z=E(this,F,!0).event(P),W=na(P.view).on("mousemove.zoom",O,!0).on("mouseup.zoom",V,!0),Y=io(P,q),ue=P.clientX,le=P.clientY;Zb(P.view),yg(P),Z.mouse=[Y,this.__zoom.invert(Y)],lh(this),Z.start();function O(G){if(sd(G),!Z.moved){var re=G.clientX-ue,ae=G.clientY-le;Z.moved=re*re+ae*ae>m}Z.event(G).zoom("mouse",n(A(Z.that.__zoom,Z.mouse[0]=io(G,q),Z.mouse[1]),Z.extent,a))}function V(G){W.on("mousemove.zoom mouseup.zoom",null),Jb(G.view,Z.moved),sd(G),Z.event(G).end()}}function U(P,...F){if(t.apply(this,arguments)){var q=this.__zoom,Z=io(P.changedTouches?P.changedTouches[0]:P,this),W=q.invert(Z),Y=q.k*(P.shiftKey?.5:2),ue=n(A(S(q,Y),Z,W),e.apply(this,F),a);sd(P),o>0?na(this).transition().duration(o).call(I,ue,Z,P):na(this).call(b.transform,ue,Z,P)}}function C(P,...F){if(t.apply(this,arguments)){var q=P.touches,Z=q.length,W=E(this,F,P.changedTouches.length===Z).event(P),Y,ue,le,O;for(yg(P),ue=0;ue<Z;++ue)le=q[ue],O=io(le,this),O=[O,this.__zoom.invert(O),le.identifier],W.touch0?!W.touch1&&W.touch0[2]!==O[2]&&(W.touch1=O,W.taps=0):(W.touch0=O,Y=!0,W.taps=1+!!u);u&&(u=clearTimeout(u)),Y&&(W.taps<2&&(f=O[0],u=setTimeout(function(){u=null},d)),lh(this),W.start())}}function N(P,...F){if(this.__zooming){var q=E(this,F).event(P),Z=P.changedTouches,W=Z.length,Y,ue,le,O;for(sd(P),Y=0;Y<W;++Y)ue=Z[Y],le=io(ue,this),q.touch0&&q.touch0[2]===ue.identifier?q.touch0[0]=le:q.touch1&&q.touch1[2]===ue.identifier&&(q.touch1[0]=le);if(ue=q.that.__zoom,q.touch1){var V=q.touch0[0],G=q.touch0[1],re=q.touch1[0],ae=q.touch1[1],ee=(ee=re[0]-V[0])*ee+(ee=re[1]-V[1])*ee,de=(de=ae[0]-G[0])*de+(de=ae[1]-G[1])*de;ue=S(ue,Math.sqrt(ee/de)),le=[(V[0]+re[0])/2,(V[1]+re[1])/2],O=[(G[0]+ae[0])/2,(G[1]+ae[1])/2]}else if(q.touch0)le=q.touch0[0],O=q.touch0[1];else return;q.zoom("touch",n(A(ue,le,O),q.extent,a))}}function B(P,...F){if(this.__zooming){var q=E(this,F).event(P),Z=P.changedTouches,W=Z.length,Y,ue;for(yg(P),p&&clearTimeout(p),p=setTimeout(function(){p=null},d),Y=0;Y<W;++Y)ue=Z[Y],q.touch0&&q.touch0[2]===ue.identifier?delete q.touch0:q.touch1&&q.touch1[2]===ue.identifier&&delete q.touch1;if(q.touch1&&!q.touch0&&(q.touch0=q.touch1,delete q.touch1),q.touch0)q.touch0[1]=this.__zoom.invert(q.touch0[0]);else if(q.end(),q.taps===2&&(ue=io(ue,this),Math.hypot(f[0]-ue[0],f[1]-ue[1])<w)){var le=na(this).on("dblclick.zoom");le&&le.apply(this,arguments)}}}return b.wheelDelta=function(P){return arguments.length?(i=typeof P=="function"?P:Mf(+P),b):i},b.filter=function(P){return arguments.length?(t=typeof P=="function"?P:Mf(!!P),b):t},b.touchable=function(P){return arguments.length?(r=typeof P=="function"?P:Mf(!!P),b):r},b.extent=function(P){return arguments.length?(e=typeof P=="function"?P:Mf([[+P[0][0],+P[0][1]],[+P[1][0],+P[1][1]]]),b):e},b.scaleExtent=function(P){return arguments.length?(s[0]=+P[0],s[1]=+P[1],b):[s[0],s[1]]},b.translateExtent=function(P){return arguments.length?(a[0][0]=+P[0][0],a[1][0]=+P[1][0],a[0][1]=+P[0][1],a[1][1]=+P[1][1],b):[[a[0][0],a[0][1]],[a[1][0],a[1][1]]]},b.constrain=function(P){return arguments.length?(n=P,b):n},b.duration=function(P){return arguments.length?(o=+P,b):o},b.interpolate=function(P){return arguments.length?(l=P,b):l},b.on=function(){var P=c.on.apply(c,arguments);return P===c?b:P},b.clickDistance=function(P){return arguments.length?(m=(P=+P)*P,b):Math.sqrt(m)},b.tapDistance=function(P){return arguments.length?(w=+P,b):w},b}const Fd={error001:()=>"[React Flow]: Seems like you have not used zustand provider as an ancestor. Help: https://reactflow.dev/error#001",error002:()=>"It looks like you've created a new nodeTypes or edgeTypes object. If this wasn't on purpose please define the nodeTypes/edgeTypes outside of the component or memoize them.",error003:t=>`Node type "${t}" not found. Using fallback type "default".`,error004:()=>"The React Flow parent container needs a width and a height to render the graph.",error005:()=>"Only child nodes can use a parent extent.",error006:()=>"Can't create edge. An edge needs a source and a target.",error007:t=>`The old edge with id=${t} does not exist.`,error009:t=>`Marker type "${t}" doesn't exist.`,error008:(t,{id:e,sourceHandle:n,targetHandle:i})=>`Couldn't create edge for ${t} handle id: "${t==="source"?n:i}", edge id: ${e}.`,error010:()=>"Handle: No node id found. Make sure to only use a Handle inside a custom Node.",error011:t=>`Edge type "${t}" not found. Using fallback type "default".`,error012:t=>`Node with id "${t}" does not exist, it may have been removed. This can happen when a node is deleted before the "onNodeClick" handler is called.`,error013:(t="react")=>`It seems that you haven't loaded the styles. Please import '@xyflow/${t}/dist/style.css' or base.css to make sure everything is working properly.`,error014:()=>"useNodeConnections: No node ID found. Call useNodeConnections inside a custom Node or provide a node ID.",error015:()=>"It seems that you are trying to drag a node that is not initialized. Please use onNodesChange as explained in the docs."},Om=[[Number.NEGATIVE_INFINITY,Number.NEGATIVE_INFINITY],[Number.POSITIVE_INFINITY,Number.POSITIVE_INFINITY]],h5=["Enter"," ","Escape"],$6={"node.a11yDescription.default":"Press enter or space to select a node. Press delete to remove it and escape to cancel.","node.a11yDescription.keyboardDisabled":"Press enter or space to select a node. You can then use the arrow keys to move the node around. Press delete to remove it and escape to cancel.","node.a11yDescription.ariaLiveMessage":({direction:t,x:e,y:n})=>`Moved selected node ${t}. New position, x: ${e}, y: ${n}`,"edge.a11yDescription.default":"Press enter or space to select an edge. You can then press delete to remove it or escape to cancel.","controls.ariaLabel":"Control Panel","controls.zoomIn.ariaLabel":"Zoom In","controls.zoomOut.ariaLabel":"Zoom Out","controls.fitView.ariaLabel":"Fit View","controls.interactive.ariaLabel":"Toggle Interactivity","minimap.ariaLabel":"Mini Map","handle.ariaLabel":"Handle"};var Iu;(function(t){t.Strict="strict",t.Loose="loose"})(Iu||(Iu={}));var yu;(function(t){t.Free="free",t.Vertical="vertical",t.Horizontal="horizontal"})(yu||(yu={}));var Dh;(function(t){t.Partial="partial",t.Full="full"})(Dh||(Dh={}));const Fm={inProgress:!1,isValid:null,from:null,fromHandle:null,fromPosition:null,fromNode:null,to:null,toHandle:null,toPosition:null,toNode:null,pointer:null};var jl;(function(t){t.Bezier="default",t.Straight="straight",t.Step="step",t.SmoothStep="smoothstep",t.SimpleBezier="simplebezier"})(jl||(jl={}));var Oh;(function(t){t.Arrow="arrow",t.ArrowClosed="arrowclosed"})(Oh||(Oh={}));var Kt;(function(t){t.Left="left",t.Top="top",t.Right="right",t.Bottom="bottom"})(Kt||(Kt={}));const kv={[Kt.Left]:Kt.Right,[Kt.Right]:Kt.Left,[Kt.Top]:Kt.Bottom,[Kt.Bottom]:Kt.Top};function eA(t,e){if(!t&&!e)return!0;if(!t||!e||t.size!==e.size)return!1;if(!t.size&&!e.size)return!0;for(const n of t.keys())if(!e.has(n))return!1;return!0}function Av(t,e,n){if(!n)return;const i=[];t.forEach((r,s)=>{e?.has(s)||i.push(r)}),i.length&&n(i)}function tA(t){return t===null?null:t?"valid":"invalid"}const p5=t=>"id"in t&&"source"in t&&"target"in t,nA=t=>"id"in t&&"position"in t&&!("source"in t)&&!("target"in t),D1=t=>"id"in t&&"internals"in t&&!("source"in t)&&!("target"in t),Yd=(t,e=[0,0])=>{const{width:n,height:i}=qc(t),r=t.origin??e,s=n*r[0],a=i*r[1];return{x:t.position.x-s,y:t.position.y-a}},iA=(t,e={nodeOrigin:[0,0]})=>{if(t.length===0)return{x:0,y:0,width:0,height:0};const n=t.reduce((i,r)=>{const s=typeof r=="string";let a=!e.nodeLookup&&!s?r:void 0;e.nodeLookup&&(a=s?e.nodeLookup.get(r):D1(r)?r:e.nodeLookup.get(r.id));const o=a?Fh(a,e.nodeOrigin):{x:0,y:0,x2:0,y2:0};return dp(i,o)},{x:1/0,y:1/0,x2:-1/0,y2:-1/0});return fp(n)},up=(t,e={})=>{let n={x:1/0,y:1/0,x2:-1/0,y2:-1/0},i=!1;return t.forEach(r=>{(e.filter===void 0||e.filter(r))&&(n=dp(n,Fh(r)),i=!0)}),i?fp(n):{x:0,y:0,width:0,height:0}},O1=(t,e,[n,i,r]=[0,0,1],s=!1,a=!1)=>{const o={...Zd(e,[n,i,r]),width:e.width/r,height:e.height/r},l=[];for(const c of t.values()){const{measured:u,selectable:f=!0,hidden:p=!1}=c;if(a&&!f||p)continue;const d=u.width??c.width??c.initialWidth??null,y=u.height??c.height??c.initialHeight??null,m=Rd(o,Mu(c)),w=(d??0)*(y??0),b=s&&m>0;(!c.internals.handleBounds||b||m>=w||c.dragging)&&l.push(c)}return l},rA=(t,e)=>{const n=new Set;return t.forEach(i=>{n.add(i.id)}),e.filter(i=>n.has(i.source)||n.has(i.target))};function sA(t,e){const n=new Map,i=e?.nodes?new Set(e.nodes.map(r=>r.id)):null;return t.forEach(r=>{r.measured.width&&r.measured.height&&(e?.includeHiddenNodes||!r.hidden)&&(!i||i.has(r.id))&&n.set(r.id,r)}),n}async function aA({nodes:t,width:e,height:n,panZoom:i,minZoom:r,maxZoom:s},a){if(t.size===0)return Promise.resolve(!0);const o=sA(t,a),l=up(o),c=F1(l,e,n,a?.minZoom??r,a?.maxZoom??s,a?.padding??.1);return await i.setViewport(c,{duration:a?.duration,ease:a?.ease,interpolate:a?.interpolate}),Promise.resolve(!0)}function g5({nodeId:t,nextPosition:e,nodeLookup:n,nodeOrigin:i=[0,0],nodeExtent:r,onError:s}){const a=n.get(t),o=a.parentId?n.get(a.parentId):void 0,{x:l,y:c}=o?o.internals.positionAbsolute:{x:0,y:0},u=a.origin??i;let f=a.extent||r;if(a.extent==="parent"&&!a.expandParent)if(!o)s?.("005",Fd.error005());else{const d=o.measured.width,y=o.measured.height;d&&y&&(f=[[l,c],[l+d,c+y]])}else o&&Tu(a.extent)&&(f=[[a.extent[0][0]+l,a.extent[0][1]+c],[a.extent[1][0]+l,a.extent[1][1]+c]]);const p=Tu(f)?Pc(e,f,a.measured):e;return(a.measured.width===void 0||a.measured.height===void 0)&&s?.("015",Fd.error015()),{position:{x:p.x-l+(a.measured.width??0)*u[0],y:p.y-c+(a.measured.height??0)*u[1]},positionAbsolute:p}}async function oA({nodesToRemove:t=[],edgesToRemove:e=[],nodes:n,edges:i,onBeforeDelete:r}){const s=new Set(t.map(p=>p.id)),a=[];for(const p of n){if(p.deletable===!1)continue;const d=s.has(p.id),y=!d&&p.parentId&&a.find(m=>m.id===p.parentId);(d||y)&&a.push(p)}const o=new Set(e.map(p=>p.id)),l=i.filter(p=>p.deletable!==!1),u=rA(a,l);for(const p of l)o.has(p.id)&&!u.find(y=>y.id===p.id)&&u.push(p);if(!r)return{edges:u,nodes:a};const f=await r({nodes:a,edges:u});return typeof f=="boolean"?f?{edges:u,nodes:a}:{edges:[],nodes:[]}:f}const Lu=(t,e=0,n=1)=>Math.min(Math.max(t,e),n),Pc=(t={x:0,y:0},e,n)=>({x:Lu(t.x,e[0][0],e[1][0]-(n?.width??0)),y:Lu(t.y,e[0][1],e[1][1]-(n?.height??0))});function m5(t,e,n){const{width:i,height:r}=qc(n),{x:s,y:a}=n.internals.positionAbsolute;return Pc(t,[[s,a],[s+i,a+r]],e)}const Nv=(t,e,n)=>t<e?Lu(Math.abs(t-e),1,e)/e:t>n?-Lu(Math.abs(t-n),1,e)/e:0,v5=(t,e,n=15,i=40)=>{const r=Nv(t.x,i,e.width-i)*n,s=Nv(t.y,i,e.height-i)*n;return[r,s]},dp=(t,e)=>({x:Math.min(t.x,e.x),y:Math.min(t.y,e.y),x2:Math.max(t.x2,e.x2),y2:Math.max(t.y2,e.y2)}),Rm=({x:t,y:e,width:n,height:i})=>({x:t,y:e,x2:t+n,y2:e+i}),fp=({x:t,y:e,x2:n,y2:i})=>({x:t,y:e,width:n-t,height:i-e}),Mu=(t,e=[0,0])=>{const{x:n,y:i}=D1(t)?t.internals.positionAbsolute:Yd(t,e);return{x:n,y:i,width:t.measured?.width??t.width??t.initialWidth??0,height:t.measured?.height??t.height??t.initialHeight??0}},Fh=(t,e=[0,0])=>{const{x:n,y:i}=D1(t)?t.internals.positionAbsolute:Yd(t,e);return{x:n,y:i,x2:n+(t.measured?.width??t.width??t.initialWidth??0),y2:i+(t.measured?.height??t.height??t.initialHeight??0)}},lA=(t,e)=>fp(dp(Rm(t),Rm(e))),Rd=(t,e)=>{const n=Math.max(0,Math.min(t.x+t.width,e.x+e.width)-Math.max(t.x,e.x)),i=Math.max(0,Math.min(t.y+t.height,e.y+e.height)-Math.max(t.y,e.y));return Math.ceil(n*i)},Cv=t=>el(t.width)&&el(t.height)&&el(t.x)&&el(t.y),el=t=>!isNaN(t)&&isFinite(t),cA=(t,e)=>{},Kd=(t,e=[1,1])=>({x:e[0]*Math.round(t.x/e[0]),y:e[1]*Math.round(t.y/e[1])}),Zd=({x:t,y:e},[n,i,r],s=!1,a=[1,1])=>{const o={x:(t-n)/r,y:(e-i)/r};return s?Kd(o,a):o},Rh=({x:t,y:e},[n,i,r])=>({x:t*r+n,y:e*r+i});function eu(t,e){if(typeof t=="number")return Math.floor((e-e/(1+t))*.5);if(typeof t=="string"&&t.endsWith("px")){const n=parseFloat(t);if(!Number.isNaN(n))return Math.floor(n)}if(typeof t=="string"&&t.endsWith("%")){const n=parseFloat(t);if(!Number.isNaN(n))return Math.floor(e*n*.01)}return console.error(`[React Flow] The padding value "${t}" is invalid. Please provide a number or a string with a valid unit (px or %).`),0}function uA(t,e,n){if(typeof t=="string"||typeof t=="number"){const i=eu(t,n),r=eu(t,e);return{top:i,right:r,bottom:i,left:r,x:r*2,y:i*2}}if(typeof t=="object"){const i=eu(t.top??t.y??0,n),r=eu(t.bottom??t.y??0,n),s=eu(t.left??t.x??0,e),a=eu(t.right??t.x??0,e);return{top:i,right:a,bottom:r,left:s,x:s+a,y:i+r}}return{top:0,right:0,bottom:0,left:0,x:0,y:0}}function dA(t,e,n,i,r,s){const{x:a,y:o}=Rh(t,[e,n,i]),{x:l,y:c}=Rh({x:t.x+t.width,y:t.y+t.height},[e,n,i]),u=r-l,f=s-c;return{left:Math.floor(a),top:Math.floor(o),right:Math.floor(u),bottom:Math.floor(f)}}const F1=(t,e,n,i,r,s)=>{const a=uA(s,e,n),o=(e-a.x)/t.width,l=(n-a.y)/t.height,c=Math.min(o,l),u=Lu(c,i,r),f=t.x+t.width/2,p=t.y+t.height/2,d=e/2-f*u,y=n/2-p*u,m=dA(t,d,y,u,e,n),w={left:Math.min(m.left-a.left,0),top:Math.min(m.top-a.top,0),right:Math.min(m.right-a.right,0),bottom:Math.min(m.bottom-a.bottom,0)};return{x:d-w.left+w.right,y:y-w.top+w.bottom,zoom:u}},Bh=()=>typeof navigator<"u"&&navigator?.userAgent?.indexOf("Mac")>=0;function Tu(t){return t!=null&&t!=="parent"}function qc(t){return{width:t.measured?.width??t.width??t.initialWidth??0,height:t.measured?.height??t.height??t.initialHeight??0}}function fA(t){return(t.measured?.width??t.width??t.initialWidth)!==void 0&&(t.measured?.height??t.height??t.initialHeight)!==void 0}function hA(t,e={width:0,height:0},n,i,r){const s={...t},a=i.get(n);if(a){const o=a.origin||r;s.x+=a.internals.positionAbsolute.x-(e.width??0)*o[0],s.y+=a.internals.positionAbsolute.y-(e.height??0)*o[1]}return s}function pA(t){return{...$6,...t||{}}}function kd(t,{snapGrid:e=[0,0],snapToGrid:n=!1,transform:i,containerBounds:r}){const{x:s,y:a}=Ea(t),o=Zd({x:s-(r?.left??0),y:a-(r?.top??0)},i),{x:l,y:c}=n?Kd(o,e):o;return{xSnapped:l,ySnapped:c,...o}}const y5=t=>({width:t.offsetWidth,height:t.offsetHeight}),b5=t=>t?.getRootNode?.()||window?.document,gA=["INPUT","SELECT","TEXTAREA"];function w5(t){const e=t.composedPath?.()?.[0]||t.target;return e?.nodeType!==1?!1:gA.includes(e.nodeName)||e.hasAttribute("contenteditable")||!!e.closest(".nokey")}const x5=t=>"clientX"in t,Ea=(t,e)=>{const n=x5(t),i=n?t.clientX:t.touches?.[0].clientX,r=n?t.clientY:t.touches?.[0].clientY;return{x:i-(e?.left??0),y:r-(e?.top??0)}},Pv=(t,e,n,i,r)=>{const s=e.querySelectorAll(`.${t}`);return!s||!s.length?null:Array.from(s).map(a=>{const o=a.getBoundingClientRect();return{id:a.getAttribute("data-handleid"),type:t,nodeId:r,position:a.getAttribute("data-handlepos"),x:(o.left-n.left)/i,y:(o.top-n.top)/i,...y5(a)}})};function mA({sourceX:t,sourceY:e,targetX:n,targetY:i,sourceControlX:r,sourceControlY:s,targetControlX:a,targetControlY:o}){const l=t*.125+r*.375+a*.375+n*.125,c=e*.125+s*.375+o*.375+i*.125,u=Math.abs(l-t),f=Math.abs(c-e);return[l,c,u,f]}function Tf(t,e){return t>=0?.5*t:e*25*Math.sqrt(-t)}function Ev({pos:t,x1:e,y1:n,x2:i,y2:r,c:s}){switch(t){case Kt.Left:return[e-Tf(e-i,s),n];case Kt.Right:return[e+Tf(i-e,s),n];case Kt.Top:return[e,n-Tf(n-r,s)];case Kt.Bottom:return[e,n+Tf(r-n,s)]}}function _5({sourceX:t,sourceY:e,sourcePosition:n=Kt.Bottom,targetX:i,targetY:r,targetPosition:s=Kt.Top,curvature:a=.25}){const[o,l]=Ev({pos:n,x1:t,y1:e,x2:i,y2:r,c:a}),[c,u]=Ev({pos:s,x1:i,y1:r,x2:t,y2:e,c:a}),[f,p,d,y]=mA({sourceX:t,sourceY:e,targetX:i,targetY:r,sourceControlX:o,sourceControlY:l,targetControlX:c,targetControlY:u});return[`M${t},${e} C${o},${l} ${c},${u} ${i},${r}`,f,p,d,y]}function S5({sourceX:t,sourceY:e,targetX:n,targetY:i}){const r=Math.abs(n-t)/2,s=n<t?n+r:n-r,a=Math.abs(i-e)/2,o=i<e?i+a:i-a;return[s,o,r,a]}function vA({sourceNode:t,targetNode:e,selected:n=!1,zIndex:i=0,elevateOnSelect:r=!1,zIndexMode:s="basic"}){if(s==="manual")return i;const a=r&&n?i+1e3:i,o=Math.max(t.parentId||r&&t.selected?t.internals.z:0,e.parentId||r&&e.selected?e.internals.z:0);return a+o}function yA({sourceNode:t,targetNode:e,width:n,height:i,transform:r}){const s=dp(Fh(t),Fh(e));s.x===s.x2&&(s.x2+=1),s.y===s.y2&&(s.y2+=1);const a={x:-r[0]/r[2],y:-r[1]/r[2],width:n/r[2],height:i/r[2]};return Rd(a,fp(s))>0}const bA=({source:t,sourceHandle:e,target:n,targetHandle:i})=>`xy-edge__${t}${e||""}-${n}${i||""}`,wA=(t,e)=>e.some(n=>n.source===t.source&&n.target===t.target&&(n.sourceHandle===t.sourceHandle||!n.sourceHandle&&!t.sourceHandle)&&(n.targetHandle===t.targetHandle||!n.targetHandle&&!t.targetHandle)),xA=(t,e,n={})=>{if(!t.source||!t.target)return e;const i=n.getEdgeId||bA;let r;return p5(t)?r={...t}:r={...t,id:i(t)},wA(r,e)?e:(r.sourceHandle===null&&delete r.sourceHandle,r.targetHandle===null&&delete r.targetHandle,e.concat(r))};function k5({sourceX:t,sourceY:e,targetX:n,targetY:i}){const[r,s,a,o]=S5({sourceX:t,sourceY:e,targetX:n,targetY:i});return[`M ${t},${e}L ${n},${i}`,r,s,a,o]}const Iv={[Kt.Left]:{x:-1,y:0},[Kt.Right]:{x:1,y:0},[Kt.Top]:{x:0,y:-1},[Kt.Bottom]:{x:0,y:1}},_A=({source:t,sourcePosition:e=Kt.Bottom,target:n})=>e===Kt.Left||e===Kt.Right?t.x<n.x?{x:1,y:0}:{x:-1,y:0}:t.y<n.y?{x:0,y:1}:{x:0,y:-1},Lv=(t,e)=>Math.sqrt(Math.pow(e.x-t.x,2)+Math.pow(e.y-t.y,2));function SA({source:t,sourcePosition:e=Kt.Bottom,target:n,targetPosition:i=Kt.Top,center:r,offset:s,stepPosition:a}){const o=Iv[e],l=Iv[i],c={x:t.x+o.x*s,y:t.y+o.y*s},u={x:n.x+l.x*s,y:n.y+l.y*s},f=_A({source:c,sourcePosition:e,target:u}),p=f.x!==0?"x":"y",d=f[p];let y=[],m,w;const b={x:0,y:0},S={x:0,y:0},[,,A,_]=S5({sourceX:t.x,sourceY:t.y,targetX:n.x,targetY:n.y});if(o[p]*l[p]===-1){p==="x"?(m=r.x??c.x+(u.x-c.x)*a,w=r.y??(c.y+u.y)/2):(m=r.x??(c.x+u.x)/2,w=r.y??c.y+(u.y-c.y)*a);const E=[{x:m,y:c.y},{x:m,y:u.y}],M=[{x:c.x,y:w},{x:u.x,y:w}];o[p]===d?y=p==="x"?E:M:y=p==="x"?M:E}else{const E=[{x:c.x,y:u.y}],M=[{x:u.x,y:c.y}];if(p==="x"?y=o.x===d?M:E:y=o.y===d?E:M,e===i){const N=Math.abs(t[p]-n[p]);if(N<=s){const B=Math.min(s-1,s-N);o[p]===d?b[p]=(c[p]>t[p]?-1:1)*B:S[p]=(u[p]>n[p]?-1:1)*B}}if(e!==i){const N=p==="x"?"y":"x",B=o[p]===l[N],P=c[N]>u[N],F=c[N]<u[N];(o[p]===1&&(!B&&P||B&&F)||o[p]!==1&&(!B&&F||B&&P))&&(y=p==="x"?E:M)}const T={x:c.x+b.x,y:c.y+b.y},D={x:u.x+S.x,y:u.y+S.y},U=Math.max(Math.abs(T.x-y[0].x),Math.abs(D.x-y[0].x)),C=Math.max(Math.abs(T.y-y[0].y),Math.abs(D.y-y[0].y));U>=C?(m=(T.x+D.x)/2,w=y[0].y):(m=y[0].x,w=(T.y+D.y)/2)}return[[t,{x:c.x+b.x,y:c.y+b.y},...y,{x:u.x+S.x,y:u.y+S.y},n],m,w,A,_]}function kA(t,e,n,i){const r=Math.min(Lv(t,e)/2,Lv(e,n)/2,i),{x:s,y:a}=e;if(t.x===s&&s===n.x||t.y===a&&a===n.y)return`L${s} ${a}`;if(t.y===a){const c=t.x<n.x?-1:1,u=t.y<n.y?1:-1;return`L ${s+r*c},${a}Q ${s},${a} ${s},${a+r*u}`}const o=t.x<n.x?1:-1,l=t.y<n.y?-1:1;return`L ${s},${a+r*l}Q ${s},${a} ${s+r*o},${a}`}function hp({sourceX:t,sourceY:e,sourcePosition:n=Kt.Bottom,targetX:i,targetY:r,targetPosition:s=Kt.Top,borderRadius:a=5,centerX:o,centerY:l,offset:c=20,stepPosition:u=.5}){const[f,p,d,y,m]=SA({source:{x:t,y:e},sourcePosition:n,target:{x:i,y:r},targetPosition:s,center:{x:o,y:l},offset:c,stepPosition:u});return[f.reduce((b,S,A)=>{let _="";return A>0&&A<f.length-1?_=kA(f[A-1],S,f[A+1],a):_=`${A===0?"M":"L"}${S.x} ${S.y}`,b+=_,b},""),p,d,y,m]}function Mv(t){return t&&!!(t.internals.handleBounds||t.handles?.length)&&!!(t.measured.width||t.width||t.initialWidth)}function AA(t){const{sourceNode:e,targetNode:n}=t;if(!Mv(e)||!Mv(n))return null;const i=e.internals.handleBounds||Tv(e.handles),r=n.internals.handleBounds||Tv(n.handles),s=Dv(i?.source??[],t.sourceHandle),a=Dv(t.connectionMode===Iu.Strict?r?.target??[]:(r?.target??[]).concat(r?.source??[]),t.targetHandle);if(!s||!a)return t.onError?.("008",Fd.error008(s?"target":"source",{id:t.id,sourceHandle:t.sourceHandle,targetHandle:t.targetHandle})),null;const o=s?.position||Kt.Bottom,l=a?.position||Kt.Top,c=Ec(e,s,o),u=Ec(n,a,l);return{sourceX:c.x,sourceY:c.y,targetX:u.x,targetY:u.y,sourcePosition:o,targetPosition:l}}function Tv(t){if(!t)return null;const e=[],n=[];for(const i of t)i.width=i.width??1,i.height=i.height??1,i.type==="source"?e.push(i):i.type==="target"&&n.push(i);return{source:e,target:n}}function Ec(t,e,n=Kt.Left,i=!1){const r=(e?.x??0)+t.internals.positionAbsolute.x,s=(e?.y??0)+t.internals.positionAbsolute.y,{width:a,height:o}=e??qc(t);if(i)return{x:r+a/2,y:s+o/2};switch(e?.position??n){case Kt.Top:return{x:r+a/2,y:s};case Kt.Right:return{x:r+a,y:s+o/2};case Kt.Bottom:return{x:r+a/2,y:s+o};case Kt.Left:return{x:r,y:s+o/2}}}function Dv(t,e){return t&&(e?t.find(n=>n.id===e):t[0])||null}function Bm(t,e){return t?typeof t=="string"?t:`${e?`${e}__`:""}${Object.keys(t).sort().map(i=>`${i}=${t[i]}`).join("&")}`:""}function NA(t,{id:e,defaultColor:n,defaultMarkerStart:i,defaultMarkerEnd:r}){const s=new Set;return t.reduce((a,o)=>([o.markerStart||i,o.markerEnd||r].forEach(l=>{if(l&&typeof l=="object"){const c=Bm(l,e);s.has(c)||(a.push({id:c,color:l.color||n,...l}),s.add(c))}}),a),[]).sort((a,o)=>a.id.localeCompare(o.id))}const A5=1e3,CA=10,R1={nodeOrigin:[0,0],nodeExtent:Om,elevateNodesOnSelect:!0,zIndexMode:"basic",defaults:{}},PA={...R1,checkEquality:!0};function B1(t,e){const n={...t};for(const i in e)e[i]!==void 0&&(n[i]=e[i]);return n}function EA(t,e,n){const i=B1(R1,n);for(const r of t.values())if(r.parentId)q1(r,t,e,i);else{const s=Yd(r,i.nodeOrigin),a=Tu(r.extent)?r.extent:i.nodeExtent,o=Pc(s,a,qc(r));r.internals.positionAbsolute=o}}function IA(t,e){if(!t.handles)return t.measured?e?.internals.handleBounds:void 0;const n=[],i=[];for(const r of t.handles){const s={id:r.id,width:r.width??1,height:r.height??1,nodeId:t.id,x:r.x,y:r.y,position:r.position,type:r.type};r.type==="source"?n.push(s):r.type==="target"&&i.push(s)}return{source:n,target:i}}function z1(t){return t==="manual"}function LA(t,e,n,i={}){const r=B1(PA,i),s={i:0},a=new Map(e),o=r?.elevateNodesOnSelect&&!z1(r.zIndexMode)?A5:0;let l=t.length>0;e.clear(),n.clear();for(const c of t){let u=a.get(c.id);if(r.checkEquality&&c===u?.internals.userNode)e.set(c.id,u);else{const f=Yd(c,r.nodeOrigin),p=Tu(c.extent)?c.extent:r.nodeExtent,d=Pc(f,p,qc(c));u={...r.defaults,...c,measured:{width:c.measured?.width,height:c.measured?.height},internals:{positionAbsolute:d,handleBounds:IA(c,u),z:N5(c,o,r.zIndexMode),userNode:c}},e.set(c.id,u)}(u.measured===void 0||u.measured.width===void 0||u.measured.height===void 0)&&!u.hidden&&(l=!1),c.parentId&&q1(u,e,n,i,s)}return l}function MA(t,e){if(!t.parentId)return;const n=e.get(t.parentId);n?n.set(t.id,t):e.set(t.parentId,new Map([[t.id,t]]))}function q1(t,e,n,i,r){const{elevateNodesOnSelect:s,nodeOrigin:a,nodeExtent:o,zIndexMode:l}=B1(R1,i),c=t.parentId,u=e.get(c);if(!u){console.warn(`Parent node ${c} not found. Please make sure that parent nodes are in front of their child nodes in the nodes array.`);return}MA(t,n),r&&!u.parentId&&u.internals.rootParentIndex===void 0&&l==="auto"&&(u.internals.rootParentIndex=++r.i,u.internals.z=u.internals.z+r.i*CA),r&&u.internals.rootParentIndex!==void 0&&(r.i=u.internals.rootParentIndex);const f=s&&!z1(l)?A5:0,{x:p,y:d,z:y}=TA(t,u,a,o,f,l),{positionAbsolute:m}=t.internals,w=p!==m.x||d!==m.y;(w||y!==t.internals.z)&&e.set(t.id,{...t,internals:{...t.internals,positionAbsolute:w?{x:p,y:d}:m,z:y}})}function N5(t,e,n){const i=el(t.zIndex)?t.zIndex:0;return z1(n)?i:i+(t.selected?e:0)}function TA(t,e,n,i,r,s){const{x:a,y:o}=e.internals.positionAbsolute,l=qc(t),c=Yd(t,n),u=Tu(t.extent)?Pc(c,t.extent,l):c;let f=Pc({x:a+u.x,y:o+u.y},i,l);t.extent==="parent"&&(f=m5(f,l,e));const p=N5(t,r,s),d=e.internals.z??0;return{x:f.x,y:f.y,z:d>=p?d+1:p}}function DA(t,e,n,i=[0,0]){const r=[],s=new Map;for(const a of t){const o=e.get(a.parentId);if(!o)continue;const l=s.get(a.parentId)?.expandedRect??Mu(o),c=lA(l,a.rect);s.set(a.parentId,{expandedRect:c,parent:o})}return s.size>0&&s.forEach(({expandedRect:a,parent:o},l)=>{const c=o.internals.positionAbsolute,u=qc(o),f=o.origin??i,p=a.x<c.x?Math.round(Math.abs(c.x-a.x)):0,d=a.y<c.y?Math.round(Math.abs(c.y-a.y)):0,y=Math.max(u.width,Math.round(a.width)),m=Math.max(u.height,Math.round(a.height)),w=(y-u.width)*f[0],b=(m-u.height)*f[1];(p>0||d>0||w||b)&&(r.push({id:l,type:"position",position:{x:o.position.x-p+w,y:o.position.y-d+b}}),n.get(l)?.forEach(S=>{t.some(A=>A.id===S.id)||r.push({id:S.id,type:"position",position:{x:S.position.x+p,y:S.position.y+d}})})),(u.width<a.width||u.height<a.height||p||d)&&r.push({id:l,type:"dimensions",setAttributes:!0,dimensions:{width:y+(p?f[0]*p-w:0),height:m+(d?f[1]*d-b:0)}})}),r}function OA(t,e,n,i,r,s,a){const o=i?.querySelector(".xyflow__viewport");let l=!1;if(!o)return{changes:[],updatedInternals:l};const c=[],u=window.getComputedStyle(o),{m22:f}=new window.DOMMatrixReadOnly(u.transform),p=[];for(const d of t.values()){const y=e.get(d.id);if(!y)continue;if(y.hidden){e.set(y.id,{...y,internals:{...y.internals,handleBounds:void 0}}),l=!0;continue}const m=y5(d.nodeElement),w=y.measured.width!==m.width||y.measured.height!==m.height;if(!!(m.width&&m.height&&(w||!y.internals.handleBounds||d.force))){const S=d.nodeElement.getBoundingClientRect(),A=Tu(y.extent)?y.extent:s;let{positionAbsolute:_}=y.internals;y.parentId&&y.extent==="parent"?_=m5(_,m,e.get(y.parentId)):A&&(_=Pc(_,A,m));const I={...y,measured:m,internals:{...y.internals,positionAbsolute:_,handleBounds:{source:Pv("source",d.nodeElement,S,f,y.id),target:Pv("target",d.nodeElement,S,f,y.id)}}};e.set(y.id,I),y.parentId&&q1(I,e,n,{nodeOrigin:r,zIndexMode:a}),l=!0,w&&(c.push({id:y.id,type:"dimensions",dimensions:m}),y.expandParent&&y.parentId&&p.push({id:y.id,parentId:y.parentId,rect:Mu(I,r)}))}}if(p.length>0){const d=DA(p,e,n,r);c.push(...d)}return{changes:c,updatedInternals:l}}async function FA({delta:t,panZoom:e,transform:n,translateExtent:i,width:r,height:s}){if(!e||!t.x&&!t.y)return Promise.resolve(!1);const a=await e.setViewportConstrained({x:n[0]+t.x,y:n[1]+t.y,zoom:n[2]},[[0,0],[r,s]],i),o=!!a&&(a.x!==n[0]||a.y!==n[1]||a.k!==n[2]);return Promise.resolve(o)}function Ov(t,e,n,i,r,s){let a=r;const o=i.get(a)||new Map;i.set(a,o.set(n,e)),a=`${r}-${t}`;const l=i.get(a)||new Map;if(i.set(a,l.set(n,e)),s){a=`${r}-${t}-${s}`;const c=i.get(a)||new Map;i.set(a,c.set(n,e))}}function RA(t,e,n){t.clear(),e.clear();for(const i of n){const{source:r,target:s,sourceHandle:a=null,targetHandle:o=null}=i,l={edgeId:i.id,source:r,target:s,sourceHandle:a,targetHandle:o},c=`${r}-${a}--${s}-${o}`,u=`${s}-${o}--${r}-${a}`;Ov("source",l,u,t,r,a),Ov("target",l,c,t,s,o),e.set(i.id,i)}}function C5(t,e){if(!t.parentId)return!1;const n=e.get(t.parentId);return n?n.selected?!0:C5(n,e):!1}function Fv(t,e,n){let i=t;do{if(i?.matches?.(e))return!0;if(i===n)return!1;i=i?.parentElement}while(i);return!1}function BA(t,e,n,i){const r=new Map;for(const[s,a]of t)if((a.selected||a.id===i)&&(!a.parentId||!C5(a,t))&&(a.draggable||e&&typeof a.draggable>"u")){const o=t.get(s);o&&r.set(s,{id:s,position:o.position||{x:0,y:0},distance:{x:n.x-o.internals.positionAbsolute.x,y:n.y-o.internals.positionAbsolute.y},extent:o.extent,parentId:o.parentId,origin:o.origin,expandParent:o.expandParent,internals:{positionAbsolute:o.internals.positionAbsolute||{x:0,y:0}},measured:{width:o.measured.width??0,height:o.measured.height??0}})}return r}function bg({nodeId:t,dragItems:e,nodeLookup:n,dragging:i=!0}){const r=[];for(const[a,o]of e){const l=n.get(a)?.internals.userNode;l&&r.push({...l,position:o.position,dragging:i})}if(!t)return[r[0],r];const s=n.get(t)?.internals.userNode;return[s?{...s,position:e.get(t)?.position||s.position,dragging:i}:r[0],r]}function zA({dragItems:t,snapGrid:e,x:n,y:i}){const r=t.values().next().value;if(!r)return null;const s={x:n-r.distance.x,y:i-r.distance.y},a=Kd(s,e);return{x:a.x-s.x,y:a.y-s.y}}function qA({onNodeMouseDown:t,getStoreItems:e,onDragStart:n,onDrag:i,onDragStop:r}){let s={x:null,y:null},a=0,o=new Map,l=!1,c={x:0,y:0},u=null,f=!1,p=null,d=!1,y=!1,m=null;function w({noDragClassName:S,handleSelector:A,domNode:_,isSelectable:I,nodeId:E,nodeClickDistance:M=0}){p=na(_);function T({x:N,y:B}){const{nodeLookup:P,nodeExtent:F,snapGrid:q,snapToGrid:Z,nodeOrigin:W,onNodeDrag:Y,onSelectionDrag:ue,onError:le,updateNodePositions:O}=e();s={x:N,y:B};let V=!1;const G=o.size>1,re=G&&F?Rm(up(o)):null,ae=G&&Z?zA({dragItems:o,snapGrid:q,x:N,y:B}):null;for(const[ee,de]of o){if(!P.has(ee))continue;let he={x:N-de.distance.x,y:B-de.distance.y};Z&&(he=ae?{x:Math.round(he.x+ae.x),y:Math.round(he.y+ae.y)}:Kd(he,q));let pe=null;if(G&&F&&!de.extent&&re){const{positionAbsolute:Ae}=de.internals,Ye=Ae.x-re.x+F[0][0],K=Ae.x+de.measured.width-re.x2+F[1][0],Re=Ae.y-re.y+F[0][1],Qe=Ae.y+de.measured.height-re.y2+F[1][1];pe=[[Ye,Re],[K,Qe]]}const{position:ge,positionAbsolute:Ee}=g5({nodeId:ee,nextPosition:he,nodeLookup:P,nodeExtent:pe||F,nodeOrigin:W,onError:le});V=V||de.position.x!==ge.x||de.position.y!==ge.y,de.position=ge,de.internals.positionAbsolute=Ee}if(y=y||V,!!V&&(O(o,!0),m&&(i||Y||!E&&ue))){const[ee,de]=bg({nodeId:E,dragItems:o,nodeLookup:P});i?.(m,o,ee,de),Y?.(m,ee,de),E||ue?.(m,de)}}async function D(){if(!u)return;const{transform:N,panBy:B,autoPanSpeed:P,autoPanOnNodeDrag:F}=e();if(!F){l=!1,cancelAnimationFrame(a);return}const[q,Z]=v5(c,u,P);(q!==0||Z!==0)&&(s.x=(s.x??0)-q/N[2],s.y=(s.y??0)-Z/N[2],await B({x:q,y:Z})&&T(s)),a=requestAnimationFrame(D)}function U(N){const{nodeLookup:B,multiSelectionActive:P,nodesDraggable:F,transform:q,snapGrid:Z,snapToGrid:W,selectNodesOnDrag:Y,onNodeDragStart:ue,onSelectionDragStart:le,unselectNodesAndEdges:O}=e();f=!0,(!Y||!I)&&!P&&E&&(B.get(E)?.selected||O()),I&&Y&&E&&t?.(E);const V=kd(N.sourceEvent,{transform:q,snapGrid:Z,snapToGrid:W,containerBounds:u});if(s=V,o=BA(B,F,V,E),o.size>0&&(n||ue||!E&&le)){const[G,re]=bg({nodeId:E,dragItems:o,nodeLookup:B});n?.(N.sourceEvent,o,G,re),ue?.(N.sourceEvent,G,re),E||le?.(N.sourceEvent,re)}}const C=Qb().clickDistance(M).on("start",N=>{const{domNode:B,nodeDragThreshold:P,transform:F,snapGrid:q,snapToGrid:Z}=e();u=B?.getBoundingClientRect()||null,d=!1,y=!1,m=N.sourceEvent,P===0&&U(N),s=kd(N.sourceEvent,{transform:F,snapGrid:q,snapToGrid:Z,containerBounds:u}),c=Ea(N.sourceEvent,u)}).on("drag",N=>{const{autoPanOnNodeDrag:B,transform:P,snapGrid:F,snapToGrid:q,nodeDragThreshold:Z,nodeLookup:W}=e(),Y=kd(N.sourceEvent,{transform:P,snapGrid:F,snapToGrid:q,containerBounds:u});if(m=N.sourceEvent,(N.sourceEvent.type==="touchmove"&&N.sourceEvent.touches.length>1||E&&!W.has(E))&&(d=!0),!d){if(!l&&B&&f&&(l=!0,D()),!f){const ue=Ea(N.sourceEvent,u),le=ue.x-c.x,O=ue.y-c.y;Math.sqrt(le*le+O*O)>Z&&U(N)}(s.x!==Y.xSnapped||s.y!==Y.ySnapped)&&o&&f&&(c=Ea(N.sourceEvent,u),T(Y))}}).on("end",N=>{if(!(!f||d)&&(l=!1,f=!1,cancelAnimationFrame(a),o.size>0)){const{nodeLookup:B,updateNodePositions:P,onNodeDragStop:F,onSelectionDragStop:q}=e();if(y&&(P(o,!1),y=!1),r||F||!E&&q){const[Z,W]=bg({nodeId:E,dragItems:o,nodeLookup:B,dragging:!1});r?.(N.sourceEvent,o,Z,W),F?.(N.sourceEvent,Z,W),E||q?.(N.sourceEvent,W)}}}).filter(N=>{const B=N.target;return!N.button&&(!S||!Fv(B,`.${S}`,_))&&(!A||Fv(B,A,_))});p.call(C)}function b(){p?.on(".drag",null)}return{update:w,destroy:b}}function jA(t,e,n){const i=[],r={x:t.x-n,y:t.y-n,width:n*2,height:n*2};for(const s of e.values())Rd(r,Mu(s))>0&&i.push(s);return i}const HA=250;function UA(t,e,n,i){let r=[],s=1/0;const a=jA(t,n,e+HA);for(const o of a){const l=[...o.internals.handleBounds?.source??[],...o.internals.handleBounds?.target??[]];for(const c of l){if(i.nodeId===c.nodeId&&i.type===c.type&&i.id===c.id)continue;const{x:u,y:f}=Ec(o,c,c.position,!0),p=Math.sqrt(Math.pow(u-t.x,2)+Math.pow(f-t.y,2));p>e||(p<s?(r=[{...c,x:u,y:f}],s=p):p===s&&r.push({...c,x:u,y:f}))}}if(!r.length)return null;if(r.length>1){const o=i.type==="source"?"target":"source";return r.find(l=>l.type===o)??r[0]}return r[0]}function P5(t,e,n,i,r,s=!1){const a=i.get(t);if(!a)return null;const o=r==="strict"?a.internals.handleBounds?.[e]:[...a.internals.handleBounds?.source??[],...a.internals.handleBounds?.target??[]],l=(n?o?.find(c=>c.id===n):o?.[0])??null;return l&&s?{...l,...Ec(a,l,l.position,!0)}:l}function E5(t,e){return t||(e?.classList.contains("target")?"target":e?.classList.contains("source")?"source":null)}function WA(t,e){let n=null;return e?n=!0:t&&!e&&(n=!1),n}const I5=()=>!0;function VA(t,{connectionMode:e,connectionRadius:n,handleId:i,nodeId:r,edgeUpdaterType:s,isTarget:a,domNode:o,nodeLookup:l,lib:c,autoPanOnConnect:u,flowId:f,panBy:p,cancelConnection:d,onConnectStart:y,onConnect:m,onConnectEnd:w,isValidConnection:b=I5,onReconnectEnd:S,updateConnection:A,getTransform:_,getFromHandle:I,autoPanSpeed:E,dragThreshold:M=1,handleDomNode:T}){const D=b5(t.target);let U=0,C;const{x:N,y:B}=Ea(t),P=E5(s,T),F=o?.getBoundingClientRect();let q=!1;if(!F||!P)return;const Z=P5(r,P,i,l,e);if(!Z)return;let W=Ea(t,F),Y=!1,ue=null,le=!1,O=null;function V(){if(!u||!F)return;const[ge,Ee]=v5(W,F,E);p({x:ge,y:Ee}),U=requestAnimationFrame(V)}const G={...Z,nodeId:r,type:P,position:Z.position},re=l.get(r);let ee={inProgress:!0,isValid:null,from:Ec(re,G,Kt.Left,!0),fromHandle:G,fromPosition:G.position,fromNode:re,to:W,toHandle:null,toPosition:kv[G.position],toNode:null,pointer:W};function de(){q=!0,A(ee),y?.(t,{nodeId:r,handleId:i,handleType:P})}M===0&&de();function he(ge){if(!q){const{x:Qe,y:Be}=Ea(ge),Ie=Qe-N,lt=Be-B;if(!(Ie*Ie+lt*lt>M*M))return;de()}if(!I()||!G){pe(ge);return}const Ee=_();W=Ea(ge,F),C=UA(Zd(W,Ee,!1,[1,1]),n,l,G),Y||(V(),Y=!0);const Ae=L5(ge,{handle:C,connectionMode:e,fromNodeId:r,fromHandleId:i,fromType:a?"target":"source",isValidConnection:b,doc:D,lib:c,flowId:f,nodeLookup:l});O=Ae.handleDomNode,ue=Ae.connection,le=WA(!!C,Ae.isValid);const Ye=l.get(r),K=Ye?Ec(Ye,G,Kt.Left,!0):ee.from,Re={...ee,from:K,isValid:le,to:Ae.toHandle&&le?Rh({x:Ae.toHandle.x,y:Ae.toHandle.y},Ee):W,toHandle:Ae.toHandle,toPosition:le&&Ae.toHandle?Ae.toHandle.position:kv[G.position],toNode:Ae.toHandle?l.get(Ae.toHandle.nodeId):null,pointer:W};A(Re),ee=Re}function pe(ge){if(!("touches"in ge&&ge.touches.length>0)){if(q){(C||O)&&ue&&le&&m?.(ue);const{inProgress:Ee,...Ae}=ee,Ye={...Ae,toPosition:ee.toHandle?ee.toPosition:null};w?.(ge,Ye),s&&S?.(ge,Ye)}d(),cancelAnimationFrame(U),Y=!1,le=!1,ue=null,O=null,D.removeEventListener("mousemove",he),D.removeEventListener("mouseup",pe),D.removeEventListener("touchmove",he),D.removeEventListener("touchend",pe)}}D.addEventListener("mousemove",he),D.addEventListener("mouseup",pe),D.addEventListener("touchmove",he),D.addEventListener("touchend",pe)}function L5(t,{handle:e,connectionMode:n,fromNodeId:i,fromHandleId:r,fromType:s,doc:a,lib:o,flowId:l,isValidConnection:c=I5,nodeLookup:u}){const f=s==="target",p=e?a.querySelector(`.${o}-flow__handle[data-id="${l}-${e?.nodeId}-${e?.id}-${e?.type}"]`):null,{x:d,y}=Ea(t),m=a.elementFromPoint(d,y),w=m?.classList.contains(`${o}-flow__handle`)?m:p,b={handleDomNode:w,isValid:!1,connection:null,toHandle:null};if(w){const S=E5(void 0,w),A=w.getAttribute("data-nodeid"),_=w.getAttribute("data-handleid"),I=w.classList.contains("connectable"),E=w.classList.contains("connectableend");if(!A||!S)return b;const M={source:f?A:i,sourceHandle:f?_:r,target:f?i:A,targetHandle:f?r:_};b.connection=M;const D=I&&E&&(n===Iu.Strict?f&&S==="source"||!f&&S==="target":A!==i||_!==r);b.isValid=D&&c(M),b.toHandle=P5(A,S,_,u,n,!0)}return b}const Rv={onPointerDown:VA,isValid:L5},pp=t=>({x:t.x,y:t.y,zoom:t.k}),wg=({x:t,y:e,zoom:n})=>cp.translate(t,e).scale(n),hu=(t,e)=>t.target.closest(`.${e}`),M5=(t,e)=>e===2&&Array.isArray(t)&&t.includes(2),GA=t=>((t*=2)<=1?t*t*t:(t-=2)*t*t+2)/2,xg=(t,e=0,n=GA,i=()=>{})=>{const r=typeof e=="number"&&e>0;return r||i(),r?t.transition().duration(e).ease(n).on("end",i):t},T5=t=>{const e=t.ctrlKey&&Bh()?10:1;return-t.deltaY*(t.deltaMode===1?.05:t.deltaMode?1:.002)*e};function XA({zoomPanValues:t,noWheelClassName:e,d3Selection:n,d3Zoom:i,panOnScrollMode:r,panOnScrollSpeed:s,zoomOnPinch:a,onPanZoomStart:o,onPanZoom:l,onPanZoomEnd:c}){return u=>{if(hu(u,e))return u.ctrlKey&&u.preventDefault(),!1;u.preventDefault(),u.stopImmediatePropagation();const f=n.property("__zoom").k||1;if(u.ctrlKey&&a){const w=io(u),b=T5(u),S=f*Math.pow(2,b);i.scaleTo(n,S,w,u);return}const p=u.deltaMode===1?20:1;let d=r===yu.Vertical?0:u.deltaX*p,y=r===yu.Horizontal?0:u.deltaY*p;!Bh()&&u.shiftKey&&r!==yu.Vertical&&(d=u.deltaY*p,y=0),i.translateBy(n,-(d/f)*s,-(y/f)*s,{internal:!0});const m=pp(n.property("__zoom"));clearTimeout(t.panScrollTimeout),t.isPanScrolling?(l?.(u,m),t.panScrollTimeout=setTimeout(()=>{c?.(u,m),t.isPanScrolling=!1},150)):(t.isPanScrolling=!0,o?.(u,m))}}function YA({noWheelClassName:t,preventScrolling:e,d3ZoomHandler:n}){return function(i,r){const s=i.type==="wheel",a=!e&&s&&!i.ctrlKey,o=hu(i,t);if(i.ctrlKey&&s&&o&&i.preventDefault(),a||o)return null;i.preventDefault(),n.call(this,i,r)}}function KA({zoomPanValues:t,onDraggingChange:e,onPanZoomStart:n}){return i=>{if(i.sourceEvent?.internal)return;const r=pp(i.transform);t.mouseButton=i.sourceEvent?.button||0,t.isZoomingOrPanning=!0,t.prevViewport=r,i.sourceEvent?.type==="mousedown"&&e(!0),n&&n?.(i.sourceEvent,r)}}function ZA({zoomPanValues:t,panOnDrag:e,onPaneContextMenu:n,onTransformChange:i,onPanZoom:r}){return s=>{t.usedRightMouseButton=!!(n&&M5(e,t.mouseButton??0)),s.sourceEvent?.sync||i([s.transform.x,s.transform.y,s.transform.k]),r&&!s.sourceEvent?.internal&&r?.(s.sourceEvent,pp(s.transform))}}function JA({zoomPanValues:t,panOnDrag:e,panOnScroll:n,onDraggingChange:i,onPanZoomEnd:r,onPaneContextMenu:s}){return a=>{if(!a.sourceEvent?.internal&&(t.isZoomingOrPanning=!1,s&&M5(e,t.mouseButton??0)&&!t.usedRightMouseButton&&a.sourceEvent&&s(a.sourceEvent),t.usedRightMouseButton=!1,i(!1),r)){const o=pp(a.transform);t.prevViewport=o,clearTimeout(t.timerId),t.timerId=setTimeout(()=>{r?.(a.sourceEvent,o)},n?150:0)}}}function QA({zoomActivationKeyPressed:t,zoomOnScroll:e,zoomOnPinch:n,panOnDrag:i,panOnScroll:r,zoomOnDoubleClick:s,userSelectionActive:a,noWheelClassName:o,noPanClassName:l,lib:c,connectionInProgress:u}){return f=>{const p=t||e,d=n&&f.ctrlKey,y=f.type==="wheel";if(f.button===1&&f.type==="mousedown"&&(hu(f,`${c}-flow__node`)||hu(f,`${c}-flow__edge`)))return!0;if(!i&&!p&&!r&&!s&&!n||a||u&&!y||hu(f,o)&&y||hu(f,l)&&(!y||r&&y&&!t)||!n&&f.ctrlKey&&y)return!1;if(!n&&f.type==="touchstart"&&f.touches?.length>1)return f.preventDefault(),!1;if(!p&&!r&&!d&&y||!i&&(f.type==="mousedown"||f.type==="touchstart")||Array.isArray(i)&&!i.includes(f.button)&&f.type==="mousedown")return!1;const m=Array.isArray(i)&&i.includes(f.button)||!f.button||f.button<=1;return(!f.ctrlKey||y)&&m}}function $A({domNode:t,minZoom:e,maxZoom:n,translateExtent:i,viewport:r,onPanZoom:s,onPanZoomStart:a,onPanZoomEnd:o,onDraggingChange:l}){const c={isZoomingOrPanning:!1,usedRightMouseButton:!1,prevViewport:{},mouseButton:0,timerId:void 0,panScrollTimeout:void 0,isPanScrolling:!1},u=t.getBoundingClientRect(),f=Q6().scaleExtent([e,n]).translateExtent(i),p=na(t).call(f);S({x:r.x,y:r.y,zoom:Lu(r.zoom,e,n)},[[0,0],[u.width,u.height]],i);const d=p.on("wheel.zoom"),y=p.on("dblclick.zoom");f.wheelDelta(T5);function m(C,N){return p?new Promise(B=>{f?.interpolate(N?.interpolate==="linear"?Sd:sh).transform(xg(p,N?.duration,N?.ease,()=>B(!0)),C)}):Promise.resolve(!1)}function w({noWheelClassName:C,noPanClassName:N,onPaneContextMenu:B,userSelectionActive:P,panOnScroll:F,panOnDrag:q,panOnScrollMode:Z,panOnScrollSpeed:W,preventScrolling:Y,zoomOnPinch:ue,zoomOnScroll:le,zoomOnDoubleClick:O,zoomActivationKeyPressed:V,lib:G,onTransformChange:re,connectionInProgress:ae,paneClickDistance:ee,selectionOnDrag:de}){P&&!c.isZoomingOrPanning&&b();const he=F&&!V&&!P;f.clickDistance(de?1/0:!el(ee)||ee<0?0:ee);const pe=he?XA({zoomPanValues:c,noWheelClassName:C,d3Selection:p,d3Zoom:f,panOnScrollMode:Z,panOnScrollSpeed:W,zoomOnPinch:ue,onPanZoomStart:a,onPanZoom:s,onPanZoomEnd:o}):YA({noWheelClassName:C,preventScrolling:Y,d3ZoomHandler:d});if(p.on("wheel.zoom",pe,{passive:!1}),!P){const Ee=KA({zoomPanValues:c,onDraggingChange:l,onPanZoomStart:a});f.on("start",Ee);const Ae=ZA({zoomPanValues:c,panOnDrag:q,onPaneContextMenu:!!B,onPanZoom:s,onTransformChange:re});f.on("zoom",Ae);const Ye=JA({zoomPanValues:c,panOnDrag:q,panOnScroll:F,onPaneContextMenu:B,onPanZoomEnd:o,onDraggingChange:l});f.on("end",Ye)}const ge=QA({zoomActivationKeyPressed:V,panOnDrag:q,zoomOnScroll:le,panOnScroll:F,zoomOnDoubleClick:O,zoomOnPinch:ue,userSelectionActive:P,noPanClassName:N,noWheelClassName:C,lib:G,connectionInProgress:ae});f.filter(ge),O?p.on("dblclick.zoom",y):p.on("dblclick.zoom",null)}function b(){f.on("zoom",null)}async function S(C,N,B){const P=wg(C),F=f?.constrain()(P,N,B);return F&&await m(F),new Promise(q=>q(F))}async function A(C,N){const B=wg(C);return await m(B,N),new Promise(P=>P(B))}function _(C){if(p){const N=wg(C),B=p.property("__zoom");(B.k!==C.zoom||B.x!==C.x||B.y!==C.y)&&f?.transform(p,N,null,{sync:!0})}}function I(){const C=p?f5(p.node()):{x:0,y:0,k:1};return{x:C.x,y:C.y,zoom:C.k}}function E(C,N){return p?new Promise(B=>{f?.interpolate(N?.interpolate==="linear"?Sd:sh).scaleTo(xg(p,N?.duration,N?.ease,()=>B(!0)),C)}):Promise.resolve(!1)}function M(C,N){return p?new Promise(B=>{f?.interpolate(N?.interpolate==="linear"?Sd:sh).scaleBy(xg(p,N?.duration,N?.ease,()=>B(!0)),C)}):Promise.resolve(!1)}function T(C){f?.scaleExtent(C)}function D(C){f?.translateExtent(C)}function U(C){const N=!el(C)||C<0?0:C;f?.clickDistance(N)}return{update:w,destroy:b,setViewport:A,setViewportConstrained:S,getViewport:I,scaleTo:E,scaleBy:M,setScaleExtent:T,setTranslateExtent:D,syncViewport:_,setClickDistance:U}}var Bd;(function(t){t.Line="line",t.Handle="handle"})(Bd||(Bd={}));const eN=["top-left","top-right","bottom-left","bottom-right"],tN=["top","right","bottom","left"];function nN({width:t,prevWidth:e,height:n,prevHeight:i,affectsX:r,affectsY:s}){const a=t-e,o=n-i,l=[a>0?1:a<0?-1:0,o>0?1:o<0?-1:0];return a&&r&&(l[0]=l[0]*-1),o&&s&&(l[1]=l[1]*-1),l}function Bv(t){const e=t.includes("right")||t.includes("left"),n=t.includes("bottom")||t.includes("top"),i=t.includes("left"),r=t.includes("top");return{isHorizontal:e,isVertical:n,affectsX:i,affectsY:r}}function Ll(t,e){return Math.max(0,e-t)}function Ml(t,e){return Math.max(0,t-e)}function Df(t,e,n){return Math.max(0,e-t,t-n)}function zv(t,e){return t?!e:e}function iN(t,e,n,i,r,s,a,o){let{affectsX:l,affectsY:c}=e;const{isHorizontal:u,isVertical:f}=e,p=u&&f,{xSnapped:d,ySnapped:y}=n,{minWidth:m,maxWidth:w,minHeight:b,maxHeight:S}=i,{x:A,y:_,width:I,height:E,aspectRatio:M}=t;let T=Math.floor(u?d-t.pointerX:0),D=Math.floor(f?y-t.pointerY:0);const U=I+(l?-T:T),C=E+(c?-D:D),N=-s[0]*I,B=-s[1]*E;let P=Df(U,m,w),F=Df(C,b,S);if(a){let W=0,Y=0;l&&T<0?W=Ll(A+T+N,a[0][0]):!l&&T>0&&(W=Ml(A+U+N,a[1][0])),c&&D<0?Y=Ll(_+D+B,a[0][1]):!c&&D>0&&(Y=Ml(_+C+B,a[1][1])),P=Math.max(P,W),F=Math.max(F,Y)}if(o){let W=0,Y=0;l&&T>0?W=Ml(A+T,o[0][0]):!l&&T<0&&(W=Ll(A+U,o[1][0])),c&&D>0?Y=Ml(_+D,o[0][1]):!c&&D<0&&(Y=Ll(_+C,o[1][1])),P=Math.max(P,W),F=Math.max(F,Y)}if(r){if(u){const W=Df(U/M,b,S)*M;if(P=Math.max(P,W),a){let Y=0;!l&&!c||l&&!c&&p?Y=Ml(_+B+U/M,a[1][1])*M:Y=Ll(_+B+(l?T:-T)/M,a[0][1])*M,P=Math.max(P,Y)}if(o){let Y=0;!l&&!c||l&&!c&&p?Y=Ll(_+U/M,o[1][1])*M:Y=Ml(_+(l?T:-T)/M,o[0][1])*M,P=Math.max(P,Y)}}if(f){const W=Df(C*M,m,w)/M;if(F=Math.max(F,W),a){let Y=0;!l&&!c||c&&!l&&p?Y=Ml(A+C*M+N,a[1][0])/M:Y=Ll(A+(c?D:-D)*M+N,a[0][0])/M,F=Math.max(F,Y)}if(o){let Y=0;!l&&!c||c&&!l&&p?Y=Ll(A+C*M,o[1][0])/M:Y=Ml(A+(c?D:-D)*M,o[0][0])/M,F=Math.max(F,Y)}}}D=D+(D<0?F:-F),T=T+(T<0?P:-P),r&&(p?U>C*M?D=(zv(l,c)?-T:T)/M:T=(zv(l,c)?-D:D)*M:u?(D=T/M,c=l):(T=D*M,l=c));const q=l?A+T:A,Z=c?_+D:_;return{width:I+(l?-T:T),height:E+(c?-D:D),x:s[0]*T*(l?-1:1)+q,y:s[1]*D*(c?-1:1)+Z}}const D5={width:0,height:0,x:0,y:0},rN={...D5,pointerX:0,pointerY:0,aspectRatio:1};function sN(t){return[[0,0],[t.measured.width,t.measured.height]]}function aN(t,e,n){const i=e.position.x+t.position.x,r=e.position.y+t.position.y,s=t.measured.width??0,a=t.measured.height??0,o=n[0]*s,l=n[1]*a;return[[i-o,r-l],[i+s-o,r+a-l]]}function oN({domNode:t,nodeId:e,getStoreItems:n,onChange:i,onEnd:r}){const s=na(t);let a={controlDirection:Bv("bottom-right"),boundaries:{minWidth:0,minHeight:0,maxWidth:Number.MAX_VALUE,maxHeight:Number.MAX_VALUE},resizeDirection:void 0,keepAspectRatio:!1};function o({controlPosition:c,boundaries:u,keepAspectRatio:f,resizeDirection:p,onResizeStart:d,onResize:y,onResizeEnd:m,shouldResize:w}){let b={...D5},S={...rN};a={boundaries:u,resizeDirection:p,keepAspectRatio:f,controlDirection:Bv(c)};let A,_=null,I=[],E,M,T,D=!1;const U=Qb().on("start",C=>{const{nodeLookup:N,transform:B,snapGrid:P,snapToGrid:F,nodeOrigin:q,paneDomNode:Z}=n();if(A=N.get(e),!A)return;_=Z?.getBoundingClientRect()??null;const{xSnapped:W,ySnapped:Y}=kd(C.sourceEvent,{transform:B,snapGrid:P,snapToGrid:F,containerBounds:_});b={width:A.measured.width??0,height:A.measured.height??0,x:A.position.x??0,y:A.position.y??0},S={...b,pointerX:W,pointerY:Y,aspectRatio:b.width/b.height},E=void 0,A.parentId&&(A.extent==="parent"||A.expandParent)&&(E=N.get(A.parentId),M=E&&A.extent==="parent"?sN(E):void 0),I=[],T=void 0;for(const[ue,le]of N)if(le.parentId===e&&(I.push({id:ue,position:{...le.position},extent:le.extent}),le.extent==="parent"||le.expandParent)){const O=aN(le,A,le.origin??q);T?T=[[Math.min(O[0][0],T[0][0]),Math.min(O[0][1],T[0][1])],[Math.max(O[1][0],T[1][0]),Math.max(O[1][1],T[1][1])]]:T=O}d?.(C,{...b})}).on("drag",C=>{const{transform:N,snapGrid:B,snapToGrid:P,nodeOrigin:F}=n(),q=kd(C.sourceEvent,{transform:N,snapGrid:B,snapToGrid:P,containerBounds:_}),Z=[];if(!A)return;const{x:W,y:Y,width:ue,height:le}=b,O={},V=A.origin??F,{width:G,height:re,x:ae,y:ee}=iN(S,a.controlDirection,q,a.boundaries,a.keepAspectRatio,V,M,T),de=G!==ue,he=re!==le,pe=ae!==W&&de,ge=ee!==Y&&he;if(!pe&&!ge&&!de&&!he)return;if((pe||ge||V[0]===1||V[1]===1)&&(O.x=pe?ae:b.x,O.y=ge?ee:b.y,b.x=O.x,b.y=O.y,I.length>0)){const K=ae-W,Re=ee-Y;for(const Qe of I)Qe.position={x:Qe.position.x-K+V[0]*(G-ue),y:Qe.position.y-Re+V[1]*(re-le)},Z.push(Qe)}if((de||he)&&(O.width=de&&(!a.resizeDirection||a.resizeDirection==="horizontal")?G:b.width,O.height=he&&(!a.resizeDirection||a.resizeDirection==="vertical")?re:b.height,b.width=O.width,b.height=O.height),E&&A.expandParent){const K=V[0]*(O.width??0);O.x&&O.x<K&&(b.x=K,S.x=S.x-(O.x-K));const Re=V[1]*(O.height??0);O.y&&O.y<Re&&(b.y=Re,S.y=S.y-(O.y-Re))}const Ee=nN({width:b.width,prevWidth:ue,height:b.height,prevHeight:le,affectsX:a.controlDirection.affectsX,affectsY:a.controlDirection.affectsY}),Ae={...b,direction:Ee};w?.(C,Ae)!==!1&&(D=!0,y?.(C,Ae),i(O,Z))}).on("end",C=>{D&&(m?.(C,{...b}),r?.({...b}),D=!1)});s.call(U)}function l(){s.on(".drag",null)}return{update:o,destroy:l}}function j1(){const t={};return[e=>{if(e&&!H3(t))throw new Error(e);return w1(t)},e=>Cb(t,e)]}const[H1,lN]=j1(),[cN,uN]=j1(),[dN,fN]=j1();var hN=Me("<div><!></div>");function Du(t,e){Tt(e,!0);let n=ct(e,"id",3,null),i=ct(e,"type",3,"source"),r=ct(e,"position",19,()=>Kt.Top),s=ct(e,"isConnectableStart",3,!0),a=ct(e,"isConnectableEnd",3,!0),o=Bc(e,["$$slots","$$events","$$legacy","id","type","position","style","class","isConnectable","isConnectableStart","isConnectableEnd","isValidConnection","onconnect","ondisconnect","children"]);const l=H1("Handle must be used within a Custom Node component"),c=cN("Handle must be used within a Custom Node component");let u=ne(()=>i()==="target"),f=ne(()=>e.isConnectable!==void 0?e.isConnectable:c.value),p=Ql(),d=ne(()=>p.ariaLabelConfig),y=null;Pb(()=>{if(e.onconnect||e.ondisconnect){p.edges;let N=p.connectionLookup.get(`${l}-${i()}${n()?`-${n()}`:""}`);if(y&&!eA(N,y)){const B=N??new Map;Av(y,B,e.ondisconnect),Av(B,y,e.onconnect)}y=new Map(N)}});let m=ne(()=>{if(!p.connection.inProgress)return[!1,!1,!1,!1,null];const{fromHandle:N,toHandle:B,isValid:P}=p.connection,F=N&&N.nodeId===l&&N.type===i()&&N.id===n(),q=B&&B.nodeId===l&&B.type===i()&&B.id===n(),Z=p.connectionMode===Iu.Strict?N?.type!==i():l!==N?.nodeId||n()!==N?.id;return[!0,F,q,Z,q&&P]}),w=ne(()=>Rc(h(m),5)),b=ne(()=>h(w)[0]),S=ne(()=>h(w)[1]),A=ne(()=>h(w)[2]),_=ne(()=>h(w)[3]),I=ne(()=>h(w)[4]);function E(N){const B=p.onbeforeconnect?p.onbeforeconnect(N):N;B&&(p.addEdge(B),p.onconnect?.(N))}function M(N){const B=x5(N);N.currentTarget&&(B&&N.button===0||!B)&&Rv.onPointerDown(N,{handleId:n(),nodeId:l,isTarget:h(u),connectionRadius:p.connectionRadius,domNode:p.domNode,nodeLookup:p.nodeLookup,connectionMode:p.connectionMode,lib:"svelte",autoPanOnConnect:p.autoPanOnConnect,autoPanSpeed:p.autoPanSpeed,flowId:p.flowId,isValidConnection:e.isValidConnection??p.isValidConnection,updateConnection:p.updateConnection,cancelConnection:p.cancelConnection,panBy:p.panBy,onConnect:E,onConnectStart:(P,F)=>{p.onconnectstart?.(P,{nodeId:F.nodeId,handleId:F.handleId,handleType:F.handleType})},onConnectEnd:(P,F)=>{p.onconnectend?.(P,F)},getTransform:()=>[p.viewport.x,p.viewport.y,p.viewport.zoom],getFromHandle:()=>p.connection.fromHandle,dragThreshold:p.connectionDragThreshold,handleDomNode:N.currentTarget})}function T(N){if(!l||!p.clickConnectStartHandle&&!s())return;if(!p.clickConnectStartHandle){p.onclickconnectstart?.(N,{nodeId:l,handleId:n(),handleType:i()}),p.clickConnectStartHandle={nodeId:l,type:i(),id:n()};return}const B=b5(N.target),P=e.isValidConnection??p.isValidConnection,{connectionMode:F,clickConnectStartHandle:q,flowId:Z,nodeLookup:W}=p,{connection:Y,isValid:ue}=Rv.isValid(N,{handle:{nodeId:l,id:n(),type:i()},connectionMode:F,fromNodeId:q.nodeId,fromHandleId:q.id??null,fromType:q.type,isValidConnection:P,flowId:Z,doc:B,lib:"svelte",nodeLookup:W});ue&&Y&&E(Y);const le=structuredClone(Ib(p.connection));delete le.inProgress,le.toPosition=le.toHandle?le.toHandle.position:null,p.onclickconnectend?.(N,le),p.clickConnectStartHandle=null}var D=hN(),U=()=>{};Jl(D,()=>({"data-handleid":n(),"data-nodeid":l,"data-handlepos":r(),"data-id":`${p.flowId??""}-${l??""}-${n()??"null"??""}-${i()??""}`,class:["svelte-flow__handle",`svelte-flow__handle-${r()}`,p.noDragClass,p.noPanClass,r(),e.class],onmousedown:M,ontouchstart:M,onclick:p.clickConnect?T:void 0,onkeypress:U,style:e.style,role:"button","aria-label":h(d)["handle.ariaLabel"],tabindex:"-1",...o,[ql]:{valid:h(I),connectingto:h(A),connectingfrom:h(S),source:!h(u),target:h(u),connectablestart:s(),connectableend:a(),connectable:h(f),connectionindicator:h(f)&&(!h(b)||h(_))&&(h(b)||p.clickConnectStartHandle?a():s())}}));var C=se(D);gs(C,()=>e.children??ta),Q(D),j(t,D),Dt()}var pN=Me("<!> <!>",1);function O5(t,e){Tt(e,!0);let n=ct(e,"targetPosition",19,()=>Kt.Top),i=ct(e,"sourcePosition",19,()=>Kt.Bottom);var r=pN(),s=Ue(r);Du(s,{type:"target",get position(){return n()}});var a=be(s),o=be(a);Du(o,{type:"source",get position(){return i()}}),_e(()=>Wt(a,` ${e.data?.label??""} `)),j(t,r),Dt()}var gN=Me(" <!>",1);function mN(t,e){Tt(e,!0);let n=ct(e,"data",19,()=>({label:"Node"})),i=ct(e,"sourcePosition",19,()=>Kt.Bottom);Ri();var r=gN(),s=Ue(r),a=be(s);Du(a,{type:"source",get position(){return i()}}),_e(()=>Wt(s,`${n()?.label??""} `)),j(t,r),Dt()}var vN=Me(" <!>",1);function yN(t,e){Tt(e,!0);let n=ct(e,"data",19,()=>({label:"Node"})),i=ct(e,"targetPosition",19,()=>Kt.Top);Ri();var r=vN(),s=Ue(r),a=be(s);Du(a,{type:"target",get position(){return i()}}),_e(()=>Wt(s,`${n()?.label??""} `)),j(t,r),Dt()}function bN(t,e){}function _g(t,e,n){if(!n||!e)return;const i=n==="root"?e:e.querySelector(`.svelte-flow__${n}`);i&&i.appendChild(t)}function wN(t,e){const n=ne(Ql),i=ne(()=>h(n).domNode);let r;return h(i)?_g(t,h(i),e):r=Eb(()=>{mn(()=>{_g(t,h(i),e),r?.()})}),{async update(s){_g(t,h(i),s)},destroy(){t.parentNode&&t.parentNode.removeChild(t),r?.()}}}function xN(){let t=Oe(typeof window>"u");if(h(t)){const e=Eb(()=>{mn(()=>{J(t,!1),e?.()})})}return{get value(){return h(t)}}}const qv=t=>nA(t),_N=t=>p5(t);function ho(t){return t===void 0?void 0:`${t}px`}const zh={ArrowUp:{x:0,y:-1},ArrowDown:{x:0,y:1},ArrowLeft:{x:-1,y:0},ArrowRight:{x:1,y:0}};var SN=Me("<div><!></div>");function kN(t,e){Tt(e,!0);let n=ct(e,"x",3,0),i=ct(e,"y",3,0),r=ct(e,"selectEdgeOnClick",3,!1),s=ct(e,"transparent",3,!1),a=Bc(e,["$$slots","$$events","$$legacy","x","y","width","height","selectEdgeOnClick","transparent","class","children"]);const o=Ql(),l=dN("EdgeLabel must be used within a Custom Edge component");let c=ne(()=>o.visible.edges.get(l)?.zIndex);var u=SN(),f=()=>{r()&&l&&o.handleEdgeSelection(l)};Jl(u,d=>({class:["svelte-flow__edge-label",{transparent:s()},e.class],tabindex:"-1",onclick:f,...a,[Jo]:d}),[()=>({display:xN().value?"none":void 0,cursor:r()?"pointer":void 0,transform:`translate(-50%, -50%) translate(${n()??""}px,${i()??""}px)`,"pointer-events":"all",width:ho(e.width),height:ho(e.height),"z-index":h(c)})],void 0,void 0,"svelte-1wg91mu");var p=se(u);gs(p,()=>e.children??ta),Q(u),wt(u,(d,y)=>wN?.(d,y),()=>"edge-labels"),j(t,u),Dt()}var AN=rt("<path></path>"),NN=rt('<path fill="none"></path><!><!>',1);function Jd(t,e){let n=ct(e,"interactionWidth",3,20),i=Bc(e,["$$slots","$$events","$$legacy","id","path","label","labelX","labelY","labelStyle","markerStart","markerEnd","style","interactionWidth","class"]);var r=NN(),s=Ue(r),a=be(s);{var o=u=>{var f=AN();Jl(f,()=>({d:e.path,"stroke-opacity":0,"stroke-width":n(),fill:"none",class:"svelte-flow__edge-interaction",...i})),j(u,f)};ke(a,u=>{n()>0&&u(o)})}var l=be(a);{var c=u=>{kN(u,{get x(){return e.labelX},get y(){return e.labelY},get style(){return e.labelStyle},selectEdgeOnClick:!0,children:(f,p)=>{Ri();var d=vb();_e(()=>Wt(d,e.label)),j(f,d)},$$slots:{default:!0}})};ke(l,u=>{e.label&&u(c)})}_e(()=>{fe(s,"id",e.id),fe(s,"d",e.path),Xt(s,0,zc(["svelte-flow__edge-path",e.class])),fe(s,"marker-start",e.markerStart),fe(s,"marker-end",e.markerEnd),An(s,e.style)}),j(t,r)}function F5(t,e){Tt(e,!0);let n=ne(()=>_5({sourceX:e.sourceX,sourceY:e.sourceY,targetX:e.targetX,targetY:e.targetY,sourcePosition:e.sourcePosition,targetPosition:e.targetPosition,curvature:e.pathOptions?.curvature})),i=ne(()=>Rc(h(n),3)),r=ne(()=>h(i)[0]),s=ne(()=>h(i)[1]),a=ne(()=>h(i)[2]);Jd(t,{get id(){return e.id},get path(){return h(r)},get labelX(){return h(s)},get labelY(){return h(a)},get label(){return e.label},get labelStyle(){return e.labelStyle},get markerStart(){return e.markerStart},get markerEnd(){return e.markerEnd},get interactionWidth(){return e.interactionWidth},get style(){return e.style}}),Dt()}function CN(t,e){Tt(e,!0);let n=ne(()=>hp({sourceX:e.sourceX,sourceY:e.sourceY,targetX:e.targetX,targetY:e.targetY,sourcePosition:e.sourcePosition,targetPosition:e.targetPosition})),i=ne(()=>Rc(h(n),3)),r=ne(()=>h(i)[0]),s=ne(()=>h(i)[1]),a=ne(()=>h(i)[2]);Jd(t,{get path(){return h(r)},get labelX(){return h(s)},get labelY(){return h(a)},get label(){return e.label},get labelStyle(){return e.labelStyle},get markerStart(){return e.markerStart},get markerEnd(){return e.markerEnd},get interactionWidth(){return e.interactionWidth},get style(){return e.style}}),Dt()}function PN(t,e){Tt(e,!0);let n=ne(()=>k5({sourceX:e.sourceX,sourceY:e.sourceY,targetX:e.targetX,targetY:e.targetY})),i=ne(()=>Rc(h(n),3)),r=ne(()=>h(i)[0]),s=ne(()=>h(i)[1]),a=ne(()=>h(i)[2]);Jd(t,{get path(){return h(r)},get labelX(){return h(s)},get labelY(){return h(a)},get label(){return e.label},get labelStyle(){return e.labelStyle},get markerStart(){return e.markerStart},get markerEnd(){return e.markerEnd},get interactionWidth(){return e.interactionWidth},get style(){return e.style}}),Dt()}function EN(t,e){Tt(e,!0);let n=ne(()=>hp({sourceX:e.sourceX,sourceY:e.sourceY,targetX:e.targetX,targetY:e.targetY,sourcePosition:e.sourcePosition,targetPosition:e.targetPosition,borderRadius:0})),i=ne(()=>Rc(h(n),3)),r=ne(()=>h(i)[0]),s=ne(()=>h(i)[1]),a=ne(()=>h(i)[2]);Jd(t,{get path(){return h(r)},get labelX(){return h(s)},get labelY(){return h(a)},get label(){return e.label},get labelStyle(){return e.labelStyle},get markerStart(){return e.markerStart},get markerEnd(){return e.markerEnd},get interactionWidth(){return e.interactionWidth},get style(){return e.style}}),Dt()}class IN{#e;#t;constructor(e,n){this.#e=e,this.#t=J3(n)}get current(){return this.#t(),this.#e()}}const LN=/\(.+\)/,MN=new Set(["all","print","screen","and","or","not","only"]);class TN extends IN{constructor(e,n){let i=LN.test(e)||e.split(/[\s,]+/).some(s=>MN.has(s.trim()))?e:`(${e})`;const r=window.matchMedia(i);super(()=>r.matches,s=>km(r,"change",s))}}function DN(t,e,n,i){const r=new Map;return O1(t,{x:0,y:0,width:n,height:i},e,!0).forEach(s=>{r.set(s.id,s)}),r}function jv(t){const{edges:e,defaultEdgeOptions:n,nodeLookup:i,previousEdges:r,connectionMode:s,onerror:a,onlyRenderVisible:o,elevateEdgesOnSelect:l,zIndexMode:c}=t,u=new Map;for(const f of e){const p=i.get(f.source),d=i.get(f.target);if(!p||!d)continue;if(o){const{visibleNodes:w,transform:b,width:S,height:A}=t;if(yA({sourceNode:p,targetNode:d,width:S,height:A,transform:b}))w.set(p.id,p),w.set(d.id,d);else continue}const y=r.get(f.id);if(y&&f===y.edge&&p==y.sourceNode&&d==y.targetNode){u.set(f.id,y);continue}const m=AA({id:f.id,sourceNode:p,targetNode:d,sourceHandle:f.sourceHandle||null,targetHandle:f.targetHandle||null,connectionMode:s,onError:a});m&&u.set(f.id,{...n,...f,...m,zIndex:vA({selected:f.selected,zIndex:f.zIndex??n.zIndex,sourceNode:p,targetNode:d,elevateOnSelect:l,zIndexMode:c}),sourceNode:p,targetNode:d,edge:f})}return u}const R5={input:mN,output:yN,default:O5,group:bN},B5={straight:PN,smoothstep:CN,default:F5,step:EN};function ON(t,e,n,i,r,s){if(e&&!n&&i&&r){const a=up(s,{filter:o=>!!((o.width||o.initialWidth)&&(o.height||o.initialHeight))});return F1(a,i,r,.5,2,.1)}else return n??{x:0,y:0,zoom:1}}function FN(t){class e{#e=ne(()=>t.props.id??"1");get flowId(){return h(this.#e)}set flowId(i){J(this.#e,i)}#t=Oe(null);get domNode(){return h(this.#t)}set domNode(i){J(this.#t,i)}#n=Oe(null);get panZoom(){return h(this.#n)}set panZoom(i){J(this.#n,i)}#i=Oe(t.width??0);get width(){return h(this.#i)}set width(i){J(this.#i,i)}#r=Oe(t.height??0);get height(){return h(this.#r)}set height(i){J(this.#r,i)}#s=Oe(t.props.zIndexMode??"basic");get zIndexMode(){return h(this.#s)}set zIndexMode(i){J(this.#s,i)}#a=ne(()=>{const i=LA(t.nodes,this.nodeLookup,this.parentLookup,{nodeExtent:this.nodeExtent,nodeOrigin:this.nodeOrigin,elevateNodesOnSelect:t.props.elevateNodesOnSelect??!0,checkEquality:!0,zIndexMode:this.zIndexMode});return this.fitViewQueued&&i&&(this.fitViewOptions?.duration?this.resolveFitView():queueMicrotask(()=>{this.resolveFitView()})),i});get nodesInitialized(){return h(this.#a)}set nodesInitialized(i){J(this.#a,i)}#o=ne(()=>this.panZoom!==null);get viewportInitialized(){return h(this.#o)}set viewportInitialized(i){J(this.#o,i)}#l=ne(()=>(RA(this.connectionLookup,this.edgeLookup,t.edges),t.edges));get _edges(){return h(this.#l)}set _edges(i){J(this.#l,i)}get nodes(){return this.nodesInitialized,t.nodes}set nodes(i){t.nodes=i}get edges(){return this._edges}set edges(i){t.edges=i}_prevSelectedNodes=[];_prevSelectedNodeIds=new Set;#c=ne(()=>{const i=this._prevSelectedNodeIds.size,r=new Set,s=this.nodes.filter(a=>(a.selected&&(r.add(a.id),this._prevSelectedNodeIds.delete(a.id)),a.selected));return(i!==r.size||this._prevSelectedNodeIds.size>0)&&(this._prevSelectedNodes=s),this._prevSelectedNodeIds=r,this._prevSelectedNodes});get selectedNodes(){return h(this.#c)}set selectedNodes(i){J(this.#c,i)}_prevSelectedEdges=[];_prevSelectedEdgeIds=new Set;#u=ne(()=>{const i=this._prevSelectedEdgeIds.size,r=new Set,s=this.edges.filter(a=>(a.selected&&(r.add(a.id),this._prevSelectedEdgeIds.delete(a.id)),a.selected));return(i!==r.size||this._prevSelectedEdgeIds.size>0)&&(this._prevSelectedEdges=s),this._prevSelectedEdgeIds=r,this._prevSelectedEdges});get selectedEdges(){return h(this.#u)}set selectedEdges(i){J(this.#u,i)}selectionChangeHandlers=new Map;nodeLookup=new Map;parentLookup=new Map;connectionLookup=new Map;edgeLookup=new Map;_prevVisibleEdges=new Map;#d=ne(()=>{const{nodes:i,_edges:r,_prevVisibleEdges:s,nodeLookup:a,connectionMode:o,onerror:l,onlyRenderVisibleElements:c,defaultEdgeOptions:u,zIndexMode:f}=this;let p,d;const y={edges:r,defaultEdgeOptions:u,previousEdges:s,nodeLookup:a,connectionMode:o,elevateEdgesOnSelect:t.props.elevateEdgesOnSelect??!0,zIndexMode:f,onerror:l};if(c){const{viewport:m,width:w,height:b}=this,S=[m.x,m.y,m.zoom];p=DN(a,S,w,b),d=jv({...y,onlyRenderVisible:!0,visibleNodes:p,transform:S,width:w,height:b})}else p=this.nodeLookup,d=jv(y);return{nodes:p,edges:d}});get visible(){return h(this.#d)}set visible(i){J(this.#d,i)}#f=ne(()=>t.props.nodesDraggable??!0);get nodesDraggable(){return h(this.#f)}set nodesDraggable(i){J(this.#f,i)}#h=ne(()=>t.props.nodesConnectable??!0);get nodesConnectable(){return h(this.#h)}set nodesConnectable(i){J(this.#h,i)}#p=ne(()=>t.props.elementsSelectable??!0);get elementsSelectable(){return h(this.#p)}set elementsSelectable(i){J(this.#p,i)}#g=ne(()=>t.props.nodesFocusable??!0);get nodesFocusable(){return h(this.#g)}set nodesFocusable(i){J(this.#g,i)}#m=ne(()=>t.props.edgesFocusable??!0);get edgesFocusable(){return h(this.#m)}set edgesFocusable(i){J(this.#m,i)}#v=ne(()=>t.props.disableKeyboardA11y??!1);get disableKeyboardA11y(){return h(this.#v)}set disableKeyboardA11y(i){J(this.#v,i)}#y=ne(()=>t.props.minZoom??.5);get minZoom(){return h(this.#y)}set minZoom(i){J(this.#y,i)}#b=ne(()=>t.props.maxZoom??2);get maxZoom(){return h(this.#b)}set maxZoom(i){J(this.#b,i)}#w=ne(()=>t.props.nodeOrigin??[0,0]);get nodeOrigin(){return h(this.#w)}set nodeOrigin(i){J(this.#w,i)}#x=ne(()=>t.props.nodeExtent??Om);get nodeExtent(){return h(this.#x)}set nodeExtent(i){J(this.#x,i)}#_=ne(()=>t.props.translateExtent??Om);get translateExtent(){return h(this.#_)}set translateExtent(i){J(this.#_,i)}#S=ne(()=>t.props.defaultEdgeOptions??{});get defaultEdgeOptions(){return h(this.#S)}set defaultEdgeOptions(i){J(this.#S,i)}#k=ne(()=>t.props.nodeDragThreshold??1);get nodeDragThreshold(){return h(this.#k)}set nodeDragThreshold(i){J(this.#k,i)}#A=ne(()=>t.props.autoPanOnNodeDrag??!0);get autoPanOnNodeDrag(){return h(this.#A)}set autoPanOnNodeDrag(i){J(this.#A,i)}#N=ne(()=>t.props.autoPanOnConnect??!0);get autoPanOnConnect(){return h(this.#N)}set autoPanOnConnect(i){J(this.#N,i)}#C=ne(()=>t.props.autoPanOnNodeFocus??!0);get autoPanOnNodeFocus(){return h(this.#C)}set autoPanOnNodeFocus(i){J(this.#C,i)}#P=ne(()=>t.props.autoPanSpeed??15);get autoPanSpeed(){return h(this.#P)}set autoPanSpeed(i){J(this.#P,i)}#E=ne(()=>t.props.connectionDragThreshold??1);get connectionDragThreshold(){return h(this.#E)}set connectionDragThreshold(i){J(this.#E,i)}fitViewQueued=t.props.fitView??!1;fitViewOptions=t.props.fitViewOptions;fitViewResolver=null;#I=ne(()=>t.props.snapGrid??null);get snapGrid(){return h(this.#I)}set snapGrid(i){J(this.#I,i)}#L=Oe(!1);get dragging(){return h(this.#L)}set dragging(i){J(this.#L,i)}#M=Oe(null);get selectionRect(){return h(this.#M)}set selectionRect(i){J(this.#M,i)}#T=Oe(!1);get selectionKeyPressed(){return h(this.#T)}set selectionKeyPressed(i){J(this.#T,i)}#D=Oe(!1);get multiselectionKeyPressed(){return h(this.#D)}set multiselectionKeyPressed(i){J(this.#D,i)}#O=Oe(!1);get deleteKeyPressed(){return h(this.#O)}set deleteKeyPressed(i){J(this.#O,i)}#F=Oe(!1);get panActivationKeyPressed(){return h(this.#F)}set panActivationKeyPressed(i){J(this.#F,i)}#R=Oe(!1);get zoomActivationKeyPressed(){return h(this.#R)}set zoomActivationKeyPressed(i){J(this.#R,i)}#B=Oe(null);get selectionRectMode(){return h(this.#B)}set selectionRectMode(i){J(this.#B,i)}#z=Oe("");get ariaLiveMessage(){return h(this.#z)}set ariaLiveMessage(i){J(this.#z,i)}#q=ne(()=>t.props.selectionMode??Dh.Partial);get selectionMode(){return h(this.#q)}set selectionMode(i){J(this.#q,i)}#j=ne(()=>({...R5,...t.props.nodeTypes}));get nodeTypes(){return h(this.#j)}set nodeTypes(i){J(this.#j,i)}#H=ne(()=>({...B5,...t.props.edgeTypes}));get edgeTypes(){return h(this.#H)}set edgeTypes(i){J(this.#H,i)}#U=ne(()=>t.props.noPanClass??"nopan");get noPanClass(){return h(this.#U)}set noPanClass(i){J(this.#U,i)}#W=ne(()=>t.props.noDragClass??"nodrag");get noDragClass(){return h(this.#W)}set noDragClass(i){J(this.#W,i)}#V=ne(()=>t.props.noWheelClass??"nowheel");get noWheelClass(){return h(this.#V)}set noWheelClass(i){J(this.#V,i)}#G=ne(()=>pA(t.props.ariaLabelConfig));get ariaLabelConfig(){return h(this.#G)}set ariaLabelConfig(i){J(this.#G,i)}#X=Oe(ON(this.nodesInitialized,t.props.fitView,t.props.initialViewport,this.width,this.height,this.nodeLookup));get _viewport(){return h(this.#X)}set _viewport(i){J(this.#X,i)}get viewport(){return t.viewport??this._viewport}set viewport(i){t.viewport&&(t.viewport=i),this._viewport=i}#Y=Oe(Fm);get _connection(){return h(this.#Y)}set _connection(i){J(this.#Y,i)}#K=ne(()=>this._connection.inProgress?{...this._connection,to:Zd(this._connection.to,[this.viewport.x,this.viewport.y,this.viewport.zoom])}:this._connection);get connection(){return h(this.#K)}set connection(i){J(this.#K,i)}#Z=ne(()=>t.props.connectionMode??Iu.Strict);get connectionMode(){return h(this.#Z)}set connectionMode(i){J(this.#Z,i)}#J=ne(()=>t.props.connectionRadius??20);get connectionRadius(){return h(this.#J)}set connectionRadius(i){J(this.#J,i)}#Q=ne(()=>t.props.isValidConnection??(()=>!0));get isValidConnection(){return h(this.#Q)}set isValidConnection(i){J(this.#Q,i)}#$=ne(()=>t.props.selectNodesOnDrag??!0);get selectNodesOnDrag(){return h(this.#$)}set selectNodesOnDrag(i){J(this.#$,i)}#ee=ne(()=>t.props.defaultMarkerColor===void 0?"#b1b1b7":t.props.defaultMarkerColor);get defaultMarkerColor(){return h(this.#ee)}set defaultMarkerColor(i){J(this.#ee,i)}#te=ne(()=>NA(t.edges,{defaultColor:this.defaultMarkerColor,id:this.flowId,defaultMarkerStart:this.defaultEdgeOptions.markerStart,defaultMarkerEnd:this.defaultEdgeOptions.markerEnd}));get markers(){return h(this.#te)}set markers(i){J(this.#te,i)}#ne=ne(()=>t.props.onlyRenderVisibleElements??!1);get onlyRenderVisibleElements(){return h(this.#ne)}set onlyRenderVisibleElements(i){J(this.#ne,i)}#ie=ne(()=>t.props.onflowerror??cA);get onerror(){return h(this.#ie)}set onerror(i){J(this.#ie,i)}#re=ne(()=>t.props.ondelete);get ondelete(){return h(this.#re)}set ondelete(i){J(this.#re,i)}#se=ne(()=>t.props.onbeforedelete);get onbeforedelete(){return h(this.#se)}set onbeforedelete(i){J(this.#se,i)}#ae=ne(()=>t.props.onbeforeconnect);get onbeforeconnect(){return h(this.#ae)}set onbeforeconnect(i){J(this.#ae,i)}#oe=ne(()=>t.props.onconnect);get onconnect(){return h(this.#oe)}set onconnect(i){J(this.#oe,i)}#le=ne(()=>t.props.onconnectstart);get onconnectstart(){return h(this.#le)}set onconnectstart(i){J(this.#le,i)}#ce=ne(()=>t.props.onconnectend);get onconnectend(){return h(this.#ce)}set onconnectend(i){J(this.#ce,i)}#ue=ne(()=>t.props.onbeforereconnect);get onbeforereconnect(){return h(this.#ue)}set onbeforereconnect(i){J(this.#ue,i)}#de=ne(()=>t.props.onreconnect);get onreconnect(){return h(this.#de)}set onreconnect(i){J(this.#de,i)}#fe=ne(()=>t.props.onreconnectstart);get onreconnectstart(){return h(this.#fe)}set onreconnectstart(i){J(this.#fe,i)}#he=ne(()=>t.props.onreconnectend);get onreconnectend(){return h(this.#he)}set onreconnectend(i){J(this.#he,i)}#pe=ne(()=>t.props.clickConnect??!0);get clickConnect(){return h(this.#pe)}set clickConnect(i){J(this.#pe,i)}#ge=ne(()=>t.props.onclickconnectstart);get onclickconnectstart(){return h(this.#ge)}set onclickconnectstart(i){J(this.#ge,i)}#me=ne(()=>t.props.onclickconnectend);get onclickconnectend(){return h(this.#me)}set onclickconnectend(i){J(this.#me,i)}#ve=Oe(null);get clickConnectStartHandle(){return h(this.#ve)}set clickConnectStartHandle(i){J(this.#ve,i)}#ye=ne(()=>t.props.onselectiondrag);get onselectiondrag(){return h(this.#ye)}set onselectiondrag(i){J(this.#ye,i)}#be=ne(()=>t.props.onselectiondragstart);get onselectiondragstart(){return h(this.#be)}set onselectiondragstart(i){J(this.#be,i)}#we=ne(()=>t.props.onselectiondragstop);get onselectiondragstop(){return h(this.#we)}set onselectiondragstop(i){J(this.#we,i)}resolveFitView=async()=>{this.panZoom&&(await aA({nodes:this.nodeLookup,width:this.width,height:this.height,panZoom:this.panZoom,minZoom:this.minZoom,maxZoom:this.maxZoom},this.fitViewOptions),this.fitViewResolver?.resolve(!0),this.fitViewQueued=!1,this.fitViewOptions=void 0,this.fitViewResolver=null)};_prefersDark=new TN("(prefers-color-scheme: dark)",t.props.colorModeSSR==="dark");#xe=ne(()=>t.props.colorMode==="system"?this._prefersDark.current?"dark":"light":t.props.colorMode??"light");get colorMode(){return h(this.#xe)}set colorMode(i){J(this.#xe,i)}constructor(){}resetStoreValues(){this.dragging=!1,this.selectionRect=null,this.selectionRectMode=null,this.selectionKeyPressed=!1,this.multiselectionKeyPressed=!1,this.deleteKeyPressed=!1,this.panActivationKeyPressed=!1,this.zoomActivationKeyPressed=!1,this._connection=Fm,this.clickConnectStartHandle=null,this.viewport=t.props.initialViewport??{x:0,y:0,zoom:1},this.ariaLiveMessage=""}}return new e}function Ql(){const t=w1(zm);if(!t)throw new Error("To call useStore outside of <SvelteFlow /> you need to wrap your component in a <SvelteFlowProvider />");return t.getStore()}const zm=Symbol();function RN(t){const e=FN(t);function n(C){e.nodeTypes={...R5,...C}}function i(C){e.edgeTypes={...B5,...C}}function r(C){e.edges=xA(C,e.edges)}const s=(C,N=!1)=>{e.nodes=e.nodes.map(B=>{if(e.connection.inProgress&&e.connection.fromNode.id===B.id){const F=e.nodeLookup.get(B.id);F&&(e.connection={...e.connection,from:Ec(F,e.connection.fromHandle,Kt.Left,!0)})}const P=C.get(B.id);return P?{...B,position:P.position,dragging:N}:B})};function a(C){const{changes:N,updatedInternals:B}=OA(C,e.nodeLookup,e.parentLookup,e.domNode,e.nodeOrigin,e.nodeExtent,e.zIndexMode);if(!B)return;EA(e.nodeLookup,e.parentLookup,{nodeOrigin:e.nodeOrigin,nodeExtent:e.nodeExtent,zIndexMode:e.zIndexMode}),e.fitViewQueued&&e.resolveFitView();const P=new Map;for(const F of N){const q=e.nodeLookup.get(F.id)?.internals.userNode;if(!q)continue;const Z={...q};switch(F.type){case"dimensions":{const W={...Z.measured,...F.dimensions};F.setAttributes&&(Z.width=F.dimensions?.width??Z.width,Z.height=F.dimensions?.height??Z.height),Z.measured=W;break}case"position":Z.position=F.position??Z.position;break}P.set(F.id,Z)}e.nodes=e.nodes.map(F=>P.get(F.id)??F)}function o(C){const N=e.fitViewResolver??Promise.withResolvers();return e.fitViewQueued=!0,e.fitViewOptions=C,e.fitViewResolver=N,e.nodes=[...e.nodes],N.promise}async function l(C,N,B){const P=typeof B?.zoom<"u"?B.zoom:e.maxZoom,F=e.panZoom;return F?(await F.setViewport({x:e.width/2-C*P,y:e.height/2-N*P,zoom:P},{duration:B?.duration,ease:B?.ease,interpolate:B?.interpolate}),Promise.resolve(!0)):Promise.resolve(!1)}function c(C,N){const B=e.panZoom;return B?B.scaleBy(C,N):Promise.resolve(!1)}function u(C){return c(1.2,C)}function f(C){return c(1/1.2,C)}function p(C){const N=e.panZoom;N&&(N.setScaleExtent([C,e.maxZoom]),e.minZoom=C)}function d(C){const N=e.panZoom;N&&(N.setScaleExtent([e.minZoom,C]),e.maxZoom=C)}function y(C){const N=e.panZoom;N&&(N.setTranslateExtent(C),e.translateExtent=C)}function m(C,N=null){let B=!1;const P=C.map(F=>(N?N.has(F.id):!0)&&F.selected?(B=!0,{...F,selected:!1}):F);return[B,P]}function w(C){const N=C?.nodes?new Set(C.nodes.map(W=>W.id)):null,[B,P]=m(e.nodes,N);B&&(e.nodes=P);const F=C?.edges?new Set(C.edges.map(W=>W.id)):null,[q,Z]=m(e.edges,F);q&&(e.edges=Z)}function b(C){const N=e.multiselectionKeyPressed;e.nodes=e.nodes.map(B=>{const P=C.includes(B.id),F=N&&B.selected||P;return!!B.selected!==F?{...B,selected:F}:B}),N||w({nodes:[]})}function S(C){const N=e.multiselectionKeyPressed;e.edges=e.edges.map(B=>{const P=C.includes(B.id),F=N&&B.selected||P;return!!B.selected!==F?{...B,selected:F}:B}),N||w({edges:[]})}function A(C,N,B){const P=e.nodeLookup.get(C);if(!P){console.warn("012",Fd.error012(C));return}e.selectionRect=null,e.selectionRectMode=null,P.selected?(N||P.selected&&e.multiselectionKeyPressed)&&(w({nodes:[P],edges:[]}),requestAnimationFrame(()=>B?.blur())):b([C])}function _(C){const N=e.edgeLookup.get(C);if(!N){console.warn("012",Fd.error012(C));return}(N.selectable||e.elementsSelectable&&typeof N.selectable>"u")&&(e.selectionRect=null,e.selectionRectMode=null,N.selected?N.selected&&e.multiselectionKeyPressed&&w({nodes:[],edges:[N]}):S([C]))}function I(C,N){const{nodeExtent:B,snapGrid:P,nodeOrigin:F,nodeLookup:q,nodesDraggable:Z,onerror:W}=e,Y=new Map,ue=P?.[0]??5,le=P?.[1]??5,O=C.x*ue*N,V=C.y*le*N;for(const G of q.values()){if(!(G.selected&&(G.draggable||Z&&typeof G.draggable>"u")))continue;let ae={x:G.internals.positionAbsolute.x+O,y:G.internals.positionAbsolute.y+V};P&&(ae=Kd(ae,P));const{position:ee,positionAbsolute:de}=g5({nodeId:G.id,nextPosition:ae,nodeLookup:q,nodeExtent:B,nodeOrigin:F,onError:W});G.position=ee,G.internals.positionAbsolute=de,Y.set(G.id,G)}s(Y)}function E(C){return FA({delta:C,panZoom:e.panZoom,transform:[e.viewport.x,e.viewport.y,e.viewport.zoom],translateExtent:e.translateExtent,width:e.width,height:e.height})}const M=C=>{e._connection={...C}};function T(){e._connection=Fm}function D(){e.resetStoreValues(),w()}return Object.assign(e,{setNodeTypes:n,setEdgeTypes:i,addEdge:r,updateNodePositions:s,updateNodeInternals:a,zoomIn:u,zoomOut:f,fitView:o,setCenter:l,setMinZoom:p,setMaxZoom:d,setTranslateExtent:y,unselectNodesAndEdges:w,addSelectedNodes:b,addSelectedEdges:S,handleNodeSelection:A,handleEdgeSelection:_,moveSelectedNodes:I,panBy:E,updateConnection:M,cancelConnection:T,reset:D})}function BN(t,e){const{minZoom:n,maxZoom:i,initialViewport:r,onPanZoomStart:s,onPanZoom:a,onPanZoomEnd:o,translateExtent:l,setPanZoomInstance:c,onDraggingChange:u,onTransformChange:f}=e,p=$A({domNode:t,minZoom:n,maxZoom:i,translateExtent:l,viewport:r,onPanZoom:a,onPanZoomStart:s,onPanZoomEnd:o,onDraggingChange:u}),d=p.getViewport();return(r.x!==d.x||r.y!==d.y||r.zoom!==d.zoom)&&f([d.x,d.y,d.zoom]),c(p),p.update(e),{update(y){p.update(y)}}}var zN=Me('<div class="svelte-flow__zoom svelte-flow__container"><!></div>');function qN(t,e){Tt(e,!0);let n=ct(e,"store",15),i=ne(()=>n().panActivationKeyPressed||e.panOnDrag),r=ne(()=>n().panActivationKeyPressed||e.panOnScroll);const{viewport:s}=n();let a=!1;mn(()=>{!a&&n().viewportInitialized&&(e.oninit?.(),a=!0)});var o=zN(),l=se(o);gs(l,()=>e.children),Q(o),wt(o,(c,u)=>BN?.(c,u),()=>({viewport:n().viewport,minZoom:n().minZoom,maxZoom:n().maxZoom,initialViewport:s,onDraggingChange:c=>{n(n().dragging=c,!0)},setPanZoomInstance:c=>{n(n().panZoom=c,!0)},onPanZoomStart:e.onmovestart,onPanZoom:e.onmove,onPanZoomEnd:e.onmoveend,zoomOnScroll:e.zoomOnScroll,zoomOnDoubleClick:e.zoomOnDoubleClick,zoomOnPinch:e.zoomOnPinch,panOnScroll:h(r),panOnDrag:h(i),panOnScrollSpeed:e.panOnScrollSpeed,panOnScrollMode:e.panOnScrollMode,zoomActivationKeyPressed:n().zoomActivationKeyPressed,preventScrolling:typeof e.preventScrolling=="boolean"?e.preventScrolling:!0,noPanClassName:n().noPanClass,noWheelClassName:n().noWheelClass,userSelectionActive:!!n().selectionRect,translateExtent:n().translateExtent,lib:"svelte",paneClickDistance:e.paneClickDistance,selectionOnDrag:e.selectionOnDrag,onTransformChange:c=>{n(n().viewport={x:c[0],y:c[1],zoom:c[2]},!0)},connectionInProgress:n().connection.inProgress})),j(t,o),Dt()}function Hv(t,e){return n=>{n.target===e&&t?.(n)}}function Uv(t){return e=>{const n=t.has(e.id);return!!e.selected!==n?{...e,selected:n}:e}}function Wv(t,e){if(t.size!==e.size)return!1;for(const n of t)if(!e.has(n))return!1;return!0}var jN=Me("<div><!></div>");function HN(t,e){Tt(e,!0);let n=ct(e,"store",15),i=ct(e,"panOnDrag",3,!0),r=ct(e,"paneClickDistance",3,1),s,a=null,o=new Set,l=new Set,c=ne(()=>n().panActivationKeyPressed||i()),u=ne(()=>n().selectionKeyPressed||!!n().selectionRect||e.selectionOnDrag&&h(c)!==!0),f=ne(()=>n().elementsSelectable&&(h(u)||n().selectionRectMode==="user")),p=!1;function d(T){if(a=s?.getBoundingClientRect(),!a)return;const D=T.target===s,U=!D&&!!T.target.closest(".nokey"),C=e.selectionOnDrag&&D||n().selectionKeyPressed;if(U||!h(u)||!C||T.button!==0||!T.isPrimary)return;T.target?.setPointerCapture?.(T.pointerId),p=!1;const{x:N,y:B}=Ea(T,a);n(n().selectionRect={width:0,height:0,startX:N,startY:B,x:N,y:B},!0),D||(T.stopPropagation(),T.preventDefault())}function y(T){if(!h(u)||!a||!n().selectionRect)return;const D=Ea(T,a),{startX:U=0,startY:C=0}=n().selectionRect;if(!p){const q=n().selectionKeyPressed?0:r();if(Math.hypot(D.x-U,D.y-C)<=q)return;n().unselectNodesAndEdges(),e.onselectionstart?.(T)}p=!0;const N={...n().selectionRect,x:D.x<U?D.x:U,y:D.y<C?D.y:C,width:Math.abs(D.x-U),height:Math.abs(D.y-C)},B=o,P=l;o=new Set(O1(n().nodeLookup,N,[n().viewport.x,n().viewport.y,n().viewport.zoom],n().selectionMode===Dh.Partial,!0).map(q=>q.id));const F=n().defaultEdgeOptions.selectable??!0;l=new Set;for(const q of o){const Z=n().connectionLookup.get(q);if(Z)for(const{edgeId:W}of Z.values()){const Y=n().edgeLookup.get(W);Y&&(Y.selectable??F)&&l.add(W)}}Wv(B,o)||n(n().nodes=n().nodes.map(Uv(o)),!0),Wv(P,l)||n(n().edges=n().edges.map(Uv(l)),!0),n(n().selectionRectMode="user",!0),n(n().selectionRect=N,!0)}function m(T){T.button===0&&(T.target?.releasePointerCapture?.(T.pointerId),!p&&T.target===s&&S?.(T),n(n().selectionRect=null,!0),p&&n(n().selectionRectMode=o.size>0?"nodes":null,!0),p&&e.onselectionend?.(T))}const w=T=>{if(Array.isArray(h(c))&&h(c).includes(2)){T.preventDefault();return}e.onpanecontextmenu?.({event:T})},b=T=>{p&&(T.stopPropagation(),p=!1)};function S(T){if(p||n().connection.inProgress){p=!1;return}e.onpaneclick?.({event:T}),n().unselectNodesAndEdges(),n(n().selectionRectMode=null,!0),n(n().selectionRect=null,!0)}var A=jN();let _;var I=ne(()=>h(f)?void 0:Hv(S,s));A.__click=function(...T){h(I)?.apply(this,T)},A.__pointermove=function(...T){(h(f)?y:void 0)?.apply(this,T)},A.__pointerup=function(...T){(h(f)?m:void 0)?.apply(this,T)};var E=ne(()=>Hv(w,s));A.__contextmenu=function(...T){h(E)?.apply(this,T)};var M=se(A);gs(M,()=>e.children),Q(A),ji(A,T=>s=T,()=>s),_e(T=>_=Xt(A,1,"svelte-flow__pane svelte-flow__container",null,_,T),[()=>({draggable:i()===!0||Array.isArray(i())&&i().includes(0),dragging:n().dragging,selection:h(u)})]),yn("pointerdown",A,function(...T){(h(f)?d:void 0)?.apply(this,T)},!0),yn("click",A,function(...T){(h(f)?b:void 0)?.apply(this,T)},!0),j(t,A),Dt()}Kn(["click","pointermove","pointerup","contextmenu"]);var UN=Me('<div class="svelte-flow__viewport xyflow__viewport svelte-flow__container"><!></div>');function WN(t,e){Tt(e,!0);var n=UN();let i;var r=se(n);gs(r,()=>e.children),Q(n),_e(()=>i=An(n,"",i,{transform:`translate(${e.store.viewport.x??""}px, ${e.store.viewport.y??""}px) scale(${e.store.viewport.zoom??""})`})),j(t,n),Dt()}function z5(t,e){const{store:n,onDrag:i,onDragStart:r,onDragStop:s,onNodeMouseDown:a}=e,o=qA({onDrag:i,onDragStart:r,onDragStop:s,onNodeMouseDown:a,getStoreItems:()=>{const{snapGrid:c,viewport:u}=n;return{nodes:n.nodes,nodeLookup:n.nodeLookup,edges:n.edges,nodeExtent:n.nodeExtent,snapGrid:c||[0,0],snapToGrid:!!c,nodeOrigin:n.nodeOrigin,multiSelectionActive:n.multiselectionKeyPressed,domNode:n.domNode,transform:[u.x,u.y,u.zoom],autoPanOnNodeDrag:n.autoPanOnNodeDrag,nodesDraggable:n.nodesDraggable,selectNodesOnDrag:n.selectNodesOnDrag,nodeDragThreshold:n.nodeDragThreshold,unselectNodesAndEdges:n.unselectNodesAndEdges,updateNodePositions:n.updateNodePositions,onSelectionDrag:n.onselectiondrag,onSelectionDragStart:n.onselectiondragstart,onSelectionDragStop:n.onselectiondragstop,panBy:n.panBy}}});function l(c,u){if(u.disabled){o.destroy();return}o.update({domNode:c,noDragClassName:u.noDragClass,handleSelector:u.handleSelector,nodeId:u.nodeId,isSelectable:u.isSelectable,nodeClickDistance:u.nodeClickDistance})}return l(t,e),{update(c){l(t,c)},destroy(){o.destroy()}}}var VN=Me('<div aria-live="assertive" aria-atomic="true" class="a11y-live-msg svelte-13pq11u"> </div>'),GN=Me('<div class="a11y-hidden svelte-13pq11u"> </div> <div class="a11y-hidden svelte-13pq11u"> </div> <!>',1);function XN(t,e){Tt(e,!0);var n=GN(),i=Ue(n),r=se(i,!0);Q(i);var s=be(i,2),a=se(s,!0);Q(s);var o=be(s,2);{var l=c=>{var u=VN(),f=se(u,!0);Q(u),_e(()=>{fe(u,"id",`${YN}-${e.store.flowId}`),Wt(f,e.store.ariaLiveMessage)}),j(c,u)};ke(o,c=>{e.store.disableKeyboardA11y||c(l)})}_e(()=>{fe(i,"id",`${q5}-${e.store.flowId}`),Wt(r,e.store.disableKeyboardA11y?e.store.ariaLabelConfig["node.a11yDescription.default"]:e.store.ariaLabelConfig["node.a11yDescription.keyboardDisabled"]),fe(s,"id",`${j5}-${e.store.flowId}`),Wt(a,e.store.ariaLabelConfig["edge.a11yDescription.default"])}),j(t,n),Dt()}const q5="svelte-flow__node-desc",j5="svelte-flow__edge-desc",YN="svelte-flow__aria-live";var KN=Me("<div><!></div>");function ZN(t,e){Tt(e,!0);let n=ct(e,"store",15),i=ne(()=>ns(e.node.data,()=>({}),!0)),r=ne(()=>ns(e.node.selected,!1)),s=ne(()=>e.node.draggable),a=ne(()=>e.node.selectable),o=ne(()=>ns(e.node.deletable,!0)),l=ne(()=>e.node.connectable),c=ne(()=>e.node.focusable),u=ne(()=>ns(e.node.hidden,!1)),f=ne(()=>ns(e.node.dragging,!1)),p=ne(()=>ns(e.node.style,"")),d=ne(()=>e.node.class),y=ne(()=>ns(e.node.type,"default")),m=ne(()=>e.node.parentId),w=ne(()=>e.node.sourcePosition),b=ne(()=>e.node.targetPosition),S=ne(()=>ns(e.node.measured,()=>({width:0,height:0}),!0).width),A=ne(()=>ns(e.node.measured,()=>({width:0,height:0}),!0).height),_=ne(()=>e.node.initialWidth),I=ne(()=>e.node.initialHeight),E=ne(()=>e.node.width),M=ne(()=>e.node.height),T=ne(()=>e.node.dragHandle),D=ne(()=>ns(e.node.internals.z,0)),U=ne(()=>e.node.internals.positionAbsolute.x),C=ne(()=>e.node.internals.positionAbsolute.y),N=ne(()=>e.node.internals.userNode),{id:B}=e.node,P=ne(()=>h(s)??n().nodesDraggable),F=ne(()=>h(a)??n().elementsSelectable),q=ne(()=>h(l)??n().nodesConnectable),Z=ne(()=>fA(e.node)),W=ne(()=>!!e.node.internals.handleBounds),Y=ne(()=>h(Z)&&h(W)),ue=ne(()=>h(c)??n().nodesFocusable);function le(Be){return n().parentLookup.has(Be)}let O=ne(()=>le(B)),V=Oe(null),G=null,re=h(y),ae=h(w),ee=h(b),de=ne(()=>n().nodeTypes[h(y)]??O5),he=ne(()=>n().ariaLabelConfig),pe={get value(){return h(q)}};lN(B),uN(pe);let ge=ne(()=>{const Be=h(S)===void 0?h(E)??h(_):h(E),Ie=h(A)===void 0?h(M)??h(I):h(M);if(!(Be===void 0&&Ie===void 0&&h(p)===void 0))return`${h(p)};${Be?`width:${ho(Be)};`:""}${Ie?`height:${ho(Ie)};`:""}`});mn(()=>{(h(y)!==re||h(w)!==ae||h(b)!==ee)&&h(V)!==null&&requestAnimationFrame(()=>{h(V)!==null&&n().updateNodeInternals(new Map([[B,{id:B,nodeElement:h(V),force:!0}]]))}),re=h(y),ae=h(w),ee=h(b)}),mn(()=>{e.resizeObserver&&(!h(Y)||h(V)!==G)&&(G&&e.resizeObserver.unobserve(G),h(V)&&e.resizeObserver.observe(h(V)),G=h(V))}),Ei(()=>{G&&e.resizeObserver?.unobserve(G)});function Ee(Be){h(F)&&(!n().selectNodesOnDrag||!h(P)||n().nodeDragThreshold>0)&&n().handleNodeSelection(B),e.onnodeclick?.({node:h(N),event:Be})}function Ae(Be){if(!(w5(Be)||n().disableKeyboardA11y))if(h5.includes(Be.key)&&h(F)){const Ie=Be.key==="Escape";n().handleNodeSelection(B,Ie,h(V))}else h(P)&&e.node.selected&&Object.prototype.hasOwnProperty.call(zh,Be.key)&&(Be.preventDefault(),n(n().ariaLiveMessage=h(he)["node.a11yDescription.ariaLiveMessage"]({direction:Be.key.replace("Arrow","").toLowerCase(),x:~~e.node.internals.positionAbsolute.x,y:~~e.node.internals.positionAbsolute.y}),!0),n().moveSelectedNodes(zh[Be.key],Be.shiftKey?4:1))}const Ye=()=>{if(n().disableKeyboardA11y||!n().autoPanOnNodeFocus||!h(V)?.matches(":focus-visible"))return;const{width:Be,height:Ie,viewport:lt}=n();O1(new Map([[B,e.node]]),{x:0,y:0,width:Be,height:Ie},[lt.x,lt.y,lt.zoom],!0).length>0||n().setCenter(e.node.position.x+(e.node.measured.width??0)/2,e.node.position.y+(e.node.measured.height??0)/2,{zoom:lt.zoom})};var K=$e(),Re=Ue(K);{var Qe=Be=>{var Ie=KN();Jl(Ie,()=>({"data-id":B,class:["svelte-flow__node",`svelte-flow__node-${h(y)}`,h(d)],style:h(ge),onclick:Ee,onpointerenter:e.onnodepointerenter?We=>e.onnodepointerenter({node:h(N),event:We}):void 0,onpointerleave:e.onnodepointerleave?We=>e.onnodepointerleave({node:h(N),event:We}):void 0,onpointermove:e.onnodepointermove?We=>e.onnodepointermove({node:h(N),event:We}):void 0,oncontextmenu:e.onnodecontextmenu?We=>e.onnodecontextmenu({node:h(N),event:We}):void 0,onkeydown:h(ue)?Ae:void 0,onfocus:h(ue)?Ye:void 0,tabIndex:h(ue)?0:void 0,role:e.node.ariaRole??(h(ue)?"group":void 0),"aria-roledescription":"node","aria-describedby":n().disableKeyboardA11y?void 0:`${q5}-${n().flowId}`,...e.node.domAttributes,[ql]:{dragging:h(f),selected:h(r),draggable:h(P),connectable:h(q),selectable:h(F),nopan:h(P),parent:h(O)},[Jo]:{"z-index":h(D),transform:`translate(${h(U)??""}px, ${h(C)??""}px)`,visibility:h(Z)?"visible":"hidden"}}));var lt=se(Ie);x1(lt,()=>h(de),(We,Ke)=>{Ke(We,{get data(){return h(i)},get id(){return B},get selected(){return h(r)},get selectable(){return h(F)},get deletable(){return h(o)},get sourcePosition(){return h(w)},get targetPosition(){return h(b)},get zIndex(){return h(D)},get dragging(){return h(f)},get draggable(){return h(P)},get dragHandle(){return h(T)},get parentId(){return h(m)},get type(){return h(y)},get isConnectable(){return h(q)},get positionAbsoluteX(){return h(U)},get positionAbsoluteY(){return h(C)},get width(){return h(E)},get height(){return h(M)}})}),Q(Ie),wt(Ie,(We,Ke)=>z5?.(We,Ke),()=>({nodeId:B,isSelectable:h(F),disabled:!h(P),handleSelector:h(T),noDragClass:n().noDragClass,nodeClickDistance:e.nodeClickDistance,onNodeMouseDown:n().handleNodeSelection,onDrag:(We,Ke,ht,Rt)=>{e.onnodedrag?.({event:We,targetNode:ht,nodes:Rt})},onDragStart:(We,Ke,ht,Rt)=>{e.onnodedragstart?.({event:We,targetNode:ht,nodes:Rt})},onDragStop:(We,Ke,ht,Rt)=>{e.onnodedragstop?.({event:We,targetNode:ht,nodes:Rt})},store:n()})),ji(Ie,We=>J(V,We),()=>h(V)),j(Be,Ie)};ke(Re,Be=>{h(u)||Be(Qe)})}j(t,K),Dt()}var JN=Me('<div class="svelte-flow__nodes"></div>');function QN(t,e){Tt(e,!0);let n=ct(e,"store",15);const i=typeof ResizeObserver>"u"?null:new ResizeObserver(s=>{const a=new Map;s.forEach(o=>{const l=o.target.getAttribute("data-id");a.set(l,{id:l,nodeElement:o.target,force:!0})}),n().updateNodeInternals(a)});Ei(()=>{i?.disconnect()});var r=JN();fn(r,21,()=>n().visible.nodes.values(),s=>s.id,(s,a)=>{ZN(s,{get node(){return h(a)},get resizeObserver(){return i},get nodeClickDistance(){return e.nodeClickDistance},get onnodeclick(){return e.onnodeclick},get onnodepointerenter(){return e.onnodepointerenter},get onnodepointermove(){return e.onnodepointermove},get onnodepointerleave(){return e.onnodepointerleave},get onnodedrag(){return e.onnodedrag},get onnodedragstart(){return e.onnodedragstart},get onnodedragstop(){return e.onnodedragstop},get onnodecontextmenu(){return e.onnodecontextmenu},get store(){return n()},set store(o){n(o)}})}),Q(r),j(t,r),Dt()}var $N=rt('<svg class="svelte-flow__edge-wrapper"><g><!></g></svg>');function eC(t,e){Tt(e,!0);let n=ne(()=>e.edge.id),i=ne(()=>e.edge.source),r=ne(()=>e.edge.target),s=ne(()=>e.edge.sourceX),a=ne(()=>e.edge.sourceY),o=ne(()=>e.edge.targetX),l=ne(()=>e.edge.targetY),c=ne(()=>e.edge.sourcePosition),u=ne(()=>e.edge.targetPosition),f=ne(()=>ns(e.edge.animated,!1)),p=ne(()=>ns(e.edge.selected,!1)),d=ne(()=>e.edge.label),y=ne(()=>e.edge.labelStyle),m=ne(()=>ns(e.edge.data,()=>({}),!0)),w=ne(()=>e.edge.style),b=ne(()=>e.edge.interactionWidth),S=ne(()=>ns(e.edge.type,"default")),A=ne(()=>e.edge.sourceHandle),_=ne(()=>e.edge.targetHandle),I=ne(()=>e.edge.markerStart),E=ne(()=>e.edge.markerEnd),M=ne(()=>e.edge.selectable),T=ne(()=>e.edge.focusable),D=ne(()=>ns(e.edge.deletable,!0)),U=ne(()=>e.edge.hidden),C=ne(()=>e.edge.zIndex),N=ne(()=>e.edge.class),B=ne(()=>e.edge.ariaLabel);fN(h(n));let P=null,F=ne(()=>h(M)??e.store.elementsSelectable),q=ne(()=>h(T)??e.store.edgesFocusable),Z=ne(()=>e.store.edgeTypes[h(S)]??F5),W=ne(()=>h(I)?`url('#${Bm(h(I),e.store.flowId)}')`:void 0),Y=ne(()=>h(E)?`url('#${Bm(h(E),e.store.flowId)}')`:void 0);function ue(ae){const ee=e.store.edgeLookup.get(h(n));ee&&(h(F)&&e.store.handleEdgeSelection(h(n)),e.onedgeclick?.({event:ae,edge:ee}))}function le(ae,ee){const de=e.store.edgeLookup.get(h(n));de&&ee({event:ae,edge:de})}function O(ae){if(!e.store.disableKeyboardA11y&&h5.includes(ae.key)&&h(F)){const{unselectNodesAndEdges:ee,addSelectedEdges:de}=e.store;ae.key==="Escape"?(P?.blur(),ee({edges:[e.edge]})):de([h(n)])}}var V=$e(),G=Ue(V);{var re=ae=>{var ee=$N();let de;var he=se(ee);Jl(he,()=>({class:["svelte-flow__edge",h(N)],"data-id":h(n),onclick:ue,oncontextmenu:e.onedgecontextmenu?ge=>{le(ge,e.onedgecontextmenu)}:void 0,onpointerenter:e.onedgepointerenter?ge=>{le(ge,e.onedgepointerenter)}:void 0,onpointerleave:e.onedgepointerleave?ge=>{le(ge,e.onedgepointerleave)}:void 0,"aria-label":h(B)===null?void 0:h(B)?h(B):`Edge from ${h(i)} to ${h(r)}`,"aria-describedby":h(q)?`${j5}-${e.store.flowId}`:void 0,role:e.edge.ariaRole??(h(q)?"group":"img"),"aria-roledescription":"edge",onkeydown:h(q)?O:void 0,tabindex:h(q)?0:void 0,...e.edge.domAttributes,[ql]:{animated:h(f),selected:h(p),selectable:h(F)}}));var pe=se(he);x1(pe,()=>h(Z),(ge,Ee)=>{Ee(ge,{get id(){return h(n)},get source(){return h(i)},get target(){return h(r)},get sourceX(){return h(s)},get sourceY(){return h(a)},get targetX(){return h(o)},get targetY(){return h(l)},get sourcePosition(){return h(c)},get targetPosition(){return h(u)},get animated(){return h(f)},get selected(){return h(p)},get label(){return h(d)},get labelStyle(){return h(y)},get data(){return h(m)},get style(){return h(w)},get interactionWidth(){return h(b)},get selectable(){return h(F)},get deletable(){return h(D)},get type(){return h(S)},get sourceHandleId(){return h(A)},get targetHandleId(){return h(_)},get markerStart(){return h(W)},get markerEnd(){return h(Y)}})}),Q(he),ji(he,ge=>P=ge,()=>P),Q(ee),_e(()=>de=An(ee,"",de,{"z-index":h(C)})),j(ae,ee)};ke(G,ae=>{h(U)||ae(re)})}j(t,V),Dt()}var tC=rt("<defs></defs>");function nC(t,e){Tt(e,!1);const n=Ql();tS();var i=tC();fn(i,5,()=>n.markers,r=>r.id,(r,s)=>{aC(r,Ah(()=>h(s)))}),Q(i),j(t,i),Dt()}var iC=rt('<polyline class="arrow" fill="none" stroke-linecap="round" stroke-linejoin="round" points="-5,-4 0,0 -5,4"></polyline>'),rC=rt('<polyline class="arrowclosed" stroke-linecap="round" stroke-linejoin="round" points="-5,-4 0,0 -5,4 -5,-4"></polyline>'),sC=rt('<marker class="svelte-flow__arrowhead" viewBox="-10 -10 20 20" refX="0" refY="0"><!></marker>');function aC(t,e){Tt(e,!0);let n=ct(e,"width",3,12.5),i=ct(e,"height",3,12.5),r=ct(e,"markerUnits",3,"strokeWidth"),s=ct(e,"orient",3,"auto-start-reverse"),a=ct(e,"color",3,"none");var o=sC(),l=se(o);{var c=f=>{var p=iC();let d;_e(()=>{fe(p,"stroke-width",e.strokeWidth),d=An(p,"",d,{stroke:a()})}),j(f,p)},u=f=>{var p=$e(),d=Ue(p);{var y=m=>{var w=rC();let b;_e(()=>{fe(w,"stroke-width",e.strokeWidth),b=An(w,"",b,{stroke:a(),fill:a()})}),j(m,w)};ke(d,m=>{e.type===Oh.ArrowClosed&&m(y)},!0)}j(f,p)};ke(l,f=>{e.type===Oh.Arrow?f(c):f(u,!1)})}Q(o),_e(()=>{fe(o,"id",e.id),fe(o,"markerWidth",`${n()}`),fe(o,"markerHeight",`${i()}`),fe(o,"markerUnits",r()),fe(o,"orient",s())}),j(t,o),Dt()}var oC=Me('<div class="svelte-flow__edges"><svg class="svelte-flow__marker"><!></svg> <!></div>');function lC(t,e){Tt(e,!0);let n=ct(e,"store",15);var i=oC(),r=se(i),s=se(r);nC(s,{}),Q(r);var a=be(r,2);fn(a,17,()=>n().visible.edges.values(),o=>o.id,(o,l)=>{eC(o,{get edge(){return h(l)},get onedgeclick(){return e.onedgeclick},get onedgecontextmenu(){return e.onedgecontextmenu},get onedgepointerenter(){return e.onedgepointerenter},get onedgepointerleave(){return e.onedgepointerleave},get store(){return n()},set store(c){n(c)}})}),Q(i),j(t,i),Dt()}var cC=Me('<div class="svelte-flow__selection svelte-1vr3gfi"></div>');function H5(t,e){Tt(e,!0);let n=ct(e,"x",3,0),i=ct(e,"y",3,0),r=ct(e,"width",3,0),s=ct(e,"height",3,0),a=ct(e,"isVisible",3,!0);var o=$e(),l=Ue(o);{var c=u=>{var f=cC();let p;_e(d=>p=An(f,"",p,d),[()=>({width:typeof r()=="string"?r():ho(r()),height:typeof s()=="string"?s():ho(s()),transform:`translate(${n()}px, ${i()}px)`})]),j(u,f)};ke(l,u=>{a()&&u(c)})}j(t,o),Dt()}var uC=Me("<div><!></div>");function dC(t,e){Tt(e,!0);let n=Oe(void 0);mn(()=>{e.store.disableKeyboardA11y||h(n)?.focus({preventScroll:!0})});let i=ne(()=>{if(e.store.selectionRectMode==="nodes"){e.store.nodes;const u=up(e.store.nodeLookup,{filter:f=>!!f.selected});if(u.width>0&&u.height>0)return u}return null});function r(u){const f=e.store.nodes.filter(p=>p.selected);e.onselectioncontextmenu?.({nodes:f,event:u})}function s(u){const f=e.store.nodes.filter(p=>p.selected);e.onselectionclick?.({nodes:f,event:u})}function a(u){Object.prototype.hasOwnProperty.call(zh,u.key)&&(u.preventDefault(),e.store.moveSelectedNodes(zh[u.key],u.shiftKey?4:1))}var o=$e(),l=Ue(o);{var c=u=>{var f=uC();f.__contextmenu=r,f.__click=s,f.__keydown=function(...y){(e.store.disableKeyboardA11y?void 0:a)?.apply(this,y)};let p;var d=se(f);H5(d,{width:"100%",height:"100%",x:0,y:0}),Q(f),wt(f,(y,m)=>z5?.(y,m),()=>({disabled:!1,store:e.store,onDrag:(y,m,w,b)=>{e.onnodedrag?.({event:y,targetNode:null,nodes:b})},onDragStart:(y,m,w,b)=>{e.onnodedragstart?.({event:y,targetNode:null,nodes:b})},onDragStop:(y,m,w,b)=>{e.onnodedragstop?.({event:y,targetNode:null,nodes:b})}})),ji(f,y=>J(n,y),()=>h(n)),_e(y=>{Xt(f,1,zc(["svelte-flow__selection-wrapper",e.store.noPanClass]),"svelte-sf2y5e"),fe(f,"role",e.store.disableKeyboardA11y?void 0:"button"),fe(f,"tabindex",e.store.disableKeyboardA11y?void 0:-1),p=An(f,"",p,y)},[()=>({width:ho(h(i).width),height:ho(h(i).height),transform:`translate(${h(i).x??""}px, ${h(i).y??""}px)`})]),j(u,f)};ke(l,u=>{e.store.selectionRectMode==="nodes"&&h(i)&&el(h(i).x)&&el(h(i).y)&&u(c)})}j(t,o),Dt()}Kn(["contextmenu","click","keydown"]);function fC(t){switch(t){case"ctrl":return 8;case"shift":return 4;case"alt":return 2;case"meta":return 1}}function $a(t,e){let{enabled:n=!0,trigger:i,type:r="keydown"}=e;function s(o){const l=Array.isArray(i)?i:[i],c=[o.metaKey,o.altKey,o.shiftKey,o.ctrlKey].reduce((u,f,p)=>f?u|1<<p:u,0);for(const u of l){const f={preventDefault:!1,enabled:!0,...u},{modifier:p,key:d,callback:y,preventDefault:m,enabled:w}=f;if(w){if(o.key!==d)continue;if(p===null||p===!1){if(c!==0)continue}else if(p!==void 0&&p?.[0]?.length>0){const S=Array.isArray(p)?p:[p];let A=!1;for(const _ of S)if((Array.isArray(_)?_:[_]).reduce((E,M)=>E|fC(M),0)===c){A=!0;break}if(!A)continue}m&&o.preventDefault();const b={node:t,trigger:f,originalEvent:o};t.dispatchEvent(new CustomEvent("shortcut",{detail:b})),y?.(b)}}}let a;return n&&(a=km(t,r,s)),{update:o=>{const{enabled:l=!0,type:c="keydown"}=o;n&&(!l||r!==c)?a?.():!n&&l&&(a=km(t,c,s)),n=l,r=c,i=o.trigger},destroy:()=>{a?.()}}}function U5(){const t=ne(Ql),e=s=>{const a=qv(s)?s:h(t).nodeLookup.get(s.id),o=a.parentId?hA(a.position,a.measured,a.parentId,h(t).nodeLookup,h(t).nodeOrigin):a.position,l={...a,position:o,width:a.measured?.width??a.width,height:a.measured?.height??a.height};return Mu(l)};function n(s,a,o={replace:!1}){h(t).nodes=ia(()=>h(t).nodes).map(l=>{if(l.id===s){const c=typeof a=="function"?a(l):a;return o?.replace&&qv(c)?c:{...l,...c}}return l})}function i(s,a,o={replace:!1}){h(t).edges=ia(()=>h(t).edges).map(l=>{if(l.id===s){const c=typeof a=="function"?a(l):a;return o.replace&&_N(c)?c:{...l,...c}}return l})}const r=s=>h(t).nodeLookup.get(s);return{zoomIn:h(t).zoomIn,zoomOut:h(t).zoomOut,getInternalNode:r,getNode:s=>r(s)?.internals.userNode,getNodes:s=>s===void 0?h(t).nodes:Vv(h(t).nodeLookup,s),getEdge:s=>h(t).edgeLookup.get(s),getEdges:s=>s===void 0?h(t).edges:Vv(h(t).edgeLookup,s),setZoom:(s,a)=>{const o=h(t).panZoom;return o?o.scaleTo(s,{duration:a?.duration}):Promise.resolve(!1)},getZoom:()=>h(t).viewport.zoom,setViewport:async(s,a)=>{const o=h(t).viewport;return h(t).panZoom?(await h(t).panZoom.setViewport({x:s.x??o.x,y:s.y??o.y,zoom:s.zoom??o.zoom},a),Promise.resolve(!0)):Promise.resolve(!1)},getViewport:()=>Ib(h(t).viewport),setCenter:async(s,a,o)=>h(t).setCenter(s,a,o),fitView:s=>h(t).fitView(s),fitBounds:async(s,a)=>{if(!h(t).panZoom)return Promise.resolve(!1);const o=F1(s,h(t).width,h(t).height,h(t).minZoom,h(t).maxZoom,a?.padding??.1);return await h(t).panZoom.setViewport(o,{duration:a?.duration,ease:a?.ease,interpolate:a?.interpolate}),Promise.resolve(!0)},getIntersectingNodes:(s,a=!0,o)=>{const l=Cv(s),c=l?s:e(s);return c?(o||h(t).nodes).filter(u=>{const f=h(t).nodeLookup.get(u.id);if(!f||!l&&u.id===s.id)return!1;const p=Mu(f),d=Rd(p,c);return a&&d>0||d>=p.width*p.height||d>=c.width*c.height}):[]},isNodeIntersecting:(s,a,o=!0)=>{const c=Cv(s)?s:e(s);if(!c)return!1;const u=Rd(c,a);return o&&u>0||u>=a.width*a.height||u>=c.width*c.height},deleteElements:async({nodes:s=[],edges:a=[]})=>{const{nodes:o,edges:l}=await oA({nodesToRemove:s,edgesToRemove:a,nodes:h(t).nodes,edges:h(t).edges,onBeforeDelete:h(t).onbeforedelete});return o&&(h(t).nodes=ia(()=>h(t).nodes).filter(c=>!o.some(({id:u})=>u===c.id))),l&&(h(t).edges=ia(()=>h(t).edges).filter(c=>!l.some(({id:u})=>u===c.id))),(o.length>0||l.length>0)&&h(t).ondelete?.({nodes:o,edges:l}),{deletedNodes:o,deletedEdges:l}},screenToFlowPosition:(s,a={snapToGrid:!0})=>{if(!h(t).domNode)return s;const o=a.snapToGrid?h(t).snapGrid:!1,{x:l,y:c,zoom:u}=h(t).viewport,{x:f,y:p}=h(t).domNode.getBoundingClientRect(),d={x:s.x-f,y:s.y-p};return Zd(d,[l,c,u],o!==null,o||[1,1])},flowToScreenPosition:s=>{if(!h(t).domNode)return s;const{x:a,y:o,zoom:l}=h(t).viewport,{x:c,y:u}=h(t).domNode.getBoundingClientRect(),f=Rh(s,[a,o,l]);return{x:f.x+c,y:f.y+u}},toObject:()=>structuredClone({nodes:[...h(t).nodes],edges:[...h(t).edges],viewport:{...h(t).viewport}}),updateNode:n,updateNodeData:(s,a,o)=>{const l=h(t).nodeLookup.get(s)?.internals.userNode;if(!l)return;const c=typeof a=="function"?a(l):a;n(s,u=>({...u,data:o?.replace?c:{...u.data,...c}}))},updateEdge:i,getNodesBounds:s=>iA(s,{nodeLookup:h(t).nodeLookup,nodeOrigin:h(t).nodeOrigin}),getHandleConnections:({type:s,id:a,nodeId:o})=>Array.from(h(t).connectionLookup.get(`${o}-${s}-${a??null}`)?.values()??[])}}function Vv(t,e){const n=[];for(const i of e){const r=t.get(i);if(r){const s="internals"in r?r.internals?.userNode:r;n.push(s)}}return n}function hC(t,e){Tt(e,!0);let n=ct(e,"store",15),i=ct(e,"selectionKey",3,"Shift"),r=ct(e,"multiSelectionKey",19,()=>Bh()?"Meta":"Control"),s=ct(e,"deleteKey",3,"Backspace"),a=ct(e,"panActivationKey",3," "),o=ct(e,"zoomActivationKey",19,()=>Bh()?"Meta":"Control"),{deleteElements:l}=U5();function c(m){return m!==null&&typeof m=="object"}function u(m){return c(m)?m.modifier||[]:[]}function f(m){return m==null?"":c(m)?m.key:m}function p(m,w){return(Array.isArray(m)?m:[m]).map(S=>{const A=f(S);return{key:A,modifier:u(S),enabled:A!==null,callback:w}})}function d(){n(n().selectionRect=null,!0),n(n().selectionKeyPressed=!1,!0),n(n().multiselectionKeyPressed=!1,!0),n(n().deleteKeyPressed=!1,!0),n(n().panActivationKeyPressed=!1,!0),n(n().zoomActivationKeyPressed=!1,!0)}function y(){const m=n().nodes.filter(b=>b.selected),w=n().edges.filter(b=>b.selected);l({nodes:m,edges:w})}yn("blur",ii,d),yn("contextmenu",ii,d),wt(ii,(m,w)=>$a?.(m,w),()=>({trigger:p(i(),()=>n(n().selectionKeyPressed=!0,!0)),type:"keydown"})),wt(ii,(m,w)=>$a?.(m,w),()=>({trigger:p(i(),()=>n(n().selectionKeyPressed=!1,!0)),type:"keyup"})),wt(ii,(m,w)=>$a?.(m,w),()=>({trigger:p(r(),()=>{n(n().multiselectionKeyPressed=!0,!0)}),type:"keydown"})),wt(ii,(m,w)=>$a?.(m,w),()=>({trigger:p(r(),()=>n(n().multiselectionKeyPressed=!1,!0)),type:"keyup"})),wt(ii,(m,w)=>$a?.(m,w),()=>({trigger:p(s(),m=>{!(m.originalEvent.ctrlKey||m.originalEvent.metaKey||m.originalEvent.shiftKey)&&!w5(m.originalEvent)&&(n(n().deleteKeyPressed=!0,!0),y())}),type:"keydown"})),wt(ii,(m,w)=>$a?.(m,w),()=>({trigger:p(s(),()=>n(n().deleteKeyPressed=!1,!0)),type:"keyup"})),wt(ii,(m,w)=>$a?.(m,w),()=>({trigger:p(a(),()=>n(n().panActivationKeyPressed=!0,!0)),type:"keydown"})),wt(ii,(m,w)=>$a?.(m,w),()=>({trigger:p(a(),()=>n(n().panActivationKeyPressed=!1,!0)),type:"keyup"})),wt(ii,(m,w)=>$a?.(m,w),()=>({trigger:p(o(),()=>n(n().zoomActivationKeyPressed=!0,!0)),type:"keydown"})),wt(ii,(m,w)=>$a?.(m,w),()=>({trigger:p(o(),()=>n(n().zoomActivationKeyPressed=!1,!0)),type:"keyup"})),Dt()}var pC=rt('<path fill="none" class="svelte-flow__connection-path"></path>'),gC=rt('<svg class="svelte-flow__connectionline"><g><!></g></svg>');function mC(t,e){Tt(e,!0);let n=ne(()=>{if(!e.store.connection.inProgress)return"";const a={sourceX:e.store.connection.from.x,sourceY:e.store.connection.from.y,sourcePosition:e.store.connection.fromPosition,targetX:e.store.connection.to.x,targetY:e.store.connection.to.y,targetPosition:e.store.connection.toPosition};switch(e.type){case jl.Bezier:{const[o]=_5(a);return o}case jl.Straight:{const[o]=k5(a);return o}case jl.Step:case jl.SmoothStep:{const[o]=hp({...a,borderRadius:e.type===jl.Step?0:void 0});return o}}});var i=$e(),r=Ue(i);{var s=a=>{var o=gC(),l=se(o),c=se(l);{var u=p=>{var d=$e(),y=Ue(d);x1(y,()=>e.LineComponent,(m,w)=>{w(m,{})}),j(p,d)},f=p=>{var d=pC();_e(()=>{fe(d,"d",h(n)),An(d,e.style)}),j(p,d)};ke(c,p=>{e.LineComponent?p(u):p(f,!1)})}Q(l),Q(o),_e(p=>{fe(o,"width",e.store.width),fe(o,"height",e.store.height),An(o,e.containerStyle),Xt(l,0,p)},[()=>zc(["svelte-flow__connection",tA(e.store.connection.isValid)])]),j(a,o)};ke(r,a=>{e.store.connection.inProgress&&a(s)})}j(t,i),Dt()}var vC=Me("<div><!></div>");function yC(t,e){Tt(e,!0);let n=ct(e,"position",3,"top-right"),i=Bc(e,["$$slots","$$events","$$legacy","position","style","class","children"]),r=ne(()=>`${n()}`.split("-"));var s=vC();Jl(s,o=>({class:o,style:e.style,...i}),[()=>["svelte-flow__panel",e.class,...h(r)]]);var a=se(s);gs(a,()=>e.children??ta),Q(s),j(t,s),Dt()}var bC=Me('<a href="https://svelteflow.dev" target="_blank" rel="noopener noreferrer" aria-label="Svelte Flow attribution">Svelte Flow</a>');function wC(t,e){Tt(e,!0);let n=ct(e,"position",3,"bottom-right");var i=$e(),r=Ue(i);{var s=a=>{yC(a,{get position(){return n()},class:"svelte-flow__attribution","data-message":"Feel free to remove the attribution or check out how you could support us: https://svelteflow.dev/support-us",children:(o,l)=>{var c=bC();j(o,c)},$$slots:{default:!0}})};ke(r,a=>{e.proOptions?.hideAttribution||a(s)})}j(t,i),Dt()}var xC=Me("<div><!></div>");function _C(t,e){Tt(e,!0);let n=ct(e,"domNode",15),i=ct(e,"clientWidth",15),r=ct(e,"clientHeight",15),s=ne(()=>e.rest.class),a=ne(()=>U3(e.rest,["id","class","nodeTypes","edgeTypes","colorMode","isValidConnection","onmove","onmovestart","onmoveend","onflowerror","ondelete","onbeforedelete","onbeforeconnect","onconnect","onconnectstart","onconnectend","onbeforereconnect","onreconnect","onreconnectstart","onreconnectend","onclickconnectstart","onclickconnectend","oninit","onselectionchange","onselectiondragstart","onselectiondrag","onselectiondragstop","onselectionstart","onselectionend","clickConnect","fitView","fitViewOptions","nodeOrigin","nodeDragThreshold","connectionDragThreshold","minZoom","maxZoom","initialViewport","connectionRadius","connectionMode","selectionMode","selectNodesOnDrag","snapGrid","defaultMarkerColor","translateExtent","nodeExtent","onlyRenderVisibleElements","autoPanOnConnect","autoPanOnNodeDrag","colorModeSSR","defaultEdgeOptions","elevateNodesOnSelect","elevateEdgesOnSelect","nodesDraggable","autoPanOnNodeFocus","nodesConnectable","elementsSelectable","nodesFocusable","edgesFocusable","disableKeyboardA11y","noDragClass","noPanClass","noWheelClass","ariaLabelConfig","autoPanSpeed","panOnScrollSpeed","zIndexMode"]));function o(u){u.currentTarget.scrollTo({top:0,left:0,behavior:"auto"}),e.rest.onscroll&&e.rest.onscroll(u)}var l=xC();Jl(l,u=>({class:["svelte-flow","svelte-flow__container",h(s),e.colorMode],"data-testid":"svelte-flow__wrapper",role:"application",onscroll:o,...h(a),[Jo]:u}),[()=>({width:ho(e.width),height:ho(e.height)})],void 0,void 0,"svelte-mkap6j");var c=se(l);gs(c,()=>e.children??ta),Q(l),ji(l,u=>n(u),()=>n()),sv(l,"clientHeight",r),sv(l,"clientWidth",i),j(t,l),Dt()}var SC=Me('<div class="svelte-flow__viewport-back svelte-flow__container"></div> <!> <div class="svelte-flow__edge-labels svelte-flow__container"></div> <!> <!> <!> <div class="svelte-flow__viewport-front svelte-flow__container"></div>',1),kC=Me("<!> <!>",1),AC=Me("<!> <!> <!> <!> <!>",1);function NC(t,e){Tt(e,!0);let n=ct(e,"paneClickDistance",3,1),i=ct(e,"nodeClickDistance",3,1),r=ct(e,"panOnScrollMode",19,()=>yu.Free),s=ct(e,"preventScrolling",3,!0),a=ct(e,"zoomOnScroll",3,!0),o=ct(e,"zoomOnDoubleClick",3,!0),l=ct(e,"zoomOnPinch",3,!0),c=ct(e,"panOnScroll",3,!1),u=ct(e,"panOnScrollSpeed",3,.5),f=ct(e,"panOnDrag",3,!0),p=ct(e,"selectionOnDrag",3,!1),d=ct(e,"connectionLineType",19,()=>jl.Bezier),y=ct(e,"nodes",31,()=>Rn([])),m=ct(e,"edges",31,()=>Rn([])),w=ct(e,"viewport",15,void 0),b=Bc(e,["$$slots","$$events","$$legacy","width","height","proOptions","selectionKey","deleteKey","panActivationKey","multiSelectionKey","zoomActivationKey","paneClickDistance","nodeClickDistance","onmovestart","onmoveend","onmove","oninit","onnodeclick","onnodecontextmenu","onnodedrag","onnodedragstart","onnodedragstop","onnodepointerenter","onnodepointermove","onnodepointerleave","onselectionclick","onselectioncontextmenu","onselectionstart","onselectionend","onedgeclick","onedgecontextmenu","onedgepointerenter","onedgepointerleave","onpaneclick","onpanecontextmenu","panOnScrollMode","preventScrolling","zoomOnScroll","zoomOnDoubleClick","zoomOnPinch","panOnScroll","panOnScrollSpeed","panOnDrag","selectionOnDrag","connectionLineComponent","connectionLineStyle","connectionLineContainerStyle","connectionLineType","attributionPosition","children","nodes","edges","viewport"]),S=RN({props:b,width:e.width,height:e.height,get nodes(){return y()},set nodes(_){y(_)},get edges(){return m()},set edges(_){m(_)},get viewport(){return w()},set viewport(_){w(_)}});const A=w1(zm);A&&A.setStore&&A.setStore(S),Cb(zm,{provider:!1,getStore(){return S}}),mn(()=>{const _={nodes:S.selectedNodes,edges:S.selectedEdges};ia(()=>e.onselectionchange)?.(_);for(const I of S.selectionChangeHandlers.values())I(_)}),Ei(()=>{S.reset()}),_C(t,{get colorMode(){return S.colorMode},get width(){return e.width},get height(){return e.height},get rest(){return b},get domNode(){return S.domNode},set domNode(_){S.domNode=_},get clientWidth(){return S.width},set clientWidth(_){S.width=_},get clientHeight(){return S.height},set clientHeight(_){S.height=_},children:(_,I)=>{var E=AC(),M=Ue(E);hC(M,{get selectionKey(){return e.selectionKey},get deleteKey(){return e.deleteKey},get panActivationKey(){return e.panActivationKey},get multiSelectionKey(){return e.multiSelectionKey},get zoomActivationKey(){return e.zoomActivationKey},get store(){return S},set store(N){S=N}});var T=be(M,2);qN(T,{get panOnScrollMode(){return r()},get preventScrolling(){return s()},get zoomOnScroll(){return a()},get zoomOnDoubleClick(){return o()},get zoomOnPinch(){return l()},get panOnScroll(){return c()},get panOnScrollSpeed(){return u()},get panOnDrag(){return f()},get paneClickDistance(){return n()},get selectionOnDrag(){return p()},get onmovestart(){return e.onmovestart},get onmove(){return e.onmove},get onmoveend(){return e.onmoveend},get oninit(){return e.oninit},get store(){return S},set store(N){S=N},children:(N,B)=>{HN(N,{get onpaneclick(){return e.onpaneclick},get onpanecontextmenu(){return e.onpanecontextmenu},get onselectionstart(){return e.onselectionstart},get onselectionend(){return e.onselectionend},get panOnDrag(){return f()},get paneClickDistance(){return n()},get selectionOnDrag(){return p()},get store(){return S},set store(P){S=P},children:(P,F)=>{var q=kC(),Z=Ue(q);WN(Z,{get store(){return S},set store(Y){S=Y},children:(Y,ue)=>{var le=SC(),O=be(Ue(le),2);lC(O,{get onedgeclick(){return e.onedgeclick},get onedgecontextmenu(){return e.onedgecontextmenu},get onedgepointerenter(){return e.onedgepointerenter},get onedgepointerleave(){return e.onedgepointerleave},get store(){return S},set store(ae){S=ae}});var V=be(O,4);mC(V,{get type(){return d()},get LineComponent(){return e.connectionLineComponent},get containerStyle(){return e.connectionLineContainerStyle},get style(){return e.connectionLineStyle},get store(){return S},set store(ae){S=ae}});var G=be(V,2);QN(G,{get nodeClickDistance(){return i()},get onnodeclick(){return e.onnodeclick},get onnodecontextmenu(){return e.onnodecontextmenu},get onnodepointerenter(){return e.onnodepointerenter},get onnodepointermove(){return e.onnodepointermove},get onnodepointerleave(){return e.onnodepointerleave},get onnodedrag(){return e.onnodedrag},get onnodedragstart(){return e.onnodedragstart},get onnodedragstop(){return e.onnodedragstop},get store(){return S},set store(ae){S=ae}});var re=be(G,2);dC(re,{get onselectionclick(){return e.onselectionclick},get onselectioncontextmenu(){return e.onselectioncontextmenu},get onnodedrag(){return e.onnodedrag},get onnodedragstart(){return e.onnodedragstart},get onnodedragstop(){return e.onnodedragstop},get store(){return S},set store(ae){S=ae}}),Ri(2),j(Y,le)},$$slots:{default:!0}});var W=be(Z,2);{let Y=ne(()=>!!(S.selectionRect&&S.selectionRectMode==="user")),ue=ne(()=>S.selectionRect?.width),le=ne(()=>S.selectionRect?.height),O=ne(()=>S.selectionRect?.x),V=ne(()=>S.selectionRect?.y);H5(W,{get isVisible(){return h(Y)},get width(){return h(ue)},get height(){return h(le)},get x(){return h(O)},get y(){return h(V)}})}j(P,q)},$$slots:{default:!0}})},$$slots:{default:!0}});var D=be(T,2);wC(D,{get proOptions(){return e.proOptions},get position(){return e.attributionPosition}});var U=be(D,2);XN(U,{get store(){return S}});var C=be(U,2);gs(C,()=>e.children??ta),j(_,E)},$$slots:{default:!0}}),Dt()}var il;(function(t){t.Lines="lines",t.Dots="dots",t.Cross="cross"})(il||(il={}));var CC=rt("<circle></circle>");function PC(t,e){var n=CC();_e(()=>{fe(n,"cx",e.radius),fe(n,"cy",e.radius),fe(n,"r",e.radius),Xt(n,0,zc(["svelte-flow__background-pattern","dots",e.class]))}),j(t,n)}var EC=rt("<path></path>");function IC(t,e){Tt(e,!0);var n=EC();_e(()=>{fe(n,"stroke-width",e.lineWidth),fe(n,"d",`M${e.dimensions[0]/2} 0 V${e.dimensions[1]} M0 ${e.dimensions[1]/2} H${e.dimensions[0]}`),Xt(n,0,zc(["svelte-flow__background-pattern",e.variant,e.class]))}),j(t,n),Dt()}const LC={[il.Dots]:1,[il.Lines]:1,[il.Cross]:6};var MC=rt('<svg data-testid="svelte-flow__background"><pattern patternUnits="userSpaceOnUse"><!></pattern><rect x="0" y="0" width="100%" height="100%"></rect></svg>');function TC(t,e){Tt(e,!0);let n=ct(e,"variant",19,()=>il.Dots),i=ct(e,"gap",3,20),r=ct(e,"lineWidth",3,1),s=ne(Ql),a=ne(()=>n()===il.Dots),o=ne(()=>n()===il.Cross),l=ne(()=>Array.isArray(i())?i():[i(),i()]),c=ne(()=>`background-pattern-${h(s).flowId}-${e.id??""}`),u=ne(()=>[h(l)[0]*h(s).viewport.zoom||1,h(l)[1]*h(s).viewport.zoom||1]),f=ne(()=>(e.size??LC[n()])*h(s).viewport.zoom),p=ne(()=>h(o)?[h(f),h(f)]:h(u)),d=ne(()=>h(a)?[h(f)/2,h(f)/2]:[h(p)[0]/2,h(p)[1]/2]);var y=MC();let m;var w=se(y),b=se(w);{var S=I=>{{let E=ne(()=>h(f)/2);PC(I,{get radius(){return h(E)},get class(){return e.patternClass}})}},A=I=>{IC(I,{get dimensions(){return h(p)},get variant(){return n()},get lineWidth(){return r()},get class(){return e.patternClass}})};ke(b,I=>{h(a)?I(S):I(A,!1)})}Q(w);var _=be(w);Q(y),_e(()=>{Xt(y,0,zc(["svelte-flow__background","svelte-flow__container",e.class])),m=An(y,"",m,{"--xy-background-color-props":e.bgColor,"--xy-background-pattern-color-props":e.patternColor}),fe(w,"id",h(c)),fe(w,"x",h(s).viewport.x%h(u)[0]),fe(w,"y",h(s).viewport.y%h(u)[1]),fe(w,"width",h(u)[0]),fe(w,"height",h(u)[1]),fe(w,"patternTransform",`translate(-${h(d)[0]},-${h(d)[1]})`),fe(_,"fill",`url(#${h(c)})`)}),j(t,y),Dt()}var DC=Me("<div><!></div>");function Gv(t,e){Tt(e,!0);let n=ct(e,"variant",19,()=>Bd.Handle),i=ct(e,"minWidth",3,10),r=ct(e,"minHeight",3,10),s=ct(e,"maxWidth",19,()=>Number.MAX_VALUE),a=ct(e,"maxHeight",19,()=>Number.MAX_VALUE),o=ct(e,"keepAspectRatio",3,!1),l=ct(e,"autoScale",3,!0),c=Bc(e,["$$slots","$$events","$$legacy","nodeId","position","variant","color","minWidth","minHeight","maxWidth","maxHeight","keepAspectRatio","resizeDirection","autoScale","shouldResize","onResizeStart","onResize","onResizeEnd","class","children"]);const u=Ql(),f=H1();let p=ne(()=>typeof e.nodeId=="string"?e.nodeId:f);if(!h(p))throw new Error("Either pass a nodeId or use within a Custom Node component");let d,y=Oe(null),m=ne(()=>n()===Bd.Line),w=ne(()=>{let _=h(m)?"right":"bottom-right";return e.position??_}),b=ne(()=>h(w).split("-"));ju(()=>(d&&J(y,oN({domNode:d,nodeId:h(p),getStoreItems:()=>({nodeLookup:u.nodeLookup,transform:[u.viewport.x,u.viewport.y,u.viewport.zoom],snapGrid:u.snapGrid??void 0,snapToGrid:!!u.snapGrid,nodeOrigin:u.nodeOrigin,paneDomNode:u.domNode}),onChange:(_,I)=>{const E=new Map;E.set(h(p),_);for(const M of I)E.set(M.id,{x:M.position.x,y:M.position.y});u.nodes=u.nodes.map(M=>{const T=E.get(M.id),D=!e.resizeDirection||e.resizeDirection==="horizontal",U=!e.resizeDirection||e.resizeDirection==="vertical";return T?{...M,position:{x:D?T.x??M.position.x:M.position.x,y:U?T.y??M.position.y:M.position.y},width:D?T.width??M.width:M.width,height:U?T.height??M.height:M.height}:M})}}),!0),()=>{h(y)?.destroy()})),Pb(()=>{h(y)?.update({controlPosition:h(w),boundaries:{minWidth:i(),minHeight:r(),maxWidth:s(),maxHeight:a()},keepAspectRatio:!!o(),resizeDirection:e.resizeDirection,onResizeStart:e.onResizeStart,onResize:e.onResize,onResizeEnd:e.onResizeEnd,shouldResize:e.shouldResize})});var S=DC();Jl(S,(_,I)=>({class:_,...c,[Jo]:I}),[()=>["svelte-flow__resize-control",u.noDragClass,...h(b),n(),e.class],()=>({"border-color":h(m)?e.color:void 0,"background-color":h(m)?void 0:e.color,scale:h(m)||!l()?void 0:Math.max(1/u.viewport.zoom,1)})]);var A=se(S);gs(A,()=>e.children??ta),Q(S),ji(S,_=>d=_,()=>d),j(t,S),Dt()}var OC=Me("<!> <!>",1);function FC(t,e){Tt(e,!0);let n=ct(e,"isVisible",3,!0),i=ct(e,"autoScale",3,!0),r=Bc(e,["$$slots","$$events","$$legacy","isVisible","nodeId","handleClass","handleStyle","lineClass","lineStyle","autoScale"]);var s=$e(),a=Ue(s);{var o=l=>{var c=OC(),u=Ue(c);fn(u,16,()=>tN,p=>p,(p,d)=>{Gv(p,Ah({get class(){return e.lineClass},get style(){return e.lineStyle},get nodeId(){return e.nodeId},get position(){return d},get autoScale(){return i()},get variant(){return Bd.Line}},()=>r))});var f=be(u,2);fn(f,16,()=>eN,p=>p,(p,d)=>{Gv(p,Ah({get class(){return e.handleClass},get style(){return e.handleStyle},get nodeId(){return e.nodeId},get position(){return d},get autoScale(){return i()}},()=>r))}),j(l,c)};ke(a,l=>{n()&&l(o)})}j(t,s),Dt()}function W5(){const t=ne(Ql),e=ne(()=>h(t).domNode),n=ne(()=>h(t).updateNodeInternals),i=H1();return s=>{if(!s&&!i)throw new Error("When using outside of a node, you must provide an id.");const a=s?Array.isArray(s)?s:[s]:[i],o=new Map;a.forEach(l=>{const c=h(e)?.querySelector(`.svelte-flow__node[data-id="${l}"]`);c&&o.set(l,{id:l,nodeElement:c,force:!0})}),requestAnimationFrame(()=>h(n)(o))}}function V5(t){return t.target instanceof HTMLInputElement||t.target instanceof HTMLTextAreaElement||!!t.target?.closest?.(".cm-editor")}const RC="1.0.0",BC={dt:{pathsim_name:"dt",type:"number",default:"0.01",description:"transient simulation timestep in time units, default see Â´SIM_TIMESTEPÂ´ in Â´_constants.pyÂ´"},dt_min:{pathsim_name:"dt_min",type:"number",default:"1e-16",description:"lower bound for transient simulation timestep, default see Â´SIM_TIMESTEP_MINÂ´ in Â´_constants.pyÂ´"},dt_max:{pathsim_name:"dt_max",type:"any",default:null,description:"upper bound for transient simulation timestep, default see Â´SIM_TIMESTEP_MAXÂ´ in Â´_constants.pyÂ´"},solver:{pathsim_name:"Solver",type:"string",default:'"SSPRK22"',description:"ODE solver class for numerical integration from Â´pathsim.solversÂ´, default is Â´pathsim.solvers.ssprk22.SSPRK22Â´ (2nd order expl. Runge Kutta)"},ftol:{pathsim_name:"tolerance_fpi",type:"number",default:"1e-10",description:"absolute tolerance for convergence of algebraic loops and internal optimizers of implicit ODE solvers, default see Â´SIM_TOLERANCE_FPIÂ´ in Â´_constants.pyÂ´"},iterations_max:{pathsim_name:"iterations_max",type:"integer",default:"200",description:"maximum allowed number of iterations for implicit ODE solver optimizers and algebraic loop solver, default see Â´SIM_ITERATIONS_MAXÂ´ in Â´_constants.pyÂ´"},log:{pathsim_name:"log",type:"boolean",default:"True",description:"flag to enable logging, default see Â´LOG_ENABLEÂ´ in Â´_constants.pyÂ´ (alternatively a path to a log file can be specified)"},rtol:{pathsim_name:"tolerance_lte_rel",type:"number",default:"0.0001",description:"Relative error tolerance for adaptive timestep control"},atol:{pathsim_name:"tolerance_lte_abs",type:"number",default:"1e-08",description:"Absolute error tolerance for adaptive timestep control"},duration:{pathsim_name:"duration",type:"number",default:"10.0",description:"Total simulation time"}},Xv={ghostTraces:{default:"0"},plotResults:{default:"true"}};function Tl(t){return BC[t]?.default??""}const Xo={duration:Tl("duration"),dt:Tl("dt"),solver:Tl("solver")||"SSPRK22",adaptive:!0,atol:Tl("atol"),rtol:Tl("rtol"),ftol:Tl("ftol"),dt_min:Tl("dt_min"),dt_max:Tl("dt_max"),ghostTraces:parseInt(Xv.ghostTraces?.default),plotResults:Xv.plotResults?.default==="true"},ts={duration:"",dt:"",solver:"SSPRK22",adaptive:!0,atol:"",rtol:"",ftol:"",dt_min:"",dt_max:"",ghostTraces:0,plotResults:!0},rl="#0070C0",zd={default:"#969696"},zC=[rl,"#E57373","#FFB74D","#FFF176","#81C784","#4DB6AC","#4DD0E1","#64B5F6","#BA68C8","#F06292","#90A4AE","#FFFFFF"];function U1(t){const{name:e,category:n,description:i=`${e} block`,blockClass:r,inputs:s=["in 0"],outputs:a=["out 0"],minInputs:o=1,minOutputs:l=1,maxInputs:c=null,maxOutputs:u=null,syncPorts:f,shape:p,params:d={}}=t,y=Object.entries(d).map(([m,w])=>({name:m,type:w.type,default:w.default,description:w.description,min:w.min,max:w.max,options:w.options}));return{type:r,name:e,category:n,description:i,blockClass:r,shape:p,ports:{inputs:s.map(m=>({name:m,direction:"input",color:zd.default})),outputs:a.map(m=>({name:m,direction:"output",color:zd.default})),minInputs:o,minOutputs:l,maxInputs:c,maxOutputs:u,syncPorts:f},params:y}}const qh={Constant:{blockClass:"Constant",description:"Produces a constant output signal (SISO).",docstringHtml:`<p>Produces a constant output signal (SISO).</p>
<div class="math">
\\begin{equation*}
y(t) = const.
\\end{equation*}
</div>
<div class="section" id="parameters">
<h3>Parameters</h3>
<dl class="docutils">
<dt>value <span class="classifier-delimiter">:</span> <span class="classifier">float</span></dt>
<dd>constant defining block output</dd>
</dl>
</div>
`,params:{value:{type:"integer",default:"1",description:"constant defining block output"}},inputs:[],outputs:["out"]},Source:{blockClass:"Source",description:"Source that produces an arbitrary time dependent output defined by `func` (callable).",docstringHtml:`<p>Source that produces an arbitrary time dependent output defined by <cite>func</cite> (callable).</p>
<div class="math">
\\begin{equation*}
y(t) = \\mathrm{func}(t)
\\end{equation*}
</div>
<div class="section" id="note">
<h3>Note</h3>
<p>This block is purely algebraic and its internal function (<cite>func</cite>) will
be called multiple times per timestep, each time when <cite>Simulation._update(t)</cite>
is called in the global simulation loop.</p>
</div>
<div class="section" id="example">
<h3>Example</h3>
<p>For example a ramp:</p>
<pre class="code python literal-block">
from pathsim.blocks import Source

src = Source(lambda t : t)
</pre>
<p>or a simple sinusoid with some frequency:</p>
<pre class="code python literal-block">
import numpy as np
from pathsim.blocks import Source

#some parameter
omega = 100

#the function that gets evaluated
def f(t):
    return np.sin(omega * t)

src = Source(f)
</pre>
<p>Because the <cite>Source</cite> block only has a single argument, it can be
used to decorate a function and make it a <cite>PathSim</cite> block. This might
be handy in some cases to keep definitions concise and localized
in the code:</p>
<pre class="code python literal-block">
import numpy as np
from pathsim.blocks import Source

#does the same as the definition above

&#64;Source
def src(t):
    omega = 100
    return np.sin(omega * t)

#'src' is now a PathSim block
</pre>
</div>
<div class="section" id="parameters">
<h3>Parameters</h3>
<dl class="docutils">
<dt>func <span class="classifier-delimiter">:</span> <span class="classifier">callable</span></dt>
<dd>function defining time dependent block output</dd>
</dl>
</div>
`,params:{func:{type:"callable",default:null,description:"function defining time dependent block output"}},inputs:[],outputs:["out"]},SinusoidalSource:{blockClass:"SinusoidalSource",description:"Source block that generates a sinusoid wave",docstringHtml:`<p>Source block that generates a sinusoid wave</p>
<div class="section" id="parameters">
<h3>Parameters</h3>
<dl class="docutils">
<dt>frequency <span class="classifier-delimiter">:</span> <span class="classifier">float</span></dt>
<dd>frequency of the sinusoid</dd>
<dt>amplitude <span class="classifier-delimiter">:</span> <span class="classifier">float</span></dt>
<dd>amplitude of the sinusoid</dd>
<dt>phase <span class="classifier-delimiter">:</span> <span class="classifier">float</span></dt>
<dd>phase of the sinusoid</dd>
</dl>
</div>
`,params:{frequency:{type:"integer",default:"1",description:"frequency of the sinusoid"},amplitude:{type:"integer",default:"1",description:"amplitude of the sinusoid"},phase:{type:"integer",default:"0",description:"phase of the sinusoid"}},inputs:[],outputs:["out"]},StepSource:{blockClass:"StepSource",description:"Discrete time unit step (or multi step) source block.",docstringHtml:`<p>Discrete time unit step (or multi step) source block.</p>
<p>Utilizes a scheduled event to set the block output
to the specified output levels at the defined event times.</p>
<p>The arguments can be vectorial and in that case, the output is set to the
amplitude that corresponds to the defined delay like a zero-order-hold stage.
This functionality enables adding external or time series measurement data
into the system.</p>
<div class="section" id="examples">
<h3>Examples</h3>
<p>This is how to use the source as a unit step source:</p>
<pre class="code python literal-block">
from pathsim.blocks import StepSource

#default, starts at 0, jumps to 1
stp = StepSource()
</pre>
<p>And this is how to configure it with multiple consecutive steps:</p>
<pre class="code python literal-block">
from pathsim.blocks import StepSource

#starts at 0, jumps to 1 at 1, jumps to -1 at 2 and jumps back to 0 at 3
stp = StepSource(amplitude=[1, -1, 0], tau=[1, 2, 3])
</pre>
<p>Similarly implementing measured time series data via zoh:</p>
<pre class="code python literal-block">
import numpy as np
from pathsim.blocks import StepSource

#some random time series arrays
times, data = np.linspace(0, 100, 1000), np.random.rand(1000)

#pass them to the block
stp = StepSource(amplitude=data, tau=times)
</pre>
</div>
<div class="section" id="parameters">
<h3>Parameters</h3>
<dl class="docutils">
<dt>amplitude <span class="classifier-delimiter">:</span> <span class="classifier">float | list[float]</span></dt>
<dd>amplitude of the step signal, or amplitudes / output
levels of the multiple steps</dd>
<dt>tau <span class="classifier-delimiter">:</span> <span class="classifier">float | list[float]</span></dt>
<dd>delay of the step, or delays of the different steps</dd>
</dl>
</div>
<div class="section" id="attributes">
<h3>Attributes</h3>
<dl class="docutils">
<dt>Evt <span class="classifier-delimiter">:</span> <span class="classifier">ScheduleList</span></dt>
<dd>internal scheduled event directly accessible</dd>
<dt>events <span class="classifier-delimiter">:</span> <span class="classifier">list[ScheduleList]</span></dt>
<dd>list of interna events</dd>
</dl>
</div>
`,params:{amplitude:{type:"integer",default:"1",description:"amplitude of the step signal, or amplitudes / output levels of the multiple steps"},tau:{type:"number",default:"0.0",description:"delay of the step, or delays of the different steps"}},inputs:[],outputs:["out"]},PulseSource:{blockClass:"PulseSource",description:"Generates a periodic pulse waveform with defined rise and fall times.",docstringHtml:`<p>Generates a periodic pulse waveform with defined rise and fall times.</p>
<p>Scheduled events trigger phase changes (low, rising, high, falling),
and the <cite>update</cite> method calculates the output value based on the
current phase, performing linear interpolation during rise and fall.</p>
<div class="section" id="parameters">
<h3>Parameters</h3>
<dl class="docutils">
<dt>amplitude <span class="classifier-delimiter">:</span> <span class="classifier">float, optional</span></dt>
<dd>Peak amplitude of the pulse. Default is 1.0.</dd>
<dt>T <span class="classifier-delimiter">:</span> <span class="classifier">float, optional</span></dt>
<dd>Period of the pulse train. Must be positive. Default is 1.0.</dd>
<dt>t_rise <span class="classifier-delimiter">:</span> <span class="classifier">float, optional</span></dt>
<dd>Duration of the rising edge. Default is 0.0.</dd>
<dt>t_fall <span class="classifier-delimiter">:</span> <span class="classifier">float, optional</span></dt>
<dd>Duration of the falling edge. Default is 0.0.</dd>
<dt>tau <span class="classifier-delimiter">:</span> <span class="classifier">float, optional</span></dt>
<dd>Initial delay before the first pulse cycle begins. Default is 0.0.</dd>
<dt>duty <span class="classifier-delimiter">:</span> <span class="classifier">float, optional</span></dt>
<dd>Duty cycle, ratio of the pulse ON duration (plateau time only)
to the total period T (must be between 0 and 1). Default is 0.5.
The high plateau duration is <cite>T * duty</cite>.</dd>
</dl>
</div>
<div class="section" id="attributes">
<h3>Attributes</h3>
<dl class="docutils">
<dt>events <span class="classifier-delimiter">:</span> <span class="classifier">list[Schedule]</span></dt>
<dd>Internal scheduled events triggering phase transitions.</dd>
<dt>_phase <span class="classifier-delimiter">:</span> <span class="classifier">str</span></dt>
<dd>Current phase of the pulse ('low', 'rising', 'high', 'falling').</dd>
<dt>_phase_start_time <span class="classifier-delimiter">:</span> <span class="classifier">float</span></dt>
<dd>Simulation time when the current phase began.</dd>
</dl>
</div>
`,params:{amplitude:{type:"number",default:"1.0",description:"Peak amplitude of the pulse. Default is 1.0."},T:{type:"number",default:"1.0",description:"Period of the pulse train. Must be positive. Default is 1.0."},t_rise:{type:"number",default:"0.0",description:"Duration of the rising edge. Default is 0.0."},t_fall:{type:"number",default:"0.0",description:"Duration of the falling edge. Default is 0.0."},tau:{type:"number",default:"0.0",description:"Initial delay before the first pulse cycle begins. Default is 0.0."},duty:{type:"number",default:"0.5",description:"Duty cycle, ratio of the pulse ON duration (plateau time only) to the total period T (must be between 0 and 1). Default is 0.5. The high plateau duration is `T * duty`."}},inputs:[],outputs:["out"]},TriangleWaveSource:{blockClass:"TriangleWaveSource",description:"Source block that generates an analog triangle wave",docstringHtml:`<p>Source block that generates an analog triangle wave</p>
<div class="section" id="parameters">
<h3>Parameters</h3>
<dl class="docutils">
<dt>frequency <span class="classifier-delimiter">:</span> <span class="classifier">float</span></dt>
<dd>frequency of the triangle wave</dd>
<dt>amplitude <span class="classifier-delimiter">:</span> <span class="classifier">float</span></dt>
<dd>amplitude of the triangle wave</dd>
<dt>phase <span class="classifier-delimiter">:</span> <span class="classifier">float</span></dt>
<dd>phase of the triangle wave</dd>
</dl>
</div>
`,params:{frequency:{type:"integer",default:"1",description:"frequency of the triangle wave"},amplitude:{type:"integer",default:"1",description:"amplitude of the triangle wave"},phase:{type:"integer",default:"0",description:"phase of the triangle wave"}},inputs:[],outputs:["out"]},SquareWaveSource:{blockClass:"SquareWaveSource",description:"Discrete time square wave source.",docstringHtml:`<p>Discrete time square wave source.</p>
<p>Utilizes scheduled events to periodically set
the block output at discrete times.</p>
<div class="section" id="parameters">
<h3>Parameters</h3>
<dl class="docutils">
<dt>amplitude <span class="classifier-delimiter">:</span> <span class="classifier">float</span></dt>
<dd>amplitude of the square wave signal</dd>
<dt>frequency <span class="classifier-delimiter">:</span> <span class="classifier">float</span></dt>
<dd>frequency of the square wave signal</dd>
<dt>phase <span class="classifier-delimiter">:</span> <span class="classifier">float</span></dt>
<dd>phase of the square wave signal</dd>
</dl>
</div>
<div class="section" id="attributes">
<h3>Attributes</h3>
<dl class="docutils">
<dt>events <span class="classifier-delimiter">:</span> <span class="classifier">list[Schedule]</span></dt>
<dd>internal scheduled events</dd>
</dl>
</div>
`,params:{amplitude:{type:"integer",default:"1",description:"amplitude of the square wave signal"},frequency:{type:"integer",default:"1",description:"frequency of the square wave signal"},phase:{type:"integer",default:"0",description:"phase of the square wave signal"}},inputs:[],outputs:["out"]},GaussianPulseSource:{blockClass:"GaussianPulseSource",description:"Source block that generates a gaussian pulse",docstringHtml:`<p>Source block that generates a gaussian pulse</p>
<div class="section" id="parameters">
<h3>Parameters</h3>
<dl class="docutils">
<dt>amplitude <span class="classifier-delimiter">:</span> <span class="classifier">float</span></dt>
<dd>amplitude of the gaussian pulse</dd>
<dt>f_max <span class="classifier-delimiter">:</span> <span class="classifier">float</span></dt>
<dd>maximum frequency component of the gaussian pulse (steepness)</dd>
<dt>tau <span class="classifier-delimiter">:</span> <span class="classifier">float</span></dt>
<dd>time delay of the gaussian pulse</dd>
</dl>
</div>
`,params:{amplitude:{type:"integer",default:"1",description:"amplitude of the gaussian pulse"},f_max:{type:"number",default:"1000.0",description:"maximum frequency component of the gaussian pulse (steepness)"},tau:{type:"number",default:"0.0",description:"time delay of the gaussian pulse"}},inputs:[],outputs:["out"]},ChirpPhaseNoiseSource:{blockClass:"ChirpPhaseNoiseSource",description:"Chirp source, sinusoid with frequency ramp up and ramp down, plus phase noise.",docstringHtml:`<p>Chirp source, sinusoid with frequency ramp up and ramp down, plus phase noise.</p>
<p>This works by using a time dependent triangle wave for the frequency
and integrating it with a numerical integration engine to get a
continuous phase. This phase is then used to evaluate a sinusoid.</p>
<p>Additionally the chirp source can have white and cumulative phase noise.
Mathematically it looks like this for the contributions to the phase from
the triangular wave:</p>
<div class="math">
\\begin{equation*}
\\varphi_t(t) = \\int_0^t \\mathrm{tri}_{f_0, B, T}(\\tau) \\, d\\tau
\\end{equation*}
</div>
<p>And from the white (w) and cumulative (c) noise:</p>
<div class="math">
\\begin{equation*}
\\varphi_n(t) = \\sigma_w \\, n_w(t) + \\sigma_c \\int_0^t n_c(\\tau) \\, d\\tau
\\end{equation*}
</div>
<p>The phase contributions are then used to evaluate a sinusoid to get the final chirp signal:</p>
<div class="math">
\\begin{equation*}
y(t) = A \\sin(\\varphi_t(t) + \\varphi_n(t) + \\varphi_0)
\\end{equation*}
</div>
<div class="section" id="parameters">
<h3>Parameters</h3>
<dl class="docutils">
<dt>amplitude <span class="classifier-delimiter">:</span> <span class="classifier">float</span></dt>
<dd>amplitude of the chirp signal</dd>
<dt>f0 <span class="classifier-delimiter">:</span> <span class="classifier">float</span></dt>
<dd>start frequency of the chirp signal</dd>
<dt>BW <span class="classifier-delimiter">:</span> <span class="classifier">float</span></dt>
<dd>bandwidth of the frequency ramp of the chirp signal</dd>
<dt>T <span class="classifier-delimiter">:</span> <span class="classifier">float</span></dt>
<dd>period of the frequency ramp of the chirp signal</dd>
<dt>phase <span class="classifier-delimiter">:</span> <span class="classifier">float</span></dt>
<dd>phase of sinusoid (initial, radians)</dd>
<dt>sig_cum <span class="classifier-delimiter">:</span> <span class="classifier">float</span></dt>
<dd>weight for cumulative phase noise contribution</dd>
<dt>sig_white <span class="classifier-delimiter">:</span> <span class="classifier">float</span></dt>
<dd>weight for white phase noise contribution</dd>
<dt>sampling_period <span class="classifier-delimiter">:</span> <span class="classifier">float, None</span></dt>
<dd>time between phase noise samples. If None,
noise is sampled every timestep (default is 0.1)</dd>
</dl>
</div>
<div class="section" id="attributes">
<h3>Attributes</h3>
<dl class="docutils">
<dt>noise_1 <span class="classifier-delimiter">:</span> <span class="classifier">float</span></dt>
<dd>internal noise value for white phase noise</dd>
<dt>noise_2 <span class="classifier-delimiter">:</span> <span class="classifier">float</span></dt>
<dd>internal noise value for cumulative phase noise</dd>
<dt>events <span class="classifier-delimiter">:</span> <span class="classifier">list[Schedule]</span></dt>
<dd>scheduled event for periodic sampling (only if sampling_period is set)</dd>
</dl>
</div>
`,params:{amplitude:{type:"integer",default:"1",description:"amplitude of the chirp signal"},f0:{type:"integer",default:"1",description:"start frequency of the chirp signal"},BW:{type:"integer",default:"1",description:"bandwidth of the frequency ramp of the chirp signal"},T:{type:"integer",default:"1",description:"period of the frequency ramp of the chirp signal"},phase:{type:"integer",default:"0",description:"phase of sinusoid (initial, radians)"},sig_cum:{type:"integer",default:"0",description:"weight for cumulative phase noise contribution"},sig_white:{type:"integer",default:"0",description:"weight for white phase noise contribution"},sampling_period:{type:"number",default:"0.1",description:"time between phase noise samples. If None, noise is sampled every timestep (default is 0.1)"}},inputs:[],outputs:["out"]},ClockSource:{blockClass:"ClockSource",description:"Discrete time clock source block.",docstringHtml:`<p>Discrete time clock source block.</p>
<p>Utilizes scheduled events to periodically set
the block output to 0 or 1 at discrete times.</p>
<div class="section" id="parameters">
<h3>Parameters</h3>
<dl class="docutils">
<dt>T <span class="classifier-delimiter">:</span> <span class="classifier">float</span></dt>
<dd>period of the clock</dd>
<dt>tau <span class="classifier-delimiter">:</span> <span class="classifier">float</span></dt>
<dd>clock delay</dd>
</dl>
</div>
<div class="section" id="attributes">
<h3>Attributes</h3>
<dl class="docutils">
<dt>events <span class="classifier-delimiter">:</span> <span class="classifier">list[Schedule]</span></dt>
<dd>internal scheduled event list</dd>
</dl>
</div>
`,params:{T:{type:"integer",default:"1",description:"period of the clock"},tau:{type:"integer",default:"0",description:"clock delay"}},inputs:[],outputs:["out"]},WhiteNoise:{blockClass:"WhiteNoise",description:"White noise source with Gaussian distribution.",docstringHtml:`<p>White noise source with Gaussian distribution.</p>
<p>Generates uncorrelated random samples with either constant amplitude
(<tt class="docutils literal">standard_deviation</tt> mode) or timestep-scaled amplitude for stochastic
integration (<tt class="docutils literal">spectral_density</tt> mode).</p>
<p>In spectral density mode, output is scaled as â(Sâ/dt) so that integrating
the noise yields correct statistical properties (Wiener process).</p>
<div class="section" id="note">
<h3>Note</h3>
<p>If <tt class="docutils literal">spectral_density</tt> is provided, it takes precedence over <tt class="docutils literal">standard_deviation</tt>.
If <tt class="docutils literal">sampling_period</tt> is set, noise is sampled at fixed intervals (zero-order hold).</p>
</div>
<div class="section" id="parameters">
<h3>Parameters</h3>
<dl class="docutils">
<dt>standard_deviation <span class="classifier-delimiter">:</span> <span class="classifier">float</span></dt>
<dd>output standard deviation for constant-amplitude mode (default: 1.0)</dd>
<dt>spectral_density <span class="classifier-delimiter">:</span> <span class="classifier">float, optional</span></dt>
<dd>power spectral density Sâ in [signalÂ²/Hz]</dd>
<dt>sampling_period <span class="classifier-delimiter">:</span> <span class="classifier">float, optional</span></dt>
<dd>time between samples, if None samples every timestep</dd>
<dt>seed <span class="classifier-delimiter">:</span> <span class="classifier">int, optional</span></dt>
<dd>random seed for reproducibility</dd>
</dl>
</div>
`,params:{standard_deviation:{type:"number",default:"1.0",description:"output standard deviation for constant-amplitude mode (default: 1.0)"},spectral_density:{type:"any",default:null,description:"power spectral density Sâ in [signalÂ²/Hz]"},sampling_period:{type:"any",default:null,description:"time between samples, if None samples every timestep"},seed:{type:"any",default:null,description:"random seed for reproducibility"}},inputs:[],outputs:["out"]},PinkNoise:{blockClass:"PinkNoise",description:"Pink noise (1/f noise) source using the Voss-McCartney algorithm.",docstringHtml:`<p>Pink noise (1/f noise) source using the Voss-McCartney algorithm.</p>
<p>Generates noise with power spectral density proportional to 1/f, where
lower frequencies have more power than higher frequencies.</p>
<p>The algorithm maintains <tt class="docutils literal">num_octaves</tt> independent random values representing
different frequency bands. At each sample, one octave is updated based on the
binary representation of the sample counter, creating the characteristic 1/f
spectrum through the superposition of different update rates.</p>
<div class="section" id="note">
<h3>Note</h3>
<p>If <tt class="docutils literal">spectral_density</tt> is provided, it takes precedence over <tt class="docutils literal">standard_deviation</tt>.
If <tt class="docutils literal">sampling_period</tt> is set, noise is sampled at fixed intervals (zero-order hold).</p>
</div>
<div class="section" id="parameters">
<h3>Parameters</h3>
<dl class="docutils">
<dt>standard_deviation <span class="classifier-delimiter">:</span> <span class="classifier">float</span></dt>
<dd>approximate output standard deviation (default: 1.0)</dd>
<dt>spectral_density <span class="classifier-delimiter">:</span> <span class="classifier">float, optional</span></dt>
<dd>power spectral density, output scaled as â(Sâ/(NÂ·dt))</dd>
<dt>num_octaves <span class="classifier-delimiter">:</span> <span class="classifier">int</span></dt>
<dd>number of frequency bands in algorithm (default: 16)</dd>
<dt>sampling_period <span class="classifier-delimiter">:</span> <span class="classifier">float, optional</span></dt>
<dd>time between samples, if None samples every timestep</dd>
<dt>seed <span class="classifier-delimiter">:</span> <span class="classifier">int, optional</span></dt>
<dd>random seed for reproducibility</dd>
</dl>
</div>
`,params:{standard_deviation:{type:"number",default:"1.0",description:"approximate output standard deviation (default: 1.0)"},spectral_density:{type:"any",default:null,description:"power spectral density, output scaled as â(Sâ/(NÂ·dt))"},num_octaves:{type:"integer",default:"16",description:"number of frequency bands in algorithm (default: 16)"},sampling_period:{type:"any",default:null,description:"time between samples, if None samples every timestep"},seed:{type:"any",default:null,description:"random seed for reproducibility"}},inputs:[],outputs:["out"]},RandomNumberGenerator:{blockClass:"RandomNumberGenerator",description:"Generates a random output value using `numpy.random.rand`.",docstringHtml:`<p>Generates a random output value using <cite>numpy.random.rand</cite>.</p>
<p>If no <cite>sampling_period</cite> (None) is specified, every simulation timestep gets
a random value. Otherwise an internal <cite>Schedule</cite> event is used to periodically
sample a random value and set the output like a zero-order-hold stage.</p>
<div class="section" id="parameters">
<h3>Parameters</h3>
<dl class="docutils">
<dt>sampling_period <span class="classifier-delimiter">:</span> <span class="classifier">float, None</span></dt>
<dd>time between random samples</dd>
</dl>
</div>
<div class="section" id="attributes">
<h3>Attributes</h3>
<dl class="docutils">
<dt>_sample <span class="classifier-delimiter">:</span> <span class="classifier">float</span></dt>
<dd>internal random number state in case that
no <cite>sampling_period</cite> is provided</dd>
<dt>Evt <span class="classifier-delimiter">:</span> <span class="classifier">Schedule</span></dt>
<dd>internal event that periodically samples a random
value in case <cite>sampling_period</cite> is provided</dd>
</dl>
</div>
`,params:{sampling_period:{type:"any",default:null,description:"time between random samples"}},inputs:[],outputs:["out"]},Integrator:{blockClass:"Integrator",description:"Integrates the input signal.",docstringHtml:`<p>Integrates the input signal.</p>
<p>Uses a numerical integration engine like this:</p>
<div class="math">
\\begin{equation*}
y(t) = \\int_0^t u(\\tau) \\ d \\tau
\\end{equation*}
</div>
<p>or in differential form like this:</p>
<div class="math">
\\begin{equation*}
\\begin{align}
    \\dot{x}(t) &amp;= u(t) \\\\
           y(t) &amp;= x(t)
\\end{align}
\\end{equation*}
</div>
<p>The Integrator block is inherently MIMO capable, so <cite>u</cite>
and <cite>y</cite> can be vectors.</p>
<div class="section" id="example">
<h3>Example</h3>
<p>This is how to initialize the integrator:</p>
<pre class="code python literal-block">
#initial value 0.0
i1 = Integrator()

#initial value 2.5
i2 = Integrator(2.5)
</pre>
</div>
<div class="section" id="parameters">
<h3>Parameters</h3>
<dl class="docutils">
<dt>initial_value <span class="classifier-delimiter">:</span> <span class="classifier">float, array</span></dt>
<dd>initial value of integrator</dd>
</dl>
</div>
`,params:{initial_value:{type:"number",default:"0.0",description:"initial value of integrator"}},inputs:null,outputs:null},Differentiator:{blockClass:"Differentiator",description:"Differentiates the input signal.",docstringHtml:`<p>Differentiates the input signal.</p>
<p>Uses a first order transfer function with a pole at the origin which implements
a high pass filter. Supports vector input.</p>
<div class="math">
\\begin{equation*}
H_\\mathrm{diff}(s) = \\frac{s}{1 + s / f_\\mathrm{max}}
\\end{equation*}
</div>
<p>The approximation holds for signals up to a frequency of approximately f_max.</p>
<div class="section" id="note">
<h3>Note</h3>
<p>Depending on <cite>f_max</cite>, the resulting system might become stiff or ill conditioned!
As a practical choice set <cite>f_max</cite> to 3x the highest expected signal frequency.</p>
</div>
<div class="section" id="note-1">
<h3>Note</h3>
<p>Since this is an approximation of real differentiation, the approximation will not hold
if there are high frequency components present in the signal. For example if you have
discontinuities such as steps or squere waves.</p>
</div>
<div class="section" id="example">
<h3>Example</h3>
<p>The block is initialized like this:</p>
<pre class="code python literal-block">
#cutoff at 1kHz
D = Differentiator(f_max=1e3)
</pre>
</div>
<div class="section" id="parameters">
<h3>Parameters</h3>
<dl class="docutils">
<dt>f_max <span class="classifier-delimiter">:</span> <span class="classifier">float</span></dt>
<dd>highest expected signal frequency</dd>
</dl>
</div>
<div class="section" id="attributes">
<h3>Attributes</h3>
<dl class="docutils">
<dt>op_dyn <span class="classifier-delimiter">:</span> <span class="classifier">DynamicOperator</span></dt>
<dd>internal dynamic operator for ODE component</dd>
<dt>op_alg <span class="classifier-delimiter">:</span> <span class="classifier">DynamicOperator</span></dt>
<dd>internal algebraic operator</dd>
</dl>
</div>
`,params:{f_max:{type:"number",default:"100.0",description:"highest expected signal frequency"}},inputs:null,outputs:null},Delay:{blockClass:"Delay",description:"Delays the input signal by a time constant 'tau' in seconds.",docstringHtml:`<p>Delays the input signal by a time constant 'tau' in seconds.</p>
<p>Mathematically this block creates a time delay of the input signal like this:</p>
<div class="math">
\\begin{equation*}
y(t) =
\\begin{cases}
x(t - \\tau) &amp; , t \\geq \\tau \\\\
0            &amp; , t &lt; \\tau
\\end{cases}
\\end{equation*}
</div>
<div class="section" id="note">
<h3>Note</h3>
<p>The internal adaptive buffer uses interpolation for the evaluation. This is
required to be compatible with variable step solvers. It has a drawback however.
The order of the ode solver used will degrade when this block is used, due to
the interpolation.</p>
</div>
<div class="section" id="note-1">
<h3>Note</h3>
<p>This block supports vector input, meaning we can have multiple parallel
delay paths through this block.</p>
</div>
<div class="section" id="example">
<h3>Example</h3>
<p>The block is initialized like this:</p>
<pre class="code python literal-block">
#5 time units delay
D = Delay(tau=5)
</pre>
</div>
<div class="section" id="parameters">
<h3>Parameters</h3>
<dl class="docutils">
<dt>tau <span class="classifier-delimiter">:</span> <span class="classifier">float</span></dt>
<dd>delay time constant</dd>
</dl>
</div>
<div class="section" id="attributes">
<h3>Attributes</h3>
<dl class="docutils">
<dt>_buffer <span class="classifier-delimiter">:</span> <span class="classifier">AdaptiveBuffer</span></dt>
<dd>internal interpolatable adaptive rolling buffer</dd>
</dl>
</div>
`,params:{tau:{type:"number",default:"0.001",description:"delay time constant"}},inputs:null,outputs:null},ODE:{blockClass:"ODE",description:"Ordinary differential equation (ODE) defined by its right hand side function.",docstringHtml:`<p>Ordinary differential equation (ODE) defined by its right hand side function.</p>
<div class="math">
\\begin{equation*}
\\begin{align}
    \\dot{x}(t) &amp;= \\mathrm{func}(x(t), u(t), t) \\\\
           y(t) &amp;= x(t)
\\end{align}
\\end{equation*}
</div>
<p>with inhomogenity (input) <cite>u</cite> and state vector <cite>x</cite>. The function can be nonlinear
and the ODE can be of arbitrary order. The block utilizes the integration engine
to solve the ODE by integrating the <cite>func</cite>, which is the right hand side function.</p>
<div class="section" id="example">
<h3>Example</h3>
<p>For example a linear 1st order ODE:</p>
<pre class="code python literal-block">
ode = ODE(lambda x, u, t: -x)
</pre>
<p>Or something more complex like the <cite>Van der Pol</cite> system, where it makes sense to
also specify the jacobian, which improves convergence for implicit solvers but is
not needed in most cases:</p>
<pre class="code python literal-block">
import numpy as np

#initial condition
x0 = np.array([2, 0])

#van der Pol parameter
mu = 1000

def func(x, u, t):
    return np.array([x[1], mu*(1 - x[0]**2)*x[1] - x[0]])

#analytical jacobian (optional)
def jac(x, u, t):
    return np.array(
        [[0                , 1               ],
         [-mu*2*x[0]*x[1]-1, mu*(1 - x[0]**2)]]
         )

#finally the block
vdp = ODE(func, x0, jac)
</pre>
</div>
<div class="section" id="parameters">
<h3>Parameters</h3>
<dl class="docutils">
<dt>func <span class="classifier-delimiter">:</span> <span class="classifier">callable</span></dt>
<dd>right hand side function of ODE</dd>
<dt>initial_value <span class="classifier-delimiter">:</span> <span class="classifier">array[float]</span></dt>
<dd>initial state / initial condition</dd>
<dt>jac <span class="classifier-delimiter">:</span> <span class="classifier">callable, None</span></dt>
<dd>jacobian of 'func' or 'None'</dd>
</dl>
</div>
<div class="section" id="attributes">
<h3>Attributes</h3>
<dl class="docutils">
<dt>op_dyn <span class="classifier-delimiter">:</span> <span class="classifier">DynamicOperator</span></dt>
<dd>internal dynamic operator for ODE right hand side 'func'</dd>
</dl>
</div>
`,params:{func:{type:"callable",default:null,description:"right hand side function of ODE"},initial_value:{type:"number",default:"0.0",description:"initial state / initial condition"},jac:{type:"any",default:null,description:"jacobian of 'func' or 'None'"}},inputs:null,outputs:null},DynamicalSystem:{blockClass:"DynamicalSystem",description:"This block implements a nonlinear dynamical system / nonlinear state space model.",docstringHtml:`<p>This block implements a nonlinear dynamical system / nonlinear state space model.</p>
<p>Its basically the same as the <cite>ODE</cite> block with the addition of an output equation
that takes the state, input and time as arguments:</p>
<div class="math">
\\begin{equation*}
\\begin{align}
    \\dot{x}(t) &amp;= \\mathrm{func}_\\mathrm{dyn}(x(t), u(t), t) \\\\
           y(t) &amp;= \\mathrm{func}_\\mathrm{alg}(x(t), u(t), t)
\\end{align}
\\end{equation*}
</div>
<div class="section" id="parameters">
<h3>Parameters</h3>
<dl class="docutils">
<dt>func_dyn <span class="classifier-delimiter">:</span> <span class="classifier">callable</span></dt>
<dd>right hand side function of ode-part of the system</dd>
<dt>func_alg <span class="classifier-delimiter">:</span> <span class="classifier">callable</span></dt>
<dd>output function of the system</dd>
<dt>initial_value <span class="classifier-delimiter">:</span> <span class="classifier">array[float]</span></dt>
<dd>initial state / initial condition</dd>
<dt>jac_dyn <span class="classifier-delimiter">:</span> <span class="classifier">callable | None</span></dt>
<dd>optional jacobian of <cite>func_dyn</cite> to improve convergence
for implicit ode solvers</dd>
</dl>
</div>
<div class="section" id="attributes">
<h3>Attributes</h3>
<dl class="docutils">
<dt>op_dyn <span class="classifier-delimiter">:</span> <span class="classifier">DynamicOperator</span></dt>
<dd>internal dynamic operator for <cite>func_dyn</cite></dd>
<dt>op_alg <span class="classifier-delimiter">:</span> <span class="classifier">DynamicOperator</span></dt>
<dd>internal dynamic operator for <cite>func_alg</cite></dd>
</dl>
</div>
`,params:{func_dyn:{type:"callable",default:null,description:"right hand side function of ode-part of the system"},func_alg:{type:"callable",default:null,description:"output function of the system"},initial_value:{type:"number",default:"0.0",description:"initial state / initial condition"},jac_dyn:{type:"any",default:null,description:"optional jacobian of `func_dyn` to improve convergence for implicit ode solvers"}},inputs:null,outputs:null},StateSpace:{blockClass:"StateSpace",description:"Linear time invariant (LTI) multi input multi output (MIMO) state space model.",docstringHtml:`<p>Linear time invariant (LTI) multi input multi output (MIMO) state space model.</p>
<div class="math">
\\begin{equation*}
\\begin{align}
    \\dot{x} &amp;= \\mathbf{A} x + \\mathbf{B} u \\\\
           y &amp;= \\mathbf{C} x + \\mathbf{D} u
\\end{align}
\\end{equation*}
</div>
<p>where <cite>A</cite>, <cite>B</cite>, <cite>C</cite> and <cite>D</cite> are the state space matrices, <cite>x</cite> is the state,
<cite>u</cite> the input and <cite>y</cite> the output vector.</p>
<div class="section" id="example">
<h3>Example</h3>
<p>A SISO state space block with two internal states can be initialized
like this:</p>
<pre class="code python literal-block">
S = StateSpace(
    A=-np.eye(2),
    B=np.ones((2, 1)),
    C=np.ones((1, 2)),
    D=1.0
    )
</pre>
<p>and a MIMO (2 in, 2 out) state space block with three internal states
can be initialized like this:</p>
<pre class="code python literal-block">
S = StateSpace(
    A=-np.eye(3),
    B=np.ones((3, 2)),
    C=np.ones((2, 3)),
    D=np.ones((2, 2))
    )
</pre>
</div>
<div class="section" id="parameters">
<h3>Parameters</h3>
<dl class="docutils">
<dt>A, B, C, D <span class="classifier-delimiter">:</span> <span class="classifier">array_like</span></dt>
<dd>real valued state space matrices</dd>
<dt>initial_value <span class="classifier-delimiter">:</span> <span class="classifier">array_like, None</span></dt>
<dd>initial state / initial condition</dd>
</dl>
</div>
<div class="section" id="attributes">
<h3>Attributes</h3>
<dl class="docutils">
<dt>op_dyn <span class="classifier-delimiter">:</span> <span class="classifier">DynamicOperator</span></dt>
<dd>internal dynamic operator for state equation</dd>
<dt>op_alg <span class="classifier-delimiter">:</span> <span class="classifier">DynamicOperator</span></dt>
<dd>internal algebraic operator for mapping to outputs</dd>
</dl>
</div>
`,params:{A:{type:"number",default:"-1.0",description:""},B:{type:"number",default:"1.0",description:""},C:{type:"number",default:"-1.0",description:""},D:{type:"number",default:"1.0",description:"real valued state space matrices"},initial_value:{type:"any",default:null,description:"initial state / initial condition"}},inputs:null,outputs:null},PT1:{blockClass:"PT1",description:"First-order lag element (PT1).",docstringHtml:`<p>First-order lag element (PT1).</p>
<p>The transfer function is defined as</p>
<div class="math">
\\begin{equation*}
H(s) = \\frac{K}{1 + T s}
\\end{equation*}
</div>
<p>where <cite>K</cite> is the static gain and <cite>T</cite> is the time constant.</p>
<div class="section" id="example">
<h3>Example</h3>
<p>The block is initialized like this:</p>
<pre class="code python literal-block">
pt1 = PT1(K=2.0, T=0.5)
</pre>
</div>
<div class="section" id="parameters">
<h3>Parameters</h3>
<dl class="docutils">
<dt>K <span class="classifier-delimiter">:</span> <span class="classifier">float</span></dt>
<dd>static gain</dd>
<dt>T <span class="classifier-delimiter">:</span> <span class="classifier">float</span></dt>
<dd>time constant in seconds (must be &gt; 0)</dd>
</dl>
</div>
`,params:{K:{type:"number",default:"1.0",description:"static gain"},T:{type:"number",default:"1.0",description:"time constant in seconds (must be > 0)"}},inputs:["in"],outputs:["out"]},PT2:{blockClass:"PT2",description:"Second-order lag element (PT2).",docstringHtml:`<p>Second-order lag element (PT2).</p>
<p>The transfer function is defined as</p>
<div class="math">
\\begin{equation*}
H(s) = \\frac{K}{1 + 2 d T s + T^2 s^2}
\\end{equation*}
</div>
<p>where <cite>K</cite> is the static gain, <cite>T</cite> is the time constant
(related to the natural frequency by <span class="math">\\(\\omega_n = 1/T\\)</span>)
and <cite>d</cite> is the damping ratio.</p>
<p>The damping ratio <cite>d</cite> controls the transient behavior:</p>
<ul class="simple">
<li><span class="math">\\(d &lt; 1\\)</span>: underdamped (oscillatory)</li>
<li><span class="math">\\(d = 1\\)</span>: critically damped</li>
<li><span class="math">\\(d &gt; 1\\)</span>: overdamped</li>
</ul>
<div class="section" id="example">
<h3>Example</h3>
<p>The block is initialized like this:</p>
<pre class="code python literal-block">
#underdamped second-order system
pt2 = PT2(K=1.0, T=0.1, d=0.3)
</pre>
</div>
<div class="section" id="parameters">
<h3>Parameters</h3>
<dl class="docutils">
<dt>K <span class="classifier-delimiter">:</span> <span class="classifier">float</span></dt>
<dd>static gain</dd>
<dt>T <span class="classifier-delimiter">:</span> <span class="classifier">float</span></dt>
<dd>time constant in seconds (must be &gt; 0)</dd>
<dt>d <span class="classifier-delimiter">:</span> <span class="classifier">float</span></dt>
<dd>damping ratio (must be &gt;= 0)</dd>
</dl>
</div>
`,params:{K:{type:"number",default:"1.0",description:"static gain"},T:{type:"number",default:"1.0",description:"time constant in seconds (must be > 0)"},d:{type:"number",default:"1.0",description:"damping ratio (must be >= 0)"}},inputs:["in"],outputs:["out"]},LeadLag:{blockClass:"LeadLag",description:"Lead-Lag compensator.",docstringHtml:`<p>Lead-Lag compensator.</p>
<p>The transfer function is defined as</p>
<div class="math">
\\begin{equation*}
H(s) = K \\frac{T_1 s + 1}{T_2 s + 1}
\\end{equation*}
</div>
<p>where <cite>K</cite> is the static gain, <cite>T1</cite> is the lead time constant
and <cite>T2</cite> is the lag time constant.</p>
<ul class="simple">
<li><span class="math">\\(T_1 &gt; T_2\\)</span>: lead compensator (phase advance)</li>
<li><span class="math">\\(T_1 &lt; T_2\\)</span>: lag compensator (phase lag)</li>
<li><span class="math">\\(T_1 = T_2\\)</span>: pure gain</li>
</ul>
<div class="section" id="example">
<h3>Example</h3>
<p>The block is initialized like this:</p>
<pre class="code python literal-block">
#lead compensator
ll = LeadLag(K=1.0, T1=0.5, T2=0.1)
</pre>
</div>
<div class="section" id="parameters">
<h3>Parameters</h3>
<dl class="docutils">
<dt>K <span class="classifier-delimiter">:</span> <span class="classifier">float</span></dt>
<dd>static gain</dd>
<dt>T1 <span class="classifier-delimiter">:</span> <span class="classifier">float</span></dt>
<dd>lead (numerator) time constant in seconds</dd>
<dt>T2 <span class="classifier-delimiter">:</span> <span class="classifier">float</span></dt>
<dd>lag (denominator) time constant in seconds (must be &gt; 0)</dd>
</dl>
</div>
`,params:{K:{type:"number",default:"1.0",description:"static gain"},T1:{type:"number",default:"1.0",description:"lead (numerator) time constant in seconds"},T2:{type:"number",default:"1.0",description:"lag (denominator) time constant in seconds (must be > 0)"}},inputs:["in"],outputs:["out"]},PID:{blockClass:"PID",description:"Proportional-Integral-Differentiation (PID) controller.",docstringHtml:`<p>Proportional-Integral-Differentiation (PID) controller.</p>
<p>The transfer function is defined as</p>
<div class="math">
\\begin{equation*}
H(s) = K_p + K_i \\frac{1}{s} + K_d \\frac{s}{1 + s / f_\\mathrm{max}}
\\end{equation*}
</div>
<p>where the differentiation is approximated by a high pass filter that holds
for signals up to a frequency of approximately <cite>f_max</cite>.</p>
<p>Internally realized as a linear state space model with two states
(differentiator filter state and integrator state).</p>
<div class="section" id="note">
<h3>Note</h3>
<p>Depending on <cite>f_max</cite>, the resulting system might become stiff or ill conditioned!
As a practical choice set <cite>f_max</cite> to 3x the highest expected signal frequency.
Since this block uses an approximation of real differentiation, the approximation will
not hold if there are high frequency components present in the signal. For example if
you have discontinuities such as steps or square waves.</p>
</div>
<div class="section" id="example">
<h3>Example</h3>
<p>The block is initialized like this:</p>
<pre class="code python literal-block">
#cutoff at 1kHz
pid = PID(Kp=2, Ki=0.5, Kd=0.1, f_max=1e3)
</pre>
</div>
<div class="section" id="parameters">
<h3>Parameters</h3>
<dl class="docutils">
<dt>Kp <span class="classifier-delimiter">:</span> <span class="classifier">float</span></dt>
<dd>proportional controller coefficient</dd>
<dt>Ki <span class="classifier-delimiter">:</span> <span class="classifier">float</span></dt>
<dd>integral controller coefficient</dd>
<dt>Kd <span class="classifier-delimiter">:</span> <span class="classifier">float</span></dt>
<dd>differentiator controller coefficient</dd>
<dt>f_max <span class="classifier-delimiter">:</span> <span class="classifier">float</span></dt>
<dd>highest expected signal frequency</dd>
</dl>
</div>
`,params:{Kp:{type:"integer",default:"0",description:"proportional controller coefficient"},Ki:{type:"integer",default:"0",description:"integral controller coefficient"},Kd:{type:"integer",default:"0",description:"differentiator controller coefficient"},f_max:{type:"integer",default:"100",description:"highest expected signal frequency"}},inputs:["in"],outputs:["out"]},AntiWindupPID:{blockClass:"AntiWindupPID",description:"Proportional-Integral-Differentiation (PID) controller with anti-windup mechanism (back-calculation).",docstringHtml:`<p>Proportional-Integral-Differentiation (PID) controller with anti-windup mechanism (back-calculation).</p>
<p>Anti-windup mechanisms are needed when the magnitude of the control signal
from the PID controller is limited by some real world saturation. In these cases,
the integrator will continue to accumulate the control error and &quot;wind itself up&quot;.
Once the setpoint is reached, this can result in significant overshoots. This
implementation adds a conditional feedback term to the internal integrator that
&quot;unwinds&quot; it when the PID output crosses some limits. This is pretty much a
deadzone feedback element for the integrator.</p>
<p>Mathematically, this block implements the following set of ODEs</p>
<div class="math">
\\begin{equation*}
\\begin{align}
\\dot{x}_1 &amp;= f_\\mathrm{max} (u - x_1) \\\\
\\dot{x}_2 &amp;= u - w
\\end{align}
\\end{equation*}
</div>
<p>with the anti-windup feedback (depending on the pid output)</p>
<div class="math">
\\begin{equation*}
w = K_s (y - \\min(\\max(y, y_\\mathrm{min}), y_\\mathrm{max}))
\\end{equation*}
</div>
<p>and the output itself</p>
<div class="math">
\\begin{equation*}
y = K_p u + K_d f_\\mathrm{max} (u - x_1) + K_i x_2
\\end{equation*}
</div>
<div class="section" id="note">
<h3>Note</h3>
<p>Depending on <cite>f_max</cite>, the resulting system might become stiff or ill conditioned!
As a practical choice set <cite>f_max</cite> to 3x the highest expected signal frequency.
Since this block uses an approximation of real differentiation, the approximation will
not hold if there are high frequency components present in the signal. For example if
you have discontinuities such as steps or square waves.</p>
</div>
<div class="section" id="example">
<h3>Example</h3>
<p>The block is initialized like this:</p>
<pre class="code python literal-block">
#cutoff at 1kHz, windup limits at [-5, 5]
pid = AntiWindupPID(Kp=2, Ki=0.5, Kd=0.1, f_max=1e3, limits=[-5, 5])
</pre>
</div>
<div class="section" id="parameters">
<h3>Parameters</h3>
<dl class="docutils">
<dt>Kp <span class="classifier-delimiter">:</span> <span class="classifier">float</span></dt>
<dd>proportional controller coefficient</dd>
<dt>Ki <span class="classifier-delimiter">:</span> <span class="classifier">float</span></dt>
<dd>integral controller coefficient</dd>
<dt>Kd <span class="classifier-delimiter">:</span> <span class="classifier">float</span></dt>
<dd>differentiator controller coefficient</dd>
<dt>f_max <span class="classifier-delimiter">:</span> <span class="classifier">float</span></dt>
<dd>highest expected signal frequency</dd>
<dt>Ks <span class="classifier-delimiter">:</span> <span class="classifier">float</span></dt>
<dd>feedback term for back calculation for anti-windup control of integrator</dd>
<dt>limits <span class="classifier-delimiter">:</span> <span class="classifier">array_like[float]</span></dt>
<dd>lower and upper limit for PID output that triggers anti-windup of integrator</dd>
</dl>
</div>
`,params:{Kp:{type:"integer",default:"0",description:"proportional controller coefficient"},Ki:{type:"integer",default:"0",description:"integral controller coefficient"},Kd:{type:"integer",default:"0",description:"differentiator controller coefficient"},f_max:{type:"integer",default:"100",description:"highest expected signal frequency"},Ks:{type:"integer",default:"10",description:"feedback term for back calculation for anti-windup control of integrator"},limits:{type:"array",default:"[-10, 10]",description:"lower and upper limit for PID output that triggers anti-windup of integrator"}},inputs:["in"],outputs:["out"]},RateLimiter:{blockClass:"RateLimiter",description:"Rate limiter block that limits the rate of change of a signal.",docstringHtml:`<p>Rate limiter block that limits the rate of change of a signal.</p>
<p>Implements a continuous-time rate limiter as a first-order tracking system
with clipped rate of change:</p>
<div class="math">
\\begin{equation*}
\\dot{x} = \\mathrm{clip}\\left(f_\\mathrm{max} (u - x),\\; -r,\\; r\\right)
\\end{equation*}
</div>
<p>where <cite>r</cite> is the maximum allowed rate and <cite>f_max</cite> controls the tracking
bandwidth when the signal is not rate-limited. The output is the state
<span class="math">\\(y = x\\)</span>.</p>
<div class="section" id="note">
<h3>Note</h3>
<p>The parameter <cite>f_max</cite> should be set high enough that the output tracks
the input without lag when the rate is within limits.</p>
</div>
<div class="section" id="example">
<h3>Example</h3>
<p>The block is initialized like this:</p>
<pre class="code python literal-block">
#max rate of 10 units/s
rl = RateLimiter(rate=10.0, f_max=1e3)
</pre>
</div>
<div class="section" id="parameters">
<h3>Parameters</h3>
<dl class="docutils">
<dt>rate <span class="classifier-delimiter">:</span> <span class="classifier">float</span></dt>
<dd>maximum rate of change (positive value)</dd>
<dt>f_max <span class="classifier-delimiter">:</span> <span class="classifier">float</span></dt>
<dd>tracking bandwidth parameter</dd>
</dl>
</div>
`,params:{rate:{type:"number",default:"1.0",description:"maximum rate of change (positive value)"},f_max:{type:"integer",default:"100",description:"tracking bandwidth parameter"}},inputs:["in"],outputs:["out"]},Backlash:{blockClass:"Backlash",description:"Backlash (mechanical play) element.",docstringHtml:`<p>Backlash (mechanical play) element.</p>
<p>Models the hysteresis-like behavior of mechanical backlash in gears,
couplings and other systems with play. The output only tracks the input
after the input has moved through the full backlash width.</p>
<div class="math">
\\begin{equation*}
\\dot{x} = f_\\mathrm{max} \\left((u - x) - \\mathrm{clip}(u - x,\\; -w/2,\\; w/2)\\right)
\\end{equation*}
</div>
<p>where <cite>w</cite> is the total backlash width. Inside the dead zone <span class="math">\\(|u - x| \\leq w/2\\)</span>
the output does not move. Once the input pushes past the edge, the output
tracks with bandwidth <cite>f_max</cite>.</p>
<div class="section" id="example">
<h3>Example</h3>
<p>The block is initialized like this:</p>
<pre class="code python literal-block">
#backlash with 0.5 units of total play
bl = Backlash(width=0.5, f_max=1e3)
</pre>
</div>
<div class="section" id="parameters">
<h3>Parameters</h3>
<dl class="docutils">
<dt>width <span class="classifier-delimiter">:</span> <span class="classifier">float</span></dt>
<dd>total backlash width (play)</dd>
<dt>f_max <span class="classifier-delimiter">:</span> <span class="classifier">float</span></dt>
<dd>tracking bandwidth parameter when engaged</dd>
</dl>
</div>
`,params:{width:{type:"number",default:"1.0",description:"total backlash width (play)"},f_max:{type:"integer",default:"100",description:"tracking bandwidth parameter when engaged"}},inputs:["in"],outputs:["out"]},Deadband:{blockClass:"Deadband",description:"Deadband (dead zone) element.",docstringHtml:`<p>Deadband (dead zone) element.</p>
<p>Outputs zero when the input is within the dead zone, and passes
the signal shifted by the zone boundary otherwise:</p>
<div class="math">
\\begin{equation*}
y = \\begin{cases}
    u - u_\\mathrm{upper} &amp; \\text{if } u &gt; u_\\mathrm{upper} \\\\
    0 &amp; \\text{if } u_\\mathrm{lower} \\leq u \\leq u_\\mathrm{upper} \\\\
    u - u_\\mathrm{lower} &amp; \\text{if } u &lt; u_\\mathrm{lower}
\\end{cases}
\\end{equation*}
</div>
<p>or equivalently <span class="math">\\(y = u - \\mathrm{clip}(u,\\; u_\\mathrm{lower},\\; u_\\mathrm{upper})\\)</span>.</p>
<div class="section" id="example">
<h3>Example</h3>
<p>The block is initialized like this:</p>
<pre class="code python literal-block">
#symmetric dead zone of width 0.2
db = Deadband(lower=-0.1, upper=0.1)
</pre>
</div>
<div class="section" id="parameters">
<h3>Parameters</h3>
<dl class="docutils">
<dt>lower <span class="classifier-delimiter">:</span> <span class="classifier">float</span></dt>
<dd>lower bound of the dead zone</dd>
<dt>upper <span class="classifier-delimiter">:</span> <span class="classifier">float</span></dt>
<dd>upper bound of the dead zone</dd>
</dl>
</div>
`,params:{lower:{type:"number",default:"-1.0",description:"lower bound of the dead zone"},upper:{type:"number",default:"1.0",description:"upper bound of the dead zone"}},inputs:["in"],outputs:["out"]},TransferFunctionNumDen:{blockClass:"TransferFunctionNumDen",description:"This block defines a LTI (SISO) transfer function.",docstringHtml:`<p>This block defines a LTI (SISO) transfer function.</p>
<p>The transfer function is defined in polynomial (numerator-denominator) form</p>
<div class="math">
\\begin{equation*}
\\mathbf{H}(s) = \\frac{b_n + b_{n-1} s + \\dots + b_{0} s^n}{a_m + a_{m-1} s + \\dots + a_{0} s^m}
\\end{equation*}
</div>
<p>where <cite>Num</cite> is the list of numerator polynomial coefficients and <cite>Den</cite> the
list of denominator coefficients.</p>
<p>Upon initialization, the state space realization of the transfer function is
computed using <cite>scipy.signal.TransferFunction(Num, Den).to_ss()</cite>.</p>
<p>The resulting state space model of the form</p>
<div class="math">
\\begin{equation*}
\\begin{align}
    \\dot{x} &amp;= \\mathbf{A} x + \\mathbf{B} u \\\\
           y &amp;= \\mathbf{C} x + \\mathbf{D} u
\\end{align}
\\end{equation*}
</div>
<p>is handled the same as the 'StateSpace' block, where <cite>A</cite>, <cite>B</cite>, <cite>C</cite> and <cite>D</cite>
are the state space matrices, <cite>x</cite> is the internal state, <cite>u</cite> the input and
<cite>y</cite> the output vector.</p>
<div class="section" id="parameters">
<h3>Parameters</h3>
<dl class="docutils">
<dt>Num <span class="classifier-delimiter">:</span> <span class="classifier">array_like</span></dt>
<dd>numerator polynomial coefficients</dd>
<dt>Den <span class="classifier-delimiter">:</span> <span class="classifier">array_like</span></dt>
<dd>denominator polynomial coefficients</dd>
</dl>
</div>
`,params:{Num:{type:"array",default:"[1]",description:"numerator polynomial coefficients"},Den:{type:"array",default:"[1, 1]",description:"denominator polynomial coefficients"}},inputs:["in"],outputs:["out"]},TransferFunctionZPG:{blockClass:"TransferFunctionZPG",description:"This block defines a LTI (SISO) transfer function.",docstringHtml:`<p>This block defines a LTI (SISO) transfer function.</p>
<p>The transfer function is defined in zeros-poles-gain (ZPG) form</p>
<div class="math">
\\begin{equation*}
\\mathbf{H}(s) = k \\frac{(s - z_1)(s - z_2)\\cdots(s - z_m)}{(s - p_1)(s - p_2)\\cdots(s - p_n)}
\\end{equation*}
</div>
<p>where <cite>Zeros</cite> are the scalar (possibly complex conjugate) zeros of the
transfer function, and <cite>Poles</cite> are the poles (denominator zeros) of the
transfer function. <cite>Gain</cite> is the scalar factor <cite>k</cite>.</p>
<p>Upon initialization, the state space realization of the transfer function is
computed using <cite>scipy.signal.ZerosPolesGain(Zeros, Poles, Gain).to_ss()</cite>.</p>
<p>The resulting state space model of the form</p>
<div class="math">
\\begin{equation*}
\\begin{align}
    \\dot{x} &amp;= \\mathbf{A} x + \\mathbf{B} u \\\\
           y &amp;= \\mathbf{C} x + \\mathbf{D} u
\\end{align}
\\end{equation*}
</div>
<p>is handled the same as the 'StateSpace' block, where <cite>A</cite>, <cite>B</cite>, <cite>C</cite> and <cite>D</cite>
are the state space matrices, <cite>x</cite> is the internal state, <cite>u</cite> the input and
<cite>y</cite> the output vector.</p>
<div class="section" id="parameters">
<h3>Parameters</h3>
<dl class="docutils">
<dt>Poles <span class="classifier-delimiter">:</span> <span class="classifier">array_like</span></dt>
<dd>transfer function poles</dd>
<dt>Zeros <span class="classifier-delimiter">:</span> <span class="classifier">array_like</span></dt>
<dd>transfer function zeros</dd>
<dt>Gain <span class="classifier-delimiter">:</span> <span class="classifier">float</span></dt>
<dd>gain term of transfer function</dd>
</dl>
</div>
`,params:{Zeros:{type:"array",default:"[]",description:"transfer function zeros"},Poles:{type:"array",default:"[-1]",description:"transfer function poles"},Gain:{type:"number",default:"1.0",description:"gain term of transfer function"}},inputs:["in"],outputs:["out"]},ButterworthLowpassFilter:{blockClass:"ButterworthLowpassFilter",description:"Direct implementation of a low pass butterworth filter block.",docstringHtml:`<p>Direct implementation of a low pass butterworth filter block.</p>
<p>Follows the same structure as the 'StateSpace' block in the
'pathsim.blocks' module. The numerator and denominator of the
filter transfer function are generated and then the transfer
function is realized as a state space model.</p>
<div class="section" id="parameters">
<h3>Parameters</h3>
<dl class="docutils">
<dt>Fc <span class="classifier-delimiter">:</span> <span class="classifier">float</span></dt>
<dd>corner frequency of the filter in [Hz]</dd>
<dt>n <span class="classifier-delimiter">:</span> <span class="classifier">int</span></dt>
<dd>filter order</dd>
</dl>
</div>
`,params:{Fc:{type:"integer",default:"100",description:"corner frequency of the filter in [Hz]"},n:{type:"integer",default:"2",description:"filter order"}},inputs:["in"],outputs:["out"]},ButterworthHighpassFilter:{blockClass:"ButterworthHighpassFilter",description:"Direct implementation of a high pass butterworth filter block.",docstringHtml:`<p>Direct implementation of a high pass butterworth filter block.</p>
<p>Follows the same structure as the 'StateSpace' block in the
'pathsim.blocks' module. The numerator and denominator of the
filter transfer function are generated and then the transfer
function is realized as a state space model.</p>
<div class="section" id="parameters">
<h3>Parameters</h3>
<dl class="docutils">
<dt>Fc <span class="classifier-delimiter">:</span> <span class="classifier">float</span></dt>
<dd>corner frequency of the filter in [Hz]</dd>
<dt>n <span class="classifier-delimiter">:</span> <span class="classifier">int</span></dt>
<dd>filter order</dd>
</dl>
</div>
`,params:{Fc:{type:"integer",default:"100",description:"corner frequency of the filter in [Hz]"},n:{type:"integer",default:"2",description:"filter order"}},inputs:["in"],outputs:["out"]},ButterworthBandpassFilter:{blockClass:"ButterworthBandpassFilter",description:"Direct implementation of a bandpass butterworth filter block.",docstringHtml:`<p>Direct implementation of a bandpass butterworth filter block.</p>
<p>Follows the same structure as the 'StateSpace' block in the
'pathsim.blocks' module. The numerator and denominator of the
filter transfer function are generated and then the transfer
function is realized as a state space model.</p>
<div class="section" id="parameters">
<h3>Parameters</h3>
<dl class="docutils">
<dt>Fc <span class="classifier-delimiter">:</span> <span class="classifier">list[float]</span></dt>
<dd>corner frequencies (left, right) of the filter in [Hz]</dd>
<dt>n <span class="classifier-delimiter">:</span> <span class="classifier">int</span></dt>
<dd>filter order</dd>
</dl>
</div>
`,params:{Fc:{type:"array",default:"[50, 100]",description:"corner frequencies (left, right) of the filter in [Hz]"},n:{type:"integer",default:"2",description:"filter order"}},inputs:["in"],outputs:["out"]},ButterworthBandstopFilter:{blockClass:"ButterworthBandstopFilter",description:"Direct implementation of a bandstop butterworth filter block.",docstringHtml:`<p>Direct implementation of a bandstop butterworth filter block.</p>
<p>Follows the same structure as the 'StateSpace' block in the
'pathsim.blocks' module. The numerator and denominator of the
filter transfer function are generated and then the transfer
function is realized as a state space model.</p>
<div class="section" id="parameters">
<h3>Parameters</h3>
<dl class="docutils">
<dt>Fc <span class="classifier-delimiter">:</span> <span class="classifier">tuple[float], list[float]</span></dt>
<dd>corner frequencies (left, right) of the filter in [Hz]</dd>
<dt>n <span class="classifier-delimiter">:</span> <span class="classifier">int</span></dt>
<dd>filter order</dd>
</dl>
</div>
`,params:{Fc:{type:"array",default:"[50, 100]",description:"corner frequencies (left, right) of the filter in [Hz]"},n:{type:"integer",default:"2",description:"filter order"}},inputs:["in"],outputs:["out"]},Adder:{blockClass:"Adder",description:"Summs / adds up all input signals to a single output signal (MISO)",docstringHtml:`<p>Summs / adds up all input signals to a single output signal (MISO)</p>
<p>This is how it works in the default case</p>
<div class="math">
\\begin{equation*}
y(t) = \\sum_i u_i(t)
\\end{equation*}
</div>
<p>and like this when additional operations are defined</p>
<div class="math">
\\begin{equation*}
y(t) = \\sum_i \\mathrm{op}_i \\cdot u_i(t)
\\end{equation*}
</div>
<div class="section" id="example">
<h3>Example</h3>
<p>This is the default initialization that just adds up all the inputs:</p>
<pre class="code python literal-block">
A = Adder()
</pre>
<p>and this is the initialization with specific operations that subtracts
the second from first input and neglects all others:</p>
<pre class="code python literal-block">
A = Adder('+-')
</pre>
</div>
<div class="section" id="note">
<h3>Note</h3>
<p>This block is purely algebraic and its operation (<cite>op_alg</cite>) will be called
multiple times per timestep, each time when <cite>Simulation._update(t)</cite> is
called in the global simulation loop.</p>
</div>
<div class="section" id="parameters">
<h3>Parameters</h3>
<dl class="docutils">
<dt>operations <span class="classifier-delimiter">:</span> <span class="classifier">str, optional</span></dt>
<dd>optional string of operations to be applied before
summation, i.e. '+-' will compute the difference,
'None' will just perform regular sum</dd>
</dl>
</div>
<div class="section" id="attributes">
<h3>Attributes</h3>
<dl class="docutils">
<dt>_ops <span class="classifier-delimiter">:</span> <span class="classifier">dict</span></dt>
<dd>dict that maps string operations to numerical</dd>
<dt>_ops_array <span class="classifier-delimiter">:</span> <span class="classifier">array_like</span></dt>
<dd>operations converted to array</dd>
<dt>op_alg <span class="classifier-delimiter">:</span> <span class="classifier">Operator</span></dt>
<dd>internal algebraic operator</dd>
</dl>
</div>
`,params:{operations:{type:"any",default:null,description:"optional string of operations to be applied before summation, i.e. '+-' will compute the difference, 'None' will just perform regular sum"}},inputs:null,outputs:["out"]},Multiplier:{blockClass:"Multiplier",description:"Multiplies all signals from all input ports (MISO).",docstringHtml:`<p>Multiplies all signals from all input ports (MISO).</p>
<div class="math">
\\begin{equation*}
y(t) = \\prod_i u_i(t)
\\end{equation*}
</div>
<div class="section" id="note">
<h3>Note</h3>
<p>This block is purely algebraic and its operation (<cite>op_alg</cite>) will be called
multiple times per timestep, each time when <cite>Simulation._update(t)</cite> is
called in the global simulation loop.</p>
</div>
<div class="section" id="attributes">
<h3>Attributes</h3>
<dl class="docutils">
<dt>op_alg <span class="classifier-delimiter">:</span> <span class="classifier">Operator</span></dt>
<dd>internal algebraic operator that wraps 'prod'</dd>
</dl>
</div>
`,params:{},inputs:null,outputs:["out"]},Amplifier:{blockClass:"Amplifier",description:"Amplifies the input signal by multiplication with a constant gain term.",docstringHtml:`<p>Amplifies the input signal by multiplication with a constant gain term.</p>
<p>Like this:</p>
<div class="math">
\\begin{equation*}
y(t) = \\mathrm{gain} \\cdot u(t)
\\end{equation*}
</div>
<div class="section" id="note">
<h3>Note</h3>
<p>This block is purely algebraic and its operation (<cite>op_alg</cite>) will be called
multiple times per timestep, each time when <cite>Simulation._update(t)</cite> is
called in the global simulation loop.</p>
</div>
<div class="section" id="example">
<h3>Example</h3>
<p>The block is initialized like this:</p>
<pre class="code python literal-block">
#amplification by factor 5
A = Amplifier(gain=5)
</pre>
</div>
<div class="section" id="parameters">
<h3>Parameters</h3>
<dl class="docutils">
<dt>gain <span class="classifier-delimiter">:</span> <span class="classifier">float</span></dt>
<dd>amplifier gain</dd>
</dl>
</div>
<div class="section" id="attributes">
<h3>Attributes</h3>
<dl class="docutils">
<dt>op_alg <span class="classifier-delimiter">:</span> <span class="classifier">Operator</span></dt>
<dd>internal algebraic operator</dd>
</dl>
</div>
`,params:{gain:{type:"number",default:"1.0",description:"amplifier gain"}},inputs:null,outputs:null},Function:{blockClass:"Function",description:"Arbitrary MIMO function block, defined by a function or `lambda` expression.",docstringHtml:`<p>Arbitrary MIMO function block, defined by a function or <cite>lambda</cite> expression.</p>
<p>The function can have multiple arguments that are then provided
by the input channels of the function block.</p>
<p>Form multi input, the function has to specify multiple arguments
and for multi output, the aoutputs have to be provided as a
tuple or list.</p>
<p>In the context of the global system, this block implements algebraic
components of the global system ODE/DAE.</p>
<div class="math">
\\begin{equation*}
\\vec{y} = \\mathrm{func}(\\vec{u})
\\end{equation*}
</div>
<div class="section" id="note">
<h3>Note</h3>
<p>This block is purely algebraic and its operation (<cite>op_alg</cite>) will be called
multiple times per timestep, each time when <cite>Simulation._update(t)</cite> is
called in the global simulation loop.
Therefore <cite>func</cite> must be purely algebraic and not introduce states,
delay, etc. For interfacing with external stateful APIs, use the
<cite>Wrapper</cite> block.</p>
</div>
<div class="section" id="note-1">
<h3>Note</h3>
<p>If the outputs are provided as a single numpy array, they are
considered a single output. For MIMO, output has to be tuple.</p>
</div>
<div class="section" id="example">
<h3>Example</h3>
<p>consider the function:</p>
<pre class="code python literal-block">
from pathsim.blocks import Function

def f(a, b, c):
    return a**2, a*b, b/c

fn = Function(f)
</pre>
<p>then, when the block is updated, the input channels of the block are
assigned to the function arguments following this scheme:</p>
<pre class="code literal-block">
inputs[0] -&gt; a
inputs[1] -&gt; b
inputs[2] -&gt; c
</pre>
<p>and the function outputs are assigned to the
output channels of the block in the same way:</p>
<pre class="code literal-block">
a**2 -&gt; outputs[0]
a*b  -&gt; outputs[1]
b/c  -&gt; outputs[2]
</pre>
<p>Because the <cite>Function</cite> block only has a single argument, it can be
used to decorate a function and make it a <cite>PathSim</cite> block. This might
be handy in some cases to keep definitions concise and localized
in the code:</p>
<pre class="code python literal-block">
from pathsim.blocks import Function

#does the same as the definition above

&#64;Function
def fn(a, b, c):
    return a**2, a*b, b/c

#'fn' is now a PathSim block
</pre>
</div>
<div class="section" id="parameters">
<h3>Parameters</h3>
<dl class="docutils">
<dt>func <span class="classifier-delimiter">:</span> <span class="classifier">callable</span></dt>
<dd>MIMO function that defines algebraic block IO behaviour, signature <cite>func(*tuple)</cite></dd>
</dl>
</div>
<div class="section" id="attributes">
<h3>Attributes</h3>
<dl class="docutils">
<dt>op_alg <span class="classifier-delimiter">:</span> <span class="classifier">Operator</span></dt>
<dd>internal algebraic operator that wraps <cite>func</cite></dd>
</dl>
</div>
`,params:{func:{type:"callable",default:null,description:"MIMO function that defines algebraic block IO behaviour, signature `func(*tuple)`"}},inputs:null,outputs:null},Sin:{blockClass:"Sin",description:"Sine operator block.",docstringHtml:`<p>Sine operator block.</p>
<p>This block supports vector inputs. This is the operation it does:</p>
<div class="math">
\\begin{equation*}
\\vec{y} = \\sin(\\vec{u})
\\end{equation*}
</div>
<div class="section" id="attributes">
<h3>Attributes</h3>
<dl class="docutils">
<dt>op_alg <span class="classifier-delimiter">:</span> <span class="classifier">Operator</span></dt>
<dd>internal algebraic operator</dd>
</dl>
</div>
`,params:{},inputs:null,outputs:null},Cos:{blockClass:"Cos",description:"Cosine operator block.",docstringHtml:`<p>Cosine operator block.</p>
<p>This block supports vector inputs. This is the operation it does:</p>
<div class="math">
\\begin{equation*}
\\vec{y} = \\cos(\\vec{u})
\\end{equation*}
</div>
<div class="section" id="attributes">
<h3>Attributes</h3>
<dl class="docutils">
<dt>op_alg <span class="classifier-delimiter">:</span> <span class="classifier">Operator</span></dt>
<dd>internal algebraic operator</dd>
</dl>
</div>
`,params:{},inputs:null,outputs:null},Tan:{blockClass:"Tan",description:"Tangent operator block.",docstringHtml:`<p>Tangent operator block.</p>
<p>This block supports vector inputs. This is the operation it does:</p>
<div class="math">
\\begin{equation*}
\\vec{y} = \\tan(\\vec{u})
\\end{equation*}
</div>
<div class="section" id="attributes">
<h3>Attributes</h3>
<dl class="docutils">
<dt>op_alg <span class="classifier-delimiter">:</span> <span class="classifier">Operator</span></dt>
<dd>internal algebraic operator</dd>
</dl>
</div>
`,params:{},inputs:null,outputs:null},Tanh:{blockClass:"Tanh",description:"Hyperbolic tangent operator block.",docstringHtml:`<p>Hyperbolic tangent operator block.</p>
<p>This block supports vector inputs. This is the operation it does:</p>
<div class="math">
\\begin{equation*}
\\vec{y} = \\tanh(\\vec{u})
\\end{equation*}
</div>
<div class="section" id="attributes">
<h3>Attributes</h3>
<dl class="docutils">
<dt>op_alg <span class="classifier-delimiter">:</span> <span class="classifier">Operator</span></dt>
<dd>internal algebraic operator</dd>
</dl>
</div>
`,params:{},inputs:null,outputs:null},Abs:{blockClass:"Abs",description:"Absolute value operator block.",docstringHtml:`<p>Absolute value operator block.</p>
<p>This block supports vector inputs. This is the operation it does:</p>
<div class="math">
\\begin{equation*}
\\vec{y} = \\vert| \\vec{u} \\vert|
\\end{equation*}
</div>
<div class="section" id="attributes">
<h3>Attributes</h3>
<dl class="docutils">
<dt>op_alg <span class="classifier-delimiter">:</span> <span class="classifier">Operator</span></dt>
<dd>internal algebraic operator</dd>
</dl>
</div>
`,params:{},inputs:null,outputs:null},Sqrt:{blockClass:"Sqrt",description:"Square root operator block.",docstringHtml:`<p>Square root operator block.</p>
<p>This block supports vector inputs. This is the operation it does:</p>
<div class="math">
\\begin{equation*}
\\vec{y} = \\sqrt{|\\vec{u}|}
\\end{equation*}
</div>
<div class="section" id="attributes">
<h3>Attributes</h3>
<dl class="docutils">
<dt>op_alg <span class="classifier-delimiter">:</span> <span class="classifier">Operator</span></dt>
<dd>internal algebraic operator</dd>
</dl>
</div>
`,params:{},inputs:null,outputs:null},Exp:{blockClass:"Exp",description:"Exponential operator block.",docstringHtml:`<p>Exponential operator block.</p>
<p>This block supports vector inputs. This is the operation it does:</p>
<div class="math">
\\begin{equation*}
\\vec{y} = e^{\\vec{u}}
\\end{equation*}
</div>
<div class="section" id="attributes">
<h3>Attributes</h3>
<dl class="docutils">
<dt>op_alg <span class="classifier-delimiter">:</span> <span class="classifier">Operator</span></dt>
<dd>internal algebraic operator</dd>
</dl>
</div>
`,params:{},inputs:null,outputs:null},Log:{blockClass:"Log",description:"Natural logarithm operator block.",docstringHtml:`<p>Natural logarithm operator block.</p>
<p>This block supports vector inputs. This is the operation it does:</p>
<div class="math">
\\begin{equation*}
\\vec{y} = \\ln(\\vec{u})
\\end{equation*}
</div>
<div class="section" id="attributes">
<h3>Attributes</h3>
<dl class="docutils">
<dt>op_alg <span class="classifier-delimiter">:</span> <span class="classifier">Operator</span></dt>
<dd>internal algebraic operator</dd>
</dl>
</div>
`,params:{},inputs:null,outputs:null},Log10:{blockClass:"Log10",description:"Base-10 logarithm operator block.",docstringHtml:`<p>Base-10 logarithm operator block.</p>
<p>This block supports vector inputs. This is the operation it does:</p>
<div class="math">
\\begin{equation*}
\\vec{y} = \\log_{10}(\\vec{u})
\\end{equation*}
</div>
<div class="section" id="attributes">
<h3>Attributes</h3>
<dl class="docutils">
<dt>op_alg <span class="classifier-delimiter">:</span> <span class="classifier">Operator</span></dt>
<dd>internal algebraic operator</dd>
</dl>
</div>
`,params:{},inputs:null,outputs:null},Mod:{blockClass:"Mod",description:"Modulo operator block.",docstringHtml:`<p>Modulo operator block.</p>
<p>This block supports vector inputs. This is the operation it does:</p>
<div class="math">
\\begin{equation*}
\\vec{y} = \\vec{u} \\bmod m
\\end{equation*}
</div>
<div class="section" id="note">
<h3>Note</h3>
<p>modulo is not differentiable at discontinuities</p>
</div>
<div class="section" id="parameters">
<h3>Parameters</h3>
<dl class="docutils">
<dt>modulus <span class="classifier-delimiter">:</span> <span class="classifier">float</span></dt>
<dd>modulus value</dd>
</dl>
</div>
<div class="section" id="attributes">
<h3>Attributes</h3>
<dl class="docutils">
<dt>op_alg <span class="classifier-delimiter">:</span> <span class="classifier">Operator</span></dt>
<dd>internal algebraic operator</dd>
</dl>
</div>
`,params:{modulus:{type:"number",default:"1.0",description:"modulus value Attributes ----------"}},inputs:null,outputs:null},Clip:{blockClass:"Clip",description:"Clipping/saturation operator block.",docstringHtml:`<p>Clipping/saturation operator block.</p>
<p>This block supports vector inputs. This is the operation it does:</p>
<div class="math">
\\begin{equation*}
\\vec{y} = \\text{clip}(\\vec{u}, u_{min}, u_{max})
\\end{equation*}
</div>
<div class="section" id="parameters">
<h3>Parameters</h3>
<dl class="docutils">
<dt>min_val <span class="classifier-delimiter">:</span> <span class="classifier">float, array_like</span></dt>
<dd>minimum clipping value</dd>
<dt>max_val <span class="classifier-delimiter">:</span> <span class="classifier">float, array_like</span></dt>
<dd>maximum clipping value</dd>
</dl>
</div>
<div class="section" id="attributes">
<h3>Attributes</h3>
<dl class="docutils">
<dt>op_alg <span class="classifier-delimiter">:</span> <span class="classifier">Operator</span></dt>
<dd>internal algebraic operator</dd>
</dl>
</div>
`,params:{min_val:{type:"number",default:"-1.0",description:"minimum clipping value"},max_val:{type:"number",default:"1.0",description:"maximum clipping value Attributes ----------"}},inputs:null,outputs:null},Pow:{blockClass:"Pow",description:"Raise to power operator block.",docstringHtml:`<p>Raise to power operator block.</p>
<p>This block supports vector inputs. This is the operation it does:</p>
<div class="math">
\\begin{equation*}
\\vec{y} = \\vec{u}^{p}
\\end{equation*}
</div>
<div class="section" id="parameters">
<h3>Parameters</h3>
<dl class="docutils">
<dt>exponent <span class="classifier-delimiter">:</span> <span class="classifier">float, array_like</span></dt>
<dd>exponent to raise the input to the power of</dd>
</dl>
</div>
<div class="section" id="attributes">
<h3>Attributes</h3>
<dl class="docutils">
<dt>op_alg <span class="classifier-delimiter">:</span> <span class="classifier">Operator</span></dt>
<dd>internal algebraic operator</dd>
</dl>
</div>
`,params:{exponent:{type:"integer",default:"2",description:"exponent to raise the input to the power of Attributes ----------"}},inputs:null,outputs:null},Switch:{blockClass:"Switch",description:"Switch block that selects between its inputs.",docstringHtml:`<p>Switch block that selects between its inputs.</p>
<div class="section" id="example">
<h3>Example</h3>
<p>The block is initialized like this:</p>
<pre class="code python literal-block">
#default None -&gt; no passthrough
s1 = Switch()

#selecting port 2 as passthrough
s2 = Switch(2)

#change the state of the switch to port 3
s2.select(3)
</pre>
<p>Sets block output depending on <cite>self.switch_state</cite> like this:</p>
<pre class="code literal-block">
switch_state == None -&gt; outputs[0] = 0

switch_state == 0 -&gt; outputs[0] = inputs[0]

switch_state == 1 -&gt; outputs[0] = inputs[1]

switch_state == 2 -&gt; outputs[0] = inputs[2]

...
</pre>
</div>
<div class="section" id="parameters">
<h3>Parameters</h3>
<dl class="docutils">
<dt>switch_state <span class="classifier-delimiter">:</span> <span class="classifier">int, None</span></dt>
<dd>state of the switch</dd>
</dl>
</div>
`,params:{switch_state:{type:"any",default:null,description:"state of the switch"}},inputs:null,outputs:["out"]},LUT:{blockClass:"LUT",description:"N-dimensional lookup table with linear interpolation functionality.",docstringHtml:`<p>N-dimensional lookup table with linear interpolation functionality.</p>
<p>This class implements a multi-dimensional lookup table that uses scipy's
LinearNDInterpolator <a class="footnote-reference" href="#scipy" id="footnote-reference-1">[1]</a> for piecewise linear interpolation in N-dimensional
space. The interpolation is based on Delaunay triangulation of the input points,
providing smooth linear interpolation between data points. For points outside
the convex hull of the input data, the interpolator returns NaN values.</p>
<p>The LUT acts as a Function block.</p>
<div class="section" id="references">
<h3>References</h3>
<table class="docutils footnote" frame="void" id="scipy" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label"><a class="fn-backref" href="#footnote-reference-1">[1]</a></td><td><a class="reference external" href="https://docs.scipy.org/doc/scipy-1.16.1/reference/generated/scipy.interpolate.LinearNDInterpolator.html">https://docs.scipy.org/doc/scipy-1.16.1/reference/generated/scipy.interpolate.LinearNDInterpolator.html</a></td></tr>
</tbody>
</table>
</div>
<div class="section" id="parameters">
<h3>Parameters</h3>
<dl class="docutils">
<dt>points <span class="classifier-delimiter">:</span> <span class="classifier">array_like of shape (n, ndim)</span></dt>
<dd>2-D array of data point coordinates where n is the number of points
and ndim is the dimensionality of the space. Each row represents a
single data point in ndim-dimensional space.</dd>
<dt>values <span class="classifier-delimiter">:</span> <span class="classifier">array_like of shape (n,) or (n, m)</span></dt>
<dd>N-D array of data values at the corresponding points. If 1-D, represents
scalar values at each point. If 2-D, each column represents a different
output dimension (m output values per input point).</dd>
</dl>
</div>
<div class="section" id="attributes">
<h3>Attributes</h3>
<dl class="docutils">
<dt>points <span class="classifier-delimiter">:</span> <span class="classifier">ndarray</span></dt>
<dd>Stored array of input point coordinates.</dd>
<dt>values <span class="classifier-delimiter">:</span> <span class="classifier">ndarray</span></dt>
<dd>Stored array of output values at each point.</dd>
<dt>inter <span class="classifier-delimiter">:</span> <span class="classifier">scipy.interpolate.LinearNDInterpolator</span></dt>
<dd>The scipy linear interpolator object used for interpolation.</dd>
</dl>
</div>
`,params:{points:{type:"any",default:null,description:"2-D array of data point coordinates where n is the number of points and ndim is the dimensionality of the space. Each row represents a single data point in ndim-dimensional space."},values:{type:"any",default:null,description:"N-D array of data values at the corresponding points. If 1-D, represents scalar values at each point. If 2-D, each column represents a different output dimension (m output values per input point)."}},inputs:null,outputs:null},LUT1D:{blockClass:"LUT1D",description:"One-dimensional lookup table with linear interpolation functionality.",docstringHtml:`<p>One-dimensional lookup table with linear interpolation functionality.</p>
<p>This class implements a 1-dimensional lookup table that uses scipy's interp1d <a class="footnote-reference" href="#scipy" id="footnote-reference-1">[1]</a>
for piecewise linear interpolation along a single axis. The interpolation
provides linear interpolation between adjacent data points and supports
extrapolation beyond the input data range using the 'extrapolate' fill mode.</p>
<p>The LUT1D acts as a Function block.</p>
<div class="section" id="references">
<h3>References</h3>
<table class="docutils footnote" frame="void" id="scipy" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label"><a class="fn-backref" href="#footnote-reference-1">[1]</a></td><td><a class="reference external" href="https://docs.scipy.org/doc/scipy-1.16.1/reference/generated/scipy.interpolate.interp1d.html">https://docs.scipy.org/doc/scipy-1.16.1/reference/generated/scipy.interpolate.interp1d.html</a></td></tr>
</tbody>
</table>
</div>
<div class="section" id="parameters">
<h3>Parameters</h3>
<dl class="docutils">
<dt>points <span class="classifier-delimiter">:</span> <span class="classifier">array_like of shape (n,)</span></dt>
<dd>1-D array of monotonically increasing data point coordinates where n
is the number of points. These represent the independent variable values
at which the dependent values are known.</dd>
<dt>values <span class="classifier-delimiter">:</span> <span class="classifier">array_like of shape (n,) or (n, m)</span></dt>
<dd>1-D or 2-D array of data values at the corresponding points. If 1-D,
represents scalar values at each point. If 2-D with shape (n, m),
each column represents a different output dimension, allowing the
lookup table to return m-dimensional vectors.</dd>
<dt>fill_value <span class="classifier-delimiter">:</span> <span class="classifier">float or str, optional</span></dt>
<dd>The value to use for points outside the interpolation range. If &quot;extrapolate&quot;,
the interpolator will use linear extrapolation. Default is &quot;extrapolate&quot;.
See <a class="reference external" href="https://docs.scipy.org/doc/scipy-1.16.1/reference/generated/scipy.interpolate.interp1d.html">https://docs.scipy.org/doc/scipy-1.16.1/reference/generated/scipy.interpolate.interp1d.html</a> for more details</dd>
</dl>
</div>
<div class="section" id="attributes">
<h3>Attributes</h3>
<dl class="docutils">
<dt>points <span class="classifier-delimiter">:</span> <span class="classifier">ndarray</span></dt>
<dd>Flattened array of input point coordinates, stored as 1-D array.</dd>
<dt>values <span class="classifier-delimiter">:</span> <span class="classifier">ndarray</span></dt>
<dd>Stored array of output values at each point, preserving original shape.</dd>
<dt>inter <span class="classifier-delimiter">:</span> <span class="classifier">scipy.interpolate.interp1d</span></dt>
<dd>The scipy 1D interpolator object used for linear interpolation with
extrapolation enabled beyond the data range.</dd>
</dl>
</div>
`,params:{points:{type:"any",default:null,description:"1-D array of monotonically increasing data point coordinates where n is the number of points. These represent the independent variable values at which the dependent values are known."},values:{type:"any",default:null,description:"1-D or 2-D array of data values at the corresponding points. If 1-D, represents scalar values at each point. If 2-D with shape (n, m), each column represents a different output dimension, allowing the lookup table to return m-dimensional vectors."},fill_value:{type:"string",default:'"extrapolate"',description:'The value to use for points outside the interpolation range. If "extrapolate", the interpolator will use linear extrapolation. Default is "extrapolate". See https://docs.scipy.org/doc/scipy-1.16.1/reference/generated/scipy.interpolate.interp1d.html for more details'}},inputs:null,outputs:null},SampleHold:{blockClass:"SampleHold",description:"Samples the inputs periodically and produces them at the output.",docstringHtml:`<p>Samples the inputs periodically and produces them at the output.</p>
<div class="section" id="parameters">
<h3>Parameters</h3>
<dl class="docutils">
<dt>T <span class="classifier-delimiter">:</span> <span class="classifier">float</span></dt>
<dd>sampling period</dd>
<dt>tau <span class="classifier-delimiter">:</span> <span class="classifier">float</span></dt>
<dd>delay</dd>
</dl>
</div>
<div class="section" id="attributes">
<h3>Attributes</h3>
<dl class="docutils">
<dt>events <span class="classifier-delimiter">:</span> <span class="classifier">list[Schedule]</span></dt>
<dd>internal scheduled event for periodic sampling</dd>
</dl>
</div>
`,params:{T:{type:"integer",default:"1",description:"sampling period"},tau:{type:"integer",default:"0",description:"delay Attributes ----------"}},inputs:null,outputs:null},FIR:{blockClass:"FIR",description:"Models a discrete-time Finite-Impulse-Response (FIR) filter.",docstringHtml:`<p>Models a discrete-time Finite-Impulse-Response (FIR) filter.</p>
<p>This block applies an FIR filter to an input signal sampled periodically.
The output at each sample time is a weighted sum of the current and a finite number
of past input samples. The operation is triggered by a scheduled event.</p>
<p>Functionality:</p>
<div class="math">
\\begin{equation*}
y[n] = b[0] x[n] + b[1] x[n-1] + \\dots + b[N] x[n-N]
\\end{equation*}
</div>
<p>where <cite>b</cite> are the filter coefficients and <cite>N</cite> is the filter order (number of
coefficients - 1).</p>
<ol class="arabic simple">
<li>Samples the input <cite>inputs[0]</cite> at intervals of <cite>T</cite>, starting after delay <cite>tau</cite>.</li>
<li>Stores the current and past <cite>len(coefficients) - 1</cite> input samples in an internal buffer.</li>
<li>Computes the filter output using the dot product of the coefficients
and the buffered input samples.</li>
<li>Outputs the result on <cite>outputs[0]</cite>.</li>
<li>Holds the output constant between updates.</li>
</ol>
<div class="section" id="parameters">
<h3>Parameters</h3>
<dl class="docutils">
<dt>coeffs <span class="classifier-delimiter">:</span> <span class="classifier">array_like</span></dt>
<dd>List or numpy array of FIR filter coefficients [b0, b1, ..., bN].
The number of coefficients determines the filter's order and memory.</dd>
<dt>T <span class="classifier-delimiter">:</span> <span class="classifier">float, optional</span></dt>
<dd>Sampling period (time between input samples and output updates). Default is 1.</dd>
<dt>tau <span class="classifier-delimiter">:</span> <span class="classifier">float, optional</span></dt>
<dd>Initial delay before the first sample is processed. Default is 0.</dd>
</dl>
</div>
<div class="section" id="input-ports">
<h3>Input Ports</h3>
<dl class="docutils">
<dt>inputs[0] <span class="classifier-delimiter">:</span> <span class="classifier">float</span></dt>
<dd>Input signal sample at the current time step.</dd>
</dl>
</div>
<div class="section" id="output-ports">
<h3>Output Ports</h3>
<dl class="docutils">
<dt>outputs[0] <span class="classifier-delimiter">:</span> <span class="classifier">float</span></dt>
<dd>Filtered output signal sample.</dd>
</dl>
</div>
<div class="section" id="attributes">
<h3>Attributes</h3>
<dl class="docutils">
<dt>buffer <span class="classifier-delimiter">:</span> <span class="classifier">deque</span></dt>
<dd>Internal buffer storing the most recent input samples.</dd>
<dt>events <span class="classifier-delimiter">:</span> <span class="classifier">list[Schedule]</span></dt>
<dd>Internal scheduled event triggering the filter calculation.</dd>
</dl>
</div>
`,params:{coeffs:{type:"array",default:"[1.0]",description:"List or numpy array of FIR filter coefficients [b0, b1, ..., bN]. The number of coefficients determines the filter's order and memory."},T:{type:"integer",default:"1",description:"Sampling period (time between input samples and output updates). Default is 1."},tau:{type:"integer",default:"0",description:"Initial delay before the first sample is processed. Default is 0."}},inputs:["in"],outputs:["out"]},ADC:{blockClass:"ADC",description:"Models an ideal Analog-to-Digital Converter (ADC).",docstringHtml:`<p>Models an ideal Analog-to-Digital Converter (ADC).</p>
<p>This block samples an analog input signal periodically, quantizes it
according to the specified number of bits and input span, and outputs
the resulting digital code on multiple output ports. The sampling
is triggered by a scheduled event.</p>
<p>Functionality:</p>
<ol class="arabic simple">
<li>Samples the analog input <cite>inputs[0]</cite> at intervals of <cite>T</cite>, starting after delay <cite>tau</cite>.</li>
<li>Clips the input voltage to the defined <cite>span</cite> [min_voltage, max_voltage].</li>
<li>Scales the clipped voltage to the range [0, 1].</li>
<li>Quantizes the scaled value to an integer code between 0 and 2^n_bits - 1 using flooring.</li>
<li>Converts the integer code to an n_bits binary representation.</li>
<li>Outputs the binary code on ports 0 (LSB) to n_bits-1 (MSB).</li>
</ol>
<p>Ideal characteristics:</p>
<ul class="simple">
<li>Instantaneous sampling at scheduled times.</li>
<li>Perfect, noise-free quantization.</li>
<li>No aperture jitter or other dynamic errors.</li>
</ul>
<div class="section" id="parameters">
<h3>Parameters</h3>
<dl class="docutils">
<dt>n_bits <span class="classifier-delimiter">:</span> <span class="classifier">int, optional</span></dt>
<dd>Number of bits for the digital output code. Default is 4.</dd>
<dt>span <span class="classifier-delimiter">:</span> <span class="classifier">list[float] or tuple[float], optional</span></dt>
<dd>The valid analog input value range [min_voltage, max_voltage].
Inputs outside this range will be clipped. Default is [-1, 1].</dd>
<dt>T <span class="classifier-delimiter">:</span> <span class="classifier">float, optional</span></dt>
<dd>Sampling period (time between samples). Default is 1 time unit.</dd>
<dt>tau <span class="classifier-delimiter">:</span> <span class="classifier">float, optional</span></dt>
<dd>Initial delay before the first sample is taken. Default is 0.</dd>
</dl>
</div>
<div class="section" id="attributes">
<h3>Attributes</h3>
<dl class="docutils">
<dt>events <span class="classifier-delimiter">:</span> <span class="classifier">list[Schedule]</span></dt>
<dd>Internal scheduled event responsible for periodic sampling and conversion.</dd>
</dl>
</div>
`,params:{n_bits:{type:"integer",default:"4",description:"Number of bits for the digital output code. Default is 4."},span:{type:"array",default:"[-1, 1]",description:"The valid analog input value range [min_voltage, max_voltage]. Inputs outside this range will be clipped. Default is [-1, 1]."},T:{type:"integer",default:"1",description:"Sampling period (time between samples). Default is 1 time unit."},tau:{type:"integer",default:"0",description:"Initial delay before the first sample is taken. Default is 0."}},inputs:["in"],outputs:null},DAC:{blockClass:"DAC",description:"Models an ideal Digital-to-Analog Converter (DAC).",docstringHtml:`<p>Models an ideal Digital-to-Analog Converter (DAC).</p>
<p>This block reads a digital input code periodically from its input ports,
reconstructs the corresponding analog value based on the number of bits
and output span, and holds the output constant between updates. The update
is triggered by a scheduled event.</p>
<p>Functionality:</p>
<ol class="arabic simple">
<li>Reads the digital code from input ports 0 (LSB) to n_bits-1 (MSB) at intervals of <cite>T</cite>, starting after delay <cite>tau</cite>.</li>
<li>Interprets the inputs as an unsigned binary integer code.</li>
<li>Converts the integer code to a fractional value between 0 and (2^n_bits - 1) / 2^n_bits.</li>
<li>Scales this fractional value to the specified analog output <cite>span</cite>.</li>
<li>Outputs the resulting analog value on <cite>outputs[0]</cite>.</li>
<li>Holds the output value constant until the next scheduled update.</li>
</ol>
<p>Ideal characteristics:</p>
<ul class="simple">
<li>Instantaneous update at scheduled times.</li>
<li>Perfect, noise-free reconstruction.</li>
<li>No glitches or settling time.</li>
</ul>
<div class="section" id="parameters">
<h3>Parameters</h3>
<dl class="docutils">
<dt>n_bits <span class="classifier-delimiter">:</span> <span class="classifier">int, optional</span></dt>
<dd>Number of digital input bits expected. Default is 4.</dd>
<dt>span <span class="classifier-delimiter">:</span> <span class="classifier">list[float] or tuple[float], optional</span></dt>
<dd>The analog output value range [min_voltage, max_voltage] corresponding
to the digital codes 0 and 2^n_bits - 1, respectively (approximately).
Default is [-1, 1].</dd>
<dt>T <span class="classifier-delimiter">:</span> <span class="classifier">float, optional</span></dt>
<dd>Update period (time between output updates). Default is 1 time unit.</dd>
<dt>tau <span class="classifier-delimiter">:</span> <span class="classifier">float, optional</span></dt>
<dd>Initial delay before the first output update. Default is 0.</dd>
</dl>
</div>
<div class="section" id="attributes">
<h3>Attributes</h3>
<dl class="docutils">
<dt>events <span class="classifier-delimiter">:</span> <span class="classifier">list[Schedule]</span></dt>
<dd>Internal scheduled event responsible for periodic updates.</dd>
</dl>
</div>
`,params:{n_bits:{type:"integer",default:"4",description:"Number of digital input bits expected. Default is 4."},span:{type:"array",default:"[-1, 1]",description:"The analog output value range [min_voltage, max_voltage] corresponding to the digital codes 0 and 2^n_bits - 1, respectively (approximately). Default is [-1, 1]."},T:{type:"integer",default:"1",description:"Update period (time between output updates). Default is 1 time unit."},tau:{type:"integer",default:"0",description:"Initial delay before the first output update. Default is 0."}},inputs:null,outputs:["out"]},Counter:{blockClass:"Counter",description:"Counts the number of detected bidirectional threshold crossings.",docstringHtml:`<p>Counts the number of detected bidirectional threshold crossings.</p>
<p>Uses zero-crossing events for the detection and sets the output
accordingly.</p>
<div class="section" id="parameters">
<h3>Parameters</h3>
<dl class="docutils">
<dt>start <span class="classifier-delimiter">:</span> <span class="classifier">int</span></dt>
<dd>counter start (initial condition)</dd>
<dt>threshold <span class="classifier-delimiter">:</span> <span class="classifier">float</span></dt>
<dd>threshold for zero crossing</dd>
</dl>
</div>
<div class="section" id="attributes">
<h3>Attributes</h3>
<dl class="docutils">
<dt>E <span class="classifier-delimiter">:</span> <span class="classifier">ZeroCrossing</span></dt>
<dd>internal event manager</dd>
<dt>events <span class="classifier-delimiter">:</span> <span class="classifier">list[ZeroCrossing]</span></dt>
<dd>internal zero crossing event</dd>
</dl>
</div>
`,params:{start:{type:"integer",default:"0",description:"counter start (initial condition)"},threshold:{type:"number",default:"0.0",description:"threshold for zero crossing Attributes ----------"}},inputs:["in"],outputs:["out"]},CounterUp:{blockClass:"CounterUp",description:"Counts the number of detected unidirectional (lo->hi) threshold crossings.",docstringHtml:`<p>Counts the number of detected unidirectional (lo-&gt;hi) threshold crossings.</p>
<div class="section" id="note">
<h3>Note</h3>
<p>This is a modification of 'Counter' which only counts
unidirectional zero-crossings (low -&gt; high)</p>
</div>
<div class="section" id="parameters">
<h3>Parameters</h3>
<dl class="docutils">
<dt>start <span class="classifier-delimiter">:</span> <span class="classifier">int</span></dt>
<dd>counter start (initial condition)</dd>
<dt>threshold <span class="classifier-delimiter">:</span> <span class="classifier">float</span></dt>
<dd>threshold for zero crossing</dd>
</dl>
</div>
<div class="section" id="attributes">
<h3>Attributes</h3>
<dl class="docutils">
<dt>E <span class="classifier-delimiter">:</span> <span class="classifier">ZeroCrossingUp</span></dt>
<dd>internal event manager</dd>
<dt>events <span class="classifier-delimiter">:</span> <span class="classifier">list[ZeroCrossing]</span></dt>
<dd>internal zero crossing event</dd>
</dl>
</div>
`,params:{start:{type:"integer",default:"0",description:"counter start (initial condition)"},threshold:{type:"number",default:"0.0",description:"threshold for zero crossing Attributes ----------"}},inputs:["in"],outputs:["out"]},CounterDown:{blockClass:"CounterDown",description:"Counts the number of detected unidirectional (hi->lo) threshold crossings.",docstringHtml:`<p>Counts the number of detected unidirectional (hi-&gt;lo) threshold crossings.</p>
<div class="section" id="note">
<h3>Note</h3>
<p>This is a modification of 'Counter' which only counts
unidirectional zero-crossings (high -&gt; low)</p>
</div>
<div class="section" id="parameters">
<h3>Parameters</h3>
<dl class="docutils">
<dt>start <span class="classifier-delimiter">:</span> <span class="classifier">int</span></dt>
<dd>counter start (initial condition)</dd>
<dt>threshold <span class="classifier-delimiter">:</span> <span class="classifier">float</span></dt>
<dd>threshold for zero crossing</dd>
</dl>
</div>
<div class="section" id="attributes">
<h3>Attributes</h3>
<dl class="docutils">
<dt>E <span class="classifier-delimiter">:</span> <span class="classifier">ZeroCrossingDown</span></dt>
<dd>internal event manager</dd>
<dt>events <span class="classifier-delimiter">:</span> <span class="classifier">list[ZeroCrossing]</span></dt>
<dd>internal zero crossing event</dd>
</dl>
</div>
`,params:{start:{type:"integer",default:"0",description:"counter start (initial condition)"},threshold:{type:"number",default:"0.0",description:"threshold for zero crossing Attributes ----------"}},inputs:["in"],outputs:["out"]},Relay:{blockClass:"Relay",description:"Relay block with hysteresis (Schmitt trigger).",docstringHtml:`<p>Relay block with hysteresis (Schmitt trigger).</p>
<p>Switches output between two values based on input crossing upper and lower
thresholds. The hysteresis prevents rapid switching when input is noisy.</p>
<p>When input rises above <cite>threshold_up</cite>, output switches to <cite>value_up</cite>.
When input falls below <cite>threshold_down</cite>, output switches to <cite>value_down</cite>.</p>
<div class="section" id="examples">
<h3>Examples</h3>
<p>Basic thermostat that turns heater on below 19Â°C, off above 21Â°C:</p>
<pre class="code python literal-block">
from pathsim.blocks import Relay

thermostat = Relay(
    threshold_up=21.0,
    threshold_down=19.0,
    value_up=0.0,
    value_down=1.0
    )
</pre>
</div>
<div class="section" id="parameters">
<h3>Parameters</h3>
<dl class="docutils">
<dt>threshold_up <span class="classifier-delimiter">:</span> <span class="classifier">float</span></dt>
<dd>threshold for transitioning to upper relay state <cite>value_up</cite> (default: 1.0)</dd>
<dt>threshold_down <span class="classifier-delimiter">:</span> <span class="classifier">float</span></dt>
<dd>threshold for transitioning to lower relay state <cite>value_down</cite> (default: 0.0)</dd>
<dt>value_up <span class="classifier-delimiter">:</span> <span class="classifier">float</span></dt>
<dd>value for upper relay state (default: 1.0)</dd>
<dt>value_down <span class="classifier-delimiter">:</span> <span class="classifier">float</span></dt>
<dd>value for lower relay state (default: 0.0)</dd>
</dl>
</div>
<div class="section" id="attributes">
<h3>Attributes</h3>
<dl class="docutils">
<dt>events <span class="classifier-delimiter">:</span> <span class="classifier">list[ZeroCrossingUp, ZeroCrossingDown]</span></dt>
<dd>internal zero crossing events for relay state transitions</dd>
</dl>
</div>
`,params:{threshold_up:{type:"number",default:"1.0",description:"threshold for transitioning to upper relay state `value_up` (default: 1.0)"},threshold_down:{type:"number",default:"0.0",description:"threshold for transitioning to lower relay state `value_down` (default: 0.0)"},value_up:{type:"number",default:"1.0",description:"value for upper relay state (default: 1.0)"},value_down:{type:"number",default:"0.0",description:"value for lower relay state (default: 0.0)"}},inputs:["in"],outputs:["out"]},Scope:{blockClass:"Scope",description:"Block for recording time domain data with variable sampling period.",docstringHtml:`<p>Block for recording time domain data with variable sampling period.</p>
<p>A time threshold can be set by <cite>t_wait</cite> to start recording data after the simulation
time is larger then the specified waiting time, i.e. <cite>t - t_wait &gt; 0</cite>.
This is useful for recording data only after all the transients have settled.</p>
<p>The block uses an internal <cite>Schedule</cite> event, when <cite>sampling_period</cite> is provided,
otherwise it just samples at every simulation timestep.</p>
<div class="section" id="parameters">
<h3>Parameters</h3>
<dl class="docutils">
<dt>sampling_period <span class="classifier-delimiter">:</span> <span class="classifier">float, None</span></dt>
<dd>time between samples, default is every timestep</dd>
<dt>t_wait <span class="classifier-delimiter">:</span> <span class="classifier">float</span></dt>
<dd>wait time before starting recording, optional</dd>
<dt>labels <span class="classifier-delimiter">:</span> <span class="classifier">list[str]</span></dt>
<dd>labels for the scope traces, and for the csv, optional</dd>
</dl>
</div>
<div class="section" id="attributes">
<h3>Attributes</h3>
<dl class="docutils">
<dt>recording_time <span class="classifier-delimiter">:</span> <span class="classifier">list[float]</span></dt>
<dd>recorded time points</dd>
<dt>recording_data <span class="classifier-delimiter">:</span> <span class="classifier">list[float]</span></dt>
<dd>recorded data points</dd>
<dt>_incremental_idx <span class="classifier-delimiter">:</span> <span class="classifier">int</span></dt>
<dd>index for incremental reading of accumulated data since last
call of incremental read</dd>
<dt>_sample_next_timestep <span class="classifier-delimiter">:</span> <span class="classifier">bool</span></dt>
<dd>flag to indicate this is a timestep to sample, only used for
event based sampling when <cite>sampling_period</cite> is provided as an arg</dd>
<dt>events <span class="classifier-delimiter">:</span> <span class="classifier">list[Schedule]</span></dt>
<dd>internal scheduled event for periodic input sampling when
<cite>sampling_period</cite> is provided</dd>
</dl>
</div>
`,params:{sampling_period:{type:"any",default:null,description:"time between samples, default is every timestep"},t_wait:{type:"number",default:"0.0",description:"wait time before starting recording, optional"},labels:{type:"any",default:null,description:"labels for the scope traces, and for the csv, optional"}},inputs:null,outputs:[]},Spectrum:{blockClass:"Spectrum",description:"Block for fourier spectrum analysis (spectrum analyzer).",docstringHtml:`<p>Block for fourier spectrum analysis (spectrum analyzer).</p>
<p>Computes continuous time running fourier transform (RFT) of the incoming signal.</p>
<p>A time threshold can be set by 't_wait' to start recording data only after the
simulation time is larger then the specified waiting time, i.e. 't - t_wait &gt; dt'.
This is useful for recording the steady state after all the transients have settled.</p>
<p>An exponential forgetting factor 'alpha' can be specified for realtime spectral
analysis. It biases the spectral components exponentially to the most recent signal
values by applying a single sided exponential window like this:</p>
<div class="math">
\\begin{equation*}
\\int_0^t u(\\tau) \\exp(\\alpha (t-\\tau))  \\exp(-j \\omega \\tau)\\ d \\tau
\\end{equation*}
</div>
<p>It is also known as the 'exponentially forgetting transform' (EFT) and a form of
short time fourier transform (STFT). It is implemented as a 1st order statespace model</p>
<div class="math">
\\begin{equation*}
\\dot{x} = - \\alpha  x +  \\exp(-j \\omega t) u
\\end{equation*}
</div>
<p>where 'u' is the input signal and 'x' is the state variable that represents the
complex fourier coefficient to the frequency 'omega'. The ODE is integrated using the
numerical integration engine of the block.</p>
<div class="section" id="example">
<h3>Example</h3>
<p>This is how to initialize it:</p>
<pre class="code python literal-block">
import numpy as np

#linear frequencies (0Hz, DC -&gt; 1kHz)
sp1 = Spectrum(
    freq=np.linspace(0, 1e3, 100),
    labels=['x1', 'x2'] #labels for two inputs
    )

#log frequencies (1Hz -&gt; 1kHz)
sp2 = Spectrum(
    freq=np.logspace(0, 3, 100)
    )

#log frequencies including DC (0Hz, DC + 1Hz -&gt; 1kHz)
sp3 = Spectrum(
    freq=np.hstack([0.0, np.logspace(0, 3, 100)])
    )

#arbitrary frequencies
sp4 = Spectrum(
    freq=np.array([0, 0.5, 20, 1e3])
    )
</pre>
</div>
<div class="section" id="note">
<h3>Note</h3>
<p>This block is relatively slow! But it is valuable for long running simulations
with few evaluation frequencies, where just FFT'ing the time series data
wouldnt be efficient OR if only the evaluation at weirdly spaced frequencies
is required. Otherwise its more efficient to just do an FFT on the time
series recording after the simulation has finished.</p>
</div>
<div class="section" id="parameters">
<h3>Parameters</h3>
<dl class="docutils">
<dt>freq <span class="classifier-delimiter">:</span> <span class="classifier">array[float]</span></dt>
<dd>list of evaluation frequencies for RFT, can be arbitrarily spaced</dd>
<dt>t_wait <span class="classifier-delimiter">:</span> <span class="classifier">float</span></dt>
<dd>wait time before starting RFT</dd>
<dt>alpha <span class="classifier-delimiter">:</span> <span class="classifier">float</span></dt>
<dd>exponential forgetting factor for realtime spectrum</dd>
<dt>labels <span class="classifier-delimiter">:</span> <span class="classifier">list[str]</span></dt>
<dd>labels for the inputs</dd>
</dl>
</div>
`,params:{freq:{type:"array",default:"[]",description:"list of evaluation frequencies for RFT, can be arbitrarily spaced"},t_wait:{type:"number",default:"0.0",description:"wait time before starting RFT"},alpha:{type:"number",default:"0.0",description:"exponential forgetting factor for realtime spectrum"},labels:{type:"array",default:"[]",description:"labels for the inputs"}},inputs:null,outputs:[]},Subsystem:{blockClass:"Subsystem",description:"Subsystem class that holds its own blocks and connecions and",docstringHtml:`<p>Subsystem class that holds its own blocks and connecions and
can natively interface with the main simulation loop.</p>
<p>IO interface is realized by a special 'Interface' block, that has extra
methods for setting and getting inputs and outputs and serves
as the interface of the internal blocks to the outside.</p>
<p>The subsystem doesnt use its 'inputs' and 'outputs' dicts directly.
It exclusively handles data transfer via the 'Interface' block.</p>
<p>This class can be used just like any other block during the simulation,
since it implements the required methods 'update' for the fixed-point
iteration (resolving algebraic loops with instant time blocks),
the 'step' method that performs timestepping (especially for dynamic
blocks with internal states) and the 'solve' method for solving the
implicit update equation for implicit solvers.</p>
<div class="section" id="example">
<h3>Example</h3>
<p>This is how we can wrap up multiple blocks within a subsystem.
In this case vanderpol system built from discrete components
instead of using an ODE block (in practice you should use
a monolithic ODE whenever possible due to performance).</p>
<pre class="code python literal-block">
from pathsim import Subsystem, Interface, Connection
from pathsim.blocks import Integrator, Function

#van der Pol parameter
mu = 1000

#blocks in the subsystem
If = Interface() # this is the interface to the outside
I1 = Integrator(2)
I2 = Integrator(0)
Fn = Function(lambda x1, x2: mu*(1 - x1**2)*x2 - x1)

sub_blocks = [If, I1, I2, Fn]

#connections in the subsystem
sub_connections = [
    Connection(I2, I1, Fn[1], If[1]),
    Connection(I1, Fn, If),
    Connection(Fn, I2)
    ]

#the subsystem acts just like a normal block
vdp = Subsystem(sub_blocks, sub_connections)
</pre>
</div>
<div class="section" id="parameters">
<h3>Parameters</h3>
<dl class="docutils">
<dt>blocks <span class="classifier-delimiter">:</span> <span class="classifier">list[Block] | None</span></dt>
<dd>internal blocks of the subsystem</dd>
<dt>connections <span class="classifier-delimiter">:</span> <span class="classifier">list[Connection] | None</span></dt>
<dd>internal connections of the subsystem</dd>
</dl>
<p>events : list[Event] | None
tolerance_fpi : float</p>
<blockquote>
absolute tolerance for convergence of algebraic loops
default see Â´SIM_TOLERANCE_FPIÂ´ in Â´_constants.pyÂ´</blockquote>
<dl class="docutils">
<dt>iterations_max <span class="classifier-delimiter">:</span> <span class="classifier">int</span></dt>
<dd>maximum allowed number of iterations for algebraic loop
solver, default see Â´SIM_ITERATIONS_MAXÂ´ in Â´_constants.pyÂ´</dd>
</dl>
</div>
<div class="section" id="attributes">
<h3>Attributes</h3>
<dl class="docutils">
<dt>interface <span class="classifier-delimiter">:</span> <span class="classifier">Interface</span></dt>
<dd>internal interface block for data transfer to the outside</dd>
<dt>graph <span class="classifier-delimiter">:</span> <span class="classifier">Graph</span></dt>
<dd>internal graph representation for fast system funcion
evluations using DAG with algebraic depths</dd>
<dt>boosters <span class="classifier-delimiter">:</span> <span class="classifier">None | list[ConnectionBooster]</span></dt>
<dd>list of boosters (fixed point accelerators) that wrap
algebraic loop closing connections assembled from the
system graph</dd>
</dl>
</div>
`,params:{},inputs:[],outputs:[]},Interface:{blockClass:"Interface",description:"Bare-bone block that serves as a data interface for the 'Subsystem' class.",docstringHtml:`<p>Bare-bone block that serves as a data interface for the 'Subsystem' class.</p>
<p>It works like this:</p>
<ul class="simple">
<li>Internal blocks of the subsystem are connected to the inputs and outputs
of this Interface block via the internal connections.</li>
<li>It behaves like a normal block (inherits the main 'Block' class methods).</li>
<li>It implements some special methods to get and set the inputs and outputs
of the blocks, that are used to translate between the internal blocks of the
subsystem and the inputs and outputs of the subsystem.</li>
<li>Handles data transfer to and from the internal subsystem blocks
to and from the inputs and outputs of the subsystem.</li>
</ul>
`,params:{},inputs:[],outputs:[]},Process:{blockClass:"Process",description:"Simplified version of the `ResidenceTime` model block",docstringHtml:`<p>Simplified version of the <cite>ResidenceTime</cite> model block
with all inputs being summed equally and only the state
and the flux being returned to the output</p>
<p>This block implements an internal 1st order linear ode with
multiple inputs, outputs and no direct passthrough.</p>
<p>The internal ODE with inputs <span class="math">\\(u_i\\)</span> :</p>
<div class="math">
\\begin{equation*}
\\dot{x} = - x / \\tau + \\mathrm{src} + \\sum_i u_i
\\end{equation*}
</div>
<p>And the output equations for output <cite>i=0</cite> and <cite>i=1</cite>:</p>
<div class="math">
\\begin{equation*}
y_0 = x
\\end{equation*}
</div>
<div class="math">
\\begin{equation*}
y_1 = x / \\tau
\\end{equation*}
</div>
<div class="section" id="parameters">
<h3>Parameters</h3>
<dl class="docutils">
<dt>tau <span class="classifier-delimiter">:</span> <span class="classifier">float</span></dt>
<dd>residence time, inverse natural frequency (eigenvalue)</dd>
<dt>initial_value <span class="classifier-delimiter">:</span> <span class="classifier">float</span></dt>
<dd>initial value of state / initial quantity of process</dd>
<dt>source_term <span class="classifier-delimiter">:</span> <span class="classifier">float</span></dt>
<dd>constant source term / generation term of the process</dd>
</dl>
</div>
`,params:{tau:{type:"integer",default:"1",description:"residence time, inverse natural frequency (eigenvalue)"},initial_value:{type:"integer",default:"0",description:"initial value of state / initial quantity of process"},source_term:{type:"integer",default:"0",description:"constant source term / generation term of the process"}},inputs:null,outputs:["x","x/tau"]},Bubbler4:{blockClass:"Bubbler4",description:"Tritium bubbling system with sequential vial collection stages.",docstringHtml:`<p>Tritium bubbling system with sequential vial collection stages.</p>
<p>This block models a tritium collection system used in fusion reactor blanket
purge gas processing. The system bubbles tritium-containing gas through a series
of liquid-filled vials to capture and concentrate tritium for measurement and
inventory tracking.</p>
<div class="section" id="physical-description">
<h3>Physical Description</h3>
<p>The bubbler consists of two parallel processing chains:</p>
<p><strong>Soluble Chain (Vials 1-2):</strong>
Tritium already in soluble forms (HTO, HT) flows sequentially through
vials 1 and 2. Each vial has a collection efficiency <span class="math">\\(\\eta_{vial}\\)</span>,
representing the fraction of tritium that dissolves into the liquid phase
and is retained.</p>
<p><strong>Insoluble Chain (Vials 3-4):</strong>
Tritium in insoluble forms (Tâ, organically bound) first undergoes catalytic
conversion to soluble forms with efficiency <span class="math">\\(\\alpha_{conv}\\)</span>. The
converted tritium, along with uncaptured soluble tritium from the first chain,
then flows through vials 3 and 4 with the same collection efficiency.</p>
</div>
<div class="section" id="mathematical-formulation">
<h3>Mathematical Formulation</h3>
<p>The system is governed by the following differential equations for the
vial inventories <span class="math">\\(x_i\\)</span>:</p>
<div class="math">
\\begin{equation*}
\\frac{dx_1}{dt} &amp;= \\eta_{vial} \\cdot u_{sol}
\\end{equation*}
</div>
<div class="math">
\\begin{equation*}
\\frac{dx_2}{dt} &amp;= \\eta_{vial} \\cdot (1-\\eta_{vial}) \\cdot u_{sol}
\\end{equation*}
</div>
<div class="math">
\\begin{equation*}
\\frac{dx_3}{dt} &amp;= \\eta_{vial} \\cdot [\\alpha_{conv} \\cdot u_{insol} + (1-\\eta_{vial})^2 \\cdot u_{sol}]
\\end{equation*}
</div>
<div class="math">
\\begin{equation*}
\\frac{dx_4}{dt} &amp;= \\eta_{vial} \\cdot (1-\\eta_{vial}) \\cdot [\\alpha_{conv} \\cdot u_{insol} + (1-\\eta_{vial})^2 \\cdot u_{sol}]
\\end{equation*}
</div>
<p>The sample output represents uncaptured tritium exiting the system:</p>
<div class="math">
\\begin{equation*}
y_{sample} = (1-\\alpha_{conv}) \\cdot u_{insol} + (1-\\eta_{vial})^2 \\cdot [\\alpha_{conv} \\cdot u_{insol} + (1-\\eta_{vial})^2 \\cdot u_{sol}]
\\end{equation*}
</div>
<dl class="docutils">
<dt>Where:</dt>
<dd><ul class="first last simple">
<li><span class="math">\\(u_{sol}\\)</span> = soluble tritium input flow rate</li>
<li><span class="math">\\(u_{insol}\\)</span> = insoluble tritium input flow rate</li>
<li><span class="math">\\(\\eta_{vial}\\)</span> = vial collection efficiency</li>
<li><span class="math">\\(\\alpha_{conv}\\)</span> = conversion efficiency from insoluble to soluble</li>
<li><span class="math">\\(x_i\\)</span> = tritium inventory in vial i</li>
</ul>
</dd>
</dl>
</div>
<div class="section" id="parameters">
<h3>Parameters</h3>
<dl class="docutils">
<dt>conversion_efficiency <span class="classifier-delimiter">:</span> <span class="classifier">float</span></dt>
<dd>Conversion efficiency from insoluble to soluble forms (<span class="math">\\(\\alpha_{conv}\\)</span>),
between 0 and 1.</dd>
<dt>vial_efficiency <span class="classifier-delimiter">:</span> <span class="classifier">float</span></dt>
<dd>Collection efficiency of each vial (<span class="math">\\(\\eta_{vial}\\)</span>), between 0 and 1.</dd>
<dt>replacement_times <span class="classifier-delimiter">:</span> <span class="classifier">float | list[float] | list[list[float]]</span></dt>
<dd>Times at which each vial is replaced with a fresh one. If None, no
replacement events are created. If a single value is provided, it is
used for all vials. If a single list of floats is provided, it will be
used for all vials. If a list of lists is provided, each sublist
corresponds to the replacement times for each vial.</dd>
</dl>
</div>
<div class="section" id="notes">
<h3>Notes</h3>
<p>Vial replacement is modeled as instantaneous reset events that set the
corresponding vial inventory to zero, simulating the physical replacement
of a full vial with an empty one.</p>
</div>
`,params:{conversion_efficiency:{type:"number",default:"0.9",description:"Conversion efficiency from insoluble to soluble forms (:math:`\\alpha_{conv}`), between 0 and 1."},vial_efficiency:{type:"number",default:"0.9",description:"Collection efficiency of each vial (:math:`\\eta_{vial}`), between 0 and 1."},replacement_times:{type:"any",default:null,description:"Times at which each vial is replaced with a fresh one. If None, no replacement events are created. If a single value is provided, it is used for all vials. If a single list of floats is provided, it will be used for all vials. If a list of lists is provided, each sublist corresponds to the replacement times for each vial."}},inputs:["sample_in_soluble","sample_in_insoluble"],outputs:["vial1","vial2","vial3","vial4","sample_out"]},Splitter:{blockClass:"Splitter",description:"Splitter block that splits the input signal into multiple",docstringHtml:`<p>Splitter block that splits the input signal into multiple
outputs weighted with the specified fractions.</p>
<div class="section" id="note">
<h3>Note</h3>
<p>The output fractions must sum to one.</p>
</div>
<div class="section" id="parameters">
<h3>Parameters</h3>
<dl class="docutils">
<dt>fractions <span class="classifier-delimiter">:</span> <span class="classifier">np.ndarray | list</span></dt>
<dd>fractions to split the input signal into,
must sum up to one</dd>
</dl>
</div>
`,params:{fractions:{type:"any",default:null,description:"fractions to split the input signal into, must sum up to one"}},inputs:["in"],outputs:null},GLC:{blockClass:"GLC",description:"Gas Liquid Contactor model block.",docstringHtml:`<p>Gas Liquid Contactor model block. Inherits from Function block.</p>
<p>More details about the model can be found in: <a class="reference external" href="https://doi.org/10.13182/FST95-A30485">https://doi.org/10.13182/FST95-A30485</a></p>
<dl class="docutils">
<dt>Args:</dt>
<dd>P_in: Inlet operating pressure [Pa]
L: Column height [m]
D: Column diameter [m]
T: Temperature [K]
g: Gravitational acceleration [m/s^2], default is 9.81
initial_nb_of_elements: Initial number of elements for BVP solver
BCs: Boundary conditions type, &quot;C-C&quot; (Closed-Closed) or &quot;O-C&quot; (Open-Closed), default is &quot;C-C&quot;</dd>
</dl>
`,params:{P_in:{type:"any",default:null,description:"L: Column height [m]"},L:{type:"any",default:null,description:"D: Column diameter [m]"},D:{type:"any",default:null,description:"T: Temperature [K]"},T:{type:"any",default:null,description:"g: Gravitational acceleration [m/s^2], default is 9.81"},BCs:{type:"any",default:null,description:""},g:{type:"number",default:"9.80665",description:"initial_nb_of_elements: Initial number of elements for BVP solver"},initial_nb_of_elements:{type:"integer",default:"20",description:'BCs: Boundary conditions type, "C-C" (Closed-Closed) or "O-C" (Open-Closed), default is "C-C"'}},inputs:["c_T_in","flow_l","y_T2_inlet","flow_g"],outputs:["c_T_out","y_T2_out","eff","P_out","Q_l","Q_g_out","n_T_out_liquid","n_T_out_gas"]}},G5={Sources:["Constant","Source","SinusoidalSource","StepSource","PulseSource","TriangleWaveSource","SquareWaveSource","GaussianPulseSource","ChirpPhaseNoiseSource","ClockSource","WhiteNoise","PinkNoise","RandomNumberGenerator"],Dynamic:["Integrator","Differentiator","Delay","ODE","DynamicalSystem","StateSpace","PT1","PT2","LeadLag","PID","AntiWindupPID","RateLimiter","Backlash","Deadband","TransferFunctionNumDen","TransferFunctionZPG","ButterworthLowpassFilter","ButterworthHighpassFilter","ButterworthBandpassFilter","ButterworthBandstopFilter"],Algebraic:["Adder","Multiplier","Amplifier","Function","Sin","Cos","Tan","Tanh","Abs","Sqrt","Exp","Log","Log10","Mod","Clip","Pow","Switch","LUT","LUT1D"],Mixed:["SampleHold","FIR","ADC","DAC","Counter","CounterUp","CounterDown","Relay"],Recording:["Scope","Spectrum"],Chemical:["Process","Bubbler4","Splitter","GLC"]},qC={ADC:"pathsim.blocks",Abs:"pathsim.blocks",Adder:"pathsim.blocks",Amplifier:"pathsim.blocks",AntiWindupPID:"pathsim.blocks",Backlash:"pathsim.blocks",Bubbler4:"pathsim_chem.tritium",ButterworthBandpassFilter:"pathsim.blocks",ButterworthBandstopFilter:"pathsim.blocks",ButterworthHighpassFilter:"pathsim.blocks",ButterworthLowpassFilter:"pathsim.blocks",ChirpPhaseNoiseSource:"pathsim.blocks",Clip:"pathsim.blocks",ClockSource:"pathsim.blocks",Constant:"pathsim.blocks",Cos:"pathsim.blocks",Counter:"pathsim.blocks",CounterDown:"pathsim.blocks",CounterUp:"pathsim.blocks",DAC:"pathsim.blocks",Deadband:"pathsim.blocks",Delay:"pathsim.blocks",Differentiator:"pathsim.blocks",DynamicalSystem:"pathsim.blocks",Exp:"pathsim.blocks",FIR:"pathsim.blocks",Function:"pathsim.blocks",GLC:"pathsim_chem.tritium",GaussianPulseSource:"pathsim.blocks",Integrator:"pathsim.blocks",LUT:"pathsim.blocks",LUT1D:"pathsim.blocks",LeadLag:"pathsim.blocks",Log:"pathsim.blocks",Log10:"pathsim.blocks",Mod:"pathsim.blocks",Multiplier:"pathsim.blocks",ODE:"pathsim.blocks",PID:"pathsim.blocks",PT1:"pathsim.blocks",PT2:"pathsim.blocks",PinkNoise:"pathsim.blocks",Pow:"pathsim.blocks",Process:"pathsim_chem.tritium",PulseSource:"pathsim.blocks",RandomNumberGenerator:"pathsim.blocks",RateLimiter:"pathsim.blocks",Relay:"pathsim.blocks",SampleHold:"pathsim.blocks",Scope:"pathsim.blocks",Sin:"pathsim.blocks",SinusoidalSource:"pathsim.blocks",Source:"pathsim.blocks",Spectrum:"pathsim.blocks",Splitter:"pathsim_chem.tritium",Sqrt:"pathsim.blocks",SquareWaveSource:"pathsim.blocks",StateSpace:"pathsim.blocks",StepSource:"pathsim.blocks",Switch:"pathsim.blocks",Tan:"pathsim.blocks",Tanh:"pathsim.blocks",TransferFunctionNumDen:"pathsim.blocks",TransferFunctionZPG:"pathsim.blocks",TriangleWaveSource:"pathsim.blocks",WhiteNoise:"pathsim.blocks"};function jC(t){if(t==null||t==="None"||t==="")return null;let e=String(t).trim();return e.length===0||((e.startsWith("'")&&e.endsWith("'")||e.startsWith('"')&&e.endsWith('"'))&&(e=e.slice(1,-1)),e.length===0)?null:[...e]}const HC={Scope:{param:"labels",direction:"input"},Spectrum:{param:"labels",direction:"input"},Adder:{param:"operations",direction:"input",parser:jC}};function UC(t){const e=HC[t];return e?Array.isArray(e)?e:[e]:[]}const WC=new Set(["Integrator","Differentiator","Delay","Amplifier","Sin","Cos","Tan","Tanh","Abs","Sqrt","Exp","Log","Log10","Mod","Clip","Pow","SampleHold"]);class VC{nodes=new Map;byCategory=new Map;register(e){this.nodes.set(e.type,e);const n=this.byCategory.get(e.category)||[];n.push(e),this.byCategory.set(e.category,n)}get(e){return this.nodes.get(e)}getByCategory(e){return this.byCategory.get(e)||[]}getAllCategories(){return Array.from(this.byCategory.keys())}getAll(){return Array.from(this.nodes.values())}has(e){return this.nodes.has(e)}get size(){return this.nodes.size}}const Pi=new VC;function GC(t,e,n){const i={};for(const[c,u]of Object.entries(n.params))i[c]={type:u.type,default:u.default,description:u.description,min:u.min,max:u.max,options:u.options};let r,s;n.inputs===null?(r=void 0,s=null):n.inputs.length>0?(r=n.inputs,s=n.inputs.length):(r=[],s=0);let a,o;n.outputs===null?(a=void 0,o=null):n.outputs.length>0?(a=n.outputs,o=n.outputs.length):(a=[],o=0);const l=U1({name:t,category:e,blockClass:n.blockClass,description:n.description,inputs:r,outputs:a,maxInputs:s,maxOutputs:o,syncPorts:WC.has(t),params:i});n.docstringHtml&&(l.docstring=n.docstringHtml),Pi.register(l)}function XC(){for(const[t,e]of Object.entries(G5))for(const n of e){const i=qh[n];i?GC(n,t,i):console.warn(`Block "${n}" not found in extracted blocks`)}}XC();const Sg=U1({name:"Subsystem",category:"Subsystem",description:"",blockClass:"Subsystem",inputs:[],outputs:[],minInputs:0,minOutputs:0,maxInputs:null,maxOutputs:null,shape:"rect",params:{}}),kg=U1({name:"Interface",category:"Subsystem",description:"",blockClass:"Interface",inputs:[],outputs:[],minInputs:0,minOutputs:0,maxInputs:null,maxOutputs:null,shape:"rect",params:{}});function YC(){const t=qh.Subsystem,e=qh.Interface;t&&(Sg.description=t.description,Sg.docstring=t.docstringHtml),e&&(kg.description=e.description,kg.docstring=e.docstringHtml),Pi.register(Sg),Pi.register(kg)}YC();const X5=new Map;function Uu(t){X5.set(t.id,t)}function Yv(t){return X5.get(t)}Uu({id:"pill",name:"Pill",cssClass:"shape-pill",borderRadius:"20px",svgRadius:20});Uu({id:"rect",name:"Rectangle",cssClass:"shape-rect",borderRadius:"4px",svgRadius:4});Uu({id:"circle",name:"Circle",cssClass:"shape-circle",borderRadius:"16px",svgRadius:16});Uu({id:"diamond",name:"Diamond",cssClass:"shape-diamond",borderRadius:"4px",svgRadius:4});Uu({id:"mixed",name:"Mixed",cssClass:"shape-mixed",borderRadius:"12px 4px 12px 4px",svgRadius:[12,4,12,4]});Uu({id:"default",name:"Default",cssClass:"shape-default",borderRadius:"8px",svgRadius:8});const KC={Sources:"pill",Dynamic:"rect",Algebraic:"rect",Mixed:"mixed",Recording:"pill",Subsystem:"rect"};function ZC(t){return KC[t]||"default"}const _n={SUBSYSTEM:"Subsystem",INTERFACE:"Interface"};function Y5(t){if(t.shape){const i=Yv(t.shape);if(i)return i.cssClass}const e=ZC(t.category);return Yv(e)?.cssClass||"shape-default"}function Ia(t){return("type"in t,t.type)===_n.SUBSYSTEM}function qd(t){return("type"in t,t.type)===_n.INTERFACE}const ad=ln(null),W1={subscribe:ad.subscribe,open(t){ad.set(t)},close(){ad.set(null)},isOpen(){return Je(ad)!==null},getOpenId(){return Je(ad)}},ch=t=>W1.open(t),Ag=()=>W1.close();function sr(){return crypto.randomUUID()}const Ji=ln(new Map),$l=ln([]),Wu=ln(new Map),Bn=ln([]),Cr=ln(new Set);function JC(t){if(t.length===0)return null;let e=Je(Ji),n=null;for(let i=0;i<t.length;i++){const r=e.get(t[i]);if(!r||r.type!==_n.SUBSYSTEM)return null;n=r,i<t.length-1&&r.graph&&(e=new Map(r.graph.nodes.map(s=>[s.id,s])))}return n}function ar(){const t=Je(Bn);if(t.length===0)return{nodes:Je(Ji),connections:Je($l),annotations:Je(Wu),events:new Map};const e=JC(t);if(!e||!e.graph)return{nodes:new Map,connections:[],annotations:new Map,events:new Map};const n=e.graph.nodes.map(i=>i.type===_n.INTERFACE?{...i,name:e.name,color:e.color,outputs:e.inputs.map((r,s)=>({id:`${i.id}-output-${s}`,nodeId:i.id,name:`in ${s}`,direction:"output",index:s,color:r.color})),inputs:e.outputs.map((r,s)=>({id:`${i.id}-input-${s}`,nodeId:i.id,name:`out ${s}`,direction:"input",index:s,color:r.color}))}:i);return{nodes:new Map(n.map(i=>[i.id,i])),connections:e.graph.connections,annotations:new Map((e.graph.annotations||[]).map(i=>[i.id,i])),events:new Map((e.graph.events||[]).map(i=>[i.id,i]))}}function Rs(t,e){t.length!==0&&Ji.update(n=>{const i=new Map(n),r=(s,a)=>{if(a.length===0)return s;const[o,...l]=a,c=s.get(o);if(!c||c.type!==_n.SUBSYSTEM)return s;const u=new Map(s);if(l.length===0){const f=e(c.graph||{nodes:[],connections:[]});u.set(o,{...c,graph:f})}else{const f=new Map((c.graph?.nodes||[]).map(d=>[d.id,d])),p=r(f,l);u.set(o,{...c,graph:{nodes:Array.from(p.values()),connections:c.graph?.connections||[],annotations:c.graph?.annotations,events:c.graph?.events}})}return u};return r(i,t)})}function V1(t,e){const n=Je(Bn);n.length===0?Ji.update(t):Rs(n,i=>({...i,nodes:e(i.nodes)}))}function jc(t,e){V1(n=>{const i=n.get(t);if(i){const r=new Map(n);return r.set(t,e(i)),r}return n},n=>n.map(i=>i.id===t?e(i):i))}function QC(t){V1(e=>{const n=new Map(e);return n.set(t.id,t),n},e=>[...e,t])}function G1(t){const e=Je(Bn);e.length===0?$l.update(t):Rs(e,n=>({...n,connections:t(n.connections)}))}function gp(t,e,n){const i=Je(Bn);i.length===0?(Ji.update(t),$l.update(n)):Rs(i,r=>({...r,nodes:e(r.nodes),connections:n(r.connections)}))}function mp(t,e){const n=Je(Bn);n.length===0?Wu.update(t):Rs(n,i=>({...i,annotations:e(i.annotations||[])}))}function $C(){return Je(Bn).length===0}const X1=Ta([Ji,Bn],()=>ar().nodes),e8=Ta([Ji,$l,Bn],()=>ar().connections),t8=Ta([Ji,Wu,Bn],()=>ar().annotations),n8=Ta([Ji,Bn],()=>ar().events),i8=Ta(X1,t=>Array.from(t.values())),r8=Ta([X1,Cr],([t,e])=>Array.from(e).map(n=>t.get(n)).filter(n=>n!==void 0)),s8=Ta([Ji,Bn],([t,e])=>{const n=[{id:"",name:"Root"}];let i=t;for(const r of e){const s=i.get(r);s&&s.type===_n.SUBSYSTEM&&(n.push({id:r,name:s.name}),s.graph&&(i=new Map(s.graph.nodes.map(a=>[a.id,a]))))}return n}),Rr={DEFAULT:11,MIN:8,MAX:24,STEP:1};function a8(t){const e=sr(),n={id:e,position:t,content:"",width:200,height:100,fontSize:Rr.DEFAULT};return mp(i=>{const r=new Map(i);return r.set(e,n),r},i=>[...i,n]),e}function K5(t,e){mp(n=>{const i=n.get(t);if(i){const r=new Map(n);return r.set(t,{...i,...e}),r}return n},n=>n.map(i=>i.id===t?{...i,...e}:i))}function o8(t,e){K5(t,{position:e})}function l8(t){mp(e=>{const n=new Map(e);return n.delete(t),n},e=>e.filter(n=>n.id!==t))}function c8(t){return ar().annotations.get(t)}const uh=ln({top:100,right:20,bottom:20,left:70});function u8(t){uh.set(t)}const Z5=ln(0);function sl(){Z5.update(t=>t+1)}const J5=ln(0),Q5=ln(0);function d8(){J5.update(t=>t+1)}function f8(){Q5.update(t=>t+1)}const $5=ln({x:0,y:0,id:0});function h8(t){$5.update(e=>({...t,id:e.id+1}))}const ew=ln({nodeId:"",id:0});function p8(t){ew.update(e=>({nodeId:t,id:e.id+1}))}const tw=ln(0);function Ad(){tw.update(t=>t+1)}const nw=ln({x:0,y:0,id:0});function g8(t){nw.update(e=>({...t,id:e.id+1}))}const iw=ln({nodeIds:[],addToSelection:!1,id:0});function oo(t,e=!1){iw.update(n=>({nodeIds:t,addToSelection:e,id:n.id+1}))}const rw=ln({annotationId:"",id:0});function m8(t){rw.update(e=>({annotationId:t,id:e.id+1}))}const sw=ln({nodeId:"",position:{x:0,y:0},cursorScreen:null,id:0});function v8(t,e,n){sw.update(i=>({nodeId:t,position:e,cursorScreen:n??null,id:i.id+1}))}let qm=null,jm=null;function y8(t){qm=t}function uo(t){return qm?qm(t):t}function b8(t){jm=t}function Kv(){return jm?jm():!1}function w8(){const t=document.querySelector(".svelte-flow");if(!t)return{x:400,y:300};const e=t.getBoundingClientRect(),n={x:e.left+e.width/2,y:e.top+e.height/2};return uo(n)}function x8(t){Bn.update(e=>[...e,t]),Cr.set(new Set),setTimeout(()=>sl(),0)}function _8(){Bn.update(t=>t.slice(0,-1)),Cr.set(new Set),setTimeout(()=>sl(),0)}function S8(t){const e=Je(Bn).length;t!==e&&(Bn.update(n=>n.slice(0,t)),Cr.set(new Set),setTimeout(()=>sl(),0))}function k8(t){Bn.set(t),Cr.set(new Set),setTimeout(()=>sl(),0)}function A8(){return Je(Bn).length===0}function N8(){return Je(Bn)}function Zv(t,e,n){return n.map((i,r)=>({id:`${t}-${e}-${r}`,nodeId:t,name:i.name,direction:e,index:r,color:i.color||zd.default}))}function aw(t,e){for(const n of t)if(n.type===_n.SUBSYSTEM&&n.graph){if(n.graph.nodes.some(s=>s.id===e))return n;const r=aw(n.graph.nodes,e);if(r)return r}return null}function ow(t,e,n){const i=n??sr(),r={...t,id:i,position:{...e},inputs:t.inputs.map((s,a)=>({...s,id:`${i}-input-${a}`,nodeId:i})),outputs:t.outputs.map((s,a)=>({...s,id:`${i}-output-${a}`,nodeId:i}))};return r.graph&&(r.graph=Y1(r.graph)),r}function Y1(t){const e=new Map,n=t.nodes.map(a=>{const o=sr();e.set(a.id,o);const l={...a,id:o,inputs:a.inputs.map((c,u)=>({...c,id:`${o}-input-${u}`,nodeId:o})),outputs:a.outputs.map((c,u)=>({...c,id:`${o}-output-${u}`,nodeId:o}))};return l.graph&&(l.graph=Y1(l.graph)),l}),i=t.connections.map(a=>({...a,id:sr(),sourceNodeId:e.get(a.sourceNodeId)||a.sourceNodeId,targetNodeId:e.get(a.targetNodeId)||a.targetNodeId})),r=t.events?.map(a=>({...a,id:sr()})),s=t.annotations?.map(a=>({...a,id:sr()}));return{nodes:n,connections:i,events:r,annotations:s}}const Jv={input:t=>`in ${t}`,output:t=>`out ${t}`},C8=/-input-(\d+)$/,P8=/-output-(\d+)$/,Ou={input:(t,e)=>`${t}-input-${e}`,output:(t,e)=>`${t}-output-${e}`,parseIndex:(t,e)=>{const n=e==="input"?C8:P8,i=t.match(n);return i?parseInt(i[1],10):null},parseConnection:(t,e)=>({sourceIndex:Ou.parseIndex(t,"output"),targetIndex:Ou.parseIndex(e,"input")})};function lw(t,e,n={}){const{multiLine:i=!1,indent:r="    ",skipInternal:s=!1}=n,a=[];for(const[o,l]of Object.entries(t))l==null||l===""||s&&o.startsWith("_")||e.has(o)&&a.push(`${o}=${l}`);return i&&a.length>0?`
`+a.map(o=>r+o).join(`,
`)+`
`:a.join(", ")}function K1(t,e,n="conn"){const i=[],r=[],s=new Map;let a=0;for(const o of t){const l=e.get(o.sourceNodeId),c=e.get(o.targetNodeId);if(!l||!c)continue;const u=`${n}_${a}`;i.push(`${u} = Connection(${l}[${o.sourcePortIndex}], ${c}[${o.targetPortIndex}])`),r.push(u),s.set(o.id,u),a++}return{lines:i,varNames:r,connVars:s}}function bu(t,e,n="    "){const i=[];i.push(`${t} = [`);for(const r of e)i.push(`${n}${r},`);return i.push("]"),i}function La(t){if(!t)return"";let e="";for(const n of t)/[a-zA-Z0-9_]/.test(n)?e+=n:n===" "&&(e+="_");return e&&/^[0-9]/.test(e)&&(e="n_"+e),e.toLowerCase()}let cl=new Map,jh=new Map,Z1=0;const ul=[],Gl=new Map,Fu=new Map,cw=ln(0);function fl(){cw.set(ul.length+Gl.size+Fu.size)}function vp(){return cl.size>0}function E8(t,e){cl=new Map(t),jh=new Map(e),Z1=0,ul.length=0,Gl.clear(),Fu.clear(),fl()}function I8(){ul.length=0,Gl.clear(),Fu.clear(),fl()}function uw(){const t=[];for(const e of Fu.values())t.push(Ng(e));for(const e of ul)t.push(Ng(e));for(const e of Gl.values())t.push(Ng(e));return ul.length=0,Gl.clear(),Fu.clear(),fl(),t.length===0?null:t.join(`
`)}function J1(t){if(!vp()||Ia(t))return;const e=Pi.get(t.type);if(!e)return;const n=new Set(cl.values());let i=La(t.name);(!i||n.has(i))&&(i=`block_dyn_${Z1++}`),cl.set(t.id,i);const r=new Set(e.params.map(l=>l.name)),s=[];for(const[l,c]of Object.entries(t.params))c==null||c===""||l.startsWith("_")||r.has(l)&&s.push(`${l}=${c}`);const a=s.join(", "),o=a?`${e.blockClass}(${a})`:`${e.blockClass}()`;ul.push([`${i} = ${o}`,`sim.add_block(${i})`,`blocks.append(${i})`,`_node_id_map[id(${i})] = "${t.id}"`,`_node_name_map["${t.id}"] = "${t.name.replace(/"/g,'\\"')}"`].join(`
`)),fl()}function L8(t){const e=cl.get(t);if(e){ul.push([`sim.remove_block(${e})`,`blocks.remove(${e})`,`_node_id_map.pop(id(${e}), None)`,`_node_name_map.pop("${t}", None)`].join(`
`)),cl.delete(t);for(const n of Gl.keys())n.startsWith(t+":")&&Gl.delete(n);fl()}}function Q1(t){if(!vp())return;const e=cl.get(t.sourceNodeId),n=cl.get(t.targetNodeId);if(!e||!n)return;const i=`conn_dyn_${Z1++}`;jh.set(t.id,i),ul.push([`${i} = Connection(${e}[${t.sourcePortIndex}], ${n}[${t.targetPortIndex}])`,`sim.add_connection(${i})`,`connections.append(${i})`].join(`
`)),fl()}function $1(t){const e=jh.get(t);e&&(ul.push([`sim.remove_connection(${e})`,`connections.remove(${e})`].join(`
`)),jh.delete(t),fl())}function M8(t,e,n){const i=cl.get(t);i&&(Gl.set(`${t}:${e}`,`${i}.${e} = ${n}`),fl())}function dw(t,e){vp()&&(Fu.set(t,e),fl())}function Ng(t){return`try:
${t.split(`
`).map(n=>`    ${n}`).join(`
`)}
except Exception as _e:
    print(f"Mutation error: {_e}", file=__import__('sys').stderr)`}function e0(t){return{portsKey:t==="input"?"inputs":"outputs",oppositeKey:t==="input"?"outputs":"inputs",minKey:t==="input"?"minInputs":"minOutputs",maxKey:t==="input"?"maxInputs":"maxOutputs",connectionKey:t==="input"?"targetNodeId":"sourceNodeId",connectionIndexKey:t==="input"?"targetPortIndex":"sourcePortIndex",defaultName:t==="input"?"in":"out"}}function fw(t,e,n){const i=r=>{const s=r.get(e);if(!s)return r;const a=new Map(r);return a.set(e,n(s)),a};t.length===0?Ji.update(i):Rs(t,r=>({...r,nodes:Array.from(i(new Map(r.nodes.map(s=>[s.id,s]))).values())}))}function t0(t,e,n=!1){const r=ar().nodes.get(t);if(!r)return!1;const s=e0(e),a=Je(Bn);if(r.type===_n.INTERFACE&&a.length>0){const d=a[a.length-1],y=a.slice(0,-1),m=s.oppositeKey,w=e==="input"?"output":"input";return fw(y,d,b=>{const S=b[m],A=S.length;return{...b,[m]:[...S,{id:Ou[w](d,A),nodeId:d,name:Jv[w](A),direction:w,index:A,color:zd.default}]}}),!0}const o=Pi.get(r.type),l=o?.ports[s.maxKey],c=r[s.portsKey];if(l!=null&&c.length>=l)return!1;const u=c.length,f=o?.ports[s.portsKey]?.[u],p={id:Ou[e](t,u),nodeId:t,name:f?.name||Jv[e](u),direction:e,index:u,color:f?.color||zd.default};return jc(t,d=>({...d,[s.portsKey]:[...d[s.portsKey],p]})),!n&&e==="input"&&o?.ports.syncPorts&&t0(t,"output",!0),!0}function n0(t,e,n=!1){const r=ar().nodes.get(t);if(!r)return!1;const s=e0(e),a=Pi.get(r.type),o=a?.ports[s.minKey]??1,l=r[s.portsKey];if(l.length<=o)return!1;const c=Je(Bn);if(r.type===_n.INTERFACE&&c.length>0){const p=c[c.length-1],d=c.slice(0,-1),y=s.oppositeKey;fw(d,p,m=>{const w=m[y];return w.length===0?m:{...m,[y]:w.slice(0,-1)}})}const u=l.length-1,f=ar();for(const p of f.connections)(s.connectionKey==="targetNodeId"?p.targetNodeId===t&&p.targetPortIndex>=u:p.sourceNodeId===t&&p.sourcePortIndex>=u)&&$1(p.id);return gp(p=>{const d=p.get(t);if(!d)return p;const y=new Map(p);return y.set(t,{...d,[s.portsKey]:d[s.portsKey].slice(0,-1)}),y},p=>p.map(d=>d.id===t?{...d,[s.portsKey]:d[s.portsKey].slice(0,-1)}:d),p=>p.filter(d=>{const y=d[s.connectionKey],m=d[s.connectionIndexKey];return!(y===t&&m>=u)})),!n&&e==="input"&&a?.ports.syncPorts&&n0(t,"output",!0),!0}function T8(t){return t0(t,"input")}function D8(t){return t0(t,"output")}function O8(t){return n0(t,"input")}function F8(t){return n0(t,"output")}function R8(t){if(t==null||t==="None"||t==="")return null;const e=String(t).trim();if(!e.startsWith("[")||!e.endsWith("]"))return null;try{const n=e.replace(/'/g,'"'),i=JSON.parse(n);if(Array.isArray(i)&&i.every(r=>typeof r=="string"))return i}catch{}return null}function B8(t,e,n,i){const s=ar().nodes.get(t);if(!s)return;const a=i?i(e):R8(e),o=e0(n),l=s[o.portsKey],c=l.map((f,p)=>{const d=a&&p<a.length?a[p]:`${o.defaultName} ${p}`;return f.name===d?f:{...f,name:d}});c.some((f,p)=>f.name!==l[p].name)&&jc(t,f=>({...f,[o.portsKey]:c}))}function z8(t,e,n){const i=Pi.get(t);if(!i)return console.error(`Unknown node type: ${t}`),null;const r=sr(),s={id:r,type:t,name:n||i.name,position:e,inputs:Zv(r,"input",i.ports.inputs),outputs:Zv(r,"output",i.ports.outputs),params:{}};if(t===_n.SUBSYSTEM){const o={id:sr(),type:_n.INTERFACE,name:s.name,position:{x:100,y:100},inputs:[],outputs:[],params:{}};s.graph={nodes:[o],connections:[]}}return QC(s),J1(s),s}function q8(t){const e=ar(),n=e.nodes.get(t);if(n){if(n.type===_n.INTERFACE){console.warn("Interface blocks cannot be deleted");return}for(const i of e.connections)(i.sourceNodeId===t||i.targetNodeId===t)&&$1(i.id);L8(t),gp(i=>{const r=new Map(i);return r.delete(t),r},i=>i.filter(r=>r.id!==t),i=>i.filter(r=>r.sourceNodeId!==t&&r.targetNodeId!==t)),Cr.update(i=>{const r=new Set(i);return r.delete(t),r})}}function j8(t,e){jc(t,n=>({...n,position:{...e}}))}function H8(t,e){const i=ar().nodes.get(t);if(!i)return;const r=Je(Bn);if(i.type===_n.INTERFACE&&r.length>0){const s=r.slice(0,-1),a=r[r.length-1];s.length===0?Ji.update(o=>{const l=o.get(a);if(l){const c=new Map(o);return c.set(a,{...l,name:e}),c}return o}):Rs(s,o=>({...o,nodes:o.nodes.map(l=>l.id===a?{...l,name:e}:l)}));return}jc(t,s=>({...s,name:e}))}function U8(t,e){const i=ar().nodes.get(t);if(!i)return;const r=Je(Bn);if(i.type===_n.INTERFACE&&r.length>0){const s=r.slice(0,-1),a=r[r.length-1];s.length===0?Ji.update(o=>{const l=o.get(a);if(l){const c=new Map(o);return c.set(a,{...l,color:e}),c}return o}):Rs(s,o=>({...o,nodes:o.nodes.map(l=>l.id===a?{...l,color:e}:l)}));return}jc(t,s=>({...s,color:e}))}function W8(t,e){jc(t,i=>({...i,params:{...i.params,...e}}));for(const[i,r]of Object.entries(e))r==null||r===""||i.startsWith("_")||M8(t,i,String(r));const n=ar().nodes.get(t);if(n)for(const i of UC(n.type))i.param in e&&B8(t,e[i.param],i.direction,i.parser)}function V8(t,e){jc(t,n=>({...n,...e}))}function G8(t){return ar().nodes.get(t)}function X8(){const t=[],e=n=>{for(const i of n)t.push(i),i.graph&&e(i.graph.nodes)};return e(Array.from(Je(Ji).values())),t}function Y8(){const t=Je(Cr);if(t.size===0)return[];const e=ar(),n=[],i=[],r={x:50,y:50},s=new Map,a=[],o=[];t.forEach(f=>{const p=e.annotations.get(f);if(p){const w=sr(),b={...p,id:w,position:{x:p.position.x+r.x,y:p.position.y+r.y}};o.push(b),i.push(w);return}const d=e.nodes.get(f);if(!d||d.type===_n.INTERFACE)return;const y=sr();s.set(f,y);const m={id:y,type:d.type,name:d.name,position:{x:d.position.x+r.x,y:d.position.y+r.y},inputs:d.inputs.map((w,b)=>({...w,id:`${y}-input-${b}`,nodeId:y})),outputs:d.outputs.map((w,b)=>({...w,id:`${y}-output-${b}`,nodeId:y})),params:JSON.parse(JSON.stringify(d.params)),pinnedParams:d.pinnedParams?[...d.pinnedParams]:void 0,color:d.color};if(d.graph){const w=JSON.parse(JSON.stringify(d.graph));m.graph=Y1(w)}a.push(m),n.push(y)});const l=e.connections,c=[];for(const f of l){const p=s.get(f.sourceNodeId),d=s.get(f.targetNodeId);p&&d&&c.push({id:sr(),sourceNodeId:p,sourcePortIndex:f.sourcePortIndex,targetNodeId:d,targetPortIndex:f.targetPortIndex})}for(const f of a)J1(f);for(const f of c)Q1(f);(a.length>0||c.length>0)&&gp(f=>{const p=new Map(f);for(const d of a)p.set(d.id,d);return p},f=>[...f,...a],f=>[...f,...c]),o.length>0&&mp(f=>{const p=new Map(f);for(const d of o)p.set(d.id,d);return p},f=>[...f,...o]);const u=[...n,...i];return u.length>0&&oo(u,!1),u}function K8(t){const e=Je(Cr);if(e.size===0)return;const n=i=>({...i,position:{x:i.position.x+t.x,y:i.position.y+t.y}});V1(i=>{const r=new Map(i);return e.forEach(s=>{const a=r.get(s);a&&r.set(s,n(a))}),r},i=>i.map(r=>e.has(r.id)?n(r):r))}function Z8(t,e){if(t.length===0)return[];const n=t.map(i=>i.id);for(const i of t)J1(i);for(const i of e)Q1(i);return gp(i=>{const r=new Map(i);for(const s of t)r.set(s.id,s);return r},i=>[...i,...t],i=>[...i,...e]),oo(n,!1),n}function J8(t,e,n,i){const r=ar(),s=r.nodes.get(t),a=r.nodes.get(n);if(!s||!a)return console.error("Invalid node IDs for connection"),null;if(e>=s.outputs.length||i>=a.inputs.length)return console.error("Invalid port indices for connection"),null;if(r.connections.some(u=>u.targetNodeId===n&&u.targetPortIndex===i))return console.warn("Target port already has a connection"),null;const c={id:sr(),sourceNodeId:t,sourcePortIndex:e,targetNodeId:n,targetPortIndex:i};return G1(u=>[...u,c]),Q1(c),c}function Q8(t){$1(t),G1(e=>e.filter(n=>n.id!==t))}function $8(){const t=[];for(const n of Je($l))t.push({connection:n});const e=(n,i)=>{const r=n instanceof Map?Array.from(n.values()):n;for(const s of r)if(s.graph){for(const a of s.graph.connections)t.push({connection:a,subsystemId:s.id});e(s.graph.nodes,s.id)}};return e(Je(Ji)),t}function eP(t,e){G1(n=>n.map(i=>i.id===t?{...i,waypoints:e}:i))}function tP(t){const e=Je(Bn);return e.length===0?!1:(Rs(e,n=>({...n,events:[...n.events||[],t]})),!0)}function nP(t){const e=Je(Bn);e.length!==0&&Rs(e,n=>({...n,events:(n.events||[]).filter(i=>i.id!==t)}))}function iP(t,e){const n=Je(Bn);n.length!==0&&Rs(n,i=>({...i,events:(i.events||[]).map(r=>r.id===t?{...r,position:{...e}}:r)}))}function rP(t,e){const n=Je(Bn);n.length!==0&&Rs(n,i=>({...i,events:(i.events||[]).map(r=>r.id===t?{...r,name:e}:r)}))}function sP(t,e){const n=Je(Bn);n.length!==0&&Rs(n,i=>({...i,events:(i.events||[]).map(r=>r.id===t?{...r,params:{...r.params,...e}}:r)}))}function aP(t,e){const n=Je(Bn);n.length!==0&&Rs(n,i=>({...i,events:(i.events||[]).map(r=>r.id===t?{...r,color:e}:r)}))}function oP(t){return ar().events.get(t)}function lP(){return Array.from(ar().events.values())}const cP=[{type:"pathsim.events.ZeroCrossing",name:"ZeroCrossing",eventClass:"ZeroCrossing",description:"Subclass of base 'Event' that triggers if the event function crosses zero.",docstringHtml:`<p>Subclass of base 'Event' that triggers if the event function crosses zero.
This is a bidirectional zero-crossing detector.</p>
<p>Monitors system state by evaluating an event function (func_evt) with scalar output and
testing for zero crossings (sign changes).</p>
<pre class="code literal-block">
func_evt(time) -&gt; event?
</pre>
<p>If an event is detected, some action (func_act) is performed on the system state.</p>
<pre class="code literal-block">
func_evt(time) == 0 -&gt; event -&gt; func_act(time)
</pre>
<div class="section" id="example">
<h3>Example</h3>
<p>Initialize a zero-crossing event handler like this:</p>
<pre class="code python literal-block">
# define the event function
def evt(t):
    # here we have a zero-crossing at 't==10'
    return t - 10

# define the action function (callback)
def act(t):
    # do something at event resolution
    pass

# initialize the event manager
E = ZeroCrossing(
    func_evt=evt,  # the event function
    func_act=act   # the action function
    )
</pre>
</div>
<div class="section" id="parameters">
<h3>Parameters</h3>
<dl class="docutils">
<dt>func_evt <span class="classifier-delimiter">:</span> <span class="classifier">callable</span></dt>
<dd>event function, where zeros are events</dd>
<dt>func_act <span class="classifier-delimiter">:</span> <span class="classifier">callable</span></dt>
<dd>action function for event resolution</dd>
<dt>tolerance <span class="classifier-delimiter">:</span> <span class="classifier">float</span></dt>
<dd>tolerance to check if detection is close to actual event</dd>
</dl>
</div>
`,params:[{name:"func_evt",type:"callable",default:"None",description:"event function, where zeros are events"},{name:"func_act",type:"callable",default:"None",description:"action function for event resolution"},{name:"tolerance",type:"number",default:"0.0001",description:"tolerance to check if detection is close to actual event"}]},{type:"pathsim.events.ZeroCrossingUp",name:"ZeroCrossingUp",eventClass:"ZeroCrossingUp",description:"Modification of standard 'ZeroCrossing' event where events are only triggered",docstringHtml:`<p>Modification of standard 'ZeroCrossing' event where events are only triggered
if the event function changes sign from negative to positive (up). Also called
unidirectional zero-crossing.</p>
`,params:[{name:"func_evt",type:"callable",default:"None",description:""},{name:"func_act",type:"callable",default:"None",description:""},{name:"tolerance",type:"number",default:"0.0001",description:""}]},{type:"pathsim.events.ZeroCrossingDown",name:"ZeroCrossingDown",eventClass:"ZeroCrossingDown",description:"Modification of standard 'ZeroCrossing' event where events are only triggered",docstringHtml:`<p>Modification of standard 'ZeroCrossing' event where events are only triggered
if the event function changes sign from positive to negative (down). Also called
unidirectional zero-crossing.</p>
`,params:[{name:"func_evt",type:"callable",default:"None",description:""},{name:"func_act",type:"callable",default:"None",description:""},{name:"tolerance",type:"number",default:"0.0001",description:""}]},{type:"pathsim.events.Schedule",name:"Schedule",eventClass:"Schedule",description:"Subclass of base 'Event' that triggers dependent on the evaluation time.",docstringHtml:`<p>Subclass of base 'Event' that triggers dependent on the evaluation time.</p>
<p>Monitors time in every timestep and triggers periodically (period). This event
does not have an event function as the event condition only depends on time.</p>
<pre class="code literal-block">
time == next_schedule_time -&gt; event
</pre>
<div class="section" id="example">
<h3>Example</h3>
<p>Initialize a scheduled event handler like this:</p>
<pre class="code python literal-block">
#define the action function (callback)
def act(t):
    #do something at event resolution
    pass

#initialize the event manager
E = Schedule(
    t_start=0,    #starting at t=0
    t_end=None,   #never ending
    t_period=3,   #triggering every 3 time units
    func_act=act  #resulting in a callback
    )
</pre>
</div>
<div class="section" id="parameters">
<h3>Parameters</h3>
<dl class="docutils">
<dt>t_start <span class="classifier-delimiter">:</span> <span class="classifier">float</span></dt>
<dd>starting time for schedule</dd>
<dt>t_end <span class="classifier-delimiter">:</span> <span class="classifier">float</span></dt>
<dd>termination time for schedule</dd>
<dt>t_period <span class="classifier-delimiter">:</span> <span class="classifier">float</span></dt>
<dd>time period of schedule, when events are triggered</dd>
<dt>func_act <span class="classifier-delimiter">:</span> <span class="classifier">callable</span></dt>
<dd>action function for event resolution</dd>
<dt>tolerance <span class="classifier-delimiter">:</span> <span class="classifier">float</span></dt>
<dd>tolerance to check if detection is close to actual event</dd>
</dl>
</div>
`,params:[{name:"t_start",type:"number",default:"0",description:"starting time for schedule"},{name:"t_end",type:"number",default:"None",description:"termination time for schedule"},{name:"t_period",type:"number",default:"1",description:"time period of schedule, when events are triggered"},{name:"func_act",type:"callable",default:"None",description:"action function for event resolution"},{name:"tolerance",type:"number",default:"1e-16",description:"tolerance to check if detection is close to actual event"}]},{type:"pathsim.events.ScheduleList",name:"ScheduleList",eventClass:"ScheduleList",description:"Subclass of base 'Schedule' that triggers dependent on the evaluation time.",docstringHtml:`<p>Subclass of base 'Schedule' that triggers dependent on the evaluation time.</p>
<p>Monitors time in every timestep and triggers at the next event time from the
time list. This event does not have an event function as the event condition
only depends on time.</p>
<pre class="code literal-block">
time == next_scheduled_time -&gt; event
</pre>
<div class="section" id="example">
<h3>Example</h3>
<p>Initialize a scheduled event handler like this:</p>
<pre class="code python literal-block">
#define the action function (callback)
def act(t):
    #do something at event resolution
    pass

#initialize the event manager
E = ScheduleList(
    times_evt=[1, 5, 12, 300],  #event times where to trigger
    func_act=act                #resulting in a callback
    )
</pre>
</div>
<div class="section" id="parameters">
<h3>Parameters</h3>
<dl class="docutils">
<dt>times_evt <span class="classifier-delimiter">:</span> <span class="classifier">list[float]</span></dt>
<dd>list of event times in ascending order</dd>
<dt>func_act <span class="classifier-delimiter">:</span> <span class="classifier">callable</span></dt>
<dd>action function for event resolution</dd>
<dt>tolerance <span class="classifier-delimiter">:</span> <span class="classifier">float</span></dt>
<dd>tolerance to check if detection is close to actual event</dd>
</dl>
</div>
`,params:[{name:"times_evt",type:"array",default:"None",description:"list of event times in ascending order"},{name:"func_act",type:"callable",default:"None",description:"action function for event resolution"},{name:"tolerance",type:"number",default:"1e-16",description:"tolerance to check if detection is close to actual event"}]},{type:"pathsim.events.Condition",name:"Condition",eventClass:"Condition",description:"Subclass of base 'Event' that triggers if the event function evaluates to 'True',",docstringHtml:`<p>Subclass of base 'Event' that triggers if the event function evaluates to 'True',
i.e. the condition is satisfied.</p>
<p>Monitors system state by evaluating an event function (func_evt) with boolean output.
The event is considered detected when the event function evaluates to 'True' for the
first time. Subsequent evaluations to 'True' are not considered unless the event is reset.</p>
<pre class="code literal-block">
func_evt(time) -&gt; event?
</pre>
<p>If an event is detected, some action (func_act) is performed on the system state.</p>
<pre class="code literal-block">
func_evt(time) == True -&gt; event -&gt; func_act(time)
</pre>
<div class="section" id="note">
<h3>Note</h3>
<p>Condition event functions evaluate to boolean and are therefore not smooth.
Therefore uses bisection method for event location instead of secant method.</p>
</div>
<div class="section" id="example">
<h3>Example</h3>
<p>Initialize a conditional event handler like this:</p>
<pre class="code python literal-block">
#define the event function
def evt(t):
    return t &gt; 10

#define the action function (callback)
def act(t):
    #do something at event resolution
    pass

#initialize the event manager
E = Condition(
    func_evt=evt,  #the event function
    func_act=act   #the action function
    )
</pre>
</div>
`,params:[{name:"func_evt",type:"callable",default:"None",description:""},{name:"func_act",type:"callable",default:"None",description:""},{name:"tolerance",type:"number",default:"0.0001",description:""}]}],uP=cP;class dP{events=new Map;constructor(){for(const e of uP)this.register(e)}register(e){this.events.set(e.type,e)}get(e){return this.events.get(e)}getAll(){return Array.from(this.events.values())}has(e){return this.events.has(e)}}const oa=new dP,rr=ln(new Map),Qs=ln(new Set);function Cg(t){Qs.set(t)}const fP=Ta(rr,t=>Array.from(t.values())),hP=Ta([rr,Qs],([t,e])=>Array.from(e).map(n=>t.get(n)).filter(n=>n!==void 0)),vn={events:{subscribe:rr.subscribe},eventsArray:{subscribe:fP.subscribe},selectedEventIds:{subscribe:Qs.subscribe},selectedEvents:{subscribe:hP.subscribe},addEvent(t,e,n){const i=oa.get(t);if(!i)return console.error(`Unknown event type: ${t}`),null;const r=sr(),s={id:r,type:t,name:n||i.name,position:e,params:{}};return rr.update(a=>{const o=new Map(a);return o.set(r,s),o}),s},removeEvent(t){rr.update(e=>{const n=new Map(e);return n.delete(t),n}),Qs.update(e=>{const n=new Set(e);return n.delete(t),n})},updateEventPosition(t,e){rr.update(n=>{const i=n.get(t);if(i){const r=new Map(n);return r.set(t,{...i,position:{...e}}),r}return n})},updateEventName(t,e){rr.update(n=>{const i=n.get(t);if(i){const r=new Map(n);return r.set(t,{...i,name:e}),r}return n})},updateEventParams(t,e){rr.update(n=>{const i=n.get(t);if(i){const r=new Map(n);return r.set(t,{...i,params:{...i.params,...e}}),r}return n})},updateEventColor(t,e){rr.update(n=>{const i=n.get(t);if(i){const r=new Map(n);return r.set(t,{...i,color:e}),r}return n})},selectEvent(t,e=!1){if(e){const n=Je(Qs);oo([...n,t],!0)}else oo([t],!1)},deselectEvent(t){const n=[...Je(Qs)].filter(i=>i!==t);oo(n,!1)},clearSelection(){Ad()},hasSelection(){return Je(Qs).size>0},clear(){rr.set(new Map),Qs.set(new Set)},getEvent(t){return Je(rr).get(t)},getAll(){return Array.from(Je(rr).values())},selectAll(){const t=Array.from(Je(rr).keys());Qs.set(new Set(t))},duplicateSelected(){const t=Je(Qs);if(t.size===0)return[];const e=Je(rr),n=[],i={x:50,y:50};return t.forEach(r=>{const s=e.get(r);if(!s)return;const a=sr(),o={id:a,type:s.type,name:s.name,position:{x:s.position.x+i.x,y:s.position.y+i.y},params:JSON.parse(JSON.stringify(s.params)),color:s.color};rr.update(l=>{const c=new Map(l);return c.set(a,o),c}),n.push(a)}),n.length>0&&oo(n,!1),n},nudgeSelectedEvents(t){const e=Je(Qs);e.size!==0&&rr.update(n=>{const i=new Map(n);return e.forEach(r=>{const s=i.get(r);s&&i.set(r,{...s,position:{x:s.position.x+t.x,y:s.position.y+t.y}})}),i})},toJSON(){return Array.from(Je(rr).values())},fromJSON(t){!t||!Array.isArray(t)?rr.set(new Map):rr.set(new Map(t.map(e=>[e.id,e]))),Qs.set(new Set)}};function pP(t,e=!1){if(e){const n=Je(Cr);oo([...n,t],!0)}else oo([t],!1)}function gP(t){const n=[...Je(Cr)].filter(i=>i!==t);oo(n,!1)}function mP(){Ad()}function vP(){return Je(Cr).size>0}function yP(){const t=ar(),e=Array.from(t.nodes.keys()),n=$C()?Array.from(Je(vn.events).keys()):Array.from(t.events.keys());oo([...e,...n],!1)}function bP(){Ji.set(new Map),$l.set([]),Wu.set(new Map),Bn.set([]),Cr.set(new Set)}function wP(){return{nodes:Array.from(Je(Ji).values()),connections:Je($l),annotations:Array.from(Je(Wu).values())}}function xP(t,e,n){!t||!Array.isArray(t)?Ji.set(new Map):Ji.set(new Map(t.map(i=>[i.id,i]))),$l.set(e||[]),Wu.set(new Map((n||[]).map(i=>[i.id,i]))),Bn.set([]),Cr.set(new Set)}function _P(){const t=[],e=(n,i,r)=>{for(const s of n)s.type!==_n.INTERFACE&&(t.push({node:s,path:[...i],pathNames:[...r],depth:i.length}),s.graph&&e(s.graph.nodes,[...i,s.id],[...r,s.name]))};return e(Array.from(Je(Ji).values()),[],["Root"]),t}const Fe={nodes:{subscribe:X1.subscribe},connections:{subscribe:e8.subscribe},annotations:{subscribe:t8.subscribe},subsystemEvents:{subscribe:n8.subscribe},selectedNodeIds:{subscribe:Cr.subscribe},nodesArray:{subscribe:i8.subscribe},selectedNodes:{subscribe:r8.subscribe},currentPath:{subscribe:Bn.subscribe},breadcrumbs:{subscribe:s8.subscribe},drillDown:x8,drillUp:_8,navigateTo:S8,navigateToPath:k8,isAtRoot:A8,getCurrentPath:N8,addNode:z8,removeNode:q8,updateNodePosition:j8,updateNodeName:H8,updateNodeColor:U8,updateNodeParams:W8,updateNode:V8,getNode:G8,getAllNodes:X8,duplicateSelected:Y8,nudgeSelectedNodes:K8,pasteNodes:Z8,addConnection:J8,removeConnection:Q8,getAllConnections:$8,updateConnectionWaypoints:eP,addInputPort:T8,removeInputPort:O8,addOutputPort:D8,removeOutputPort:F8,addAnnotation:a8,updateAnnotation:K5,updateAnnotationPosition:o8,removeAnnotation:l8,getAnnotation:c8,addSubsystemEvent:tP,removeSubsystemEvent:nP,updateSubsystemEventPosition:iP,updateSubsystemEventName:rP,updateSubsystemEventParams:sP,updateSubsystemEventColor:aP,getSubsystemEvent:oP,getSubsystemEvents:lP,selectNode:pP,deselectNode:gP,clearSelection:mP,hasSelection:vP,selectAll:yP,clear:bP,toJSON:wP,fromJSON:xP,getAllNodesWithPaths:_P},SP=50;let al=[],Ic=[],la=!1,wu=null,Hm=!1,ra=0,tl=null;const hw=ln({undoStack:[],redoStack:[],canUndo:!1,canRedo:!1});function yp(){hw.set({undoStack:al,redoStack:Ic,canUndo:al.length>0,canRedo:Ic.length>0})}function Qd(){return{graph:Fe.toJSON(),events:vn.toJSON()}}function i0(t){al.push(t),al.length>SP&&al.shift(),Ic=[],yp()}function pw(t){Hm=!0;try{Fe.fromJSON(t.graph.nodes,t.graph.connections,t.graph.annotations),vn.fromJSON(t.events)}finally{queueMicrotask(()=>{Hm=!1})}}function kP(){return Hm}function AP(t){if(la)return t();const e=ra===0;e&&(tl=Qd()),ra++;try{const n=t();return e&&tl&&i0(tl),n}catch(n){throw n}finally{ra--,ra===0&&(tl=null)}}async function NP(t){if(la)return t();const e=ra===0;e&&(tl=Qd()),ra++;try{const n=await t();return e&&tl&&i0(tl),n}catch(n){throw n}finally{ra--,ra===0&&(tl=null)}}function CP(){return ra>0||la}function PP(){la||(la=!0,wu=Qd())}function EP(){la&&(la=!1,wu&&(i0(wu),wu=null))}function IP(){la=!1,wu=null}function LP(){if(la||ra>0||al.length===0)return!1;const t=Qd(),e=al.pop();return Ic.push(t),pw(e),yp(),!0}function MP(){if(la||ra>0||Ic.length===0)return!1;const t=Qd(),e=Ic.pop();return al.push(t),pw(e),yp(),!0}function TP(){al=[],Ic=[],la=!1,wu=null,ra=0,tl=null,yp()}function DP(){return la}const It={subscribe:hw.subscribe,mutate:AP,mutateAsync:NP,isInMutation:CP,beginDrag:PP,endDrag:EP,cancelDrag:IP,undo:LP,redo:MP,clear:TP,isInDrag:DP,isRestoringState:kP},Pg=ln(!1),dh={subscribe:Pg.subscribe,toggle(){Pg.update(t=>!t)},set(t){Pg.set(t)}},gw="pathview-portLabels";function OP(){return localStorage.getItem(gw)==="true"}const gd=ln(OP());gd.subscribe(t=>{localStorage.setItem(gw,String(t))});const r0={subscribe:gd.subscribe,toggle(){gd.update(t=>!t)},set(t){gd.set(t)},get(){return Je(gd)}},md=ln(null),Um=ln(null),s0=ln({text:"",x:0,y:0,visible:!1,position:"bottom"});let fh=null,hh=null;function Wm(t,e,n="bottom",i,r){hh&&(clearTimeout(hh),hh=null),fh=setTimeout(()=>{const s=e.getBoundingClientRect(),a=r??240,o=28,l=8,c=8;let u=n,f,p;switch(n==="bottom"&&s.bottom+l+o>window.innerHeight-c?u="top":n==="top"&&s.top-l-o<c?u="bottom":n==="right"&&s.right+l+a>window.innerWidth-c?u="left":n==="left"&&s.left-l-a<c&&(u="right"),u){case"left":f=s.left-l,p=s.top+s.height/2;break;case"right":f=s.right+l,p=s.top+s.height/2;break;case"top":f=s.left+s.width/2,p=s.top-l;break;default:f=s.left+s.width/2,p=s.bottom+l;break}if(u==="bottom"||u==="top"){const d=a/2;f-d<c?f=c+d:f+d>window.innerWidth-c&&(f=window.innerWidth-c-d)}if(u==="left"||u==="right"){const d=o/2;p-d<c?p=c+d:p+d>window.innerHeight-c&&(p=window.innerHeight-c-d)}s0.set({text:t,shortcut:i,maxWidth:r,x:f,y:p,visible:!0,position:u})},50)}function Hh(){fh&&(clearTimeout(fh),fh=null),hh=setTimeout(()=>{s0.update(t=>({...t,visible:!1}))},50)}function $t(t,e){if(typeof window>"u")return{destroy:()=>{}};let n=typeof e=="string"?e:e.text,i=typeof e=="string"?void 0:e.shortcut,r=typeof e=="string"?void 0:e.maxWidth,s=typeof e=="string"?"bottom":e.position??"bottom";function a(){n&&Wm(n,t,s,i,r)}function o(){Hh()}return t.addEventListener("mouseenter",a),t.addEventListener("mouseleave",o),{update(l){n=typeof l=="string"?l:l.text,i=typeof l=="string"?void 0:l.shortcut,r=typeof l=="string"?void 0:l.maxWidth,s=typeof l=="string"?"bottom":l.position??"bottom"},destroy(){t.removeEventListener("mouseenter",a),t.removeEventListener("mouseleave",o),Hh()}}}var FP=Me('<span class="shortcut svelte-11extwn"> </span>'),RP=Me('<div><span class="text"> </span> <!></div>');function BP(t,e){Tt(e,!0);let n=Oe(Rn({text:"",x:0,y:0,visible:!1,position:"bottom"}));s0.subscribe(a=>{J(n,a,!0)});var i=$e(),r=Ue(i);{var s=a=>{var o=RP(),l=se(o),c=se(l,!0);Q(l);var u=be(l,2);{var f=p=>{var d=FP(),y=se(d,!0);Q(d),_e(()=>Wt(y,h(n).shortcut)),j(p,d)};ke(u,p=>{h(n).shortcut&&p(f)})}Q(o),_e(()=>{Xt(o,1,`tooltip tooltip-${h(n).position??""}`,"svelte-11extwn"),An(o,`left: ${h(n).x??""}px; top: ${h(n).y??""}px;${h(n).maxWidth?` max-width: ${h(n).maxWidth}px;`:""}`),Wt(c,h(n).text)}),j(a,o)};ke(r,a=>{h(n).visible&&a(s)})}j(t,i),Dt()}const Qv={blurOnEscape:!0,blurOnEnter:!1};function $s(t,e={}){const n={...Qv,...e};function i(r){const s=r;s.key==="Escape"&&n.blurOnEscape&&(s.stopPropagation(),t.blur()),s.key==="Enter"&&n.blurOnEnter&&!(t instanceof HTMLTextAreaElement)&&(s.stopPropagation(),t.blur())}return t.addEventListener("keydown",i),t.setAttribute("autocomplete","off"),{update(r){Object.assign(n,Qv,r)},destroy(){t.removeEventListener("keydown",i)}}}let zP=0;const $v=500;function qP(){const{subscribe:t,set:e,update:n}=ln([]);let i=[],r=null;const s=50;function a(){if(i.length===0)return;const l=i;i=[],r=null,n(c=>{const u=[...c,...l];return u.length>$v?u.slice(-$v):u})}function o(){r===null&&(r=setTimeout(a,s))}return{subscribe:t,log(l,c="info"){i.push({id:zP++,timestamp:new Date,level:c,message:l}),o()},info(l){this.log(l,"info")},warn(l){this.log(l,"warning")},error(l){this.log(l,"error")},output(l){this.log(l,"output")},clear(){i=[],r&&(clearTimeout(r),r=null),e([])},getAll(){return Je({subscribe:t})},flush(){r&&clearTimeout(r),a()}}}const ri=qP(),jP={dt:t=>({attr:"dt",code:`sim.dt = ${t}`}),dt_min:t=>({attr:"dt_min",code:`sim.dt_min = ${t}`}),dt_max:t=>({attr:"dt_max",code:`sim.dt_max = ${t}`}),rtol:t=>({attr:"rtol",code:`sim.tolerance_lte_rel = ${t}`}),atol:t=>({attr:"atol",code:`sim.tolerance_lte_abs = ${t}`}),ftol:t=>({attr:"ftol",code:`sim.tolerance_fpi = ${t}`}),solver:t=>({attr:"solver",code:`sim._set_solver(${t})`})};function Eg(t){for(const[e,n]of Object.entries(t)){if(n==null||n==="")continue;const i=jP[e];if(i){const{attr:r,code:s}=i(String(n));dw(r,s)}}}const Dl=ln({...ts}),is={subscribe:Dl.subscribe,update(t){Dl.update(e=>({...e,...t})),Eg(t)},setDuration(t){Dl.update(e=>({...e,duration:t}))},setDt(t){Dl.update(e=>({...e,dt:t})),Eg({dt:t})},setSolver(t){Dl.update(e=>({...e,solver:t})),Eg({solver:t})},reset(){Dl.set({...ts})},get(){return Je(Dl)},set(t){Dl.set(t)}},e2=["Sources","Dynamic","Algebraic","Mixed","Recording","Subsystem"],Ts={SIMULATION:3e5,INIT:12e4,VALIDATION:3e4},mw={STARTING_WORKER:"Starting worker...",STARTING_SIMULATION:"Starting simulation..."},Lc={READY:"Ready",COMPLETE:"Complete",STOPPED:"Stopped",RUNNING:"Running"},HP={SIMULATION_COMPLETED:"Simulation completed successfully"},vw={initialized:!1,loading:!1,error:null,progress:""},od=ln(vw),Xi={subscribe:od.subscribe,get:()=>Je(od),set:od.set,update:od.update,reset:()=>od.set(vw)};class UP{worker=null;messageId=0;pendingRequests=new Map;isInitializing=!1;streamState={id:null,onData:null,onDone:null,onError:null};stdoutCallback=null;stderrCallback=null;async init(){const e=this.getState();if(!(this.worker&&(e.initialized||e.loading))){this.worker&&(this.worker.terminate(),this.worker=null),Xi.update(n=>({...n,loading:!0,error:null,progress:mw.STARTING_WORKER})),this.isInitializing=!0;try{this.worker=new Worker(new URL(""+new URL("../workers/worker-CuhqzRXm.js",import.meta.url).href,import.meta.url),{type:"module"}),this.worker.onmessage=n=>{this.handleResponse(n.data)},this.worker.onerror=n=>{Xi.update(i=>({...i,loading:!1,error:n.message||"Worker error"}))},this.sendRequest({type:"init"}),await new Promise((n,i)=>{const r=setTimeout(()=>i(new Error("Initialization timeout")),Ts.INIT),s=Xi.subscribe(a=>{a.initialized&&(clearTimeout(r),s(),n()),a.error&&(clearTimeout(r),s(),i(new Error(a.error)))})})}catch(n){throw Xi.update(i=>({...i,loading:!1,error:n instanceof Error?n.message:String(n)})),n}}}terminate(){for(const[,e]of this.pendingRequests)clearTimeout(e.timeoutId),e.reject(new Error("Backend terminated"));this.pendingRequests.clear(),this.streamState={id:null,onData:null,onDone:null,onError:null},this.worker&&(this.worker.terminate(),this.worker=null),Xi.reset()}getState(){return Xi.get()}subscribe(e){return Xi.subscribe(e)}isReady(){return this.getState().initialized}isLoading(){return this.getState().loading}getError(){return this.getState().error}async exec(e,n=Ts.SIMULATION){if(this.worker||await this.init(),!this.isReady())throw new Error("Backend not initialized");const i=this.generateId();return new Promise((r,s)=>{const a=setTimeout(()=>{this.pendingRequests.has(i)&&(this.pendingRequests.delete(i),s(new Error("Execution timeout")))},n);this.pendingRequests.set(i,{resolve:()=>r(),reject:s,timeoutId:a}),this.sendRequest({type:"exec",id:i,code:e})})}async evaluate(e,n=Ts.SIMULATION){if(this.worker||await this.init(),!this.isReady())throw new Error("Backend not initialized");const i=this.generateId();return new Promise((r,s)=>{const a=setTimeout(()=>{this.pendingRequests.has(i)&&(this.pendingRequests.delete(i),s(new Error("Evaluation timeout")))},n);this.pendingRequests.set(i,{resolve:o=>{if(o===void 0){s(new Error("No value returned from eval"));return}try{r(JSON.parse(o))}catch{s(new Error(`Failed to parse eval result: ${o}`))}},reject:s,timeoutId:a}),this.sendRequest({type:"eval",id:i,expr:e})})}startStreaming(e,n,i,r){if(!this.worker){r(new Error("Backend not initialized"));return}if(!this.isReady()){r(new Error("Backend not initialized"));return}this.streamState.id&&this.stopStreaming();const s=this.generateId();this.streamState={id:s,onData:n,onDone:i,onError:r},this.sendRequest({type:"stream-start",id:s,expr:e})}stopStreaming(){!this.worker||!this.streamState.id||this.sendRequest({type:"stream-stop"})}isStreaming(){return this.streamState.id!==null}execDuringStreaming(e){if(!this.worker||!this.streamState.id){console.warn("Cannot exec during streaming: no active stream");return}this.sendRequest({type:"stream-exec",code:e})}onStdout(e){this.stdoutCallback=e}onStderr(e){this.stderrCallback=e}generateId(){return`repl_${++this.messageId}`}sendRequest(e){if(!this.worker)throw new Error("Worker not initialized");this.worker.postMessage(e)}handleResponse(e){switch(e.type){case"ready":Xi.update(n=>({...n,initialized:!0,loading:!1,progress:Lc.READY})),this.isInitializing=!1;break;case"progress":Xi.update(n=>({...n,progress:e.value||""}));break;case"ok":if(e.id&&this.pendingRequests.has(e.id)){const n=this.pendingRequests.get(e.id);clearTimeout(n.timeoutId),n.resolve(void 0),this.pendingRequests.delete(e.id)}break;case"value":if(e.id&&this.pendingRequests.has(e.id)){const n=this.pendingRequests.get(e.id);clearTimeout(n.timeoutId),n.resolve(e.value),this.pendingRequests.delete(e.id)}break;case"error":this.handleError(e);break;case"stdout":e.value&&this.stdoutCallback&&this.stdoutCallback(e.value);break;case"stderr":e.value&&this.stderrCallback&&this.stderrCallback(e.value);break;case"stream-data":if(e.id===this.streamState.id&&this.streamState.onData&&e.value)try{this.streamState.onData(JSON.parse(e.value))}catch{}break;case"stream-done":e.id===this.streamState.id&&this.streamState.onDone&&(this.streamState.onDone(),this.streamState={id:null,onData:null,onDone:null,onError:null});break}}handleError(e){const{id:n,error:i,traceback:r}=e,s=r?`${i}
${r}`:i||"Unknown error";if(n&&this.pendingRequests.has(n)){const a=this.pendingRequests.get(n);clearTimeout(a.timeoutId),a.reject(new Error(s)),this.pendingRequests.delete(n)}n===this.streamState.id&&this.streamState.onError&&(this.streamState.onError(new Error(s)),this.streamState={id:null,onData:null,onDone:null,onError:null}),Xi.update(a=>({...a,error:i||"Unknown error"}))}}const WP="0.7.5",VP={pathsim:"0.17.2",pathsim_chem:"0.2rc3"},GP=[{pip:"pathsim==0.17.2",required:!0,pre:!0,import:"pathsim"},{pip:"pathsim-chem==0.2rc3",required:!1,pre:!0,import:"pathsim_chem"}],XP=5,YP="flask-session";class KP{host;sessionId;messageId=0;_isStreaming=!1;streamPollTimer=null;serverInitPromise=null;broadcastChannel=null;streamState={onData:null,onDone:null,onError:null};stdoutCallback=null;stderrCallback=null;constructor(e){this.host=e.replace(/\/$/,"");const n=typeof localStorage<"u"?localStorage.getItem("flask-session-id"):null;n?this.sessionId=n:(this.sessionId=crypto.randomUUID(),typeof localStorage<"u"&&localStorage.setItem("flask-session-id",this.sessionId)),typeof BroadcastChannel<"u"&&(this.broadcastChannel=new BroadcastChannel(YP),this.broadcastChannel.onmessage=i=>{i.data?.type==="session-terminated"&&(this.serverInitPromise=null,Xi.reset())})}async init(){const e=this.getState();if(!(e.initialized||e.loading)){Xi.update(n=>({...n,loading:!0,error:null,progress:"Connecting to Flask server..."}));try{const n=await fetch(`${this.host}/api/health`,{signal:AbortSignal.timeout(Ts.INIT)});if(!n.ok)throw new Error(`Server health check failed: ${n.status}`);Xi.update(i=>({...i,progress:"Initializing Python worker..."})),await this.postInit({updateProgress:!0}),this.serverInitPromise=Promise.resolve(),Xi.update(i=>({...i,initialized:!0,loading:!1,progress:Lc.READY}))}catch(n){const i=n instanceof Error?n.message:String(n);throw Xi.update(r=>({...r,loading:!1,error:`Flask backend error: ${i}`})),n}}}terminate(){this.stopStreaming(),this.streamPollTimer&&(clearTimeout(this.streamPollTimer),this.streamPollTimer=null),this._isStreaming=!1,this.streamState={onData:null,onDone:null,onError:null},fetch(`${this.host}/api/session`,{method:"DELETE",headers:{"X-Session-ID":this.sessionId}}).catch(()=>{}),this.broadcastChannel?.postMessage({type:"session-terminated"}),this.serverInitPromise=null,Xi.reset()}getState(){return Xi.get()}subscribe(e){return Xi.subscribe(e)}isReady(){return this.getState().initialized}isLoading(){return this.getState().loading}getError(){return this.getState().error}ensureServerInit(){return this.serverInitPromise?this.serverInitPromise:(this.serverInitPromise=this.postInit({updateProgress:!1}),this.serverInitPromise.catch(()=>{this.serverInitPromise=null}),this.serverInitPromise)}async exec(e,n=Ts.SIMULATION){await this.ensureServerInit();const i=this.generateId(),s=await(await fetch(`${this.host}/api/exec`,{method:"POST",headers:{"Content-Type":"application/json","X-Session-ID":this.sessionId},body:JSON.stringify({id:i,code:e}),signal:AbortSignal.timeout(n)})).json();if(s.stdout&&this.stdoutCallback&&this.stdoutCallback(s.stdout),s.stderr&&this.stderrCallback&&this.stderrCallback(s.stderr),s.type==="error"){this.handleWorkerError(s);const a=s.traceback?`${s.error}
${s.traceback}`:s.error;throw new Error(a)}}async evaluate(e,n=Ts.SIMULATION){await this.ensureServerInit();const i=this.generateId(),s=await(await fetch(`${this.host}/api/eval`,{method:"POST",headers:{"Content-Type":"application/json","X-Session-ID":this.sessionId},body:JSON.stringify({id:i,expr:e}),signal:AbortSignal.timeout(n)})).json();if(s.stdout&&this.stdoutCallback&&this.stdoutCallback(s.stdout),s.stderr&&this.stderrCallback&&this.stderrCallback(s.stderr),s.type==="error"){this.handleWorkerError(s);const a=s.traceback?`${s.error}
${s.traceback}`:s.error;throw new Error(a)}if(s.value===void 0)throw new Error("No value returned from eval");return JSON.parse(s.value)}startStreaming(e,n,i,r){this._isStreaming&&this.stopStreaming(),this.streamPollTimer&&(clearTimeout(this.streamPollTimer),this.streamPollTimer=null);const s=this.generateId();this._isStreaming=!0,this.streamState={onData:n,onDone:i,onError:r},this.ensureServerInit().then(()=>fetch(`${this.host}/api/stream/start`,{method:"POST",headers:{"Content-Type":"application/json","X-Session-ID":this.sessionId},body:JSON.stringify({id:s,expr:e})})).then(a=>a.json()).then(a=>{if(a.type==="error")throw new Error(a.error);this.pollStreamResults()}).catch(a=>{this._isStreaming=!1,r(a instanceof Error?a:new Error(String(a))),this.streamState={onData:null,onDone:null,onError:null}})}stopStreaming(){this._isStreaming&&fetch(`${this.host}/api/stream/stop`,{method:"POST",headers:{"Content-Type":"application/json","X-Session-ID":this.sessionId}}).catch(()=>{})}isStreaming(){return this._isStreaming}execDuringStreaming(e){if(!this._isStreaming){console.warn("Cannot exec during streaming: no active stream");return}fetch(`${this.host}/api/stream/exec`,{method:"POST",headers:{"Content-Type":"application/json","X-Session-ID":this.sessionId},body:JSON.stringify({code:e})}).catch(()=>{})}onStdout(e){this.stdoutCallback=e}onStderr(e){this.stderrCallback=e}generateId(){return`repl_${++this.messageId}`}async postInit(e){const i=await(await fetch(`${this.host}/api/init`,{method:"POST",headers:{"Content-Type":"application/json","X-Session-ID":this.sessionId},body:JSON.stringify({packages:GP}),signal:AbortSignal.timeout(Ts.INIT)})).json();if(i.type==="error")throw new Error(i.error);if(i.messages)for(const r of i.messages)r.type==="stdout"&&this.stdoutCallback&&this.stdoutCallback(r.value),r.type==="stderr"&&this.stderrCallback&&this.stderrCallback(r.value),r.type==="progress"&&e.updateProgress&&Xi.update(s=>({...s,progress:r.value}))}handleWorkerError(e){const n=e.errorType;(n==="worker-crashed"||n==="timeout")&&(this.serverInitPromise=null,this.stderrCallback&&this.stderrCallback(`Python worker crashed, restarting on next request...
`))}async pollStreamResults(){if(this._isStreaming)try{const n=await(await fetch(`${this.host}/api/stream/poll`,{method:"POST",headers:{"Content-Type":"application/json","X-Session-ID":this.sessionId}})).json();if(!Array.isArray(n?.messages))throw new Error(n?.error||"Invalid poll response");for(const i of n.messages)if(this.handleStreamMessage(i),!this._isStreaming)return;this._isStreaming&&(this.streamPollTimer=setTimeout(()=>this.pollStreamResults(),XP))}catch(e){this._isStreaming=!1,this.streamState.onError&&this.streamState.onError(e instanceof Error?e:new Error(String(e))),this.streamState={onData:null,onDone:null,onError:null}}}handleStreamMessage(e){switch(e.type){case"stream-data":{if(this.streamState.onData&&e.value)try{this.streamState.onData(JSON.parse(e.value))}catch{}break}case"stream-done":{this._isStreaming=!1,this.streamState.onDone&&this.streamState.onDone(),this.streamState={onData:null,onDone:null,onError:null};break}case"stdout":{this.stdoutCallback&&e.value&&this.stdoutCallback(e.value);break}case"stderr":{this.stderrCallback&&e.value&&this.stderrCallback(e.value);break}case"error":{if(this._isStreaming=!1,this.streamState.onError){const i=e.traceback?`${e.error}
${e.traceback}`:e.error||"Unknown error";this.streamState.onError(new Error(i))}this.streamState={onData:null,onDone:null,onError:null};break}}}}let xc=null,yw="http://localhost:5000";function bw(t){yw=t}function Vu(){return xc||(xc=ww("pyodide")),xc}function ww(t){switch(t){case"pyodide":return new UP;case"flask":return new KP(yw);case"remote":throw new Error(`Backend type '${t}' not yet implemented`);default:throw new Error(`Unknown backend type: ${t}`)}}function xw(t){return xc&&xc.terminate(),xc=ww(t),xc}async function ZP(){if(typeof window>"u")return;const t=new URLSearchParams(window.location.search),e=t.get("backend"),n=t.get("host");e==="flask"&&(n&&bw(n),xw("flask"),await bp())}async function JP(){if(!(typeof window>"u"||new URLSearchParams(window.location.search).has("backend")))try{const e=await fetch("/api/health",{method:"GET",signal:AbortSignal.timeout(2e3)});e.ok&&(await e.json()).status==="ok"&&(bw(window.location.origin),xw("flask"),await bp())}catch{}}const Gu={subscribe:Xi.subscribe};async function bp(){const t=Vu();t.onStdout(n=>ri.output(n)),t.onStderr(n=>ri.error(n));const e=t.subscribe(n=>{n.progress&&n.loading&&ri.info(n.progress)});try{ri.info("Initializing Python REPL..."),await t.init(),ri.info("Python REPL ready")}finally{e()}}async function Ki(t,e){return Vu().exec(t,e)}async function QP(t,e){return Vu().evaluate(t,e)}function $P(t,e,n,i){Vu().startStreaming(t,e,n,i)}function _w(){Vu().stopStreaming()}function eE(t){Vu().execDuringStreaming(t)}const tE=`
import json
import gc
import numpy as np

def _to_json(obj):
    """Convert Python object to JSON-serializable form."""
    if hasattr(obj, 'tolist'):
        return obj.tolist()
    if isinstance(obj, (set, frozenset)):
        return list(obj)
    if isinstance(obj, bytes):
        return obj.decode('utf-8', errors='replace')
    return obj

def _step_streaming_gen():
    """Step the streaming generator and return result dict."""
    global _sim_streaming, _sim_gen
    if '_sim_gen' not in globals() or not _sim_streaming:
        return {'done': True, 'result': None}
    try:
        result = next(_sim_gen)
        return {'done': False, 'result': result}
    except StopIteration:
        _sim_streaming = False
        return {'done': True, 'result': None}

def _extract_scope_data(blocks, node_id_map, incremental=False):
    """Extract data from Scope blocks recursively.

    If incremental=True, only returns data accumulated since last read.
    """
    scope_data = {}

    def find_scopes(block_list):
        for block in block_list:
            block_name = type(block).__name__
            block_id = node_id_map.get(id(block), str(id(block)))

            if block_name == 'Scope':
                try:
                    data = block.read(incremental=incremental)
                    if data is not None:
                        time_arr, signals = data
                        labels = list(block.labels) if hasattr(block, 'labels') and block.labels else []
                        scope_data[block_id] = {
                            'time': time_arr.tolist() if hasattr(time_arr, 'tolist') else list(time_arr),
                            'signals': [s.tolist() if hasattr(s, 'tolist') else list(s) for s in signals],
                            'labels': labels
                        }
                except Exception as e:
                    print(f"Error reading Scope: {e}")
            elif block_name == 'Subsystem':
                if hasattr(block, 'blocks'):
                    find_scopes(block.blocks)

    find_scopes(blocks)
    return scope_data


def _extract_spectrum_data(blocks, node_id_map):
    """Extract data from Spectrum blocks recursively."""
    spectrum_data = {}

    def find_spectrums(block_list):
        for block in block_list:
            block_name = type(block).__name__
            block_id = node_id_map.get(id(block), str(id(block)))

            if block_name == 'Spectrum':
                try:
                    data = block.read()
                    if data is not None:
                        freq_arr, magnitude = data

                        # Convert complex to magnitude if needed
                        if np.iscomplexobj(magnitude):
                            magnitude = np.abs(magnitude)

                        freq_list = freq_arr.tolist() if hasattr(freq_arr, 'tolist') else list(freq_arr)

                        # Handle both single array and list of arrays
                        if hasattr(magnitude, 'ndim') and magnitude.ndim == 1:
                            mag_list = [magnitude.tolist()]
                        elif hasattr(magnitude, 'ndim') and magnitude.ndim == 2:
                            mag_list = [m.tolist() for m in magnitude]
                        else:
                            mag_list = [m.tolist() if hasattr(m, 'tolist') else list(m) for m in magnitude]

                        labels = list(block.labels) if hasattr(block, 'labels') and block.labels else []
                        spectrum_data[block_id] = {
                            'frequency': freq_list,
                            'magnitude': mag_list,
                            'labels': labels
                        }
                except Exception as e:
                    print(f"Error reading Spectrum: {e}")
            elif block_name == 'Subsystem':
                if hasattr(block, 'blocks'):
                    find_spectrums(block.blocks)

    find_spectrums(blocks)
    return spectrum_data


def _extract_all_data(blocks, node_id_map, node_name_map=None, incremental=False):
    """Extract all recording block data.

    If incremental=True, only returns data accumulated since last read.
    """
    return {
        'scopeData': _extract_scope_data(blocks, node_id_map, incremental=incremental),
        'spectrumData': _extract_spectrum_data(blocks, node_id_map),
        'nodeNames': node_name_map or {}
    }
`;function nE(t){return`
import sys
import traceback

_simulation_error = None

try:
${oE(t,4)}
except Exception as e:
    tb = traceback.format_exc()
    _simulation_error = f"{type(e).__name__}: {e}"
    print("=" * 60, file=sys.stderr)
    print("SIMULATION ERROR", file=sys.stderr)
    print("=" * 60, file=sys.stderr)
    print(tb, file=sys.stderr)
    print("=" * 60, file=sys.stderr)
    raise
`}function iE(t){return`
import base64

_validation_namespace = {'np': np}
_validation_errors = []

# Decode and execute code context
_code_context = base64.b64decode("${t}").decode('utf-8')
try:
    exec(_code_context, _validation_namespace)
except Exception as e:
    _validation_errors.append({
        'nodeId': '__code_context__',
        'param': '',
        'error': f"Code context error: {type(e).__name__}: {e}"
    })
`}function rE(t){return`
import json
import base64

if not _validation_errors:
    _node_params = json.loads(base64.b64decode("${t}").decode('utf-8'))

    for node_id, params in _node_params.items():
        for param_name, expr in params.items():
            if expr is None or expr == '':
                continue
            try:
                eval(str(expr), _validation_namespace)
            except Exception as e:
                _validation_errors.append({
                    'nodeId': node_id,
                    'param': param_name,
                    'error': f"{type(e).__name__}: {e}"
                })
`}const sE="{'valid': len(_validation_errors) == 0, 'errors': _validation_errors}",Sw=`
import gc
_cg = globals().get('_clean_globals', None)
if _cg is not None:
    for _var in list(globals().keys()):
        if _var not in _cg and _var != '_cg':
            try:
                del globals()[_var]
            except:
                pass
    del _cg
gc.collect()
`,kw=`
import gc
for _var in ['_simulation_error', '_validation_errors', '_validation_namespace']:
    if _var in globals():
        try:
            del globals()[_var]
        except:
            pass
gc.collect()
`;function Aw(t,e=10,n=!0){return`
_sim_gen = sim.run_streaming(
    duration=${t},
    reset=${n?"True":"False"},
    tickrate=${e},
    func_callback=lambda: _extract_all_data(blocks, _node_id_map, _node_name_map if '_node_name_map' in globals() else {}, incremental=True)
)
_sim_streaming = True
`}const aE="_step_streaming_gen()",Ru=`
_sim_streaming = False
if '_sim_gen' in globals():
    try:
        _sim_gen.close()
    except:
        pass
`;function oE(t,e){const n=" ".repeat(e);return t.split(`
`).map(i=>n+i).join(`
`)}function t2(t){return btoa(unescape(encodeURIComponent(t)))}const n2={phase:"idle",progress:"",error:null,result:null,resultHistory:[]},Zi={...ln({...n2}),reset(){this.set({...n2,resultHistory:[]})}};function lE(t){return t?{scopeData:Object.fromEntries(Object.entries(t.scopeData).map(([e,n])=>[e,{time:[],signals:n.signals.map(()=>[]),labels:n.labels}])),spectrumData:Object.fromEntries(Object.entries(t.spectrumData).map(([e,n])=>[e,{frequency:[],magnitude:n.magnitude.map(()=>[]),labels:n.labels}])),nodeNames:{...t.nodeNames}}:{scopeData:{},spectrumData:{},nodeNames:{}}}let Uh=!1,Ar=!1;function Nw(t,e,n){return n===0?[]:t?[t,...e].slice(0,n):e}function i2(t,e){if(!t)return e;const n={...t.scopeData};for(const[i,r]of Object.entries(e.scopeData))n[i]?n[i]={time:[...n[i].time,...r.time],signals:n[i].signals.map((s,a)=>[...s,...r.signals[a]||[]]),labels:r.labels||n[i].labels}:n[i]=r;return{scopeData:n,spectrumData:e.spectrumData,nodeNames:{...t.nodeNames,...e.nodeNames}}}async function a0(){Uh||(await Ki(tE),Uh=!0)}async function Cw(){await bp(),await a0()}const Pw=10,cE=10;async function Ew(t,e){let n=t;const i=[];let r=null,s=0,a=t;function o(l){if(i.length>0&&l-s>=1e3/cE){for(;i.length>0;){const c=i.shift();n=i2(n,c)}a=n,s=l,Ar&&Zi.update(c=>({...c,result:n}))}Ar&&(r=requestAnimationFrame(o))}for(r=requestAnimationFrame(o),await new Promise((l,c)=>{$P(aE,u=>{u.result&&i.push(u.result)},()=>l(),u=>c(u))});i.length>0;){const l=i.shift();n=i2(n,l)}return a=n,r!==null&&cancelAnimationFrame(r),a}async function uE(t,e,n,i,r){Je(Gu).initialized||await bp(),i&&r?E8(i,r):I8(),Ar=!0;const a=is.get().ghostTraces;Zi.update(o=>({...o,phase:"starting",progress:mw.STARTING_SIMULATION,error:null,result:a>0?lE(o.result):o.result,resultHistory:Nw(o.result,o.resultHistory,a)}));try{await Ki(Sw),Uh=!1,await a0();const o=nE(t);await Ki(o),await Ki(Aw(e,Pw)),Zi.update(c=>({...c,phase:"running"})),ri.info("Streaming simulation started");const l=await Ew(null,n);return await Ki(Ru),await Ki(kw),Zi.update(c=>!Ar&&c.result===null?c:{...c,phase:Ar?"complete":"idle",progress:Ar?Lc.COMPLETE:Lc.STOPPED,result:l}),Ar&&ri.info(HP.SIMULATION_COMPLETED),l}catch(o){const l=o instanceof Error?o.message:String(o);ri.error(`Streaming simulation failed: ${l}`);try{await Ki(Ru)}catch{}throw Zi.update(c=>({...c,phase:"error",error:l})),o}finally{Ar=!1}}async function dE(t,e){if(!Je(Gu).initialized)throw new Error("No simulation to continue. Run a simulation first.");await a0(),Ar=!0,Zi.update(i=>({...i,phase:"starting",progress:"Continuing simulation...",error:null,resultHistory:Nw(i.result,i.resultHistory,is.get().ghostTraces)}));try{await Ki(`
if 'sim' not in dir() or sim is None:
    raise RuntimeError("No simulation to continue. Run a simulation first.")
		`);const i=uw();i&&(await Ki(i),ri.info("Applied graph mutations")),await Ki(Aw(t,Pw,!1)),Zi.update(a=>({...a,phase:"running"})),ri.info("Continuing simulation (streaming)...");const r=Je(Zi).result,s=await Ew(r,e);return await Ki(Ru),Zi.update(a=>!Ar&&a.result===null?a:{...a,phase:Ar?"complete":"idle",progress:Ar?Lc.COMPLETE:Lc.STOPPED,result:s}),Ar&&ri.info("Simulation continued successfully"),s}catch(i){const r=i instanceof Error?i.message:String(i);ri.error(`Continue simulation failed: ${r}`);try{await Ki(Ru)}catch{}throw Zi.update(s=>({...s,phase:"error",error:r})),i}finally{Ar=!1}}async function fE(){const t=uw();return t?(Ar?(eE(t),ri.info("Staged changes (applied during streaming)")):(await Ki(t),ri.info("Staged changes applied")),!0):!1}async function Iw(){if(_w(),Ar=!1,Zi.reset(),Je(Gu).initialized)try{await Ki(Ru,Ts.VALIDATION),await Ki(Sw)}catch{}Uh=!1}async function hE(t,e){Je(Gu).initialized||await Cw();try{const i=t2(t);await Ki(iE(i),Ts.VALIDATION);const r=t2(JSON.stringify(e));await Ki(rE(r),Ts.VALIDATION);const s=await QP(sE,Ts.VALIDATION);return await Ki(kw),s}catch(i){return{valid:!1,errors:[{nodeId:"__validation__",param:"",error:i instanceof Error?i.message:String(i)}]}}}async function r2(){if(_w(),Ar=!1,Zi.update(e=>({...e,phase:"idle",progress:Lc.STOPPED,error:null})),!!Je(Gu).initialized)try{await Ki(Ru,Ts.VALIDATION),await Ki(`
if 'sim' in dir() and sim is not None:
    sim.stop()
		`,Ts.VALIDATION)}catch{}}function pE(t){Zi.update(e=>({...e,resultHistory:e.resultHistory.slice(0,t)}))}const Vm={lineStyle:"solid",markerStyle:null},Wh={xAxisScale:"linear",yAxisScale:"linear",showLegend:!1},Lw={traces:{},blocks:{}},mc=ln({...Lw}),kr={subscribe:mc.subscribe,getTraceSettings(t){return Je(mc).traces[t]??{...Vm}},getBlockSettings(t){return Je(mc).blocks[t]??{...Wh}},setTraceSettings(t,e){mc.update(n=>{const i=n.traces[t]??{...Vm};return{...n,traces:{...n.traces,[t]:{...i,...e}}}})},setBlockSettings(t,e){mc.update(n=>{const i=n.blocks[t]??{...Wh};return{...n,blocks:{...n.blocks,[t]:{...i,...e}}}})},setTraceLineStyle(t,e){this.setTraceSettings(t,{lineStyle:e})},setTraceMarkerStyle(t,e){this.setTraceSettings(t,{markerStyle:e})},setBlockXAxisScale(t,e){this.setBlockSettings(t,{xAxisScale:e})},setBlockYAxisScale(t,e){this.setBlockSettings(t,{yAxisScale:e})},setBlockShowLegend(t,e){this.setBlockSettings(t,{showLegend:e})},reset(){mc.set({...Lw})},get(){return Je(mc)}};function Gm(t,e){return`${t}-${e}`}const gE=15,mE=400,Ig=.5,vE=.2;function yE(t,e){if(e<=1)return Ig;const n=Ig-vE;return Ig-t/(e-1)*n}const s2=["#E57373","#81C784","#64B5F6","#BA68C8","#4DD0E1","#FFB74D","#F06292","#4DB6AC","#90A4AE"];function Mw(t,e){return t===0?e:s2[(t-1)%s2.length]}function Tw(){return typeof document>"u"?"#0070C0":getComputedStyle(document.documentElement).getPropertyValue("--accent").trim()||"#0070C0"}const bE={solid:"solid",dash:"dash",dot:"dot"},Dw={solid:"",dash:"6,3",dot:"2,2"},wE={circle:"circle",square:"square","triangle-up":"triangle-up"},Ow=224,Fw=96,Rw=8;function xE(t,e,n=mE){const i=t.length;if(i===0)return{x:[],y:[],xMin:0,xMax:1,yMin:0,yMax:1};if(i<=n*2){let f=e[0],p=e[0];for(let d=1;d<i;d++)e[d]<f&&(f=e[d]),e[d]>p&&(p=e[d]);return{x:t,y:e,xMin:t[0],xMax:t[i-1],yMin:f,yMax:p}}const r=i/n,s=[],a=[];let o=1/0,l=-1/0;for(let f=0;f<n;f++){const p=Math.floor(f*r),d=Math.floor((f+1)*r);let y=p,m=p,w=e[p],b=e[p];for(let S=p+1;S<d&&S<i;S++)e[S]<w&&(w=e[S],y=S),e[S]>b&&(b=e[S],m=S);y<=m?(s.push(t[y]),a.push(e[y]),m!==y&&(s.push(t[m]),a.push(e[m]))):(s.push(t[m]),a.push(e[m]),s.push(t[y]),a.push(e[y])),w<o&&(o=w),b>l&&(l=b)}const c=t[i-1],u=e[i-1];return s[s.length-1]!==c&&(s.push(c),a.push(u)),{x:s,y:a,xMin:t[0],xMax:t[i-1],yMin:o,yMax:l}}function _E(t){let e=1/0,n=-1/0,i=1/0,r=-1/0;for(const{x:s,y:a}of t)for(let o=0;o<s.length;o++)s[o]<e&&(e=s[o]),s[o]>n&&(n=s[o]),a[o]<i&&(i=a[o]),a[o]>r&&(r=a[o]);return isFinite(e)||(e=0),isFinite(n)||(n=1),isFinite(i)||(i=0),isFinite(r)||(r=1),{xMin:e,xMax:n,yMin:i,yMax:r}}function a2(t){return t>=1e6?(t/1e6).toFixed(1)+"M":t>=1e3?(t/1e3).toFixed(1)+"k":t>=1?t.toFixed(1):t.toExponential(1)}function lu(t){return typeof document>"u"?"":getComputedStyle(document.documentElement).getPropertyValue(t).trim()}function o2(t,e){if(e==="scope"){const n=t;return{x:n.time||[],ys:n.signals||[],labels:n.labels}}else{const n=t;return{x:n.frequency?Array.from({length:n.frequency.length},(r,s)=>s):[],ys:n.magnitude||[],labels:n.labels}}}function l2(t,e,n,i,r,s,a){const o=Mw(t,s),l={lineStyle:r.lineStyle,markerStyle:r.markerStyle,color:o,visible:r.lineStyle!==null||r.markerStyle!==null};if(!l.visible)return null;const c=xE(e,n);return{signalIndex:t,label:i,x:e,y:n,xDecimated:c.x,yDecimated:c.y,style:l,ghost:a}}function c2(t){const{nodeId:e,type:n,title:i,data:r,ghostData:s,getTraceSettings:a,blockSettings:o,accentColor:l}=t,c=[],u=[],f=s.length;for(let y=f-1;y>=0;y--){const m=s[y];if(!m)continue;const{x:w,ys:b,labels:S}=o2(m,n);if(w.length===0)continue;const A=yE(y,f);for(let _=0;_<b.length;_++){const I=b[_];if(!I||I.length===0)continue;const E=S?.[_]??`port ${_}`,M=a(_),T=l2(_,w,I,E,M,l,{index:y,total:f,opacity:A});T&&(c.push(T),u.push({x:w,y:I}))}}if(r){const{x:y,ys:m,labels:w}=o2(r,n);if(y.length>0)for(let b=0;b<m.length;b++){const S=m[b];if(!S||S.length===0)continue;const A=w?.[b]??`port ${b}`,_=a(b),I=l2(b,y,S,A,_,l,null);I&&(c.push(I),u.push({x:y,y:S}))}}const p=_E(u);let d;return n==="spectrum"&&r&&(d=r.frequency),{nodeId:e,type:n,title:i,traces:c,layout:{xAxisScale:o.xAxisScale,yAxisScale:o.yAxisScale,showLegend:o.showLegend},bounds:p,frequencies:d}}function SE(t){const{fps:e,name:n="RenderQueue"}=t,i=1e3/e,r=new Map;let s=null,a=0,o=!0;function l(){o=document.visibilityState==="visible",o&&r.size>0&&s===null&&c()}typeof document<"u"&&document.addEventListener("visibilitychange",l);function c(){s===null&&(s=requestAnimationFrame(u))}function u(f){if(s=null,!o||r.size===0)return;if(f-a<i){c();return}a=f;const p=Array.from(r.values());r.clear();for(const d of p)try{d()}catch(y){console.error(`[${n}] Task error:`,y)}r.size>0&&c()}return{enqueue(f,p){r.set(f,p),o&&c()},cancel(f){r.delete(f)},isVisible(){return o},destroy(){s!==null&&(cancelAnimationFrame(s),s=null),r.clear(),typeof document<"u"&&document.removeEventListener("visibilitychange",l)}}}const kE=SE({fps:gE,name:"PlotRenderQueue"}),vd=ln({plots:new Map,isStreaming:!1,lastUpdateTime:0}),AE=Symbol("plotDataStore");function NE(t,e,n){const i=new Map;if(!t)return i;const r=Tw(),s=(o,l)=>t.nodeNames?.[o]||l,a=(o,l)=>e.slice(0,n).map(u=>l==="scope"?u.scopeData?.[o]:u.spectrumData?.[o]).filter(u=>u!=null);if(t.scopeData)for(const[o,l]of Object.entries(t.scopeData)){const c=c2({nodeId:o,type:"scope",title:s(o,"Scope"),data:l,ghostData:a(o,"scope"),getTraceSettings:u=>kr.getTraceSettings(Gm(o,u)),blockSettings:kr.getBlockSettings(o),accentColor:r});i.set(o,c)}if(t.spectrumData)for(const[o,l]of Object.entries(t.spectrumData)){Je(kr).blocks[o]||kr.setBlockYAxisScale(o,"log");const u=c2({nodeId:o,type:"spectrum",title:s(o,"Spectrum"),data:l,ghostData:a(o,"spectrum"),getTraceSettings:f=>kr.getTraceSettings(Gm(o,f)),blockSettings:kr.getBlockSettings(o),accentColor:r});i.set(o,u)}return i}let u2=null,d2=[],f2=0;function o0(){kE.enqueue(AE,()=>{const t=Je(Zi),n=Je(is).ghostTraces??0,i=NE(t.result,t.resultHistory,n);vd.set({plots:i,isStreaming:t.phase==="running",lastUpdateTime:Date.now()})})}Zi.subscribe(t=>{(t.result!==u2||t.resultHistory!==d2)&&(u2=t.result,d2=t.resultHistory,o0())});is.subscribe(t=>{(t.ghostTraces??0)!==f2&&(f2=t.ghostTraces??0,o0())});kr.subscribe(()=>{o0()});const wp={subscribe:vd.subscribe,getPlot(t){return Je(vd).plots.get(t)},getAllPlots(){return Array.from(Je(vd).plots.values())},isStreaming(){return Je(vd).isStreaming}},Fn=10,vs={unit:Fn,x2:Fn*2,x4:Fn*4,x10:Fn*10,px:t=>t*Fn},CE=[Fn,Fn],PE=vs.x2,Nd={baseWidth:vs.px(8),baseHeight:vs.x4,portSpacing:vs.x2},EE=vs.x4,yd={columnWidth:vs.x4,rowHeight:vs.x4};function Of(t){return Math.ceil(t/vs.x2)*vs.x2}function IE(t,e){return e<=0||e===1?0:-((e-1)*Nd.portSpacing)/2+t*Nd.portSpacing}function Ol(t,e){const n=IE(t,e);return n===0?"50%":`calc(50% + ${n}px)`}const LE=14;function ME(t,e,n,i,r,s,a,o,l){const c=r===1||r===3,u=Math.max(e,n),f=Math.max(1,u)*Nd.portSpacing,p=i>0?7+24*i:0,d=i>0?160:0,y=s?s.length*5+20:0,m=l?Of(l.width+24):t.length*6+20;let w=Of(Math.max(Nd.baseWidth,m,y,d,c?f:0)),b;l&&l.height>LE*1.2?b=l.height+24+p:b=Nd.baseHeight+p;let S=w,A=Of(c?b:Math.max(b,f));return c?(a&&(A+=yd.rowHeight),o&&(A+=yd.rowHeight)):(a&&(S+=yd.columnWidth),o&&(S+=yd.columnWidth)),{width:S,height:A}}function TE(t,e){const n=t.params?._showInputLabels??e,i=t.params?._showOutputLabels??e;return{inputs:n&&t.inputs.length>0,outputs:i&&t.outputs.length>0}}function Ff(t,e=5){return t.length>e?t.slice(0,e):t}let Rf=null;async function l0(){return Rf||(Rf=await hs(()=>import("./XbL3y5x-.js"),[],import.meta.url),Rf)}function c0(){return"https://cdn.jsdelivr.net/npm/katex@0.16.9/dist/katex.min.css"}const ph=new Map;function Bw(t){return/\$[^$\n]+\$/.test(t)}async function DE(t){if(!t?.trim())return{html:"",hasMath:!1};const e=ph.get(t);if(e)return e;if(!Bw(t)){const a={html:p2(t),hasMath:!1};return ph.set(t,a),a}const n=await l0();let i=!1;const s={html:t.replace(/\$([^$\n]+)\$/g,(a,o)=>{i=!0;try{return n.default.renderToString(o.trim(),{displayMode:!1,throwOnError:!1,strict:!1,output:"html"})}catch{return`<code class="math-error">${p2(o)}</code>`}}),hasMath:i};return ph.set(t,s),s}function OE(t){return ph.get(t)??null}function h2(t){const e=document.createElement("span");e.style.cssText=`
		position: absolute;
		visibility: hidden;
		white-space: nowrap;
		font-size: 10px;
		font-weight: 600;
		font-family: system-ui, -apple-system, sans-serif;
		letter-spacing: -0.2px;
	`,e.innerHTML=t,document.body.appendChild(e);const n={width:Math.ceil(e.scrollWidth),height:Math.ceil(e.scrollHeight)};return document.body.removeChild(e),n}function p2(t){return t.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;")}const FE=1e-10;function g2(t,e){return e==="log"?Math.log10(Math.max(t,FE)):t}function m2(t,e,n){if(n==="log"){const r=t>0?t:1,s=Math.max(e,r),a=Math.log10(r),o=Math.log10(s),l=o-a||1;return{scaledMin:a,scaledMax:o,range:l}}const i=e-t||1;return{scaledMin:t,scaledMax:e,range:i}}function RE(t,e=Ow,n=Fw,i=Rw){const{traces:r,bounds:s,layout:a}=t;if(r.length===0)return[];const{xMin:o,xMax:l,yMin:c,yMax:u}=s,f=a.xAxisScale,p=a.yAxisScale,d=m2(o,l,f),y=m2(c,u,p),m=e-i*2,w=n-i*2;return r.map(b=>{const{xDecimated:S,yDecimated:A,style:_,ghost:I}=b,E=[];for(let M=0;M<S.length;M++){const T=S[M],D=A[M];if(f==="log"&&T<=0||p==="log"&&D<=0)continue;const U=g2(T,f),C=g2(D,p),N=i+(U-d.scaledMin)/d.range*m,B=n-i-(C-y.scaledMin)/y.range*w,P=Math.max(i,Math.min(e-i,N)),F=Math.max(i,Math.min(n-i,B)),q=E.length===0?"M":"L";E.push(`${q}${P.toFixed(1)},${F.toFixed(1)}`)}return{d:E.join(" "),color:_.color,opacity:I?.opacity??1,strokeWidth:I?.7:1,dasharray:_.lineStyle?Dw[_.lineStyle]:""}})}var BE=rt('<path fill="none" stroke-linecap="round" stroke-linejoin="round"></path>'),zE=rt('<text text-anchor="middle" class="no-data-text svelte-1i5tbyr" font-size="11" font-family="Inter, sans-serif">No data</text>'),qE=Me('<div class="preview-container svelte-1i5tbyr"><svg class="svelte-1i5tbyr"><rect x="0" y="0" rx="4" class="plot-bg svelte-1i5tbyr"></rect><!></svg></div>');function jE(t,e){Tt(e,!0);const n=Ow,i=Fw,r=Rw;let s=Oe(Rn([]));const a=wp.subscribe(y=>{const m=y.plots.get(e.nodeId);m?J(s,RE(m,n,i,r),!0):J(s,[],!0)});Ei(()=>{a()});const o=ne(()=>()=>h(s).length>0);var l=qE(),c=se(l),u=se(c),f=be(u);{var p=y=>{var m=$e(),w=Ue(m);fn(w,17,()=>h(s),Nn,(b,S)=>{var A=BE();_e(()=>{fe(A,"d",h(S).d),fe(A,"stroke",h(S).color),fe(A,"stroke-width",h(S).strokeWidth),fe(A,"stroke-dasharray",h(S).dasharray),fe(A,"opacity",h(S).opacity)}),j(b,A)}),j(y,m)},d=y=>{var m=zE();_e(()=>{fe(m,"x",n/2),fe(m,"y",i/2+4)}),j(y,m)};ke(f,y=>{h(o)()?y(p):y(d,!1)})}Q(c),Q(l),_e(()=>{fe(c,"width",n),fe(c,"height",i),fe(c,"viewBox",`0 0 ${n} ${i}`),fe(u,"width",n),fe(u,"height",i)}),j(t,l),Dt()}var HE=Me('<link rel="stylesheet"/>'),UE=Me("<div><!></div>"),WE=Me('<div class="selection-glow svelte-1d5s31p"></div>'),VE=Me('<span class="port-label svelte-1d5s31p"> </span>'),GE=Me('<div class="port-labels port-labels-input port-labels-row svelte-1d5s31p"></div>'),XE=Me('<span class="port-label svelte-1d5s31p"> </span>'),YE=Me('<div class="port-labels port-labels-input svelte-1d5s31p"></div>'),KE=Me('<span class="node-name svelte-1d5s31p"><!></span>'),ZE=Me('<span class="node-name svelte-1d5s31p"> </span>'),JE=Me('<span class="node-type svelte-1d5s31p"> </span>'),QE=Me('<div class="pinned-param svelte-1d5s31p"><label class="svelte-1d5s31p"> </label> <input type="text" class="svelte-1d5s31p"/></div>'),$E=Me('<div class="pinned-params svelte-1d5s31p"></div>'),eI=Me('<span class="port-label svelte-1d5s31p"> </span>'),tI=Me('<div class="port-labels port-labels-output port-labels-row svelte-1d5s31p"></div>'),nI=Me('<span class="port-label svelte-1d5s31p"> </span>'),iI=Me('<div class="port-labels port-labels-output svelte-1d5s31p"></div>'),rI=Me('<div><button class="port-btn svelte-1d5s31p" title="Add input">+</button> <button class="port-btn svelte-1d5s31p" title="Remove input">-</button></div>'),sI=Me('<div><button class="port-btn svelte-1d5s31p" title="Add output">+</button> <button class="port-btn svelte-1d5s31p" title="Remove output">-</button></div>'),aI=Me('<div><!> <!> <div class="node-clip svelte-1d5s31p"><!> <div class="node-inner svelte-1d5s31p"><div class="node-content svelte-1d5s31p"><!> <!></div> <!></div> <!></div> <!> <!> <!> <!></div>');function oI(t,e){Tt(e,!0);let n=ct(e,"selected",3,!1);const i=W5(),r=ne(()=>Pi.get(e.data.type)),s=ne(()=>h(r)?.category||"Algebraic"),a=ne(()=>()=>{if(!e.data.pinnedParams?.length||!h(r))return[];const je=new Set(h(r).params.map(tt=>tt.name));return e.data.pinnedParams.filter(tt=>je.has(tt))}),o=ne(()=>h(s)==="Recording");let l=Oe(!1),c=null,u=Oe(!1),f=Oe(!1),p=Oe(!1),d=Oe(!1);const y=dh.subscribe(je=>{J(p,je,!0)}),m=wp.subscribe(je=>{J(d,je.plots.has(e.id),!0)});let w=Oe(!1);const b=r0.subscribe(je=>{J(w,je,!0)}),S=ne(()=>e.data.params?._showInputLabels),A=ne(()=>e.data.params?._showOutputLabels),_=ne(()=>h(S)??h(w)),I=ne(()=>h(A)??h(w)),E=ne(()=>h(_)&&e.data.inputs.length>0),M=ne(()=>h(I)&&e.data.outputs.length>0),T=ne(()=>h(E)||h(M));mn(()=>{(h(_)!==void 0||h(I)!==void 0)&&i(e.id)}),Ei(()=>{y(),m(),b(),c&&clearTimeout(c)}),mn(()=>{h(p)&&h(d)&&J(u,!0)});function D(){h(o)&&(J(l,!0),c=setTimeout(()=>{h(l)&&(J(u,!0),J(f,!0))},300))}function U(){J(l,!1),J(f,!1),c&&(clearTimeout(c),c=null)}const C=ne(()=>Bw(e.data.name));let N=Oe(null),B=Oe(null),P=Oe(null);mn(()=>{if(h(C)){const je=OE(e.data.name);if(je){J(N,je.html,!0);const tt=h2(je.html);J(B,tt.width,!0),J(P,tt.height,!0),i(e.id)}else DE(e.data.name).then(tt=>{J(N,tt.html,!0);const Ft=h2(tt.html);J(B,Ft.width,!0),J(P,Ft.height,!0),i(e.id)})}else J(N,null),J(B,null),J(P,null)});const F=ne(()=>h(r)?.ports.maxInputs===null),q=ne(()=>h(r)?.ports.maxOutputs===null),Z=ne(()=>h(r)?.ports.syncPorts??!1),W=ne(()=>e.data.params?._rotation||0),Y=ne(()=>()=>{switch(h(W)){case 1:return Kt.Top;case 2:return Kt.Right;case 3:return Kt.Bottom;default:return Kt.Left}}),ue=ne(()=>()=>{switch(h(W)){case 1:return Kt.Bottom;case 2:return Kt.Left;case 3:return Kt.Top;default:return Kt.Right}}),le=ne(()=>h(W)===1||h(W)===3),O=ne(()=>()=>{switch(h(W)){case 1:return"bottom";case 2:return"left";case 3:return"top";default:return"right"}}),V=ne(()=>h(a)().length),G=ne(()=>h(C)&&h(B)!==null&&h(P)!==null?{width:h(B),height:h(P)}:null),re=ne(()=>ME(e.data.name,e.data.inputs.length,e.data.outputs.length,h(V),h(W),h(r)?.name,h(E),h(M),h(G))),ae=ne(()=>()=>{if(!h(T))return{columns:void 0,rows:void 0,inputStyle:"",innerStyle:"",outputStyle:""};const je=`${yd.columnWidth}px`;let tt,Ft,nn="",Yt="",Vt="";if(h(le)){const Lt=h(W)===1?"border-bottom":"border-top",Qt=h(W)===1?"border-top":"border-bottom",rn="grid-column: 1;";if(h(E)&&h(M))Ft=`${je} 1fr ${je}`,h(W)===1?(nn=`${rn} grid-row: 1; ${Lt}: 1px solid var(--border);`,Yt=`${rn} grid-row: 2;`,Vt=`${rn} grid-row: 3; ${Qt}: 1px solid var(--border);`):(Vt=`${rn} grid-row: 1; ${Qt}: 1px solid var(--border);`,Yt=`${rn} grid-row: 2;`,nn=`${rn} grid-row: 3; ${Lt}: 1px solid var(--border);`);else if(h(E)){Ft=h(W)===1?`${je} 1fr`:`1fr ${je}`;const Mn=h(W)===1?1:2,Zt=h(W)===1?2:1;nn=`${rn} grid-row: ${Mn}; ${Lt}: 1px solid var(--border);`,Yt=`${rn} grid-row: ${Zt};`}else if(h(M)){Ft=h(W)===1?`1fr ${je}`:`${je} 1fr`;const Mn=h(W)===1?2:1,Zt=h(W)===1?1:2;Vt=`${rn} grid-row: ${Mn}; ${Qt}: 1px solid var(--border);`,Yt=`${rn} grid-row: ${Zt};`}}else{const Lt="grid-row: 1;",Qt=h(W)===0?"border-right":"border-left",rn=h(W)===0?"border-left":"border-right";if(h(E)&&h(M))tt=`${je} 1fr ${je}`,h(W)===0?(nn=`${Lt} grid-column: 1; ${Qt}: 1px solid var(--border);`,Yt=`${Lt} grid-column: 2;`,Vt=`${Lt} grid-column: 3; ${rn}: 1px solid var(--border);`):(Vt=`${Lt} grid-column: 1; ${rn}: 1px solid var(--border);`,Yt=`${Lt} grid-column: 2;`,nn=`${Lt} grid-column: 3; ${Qt}: 1px solid var(--border);`);else if(h(E)){tt=h(W)===0?`${je} 1fr`:`1fr ${je}`;const Mn=h(W)===0?1:2,Zt=h(W)===0?2:1;nn=`${Lt} grid-column: ${Mn}; ${Qt}: 1px solid var(--border);`,Yt=`${Lt} grid-column: ${Zt};`}else if(h(M)){tt=h(W)===0?`1fr ${je}`:`${je} 1fr`;const Mn=h(W)===0?2:1,Zt=h(W)===0?1:2;Vt=`${Lt} grid-column: ${Mn}; ${rn}: 1px solid var(--border);`,Yt=`${Lt} grid-column: ${Zt};`}}return{columns:tt,rows:Ft,inputStyle:nn,innerStyle:Yt,outputStyle:Vt}}),ee=ne(()=>Ia(e.data)),de=ne(()=>e.data.type===_n.INTERFACE),he=ne(()=>h(ee)||h(de));function pe(je){je.stopPropagation(),h(ee)?Fe.drillDown(e.id):ch(e.id)}function ge(je){je.stopPropagation(),It.mutate(()=>Fe.addInputPort(e.id))}const Ee=ne(()=>h(r)?.ports.minInputs??1),Ae=ne(()=>h(r)?.ports.minOutputs??1);function Ye(je){je.stopPropagation(),e.data.inputs.length>h(Ee)&&It.mutate(()=>Fe.removeInputPort(e.id))}function K(je){je.stopPropagation(),It.mutate(()=>Fe.addOutputPort(e.id))}function Re(je){je.stopPropagation(),e.data.outputs.length>h(Ae)&&It.mutate(()=>Fe.removeOutputPort(e.id))}const Qe=ne(()=>()=>h(r)?Y5(h(r)):"shape-default"),Be=ne(()=>e.data.color||"var(--accent)");function Ie(je,tt){It.mutate(()=>Fe.updateNodeParams(e.id,{[je]:tt}))}function lt(je){return je==null?"":typeof je=="object"?JSON.stringify(je):String(je)}function We(je){return je==null?"None":typeof je=="object"?JSON.stringify(je):String(je)}function Ke(){switch(h(W)){case 1:return"top";case 2:return"right";case 3:return"bottom";default:return"left"}}function ht(){switch(h(W)){case 1:return"bottom";case 2:return"left";case 3:return"top";default:return"right"}}function Rt(je,tt){md.set({nodeId:e.id,handleId:tt.id,color:h(Be)}),Wm(tt.name,je.currentTarget,Ke())}function ye(je){md.set(null),Hh()}function qe(je,tt){md.set({nodeId:e.id,handleId:tt.id,color:h(Be)}),Wm(tt.name,je.currentTarget,ht())}function ve(je){md.set(null),Hh()}mn(()=>{n()?Um.set({nodeId:e.id,color:h(Be)}):Um.update(je=>je?.nodeId===e.id?null:je)});var Pe=aI();rp("1d5s31p",je=>{var tt=HE();_e(Ft=>fe(tt,"href",Ft),[c0]),j(je,tt)});let Le;Pe.__dblclick=pe;var it=se(Pe);{var nt=je=>{var tt=UE();let Ft;var nn=se(tt);jE(nn,{get nodeId(){return e.id}}),Q(tt),_e(Yt=>Ft=Xt(tt,1,`plot-preview-popup preview-${Yt??""}`,"svelte-1d5s31p",Ft,{visible:h(f)||h(p)}),[()=>h(O)()]),j(je,tt)};ke(it,je=>{(h(u)||h(p))&&h(d)&&je(nt)})}var _t=be(it,2);{var At=je=>{var tt=WE();j(je,tt)};ke(_t,je=>{n()&&je(At)})}var St=be(_t,2);let st;var Ot=se(St);{var dt=je=>{var tt=$e(),Ft=Ue(tt);{var nn=Vt=>{var Lt=GE();fn(Lt,21,()=>e.data.inputs,Nn,(Qt,rn,Mn)=>{var Zt=VE(),Qn=se(Zt,!0);Q(Zt),_e((En,Wn)=>{An(Zt,`left: ${En??""};`),Wt(Qn,Wn)},[()=>Ol(Mn,e.data.inputs.length),()=>Ff(h(rn).name)]),j(Qt,Zt)}),Q(Lt),_e(Qt=>An(Lt,Qt),[()=>h(ae)().inputStyle]),j(Vt,Lt)},Yt=Vt=>{var Lt=YE();fn(Lt,21,()=>e.data.inputs,Nn,(Qt,rn,Mn)=>{var Zt=XE(),Qn=se(Zt,!0);Q(Zt),_e((En,Wn)=>{An(Zt,`top: ${En??""};`),Wt(Qn,Wn)},[()=>Ol(Mn,e.data.inputs.length),()=>Ff(h(rn).name)]),j(Qt,Zt)}),Q(Lt),_e(Qt=>An(Lt,Qt),[()=>h(ae)().inputStyle]),j(Vt,Lt)};ke(Ft,Vt=>{h(le)?Vt(nn):Vt(Yt,!1)})}j(je,tt)};ke(Ot,je=>{h(E)&&je(dt)})}var bt=be(Ot,2),ot=se(bt),vt=se(ot);{var jt=je=>{var tt=KE(),Ft=se(tt);_1(Ft,()=>h(N)),Q(tt),j(je,tt)},kt=je=>{var tt=ZE(),Ft=se(tt,!0);Q(tt),_e(()=>Wt(Ft,e.data.name)),j(je,tt)};ke(vt,je=>{h(N)?je(jt):je(kt,!1)})}var gt=be(vt,2);{var Gt=je=>{var tt=JE(),Ft=se(tt,!0);Q(tt),_e(()=>Wt(Ft,h(r).name)),j(je,tt)};ke(gt,je=>{h(r)&&je(Gt)})}Q(ot);var oi=be(ot,2);{var bn=je=>{var tt=$E();tt.__click=Ft=>Ft.stopPropagation(),tt.__dblclick=Ft=>Ft.stopPropagation(),fn(tt,21,()=>h(a)(),Nn,(Ft,nn)=>{const Yt=ne(()=>h(r).params.find(rn=>rn.name===h(nn)));var Vt=$e(),Lt=Ue(Vt);{var Qt=rn=>{var Mn=QE(),Zt=se(Mn),Qn=se(Zt,!0);Q(Zt);var En=be(Zt,2);Br(En),En.__input=Wn=>Ie(h(nn),Wn.currentTarget.value),En.__mousedown=Wn=>Wn.stopPropagation(),wt(En,Wn=>$s?.(Wn)),Q(Mn),_e((Wn,Bs)=>{fe(Zt,"for",`pinned-${e.id??""}-${h(nn)??""}`),Wt(Qn,h(nn)),fe(En,"id",`pinned-${e.id??""}-${h(nn)??""}`),ps(En,Wn),fe(En,"placeholder",Bs)},[()=>lt(e.data.params[h(nn)]),()=>We(h(Yt).default)]),yn("focus",En,Wn=>Wn.stopPropagation()),j(rn,Mn)};ke(Lt,rn=>{h(Yt)&&rn(Qt)})}j(Ft,Vt)}),Q(tt),j(je,tt)};ke(oi,je=>{h(a)().length>0&&h(r)&&je(bn)})}Q(bt);var Cn=be(bt,2);{var li=je=>{var tt=$e(),Ft=Ue(tt);{var nn=Vt=>{var Lt=tI();fn(Lt,21,()=>e.data.outputs,Nn,(Qt,rn,Mn)=>{var Zt=eI(),Qn=se(Zt,!0);Q(Zt),_e((En,Wn)=>{An(Zt,`left: ${En??""};`),Wt(Qn,Wn)},[()=>Ol(Mn,e.data.outputs.length),()=>Ff(h(rn).name)]),j(Qt,Zt)}),Q(Lt),_e(Qt=>An(Lt,Qt),[()=>h(ae)().outputStyle]),j(Vt,Lt)},Yt=Vt=>{var Lt=iI();fn(Lt,21,()=>e.data.outputs,Nn,(Qt,rn,Mn)=>{var Zt=nI(),Qn=se(Zt,!0);Q(Zt),_e((En,Wn)=>{An(Zt,`top: ${En??""};`),Wt(Qn,Wn)},[()=>Ol(Mn,e.data.outputs.length),()=>Ff(h(rn).name)]),j(Qt,Zt)}),Q(Lt),_e(Qt=>An(Lt,Qt),[()=>h(ae)().outputStyle]),j(Vt,Lt)};ke(Ft,Vt=>{h(le)?Vt(nn):Vt(Yt,!1)})}j(je,tt)};ke(Cn,je=>{h(M)&&je(li)})}Q(St);var Bt=be(St,2);{var Jn=je=>{var tt=rI();let Ft;var nn=se(tt);nn.__click=ge,nn.__dblclick=Vt=>Vt.stopPropagation();var Yt=be(nn,2);Yt.__click=Ye,Yt.__dblclick=Vt=>Vt.stopPropagation(),Q(tt),_e(()=>{Ft=Xt(tt,1,"port-controls port-controls-input svelte-1d5s31p",null,Ft,{"port-controls-left":h(W)===0,"port-controls-top":h(W)===1,"port-controls-right":h(W)===2,"port-controls-bottom":h(W)===3}),Yt.disabled=e.data.inputs.length<=h(Ee)}),j(je,tt)};ke(Bt,je=>{h(F)&&n()&&je(Jn)})}var qn=be(Bt,2);{var Pn=je=>{var tt=sI();let Ft;var nn=se(tt);nn.__click=K,nn.__dblclick=Vt=>Vt.stopPropagation();var Yt=be(nn,2);Yt.__click=Re,Yt.__dblclick=Vt=>Vt.stopPropagation(),Q(tt),_e(()=>{Ft=Xt(tt,1,"port-controls port-controls-output svelte-1d5s31p",null,Ft,{"port-controls-right":h(W)===0,"port-controls-bottom":h(W)===1,"port-controls-left":h(W)===2,"port-controls-top":h(W)===3}),Yt.disabled=e.data.outputs.length<=h(Ae)}),j(je,tt)};ke(qn,je=>{h(q)&&n()&&!h(Z)&&je(Pn)})}var jn=be(qn,2);Q0(jn,()=>`${h(W)}-${e.data.inputs.length}`,je=>{var tt=$e(),Ft=Ue(tt);fn(Ft,17,()=>e.data.inputs,Nn,(nn,Yt,Vt)=>{{let Lt=ne(()=>h(Y)()),Qt=ne(()=>h(le)?`left: ${Ol(Vt,e.data.inputs.length)};`:`top: ${Ol(Vt,e.data.inputs.length)};`);Du(nn,{type:"target",get position(){return h(Lt)},get id(){return h(Yt).id},get style(){return h(Qt)},class:"handle handle-input",onmouseenter:rn=>Rt(rn,h(Yt)),onmouseleave:()=>ye(h(Yt))})}}),j(je,tt)});var wn=be(jn,2);Q0(wn,()=>`${h(W)}-${e.data.outputs.length}`,je=>{var tt=$e(),Ft=Ue(tt);fn(Ft,17,()=>e.data.outputs,Nn,(nn,Yt,Vt)=>{{let Lt=ne(()=>h(ue)()),Qt=ne(()=>h(le)?`left: ${Ol(Vt,e.data.outputs.length)};`:`top: ${Ol(Vt,e.data.outputs.length)};`);Du(nn,{type:"source",get position(){return h(Lt)},get id(){return h(Yt).id},get style(){return h(Qt)},class:"handle handle-output",onmouseenter:rn=>qe(rn,h(Yt)),onmouseleave:()=>ve(h(Yt))})}}),j(je,tt)}),Q(Pe),_e((je,tt,Ft)=>{Le=Xt(Pe,1,`node ${je??""}`,"svelte-1d5s31p",Le,{selected:n(),vertical:h(le),"preview-hovered":h(f),"subsystem-type":h(he),"show-labels":h(T)}),fe(Pe,"data-rotation",h(W)),An(Pe,`width: ${h(re).width??""}px; height: ${h(re).height??""}px; --node-color: ${h(Be)??""};`),st=An(St,"",st,tt),An(bt,Ft)},[()=>h(Qe)(),()=>({"grid-template-columns":h(ae)().columns,"grid-template-rows":h(ae)().rows}),()=>h(ae)().innerStyle]),yn("mouseenter",Pe,D),yn("mouseleave",Pe,U),j(t,Pe),Dt()}Kn(["dblclick","click","input","mousedown"]);const ld=ln(null),u0={subscribe:ld.subscribe,open(t){ld.set(t)},close(){ld.set(null)},isOpen(){return Je(ld)!==null},getOpenId(){return Je(ld)}},zw=t=>u0.open(t),Lg=()=>u0.close();var lI=Me('<span class="event-type svelte-7puem2"> </span>'),cI=Me('<div><div class="diamond svelte-7puem2"><div class="diamond-inner svelte-7puem2"><span class="event-name svelte-7puem2"> </span> <!></div></div></div>');function uI(t,e){Tt(e,!0);let n=ct(e,"selected",3,!1);const i=ne(()=>oa.get(e.data.type)),r=ne(()=>e.data.color||"var(--accent)");function s(y){y.stopPropagation(),zw(e.id)}var a=cI();let o;a.__dblclick=s;var l=se(a);l.__dblclick=s;var c=se(l),u=se(c),f=se(u,!0);Q(u);var p=be(u,2);{var d=y=>{var m=lI(),w=se(m,!0);Q(m),_e(()=>Wt(w,h(i).name)),j(y,m)};ke(p,y=>{h(i)&&y(d)})}Q(c),Q(l),Q(a),_e(()=>{o=Xt(a,1,"event-node svelte-7puem2",null,o,{selected:n()}),An(a,`--event-color: ${h(r)??""};`),Wt(f,e.data.name)}),j(t,a),Dt()}Kn(["dblclick"]);async function dI(t){if(!t?.trim())return"";const e=await l0(),n=[];let i=t.replace(/\$\$([\s\S]*?)\$\$/g,(r,s)=>{const a=`%%MATH_BLOCK_${n.length}%%`;try{n.push(e.default.renderToString(s.trim(),{displayMode:!0,throwOnError:!1,strict:!1}))}catch{n.push(`<code class="math-error">${v2(s)}</code>`)}return a});return i=i.replace(/\$([^\$\n]+?)\$/g,(r,s)=>{const a=`%%MATH_BLOCK_${n.length}%%`;try{n.push(e.default.renderToString(s.trim(),{displayMode:!1,throwOnError:!1,strict:!1}))}catch{n.push(`<code class="math-error">${v2(s)}</code>`)}return a}),i=fI(i),n.forEach((r,s)=>{i=i.replace(`%%MATH_BLOCK_${s}%%`,r)}),i}function fI(t){let e=t.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;");return e=e.replace(/%%MATH_BLOCK_(\d+)%%/g,"%%MATH_BLOCK_$1%%"),e=e.replace(/```(\w*)\n([\s\S]*?)```/g,(n,i,r)=>`<pre><code>${r.trim()}</code></pre>`),e=e.replace(/^### (.*)$/gm,"<h3>$1</h3>"),e=e.replace(/^## (.*)$/gm,"<h2>$1</h2>"),e=e.replace(/^# (.*)$/gm,"<h1>$1</h1>"),e=e.replace(/^([-*_]){3,}\s*$/gm,"<hr>"),e=e.replace(/^&gt; (.*)$/gm,"<blockquote>$1</blockquote>"),e=e.replace(/<\/blockquote>\n<blockquote>/g,`
`),e=e.replace(/^[-*] (.*)$/gm,"<li>$1</li>"),e=e.replace(/((?:<li>.*<\/li>\n?)+)/g,"<ul>$1</ul>"),e=e.replace(/^\d+\. (.*)$/gm,"<oli>$1</oli>"),e=e.replace(/((?:<oli>.*<\/oli>\n?)+)/g,n=>"<ol>"+n.replace(/<\/?oli>/g,i=>i.replace("oli","li"))+"</ol>"),e=e.replace(/\*\*\*(.+?)\*\*\*/g,"<strong><em>$1</em></strong>"),e=e.replace(/\*\*(.+?)\*\*/g,"<strong>$1</strong>"),e=e.replace(new RegExp("(?<![<])\\*([^*\\n]+?)\\*(?![>])","g"),"<em>$1</em>"),e=e.replace(/`([^`]+)`/g,"<code>$1</code>"),e=e.replace(/\[([^\]]+)\]\(([^)]+)\)/g,'<a href="$2" target="_blank" rel="noopener">$1</a>'),e=e.split(/\n\n+/).map(n=>n.trim()).filter(n=>n.length>0).map(n=>/^<(h[1-6]|ul|ol|blockquote|pre|hr)/.test(n)?n:`<p>${n.replace(/\n/g,"<br>")}</p>`).join(""),e}function v2(t){return t.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;")}var hI=rt('<svg width="8" height="8" viewBox="0 0 24 24" fill="none" stroke-width="4"><polyline points="20 6 9 17 4 12"></polyline></svg>'),pI=Me("<button><!></button>"),gI=Me('<div role="dialog" tabindex="-1"><div class="color-grid svelte-10xj43v"></div> <div class="color-custom svelte-10xj43v"><label for="custom-color" class="svelte-10xj43v">CUSTOM:</label> <input id="custom-color" type="color" class="custom-color-input svelte-10xj43v"/></div></div>'),mI=Me('<div class="color-picker-wrapper svelte-10xj43v"><button aria-label="Change color"><svg viewBox="0 0 24 24" fill="none" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="10"></circle><circle cx="8" cy="10" r="1.5"></circle><circle cx="12" cy="7" r="1.5"></circle><circle cx="16" cy="10" r="1.5"></circle><circle cx="15" cy="15" r="2"></circle></svg></button> <!></div>');function d0(t,e){Tt(e,!0);let n=ct(e,"defaultColor",3,rl),i=ct(e,"popupPosition",3,"bottom"),r=ct(e,"tooltipPosition",3,"bottom"),s=ct(e,"iconSize",3,16),a=ct(e,"variant",3,"default"),o=Oe(!1);function l(){J(o,!h(o))}function c(E){E===n()?e.onSelect(void 0):e.onSelect(E),J(o,!1)}function u(E){const M=E.target;e.onSelect(M.value)}function f(E){E.target.closest(".color-picker-wrapper")||J(o,!1)}var p=mI();yn("click",ii,f);var d=se(p);let y;d.__click=l;var m=se(d),w=be(se(m)),b=be(w),S=be(b),A=be(S);Q(m),Q(d),wt(d,(E,M)=>$t?.(E,M),()=>({text:"Color",position:r()}));var _=be(d,2);{var I=E=>{var M=gI();M.__click=C=>C.stopPropagation();var T=se(M);fn(T,21,()=>zC,Nn,(C,N)=>{var B=pI();let P;B.__click=()=>c(h(N));var F=se(B);{var q=Z=>{var W=hI();_e(()=>fe(W,"stroke",h(N)==="#FFFFFF"||h(N)==="#FFF176"?"#333":"#fff")),j(Z,W)};ke(F,Z=>{e.currentColor===h(N)&&Z(q)})}Q(B),_e(()=>{P=Xt(B,1,"color-option svelte-10xj43v",null,P,{selected:e.currentColor===h(N)}),An(B,`background: ${h(N)??""};`),fe(B,"title",h(N)===n()?"Default":h(N))}),j(C,B)}),Q(T);var D=be(T,2),U=be(se(D),2);Br(U),U.__input=u,Q(D),Q(M),_e(()=>{Xt(M,1,`color-picker-popup popup-${i()??""}`,"svelte-10xj43v"),ps(U,e.currentColor)}),j(E,M)};ke(_,E=>{h(o)&&E(I)})}Q(p),_e(()=>{y=Xt(d,1,"picker-btn svelte-10xj43v",null,y,{ghost:a()==="ghost"}),fe(m,"width",s()),fe(m,"height",s()),fe(m,"stroke",e.iconColor||"currentColor"),fe(w,"fill",e.iconColor||"currentColor"),fe(b,"fill",e.iconColor||"currentColor"),fe(S,"fill",e.iconColor||"currentColor"),fe(A,"fill",e.iconColor||"currentColor")}),j(t,p),Dt()}Kn(["click","input"]);var vI=rt('<svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svelte-1aaflua"><polyline points="3 6 5 6 21 6"></polyline><path d="M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6m3 0V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2"></path></svg>'),yI=rt('<svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svelte-1aaflua"><circle cx="12" cy="12" r="3"></circle><path d="M19.4 15a1.65 1.65 0 0 0 .33 1.82l.06.06a2 2 0 0 1 0 2.83 2 2 0 0 1-2.83 0l-.06-.06a1.65 1.65 0 0 0-1.82-.33 1.65 1.65 0 0 0-1 1.51V21a2 2 0 0 1-2 2 2 2 0 0 1-2-2v-.09A1.65 1.65 0 0 0 9 19.4a1.65 1.65 0 0 0-1.82.33l-.06.06a2 2 0 0 1-2.83 0 2 2 0 0 1 0-2.83l.06-.06a1.65 1.65 0 0 0 .33-1.82 1.65 1.65 0 0 0-1.51-1H3a2 2 0 0 1-2-2 2 2 0 0 1 2-2h.09A1.65 1.65 0 0 0 4.6 9a1.65 1.65 0 0 0-.33-1.82l-.06-.06a2 2 0 0 1 0-2.83 2 2 0 0 1 2.83 0l.06.06a1.65 1.65 0 0 0 1.82.33H9a1.65 1.65 0 0 0 1-1.51V3a2 2 0 0 1 2-2 2 2 0 0 1 2 2v.09a1.65 1.65 0 0 0 1 1.51 1.65 1.65 0 0 0 1.82-.33l.06-.06a2 2 0 0 1 2.83 0 2 2 0 0 1 0 2.83l-.06.06a1.65 1.65 0 0 0-.33 1.82V9a1.65 1.65 0 0 0 1.51 1H21a2 2 0 0 1 2 2 2 2 0 0 1-2 2h-.09a1.65 1.65 0 0 0-1.51 1z"></path></svg>'),bI=rt('<svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svelte-1aaflua"><rect x="9" y="9" width="13" height="13" rx="2" ry="2"></rect><path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"></path></svg>'),wI=rt('<svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svelte-1aaflua"><path d="M23 4v6h-6"></path><path d="M20.49 15a9 9 0 1 1-2.12-9.36L23 10"></path></svg>'),xI=rt('<svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svelte-1aaflua"><line x1="12" y1="5" x2="12" y2="19"></line><line x1="5" y1="12" x2="19" y2="12"></line></svg>'),_I=rt('<svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svelte-1aaflua"><path d="M8 3H5a2 2 0 0 0-2 2v3m18 0V5a2 2 0 0 0-2-2h-3m0 18h3a2 2 0 0 0 2-2v-3M3 16v3a2 2 0 0 0 2 2h3"></path></svg>'),SI=rt('<svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svelte-1aaflua"><rect x="3" y="3" width="18" height="18" rx="2" ry="2"></rect><path d="M9 12l2 2 4-4"></path></svg>'),kI=rt('<svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svelte-1aaflua"><path d="M3 7v6h6"></path><path d="M21 17a9 9 0 0 0-9-9 9 9 0 0 0-6 2.3L3 13"></path></svg>'),AI=rt('<svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svelte-1aaflua"><path d="M21 7v6h-6"></path><path d="M3 17a9 9 0 0 1 9-9 9 9 0 0 1 6 2.3L21 13"></path></svg>'),NI=rt('<svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svelte-1aaflua"><path d="M15 3h4a2 2 0 0 1 2 2v14a2 2 0 0 1-2 2h-4"></path><polyline points="10 17 15 12 10 7"></polyline><line x1="15" y1="12" x2="3" y2="12"></line></svg>'),CI=rt('<svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svelte-1aaflua"><path d="M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4"></path><polyline points="16 17 21 12 16 7"></polyline><line x1="21" y1="12" x2="9" y2="12"></line></svg>'),PI=rt('<svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svelte-1aaflua"><polygon points="13 2 3 14 12 14 11 22 21 10 12 10 13 2"></polygon></svg>'),EI=rt('<svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svelte-1aaflua"><rect x="3" y="3" width="7" height="7" rx="1"></rect><rect x="14" y="3" width="7" height="7" rx="1"></rect><rect x="3" y="14" width="7" height="7" rx="1"></rect><rect x="14" y="14" width="7" height="7" rx="1"></rect></svg>'),II=rt('<svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svelte-1aaflua"><polyline points="4 7 4 4 20 4 20 7"></polyline><line x1="9" y1="20" x2="15" y2="20"></line><line x1="12" y1="4" x2="12" y2="20"></line></svg>'),LI=rt('<svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svelte-1aaflua"><line x1="12" y1="17" x2="12" y2="22"></line><path d="M5 17h14v-1.76a2 2 0 0 0-1.11-1.79l-1.78-.9A2 2 0 0 1 15 10.76V6h1a2 2 0 0 0 0-4H8a2 2 0 0 0 0 4h1v4.76a2 2 0 0 1-1.11 1.79l-1.78.9A2 2 0 0 0 5 15.24Z"></path></svg>'),MI=rt('<svg viewBox="0 0 24 24" fill="currentColor" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svelte-1aaflua"><line x1="12" y1="17" x2="12" y2="22"></line><path d="M5 17h14v-1.76a2 2 0 0 0-1.11-1.79l-1.78-.9A2 2 0 0 1 15 10.76V6h1a2 2 0 0 0 0-4H8a2 2 0 0 0 0 4h1v4.76a2 2 0 0 1-1.11 1.79l-1.78.9A2 2 0 0 0 5 15.24Z"></path></svg>'),TI=rt('<svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svelte-1aaflua"><line x1="18" y1="6" x2="6" y2="18"></line><line x1="6" y1="6" x2="18" y2="18"></line></svg>'),DI=rt('<svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svelte-1aaflua"><polyline points="20 6 9 17 4 12"></polyline></svg>'),OI=rt('<svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svelte-1aaflua"><circle cx="11" cy="11" r="8"></circle><line x1="21" y1="21" x2="16.65" y2="16.65"></line></svg>'),FI=rt('<svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svelte-1aaflua"><polyline points="6 9 12 15 18 9"></polyline></svg>'),RI=rt('<svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svelte-1aaflua"><polyline points="18 15 12 9 6 15"></polyline></svg>'),BI=rt('<svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svelte-1aaflua"><polyline points="9 18 15 12 9 6"></polyline></svg>'),zI=rt('<svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svelte-1aaflua"><polyline points="15 18 9 12 15 6"></polyline></svg>'),qI=rt('<svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svelte-1aaflua"><path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"></path><polyline points="7 10 12 15 17 10"></polyline><line x1="12" y1="15" x2="12" y2="3"></line></svg>'),jI=rt('<svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svelte-1aaflua"><path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"></path><polyline points="17 8 12 3 7 8"></polyline><line x1="12" y1="3" x2="12" y2="15"></line></svg>'),HI=rt('<svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svelte-1aaflua"><path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"></path><polyline points="17 8 12 3 7 8"></polyline><line x1="12" y1="3" x2="12" y2="15"></line><circle cx="22" cy="3" r="1.5" fill="currentColor" stroke="none"></circle></svg>'),UI=rt('<svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svelte-1aaflua"><polygon points="5 3 19 12 5 21 5 3"></polygon></svg>'),WI=rt('<svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svelte-1aaflua"><rect x="6" y="4" width="4" height="16"></rect><rect x="14" y="4" width="4" height="16"></rect></svg>'),VI=rt('<svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svelte-1aaflua"><rect x="3" y="3" width="18" height="18" rx="2" ry="2"></rect></svg>'),GI=rt('<svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svelte-1aaflua"><path d="M1 12s4-8 11-8 11 8 11 8-4 8-11 8-11-8-11-8z"></path><circle cx="12" cy="12" r="3"></circle></svg>'),XI=rt('<svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svelte-1aaflua"><path d="M17.94 17.94A10.07 10.07 0 0 1 12 20c-7 0-11-8-11-8a18.45 18.45 0 0 1 5.06-5.94M9.9 4.24A9.12 9.12 0 0 1 12 4c7 0 11 8 11 8a18.5 18.5 0 0 1-2.16 3.19m-6.72-1.07a3 3 0 1 1-4.24-4.24"></path><line x1="1" y1="1" x2="23" y2="23"></line></svg>'),YI=rt('<svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svelte-1aaflua"><polyline points="16 18 22 12 16 6"></polyline><polyline points="8 6 2 12 8 18"></polyline></svg>'),KI=rt('<svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svelte-1aaflua"><polyline points="4 17 10 11 4 5"></polyline><line x1="12" y1="19" x2="20" y2="19"></line></svg>'),ZI=rt('<svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svelte-1aaflua"><circle cx="12" cy="12" r="10"></circle><line x1="12" y1="16" x2="12" y2="12"></line><line x1="12" y1="8" x2="12.01" y2="8"></line></svg>'),JI=rt('<svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svelte-1aaflua"><path d="M10.29 3.86L1.82 18a2 2 0 0 0 1.71 3h16.94a2 2 0 0 0 1.71-3L13.71 3.86a2 2 0 0 0-3.42 0z"></path><line x1="12" y1="9" x2="12" y2="13"></line><line x1="12" y1="17" x2="12.01" y2="17"></line></svg>'),QI=rt('<svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svelte-1aaflua"><path d="M22 19a2 2 0 0 1-2 2H4a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h5l2 3h9a2 2 0 0 1 2 2z"></path></svg>'),$I=rt('<svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svelte-1aaflua"><path d="M13 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V9z"></path><polyline points="13 2 13 9 20 9"></polyline></svg>'),eL=rt('<svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svelte-1aaflua"><path d="M19 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h11l5 5v11a2 2 0 0 1-2 2z"></path><polyline points="17 21 17 13 7 13 7 21"></polyline><polyline points="7 3 7 8 15 8"></polyline></svg>'),tL=rt('<svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svelte-1aaflua"><rect x="2" y="4" width="20" height="16" rx="2" ry="2"></rect><path d="M6 8h.001"></path><path d="M10 8h.001"></path><path d="M14 8h.001"></path><path d="M18 8h.001"></path><path d="M8 12h.001"></path><path d="M12 12h.001"></path><path d="M16 12h.001"></path><path d="M7 16h10"></path></svg>'),nL=rt('<svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svelte-1aaflua"><path d="M18 13v6a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h6"></path><polyline points="15 3 21 3 21 9"></polyline><line x1="10" y1="14" x2="21" y2="3"></line></svg>'),iL=rt('<svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svelte-1aaflua"><line x1="3" y1="12" x2="21" y2="12"></line><line x1="3" y1="6" x2="21" y2="6"></line><line x1="3" y1="18" x2="21" y2="18"></line></svg>'),rL=rt('<svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svelte-1aaflua"><path d="M3 9l9-7 9 7v11a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z"></path><polyline points="9 22 9 12 15 12 15 22"></polyline></svg>'),sL=rt('<svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svelte-1aaflua"><path d="M4 19.5A2.5 2.5 0 0 1 6.5 17H20"></path><path d="M6.5 2H20v20H6.5A2.5 2.5 0 0 1 4 19.5v-15A2.5 2.5 0 0 1 6.5 2z"></path></svg>'),aL=rt('<svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svelte-1aaflua"><polygon points="12 2 2 7 12 12 22 7 12 2"></polygon><polyline points="2 17 12 22 22 17"></polyline><polyline points="2 12 12 17 22 12"></polyline></svg>'),oL=rt('<svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svelte-1aaflua"><polyline points="22 12 18 12 15 21 9 3 6 12 2 12"></polyline></svg>'),lL=rt('<svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svelte-1aaflua"><path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"></path><polyline points="14 2 14 8 20 8"></polyline><line x1="12" y1="18" x2="12" y2="12"></line><line x1="9" y1="15" x2="15" y2="15"></line></svg>'),cL=rt('<svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svelte-1aaflua"><line x1="2" y1="5" x2="8" y2="5"></line><line x1="5" y1="2" x2="5" y2="8"></line><path d="M13 5h8v16H5V13"></path></svg>'),uL=rt('<svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svelte-1aaflua"><rect x="2" y="8" width="20" height="8" rx="2"></rect></svg>'),dL=rt('<svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svelte-1aaflua"><circle cx="12" cy="12" r="10"></circle><path d="M9.09 9a3 3 0 0 1 5.83 1c0 2-3 3-3 3"></path><line x1="12" y1="17" x2="12.01" y2="17"></line></svg>'),fL=rt('<svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svelte-1aaflua"><path d="M21 12a9 9 0 1 1-6.219-8.56"></path></svg>'),hL=rt('<svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svelte-1aaflua"><circle cx="12" cy="12" r="5"></circle><line x1="12" y1="1" x2="12" y2="3"></line><line x1="12" y1="21" x2="12" y2="23"></line><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line><line x1="1" y1="12" x2="3" y2="12"></line><line x1="21" y1="12" x2="23" y2="12"></line><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line></svg>'),pL=rt('<svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svelte-1aaflua"><path d="M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"></path></svg>'),gL=rt('<svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svelte-1aaflua"><line x1="18" y1="20" x2="18" y2="10"></line><line x1="12" y1="20" x2="12" y2="4"></line><line x1="6" y1="20" x2="6" y2="14"></line></svg>'),mL=rt('<svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svelte-1aaflua"><rect x="3" y="12" width="4" height="9"></rect><rect x="10" y="8" width="4" height="13"></rect><rect x="17" y="4" width="4" height="17"></rect></svg>'),vL=rt('<svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svelte-1aaflua"><rect x="3" y="3" width="18" height="18" rx="2"></rect><rect x="12" y="12" width="7" height="7" rx="1"></rect></svg>'),yL=rt('<svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svelte-1aaflua"><circle cx="11" cy="11" r="8"></circle><line x1="21" y1="21" x2="16.65" y2="16.65"></line><line x1="11" y1="8" x2="11" y2="14"></line><line x1="8" y1="11" x2="14" y2="11"></line></svg>'),bL=rt('<svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svelte-1aaflua"><circle cx="11" cy="11" r="8"></circle><line x1="21" y1="21" x2="16.65" y2="16.65"></line><line x1="8" y1="11" x2="14" y2="11"></line></svg>'),wL=rt('<svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svelte-1aaflua"><rect x="3" y="3" width="18" height="18" rx="2"></rect></svg>'),xL=rt('<svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svelte-1aaflua"><polygon points="5 4 15 12 5 20 5 4"></polygon><line x1="19" y1="5" x2="19" y2="19"></line></svg>'),_L=rt('<svg viewBox="0 0 24 24" fill="currentColor" stroke="none" class="svelte-1aaflua"><polygon points="5 3 19 12 5 21 5 3"></polygon></svg>'),SL=rt('<svg viewBox="0 0 24 24" fill="currentColor" stroke="none" class="svelte-1aaflua"><rect x="6" y="6" width="12" height="12" rx="1"></rect></svg>'),kL=rt('<svg viewBox="0 0 24 24" fill="currentColor" stroke="none" class="svelte-1aaflua"><path d="M5 4l10 8-10 8V4z"></path><rect x="17" y="5" width="3" height="14" rx="1"></rect></svg>'),AL=rt('<svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svelte-1aaflua"><path d="M12 2v4m0 12v4M4.93 4.93l2.83 2.83m8.48 8.48l2.83 2.83M2 12h4m12 0h4M4.93 19.07l2.83-2.83m8.48-8.48l2.83-2.83"></path></svg>'),NL=rt('<svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svelte-1aaflua"><rect x="8" y="2" width="8" height="4" rx="1" ry="1"></rect><path d="M16 4h2a2 2 0 0 1 2 2v14a2 2 0 0 1-2 2H6a2 2 0 0 1-2-2V6a2 2 0 0 1 2-2h2"></path></svg>'),CL=rt('<svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svelte-1aaflua"><line x1="8" y1="6" x2="21" y2="6"></line><line x1="8" y1="12" x2="21" y2="12"></line><line x1="8" y1="18" x2="21" y2="18"></line><line x1="3" y1="6" x2="3.01" y2="6"></line><line x1="3" y1="12" x2="3.01" y2="12"></line><line x1="3" y1="18" x2="3.01" y2="18"></line></svg>'),PL=rt('<svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svelte-1aaflua"><path d="M8 3H7a2 2 0 0 0-2 2v5a2 2 0 0 1-2 2 2 2 0 0 1 2 2v5a2 2 0 0 0 2 2h1"></path><path d="M16 3h1a2 2 0 0 1 2 2v5a2 2 0 0 0 2 2 2 2 0 0 0-2 2v5a2 2 0 0 1-2 2h-1"></path></svg>'),EL=rt('<svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svelte-1aaflua"><rect x="3" y="3" width="18" height="18" rx="2"></rect><line x1="3" y1="9" x2="21" y2="9"></line><line x1="3" y1="15" x2="21" y2="15"></line><line x1="9" y1="3" x2="9" y2="21"></line></svg>'),IL=rt('<svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svelte-1aaflua"><path d="M20.84 4.61a5.5 5.5 0 0 0-7.78 0L12 5.67l-1.06-1.06a5.5 5.5 0 0 0-7.78 7.78l1.06 1.06L12 21.23l7.78-7.78 1.06-1.06a5.5 5.5 0 0 0 0-7.78z"></path></svg>'),LL=rt('<svg viewBox="0 0 24 24" fill="currentColor" class="svelte-1aaflua"><path d="M12 0c-6.626 0-12 5.373-12 12 0 5.302 3.438 9.8 8.207 11.387.599.111.793-.261.793-.577v-2.234c-3.338.726-4.033-1.416-4.033-1.416-.546-1.387-1.333-1.756-1.333-1.756-1.089-.745.083-.729.083-.729 1.205.084 1.839 1.237 1.839 1.237 1.07 1.834 2.807 1.304 3.492.997.107-.775.418-1.305.762-1.604-2.665-.305-5.467-1.334-5.467-5.931 0-1.311.469-2.381 1.236-3.221-.124-.303-.535-1.524.117-3.176 0 0 1.008-.322 3.301 1.23.957-.266 1.983-.399 3.003-.404 1.02.005 2.047.138 3.006.404 2.291-1.552 3.297-1.23 3.297-1.23.653 1.653.242 2.874.118 3.176.77.84 1.235 1.911 1.235 3.221 0 4.609-2.807 5.624-5.479 5.921.43.372.823 1.102.823 2.222v3.293c0 .319.192.694.801.576 4.765-1.589 8.199-6.086 8.199-11.386 0-6.627-5.373-12-12-12z"></path></svg>'),ML=rt('<svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svelte-1aaflua"><line x1="5" y1="12" x2="19" y2="12"></line><polyline points="12 5 19 12 12 19"></polyline></svg>'),TL=rt('<svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svelte-1aaflua"><line x1="19" y1="12" x2="5" y2="12"></line><polyline points="12 19 5 12 12 5"></polyline></svg>'),DL=rt('<svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svelte-1aaflua"><path d="M21 16V8a2 2 0 0 0-1-1.73l-7-4a2 2 0 0 0-2 0l-7 4A2 2 0 0 0 3 8v8a2 2 0 0 0 1 1.73l7 4a2 2 0 0 0 2 0l7-4A2 2 0 0 0 21 16z"></path><polyline points="3.27 6.96 12 12.01 20.73 6.96"></polyline><line x1="12" y1="22.08" x2="12" y2="12"></line></svg>'),OL=rt('<svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svelte-1aaflua"><path d="M9 3h6"></path><path d="M10 3v6l-5 10h14l-5-10V3"></path></svg>'),FL=rt('<svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svelte-1aaflua"><path d="M19 17h2c.6 0 1-.4 1-1v-3c0-.9-.7-1.7-1.5-1.9C18.7 10.6 16 10 16 10s-1.3-1.4-2.2-2.3c-.5-.4-1.1-.7-1.8-.7H5c-.6 0-1.1.4-1.4.9l-1.5 2.8C1.4 11.3 1 12.1 1 13v3c0 .6.4 1 1 1h2"></path><circle cx="7" cy="17" r="2"></circle><path d="M9 17h6"></path><circle cx="17" cy="17" r="2"></circle></svg>'),RL=rt('<svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svelte-1aaflua"><rect x="3" y="3" width="18" height="18" rx="2" ry="2"></rect><circle cx="8.5" cy="8.5" r="1.5"></circle><polyline points="21 15 16 10 5 21"></polyline></svg>'),BL=rt('<svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svelte-1aaflua"><path d="M20.59 13.41l-7.17 7.17a2 2 0 0 1-2.83 0L2 12V2h10l8.59 8.59a2 2 0 0 1 0 2.82z"></path><line x1="7" y1="7" x2="7.01" y2="7"></line></svg>'),zL=rt('<svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svelte-1aaflua"><polyline points="7 10 12 15 17 10"></polyline><line x1="12" y1="15" x2="12" y2="3"></line><line x1="4" y1="21" x2="20" y2="21"></line></svg>'),qL=rt('<svg viewBox="0 0 24 24" fill="currentColor" stroke="none" class="svelte-1aaflua"><text x="2" y="18" font-size="16" font-weight="700" font-family="system-ui, sans-serif">A</text><text x="14" y="18" font-size="16" font-weight="700" font-family="system-ui, sans-serif">a</text></svg>'),jL=rt('<svg viewBox="0 0 24 24" fill="currentColor" stroke="none" class="svelte-1aaflua"><text x="2" y="18" font-size="11" font-weight="700" font-family="system-ui, sans-serif">A</text><text x="10" y="18" font-size="11" font-weight="700" font-family="system-ui, sans-serif">a</text></svg>'),HL=Me('<span class="text-icon svelte-1aaflua"> </span>');function qt(t,e){let n=ct(e,"size",3,14);var i=$e(),r=Ue(i);{var s=o=>{var l=vI();_e(()=>{fe(l,"width",n()),fe(l,"height",n())}),j(o,l)},a=o=>{var l=$e(),c=Ue(l);{var u=p=>{var d=yI();_e(()=>{fe(d,"width",n()),fe(d,"height",n())}),j(p,d)},f=p=>{var d=$e(),y=Ue(d);{var m=b=>{var S=bI();_e(()=>{fe(S,"width",n()),fe(S,"height",n())}),j(b,S)},w=b=>{var S=$e(),A=Ue(S);{var _=E=>{var M=wI();_e(()=>{fe(M,"width",n()),fe(M,"height",n())}),j(E,M)},I=E=>{var M=$e(),T=Ue(M);{var D=C=>{var N=xI();_e(()=>{fe(N,"width",n()),fe(N,"height",n())}),j(C,N)},U=C=>{var N=$e(),B=Ue(N);{var P=q=>{var Z=_I();_e(()=>{fe(Z,"width",n()),fe(Z,"height",n())}),j(q,Z)},F=q=>{var Z=$e(),W=Ue(Z);{var Y=le=>{var O=SI();_e(()=>{fe(O,"width",n()),fe(O,"height",n())}),j(le,O)},ue=le=>{var O=$e(),V=Ue(O);{var G=ae=>{var ee=kI();_e(()=>{fe(ee,"width",n()),fe(ee,"height",n())}),j(ae,ee)},re=ae=>{var ee=$e(),de=Ue(ee);{var he=ge=>{var Ee=AI();_e(()=>{fe(Ee,"width",n()),fe(Ee,"height",n())}),j(ge,Ee)},pe=ge=>{var Ee=$e(),Ae=Ue(Ee);{var Ye=Re=>{var Qe=NI();_e(()=>{fe(Qe,"width",n()),fe(Qe,"height",n())}),j(Re,Qe)},K=Re=>{var Qe=$e(),Be=Ue(Qe);{var Ie=We=>{var Ke=CI();_e(()=>{fe(Ke,"width",n()),fe(Ke,"height",n())}),j(We,Ke)},lt=We=>{var Ke=$e(),ht=Ue(Ke);{var Rt=qe=>{var ve=PI();_e(()=>{fe(ve,"width",n()),fe(ve,"height",n())}),j(qe,ve)},ye=qe=>{var ve=$e(),Pe=Ue(ve);{var Le=nt=>{var _t=EI();_e(()=>{fe(_t,"width",n()),fe(_t,"height",n())}),j(nt,_t)},it=nt=>{var _t=$e(),At=Ue(_t);{var St=Ot=>{var dt=II();_e(()=>{fe(dt,"width",n()),fe(dt,"height",n())}),j(Ot,dt)},st=Ot=>{var dt=$e(),bt=Ue(dt);{var ot=jt=>{var kt=LI();_e(()=>{fe(kt,"width",n()),fe(kt,"height",n())}),j(jt,kt)},vt=jt=>{var kt=$e(),gt=Ue(kt);{var Gt=bn=>{var Cn=MI();_e(()=>{fe(Cn,"width",n()),fe(Cn,"height",n())}),j(bn,Cn)},oi=bn=>{var Cn=$e(),li=Ue(Cn);{var Bt=qn=>{var Pn=TI();_e(()=>{fe(Pn,"width",n()),fe(Pn,"height",n())}),j(qn,Pn)},Jn=qn=>{var Pn=$e(),jn=Ue(Pn);{var wn=tt=>{var Ft=DI();_e(()=>{fe(Ft,"width",n()),fe(Ft,"height",n())}),j(tt,Ft)},je=tt=>{var Ft=$e(),nn=Ue(Ft);{var Yt=Lt=>{var Qt=OI();_e(()=>{fe(Qt,"width",n()),fe(Qt,"height",n())}),j(Lt,Qt)},Vt=Lt=>{var Qt=$e(),rn=Ue(Qt);{var Mn=Qn=>{var En=FI();_e(()=>{fe(En,"width",n()),fe(En,"height",n())}),j(Qn,En)},Zt=Qn=>{var En=$e(),Wn=Ue(En);{var Bs=or=>{var bs=RI();_e(()=>{fe(bs,"width",n()),fe(bs,"height",n())}),j(or,bs)},vo=or=>{var bs=$e(),zs=Ue(bs);{var Pr=xs=>{var lr=BI();_e(()=>{fe(lr,"width",n()),fe(lr,"height",n())}),j(xs,lr)},ws=xs=>{var lr=$e(),pl=Ue(lr);{var ua=Hi=>{var cr=zI();_e(()=>{fe(cr,"width",n()),fe(cr,"height",n())}),j(Hi,cr)},gl=Hi=>{var cr=$e(),nc=Ue(cr);{var $n=fi=>{var Er=qI();_e(()=>{fe(Er,"width",n()),fe(Er,"height",n())}),j(fi,Er)},Ba=fi=>{var Er=$e(),ml=Ue(Er);{var Ii=ur=>{var yr=jI();_e(()=>{fe(yr,"width",n()),fe(yr,"height",n())}),j(ur,yr)},hi=ur=>{var yr=$e(),vl=Ue(yr);{var ic=dr=>{var rs=HI();_e(()=>{fe(rs,"width",n()),fe(rs,"height",n())}),j(dr,rs)},Ir=dr=>{var rs=$e(),za=Ue(rs);{var qr=qs=>{var ss=UI();_e(()=>{fe(ss,"width",n()),fe(ss,"height",n())}),j(qs,ss)},yl=qs=>{var ss=$e(),_s=Ue(ss);{var yo=Ss=>{var Li=WI();_e(()=>{fe(Li,"width",n()),fe(Li,"height",n())}),j(Ss,Li)},jr=Ss=>{var Li=$e(),qa=Ue(Li);{var rc=js=>{var ks=VI();_e(()=>{fe(ks,"width",n()),fe(ks,"height",n())}),j(js,ks)},Jt=js=>{var ks=$e(),sc=Ue(ks);{var as=Ns=>{var Hs=GI();_e(()=>{fe(Hs,"width",n()),fe(Hs,"height",n())}),j(Ns,Hs)},As=Ns=>{var Hs=$e(),da=Ue(Hs);{var bo=Ws=>{var Qi=XI();_e(()=>{fe(Qi,"width",n()),fe(Qi,"height",n())}),j(Ws,Qi)},Us=Ws=>{var Qi=$e(),ac=Ue(Qi);{var ja=os=>{var $i=YI();_e(()=>{fe($i,"width",n()),fe($i,"height",n())}),j(os,$i)},wo=os=>{var $i=$e(),Ha=Ue($i);{var fa=br=>{var Hr=KI();_e(()=>{fe(Hr,"width",n()),fe(Hr,"height",n())}),j(br,Hr)},Ua=br=>{var Hr=$e(),xo=Ue(Hr);{var _o=fr=>{var xe=ZI();_e(()=>{fe(xe,"width",n()),fe(xe,"height",n())}),j(fr,xe)},Cs=fr=>{var xe=$e(),Ve=Ue(xe);{var Ct=R=>{var te=JI();_e(()=>{fe(te,"width",n()),fe(te,"height",n())}),j(R,te)},x=R=>{var te=$e(),me=Ue(te);{var Ne=Ge=>{var mt=QI();_e(()=>{fe(mt,"width",n()),fe(mt,"height",n())}),j(Ge,mt)},ze=Ge=>{var mt=$e(),yt=Ue(mt);{var ft=sn=>{var tn=$I();_e(()=>{fe(tn,"width",n()),fe(tn,"height",n())}),j(sn,tn)},zt=sn=>{var tn=$e(),In=Ue(tn);{var Sn=pn=>{var Tn=eL();_e(()=>{fe(Tn,"width",n()),fe(Tn,"height",n())}),j(pn,Tn)},zn=pn=>{var Tn=$e(),ha=Ue(Tn);{var Ps=Vs=>{var Es=tL();_e(()=>{fe(Es,"width",n()),fe(Es,"height",n())}),j(Vs,Es)},pa=Vs=>{var Es=$e(),Wa=Ue(Es);{var So=Ur=>{var pi=nL();_e(()=>{fe(pi,"width",n()),fe(pi,"height",n())}),j(Ur,pi)},ko=Ur=>{var pi=$e(),Ao=Ue(pi);{var No=Gs=>{var ki=iL();_e(()=>{fe(ki,"width",n()),fe(ki,"height",n())}),j(Gs,ki)},oc=Gs=>{var ki=$e(),ga=Ue(ki);{var bl=er=>{var ls=rL();_e(()=>{fe(ls,"width",n()),fe(ls,"height",n())}),j(er,ls)},Vc=er=>{var ls=$e(),lc=Ue(ls);{var cc=cs=>{var Ui=sL();_e(()=>{fe(Ui,"width",n()),fe(Ui,"height",n())}),j(cs,Ui)},Va=cs=>{var Ui=$e(),Wr=Ue(Ui);{var Ga=Vr=>{var Xs=aL();_e(()=>{fe(Xs,"width",n()),fe(Xs,"height",n())}),j(Vr,Xs)},ma=Vr=>{var Xs=$e(),wl=Ue(Xs);{var xi=wr=>{var xr=oL();_e(()=>{fe(xr,"width",n()),fe(xr,"height",n())}),j(wr,xr)},Gc=wr=>{var xr=$e(),uc=Ue(xr);{var dc=Ys=>{var Gr=lL();_e(()=>{fe(Gr,"width",n()),fe(Gr,"height",n())}),j(Ys,Gr)},fc=Ys=>{var Gr=$e(),Xa=Ue(Gr);{var Ya=Xr=>{var us=cL();_e(()=>{fe(us,"width",n()),fe(us,"height",n())}),j(Xr,us)},Co=Xr=>{var us=$e(),ds=Ue(us);{var Ks=kn=>{var Vn=uL();_e(()=>{fe(Vn,"width",n()),fe(Vn,"height",n())}),j(kn,Vn)},Ln=kn=>{var Vn=$e(),Mi=Ue(Vn);{var va=Is=>{var ya=dL();_e(()=>{fe(ya,"width",n()),fe(ya,"height",n())}),j(Is,ya)},hc=Is=>{var ya=$e(),of=Ue(ya);{var lf=Po=>{var Eo=fL();_e(()=>{fe(Eo,"width",n()),fe(Eo,"height",n())}),j(Po,Eo)},cf=Po=>{var Eo=$e(),uf=Ue(Eo);{var pc=Io=>{var Lo=hL();_e(()=>{fe(Lo,"width",n()),fe(Lo,"height",n())}),j(Io,Lo)},df=Io=>{var Lo=$e(),ff=Ue(Lo);{var hf=Mo=>{var To=pL();_e(()=>{fe(To,"width",n()),fe(To,"height",n())}),j(Mo,To)},pf=Mo=>{var To=$e(),Zu=Ue(To);{var Xc=tr=>{var ba=gL();_e(()=>{fe(ba,"width",n()),fe(ba,"height",n())}),j(tr,ba)},Yr=tr=>{var ba=$e(),Yc=Ue(ba);{var gf=wa=>{var Ka=mL();_e(()=>{fe(Ka,"width",n()),fe(Ka,"height",n())}),j(wa,Ka)},Kc=wa=>{var Ka=$e(),mf=Ue(Ka);{var Ju=xa=>{var Za=vL();_e(()=>{fe(Za,"width",n()),fe(Za,"height",n())}),j(xa,Za)},Qu=xa=>{var Za=$e(),Dp=Ue(Za);{var Op=xl=>{var _l=yL();_e(()=>{fe(_l,"width",n()),fe(_l,"height",n())}),j(xl,_l)},vf=xl=>{var _l=$e(),Fp=Ue(_l);{var Rp=Ja=>{var Qa=bL();_e(()=>{fe(Qa,"width",n()),fe(Qa,"height",n())}),j(Ja,Qa)},Bp=Ja=>{var Qa=$e(),gc=Ue(Qa);{var zp=Do=>{var Sl=wL();_e(()=>{fe(Sl,"width",n()),fe(Sl,"height",n())}),j(Do,Sl)},qp=Do=>{var Sl=$e(),jp=Ue(Sl);{var Hp=Kr=>{var hr=xL();_e(()=>{fe(hr,"width",n()),fe(hr,"height",n())}),j(Kr,hr)},Up=Kr=>{var hr=$e(),_a=Ue(hr);{var Wp=Zr=>{var nr=_L();_e(()=>{fe(nr,"width",n()),fe(nr,"height",n())}),j(Zr,nr)},yf=Zr=>{var nr=$e(),Vp=Ue(nr);{var Gp=Oo=>{var Fo=SL();_e(()=>{fe(Fo,"width",n()),fe(Fo,"height",n())}),j(Oo,Fo)},bf=Oo=>{var Fo=$e(),wf=Ue(Fo);{var Xp=Sa=>{var Zs=kL();_e(()=>{fe(Zs,"width",n()),fe(Zs,"height",n())}),j(Sa,Zs)},Zc=Sa=>{var Zs=$e(),$u=Ue(Zs);{var Yp=kl=>{var Al=AL();_e(()=>{fe(Al,"width",n()),fe(Al,"height",n())}),j(kl,Al)},xf=kl=>{var Al=$e(),Kp=Ue(Al);{var Zp=Nl=>{var Ro=NL();_e(()=>{fe(Ro,"width",n()),fe(Ro,"height",n())}),j(Nl,Ro)},Jp=Nl=>{var Ro=$e(),Jc=Ue(Ro);{var Qp=Bo=>{var g=CL();_e(()=>{fe(g,"width",n()),fe(g,"height",n())}),j(Bo,g)},$p=Bo=>{var g=$e(),v=Ue(g);{var k=z=>{var H=PL();_e(()=>{fe(H,"width",n()),fe(H,"height",n())}),j(z,H)},L=z=>{var H=$e(),X=Ue(H);{var $=oe=>{var we=EL();_e(()=>{fe(we,"width",n()),fe(we,"height",n())}),j(oe,we)},ie=oe=>{var we=$e(),De=Ue(we);{var ce=Ce=>{var He=IL();_e(()=>{fe(He,"width",n()),fe(He,"height",n())}),j(Ce,He)},Se=Ce=>{var He=$e(),Te=Ue(He);{var Xe=at=>{var et=LL();_e(()=>{fe(et,"width",n()),fe(et,"height",n())}),j(at,et)},Ze=at=>{var et=$e(),Ht=Ue(et);{var Pt=Nt=>{var hn=ML();_e(()=>{fe(hn,"width",n()),fe(hn,"height",n())}),j(Nt,hn)},un=Nt=>{var hn=$e(),Ti=Ue(hn);{var dn=pt=>{var Gn=TL();_e(()=>{fe(Gn,"width",n()),fe(Gn,"height",n())}),j(pt,Gn)},Mt=pt=>{var Gn=$e(),on=Ue(Gn);{var xn=gi=>{var Ai=DL();_e(()=>{fe(Ai,"width",n()),fe(Ai,"height",n())}),j(gi,Ai)},ei=gi=>{var Ai=$e(),mi=Ue(Ai);{var pr=ci=>{var gn=OL();_e(()=>{fe(gn,"width",n()),fe(gn,"height",n())}),j(ci,gn)},_r=ci=>{var gn=$e(),Dn=Ue(gn);{var vi=yi=>{var gr=FL();_e(()=>{fe(gr,"width",n()),fe(gr,"height",n())}),j(yi,gr)},On=yi=>{var gr=$e(),_i=Ue(gr);{var Lr=ui=>{var Wi=RL();_e(()=>{fe(Wi,"width",n()),fe(Wi,"height",n())}),j(ui,Wi)},Hn=ui=>{var Wi=$e(),Sr=Ue(Wi);{var Jr=Di=>{var Vi=BL();_e(()=>{fe(Vi,"width",n()),fe(Vi,"height",n())}),j(Di,Vi)},Qr=Di=>{var Vi=$e(),Xn=Ue(Vi);{var $r=fs=>{var Mr=zL();_e(()=>{fe(Mr,"width",n()),fe(Mr,"height",n())}),j(fs,Mr)},Ls=fs=>{var Mr=$e(),ir=Ue(Mr);{var Qc=ka=>{var Js=qL();_e(()=>{fe(Js,"width",n()),fe(Js,"height",n())}),j(ka,Js)},ed=ka=>{var Js=$e(),eg=Ue(Js);{var tg=es=>{var zo=jL();_e(()=>{fe(zo,"width",n()),fe(zo,"height",n())}),j(es,zo)},td=es=>{var zo=HL(),ng=se(zo,!0);Q(zo),_e(()=>Wt(ng,e.name)),j(es,zo)};ke(eg,es=>{e.name==="font-size-decrease"?es(tg):es(td,!1)},!0)}j(ka,Js)};ke(ir,ka=>{e.name==="font-size-increase"?ka(Qc):ka(ed,!1)},!0)}j(fs,Mr)};ke(Xn,fs=>{e.name==="stage"?fs($r):fs(Ls,!1)},!0)}j(Di,Vi)};ke(Sr,Di=>{e.name==="tag"?Di(Jr):Di(Qr,!1)},!0)}j(ui,Wi)};ke(_i,ui=>{e.name==="image"?ui(Lr):ui(Hn,!1)},!0)}j(yi,gr)};ke(Dn,yi=>{e.name==="car"?yi(vi):yi(On,!1)},!0)}j(ci,gn)};ke(mi,ci=>{e.name==="flask"?ci(pr):ci(_r,!1)},!0)}j(gi,Ai)};ke(on,gi=>{e.name==="box"?gi(xn):gi(ei,!1)},!0)}j(pt,Gn)};ke(Ti,pt=>{e.name==="arrow-left"?pt(dn):pt(Mt,!1)},!0)}j(Nt,hn)};ke(Ht,Nt=>{e.name==="arrow-right"?Nt(Pt):Nt(un,!1)},!0)}j(at,et)};ke(Te,at=>{e.name==="github"?at(Xe):at(Ze,!1)},!0)}j(Ce,He)};ke(De,Ce=>{e.name==="heart"?Ce(ce):Ce(Se,!1)},!0)}j(oe,we)};ke(X,oe=>{e.name==="table"?oe($):oe(ie,!1)},!0)}j(z,H)};ke(v,z=>{e.name==="braces"?z(k):z(L,!1)},!0)}j(Bo,g)};ke(Jc,Bo=>{e.name==="list"?Bo(Qp):Bo($p,!1)},!0)}j(Nl,Ro)};ke(Kp,Nl=>{e.name==="clipboard"?Nl(Zp):Nl(Jp,!1)},!0)}j(kl,Al)};ke($u,kl=>{e.name==="crosshair"?kl(Yp):kl(xf,!1)},!0)}j(Sa,Zs)};ke(wf,Sa=>{e.name==="skip-forward-filled"?Sa(Xp):Sa(Zc,!1)},!0)}j(Oo,Fo)};ke(Vp,Oo=>{e.name==="stop-filled"?Oo(Gp):Oo(bf,!1)},!0)}j(Zr,nr)};ke(_a,Zr=>{e.name==="play-filled"?Zr(Wp):Zr(yf,!1)},!0)}j(Kr,hr)};ke(jp,Kr=>{e.name==="skip-forward"?Kr(Hp):Kr(Up,!1)},!0)}j(Do,Sl)};ke(gc,Do=>{e.name==="square"?Do(zp):Do(qp,!1)},!0)}j(Ja,Qa)};ke(Fp,Ja=>{e.name==="zoom-out"?Ja(Rp):Ja(Bp,!1)},!0)}j(xl,_l)};ke(Dp,xl=>{e.name==="zoom-in"?xl(Op):xl(vf,!1)},!0)}j(xa,Za)};ke(mf,xa=>{e.name==="map"?xa(Ju):xa(Qu,!1)},!0)}j(wa,Ka)};ke(Yc,wa=>{e.name==="bar-chart-2"?wa(gf):wa(Kc,!1)},!0)}j(tr,ba)};ke(Zu,tr=>{e.name==="bar-chart"?tr(Xc):tr(Yr,!1)},!0)}j(Mo,To)};ke(ff,Mo=>{e.name==="moon"?Mo(hf):Mo(pf,!1)},!0)}j(Io,Lo)};ke(uf,Io=>{e.name==="sun"?Io(pc):Io(df,!1)},!0)}j(Po,Eo)};ke(of,Po=>{e.name==="loader"?Po(lf):Po(cf,!1)},!0)}j(Is,ya)};ke(Mi,Is=>{e.name==="help-circle"?Is(va):Is(hc,!1)},!0)}j(kn,Vn)};ke(ds,kn=>{e.name==="spacebar"?kn(Ks):kn(Ln,!1)},!0)}j(Xr,us)};ke(Xa,Xr=>{e.name==="new-canvas"?Xr(Ya):Xr(Co,!1)},!0)}j(Ys,Gr)};ke(uc,Ys=>{e.name==="file-plus"?Ys(dc):Ys(fc,!1)},!0)}j(wr,xr)};ke(wl,wr=>{e.name==="activity"?wr(xi):wr(Gc,!1)},!0)}j(Vr,Xs)};ke(Wr,Vr=>{e.name==="layers"?Vr(Ga):Vr(ma,!1)},!0)}j(cs,Ui)};ke(lc,cs=>{e.name==="book"?cs(cc):cs(Va,!1)},!0)}j(er,ls)};ke(ga,er=>{e.name==="home"?er(bl):er(Vc,!1)},!0)}j(Gs,ki)};ke(Ao,Gs=>{e.name==="menu"?Gs(No):Gs(oc,!1)},!0)}j(Ur,pi)};ke(Wa,Ur=>{e.name==="external-link"?Ur(So):Ur(ko,!1)},!0)}j(Vs,Es)};ke(ha,Vs=>{e.name==="keyboard"?Vs(Ps):Vs(pa,!1)},!0)}j(pn,Tn)};ke(In,pn=>{e.name==="save"?pn(Sn):pn(zn,!1)},!0)}j(sn,tn)};ke(yt,sn=>{e.name==="file"?sn(ft):sn(zt,!1)},!0)}j(Ge,mt)};ke(me,Ge=>{e.name==="folder"?Ge(Ne):Ge(ze,!1)},!0)}j(R,te)};ke(Ve,R=>{e.name==="alert-triangle"?R(Ct):R(x,!1)},!0)}j(fr,xe)};ke(xo,fr=>{e.name==="info"?fr(_o):fr(Cs,!1)},!0)}j(br,Hr)};ke(Ha,br=>{e.name==="terminal"?br(fa):br(Ua,!1)},!0)}j(os,$i)};ke(ac,os=>{e.name==="code"?os(ja):os(wo,!1)},!0)}j(Ws,Qi)};ke(da,Ws=>{e.name==="eye-off"?Ws(bo):Ws(Us,!1)},!0)}j(Ns,Hs)};ke(sc,Ns=>{e.name==="eye"?Ns(as):Ns(As,!1)},!0)}j(js,ks)};ke(qa,js=>{e.name==="stop"?js(rc):js(Jt,!1)},!0)}j(Ss,Li)};ke(_s,Ss=>{e.name==="pause"?Ss(yo):Ss(jr,!1)},!0)}j(qs,ss)};ke(za,qs=>{e.name==="play"?qs(qr):qs(yl,!1)},!0)}j(dr,rs)};ke(vl,dr=>{e.name==="upload-plus"?dr(ic):dr(Ir,!1)},!0)}j(ur,yr)};ke(ml,ur=>{e.name==="upload"?ur(Ii):ur(hi,!1)},!0)}j(fi,Er)};ke(nc,fi=>{e.name==="download"?fi($n):fi(Ba,!1)},!0)}j(Hi,cr)};ke(pl,Hi=>{e.name==="chevron-left"?Hi(ua):Hi(gl,!1)},!0)}j(xs,lr)};ke(zs,xs=>{e.name==="chevron-right"?xs(Pr):xs(ws,!1)},!0)}j(or,bs)};ke(Wn,or=>{e.name==="chevron-up"?or(Bs):or(vo,!1)},!0)}j(Qn,En)};ke(rn,Qn=>{e.name==="chevron-down"?Qn(Mn):Qn(Zt,!1)},!0)}j(Lt,Qt)};ke(nn,Lt=>{e.name==="search"?Lt(Yt):Lt(Vt,!1)},!0)}j(tt,Ft)};ke(jn,tt=>{e.name==="check"?tt(wn):tt(je,!1)},!0)}j(qn,Pn)};ke(li,qn=>{e.name==="x"?qn(Bt):qn(Jn,!1)},!0)}j(bn,Cn)};ke(gt,bn=>{e.name==="pin-filled"?bn(Gt):bn(oi,!1)},!0)}j(jt,kt)};ke(bt,jt=>{e.name==="pin"?jt(ot):jt(vt,!1)},!0)}j(Ot,dt)};ke(At,Ot=>{e.name==="type"?Ot(St):Ot(st,!1)},!0)}j(nt,_t)};ke(Pe,nt=>{e.name==="grid"?nt(Le):nt(it,!1)},!0)}j(qe,ve)};ke(ht,qe=>{e.name==="zap"?qe(Rt):qe(ye,!1)},!0)}j(We,Ke)};ke(Be,We=>{e.name==="exit"?We(Ie):We(lt,!1)},!0)}j(Re,Qe)};ke(Ae,Re=>{e.name==="enter"?Re(Ye):Re(K,!1)},!0)}j(ge,Ee)};ke(de,ge=>{e.name==="redo"?ge(he):ge(pe,!1)},!0)}j(ae,ee)};ke(V,ae=>{e.name==="undo"?ae(G):ae(re,!1)},!0)}j(le,O)};ke(W,le=>{e.name==="select-all"?le(Y):le(ue,!1)},!0)}j(q,Z)};ke(B,q=>{e.name==="maximize"?q(P):q(F,!1)},!0)}j(C,N)};ke(T,C=>{e.name==="plus"?C(D):C(U,!1)},!0)}j(E,M)};ke(A,E=>{e.name==="rotate"?E(_):E(I,!1)},!0)}j(b,S)};ke(y,b=>{e.name==="copy"?b(m):b(w,!1)},!0)}j(p,d)};ke(c,p=>{e.name==="settings"?p(u):p(f,!1)},!0)}j(o,l)};ke(r,o=>{e.name==="trash"?o(s):o(a,!1)})}j(t,i)}var UL=Me('<link rel="stylesheet"/>'),WL=Me('<div class="toolbar svelte-pxdwwx"><button class="toolbar-btn svelte-pxdwwx"><!></button> <button class="toolbar-btn svelte-pxdwwx"><!></button> <!></div>'),VL=Me('<textarea placeholder="Markdown with $math$..." spellcheck="false" class="svelte-pxdwwx"></textarea>'),GL=Me('<span class="placeholder svelte-pxdwwx">Double-click to add note...</span>'),XL=Me('<div class="rendered svelte-pxdwwx"><!></div>'),YL=Me('<div><!> <div class="annotation svelte-pxdwwx"><!> <!></div></div>');function KL(t,e){Tt(e,!0);let n=ct(e,"selected",3,!1),i=Oe(Rn(e.data.content||"")),r=Oe(Rn(e.data.color||rl)),s=Oe(Rn(e.data.fontSize||Rr.DEFAULT));const a=Fe.annotations.subscribe(F=>{const q=F.get(e.id);q&&(J(i,q.content||"",!0),J(r,q.color||rl,!0),J(s,q.fontSize||Rr.DEFAULT,!0))});let o=0;const l=rw.subscribe(F=>{F.id>o&&F.annotationId===e.id&&(o=F.id,J(f,!0))});Ei(()=>{a(),l()});let c=Oe(""),u=Oe(void 0),f=Oe(!1);mn(()=>{h(i)?dI(h(i)).then(F=>{J(c,F,!0)}):J(c,"")}),mn(()=>{h(f)&&h(u)&&(h(u).focus(),h(u).selectionStart=h(u).value.length)}),mn(()=>{n()||J(f,!1)});function p(){It.beginDrag()}function d(){It.endDrag()}function y(F){const q=F.target.value;Fe.updateAnnotation(e.id,{content:q})}function m(F){if(F.key==="Escape"){J(f,!1),F.stopPropagation();return}F.stopPropagation()}function w(F){n()&&(F.target.closest(".color-picker-wrapper")||J(f,!0))}function b(F){It.mutate(()=>Fe.updateAnnotation(e.id,{color:F}))}function S(){const F=Math.min(h(s)+Rr.STEP,Rr.MAX);It.mutate(()=>Fe.updateAnnotation(e.id,{fontSize:F}))}function A(){const F=Math.max(h(s)-Rr.STEP,Rr.MIN);It.mutate(()=>Fe.updateAnnotation(e.id,{fontSize:F}))}function _(F){const q=F.currentTarget;q.scrollHeight>q.clientHeight&&F.stopPropagation()}function I(F,q){const Z=Math.round(q.width/Fn)*Fn,W=Math.round(q.height/Fn)*Fn;It.mutate(()=>Fe.updateAnnotation(e.id,{width:Math.max(100,Z),height:Math.max(50,W)}))}var E=YL();rp("pxdwwx",F=>{var q=UL();_e(Z=>fe(q,"href",Z),[c0]),j(F,q)});let M;var T=se(E);FC(T,{minWidth:100,minHeight:50,get isVisible(){return n()},onResizeEnd:I});var D=be(T,2);D.__dblclick=w;var U=se(D);{var C=F=>{var q=WL(),Z=se(q);Z.__click=S;var W=se(Z);qt(W,{name:"font-size-increase",size:14}),Q(Z),wt(Z,(O,V)=>$t?.(O,V),()=>({text:"Increase font size",position:"top"}));var Y=be(Z,2);Y.__click=A;var ue=se(Y);qt(ue,{name:"font-size-decrease",size:14}),Q(Y),wt(Y,(O,V)=>$t?.(O,V),()=>({text:"Decrease font size",position:"top"}));var le=be(Y,2);d0(le,{get currentColor(){return h(r)},get defaultColor(){return rl},onSelect:b,popupPosition:"top",tooltipPosition:"top",get iconColor(){return h(r)},iconSize:14,variant:"ghost"}),Q(q),_e(()=>{Z.disabled=h(s)>=Rr.MAX,Y.disabled=h(s)<=Rr.MIN}),j(F,q)};ke(U,F=>{n()&&F(C)})}var N=be(U,2);{var B=F=>{var q=VL();W3(q),q.__input=y,q.__keydown=m,ji(q,Z=>J(u,Z),()=>h(u)),_e(()=>ps(q,h(i))),yn("focus",q,p),yn("blur",q,d),yn("wheel",q,_),j(F,q)},P=F=>{var q=XL(),Z=se(q);{var W=ue=>{var le=$e(),O=Ue(le);_1(O,()=>h(c)),j(ue,le)},Y=ue=>{var le=GL();j(ue,le)};ke(Z,ue=>{h(i)?ue(W):ue(Y,!1)})}Q(q),yn("wheel",q,_),j(F,q)};ke(N,F=>{h(f)?F(B):F(P,!1)})}Q(D),Q(E),_e(()=>{M=Xt(E,1,"annotation-wrapper svelte-pxdwwx",null,M,{nodrag:h(f)}),An(E,`--annotation-color: ${h(r)??""}; --annotation-font-size: ${h(s)??""}px;`)}),j(t,E),Dt()}Kn(["dblclick","click","input","keydown"]);const qw={up:{x:0,y:-1},down:{x:0,y:1},left:{x:-1,y:0},right:{x:1,y:0}},ZL={up:"down",down:"up",left:"right",right:"left"},Wl=vs.unit,f0=0,h0=vs.unit,Yn=vs.unit,y2=vs.unit/2,JL=vs.unit/4,tu=10;function b2(t,e){return(t+1e4)*20001+(e+1e4)}function zr(t){return Math.round(t/Yn)}function w2(t){return t*Yn}function x2(t,e,n){const i={x:t.x-Wl,y:t.y-Wl,width:t.width+2*Wl,height:t.height+2*Wl};return{minGx:zr(i.x-e),minGy:zr(i.y-n),maxGx:zr(i.x+i.width-e),maxGy:zr(i.y+i.height-n)}}class QL{offsetX=0;offsetY=0;nodeObstacles=new Map;portStubObstacles=[];spatialHash=new Map;constructor(e){e&&this.initFromContext(e)}getBucketKey(e,n){const i=Math.floor(e/tu),r=Math.floor(n/tu);return b2(i,r)}getObstacleBuckets(e){const n=[],i=Math.floor(e.minGx/tu),r=Math.floor(e.maxGx/tu),s=Math.floor(e.minGy/tu),a=Math.floor(e.maxGy/tu);for(let o=i;o<=r;o++)for(let l=s;l<=a;l++)n.push(b2(o,l));return n}addToSpatialHash(e,n){for(const i of this.getObstacleBuckets(n))this.spatialHash.has(i)||this.spatialHash.set(i,new Set),this.spatialHash.get(i).add(e)}removeFromSpatialHash(e,n){for(const i of this.getObstacleBuckets(n))this.spatialHash.get(i)?.delete(e)}initFromContext(e){const{canvasBounds:n}=e;this.offsetX=Math.floor(n.x/Yn)*Yn,this.offsetY=Math.floor(n.y/Yn)*Yn,this.nodeObstacles.clear(),this.spatialHash.clear();for(const[i,r]of e.nodeBounds){const s=x2(r,this.offsetX,this.offsetY);this.nodeObstacles.set(i,s),this.addToSpatialHash(i,s)}this.updatePortStubs(e.portStubs)}updateBounds(e){this.offsetX=Math.floor(e.x/Yn)*Yn,this.offsetY=Math.floor(e.y/Yn)*Yn}updateNode(e,n){const i=this.nodeObstacles.get(e);i&&this.removeFromSpatialHash(e,i);const r=x2(n,this.offsetX,this.offsetY);this.nodeObstacles.set(e,r),this.addToSpatialHash(e,r)}removeNode(e){const n=this.nodeObstacles.get(e);n&&this.removeFromSpatialHash(e,n),this.nodeObstacles.delete(e)}updatePortStubs(e){if(this.portStubObstacles=[],e)for(const n of e){const i=qw[n.direction],r=n.position.x+i.x*Yn,s=n.position.y+i.y*Yn,a=zr(r-this.offsetX),o=zr(s-this.offsetY);this.portStubObstacles.push({minGx:a,minGy:o,maxGx:a,maxGy:o})}}isWalkableAt(e,n){const i=this.getBucketKey(e,n),r=this.spatialHash.get(i);if(r)for(const s of r){const a=this.nodeObstacles.get(s);if(a&&e>=a.minGx&&e<=a.maxGx&&n>=a.minGy&&n<=a.maxGy)return!1}for(const s of this.portStubObstacles)if(e>=s.minGx&&e<=s.maxGx&&n>=s.minGy&&n<=s.maxGy)return!1;return!0}getOffset(){return{x:this.offsetX,y:this.offsetY}}}const $L=2,e7=20,t7=2,n7=3,i7=1e4,r7={right:0,left:1,down:2,up:3},_2=[{dx:1,dy:0,dir:"right",dirIdx:0},{dx:-1,dy:0,dir:"left",dirIdx:1},{dx:0,dy:1,dir:"down",dirIdx:2},{dx:0,dy:-1,dir:"up",dirIdx:3}];function S2(t,e,n){return((t+1e4)*20001+(e+1e4))*4+n}function Bf(t,e){return(t+1e4)*20001+(e+1e4)}class s7{heap=[];index=new Map;push(e){e.heapIdx=this.heap.length,this.heap.push(e),this.index.set(e.stateKey,e),this.bubbleUp(e.heapIdx)}pop(){if(this.heap.length===0)return;const e=this.heap[0];this.index.delete(e.stateKey);const n=this.heap.pop();return this.heap.length>0&&(n.heapIdx=0,this.heap[0]=n,this.bubbleDown(0)),e}get length(){return this.heap.length}updateIfBetter(e,n,i,r){const s=this.index.get(e);return s&&n<s.g?(s.g=n,s.f=n+s.h,s.parent=r,this.bubbleUp(s.heapIdx),!0):!1}has(e){return this.index.has(e)}bubbleUp(e){const n=this.heap;for(;e>0;){const i=e-1>>1;if(n[e].f>=n[i].f)break;this.swap(e,i),e=i}}bubbleDown(e){const n=this.heap,i=n.length;for(;;){const r=2*e+1,s=2*e+2;let a=e;if(r<i&&n[r].f<n[a].f&&(a=r),s<i&&n[s].f<n[a].f&&(a=s),a===e)break;this.swap(e,a),e=a}}swap(e,n){const i=this.heap,r=i[e],s=i[n];i[e]=s,i[n]=r,r.heapIdx=n,s.heapIdx=e}}function Xm(t,e,n,i,r,s){const a=zr(t.x-i.x),o=zr(t.y-i.y),l=zr(e.x-i.x),c=zr(e.y-i.y),u=zr(i.x),f=zr(i.y),p=new Set;p.add(Bf(a,o)),p.add(Bf(l,c));const d=_2.find(E=>E.dir===r);if(d)for(let E=1;E<=n7;E++)p.add(Bf(a+d.dx*E,o+d.dy*E));const y=(E,M)=>p.has(Bf(E,M))?!0:n.isWalkableAt(E,M),m=new s7,w=new Set,b=r7[r],S=S2(a,o,b),A=k2(a,o,l,c),_={x:a,y:o,g:0,h:A,f:A,parent:null,direction:r,dirIdx:b,stateKey:S,heapIdx:0};m.push(_);let I=0;for(;m.length>0&&I<i7;){I++;const E=m.pop();if(E.x===l&&E.y===c)return{path:a7(E,i),isFallback:!1};if(w.has(E.stateKey))continue;w.add(E.stateKey);const M=ZL[E.direction],T=E.parent===null;for(const{dx:D,dy:U,dir:C,dirIdx:N}of _2){if(C===M||T&&C!==r)continue;const B=E.x+D,P=E.y+U;if(!y(B,P))continue;const F=S2(B,P,N);if(w.has(F))continue;let q=1;if(E.direction!==C&&(q+=$L),s){const W=B+u,Y=P+f,ue=s.get(`${W},${Y}`);if(ue){const O=C==="left"||C==="right"?ue.has("up")||ue.has("down"):ue.has("left")||ue.has("right");q+=O?t7:e7}}const Z=E.g+q;if(!m.updateIfBetter(F,Z,0,E)&&!m.has(F)){const W=k2(B,P,l,c);m.push({x:B,y:P,g:Z,h:W,f:Z+W,parent:E,direction:C,dirIdx:N,stateKey:F,heapIdx:0})}}}return r==="right"||r==="left"?{path:[t,{x:e.x,y:t.y},e],isFallback:!0}:{path:[t,{x:t.x,y:e.y},e],isFallback:!0}}function k2(t,e,n,i){return Math.abs(t-n)+Math.abs(e-i)}function a7(t,e){const n=[];let i=t;for(;i!==null;)n.push({x:w2(i.x)+e.x,y:w2(i.y)+e.y}),i=i.parent;return n.reverse(),n}function jw(t){if(t.length<3)return t;const e=[t[0]];for(let n=1;n<t.length-1;n++){const i=e[e.length-1],r=t[n],s=t[n+1],a=Math.sign(r.x-i.x),o=Math.sign(r.y-i.y),l=Math.sign(s.x-r.x),c=Math.sign(s.y-r.y);(a!==l||o!==c)&&e.push(r)}return e.push(t[t.length-1]),e}function Vh(t){return{x:Math.round(t.x/Yn)*Yn,y:Math.round(t.y/Yn)*Yn}}function Bu(t,e,n){const i=qw[e],r={x:t.x+i.x*n,y:t.y+i.y*n};return Vh(r)}function Hw(t,e,n,i,r,s){const a=Bu(t,n,f0),o=Bu(e,i,h0),l=r.getOffset(),c=Xm(a,o,r,l,n,s);return{path:jw(c.path),waypoints:[],isFallback:c.isFallback}}function o7(t,e,n="right",i="left"){const r=Bu(t,n,f0),s=Bu(e,i,h0),a=[r];return r.x!==s.x&&r.y!==s.y&&(n==="right"||n==="left"?a.push(Vh({x:s.x,y:r.y})):a.push(Vh({x:r.x,y:s.y}))),a.push(s),{path:a,waypoints:[]}}function l7(t,e=2){const n=new Map;let i=0;for(let r=0;r<t.length-1;r++){const s=t[r],a=t[r+1],o=a.x-s.x,l=a.y-s.y;let c;Math.abs(o)>Math.abs(l)?c=o>0?"right":"left":c=l>0?"down":"up";const u=zr(s.x),f=zr(s.y),p=zr(a.x),d=zr(a.y),y=Math.min(u,p),m=Math.max(u,p),w=Math.min(f,d),b=Math.max(f,d);for(let S=y;S<=m;S++)for(let A=w;A<=b;A++)if(i++,i>e){const _=`${S},${A}`;n.has(_)||n.set(_,new Set),n.get(_).add(c)}}return n}function Uw(t,e){const n=e.x-t.x,i=e.y-t.y;return Math.abs(n)>Math.abs(i)?n>0?"right":"left":i>0?"down":"up"}function c7(t){if(t.length<2)return"right";const e=t[t.length-1],n=t[t.length-2];return Uw(n,e)}function u7(t,e,n,i,r,s,a){if(s.length===0)return Hw(t,e,n,i,r,a);const o=r.getOffset(),l=[];let c=Bu(t,n,f0),u=n,f=!1;for(let m=0;m<s.length;m++){const w=s[m],b=Vh(w.position),S=Xm(c,b,r,o,u,a);if(S.isFallback&&(f=!0),l.length===0?l.push(...S.path):S.path.length>0&&l.push(...S.path.slice(1)),c=b,S.path.length>=2)u=c7(S.path);else{const A=m<s.length-1?s[m+1].position:e;u=Uw(b,A)}}const p=Bu(e,i,h0),d=Xm(c,p,r,o,u,a);return d.isFallback&&(f=!0),l.length===0?l.push(...d.path):d.path.length>0&&l.push(...d.path.slice(1)),{path:jw(l),waypoints:s,isFallback:f}}function Ho(t){return(t||[]).filter(e=>e.isUserWaypoint)}function Uo(t,e,n,i,r,s,a){return r?s.length>0?u7(t,e,n,i,r,s,a):Hw(t,e,n,i,r,a):o7(t,e,n,i)}function A2(t,e,n,i,r){const s=r.map(a=>`${a.position.x},${a.position.y}`).join(";");return`${t.x},${t.y}|${e.x},${e.y}|${n}|${i}|${s}`}const d7=8,ti=ln({routes:new Map,context:null,grid:null,routeInputHashes:new Map});let zf=0;const Ci={subscribe:ti.subscribe,setContext(t,e,n){const i={nodeBounds:t,canvasBounds:e,portStubs:n};ti.update(r=>{let s=r.grid;if(!s)s=new QL(i);else{s.updateBounds(e);const a=new Set(t.keys()),o=new Set;if(r.context)for(const l of r.context.nodeBounds.keys())o.add(l);for(const[l,c]of t)s.updateNode(l,c);for(const l of o)a.has(l)||s.removeNode(l);s.updatePortStubs(n)}return{...r,context:i,grid:s}})},updateNodeBounds(t,e){ti.update(n=>(n.grid&&n.grid.updateNode(t,e),n.context&&n.context.nodeBounds.set(t,e),n))},recalculateRoutesForNodes(t,e,n){const i=Je(ti);if(!i.grid)return;const r=e.filter(c=>t.has(c.sourceNodeId)||t.has(c.targetNodeId));if(r.length===0)return;const s=new Map,a=(c,u,f)=>{const p=`${c}:${u}:${f}`;return s.has(p)||s.set(p,n(c,u,f)),s.get(p)},o=new Map(i.routes),l=new Map(i.routeInputHashes);for(const c of r){const u=a(c.sourceNodeId,c.sourcePortIndex,!0),f=a(c.targetNodeId,c.targetPortIndex,!1);if(!u||!f)continue;const p=Ho(c.waypoints),d=A2(u.position,f.position,u.direction,f.direction,p);if(d===i.routeInputHashes.get(c.id)&&o.has(c.id))continue;const y=Uo(u.position,f.position,u.direction,f.direction,i.grid,p);o.set(c.id,y),l.set(c.id,d)}ti.update(c=>({...c,routes:o,routeInputHashes:l}))},getRoute(t){return Ta(ti,e=>e.routes.get(t)||null)},getRouteSync(t){return Je(ti).routes.get(t)||null},calcRoute(t,e,n,i="right",r="left"){const s=Je(ti),a=Ho(t.waypoints),o=Uo(e,n,i,r,s.grid,a);return ti.update(l=>{const c=new Map(l.routes);return c.set(t.id,o),{...l,routes:c}}),o},recalculateAllRoutes(t,e){const n=Je(ti),i=++zf,r=new Map,s=(f,p,d)=>{const y=`${f}:${p}:${d}`;return r.has(y)||r.set(y,e(f,p,d)),r.get(y)},a=new Map(n.routes),o=new Map,l=[...t].sort((f,p)=>{const d=s(f.sourceNodeId,f.sourcePortIndex,!0),y=s(f.targetNodeId,f.targetPortIndex,!1),m=s(p.sourceNodeId,p.sourcePortIndex,!0),w=s(p.targetNodeId,p.targetPortIndex,!1),b=d&&y?Math.abs(y.position.x-d.position.x)+Math.abs(y.position.y-d.position.y):0;return(m&&w?Math.abs(w.position.x-m.position.x)+Math.abs(w.position.y-m.position.y):0)-b}),c=new Map;for(const f of l){const p=`${f.sourceNodeId}:${f.sourcePortIndex}`,d=c.get(p)||[];d.push(f),c.set(p,d)}const u=[];for(const[,f]of c)u.push(...f);for(const f of u){const p=s(f.sourceNodeId,f.sourcePortIndex,!0),d=s(f.targetNodeId,f.targetPortIndex,!1);if(!p||!d)continue;const y=Ho(f.waypoints),m=Uo(p.position,d.position,p.direction,d.direction,n.grid,y);a.set(f.id,m),o.set(f.id,A2(p.position,d.position,p.direction,d.direction,y))}ti.update(f=>({...f,routes:a,routeInputHashes:o})),u.length>1&&this._refineRoutesAsync(i,u,c,s,o)},async _refineRoutesAsync(t,e,n,i,r){const s=new Map,a=new Map;let o=0;for(const[,l]of n){const c=[];for(const u of l){if(t!==zf)return;const f=Je(ti),p=i(u.sourceNodeId,u.sourcePortIndex,!0),d=i(u.targetNodeId,u.targetPortIndex,!1);if(!p||!d)continue;const y=Ho(u.waypoints),m=Uo(p.position,d.position,p.direction,d.direction,f.grid,y,s);if(a.set(u.id,m),m.path.length>0&&c.push(l7(m.path,2)),o++,o%d7===0&&(await new Promise(w=>requestAnimationFrame(()=>w())),t!==zf))return}for(const u of c)for(const[f,p]of u){s.has(f)||s.set(f,new Set);for(const d of p)s.get(f).add(d)}}t===zf&&ti.update(l=>{const c=new Map(l.routes);for(const[u,f]of a)c.set(u,f);return{...l,routes:c,routeInputHashes:new Map(r)}})},invalidateRoute(t){ti.update(e=>{const n=new Map(e.routes),i=new Map(e.routeInputHashes);return n.delete(t),i.delete(t),{...e,routes:n,routeInputHashes:i}})},invalidateRoutesForNodes(t){const n=Je(Fe.connections).filter(i=>t.has(i.sourceNodeId)||t.has(i.targetNodeId));ti.update(i=>{const r=new Map(i.routes),s=new Map(i.routeInputHashes);for(const a of n)r.delete(a.id),s.delete(a.id);return{...i,routes:r,routeInputHashes:s}})},addUserWaypoint(t,e,n){let i=null;return It.mutate(()=>{const s=Je(Fe.connections).find(c=>c.id===t);if(!s)return;i=sr();const a={id:i,position:e,isUserWaypoint:!0},l=[...Ho(s.waypoints),a];if(Fe.updateConnectionWaypoints(t,l),n){const c=Je(ti),u=n(s.sourceNodeId,s.sourcePortIndex,!0),f=n(s.targetNodeId,s.targetPortIndex,!1);if(u&&f){const p=Uo(u.position,f.position,u.direction,f.direction,c.grid,l);ti.update(d=>{const y=new Map(d.routes);return y.set(t,p),{...d,routes:y}});return}}Ci.invalidateRoute(t)}),i},addUserWaypointAtIndex(t,e,n,i){let r=null;return It.mutate(()=>{const a=Je(Fe.connections).find(u=>u.id===t);if(!a)return;r=sr();const o={id:r,position:e,isUserWaypoint:!0},l=Ho(a.waypoints),c=[...l.slice(0,n),o,...l.slice(n)];if(Fe.updateConnectionWaypoints(t,c),i){const u=Je(ti),f=i(a.sourceNodeId,a.sourcePortIndex,!0),p=i(a.targetNodeId,a.targetPortIndex,!1);if(f&&p){const d=Uo(f.position,p.position,f.direction,p.direction,u.grid,c);ti.update(y=>{const m=new Map(y.routes);return m.set(t,d),{...y,routes:m}});return}}Ci.invalidateRoute(t)}),r},removeUserWaypoint(t,e,n){It.mutate(()=>{const r=Je(Fe.connections).find(a=>a.id===t);if(!r?.waypoints)return;const s=r.waypoints.filter(a=>a.id!==e||!a.isUserWaypoint);if(Fe.updateConnectionWaypoints(t,s),n){const a=Je(ti),o=n(r.sourceNodeId,r.sourcePortIndex,!0),l=n(r.targetNodeId,r.targetPortIndex,!1);if(o&&l){const c=Ho(s),u=Uo(o.position,l.position,o.direction,l.direction,a.grid,c);ti.update(f=>{const p=new Map(f.routes);return p.set(t,u),{...f,routes:p}});return}}Ci.invalidateRoute(t)})},moveWaypoint(t,e,n,i){const s=Je(Fe.connections).find(o=>o.id===t);if(!s?.waypoints)return;const a=s.waypoints.map(o=>o.id===e?{...o,position:n}:o);if(Fe.updateConnectionWaypoints(t,a),i){const o=Je(ti),l=i(s.sourceNodeId,s.sourcePortIndex,!0),c=i(s.targetNodeId,s.targetPortIndex,!1);if(l&&c){const u=Ho(a),f=Uo(l.position,c.position,l.direction,c.direction,o.grid,u);ti.update(p=>{const d=new Map(p.routes);return d.set(t,f),{...p,routes:d}});return}}Ci.invalidateRoute(t)},cleanupWaypoints(t,e){const i=Je(Fe.connections).find(_=>_.id===t);if(!i?.waypoints)return;const r=Ho(i.waypoints);if(r.length===0)return;let s=null,a=null;e&&(s=e(i.sourceNodeId,i.sourcePortIndex,!0),a=e(i.targetNodeId,i.targetPortIndex,!1));const o=s?.position||null,l=a?.position||null,c=15,u=5,f=(_,I,E)=>{const M=E.x-_.x,T=E.y-_.y,D=Math.sqrt(M*M+T*T);return D<1?!0:Math.abs((I.x-_.x)*T-(I.y-_.y)*M)/D<u},p=(_,I)=>Math.sqrt((_.x-I.x)**2+(_.y-I.y)**2);let d=[...r],y=!1;for(let _=d.length-1;_>0;_--)p(d[_].position,d[_-1].position)<c&&(d.splice(_,1),y=!0);const m=[];o&&m.push(o),m.push(...d.map(_=>_.position)),l&&m.push(l);const w=o?1:0,b=l?m.length-1:m.length,S=new Set;for(let _=w;_<b;_++){const I=o?_-1:_;if(I<0||I>=d.length)continue;const E=m[_-1],M=m[_],T=m[_+1];E&&T&&f(E,M,T)&&(S.add(I),y=!0)}const A=Array.from(S).sort((_,I)=>I-_);for(const _ of A)d.splice(_,1);if(y){Fe.updateConnectionWaypoints(t,d);const _=Je(ti);if(s&&a){const I=Uo(s.position,a.position,s.direction,a.direction,_.grid,d);ti.update(E=>{const M=new Map(E.routes);return M.set(t,I),{...E,routes:M}})}}},resetRoute(t){It.mutate(()=>{Fe.updateConnectionWaypoints(t,[]),Ci.invalidateRoute(t)})},clearRoutes(){ti.update(t=>({...t,routes:new Map,routeInputHashes:new Map}))},clearContext(){ti.update(t=>({...t,routes:new Map,routeInputHashes:new Map,context:null,grid:null}))}};function f7(t,e=100){const n=new Map;let i=1/0,r=1/0,s=-1/0,a=-1/0;for(const l of t){const c=l.measured?.width??l.width??80,u=l.measured?.height??l.height??40,f=l.position.x-c/2,p=l.position.y-u/2;n.set(l.id,{x:f,y:p,width:c,height:u}),i=Math.min(i,f-Wl),r=Math.min(r,p-Wl),s=Math.max(s,f+c+Wl),a=Math.max(a,p+u+Wl)}const o={x:i-e,y:r-e,width:s-i+2*e,height:a-r+2*e};return{nodeBounds:n,canvasBounds:o}}const cu=ln(null);let Oi=null;cu.subscribe(t=>Oi=t);var h7=rt('<circle r="4"></circle>'),p7=rt('<circle r="3" class="segment-midpoint svelte-5viyfv"></circle>'),g7=rt('<g><!><g class="waypoint-group svelte-5viyfv"><!><!></g><g><path d="M -5 -2.5 L -1 -0.5 Q 0 0 -1 0.5 L -5 2.5 Q -6 3 -6 2 L -6 -2 Q -6 -3 -5 -2.5 Z"></path></g></g>');function m7(t,e){Tt(e,!0);function n(ee){switch(ee){case Kt.Left:return"left";case Kt.Right:return"right";case Kt.Top:return"up";case Kt.Bottom:return"down";default:return"right"}}function i(ee,de,he){return he&&ee===e.source?{position:{x:e.sourceX,y:e.sourceY},direction:n(e.sourcePosition)}:!he&&ee===e.target?{position:{x:e.targetX,y:e.targetY},direction:n(e.targetPosition)}:null}let r=Oe(null);cu.subscribe(ee=>J(r,ee,!0));const s=ne(()=>h(r)?.edgeId===e.id),a=ne(()=>h(r)?.edgeId===e.id?h(r).waypointId:null);function o(ee,de){ee.stopPropagation(),ee.preventDefault();const he=ge=>{if(!Oi||Oi.edgeId!==e.id)return;ge.stopPropagation(),ge.preventDefault();const Ee=uo({x:ge.clientX,y:ge.clientY}),Ae={x:Math.round(Ee.x/Yn)*Yn,y:Math.round(Ee.y/Yn)*Yn};Ae.x===Oi.lastSnappedPos.x&&Ae.y===Oi.lastSnappedPos.y||(Oi.lastSnappedPos=Ae,Ci.moveWaypoint(Oi.edgeId,Oi.waypointId,Ae,Oi.getPortInfo))},pe=ge=>{if(!Oi)return;ge.stopPropagation(),ge.preventDefault(),document.removeEventListener("pointermove",he,{capture:!0}),document.removeEventListener("pointerup",pe,{capture:!0});const Ee=Oi;cu.set(null),It.endDrag(),Ci.cleanupWaypoints(Ee.edgeId,Ee.getPortInfo)};cu.set({edgeId:e.id,waypointId:de.id,lastSnappedPos:{...de.position},getPortInfo:i,cleanup:()=>{document.removeEventListener("pointermove",he,{capture:!0}),document.removeEventListener("pointerup",pe,{capture:!0})}}),It.beginDrag(),document.addEventListener("pointermove",he,{capture:!0}),document.addEventListener("pointerup",pe,{capture:!0})}function l(ee,de){ee.stopPropagation(),ee.preventDefault(),Ci.removeUserWaypoint(e.id,de.id,i)}let c=Oe(null),u=null;mn(()=>{u&&u(),u=Ci.getRoute(e.id).subscribe(ee=>J(c,ee,!0))});let f=Oe(null);const p=md.subscribe(ee=>J(f,ee,!0));let d=Oe(null);const y=Um.subscribe(ee=>J(d,ee,!0));Ei(()=>{u&&u(),p(),y()});const m=ne(()=>()=>h(f)?e.source===h(f).nodeId&&e.sourceHandleId===h(f).handleId||e.target===h(f).nodeId&&e.targetHandleId===h(f).handleId:!1),w=ne(()=>()=>h(d)?e.source===h(d).nodeId||e.target===h(d).nodeId:!1),b=ne(()=>()=>h(m)()||h(w)()),S=ne(()=>()=>h(m)()?h(f)?.color||"var(--accent)":h(w)()&&h(d)?.color||"var(--accent)"),A=.5,_=4.5,I=ne(()=>()=>{let ee=e.sourceX,de=e.sourceY;return e.sourcePosition==="right"?ee-=A:e.sourcePosition==="left"?ee+=A:e.sourcePosition==="bottom"?de-=A:e.sourcePosition==="top"&&(de+=A),{x:ee,y:de}}),E=ne(()=>()=>{let ee=e.targetX,de=e.targetY;return e.targetPosition==="right"?ee+=_:e.targetPosition==="left"?ee-=_:e.targetPosition==="bottom"?de+=_:e.targetPosition==="top"&&(de-=_),{x:ee,y:de}}),M=5;function T(ee,de){if(ee.length<2)return"";if(ee.length===2)return`M ${ee[0].x} ${ee[0].y} L ${ee[1].x} ${ee[1].y}`;let he=`M ${ee[0].x} ${ee[0].y}`;for(let ge=1;ge<ee.length-1;ge++){const Ee=ee[ge-1],Ae=ee[ge],Ye=ee[ge+1],K=Math.hypot(Ae.x-Ee.x,Ae.y-Ee.y),Re=Math.hypot(Ye.x-Ae.x,Ye.y-Ae.y),Qe=Math.min(de,K/2,Re/2);if(Qe<.5){he+=` L ${Ae.x} ${Ae.y}`;continue}const Be=(Ee.x-Ae.x)/K,Ie=(Ee.y-Ae.y)/K,lt=(Ye.x-Ae.x)/Re,We=(Ye.y-Ae.y)/Re,Ke=Ae.x+Be*Qe,ht=Ae.y+Ie*Qe,Rt=Ae.x+lt*Qe,ye=Ae.y+We*Qe;he+=` L ${Ke} ${ht} Q ${Ae.x} ${Ae.y} ${Rt} ${ye}`}const pe=ee[ee.length-1];return he+=` L ${pe.x} ${pe.y}`,he}let D=Oe("");mn(()=>{if(h(c)?.path&&h(c).path.length>=1&&!h(c).isFallback){const ee=h(I)(),de=h(E)(),he=[ee,...h(c).path,de];J(D,T(he,M),!0)}});const U=ne(()=>()=>{const ee=h(I)(),de=h(E)(),[he]=hp({sourceX:ee.x,sourceY:ee.y,sourcePosition:e.sourcePosition,targetX:de.x,targetY:de.y,targetPosition:e.targetPosition,borderRadius:8});return he}),C=ne(()=>()=>h(D)?{path:h(D),isFallback:!1}:{path:h(U)(),isFallback:!0}),N=ne(()=>()=>h(c)?.waypoints?h(c).waypoints.filter(de=>de.isUserWaypoint):e.data?.waypoints?.filter(de=>de.isUserWaypoint)||[]),B=ne(()=>()=>{if(!h(c)?.path||h(c).path.length<1)return[];const ee=h(I)(),de=h(E)(),he=[ee,...h(c).path,de],pe=h(N)(),ge=20,Ee=(Ye,K)=>{for(const Re of pe)if(Math.hypot(Re.position.x-Ye,Re.position.y-K)<ge)return!0;return!1},Ae=[];for(let Ye=0;Ye<he.length-1;Ye++){const K=he[Ye],Re=he[Ye+1];if(Math.hypot(Re.x-K.x,Re.y-K.y)>30){const Be=(K.x+Re.x)/2,Ie=(K.y+Re.y)/2;Ee(Be,Ie)||Ae.push({x:Be,y:Ie,segmentIndex:Ye})}}return Ae}),P=ne(()=>()=>e.selected||h(s));function F(ee,de){ee.stopPropagation(),ee.preventDefault();const he=uo({x:ee.clientX,y:ee.clientY}),pe={x:Math.round(he.x/Yn)*Yn,y:Math.round(he.y/Yn)*Yn},ge=h(N)(),Ee=q(de,ge),Ae=Ci.addUserWaypointAtIndex(e.id,pe,Ee,i);if(Ae){const Ye=Re=>{if(!Oi||Oi.edgeId!==e.id)return;Re.stopPropagation(),Re.preventDefault();const Qe=uo({x:Re.clientX,y:Re.clientY}),Be={x:Math.round(Qe.x/Yn)*Yn,y:Math.round(Qe.y/Yn)*Yn};Be.x===Oi.lastSnappedPos.x&&Be.y===Oi.lastSnappedPos.y||(Oi.lastSnappedPos=Be,Ci.moveWaypoint(Oi.edgeId,Oi.waypointId,Be,Oi.getPortInfo))},K=Re=>{if(!Oi)return;Re.stopPropagation(),Re.preventDefault(),document.removeEventListener("pointermove",Ye,{capture:!0}),document.removeEventListener("pointerup",K,{capture:!0});const Qe=Oi;cu.set(null),It.endDrag(),Ci.cleanupWaypoints(Qe.edgeId,Qe.getPortInfo)};cu.set({edgeId:e.id,waypointId:Ae,lastSnappedPos:pe,getPortInfo:i,cleanup:()=>{document.removeEventListener("pointermove",Ye,{capture:!0}),document.removeEventListener("pointerup",K,{capture:!0})}}),It.beginDrag(),document.addEventListener("pointermove",Ye,{capture:!0}),document.addEventListener("pointerup",K,{capture:!0})}}function q(ee,de){if(de.length===0||!h(c)?.path)return 0;const he=h(I)(),pe=h(E)(),ge=[he,...h(c).path,pe],Ee=[0];for(let K=1;K<ge.length;K++){const Re=ge[K-1],Qe=ge[K];Ee.push(Ee[K-1]+Math.hypot(Qe.x-Re.x,Qe.y-Re.y))}const Ae=(Ee[ee]+Ee[ee+1])/2;let Ye=0;for(const K of de){let Re=1/0,Qe=0;for(let Be=0;Be<ge.length;Be++){const Ie=ge[Be],lt=Math.hypot(Ie.x-K.position.x,Ie.y-K.position.y);lt<Re&&(Re=lt,Qe=Ee[Be])}Qe<Ae&&Ye++}return Ye}const Z=ne(()=>()=>{const ee=h(E)(),{isFallback:de}=h(C)();if(!de&&h(c)?.path&&h(c).path.length>=1){const pe=h(c).path,ge=ee,Ee=pe[pe.length-1],Ae=ge.x-Ee.x,Ye=ge.y-Ee.y,K=Math.atan2(Ye,Ae)*(180/Math.PI);return{x:ge.x,y:ge.y,angle:K}}const{path:he}=h(C)();if(he){const pe=document.createElementNS("http://www.w3.org/2000/svg","path");pe.setAttribute("d",he);const ge=pe.getTotalLength(),Ee=pe.getPointAtLength(ge),Ae=pe.getPointAtLength(ge-5),Ye=Math.atan2(Ee.y-Ae.y,Ee.x-Ae.x)*(180/Math.PI);return{x:Ee.x,y:Ee.y,angle:Ye}}return{x:ee.x,y:ee.y,angle:0}});var W=g7();let Y;var ue=se(W);{let ee=ne(()=>h(C)().path);Jd(ue,{get id(){return e.id},get path(){return h(ee)},get style(){return e.style}})}var le=be(ue),O=se(le);fn(O,17,()=>h(N)(),ee=>ee.id,(ee,de)=>{var he=h7();let pe;he.__pointerdown=ge=>o(ge,h(de)),he.__dblclick=ge=>l(ge,h(de)),_e(()=>{fe(he,"cx",h(de).position.x),fe(he,"cy",h(de).position.y),pe=Xt(he,0,"waypoint-marker svelte-5viyfv",null,pe,{dragging:h(s)&&h(a)===h(de).id})}),j(ee,he)});var V=be(O);fn(V,17,()=>h(B)(),ee=>ee.segmentIndex,(ee,de)=>{var he=p7();he.__pointerdown=pe=>F(pe,h(de).segmentIndex),_e(()=>{fe(he,"cx",h(de).x),fe(he,"cy",h(de).y)}),j(ee,he)}),Q(le);var G=be(le),re=se(G);let ae;Q(G),Q(W),_e((ee,de,he,pe,ge,Ee,Ae,Ye)=>{An(W,`--highlight-color: ${ee??""}`),Y=Xt(W,0,"svelte-5viyfv",null,Y,de),An(le,`opacity: ${he??""}; pointer-events: ${pe??""};`),fe(G,"transform",`translate(${ge??""}, ${Ee??""}) rotate(${Ae??""}) translate(5, 0)`),ae=Xt(re,0,"edge-arrow svelte-5viyfv",null,ae,Ye)},[()=>h(S)(),()=>({highlighted:h(b)()}),()=>h(P)()?1:0,()=>h(P)()?"all":"none",()=>h(Z)().x,()=>h(Z)().y,()=>h(Z)().angle,()=>({selected:e.selected,highlighted:h(b)()})]),j(t,W),Dt()}Kn(["pointerdown","dblclick"]);let Mg=null;const Ww={registerDropHandler(t){Mg=t},handleDrop(t){Mg&&Mg(t)}},Na={nodeDuration:500,nodeStagger:50,flyDistanceMargin:100,edgeDuration:300,arrowDuration:150,initialDelay:100,fitViewDelay:50};function v7(){return typeof window>"u"?!1:new URLSearchParams(window.location.search).get("fancyloading")!=="false"}const Vw=ln(0);let pu=new Map,Gh=new Map,Cd=new Map,Xl=!1,sa=null;function Gw(t){t.code==="Space"&&!t.repeat&&Xl&&(t.preventDefault(),Kw())}function Xw(t){if(!Xl)return;t.target.closest(".svelte-flow__pane")&&Kw()}function y7(){window.addEventListener("keydown",Gw),document.addEventListener("click",Xw,!0)}function Yw(){window.removeEventListener("keydown",Gw),document.removeEventListener("click",Xw,!0)}function b7(){Vw.update(t=>t+1)}function Kw(){Xl&&(sa&&(clearTimeout(sa),sa=null),Zw())}function w7(t,e,n,i){v7()&&((Xl||sa)&&(sa&&(clearTimeout(sa),sa=null),document.querySelectorAll(".assembling").forEach(r=>{r.classList.remove("assembling")}),Xl=!1,Yw()),document.body.classList.add("assembly-pending"),setTimeout(()=>{n(),setTimeout(()=>{const r=t(),s=e(),a=i();if(r.length===0){document.body.classList.remove("assembly-pending");return}x7(r,s,a),document.body.classList.remove("assembly-pending"),_7()},Na.fitViewDelay)},Na.initialDelay))}function x7(t,e,n){const i=[...t].sort(()=>Math.random()-.5),r=-n.x/n.zoom,s=-n.y/n.zoom,a=Na.flyDistanceMargin,o=r-a,l=s-a;pu=new Map,Gh=new Map,i.forEach((p,d)=>{pu.set(p.id,d*Na.nodeStagger),Gh.set(p.id,{x:o-p.x,y:l-p.y})}),Cd=new Map,e.forEach(p=>{const d=pu.get(p.source)??0,y=pu.get(p.target)??0,m=Math.max(d,y)+Na.nodeDuration*.7;Cd.set(p.id,m)}),sa&&(clearTimeout(sa),sa=null),Xl=!0,y7();const c=i.length*Na.nodeStagger,u=Math.max(...Array.from(Cd.values()),0),f=Math.max(c,u)+Na.nodeDuration+Na.edgeDuration+Na.arrowDuration+200;sa=setTimeout(Zw,f)}function _7(){if(!Xl)return;const t=document.querySelectorAll(".svelte-flow__node"),e=document.querySelectorAll(".svelte-flow__edge");t.forEach(n=>{const i=n.getAttribute("data-id");if(!i)return;const r=pu.get(i)??0,s=Gh.get(i)??{x:0,y:-100},a=n;a.style.setProperty("--assembly-delay",`${r}ms`),a.style.setProperty("--assembly-duration",`${Na.nodeDuration}ms`),a.style.setProperty("--fly-from-x",`${s.x}px`),a.style.setProperty("--fly-from-y",`${s.y}px`),n.classList.add("assembling")}),e.forEach(n=>{const i=n.getAttribute("data-id");if(!i)return;const r=Cd.get(i)??0,s=n,a=n.querySelector("path.svelte-flow__edge-path");if(a){const o=a.getTotalLength();s.style.setProperty("--edge-length",`${o}`)}s.style.setProperty("--assembly-delay",`${r}ms`),s.style.setProperty("--assembly-duration",`${Na.edgeDuration}ms`),n.classList.add("assembling")})}function Zw(){document.querySelectorAll(".assembling").forEach(t=>{t.classList.remove("assembling");const e=t;e.style.removeProperty("--assembly-delay"),e.style.removeProperty("--assembly-duration"),e.style.removeProperty("--fly-from-x"),e.style.removeProperty("--fly-from-y"),e.style.removeProperty("--edge-length")}),document.body.classList.remove("assembly-pending"),pu=new Map,Gh=new Map,Cd=new Map,Xl=!1,sa=null,Yw()}const Tg={duration:300,flyDistanceMargin:100};function S7(t,e,n,i,r){let s,a;if(i&&r){const u=r(i);s=u.x-e.x,a=u.y-e.y}else{const u=n();s=-u.x/u.zoom-Tg.flyDistanceMargin-e.x,a=0}let o=0;const l=20;function c(){const u=document.querySelector(`[data-id="${t}"]`);if(!u){o++,o<l&&requestAnimationFrame(c);return}u.style.translate=`${s}px ${a}px`,u.style.scale="0.8",u.style.opacity="0",u.style.setProperty("--fly-from-x",`${s}px`),u.style.setProperty("--fly-from-y",`${a}px`),u.style.setProperty("--assembly-duration",`${Tg.duration}ms`),u.style.setProperty("--assembly-delay","0ms"),requestAnimationFrame(()=>{u.style.removeProperty("translate"),u.style.removeProperty("scale"),u.style.removeProperty("opacity"),u.classList.add("assembling"),setTimeout(()=>{u.classList.remove("assembling"),u.style.removeProperty("--fly-from-x"),u.style.removeProperty("--fly-from-y"),u.style.removeProperty("--assembly-duration"),u.style.removeProperty("--assembly-delay")},Tg.duration+50)})}requestAnimationFrame(c)}const Ym=[".blk",".sub",".pvm",".json"],p0="1.0";function k7(t){const e=Pi.get(t.type),n=new Set(e?.params.map(r=>r.name)||[]),i={};for(const[r,s]of Object.entries(t.params))if(!(s==null||s==="")){if(r.startsWith("_")){i[r]=s;continue}n.has(r)&&(i[r]=s)}return i}function xp(t){const e={...t,params:k7(t)};return e.graph?.nodes&&(e.graph={...e.graph,nodes:e.graph.nodes.map(n=>xp(n))}),e}const bd=ln(""),cd=ln(null),Dg=Ta(bd,t=>{const e=[],n=t.matchAll(/def\s+(\w+)\s*\(/g);for(const r of n)e.push(r[1]);const i=t.matchAll(/^(\w+)\s*=/gm);for(const r of i)e.push(r[1]);return[...new Set(e)]}),Os={code:{subscribe:bd.subscribe},lastError:{subscribe:cd.subscribe},definedNames:{subscribe:Dg.subscribe},setCode(t){bd.set(t),cd.set(null),vp()&&t.trim()&&dw("code_context",t.trim())},getCode(){return Je(bd)},setError(t){cd.set(t)},clearError(){cd.set(null)},hasName(t){return Je(Dg).includes(t)},getDefinedNames(){return Je(Dg)},clear(){bd.set(""),cd.set(null)}},_p={JSON:"application/json",CSV:"text/csv;charset=utf-8;",SVG:"image/svg+xml",PYTHON:"text/x-python"};function Sp(t,e,n){const i=new Blob([t],{type:n}),r=URL.createObjectURL(i),s=document.createElement("a");s.href=r,s.download=e,document.body.appendChild(s),s.click(),document.body.removeChild(s),URL.revokeObjectURL(r)}function Jw(t,e){const n=typeof t=="string"?t:JSON.stringify(t,null,"	");Sp(n,e,_p.JSON)}function Qw(t,e){Sp(t,e,_p.CSV)}function A7(t,e){Sp(t,e,_p.SVG)}function N7(t,e){Sp(t,e,_p.PYTHON)}const g0={open:!1,options:null,resolve:null},kp=ln(g0);function C7(t){return new Promise(e=>{kp.set({open:!0,options:{confirmText:"Confirm",cancelText:"Cancel",...t},resolve:e})})}function P7(){kp.update(t=>(t.resolve&&t.resolve(!0),g0))}function E7(){kp.update(t=>(t.resolve&&t.resolve(!1),g0))}const Pd={subscribe:kp.subscribe,show:C7,confirm:P7,cancel:E7},$w="pathview_autosave",I7=".pvm";let qf=null,jd=null;const Xu=ln(null);function Ap(){return"showSaveFilePicker"in window&&"showOpenFilePicker"in window}const L7={subscribe:Xu.subscribe};function ex(){let t=null;return Xu.subscribe(e=>t=e)(),t}function M7(){jd=null,Xu.set(null)}function Np(t){const{nodes:e,connections:n,annotations:i}=Fe.toJSON(),r=vn.toJSON(),s=is.get(),a=Os.getCode(),o=e.map(c=>xp(c)),l=Object.fromEntries(Object.entries(s).map(([c,u])=>[c,u===""?null:u]));return{version:RC,metadata:{created:new Date().toISOString(),modified:new Date().toISOString(),name:t||"Untitled"},graph:{nodes:o,connections:n,annotations:i},events:r,codeContext:{code:a},simulationSettings:l}}function T7(t){if(t.startsWith("pathsim.")){const e=t.split(".");return e[e.length-1]}return t}function D7(t){const e=n=>n.map(i=>{const r={...i,type:T7(i.type)};return r.graph&&(r.graph={nodes:e(r.graph.nodes||[]),connections:r.graph.connections||[],annotations:r.graph.annotations,events:r.graph.events}),r});return{...t,graph:t.graph?{...t.graph,nodes:e(t.graph.nodes||[])}:t.graph}}async function O7(t){if(t=D7(t),!t.version)throw new Error("Invalid file: missing version");if(Iw(),Fe.clear(),vn.clear(),ri.clear(),await Nb(),Fe.fromJSON(t.graph?.nodes||[],t.graph?.connections||[],t.graph?.annotations||[]),t.events&&t.events.length>0&&vn.fromJSON(t.events),t.codeContext?.code?Os.setCode(t.codeContext.code):Os.clear(),t.simulationSettings){const e=t.simulationSettings,n={...ts,solver:e.solver??ts.solver,ghostTraces:e.ghostTraces??ts.ghostTraces,plotResults:e.plotResults??ts.plotResults,adaptive:e.adaptive??ts.adaptive,duration:e.duration!=null?String(e.duration):ts.duration,dt:e.dt!=null?String(e.dt):ts.dt,rtol:e.rtol!=null?String(e.rtol):ts.rtol,atol:e.atol!=null?String(e.atol):ts.atol,ftol:e.ftol!=null?String(e.ftol):ts.ftol,dt_min:e.dt_min!=null?String(e.dt_min):ts.dt_min,dt_max:e.dt_max!=null?String(e.dt_max):ts.dt_max};is.set(n)}else is.reset();It.clear(),b7()}function tx(){try{const t=Np("Autosave");localStorage.setItem($w,JSON.stringify(t))}catch(t){console.warn("Autosave failed:",t)}}function N2(t=500){qf&&clearTimeout(qf),qf=setTimeout(()=>{tx(),qf=null},t)}function nx(){localStorage.removeItem($w)}async function F7(){if(jd&&Ap())try{const t=Np(ex()||void 0),e=JSON.stringify(t,null,2),n=await jd.createWritable();return await n.write(e),await n.close(),!0}catch(t){console.warn("Failed to save to current file:",t)}return ix()}async function ix(){const t=(ex()||"pathview_graph")+I7;if(Ap())try{const e=await window.showSaveFilePicker({suggestedName:t,types:[{description:"PathView Model",accept:{"application/json":[".pvm",".json"]}}]}),n=e.name.replace(/\.(pvm|json)$/,""),i=Np(n),r=JSON.stringify(i,null,2),s=await e.createWritable();return await s.write(r),await s.close(),jd=e,Xu.set(n),!0}catch(e){if(e.name==="AbortError")return!1;console.error("Failed to save file:",e)}return R7(t),!0}function R7(t){const e=t.replace(/\.(pvm|json)$/,""),n=Np(e);Jw(n,t),Xu.set(e)}function B7(){Iw(),Fe.clear(),vn.clear(),Os.clear(),ri.clear(),is.reset(),It.clear(),nx(),M7()}function z7(t=3e4){const e=setInterval(tx,t);return()=>clearInterval(e)}function q7(t){if(typeof t!="object"||t===null)return"unknown";const e=t;return"type"in e&&["block","subsystem","model"].includes(e.type)?"component":"graph"in e&&"version"in e?"legacy-model":"unknown"}function rx(t,e){const n=JSON.parse(t),i=q7(n);if(i==="unknown")throw new Error("Invalid file format");return i==="legacy-model"?{version:p0,type:"model",metadata:{name:n.metadata?.name||e.replace(/\.(json|pvm)$/,""),created:n.metadata?.created||new Date().toISOString(),modified:n.metadata?.modified||new Date().toISOString()},content:{graph:n.graph,events:n.events,codeContext:n.codeContext,simulationSettings:n.simulationSettings}}:n}function Xh(t){const e=[];for(const n of t){if(n.type===_n.SUBSYSTEM||n.type===_n.INTERFACE){n.graph?.nodes&&e.push(...Xh(n.graph.nodes));continue}Pi.has(n.type)||e.push(n.type),n.graph?.nodes&&e.push(...Xh(n.graph.nodes))}return[...new Set(e)]}function j7(t,e){const n=t.node,i=Xh([n]);if(i.length>0)throw new Error(`Unknown block type(s): ${i.join(", ")}`);const r=ow(n,e);return It.mutate(()=>{Fe.clearSelection(),vn.clearSelection(),Fe.pasteNodes([r],[])}),[r.id]}async function H7(t,e){if(Je(Fe.nodesArray).length>0&&!await Pd.show({title:"Unsaved Changes",message:"Opening this file will discard your current work. Continue?",confirmText:"Discard & Open",cancelText:"Cancel"}))return{success:!1,type:"model",cancelled:!0};const i=t.content,r={version:t.version,metadata:t.metadata,graph:i.graph||{nodes:[],connections:[]},events:i.events,codeContext:i.codeContext||{code:""},simulationSettings:i.simulationSettings||ts};return await O7(r),jd=e.fileHandle||null,Xu.set(e.fileName?.replace(/\.(pvm|json)$/,"")||t.metadata.name||null),{success:!0,type:"model"}}async function sx(t,e){switch(t.type){case"block":case"subsystem":{const n=e.position||{x:100,y:100},i=j7(t.content,n);return{success:!0,type:t.type,nodeIds:i}}case"model":return H7(t,e);default:return{success:!1,type:t.type,error:`Unknown component type: ${t.type}`}}}async function Km(t,e={}){try{const n=await t.text(),i=rx(n,t.name);return sx(i,{...e,fileName:e.fileName||t.name})}catch(n){return{success:!1,type:"model",error:n instanceof Error?n.message:"Unknown error"}}}async function U7(t,e={}){try{const n=await fetch(t);if(!n.ok)throw new Error(`Failed to fetch file: ${n.status} ${n.statusText}`);const i=await n.text(),r=e.fileName||t.split("/").pop()||"model.pvm",s=rx(i,r);return sx(s,{...e,fileName:r})}catch(n){return{success:!1,type:"model",error:n instanceof Error?n.message:"Unknown error"}}}async function ax(t){if(Ap())try{const[e]=await window.showOpenFilePicker({types:[{description:"PathView Files",accept:{"application/json":Ym}}],multiple:!1}),n=await e.getFile();return Km(n,{position:t,fileHandle:e,fileName:e.name})}catch(e){return e.name==="AbortError"?{success:!1,type:"model",cancelled:!0}:(console.error("Failed to open file:",e),{success:!1,type:"model",error:"Failed to open file. Make sure it is a valid PathView file."})}return new Promise(e=>{const n=document.createElement("input");n.type="file",n.accept=Ym.join(","),n.onchange=async()=>{const i=n.files?.[0];if(!i){e({success:!1,type:"model",cancelled:!0});return}const r=await Km(i,{position:t,fileName:i.name});e(r)},n.oncancel=()=>e({success:!1,type:"model",cancelled:!0}),n.click()})}function W7(t,e){Tt(e,!0),ct(e,"edges",19,()=>[]);const{getNodes:n,getEdges:i,fitView:r,zoomIn:s,zoomOut:a,getViewport:o,setViewport:l,screenToFlowPosition:c}=U5(),u=W5();function f(A,_=300){const I=n();if(I.length===0)return;let E=1/0,M=1/0,T=-1/0,D=-1/0;for(const ae of I){const ee=ae.measured?.width??ae.width??160,de=ae.measured?.height??ae.height??60,he=ae.origin??[.5,.5],pe=ae.position.x-ee*he[0],ge=ae.position.y-de*he[1];E=Math.min(E,pe),M=Math.min(M,ge),T=Math.max(T,pe+ee),D=Math.max(D,ge+de)}const U=20;E-=U,M-=U,T+=U,D+=U;const C=T-E,N=D-M,B=window.innerWidth,P=window.innerHeight,F=B-A.left-A.right,q=P-A.top-A.bottom;if(F<=0||q<=0){r({padding:.1,duration:_});return}const Z=F/C,W=q/N,Y=Math.min(Z,W,1.5),ue=(E+T)/2,le=(M+D)/2,O=A.left+F/2,V=A.top+q/2,G=O-ue*Y,re=V-le*Y;l({x:G,y:re,zoom:Y},{duration:_})}ju(()=>{setTimeout(()=>{const A=Je(uh);f(A,300)},200),y8(c),Ww.registerDropHandler(async A=>{const _=c({x:A.clientX,y:A.clientY}),I=A.dataTransfer?.files;if(I&&I.length>0){const T=I[0],D="."+T.name.split(".").pop()?.toLowerCase();if(Ym.includes(D)){const U=await Km(T,{position:{x:_.x-80,y:_.y-30},fileName:T.name});!U.success&&!U.cancelled&&U.error&&alert(`Failed to import: ${U.error}`);return}}const E=A.dataTransfer?.getData("application/pathview-node");if(E){const T=Math.round(_.x/Fn)*Fn,D=Math.round(_.y/Fn)*Fn;It.mutate(()=>{Fe.addNode(E,{x:T,y:D})});return}const M=A.dataTransfer?.getData("application/pathview-event");if(M){const T={x:_.x-40,y:_.y-40};It.mutate(()=>{if(Fe.isAtRoot())vn.addEvent(M,T);else{const D=oa.get(M);if(D){const U={id:crypto.randomUUID(),type:M,name:D.name,position:T,params:{}};Fe.addSubsystemEvent(U)}}});return}})});let p=0;Z5.subscribe(A=>{if(A>p){const _=Je(uh);f(_,300),p=A}});let d=0;J5.subscribe(A=>{A>d&&(s({duration:200}),d=A)});let y=0;Q5.subscribe(A=>{A>y&&(a({duration:200}),y=A)});let m=0;$5.subscribe(A=>{if(A.id>m){const _=o();l({x:_.x+A.x,y:_.y+A.y,zoom:_.zoom}),m=A.id}});let w=0;ew.subscribe(A=>{A.id>w&&A.nodeId&&(r({nodes:[{id:A.nodeId}],padding:.5,duration:300,maxZoom:1.5}),w=A.id)}),mn(()=>{e.pendingUpdates.length>0&&setTimeout(()=>{e.pendingUpdates.forEach(A=>{typeof u=="function"&&u(A)}),e.onUpdatesProcessed()},10)}),mn(()=>{const A=setInterval(()=>{n().forEach(I=>{if(I.position){const E=Fe.getNode(I.id);E&&(Math.abs(E.position.x-I.position.x)>1||Math.abs(E.position.y-I.position.y)>1)&&Fe.updateNodePosition(I.id,I.position)}})},2e3);return()=>clearInterval(A)});let b=0;Vw.subscribe(A=>{if(A>b){b=A;const _=Je(uh);w7(()=>n().map(I=>({id:I.id,x:I.position.x,y:I.position.y})),()=>i().map(I=>({id:I.id,source:I.source,target:I.target})),()=>f(_,0),()=>{const I=o(),E=document.querySelector(".svelte-flow");return{zoom:I.zoom,x:I.x,y:I.y,width:E?.clientWidth??window.innerWidth,height:E?.clientHeight??window.innerHeight}})}});let S=0;sw.subscribe(A=>{A.id>S&&A.nodeId&&(S=A.id,S7(A.nodeId,A.position,()=>{const _=o(),I=document.querySelector(".svelte-flow");return{zoom:_.zoom,x:_.x,y:_.y,width:I?.clientWidth??window.innerWidth,height:I?.clientHeight??window.innerHeight}},A.cursorScreen,c))}),Dt()}function V7(){const t=new URL(window.location.href).searchParams.get("theme");if(t==="dark"||t==="light")return localStorage.setItem("pathview-theme",t),document.documentElement.setAttribute("data-theme",t),t;const e=localStorage.getItem("pathview-theme");return e==="light"||e==="dark"?e:window.matchMedia("(prefers-color-scheme: light)").matches?"light":"dark"}const wd=ln(V7());wd.subscribe(t=>{document.documentElement.setAttribute("data-theme",t),localStorage.setItem("pathview-theme",t)});const ol={subscribe:wd.subscribe,toggle(){wd.update(t=>t==="dark"?"light":"dark")},set(t){wd.set(t)},get(){let t="dark";return wd.subscribe(e=>t=e)(),t}},eo=ln({open:!1,position:{x:0,y:0},target:null}),so={subscribe:eo.subscribe,openForNode(t,e){eo.set({open:!0,position:e,target:{type:"node",nodeId:t}})},openForEvent(t,e){eo.set({open:!0,position:e,target:{type:"event",eventId:t}})},openForSelection(t,e){eo.set({open:!0,position:e,target:{type:"selection",nodeIds:t}})},openForEdge(t,e){eo.set({open:!0,position:e,target:{type:"edge",edgeId:t}})},openForCanvas(t){eo.set({open:!0,position:t,target:{type:"canvas"}})},openForAnnotation(t,e){eo.set({open:!0,position:e,target:{type:"annotation",annotationId:t}})},openForPlot(t,e,n){eo.set({open:!0,position:n,target:{type:"plot",nodeId:t,plotEl:e}})},close(){eo.set({open:!1,position:{x:0,y:0},target:null})},getState(){return Je(eo)}},jf=ln([]),C2={subscribe:jf.subscribe,queueUpdate(t){jf.update(e=>[...e,...t])},clear(){jf.set([])},get(){return Je(jf)}};function G7(t){return{id:t.id,type:"eventNode",position:{...t.position},data:t,origin:[.5,.5],selectable:!0,draggable:!0,connectable:!1,deletable:!0}}function X7(t){return{id:t.id,type:"annotation",position:{...t.position},data:t,width:t.width,height:t.height,origin:[0,0],selectable:!0,draggable:!0,connectable:!1,deletable:!0}}function P2(t){return{id:t.id,source:t.sourceNodeId,sourceHandle:Ou.output(t.sourceNodeId,t.sourcePortIndex),target:t.targetNodeId,targetHandle:Ou.input(t.targetNodeId,t.targetPortIndex),type:"orthogonal",data:{waypoints:t.waypoints},selectable:!0,deletable:!0,animated:!1}}function m0(t){return Fe.getNode(t)?.params?._rotation||0}function Y7(t){return(t+1)%4}function K7(t){return t===0?2:t===2?0:t}function Z7(t){return t===1?3:t===3?1:t}function J7(t){const e=t.filter(n=>n.selected);return e.length===0?[]:It.mutate(()=>{const n=[];for(const i of e){const r=m0(i.id),s=Y7(r);Fe.updateNodeParams(i.id,{_rotation:s}),n.push(i.id)}return n})}function Q7(t){const e=t.filter(n=>n.selected);return e.length===0?[]:It.mutate(()=>{const n=[];for(const i of e){const r=m0(i.id),s=K7(r);s!==r&&(Fe.updateNodeParams(i.id,{_rotation:s}),n.push(i.id))}return n})}function $7(t){const e=t.filter(n=>n.selected);return e.length===0?[]:It.mutate(()=>{const n=[];for(const i of e){const r=m0(i.id),s=Z7(r);s!==r&&(Fe.updateNodeParams(i.id,{_rotation:s}),n.push(i.id))}return n})}function eM(t){const n=Je(Fe.nodesArray).find(s=>s.id===t);if(!n)return null;const i=Je(Fe.connections),r=new Set(i.filter(s=>s.targetNodeId===t).map(s=>s.targetPortIndex));for(let s=0;s<n.inputs.length;s++)if(!r.has(s))return s;return null}var tM=Me('<div class="drop-zone-overlay svelte-5kezjk"><svg width="32" height="32" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"></path><polyline points="7 10 12 15 17 10"></polyline><line x1="12" y1="15" x2="12" y2="3"></line></svg></div>'),nM=Me("<!> <!>",1),iM=Me('<div class="flow-canvas svelte-5kezjk" role="application" aria-label="Flow canvas"><!> <!></div>');function rM(t,e){Tt(e,!0);let n=Oe("dark");const i=ol.subscribe(ye=>{J(n,ye,!0)});let r=null;function s(){r!==null&&clearTimeout(r),r=setTimeout(()=>{r=null,E()},0)}let a={x:0,y:0};function o(ye){a={x:ye.clientX,y:ye.clientY}}function l(ye){if(V5(ye))return;if(ye.key==="Delete"){const Pe=h(N).filter(it=>it.selected),Le=h(B).filter(it=>it.selected);(Pe.length>0||Le.length>0)&&(ye.preventDefault(),ae({nodes:Pe,edges:Le}));return}if(ye.key==="\\"){const Pe=h(B).find(Le=>Le.selected);if(Pe){ye.preventDefault();const Le=uo(a),it=10,nt=Math.round(Le.x/it)*it,_t=Math.round(Le.y/it)*it;Ci.addUserWaypoint(Pe.id,{x:nt,y:_t},I)}return}if(!h(N).some(Pe=>Pe.selected))return;let ve=[];ye.key==="r"||ye.key==="R"?(ye.preventDefault(),ve=J7(h(N))):ye.key==="x"||ye.key==="X"?(ye.preventDefault(),ve=Q7(h(N))):(ye.key==="y"||ye.key==="Y")&&(ye.preventDefault(),ve=$7(h(N))),ve.length>0&&(J(u,[...ve],!0),setTimeout(()=>{const Pe=Je(Fe.connections);Ci.recalculateRoutesForNodes(new Set(ve),Pe,I)},0))}let c=new Map,u=Oe(Rn([]));const f=C2.subscribe(ye=>{ye.length>0&&(J(u,[...h(u),...ye],!0),C2.clear())});b8(()=>h(N).some(ye=>ye.selected));let p=0;const d=tw.subscribe(ye=>{ye>p&&(p=ye,J(N,h(N).map(qe=>({...qe,selected:!1})),!0),J(B,h(B).map(qe=>({...qe,selected:!1})),!0),Cr.set(new Set),Cg(new Set))});let y=0;const m=nw.subscribe(ye=>{if(ye.id>y){y=ye.id;const qe={x:ye.x,y:ye.y};J(N,h(N).map(ve=>ve.selected?{...ve,position:{x:ve.position.x+qe.x,y:ve.position.y+qe.y}}:ve),!0),It.mutate(()=>{h(N).forEach(ve=>{ve.selected&&(ve.type==="eventNode"?Fe.isAtRoot()?vn.updateEventPosition(ve.id,ve.position):Fe.updateSubsystemEventPosition(ve.id,ve.position):ve.type==="annotation"?Fe.updateAnnotationPosition(ve.id,ve.position):Fe.updateNodePosition(ve.id,ve.position))})})}});let w=0;const b=iw.subscribe(ye=>{if(ye.id>w){w=ye.id;const qe=new Set(ye.nodeIds);J(N,h(N).map(ve=>qe.has(ve.id)?{...ve,selected:!0}:ye.addToSelection?ve:{...ve,selected:!1}),!0),ye.addToSelection||J(B,h(B).map(ve=>({...ve,selected:!1})),!0),S()}});function S(){const ye=h(N).filter(Pe=>Pe.selected),qe=new Set,ve=new Set;ye.forEach(Pe=>{Pe.type==="eventNode"?ve.add(Pe.id):Pe.type!=="annotation"&&qe.add(Pe.id)}),Cr.set(qe),Cg(ve)}const A=[i,f,d,m,b];Ei(()=>{A.forEach(ye=>ye()),r!==null&&clearTimeout(r)});function _(){J(u,[],!0)}function I(ye,qe,ve){const Pe=h(P).get(ye);if(!Pe)return null;const Le=Pe.data,it=ve?Le.outputs:Le.inputs;if(qe>=it.length)return null;const nt=Le.params?._rotation||0,_t=Pe.measured?.width??Pe.width??80,At=Pe.measured?.height??Pe.height??40,St=it.length,st=20,dt=-((St-1)*st)/2+qe*st;let bt=Pe.position.x,ot=Pe.position.y,vt;const jt=ve?y2:y2+JL;if(ve)switch(nt){case 1:bt+=dt,ot+=At/2+jt,vt="down";break;case 2:bt-=_t/2+jt,ot+=dt,vt="left";break;case 3:bt+=dt,ot-=At/2+jt,vt="up";break;default:bt+=_t/2+jt,ot+=dt,vt="right";break}else switch(nt){case 1:bt+=dt,ot-=At/2+jt,vt="up";break;case 2:bt+=_t/2+jt,ot+=dt,vt="right";break;case 3:bt+=dt,ot+=At/2+jt,vt="down";break;default:bt-=_t/2+jt,ot+=dt,vt="left";break}return{position:{x:bt,y:ot},direction:vt}}function E(){const ye=h(N).filter(it=>it.type==="pathview");if(ye.length===0){Ci.clearRoutes();return}const{nodeBounds:qe,canvasBounds:ve}=f7(ye),Pe=[];for(const it of ye){const nt=it.data;for(let _t=0;_t<nt.inputs.length;_t++){const At=I(it.id,_t,!1);At&&Pe.push({position:At.position,direction:At.direction})}for(let _t=0;_t<nt.outputs.length;_t++){const At=I(it.id,_t,!0);At&&Pe.push({position:At.position,direction:At.direction})}}Ci.setContext(qe,ve,Pe);const Le=Je(Fe.connections);Ci.recalculateAllRoutes(Le,I)}const M={pathview:oI,eventNode:uI,annotation:KL},T={orthogonal:m7};let D=Oe(Rn([])),U=Oe(Rn([])),C=Oe(Rn([])),N=Oe(Rn([])),B=Oe(Rn([])),P=ne(()=>new Map(h(N).map(ye=>[ye.id,ye])));mn(()=>{const ye=ia(()=>new Map(h(N).map(ve=>[ve.id,ve]))),qe=It.isRestoringState();J(N,[...h(D),...h(U),...h(C)].map(ve=>{const Pe=ye.get(ve.id);return Pe&&!qe?{...ve,position:Pe.position,selected:Pe.selected}:ve}),!0)});let F=!1,q=!1,Z=new Set;mn(()=>{const ye=new Set(h(N).map(ve=>ve.id)),qe=[...Z].filter(ve=>!ye.has(ve));qe.length>0&&!F&&(F=!0,qe.forEach(ve=>{const Pe=Fe.getNode(ve),Le=vn.getEvent(ve);!Pe&&!Le&&c.delete(ve)}),F=!1),Z=ye}),mn(()=>{F||h(N).forEach(ye=>{if(ye.type==="annotation"&&ye.width&&ye.height){const qe=Fe.getAnnotation(ye.id);qe&&(qe.width!==ye.width||qe.height!==ye.height)&&(F=!0,Fe.updateAnnotation(ye.id,{width:ye.width,height:ye.height}),F=!1)}})}),A.push(Fe.nodes.subscribe(ye=>{if(F)return;const qe=Array.from(ye.values()),ve=[],Pe=new Map(h(N).map(st=>[st.id,st])),Le=new Set(qe.map(st=>st.id)),it=new Set(h(N).map(st=>st.id)),nt=qe.some(st=>!it.has(st.id)),_t=h(N).some(st=>!Le.has(st.id)),At=qe.some(st=>{const Ot=Pe.get(st.id);if(!Ot)return!1;const dt=Ot.data,bt=c.get(st.id),ot={inputs:st.inputs.length,outputs:st.outputs.length};return!!(bt&&(bt.inputs!==ot.inputs||bt.outputs!==ot.outputs)||dt.name!==st.name||dt.color!==st.color||JSON.stringify(dt.params)!==JSON.stringify(st.params)||JSON.stringify(dt.pinnedParams)!==JSON.stringify(st.pinnedParams))});if(!nt&&!_t&&!At&&q)return;const St=qe.map(st=>{const Ot=Pe.get(st.id),dt=c.get(st.id),bt={inputs:st.inputs.length,outputs:st.outputs.length};if(dt&&(dt.inputs!==bt.inputs||dt.outputs!==bt.outputs)&&ve.push(st.id),c.set(st.id,bt),Ot){const kt=Ot.data?.params?._rotation??0,gt=st.params?._rotation??0;kt!==gt&&ve.push(st.id)}const ot=Ot&&!It.isRestoringState()?Ot.position:{...st.position},vt=st.type===_n.INTERFACE;return Ot?{id:Ot.id,type:Ot.type,position:ot,data:st,origin:[.5,.5],selectable:Ot.selectable,draggable:Ot.draggable,deletable:!vt}:{id:st.id,type:"pathview",position:ot,data:st,origin:[.5,.5],selectable:!0,draggable:!0,deletable:!vt}});for(const st of c.keys())Le.has(st)||c.delete(st);J(D,St,!0),ve.length>0&&(J(u,[...ve],!0),setTimeout(()=>{const st=Je(Fe.connections);Ci.recalculateRoutesForNodes(new Set(ve),st,I)},0)),qe.length>0&&!q&&setTimeout(()=>{q=!0},100)}));let W=[],Y=[],ue=[];function le(){const ye=W.length===0?Y:ue;J(U,ye.map(G7),!0)}A.push(Fe.currentPath.subscribe(ye=>{W=ye,le(),Ci.clearContext()})),A.push(vn.eventsArray.subscribe(ye=>{Y=ye,le()})),A.push(Fe.subsystemEvents.subscribe(ye=>{ue=Array.from(ye.values()),le()})),A.push(Fe.annotations.subscribe(ye=>{J(C,Array.from(ye.values()).map(X7),!0)})),A.push(Fe.connections.subscribe(ye=>{if(F)return;const qe=new Map(h(B).map(ve=>[ve.id,ve.selected]));J(B,ye.map(ve=>{const Pe=P2(ve);return qe.get(ve.id)&&(Pe.selected=!0),Pe}),!0),s()}));let O=new Map;function V({nodes:ye}){It.beginDrag(),O.clear();for(const qe of ye){const ve=Math.round(qe.position.x/Fn)*Fn,Pe=Math.round(qe.position.y/Fn)*Fn;O.set(qe.id,{x:ve,y:Pe})}}function G({nodes:ye}){const qe=new Set;for(const ve of ye){if(ve.type!=="pathview")continue;const Pe=Math.round(ve.position.x/Fn)*Fn,Le=Math.round(ve.position.y/Fn)*Fn,it=O.get(ve.id);if(!it||it.x!==Pe||it.y!==Le){O.set(ve.id,{x:Pe,y:Le}),qe.add(ve.id);const nt=ve.measured?.width??ve.width??80,_t=ve.measured?.height??ve.height??40;Ci.updateNodeBounds(ve.id,{x:Pe-nt/2,y:Le-_t/2,width:nt,height:_t})}}if(qe.size>0){const ve=Je(Fe.connections);Ci.recalculateRoutesForNodes(qe,ve,I)}}function re({targetNode:ye}){O.clear(),ye?.id&&ye?.position&&(F=!0,ye.type==="eventNode"?Fe.isAtRoot()?vn.updateEventPosition(ye.id,ye.position):Fe.updateSubsystemEventPosition(ye.id,ye.position):ye.type==="annotation"?Fe.updateAnnotationPosition(ye.id,ye.position):Fe.updateNodePosition(ye.id,ye.position),F=!1),It.endDrag(),E()}function ae({nodes:ye,edges:qe}){if(ye.length===0&&qe.length===0)return;F=!0,It.mutate(()=>{ye.forEach(Le=>{Le.type==="eventNode"?Fe.isAtRoot()?vn.getEvent(Le.id)&&vn.removeEvent(Le.id):Fe.getSubsystemEvent(Le.id)&&Fe.removeSubsystemEvent(Le.id):Le.type==="annotation"?Fe.getAnnotation(Le.id)&&Fe.removeAnnotation(Le.id):Fe.getNode(Le.id)&&(Fe.removeNode(Le.id),c.delete(Le.id))}),qe.forEach(Le=>{const it=Je(Fe.connections);let nt=it.find(_t=>_t.id===Le.id);if(!nt&&Le.sourceHandle&&Le.targetHandle){const _t=Le.sourceHandle.match(/-output-(\d+)$/),At=Le.targetHandle.match(/-input-(\d+)$/);if(_t&&At){const St=parseInt(_t[1],10),st=parseInt(At[1],10);nt=it.find(Ot=>Ot.sourceNodeId===Le.source&&Ot.sourcePortIndex===St&&Ot.targetNodeId===Le.target&&Ot.targetPortIndex===st)}}nt&&Fe.removeConnection(nt.id)})});const ve=new Set(ye.map(Le=>Le.id));J(D,h(D).filter(Le=>!ve.has(Le.id)),!0),J(U,h(U).filter(Le=>!ve.has(Le.id)),!0),J(C,h(C).filter(Le=>!ve.has(Le.id)),!0);const Pe=Je(Fe.connections);J(B,Pe.map(P2),!0),F=!1}function ee(ye){if(!ye.source||!ye.target||!ye.sourceHandle||!ye.targetHandle)return;const qe=ye.sourceHandle.match(/-output-(\d+)$/),ve=ye.targetHandle.match(/-input-(\d+)$/);qe&&ve&&It.mutate(()=>{const Pe=parseInt(qe[1],10);let Le=parseInt(ve[1],10);if(Je(Fe.connections).some(_t=>_t.targetNodeId===ye.target&&_t.targetPortIndex===Le)){const _t=eM(ye.target);if(_t!==null)Le=_t;else{const St=Je(Fe.nodesArray).find(Ot=>Ot.id===ye.target);if(!St)return;const st=Pi.get(St.type);if(!st||st.ports.maxInputs!==null)return;Fe.addInputPort(ye.target),Le=St.inputs.length}}Fe.addConnection(ye.source,Pe,ye.target,Le)})}function de({nodes:ye}){const qe=new Set,ve=new Set;ye?.forEach(Pe=>{Pe.type==="eventNode"?ve.add(Pe.id):qe.add(Pe.id)}),Cr.set(qe),Cg(ve)}let he=Oe(!1),pe=0;function ge(ye){return ye.dataTransfer?.types.includes("Files")??!1}function Ee(ye){ge(ye)&&(pe++,J(he,!0))}function Ae(ye){ge(ye)&&(pe--,pe===0&&J(he,!1))}function Ye(ye){ye.preventDefault(),pe=0,J(he,!1),Ww.handleDrop(ye)}function K(ye){ye.preventDefault(),ye.dataTransfer&&(ye.dataTransfer.dropEffect="copy")}let Re;function Qe({event:ye,node:qe}){if(ye.preventDefault(),qe.type==="eventNode"){so.openForEvent(qe.id,{x:ye.clientX,y:ye.clientY});return}if(qe.type==="annotation"){so.openForAnnotation(qe.id,{x:ye.clientX,y:ye.clientY});return}const ve=h(N).filter(Pe=>Pe.selected);ve.length>1&&ve.some(Pe=>Pe.id===qe.id)?so.openForSelection(ve.map(Pe=>Pe.id),{x:ye.clientX,y:ye.clientY}):so.openForNode(qe.id,{x:ye.clientX,y:ye.clientY})}function Be({event:ye,edge:qe}){ye.preventDefault(),so.openForEdge(qe.id,{x:ye.clientX,y:ye.clientY})}function Ie({event:ye}){ye.preventDefault(),so.openForCanvas({x:ye.clientX,y:ye.clientY})}function lt(ye){ye.target.closest(".svelte-flow__pane")&&sl()}var We=iM();yn("keydown",ii,l),We.__dblclick=lt,We.__mousemove=o;var Ke=se(We);{var ht=ye=>{var qe=tM();j(ye,qe)};ke(Ke,ye=>{h(he)&&ye(ht)})}var Rt=be(Ke,2);NC(Rt,Ah({get nodeTypes(){return M},get edgeTypes(){return T},onconnect:ee,onnodedragstart:V,onnodedrag:G,onnodedragstop:re,ondelete:ae,onselectionchange:de,ondrop:ye=>Ye(ye.event||ye),ondragover:ye=>K(ye.event||ye),onnodecontextmenu:Qe,onedgecontextmenu:Be,onpanecontextmenu:Ie,nodeOrigin:[.5,.5]},()=>({snapToGrid:!0,snapGrid:CE}),{deleteKeyCode:["Delete","Backspace"],selectionKeyCode:["Shift"],multiSelectionKeyCode:["Shift","Meta","Control"],get colorMode(){return h(n)},connectOnClick:!0,edgesReconnectable:!0,edgesFocusable:!0,edgesSelectable:!0,zoomOnDoubleClick:!1,elevateEdgesOnSelect:!1,proOptions:{hideAttribution:!0},get nodes(){return h(N)},set nodes(ye){J(N,ye,!0)},get edges(){return h(B)},set edges(ye){J(B,ye,!0)},children:(ye,qe)=>{var ve=nM(),Pe=Ue(ve);W7(Pe,{get pendingUpdates(){return h(u)},onUpdatesProcessed:_});var Le=be(Pe,2);TC(Le,{get variant(){return il.Dots},get gap(){return PE},size:1}),j(ye,ve)},$$slots:{default:!0}})),Q(We),ji(We,ye=>Re=ye,()=>Re),yn("dragover",We,K),yn("dragenter",We,Ee),yn("dragleave",We,Ae),j(t,We),Dt()}Kn(["dblclick","mousemove"]);var sM=Me("<button> </button>"),aM=Me("<button> </button>"),oM=Me("<button> </button>"),lM=Me("<button> </button>"),cM=Me("<button> </button>"),uM=Me('<div class="simulation-panel svelte-makk3l"><div class="settings-grid svelte-makk3l"><div class="setting-item svelte-makk3l"><label for="duration" class="svelte-makk3l"><span>Duration</span> <span class="help-icon svelte-makk3l">?</span></label> <div class="input-with-unit svelte-makk3l"><input id="duration" type="text" class="code-input svelte-makk3l" spellcheck="false"/> <span class="unit svelte-makk3l">s</span></div></div> <div class="setting-item svelte-makk3l"><label for="dt" class="svelte-makk3l"><span>Time Step</span> <span class="help-icon svelte-makk3l">?</span></label> <div class="input-with-unit svelte-makk3l"><input id="dt" type="text" class="code-input svelte-makk3l" spellcheck="false"/> <span class="unit svelte-makk3l">s</span></div></div></div> <div class="solver-section svelte-makk3l"><span class="section-label svelte-makk3l">Solver</span> <div class="solver-matrix svelte-makk3l"><div class="matrix-header corner svelte-makk3l"></div> <div class="matrix-header col-header svelte-makk3l"><span>Adaptive</span> <span class="help-icon svelte-makk3l">?</span></div> <div class="matrix-header col-header svelte-makk3l"><span>Fixed</span> <span class="help-icon svelte-makk3l">?</span></div> <div class="matrix-header row-header svelte-makk3l"><span class="rotated-text svelte-makk3l">Explicit</span> <span class="help-icon svelte-makk3l">?</span></div> <div class="matrix-cell svelte-makk3l"></div> <div class="matrix-cell svelte-makk3l"></div> <div class="matrix-header row-header svelte-makk3l"><span class="rotated-text svelte-makk3l">Implicit</span> <span class="help-icon svelte-makk3l">?</span></div> <div class="matrix-cell svelte-makk3l"></div> <div class="matrix-cell svelte-makk3l"></div></div></div> <div class="settings-grid svelte-makk3l"><div class="setting-item svelte-makk3l"><label for="rtol" class="svelte-makk3l"><span>Rel. Tolerance</span> <span class="help-icon svelte-makk3l">?</span></label> <input id="rtol" type="text" class="code-input svelte-makk3l" spellcheck="false"/></div> <div class="setting-item svelte-makk3l"><label for="atol" class="svelte-makk3l"><span>Abs. Tolerance</span> <span class="help-icon svelte-makk3l">?</span></label> <input id="atol" type="text" class="code-input svelte-makk3l" spellcheck="false"/></div> <div class="setting-item svelte-makk3l"><label for="ftol" class="svelte-makk3l"><span>FP Tolerance</span> <span class="help-icon svelte-makk3l">?</span></label> <input id="ftol" type="text" class="code-input svelte-makk3l" spellcheck="false"/></div></div> <div class="settings-grid svelte-makk3l"><div class="setting-item svelte-makk3l"><label for="dt_min" class="svelte-makk3l"><span>Min Timestep</span> <span class="help-icon svelte-makk3l">?</span></label> <div class="input-with-unit svelte-makk3l"><input id="dt_min" type="text" class="code-input svelte-makk3l" spellcheck="false"/> <span class="unit svelte-makk3l">s</span></div></div> <div class="setting-item svelte-makk3l"><label for="dt_max" class="svelte-makk3l"><span>Max Timestep</span> <span class="help-icon svelte-makk3l">?</span></label> <div class="input-with-unit svelte-makk3l"><input id="dt_max" type="text" class="code-input svelte-makk3l" spellcheck="false"/> <span class="unit svelte-makk3l">s</span></div></div></div> <div class="setting-item full-width svelte-makk3l"><span class="setting-label svelte-makk3l"><span>Ghost Traces</span> <span class="help-icon svelte-makk3l">?</span></span> <div class="ghost-selector svelte-makk3l"></div></div></div>');function dM(t,e){Tt(e,!0);let n=Oe(Rn(is.get()));const i=is.subscribe(ve=>{J(n,ve,!0)});Ei(i);const r={adaptive:{explicit:["RKBS32","RKCK54"],implicit:["GEAR52A","ESDIRK43"]},fixed:{explicit:["SSPRK22","RK4"],implicit:["BDF2"]}},s={adaptive:"Automatically adjusts step size for accuracy and speed",fixed:"Uses constant step size (dt) throughout simulation",explicit:"Fast, direct computation. Best for non-stiff systems",implicit:"Solves equations iteratively. Handles stiff systems",duration:"Total simulation time in seconds",dt:"Initial/fixed time step size in seconds",rtol:"Relative error tolerance for adaptive solvers",atol:"Absolute error tolerance for adaptive solvers",ftol:"Fixed-point iteration tolerance for implicit solvers and algebraic loops",dt_min:"Minimum allowed timestep for adaptive solvers",dt_max:"Maximum allowed timestep for adaptive solvers",ghostTraces:"Number of previous simulation traces to show faded"};function a(ve,Pe){is.update({[ve]:Pe})}function o(ve){a("solver",ve)}function l(ve){ve<h(n).ghostTraces&&pE(ve),a("ghostTraces",ve)}var c=uM(),u=se(c),f=se(u),p=se(f),d=be(se(p),2);wt(d,(ve,Pe)=>$t?.(ve,Pe),()=>s.duration),Q(p);var y=be(p,2),m=se(y);Br(m),m.__input=ve=>a("duration",ve.currentTarget.value),wt(m,ve=>$s?.(ve)),Ri(2),Q(y),Q(f);var w=be(f,2),b=se(w),S=be(se(b),2);wt(S,(ve,Pe)=>$t?.(ve,Pe),()=>s.dt),Q(b);var A=be(b,2),_=se(A);Br(_),_.__input=ve=>a("dt",ve.currentTarget.value),wt(_,ve=>$s?.(ve)),Ri(2),Q(A),Q(w),Q(u);var I=be(u,2),E=be(se(I),2),M=be(se(E),2),T=be(se(M),2);wt(T,(ve,Pe)=>$t?.(ve,Pe),()=>s.adaptive),Q(M);var D=be(M,2),U=be(se(D),2);wt(U,(ve,Pe)=>$t?.(ve,Pe),()=>s.fixed),Q(D);var C=be(D,2),N=be(se(C),2);wt(N,(ve,Pe)=>$t?.(ve,Pe),()=>s.explicit),Q(C);var B=be(C,2);fn(B,21,()=>r.adaptive.explicit,Nn,(ve,Pe)=>{var Le=sM();let it;Le.__click=()=>o(h(Pe));var nt=se(Le,!0);Q(Le),_e(()=>{it=Xt(Le,1,"solver-pill svelte-makk3l",null,it,{selected:h(n).solver===h(Pe)}),Wt(nt,h(Pe))}),j(ve,Le)}),Q(B);var P=be(B,2);fn(P,21,()=>r.fixed.explicit,Nn,(ve,Pe)=>{var Le=aM();let it;Le.__click=()=>o(h(Pe));var nt=se(Le,!0);Q(Le),_e(()=>{it=Xt(Le,1,"solver-pill svelte-makk3l",null,it,{selected:h(n).solver===h(Pe)}),Wt(nt,h(Pe))}),j(ve,Le)}),Q(P);var F=be(P,2),q=be(se(F),2);wt(q,(ve,Pe)=>$t?.(ve,Pe),()=>s.implicit),Q(F);var Z=be(F,2);fn(Z,21,()=>r.adaptive.implicit,Nn,(ve,Pe)=>{var Le=oM();let it;Le.__click=()=>o(h(Pe));var nt=se(Le,!0);Q(Le),_e(()=>{it=Xt(Le,1,"solver-pill svelte-makk3l",null,it,{selected:h(n).solver===h(Pe)}),Wt(nt,h(Pe))}),j(ve,Le)}),Q(Z);var W=be(Z,2);fn(W,21,()=>r.fixed.implicit,Nn,(ve,Pe)=>{var Le=lM();let it;Le.__click=()=>o(h(Pe));var nt=se(Le,!0);Q(Le),_e(()=>{it=Xt(Le,1,"solver-pill svelte-makk3l",null,it,{selected:h(n).solver===h(Pe)}),Wt(nt,h(Pe))}),j(ve,Le)}),Q(W),Q(E),Q(I);var Y=be(I,2),ue=se(Y),le=se(ue),O=be(se(le),2);wt(O,(ve,Pe)=>$t?.(ve,Pe),()=>s.rtol),Q(le);var V=be(le,2);Br(V),V.__input=ve=>a("rtol",ve.currentTarget.value),wt(V,ve=>$s?.(ve)),Q(ue);var G=be(ue,2),re=se(G),ae=be(se(re),2);wt(ae,(ve,Pe)=>$t?.(ve,Pe),()=>s.atol),Q(re);var ee=be(re,2);Br(ee),ee.__input=ve=>a("atol",ve.currentTarget.value),wt(ee,ve=>$s?.(ve)),Q(G);var de=be(G,2),he=se(de),pe=be(se(he),2);wt(pe,(ve,Pe)=>$t?.(ve,Pe),()=>s.ftol),Q(he);var ge=be(he,2);Br(ge),ge.__input=ve=>a("ftol",ve.currentTarget.value),wt(ge,ve=>$s?.(ve)),Q(de),Q(Y);var Ee=be(Y,2),Ae=se(Ee),Ye=se(Ae),K=be(se(Ye),2);wt(K,(ve,Pe)=>$t?.(ve,Pe),()=>s.dt_min),Q(Ye);var Re=be(Ye,2),Qe=se(Re);Br(Qe),Qe.__input=ve=>a("dt_min",ve.currentTarget.value),wt(Qe,ve=>$s?.(ve)),Ri(2),Q(Re),Q(Ae);var Be=be(Ae,2),Ie=se(Be),lt=be(se(Ie),2);wt(lt,(ve,Pe)=>$t?.(ve,Pe),()=>s.dt_max),Q(Ie);var We=be(Ie,2),Ke=se(We);Br(Ke),Ke.__input=ve=>a("dt_max",ve.currentTarget.value),wt(Ke,ve=>$s?.(ve)),Ri(2),Q(We),Q(Be),Q(Ee);var ht=be(Ee,2),Rt=se(ht),ye=be(se(Rt),2);wt(ye,(ve,Pe)=>$t?.(ve,Pe),()=>s.ghostTraces),Q(Rt);var qe=be(Rt,2);fn(qe,20,()=>[0,1,2,3,4,5,6,7,8],Nn,(ve,Pe)=>{var Le=cM();let it;Le.__click=()=>l(Pe);var nt=se(Le,!0);Q(Le),_e(()=>{it=Xt(Le,1,"ghost-pill svelte-makk3l",null,it,{active:h(n).ghostTraces===Pe}),Wt(nt,Pe)}),j(ve,Le)}),Q(qe),Q(ht),Q(c),_e(()=>{ps(m,h(n).duration),fe(m,"placeholder",Xo.duration),ps(_,h(n).dt),fe(_,"placeholder",Xo.dt),ps(V,h(n).rtol),fe(V,"placeholder",Xo.rtol),ps(ee,h(n).atol),fe(ee,"placeholder",Xo.atol),ps(ge,h(n).ftol),fe(ge,"placeholder",Xo.ftol),ps(Qe,h(n).dt_min),fe(Qe,"placeholder",Xo.dt_min),ps(Ke,h(n).dt_max),fe(Ke,"placeholder",Xo.dt_max)}),j(t,c),Dt()}Kn(["input","click"]);function ea(t,e){const n=t[e];return n===""||n===null||n===void 0?Xo[e]:n}function Hd(t,e,n=!1){return lw(t,e,{multiLine:n,skipInternal:!0})}function v0(t,e,n=!1){return lw(t,e,{multiLine:n})}function ox(t,e,n,i=!1){const r=[];for(const s of t){const a=oa.get(s.type);if(!a)continue;let o=La(s.name);(!o||e.includes(o)||r.includes(o))&&(o=`event_${r.length}`),r.push(o);const l=new Set(a.params.map(u=>u.name)),c=v0(s.params,l,i);c?n.push(`${o} = ${a.eventClass}(${c})`):n.push(`${o} = ${a.eventClass}()`)}return r}function lx(t,e,n,i="    "){n.push("sim = Simulation("),n.push(`${i}blocks,`),n.push(`${i}connections,`),e&&n.push(`${i}events,`),n.push(`${i}Solver=${ea(t,"solver")},`),n.push(`${i}dt=${ea(t,"dt")},`),n.push(`${i}dt_min=${ea(t,"dt_min")},`);const r=ea(t,"dt_max");r&&n.push(`${i}dt_max=${r},`),n.push(`${i}tolerance_lte_rel=${ea(t,"rtol")},`),n.push(`${i}tolerance_lte_abs=${ea(t,"atol")},`),n.push(`${i}tolerance_fpi=${ea(t,"ftol")},`),n.push(")")}function y0(t){const e=[];for(const n of t)e.push(n),Ia(n)&&e.push(...y0(n.graph?.nodes??[]));return e}function cx(t){const e=y0(t),n=new Map;for(const i of e){if(Ia(i)||qd(i))continue;const r=Pi.get(i.type);if(!r)continue;const s=qC[r.blockClass]||"pathsim.blocks";n.has(s)||n.set(s,new Set),n.get(s).add(r.blockClass)}return n}function Cp(t,e,n,i,r="",s={}){const{formatted:a=!1}=s,o=t.graph?.nodes??[],l=t.graph?.connections??[],c=t.graph?.events??[];let u=La(t.name);(!u||n.includes(u))&&(u=`subsystem_${n.length}`),n.push(u),e.set(t.id,u);const f=r+u+"_",p=o.filter(qd),d=o.filter(A=>!qd(A)),y=[],m=new Map;a&&(i.push(""),i.push(`# Subsystem: ${t.name}`));for(const A of p){const _=f+"interface";y.push(_),m.set(A.id,_),i.push(`${_} = Interface()`)}for(const A of d)if(Ia(A))Cp(A,m,y,i,f,s);else{const _=Pi.get(A.type);if(!_)continue;let I=f+La(A.name);(!I||y.includes(I))&&(I=`${f}block_${y.length}`),y.push(I),m.set(A.id,I);const E=new Set(_.params.map(T=>T.name)),M=Hd(A.params,E,a);M?i.push(`${I} = ${_.blockClass}(${M})`):i.push(`${I} = ${_.blockClass}()`)}for(const[A,_]of m)e.set(A,_);const w=[];if(c.length>0)for(const A of c){const _=oa.get(A.type);if(!_)continue;let I=f+La(A.name);(!I||n.includes(I)||w.includes(I))&&(I=`${f}event_${w.length}`),w.push(I);const E=new Set(_.params.map(T=>T.name)),M=v0(A.params,E,a);M?i.push(`${I} = ${_.eventClass}(${M})`):i.push(`${I} = ${_.eventClass}()`)}const b=`${u}_conn`,S=K1(l,m,b);for(const A of S.lines)i.push(A);i.push(`${u} = Subsystem(`),i.push("    blocks=[");for(const A of y)i.push(`        ${A},`);i.push("    ],"),i.push("    connections=[");for(const A of S.varNames)i.push(`        ${A},`);if(i.push("    ],"),c.length>0){i.push("    events=[");for(const A of w)i.push(`        ${A},`);i.push("    ],")}return i.push(")"),a||i.push(""),u}function fM(t){const e=new Map;for(const n of t){const i=Pi.get(n.type);if(!i)continue;const r=i.category||"Other";e.has(r)||e.set(r,[]),e.get(r).push({node:n,typeDef:i})}return e}function hM(t,e,n,i,r=!0,s=[],a=!0){const o=[],l=t.some(Ia),c=s.length>0,u=new Set(s.map(b=>oa.get(b.type)?.eventClass).filter(Boolean)),f=cx(t);o.push("# IMPORTS"),o.push("import numpy as np"),l?o.push("from pathsim import Simulation, Connection, Subsystem, Interface"):o.push("from pathsim import Simulation, Connection");for(const[b]of f)o.push(`from ${b} import *`);f.has("pathsim.blocks")||o.push("from pathsim.blocks import *"),o.push(`from pathsim.solvers import ${ea(n,"solver")}`),c&&o.push(`from pathsim.events import ${[...u].join(", ")}`),o.push(""),i.trim()&&(o.push("# CODE CONTEXT"),o.push(i.trim()),o.push("")),o.push("# BLOCKS");const p=new Map,d=[],y=t.filter(Ia);for(const b of y)Cp(b,p,d,o);if(t.filter(b=>!Ia(b)&&!qd(b)).forEach((b,S)=>{const A=Pi.get(b.type);if(!A){console.warn(`Unknown node type: ${b.type}`);return}let _=La(b.name);(!_||d.includes(_))&&(_=`block_${S}`),d.push(_),p.set(b.id,_);const I=new Set(A.params.map(M=>M.name)),E=Hd(b.params,I);E?o.push(`${_} = ${A.blockClass}(${E})`):o.push(`${_} = ${A.blockClass}()`)}),o.push(""),o.push(...bu("blocks",d)),o.push(""),r){o.push("# NODE ID MAPPING (for data extraction)"),o.push("_node_id_map = {");for(const[S,A]of p)o.push(`    id(${A}): "${S}",`);o.push("}"),o.push(""),o.push("# NODE NAME MAPPING"),o.push("_node_name_map = {");const b=y0(t);for(const S of b){const A=S.name.replace(/"/g,'\\"');o.push(`    "${S.id}": "${A}",`)}o.push("}"),o.push("")}o.push("# CONNECTIONS");const w=K1(e,p);for(const b of w.lines)o.push(b);if(o.push(...bu("connections",w.varNames)),o.push(""),c){o.push("# EVENTS");const b=ox(s,d,o);o.push(""),o.push(...bu("events",b)),o.push("")}return o.push("# SIMULATION"),lx(n,c,o),a&&(o.push(""),o.push("# RUN"),o.push(`sim.run(duration=${ea(n,"duration")}, reset=True)`)),{code:o.join(`
`),nodeVars:p,connVars:w.connVars}}function pM(t,e,n,i,r=[]){const s=[],a="# "+"â".repeat(76),l=new Date().toISOString().replace("T"," ").split(".")[0];s.push("#!/usr/bin/env python3"),s.push("# -*- coding: utf-8 -*-"),s.push('"""'),s.push("PathSim Simulation"),s.push("=================="),s.push(""),s.push(`Generated by PathView on ${l}`),s.push("https://view.pathsim.org"),s.push(""),s.push("PathSim documentation: https://docs.pathsim.org"),s.push('"""'),s.push("");const c=t.some(Ia),u=r.length>0,f=new Set(r.map(_=>oa.get(_.type)?.eventClass).filter(Boolean));s.push(a),s.push("# IMPORTS"),s.push(a),s.push(""),s.push("import numpy as np"),s.push("import matplotlib.pyplot as plt"),s.push(""),c?s.push("from pathsim import Simulation, Connection, Subsystem, Interface"):s.push("from pathsim import Simulation, Connection");const p=cx(t);for(const[_,I]of p){const E=[...I].sort();if(E.length===1)s.push(`from ${_} import ${E[0]}`);else{s.push(`from ${_} import (`);for(let M=0;M<E.length;M++){const T=M<E.length-1?",":"";s.push(`    ${E[M]}${T}`)}s.push(")")}}s.push(`from pathsim.solvers import ${ea(n,"solver")}`),u&&s.push(`from pathsim.events import ${[...f].join(", ")}`),s.push(""),i.trim()&&(s.push(a),s.push("# USER-DEFINED CODE"),s.push(a),s.push(""),s.push(i.trim()),s.push("")),s.push(a),s.push("# BLOCKS"),s.push(a);const d=new Map,y=[];let m=0;const w=t,b=w.filter(Ia);for(const _ of b)Cp(_,d,y,s,"",{formatted:!0});const S=w.filter(_=>!Ia(_)&&!qd(_)),A=fM(S);for(const _ of e2){if(_==="Subsystem")continue;const I=A.get(_);if(!(!I||I.length===0)){s.push(""),s.push(`# ${_}`);for(const{node:E,typeDef:M}of I){let T=La(E.name);(!T||y.includes(T))&&(T=`block_${m}`),y.push(T),d.set(E.id,T),m++;const D=new Set(M.params.map(C=>C.name)),U=Hd(E.params,D,!0);U?s.push(`${T} = ${M.blockClass}(${U})`):s.push(`${T} = ${M.blockClass}()`)}}}for(const[_,I]of A)if(!e2.includes(_)){s.push(""),s.push(`# ${_}`);for(const{node:E,typeDef:M}of I){let T=La(E.name);(!T||y.includes(T))&&(T=`block_${m}`),y.push(T),d.set(E.id,T),m++;const D=new Set(M.params.map(C=>C.name)),U=Hd(E.params,D,!0);U?s.push(`${T} = ${M.blockClass}(${U})`):s.push(`${T} = ${M.blockClass}()`)}}if(s.push(""),s.push(...bu("blocks",y)),s.push(""),s.push(a),s.push("# CONNECTIONS"),s.push(a),s.push(""),e.length===0)s.push("connections = []");else{const _=K1(e,d);for(const I of _.lines)s.push(I);s.push(""),s.push(...bu("connections",_.varNames))}if(s.push(""),u){s.push(a),s.push("# EVENTS"),s.push(a),s.push("");const _=ox(r,y,s,!0);s.push(""),s.push(...bu("events",_)),s.push("")}return s.push(a),s.push("# SIMULATION"),s.push(a),s.push(""),lx(n,u,s),s.push(""),s.push(a),s.push("# MAIN"),s.push(a),s.push(""),s.push("if __name__ == '__main__':"),s.push(""),s.push("    # Run simulation"),s.push(`    sim.run(duration=${ea(n,"duration")})`),s.push(""),s.push("    # Plot results"),s.push("    sim.plot()"),s.push("    plt.show()"),s.push(""),s.join(`
`)}async function gM(t,e,n,i,r=[],s){const a=hM(t,e,n,i,!0,r,!1),o=ea(n,"duration");return uE(a.code,String(o),s,a.nodeVars,a.connVars)}function mM(t,e,n,i,r=[]){return pM(t,e,n,i,r)}function b0(t,e,n){const i=Pi.get(t.type);if(!i)return"";if(t.type===_n.INTERFACE){const o=e||Fe.getAllNodes(),l=aw(o,t.id);return l?b0(l,e,n):"# Interface block (no parent subsystem found)"}const r=La(t.name)||"block";if(t.type===_n.SUBSYSTEM&&e&&n){const o=[];return Cp(t,new Map,[],o,"",{formatted:!0}),o.join(`
`)}const s=new Set(i.params.map(o=>o.name)),a=Hd(t.params,s,!0);return a?`${r} = ${i.blockClass}(${a})`:`${r} = ${i.blockClass}()`}function ux(t){const e=oa.get(t.type);if(!e)return"";const n=La(t.name)||"event",i=new Set(e.params.map(s=>s.name)),r=v0(t.params,i,!0);return r?`${n} = ${e.eventClass}(${r})`:`${n} = ${e.eventClass}()`}function vM(t){const e={};for(const n of t){const i=Pi.get(n.type);if(!i)continue;const r=new Set(i.params.map(a=>a.name)),s={};for(const[a,o]of Object.entries(n.params))o==null||o===""||a.startsWith("_")||r.has(a)&&(s[a]=String(o));Object.keys(s).length>0&&(e[n.id]=s)}return e}async function yM(t,e){const n=vM(t);return hE(e,n)}function dx(t){const e=new RegExp("(?<![.\\w])([a-zA-Z_][a-zA-Z0-9_]*)","g"),n=new Set;let i;for(;(i=e.exec(t))!==null;)n.add(i[1]);return n}const bM=new Set(["True","False","None","and","or","not","in","is","if","else","elif","for","while","def","class","return","yield","import","from","as","try","except","finally","with","lambda","pass","break","continue","raise","global","nonlocal","assert","del","print","len","range","list","dict","set","tuple","str","int","float","bool","type","np","numpy","math","sin","cos","tan","exp","log","sqrt","pi","abs","min","max","sum","any","all","map","filter","zip","enumerate"]);function fx(t,e){if(!t.trim()||e.size===0)return"";const n=t.split(`
`),i=[];let r=!1,s=0;const a=new Set([...e].filter(o=>!bM.has(o)));if(a.size===0)return"";for(let o=0;o<n.length;o++){const l=n[o],c=l.trim(),u=c.match(/^def\s+([a-zA-Z_][a-zA-Z0-9_]*)\s*\(/);if(u&&a.has(u[1])){r=!0,s=l.search(/\S/),i.push(l);continue}const f=c.match(/^([a-zA-Z_][a-zA-Z0-9_]*)\s*=/);if(f&&a.has(f[1])&&!r){i.push(l);continue}if(r){const p=l.search(/\S/);c===""||p>s?i.push(l):r=!1}}return i.join(`
`).trim()}function hx(t){const e=[];for(const n of Object.values(t.params))n!=null&&n!==""&&e.push(String(n));if(t.graph)for(const n of t.graph.nodes)e.push(...hx(n));return e}function px(t,e){if(t.graph)for(const n of t.graph.nodes){const i=Pi.get(n.type);i&&i.blockClass!=="Subsystem"&&i.blockClass!=="Interface"&&e.add(i.blockClass),n.type===_n.SUBSYSTEM&&px(n,e)}}function gx(t,e){const n=Pi.get(t.type);if(!n)return"";const i=[];if(i.push("import numpy as np"),t.type===_n.SUBSYSTEM){i.push("from pathsim import Subsystem, Interface, Connection");const o=new Set;px(t,o),o.size>0&&i.push(`from pathsim.blocks import ${[...o].sort().join(", ")}`)}else i.push(`from pathsim.blocks import ${n.blockClass}`);const r=t.type===_n.SUBSYSTEM?hx(t).join(" "):Object.values(t.params).filter(o=>o!=null&&o!=="").join(" "),s=dx(r),a=fx(e,s);return a&&(i.push(""),i.push(a)),i.push(""),i.join(`
`)}function mx(t,e){const n=oa.get(t.type);if(!n)return"";const i=[];i.push("import numpy as np"),i.push(`from pathsim.events import ${n.eventClass}`);const r=Object.values(t.params).filter(o=>o!=null&&o!=="").join(" "),s=dx(r),a=fx(e,s);return a&&(i.push(""),i.push(a)),i.push(""),i.join(`
`)}function wM(t){return qh[t]?.docstringHtml}const bi={keyword:"#E57373",operator:"#0070C0",special:"#FFB74D",number:"#4DB6AC",string:"#81C784",function:"#0070C0",comment:{dark:"#505060",light:"#909098"},invalid:"#BA68C8",variable:{dark:"#e0e0e0",light:"#383a42"},punctuation:{dark:"#abb2bf",light:"#505050"}};let Hf=null;async function Pp(){if(Hf)return Hf;const[t,e,n,i,r,s,a]=await Promise.all([hs(()=>import("./BaLj8HaF.js").then(o=>o.t),__vite__mapDeps([0,1]),import.meta.url),hs(()=>import("./BJrbMhgq.js"),[],import.meta.url),hs(()=>import("./zngUhAbX.js"),__vite__mapDeps([2,0,1,3,4,5]),import.meta.url),hs(()=>import("./AwXmWqiV.js"),__vite__mapDeps([6,4,3,1,0,5]),import.meta.url),hs(()=>import("./-suHlTGB.js"),__vite__mapDeps([7,0,1,3,4]),import.meta.url),hs(()=>import("./bH9uCY5d.js"),__vite__mapDeps([3,4,1,0]),import.meta.url),hs(()=>import("./DSDy7V6L.js").then(o=>o.i),[],import.meta.url)]);return Hf={EditorView:t.EditorView,EditorState:e.EditorState,keymap:t.keymap,basicSetup:n.basicSetup,python:i.python,oneDark:r.oneDark,HighlightStyle:s.HighlightStyle,syntaxHighlighting:s.syntaxHighlighting,indentUnit:s.indentUnit,tags:a.tags},Hf}function xM(t,e){const{HighlightStyle:n,tags:i}=t,r=e?bi.variable.dark:bi.variable.light,s=e?bi.punctuation.dark:bi.punctuation.light,a=e?bi.comment.dark:bi.comment.light;return n.define([{tag:i.keyword,color:bi.keyword},{tag:i.operator,color:bi.operator},{tag:i.special(i.variableName),color:bi.special},{tag:i.typeName,color:bi.special},{tag:i.atom,color:bi.number},{tag:i.number,color:bi.number},{tag:i.bool,color:bi.number},{tag:i.string,color:bi.string},{tag:i.character,color:bi.string},{tag:i.regexp,color:bi.string},{tag:i.escape,color:bi.operator},{tag:i.variableName,color:r},{tag:i.definition(i.variableName),color:r},{tag:i.propertyName,color:r},{tag:i.function(i.variableName),color:bi.function},{tag:i.function(i.propertyName),color:bi.function},{tag:i.definition(i.function(i.variableName)),color:bi.function},{tag:i.labelName,color:r},{tag:i.comment,color:a,fontStyle:"italic"},{tag:i.blockComment,color:a,fontStyle:"italic"},{tag:i.docComment,color:a,fontStyle:"italic"},{tag:i.invalid,color:"#ffffff",backgroundColor:bi.invalid},{tag:i.punctuation,color:s},{tag:i.bracket,color:s},{tag:i.className,color:bi.special},{tag:i.attributeName,color:r},{tag:i.attributeValue,color:bi.string},{tag:i.self,color:bi.special}])}function $d(t,e,n={}){const{EditorView:i,EditorState:r,keymap:s,basicSetup:a,python:o,oneDark:l,syntaxHighlighting:c,indentUnit:u}=t,f=[];if(n.keymaps&&n.keymaps.length>0&&f.push(s.of(n.keymaps)),f.push(a,o(),u.of("    "),c(xM(t,e))),n.readOnly&&f.push(r.readOnly.of(!0)),n.onDocChange){const p=n.onDocChange;f.push(i.updateListener.of(d=>{d.docChanged&&p(d.state.doc.toString())}))}return e&&f.push(l),f}let xu=[],Yh=[],_u=null;async function _M(t){if(!t?.trim())return'<p class="no-docs">No documentation available.</p>';const e=await l0(),n=document.createElement("div");n.innerHTML=t;const i=n.querySelectorAll(".math");for(const r of i){const s=r.textContent||"";if(s.trim())try{let a=s.replace(/^\\\(|\\\)$/g,"").replace(/^\\\[|\\\]$/g,"").trim();a=a.replace(/\\begin\{eqnarray\*?\}/g,"\\begin{aligned}").replace(/\\end\{eqnarray\*?\}/g,"\\end{aligned}"),a.includes("\\\\")&&!a.includes("\\begin{")&&(a=`\\begin{aligned}${a}\\end{aligned}`);const o=r.tagName==="DIV"||s.includes("\\["),l=e.default.renderToString(a,{displayMode:o,throwOnError:!1,strict:!1});r.innerHTML=l,r.classList.add("katex-rendered")}catch(a){console.warn("KaTeX error for:",s,a)}}return n.innerHTML}function SM(t){const e=t.querySelectorAll("dl.docutils");for(const n of e){if(n.classList.contains("table-transformed"))continue;const i=document.createElement("div");i.className="param-table-wrapper";const r=document.createElement("table");r.className="param-table";const s=document.createElement("thead"),a=document.createElement("tr");["Name","Type","Description"].forEach(c=>{const u=document.createElement("th");u.textContent=c,a.appendChild(u)}),s.appendChild(a),r.appendChild(s);const o=document.createElement("tbody"),l=n.querySelectorAll(":scope > dt");for(const c of l){const u=document.createElement("tr"),f=document.createElement("td");f.className="param-name";const p=document.createElement("code");let d="";for(const S of c.childNodes)if(S.nodeType===Node.TEXT_NODE){if(d=S.textContent?.trim()||"",d)break}else if(S.nodeType===Node.ELEMENT_NODE){const A=S;if(A.classList.contains("classifier-delimiter")||(d=A.textContent?.trim()||"",d))break}p.textContent=d,f.appendChild(p),u.appendChild(f);const y=document.createElement("td");y.className="param-type";const m=c.querySelector(".classifier");if(m){const S=document.createElement("code");S.textContent=m.textContent||"",y.appendChild(S)}u.appendChild(y);const w=document.createElement("td");w.className="param-desc";const b=c.nextElementSibling;b&&b.tagName==="DD"&&(w.innerHTML=b.innerHTML),u.appendChild(w),o.appendChild(u)}r.appendChild(o),i.appendChild(r),n.parentNode?.replaceChild(i,n)}}function kM(t){return t.includes(">>>")||t.includes("...")?"console":"python"}function AM(t){const e=document.createElement("button");return e.className="copy-btn",e.innerHTML='<svg width="12" height="12" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="9" y="9" width="13" height="13" rx="2" ry="2"></rect><path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"></path></svg>',e.title="Copy code",e.addEventListener("click",async()=>{try{await navigator.clipboard.writeText(t),e.innerHTML='<svg width="12" height="12" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><polyline points="20 6 9 17 4 12"></polyline></svg>',setTimeout(()=>{e.innerHTML='<svg width="12" height="12" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="9" y="9" width="13" height="13" rx="2" ry="2"></rect><path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"></path></svg>'},2e3)}catch(n){console.error("Failed to copy:",n)}}),e}async function NM(t){Zm(),_u=await Pp();const e=document.documentElement.getAttribute("data-theme")!=="light",n=t.querySelectorAll("pre");for(const i of n){if(i.classList.contains("cm-processed"))continue;const r=i.querySelector("code"),s=r?r.textContent:i.textContent;if(!s?.trim())continue;i.classList.add("cm-processed");const a=s.trim(),o=kM(a),l=document.createElement("div");l.className="code-block-wrapper";const c=document.createElement("div");c.className="code-block-header";const u=document.createElement("span");u.className="code-label",u.textContent=o==="console"?"CONSOLE":"PYTHON",c.appendChild(u),c.appendChild(AM(a)),l.appendChild(c);const f=document.createElement("div");f.className="cm-container",l.appendChild(f),i.parentNode?.replaceChild(l,i),Yh.push({wrapper:l,code:a});const p=new _u.EditorView({doc:a,extensions:$d(_u,e,{readOnly:!0}),parent:f});xu.push(p)}}async function CM(){if(!_u||Yh.length===0)return;const t=document.documentElement.getAttribute("data-theme")!=="light";for(const e of xu)e.destroy();xu=[];for(const{wrapper:e,code:n}of Yh){const i=e.querySelector(".cm-container");if(!i)continue;i.innerHTML="";const r=new _u.EditorView({doc:n,extensions:$d(_u,t,{readOnly:!0}),parent:i});xu.push(r)}}function Zm(){for(const t of xu)t.destroy();xu=[],Yh=[]}var PM=Me('<link rel="stylesheet"/>'),EM=Me('<div class="docs-loading svelte-1tqxd15">Loading documentation...</div>'),IM=Me('<div class="docs-content svelte-1tqxd15"><!></div>'),LM=Me('<div class="docs-section svelte-1tqxd15"><button class="docs-toggle svelte-1tqxd15"><span><!></span> Documentation</button> <!></div>');function vx(t,e){Tt(e,!0);let n=Oe(!1),i=Oe(""),r=Oe(!1),s=Oe(void 0);const a=ne(()=>!!e.docstring||!!e.docstringHtml);async function o(){if(J(n,!h(n)),h(n)&&!h(i)){const f=e.docstringHtml||e.docstring;if(!f)return;J(r,!0);try{J(i,await _M(f),!0)}catch(p){console.error("Failed to render docstring:",p),J(i,'<p class="docs-error">Failed to render documentation.</p>')}J(r,!1)}}mn(()=>{h(i)&&h(s)&&!h(r)&&requestAnimationFrame(async()=>{h(s)&&(SM(h(s)),await NM(h(s)))})}),ol.subscribe(()=>{h(n)&&h(s)&&CM()}),mn(()=>{(e.docstring||e.docstringHtml)&&(Zm(),J(i,""),J(n,!1))}),Ei(()=>{Zm()});var l=$e();rp("1tqxd15",f=>{var p=PM();_e(d=>fe(p,"href",d),[c0]),j(f,p)});var c=Ue(l);{var u=f=>{var p=LM(),d=se(p);d.__click=o;var y=se(d);let m;var w=se(y);qt(w,{name:"chevron-right",size:12}),Q(y),Ri(),Q(d);var b=be(d,2);{var S=A=>{var _=IM(),I=se(_);{var E=T=>{var D=EM();j(T,D)},M=T=>{var D=$e(),U=Ue(D);_1(U,()=>h(i)),j(T,D)};ke(I,T=>{h(r)?T(E):T(M,!1)})}Q(_),ji(_,T=>J(s,T),()=>h(s)),Si(3,_,()=>yS,()=>({duration:200})),j(A,_)};ke(b,A=>{h(n)&&A(S)})}Q(p),_e(()=>m=Xt(y,1,"toggle-icon svelte-1tqxd15",null,m,{expanded:h(n)})),j(f,p)};ke(c,f=>{h(a)&&f(u)})}j(t,l),Dt()}Kn(["click"]);var MM=Me('<div class="loading svelte-70gj2h">Loading...</div>'),TM=Me('<div class="dialog-backdrop nested" role="presentation"><div class="dialog glass-panel svelte-70gj2h" role="dialog" tabindex="-1" aria-labelledby="dialog-title"><div class="dialog-header"><span id="dialog-title"> </span> <div class="header-actions svelte-70gj2h"><button aria-label="Copy to Clipboard"><!></button> <button class="icon-btn" aria-label="Close"><!></button></div></div> <div class="dialog-body svelte-70gj2h"><div class="code-preview svelte-70gj2h"><!></div></div></div></div>');function w0(t,e){Tt(e,!0);let n=ct(e,"open",3,!1),i=ct(e,"code",3,""),r=ct(e,"title",3,"Python Code"),s=Oe(void 0),a=null,o=null,l=Oe(!0),c=Oe("dark"),u=Oe(!1);const f=ol.subscribe(E=>{J(c,E,!0),a&&o&&h(s)&&y()});mn(()=>{n()?(J(u,!1),J(l,!0),setTimeout(()=>m(),0)):d()}),mn(()=>{n()&&a&&i()!==a.state.doc.toString()&&a.dispatch({changes:{from:0,to:a.state.doc.length,insert:i()}})});function p(){return o?$d(o,h(c)==="dark",{readOnly:!0}):[]}function d(){a&&(a.destroy(),a=null)}function y(){if(!a||!h(s)||!o)return;const E=a.state.doc.toString();a.destroy(),a=new o.EditorView({doc:E,extensions:p(),parent:h(s)})}async function m(){h(s)&&(d(),o=await Pp(),a=new o.EditorView({doc:i(),extensions:p(),parent:h(s)}),J(l,!1))}function w(){navigator.clipboard.writeText(i()),J(u,!0),setTimeout(()=>J(u,!1),2e3)}function b(E){E.target===E.currentTarget&&e.onClose()}function S(E){E.key==="Escape"&&e.onClose()}Ei(()=>{f(),d()});var A=$e();yn("keydown",ii,S);var _=Ue(A);{var I=E=>{var M=TM();M.__click=b;var T=se(M),D=se(T),U=se(D),C=se(U,!0);Q(U);var N=be(U,2),B=se(N);let P;B.__click=w;var F=se(B);{var q=G=>{qt(G,{name:"check",size:16})},Z=G=>{qt(G,{name:"copy",size:16})};ke(F,G=>{h(u)?G(q):G(Z,!1)})}Q(B),wt(B,(G,re)=>$t?.(G,re),()=>h(u)?"Copied!":"Copy to Clipboard");var W=be(B,2);W.__click=function(...G){e.onClose?.apply(this,G)};var Y=se(W);qt(Y,{name:"x",size:16}),Q(W),wt(W,(G,re)=>$t?.(G,re),()=>({text:"Close",shortcut:"Esc"})),Q(N),Q(D);var ue=be(D,2),le=se(ue),O=se(le);{var V=G=>{var re=MM();j(G,re)};ke(O,G=>{h(l)&&G(V)})}Q(le),ji(le,G=>J(s,G),()=>h(s)),Q(ue),Q(T),Q(M),_e(()=>{Wt(C,r()),P=Xt(B,1,"icon-btn",null,P,{success:h(u)})}),Si(3,T,()=>po,()=>({start:.95,duration:150,easing:Da})),Si(3,M,()=>dl,()=>({duration:150})),j(E,M)};ke(_,E=>{n()&&E(I)})}j(t,A),Dt()}Kn(["click"]);function DM(t){const e=JSON.parse(JSON.stringify(t)),n=xp(e);return delete n.graph,{version:p0,type:"block",metadata:{name:t.name,created:new Date().toISOString(),modified:new Date().toISOString()},content:{node:n}}}function OM(t){if(t.type!==_n.SUBSYSTEM)throw new Error("Node is not a subsystem");const e=JSON.parse(JSON.stringify(t)),n=xp(e);return{version:p0,type:"subsystem",metadata:{name:t.name,created:new Date().toISOString(),modified:new Date().toISOString()},content:{node:n}}}function FM(t){return{block:".blk",subsystem:".sub",model:".pvm"}[t]}function RM(t){return{block:"PathView Block",subsystem:"PathView Subsystem",model:"PathView Model"}[t]}function BM(t,e){Jw(t,e)}async function Jm(t,e){const n=Fe.getNode(e);if(!n)return console.error("Node not found:",e),!1;if(t==="subsystem"&&n.type!==_n.SUBSYSTEM)return console.error("Cannot export non-subsystem as subsystem"),!1;const i=t==="subsystem"?OM(n):DM(n),r=FM(t),s=`${n.name}${r}`;if(Ap())try{const a=await window.showSaveFilePicker({suggestedName:s,types:[{description:RM(t),accept:{"application/json":[r]}}]}),o=JSON.stringify(i,null,2),l=await a.createWritable();return await l.write(o),await l.close(),!0}catch(a){if(a.name==="AbortError")return!1;console.error("Failed to save component:",a)}return BM(i,s),!0}const zM=/[/\\:*?"<>|]/g;function yx(t){return t.replace(zM,"").trim()||"export"}function qM(t,e,n){const i=["time"];for(let s=0;s<e.length;s++)i.push(n?.[s]??`port_${s}`);const r=[i.join(",")];for(let s=0;s<t.length;s++){const a=[t[s].toString()];for(let o=0;o<e.length;o++)a.push((e[o][s]??"").toString());r.push(a.join(","))}return r.join(`
`)}function jM(t,e,n){const i=["frequency"];for(let s=0;s<e.length;s++)i.push(n?.[s]??`port_${s}`);const r=[i.join(",")];for(let s=0;s<t.length;s++){const a=[t[s].toString()];for(let o=0;o<e.length;o++)a.push((e[o][s]??"").toString());r.push(a.join(","))}return r.join(`
`)}function bx(t,e){const n=Je(Zi);if(!n.result)return!1;if(e==="scope"){const i=n.result.scopeData[t];return!!(i&&i.time.length>0)}else{const i=n.result.spectrumData[t];return!!(i&&i.frequency.length>0)}}function HM(t,e){const i=Je(Zi).result?.scopeData[t];if(!i||i.time.length===0)return!1;const r=qM(i.time,i.signals,i.labels),s=`${yx(e||"Scope")}.csv`;return Qw(r,s),!0}function UM(t,e){const i=Je(Zi).result?.spectrumData[t];if(!i||i.frequency.length===0)return!1;const r=jM(i.frequency,i.magnitude,i.labels),s=`${yx(e||"Spectrum")}.csv`;return Qw(r,s),!0}function x0(t,e,n){return n==="Scope"?HM(t,e):n==="Spectrum"?UM(t,e):!1}function WM(){let t=Oe(null),e=Oe(Rn([])),n=Oe("idle"),i=Oe(0);const r=Zi.subscribe(d=>{J(t,d.result,!0),J(e,d.resultHistory,!0),J(n,d.phase,!0)}),s=is.subscribe(d=>{J(i,d.ghostTraces??0,!0)});function a(d){return d==="Scope"?"scope":"spectrum"}function o(d,y){if(!h(t))return!1;if(a(y)==="scope"){const w=h(t).scopeData?.[d];return!!(w&&w.time.length>0)}else{const w=h(t).spectrumData?.[d];return!!(w&&w.frequency.length>0)}}function l(d){return h(t)?.scopeData?.[d]||null}function c(d){return h(t)?.spectrumData?.[d]||null}function u(d,y){if(a(y)==="scope"){const w=l(d);if(w)return{type:"scope",data:w}}else{const w=c(d);if(w)return{type:"spectrum",data:w}}return null}function f(d,y){if(h(i)===0||h(e).length===0)return[];const m=a(y);return h(e).slice(0,h(i)).map(b=>m==="scope"?b.scopeData?.[d]:b.spectrumData?.[d]).filter(b=>b!=null)}function p(){r(),s()}return{get simResult(){return h(t)},get resultHistory(){return h(e)},get simPhase(){return h(n)},get ghostTraces(){return h(i)},hasData:o,getScopeData:l,getSpectrumData:c,getPlotData:u,getGhostData:f,destroy:p}}var VM=Me('<button class="icon-btn" aria-label="Export CSV"><!></button>'),GM=Me('<button class="icon-btn" aria-label="Export"><!></button>'),XM=Me('<span class="help-icon">?</span>'),YM=Me("<option> </option>"),KM=Me('<select class="svelte-kkoyc2"></select>'),ZM=Me('<input type="text" class="svelte-kkoyc2"/>'),JM=Me('<div class="param-item"><label><span> </span> <!></label> <div class="param-input-row svelte-kkoyc2"><!> <button><!></button></div></div>'),QM=Me('<div class="section"><div class="section-title">Parameters</div> <div class="params-grid"></div></div>'),$M=Me('<div class="no-params">No configurable parameters</div>'),eT=Me('<div class="dialog-backdrop" role="presentation"><div class="properties-dialog glass-panel" role="dialog" tabindex="-1" aria-labelledby="dialog-title"><div class="dialog-header"><div class="node-info"><input id="dialog-title" class="node-name-input" type="text"/> <span class="node-type"> </span></div> <div class="header-actions"><!> <!> <!> <button class="icon-btn" aria-label="View Python Code"><!></button> <button class="icon-btn" aria-label="Close"><!></button></div></div> <div class="dialog-body"><!> <!></div> <div class="dialog-footer"><span class="hint">R rotate Â· X flip horizontal Â· Y flip vertical</span></div></div></div>'),tT=Me("<!> <!>",1);function nT(t,e){Tt(e,!0);let n=Oe(null),i=Oe(null);const r=W1.subscribe(F=>{J(n,F,!0),F?J(i,Fe.getNode(F)||null,!0):J(i,null)}),s=Fe.nodesArray.subscribe(F=>{h(n)&&J(i,F.find(q=>q.id===h(n))||null,!0)});Ei(()=>{r(),s()});const a=ne(()=>h(i)?Pi.get(h(i).type):null),o=ne(()=>h(a)?.blockClass?wM(h(a).blockClass):void 0),l=ne(()=>h(i)?.color||rl);function c(F){if(!h(i))return;const q=h(i).id;It.mutate(()=>Fe.updateNodeColor(q,F))}let u=Oe(!1),f=Oe("");function p(){if(!h(i))return;const F=Fe.getAllNodes(),q=Fe.getAllConnections().map(ue=>ue.connection),Z=Os.getCode(),W=gx(h(i),Z),Y=b0(h(i),F,q);J(f,W+Y),J(u,!0)}function d(){if(!h(i))return;const F=h(i).type===_n.SUBSYSTEM?"subsystem":"block";Jm(F,h(i).id)}const y=ne(()=>h(i)?.type!==_n.INTERFACE),m=ne(()=>h(i)?.type==="Scope"||h(i)?.type==="Spectrum"),w=WM(),b=ne(()=>h(n)&&h(i)&&h(m)?w.hasData(h(n),h(i).type):!1);function S(){!h(i)||!h(n)||x0(h(n),h(i).name,h(i).type)}function A(F,q){if(!h(i))return;const Z=h(i).id;It.mutate(()=>Fe.updateNodeParams(Z,{[F]:q}))}function _(F){return h(i)?.pinnedParams?.includes(F)??!1}function I(F){if(!h(i))return;const q=h(i).id,Z=h(i).pinnedParams??[],W=Z.includes(F)?Z.filter(Y=>Y!==F):[...Z,F];It.mutate(()=>Fe.updateNode(q,{pinnedParams:W}))}function E(F){if(!h(i))return;const q=h(i).id;It.mutate(()=>Fe.updateNodeName(q,F))}function M(F){return F==null?"":typeof F=="object"?JSON.stringify(F):String(F)}function T(F){return F==null?"None":typeof F=="object"?JSON.stringify(F):String(F)}function D(F){F.target===F.currentTarget&&Ag()}function U(F){F.key==="Escape"&&Ag()}var C=tT();yn("keydown",ii,U);var N=Ue(C);{var B=F=>{var q=eT();q.__click=D;var Z=se(q),W=se(Z),Y=se(W),ue=se(Y);Br(ue),ue.__input=Be=>E(Be.currentTarget.value),wt(ue,Be=>$s?.(Be));var le=be(ue,2),O=se(le,!0);Q(le),Q(Y);var V=be(Y,2),G=se(V);d0(G,{get currentColor(){return h(l)},get defaultColor(){return rl},onSelect:c});var re=be(G,2);{var ae=Be=>{var Ie=VM();Ie.__click=S;var lt=se(Ie);qt(lt,{name:"table",size:16}),Q(Ie),wt(Ie,(We,Ke)=>$t?.(We,Ke),()=>h(b)?"Export CSV":"Run simulation to export data"),_e(()=>Ie.disabled=!h(b)),j(Be,Ie)};ke(re,Be=>{h(m)&&Be(ae)})}var ee=be(re,2);{var de=Be=>{var Ie=GM();Ie.__click=d;var lt=se(Ie);qt(lt,{name:"upload",size:16}),Q(Ie),wt(Ie,(We,Ke)=>$t?.(We,Ke),()=>"Export"),j(Be,Ie)};ke(ee,Be=>{h(y)&&Be(de)})}var he=be(ee,2);he.__click=p;var pe=se(he);qt(pe,{name:"braces",size:16}),Q(he),wt(he,(Be,Ie)=>$t?.(Be,Ie),()=>"View Python Code");var ge=be(he,2);ge.__click=function(...Be){Ag?.apply(this,Be)};var Ee=se(ge);qt(Ee,{name:"x",size:16}),Q(ge),Q(V),Q(W);var Ae=be(W,2),Ye=se(Ae);{var K=Be=>{var Ie=QM(),lt=be(se(Ie),2);fn(lt,21,()=>h(a).params,Nn,(We,Ke)=>{const ht=ne(()=>h(i).params[h(Ke).name]),Rt=ne(()=>_(h(Ke).name));var ye=JM(),qe=se(ye),ve=se(qe),Pe=se(ve,!0);Q(ve);var Le=be(ve,2);{var it=bt=>{var ot=XM();wt(ot,(vt,jt)=>$t?.(vt,jt),()=>h(Ke).description),j(bt,ot)};ke(Le,bt=>{h(Ke).description&&bt(it)})}Q(qe);var nt=be(qe,2),_t=se(nt);{var At=bt=>{var ot=KM();ot.__change=jt=>A(h(Ke).name,jt.currentTarget.value),fn(ot,21,()=>h(Ke).options,Nn,(jt,kt)=>{var gt=YM(),Gt=se(gt,!0);Q(gt);var oi={};_e(()=>{Wt(Gt,h(kt)),oi!==(oi=h(kt))&&(gt.value=(gt.__value=h(kt))??"")}),j(jt,gt)}),Q(ot);var vt;Tb(ot),_e(jt=>{fe(ot,"id",`param-${h(Ke).name??""}`),vt!==(vt=jt)&&(ot.value=(ot.__value=jt)??"",Nh(ot,jt))},[()=>M(h(ht))]),j(bt,ot)},St=bt=>{var ot=ZM();Br(ot),ot.__input=vt=>A(h(Ke).name,vt.currentTarget.value),wt(ot,vt=>$s?.(vt)),_e((vt,jt)=>{fe(ot,"id",`param-${h(Ke).name??""}`),ps(ot,vt),fe(ot,"placeholder",jt)},[()=>M(h(ht)),()=>T(h(Ke).default)]),j(bt,ot)};ke(_t,bt=>{h(Ke).options&&h(Ke).options.length>0?bt(At):bt(St,!1)})}var st=be(_t,2);let Ot;st.__click=()=>I(h(Ke).name);var dt=se(st);{let bt=ne(()=>h(Rt)?"pin-filled":"pin");qt(dt,{get name(){return h(bt)},size:14})}Q(st),wt(st,(bt,ot)=>$t?.(bt,ot),()=>h(Rt)?"Unpin from node":"Pin to node"),Q(nt),Q(ye),_e(()=>{fe(qe,"for",`param-${h(Ke).name??""}`),Wt(Pe,h(Ke).name),Ot=Xt(st,1,"pin-btn svelte-kkoyc2",null,Ot,{pinned:h(Rt)}),fe(st,"aria-label",h(Rt)?"Unpin from node":"Pin to node")}),j(We,ye)}),Q(lt),Q(Ie),j(Be,Ie)},Re=Be=>{var Ie=$M();j(Be,Ie)};ke(Ye,Be=>{h(a).params.length>0?Be(K):Be(Re,!1)})}var Qe=be(Ye,2);vx(Qe,{get docstringHtml(){return h(o)}}),Q(Ae),Ri(2),Q(Z),Q(q),_e(()=>{An(Z,`--node-color: ${h(l)??""}`),ps(ue,h(i).name),Wt(O,h(a).name)}),Si(3,Z,()=>po,()=>({start:.95,duration:150,easing:Da})),Si(3,q,()=>dl,()=>({duration:150})),j(F,q)};ke(N,F=>{h(n)&&h(i)&&h(a)&&F(B)})}var P=be(N,2);w0(P,{get open(){return h(u)},get code(){return h(f)},title:"Block Python Code",onClose:()=>J(u,!1)}),j(t,C),Dt()}Kn(["click","input","change"]);var iT=Me('<span class="block-pill svelte-n1vk93"> </span>'),rT=Me('<div class="section"><div class="section-title">Block References</div> <div class="block-pills svelte-n1vk93"></div></div>'),sT=Me('<span class="help-icon">?</span>'),aT=Me('<div class="param-item"><label><span> </span> <!></label> <input type="text"/></div>'),oT=Me('<div><div class="section-title">Parameters</div> <div class="params-grid"></div></div>'),lT=Me('<div class="no-params">No configurable parameters</div>'),cT=Me('<div class="dialog-backdrop" role="presentation"><div class="properties-dialog glass-panel" role="dialog" tabindex="-1" aria-labelledby="dialog-title"><div class="dialog-header"><div class="node-info"><input id="dialog-title" class="node-name-input" type="text"/> <span class="node-type"> </span></div> <div class="header-actions"><!> <button class="icon-btn" aria-label="View Python Code"><!></button> <button class="icon-btn" aria-label="Close"><!></button></div></div> <div class="dialog-body"><!> <!> <!></div> <div class="dialog-footer"><span class="hint">Events trigger actions during simulation</span></div></div></div>'),uT=Me("<!> <!>",1);function dT(t,e){Tt(e,!0);let n=Oe(null),i=Oe(null);const r=u0.subscribe(M=>{J(n,M,!0),M?J(i,vn.getEvent(M)||null,!0):J(i,null)}),s=vn.eventsArray.subscribe(M=>{h(n)&&J(i,M.find(T=>T.id===h(n))||null,!0)});Ei(()=>{r(),s()});const a=ne(()=>h(i)?oa.get(h(i).type):null),o=ne(()=>h(i)?.color||rl);function l(M){if(!h(i))return;const T=h(i).id;It.mutate(()=>vn.updateEventColor(T,M))}let c=Oe(!1),u=Oe("");function f(){if(!h(i))return;const M=Os.getCode(),T=mx(h(i),M),D=ux(h(i));J(u,T+D),J(c,!0)}const p=ne(()=>()=>{const M=Je(Fe.nodesArray),T=[],D=new Set;for(const U of M){let C=La(U.name);(!C||D.has(C))&&(C=`block_${T.length}`),D.add(C),T.push(C)}return T.sort()});function d(M,T){if(!h(i))return;const D=h(i).id;It.mutate(()=>vn.updateEventParams(D,{[M]:T}))}function y(M){if(!h(i))return;const T=h(i).id;It.mutate(()=>vn.updateEventName(T,M))}function m(M){return M==null?"":typeof M=="object"?JSON.stringify(M):String(M)}function w(M){return M==null?"None":typeof M=="object"?JSON.stringify(M):String(M)}function b(M){M.target===M.currentTarget&&Lg()}function S(M){M.key==="Escape"&&Lg()}var A=uT();yn("keydown",ii,S);var _=Ue(A);{var I=M=>{var T=cT();T.__click=b;var D=se(T),U=se(D),C=se(U),N=se(C);Br(N),N.__input=de=>y(de.currentTarget.value),wt(N,de=>$s?.(de));var B=be(N,2),P=se(B,!0);Q(B),Q(C);var F=be(C,2),q=se(F);d0(q,{get currentColor(){return h(o)},get defaultColor(){return rl},onSelect:l});var Z=be(q,2);Z.__click=f;var W=se(Z);qt(W,{name:"braces",size:16}),Q(Z),wt(Z,(de,he)=>$t?.(de,he),()=>"View Python Code");var Y=be(Z,2);Y.__click=function(...de){Lg?.apply(this,de)};var ue=se(Y);qt(ue,{name:"x",size:16}),Q(Y),Q(F),Q(U);var le=be(U,2),O=se(le);{var V=de=>{var he=rT(),pe=be(se(he),2);fn(pe,21,()=>h(p)(),Nn,(ge,Ee)=>{var Ae=iT(),Ye=se(Ae,!0);Q(Ae),_e(()=>Wt(Ye,h(Ee))),j(ge,Ae)}),Q(pe),Q(he),j(de,he)};ke(O,de=>{h(p)().length>0&&de(V)})}var G=be(O,2);{var re=de=>{var he=oT();let pe;var ge=be(se(he),2);fn(ge,21,()=>h(a).params,Nn,(Ee,Ae)=>{const Ye=ne(()=>h(i).params[h(Ae).name]),K=ne(()=>h(Ae).type==="callable"?h(Ae).description?h(Ae).description+". Define functions in Code Editor (E)":"Define functions in Code Editor (E)":h(Ae).description);var Re=aT(),Qe=se(Re),Be=se(Qe),Ie=se(Be,!0);Q(Be);var lt=be(Be,2);{var We=ht=>{var Rt=sT();wt(Rt,(ye,qe)=>$t?.(ye,qe),()=>h(K)),j(ht,Rt)};ke(lt,ht=>{h(K)&&ht(We)})}Q(Qe);var Ke=be(Qe,2);Br(Ke),Ke.__input=ht=>d(h(Ae).name,ht.currentTarget.value),wt(Ke,ht=>$s?.(ht)),Q(Re),_e((ht,Rt)=>{fe(Qe,"for",`param-${h(Ae).name??""}`),Wt(Ie,h(Ae).name),fe(Ke,"id",`param-${h(Ae).name??""}`),ps(Ke,ht),fe(Ke,"placeholder",Rt)},[()=>m(h(Ye)),()=>w(h(Ae).default)]),j(Ee,Re)}),Q(ge),Q(he),_e(Ee=>pe=Xt(he,1,"section svelte-n1vk93",null,pe,Ee),[()=>({"with-separator":h(p)().length>0})]),j(de,he)},ae=de=>{var he=lT();j(de,he)};ke(G,de=>{h(a).params.length>0?de(re):de(ae,!1)})}var ee=be(G,2);vx(ee,{get docstringHtml(){return h(a).docstringHtml}}),Q(le),Ri(2),Q(D),Q(T),_e(()=>{An(D,`--node-color: ${h(o)??""}`),ps(N,h(i).name),Wt(P,h(a).name)}),Si(3,D,()=>po,()=>({start:.95,duration:150,easing:Da})),Si(3,T,()=>dl,()=>({duration:150})),j(M,T)};ke(_,M=>{h(n)&&h(i)&&h(a)&&M(I)})}var E=be(_,2);w0(E,{get open(){return h(c)},get code(){return h(u)},title:"Event Python Code",onClose:()=>J(c,!1)}),j(t,A),Dt()}Kn(["click","input"]);const{subscribe:fT,set:E2}=ln(null),Kh={subscribe:fT,open(t,e){E2({code:t,title:e})},close(){E2(null)}},Og={responsive:!0,displaylogo:!1,displayModeBar:"hover",modeBarButtonsToRemove:["lasso2d","select2d","toImage"],modeBarButtonsToAdd:[],scrollZoom:!0,doubleClick:"reset"};function wx(t,e=!1){const{style:n,ghost:i,signalIndex:r,label:s}=t,a=e?t.xDecimated:t.x,o=e?t.yDecimated:t.y,l=n.lineStyle!==null,c=n.markerStyle!==null;let u="lines";l&&c?u="lines+markers":c&&(u="markers");const f={x:a,y:o,type:"scatter",mode:u,name:s,legendgroup:`signal-${r}`};return i?(f.opacity=i.opacity,f.showlegend=!1,f.hoverinfo="skip"):f.hovertemplate=`<b style="color:${n.color}">${s}</b><br>x = %{x:.4g}<br>y = %{y:.4g}<extra></extra>`,l&&n.lineStyle&&(f.line={color:n.color,width:i?1:1.5,dash:bE[n.lineStyle]}),c&&n.markerStyle&&(f.marker={symbol:wE[n.markerStyle],size:i?5:6,color:n.color},f.cliponaxis=!1),f}function hT(t,e){const n=wx(t,!1);return!t.ghost&&e&&(n.customdata=e,n.hovertemplate=`<b style="color:${t.style.color}">${t.label}</b><br>f = %{customdata:.2f} Hz<br>mag = %{y:.4g}<extra></extra>`),n}function xx(){const t=lu("--text-muted"),e=lu("--text-disabled"),n=lu("--surface-raised"),i=lu("--border"),r=lu("--accent");return{paper_bgcolor:"transparent",plot_bgcolor:"transparent",font:{color:t,family:"Inter, system-ui, sans-serif",size:11},margin:{l:60,r:15,t:10,b:45},xaxis:{gridcolor:i,gridwidth:.5,zeroline:!1,linecolor:i,linewidth:1.5,tickfont:{size:10,color:e},title:{standoff:10}},yaxis:{gridcolor:i,gridwidth:.5,zeroline:!1,linecolor:i,linewidth:1.5,tickfont:{size:10,color:e},title:{standoff:5}},legend:{bgcolor:n,bordercolor:i,borderwidth:1,font:{size:10,color:t},x:.01,xanchor:"left",y:.99,yanchor:"top"},modebar:{bgcolor:"transparent",color:e,activecolor:r},hoverlabel:{bgcolor:n,bordercolor:i,font:{color:t,size:11}}}}function Fg(t){const{type:e,title:n,layout:i,frequencies:r}=t,s=xx(),a=e==="scope"?"Time (s)":"Frequency (Hz)",o=e==="scope"?n.toLowerCase().startsWith("scope")?n:`Scope: ${n}`:n.toLowerCase().startsWith("spectrum")?n:`Spectrum: ${n}`,l={...s,xaxis:{...s.xaxis,title:{text:a,font:{size:11},standoff:10},type:i.xAxisScale},yaxis:{...s.yaxis,title:{text:o,font:{size:11},standoff:5},type:i.yAxisScale},showlegend:i.showLegend,hovermode:"closest"};if(e==="spectrum"&&r&&r.length>0){const c=Math.min(6,r.length),u=Math.max(1,Math.floor((r.length-1)/(c-1))),f=[],p=[];for(let d=0;d<r.length;d+=u)f.push(d),p.push(a2(r[d]));f[f.length-1]!==r.length-1&&(f.push(r.length-1),p.push(a2(r[r.length-1]))),l.xaxis={...l.xaxis,tickvals:f,ticktext:p,tickangle:0}}return l}function pT(t){const e=lu("--text-disabled");return{...t,annotations:[{text:"No data",xref:"paper",yref:"paper",x:.5,y:.5,showarrow:!1,font:{size:14,color:e}}]}}var gT=Me('<div class="plot-container svelte-oa38j7"><div class="plot svelte-oa38j7"></div></div>');function I2(t,e){Tt(e,!0);let n,i=null,r=null,s=Oe(null),a=Oe(!1),o=!1,l=0,c=0,u=!1;const f=ol.subscribe(()=>{if(i&&n){const E=xx();i.relayout(n,{"font.color":E.font?.color,"xaxis.gridcolor":E.xaxis?.gridcolor,"xaxis.linecolor":E.xaxis?.linecolor,"xaxis.tickfont.color":E.xaxis?.tickfont?.color,"yaxis.gridcolor":E.yaxis?.gridcolor,"yaxis.linecolor":E.yaxis?.linecolor,"yaxis.tickfont.color":E.yaxis?.tickfont?.color,"legend.bgcolor":E.legend?.bgcolor,"legend.bordercolor":E.legend?.bordercolor,"legend.font.color":E.legend?.font?.color,"modebar.color":E.modebar?.color,"modebar.activecolor":E.modebar?.activecolor,"hoverlabel.bgcolor":E.hoverlabel?.bgcolor,"hoverlabel.bordercolor":E.hoverlabel?.bordercolor,"hoverlabel.font.color":E.hoverlabel?.font?.color})}}),p=wp.subscribe(E=>{J(s,E.plots.get(e.nodeId)??null,!0);const M=E.isStreaming;(M&&!u||!M&&u)&&(o=!1,l=0,c=0),u=M,J(a,M,!0),i&&n&&d()});ju(async()=>{i=await hs(()=>import("./bCZ0t4tq.js").then(E=>E.p),[],import.meta.url),h(s)&&d(),r=new ResizeObserver(()=>{i&&n&&i.Plots.resize(n)}),r.observe(n)}),Ei(()=>{p(),f(),r?.disconnect(),i&&n&&i.purge(n)});function d(){if(!(!i||!n)){if(h(s)?.type==="spectrum"){y();return}m()}}function y(){if(!i||!n||!h(s)){S();return}const E=h(s).traces.map(M=>hT(M,h(s).frequencies));if(E.length===0)S();else{const M=Fg(h(s));i.react(n,E,M,Og)}}function m(){if(!i||!n)return;if(!h(s)||h(s).traces.length===0){S(),o=!1,l=0;return}const M=h(s).traces.find(T=>!T.ghost)?.x.length??0;if(h(a)&&o&&M>l){b(M);return}w()}function w(){if(!i||!n||!h(s))return;c=h(s).traces.filter(D=>D.ghost).length;const E=h(s).traces.map(D=>wx(D)),M=Fg(h(s));i.react(n,E,M,Og);const T=h(s).traces.find(D=>!D.ghost);h(a)&&T&&T.x.length>0&&(o=!0,l=T.x.length)}function b(E){if(!i||!n||!h(s))return;const M=l,T=h(s).traces.filter(N=>!N.ghost),D=[],U=[],C=[];T.forEach((N,B)=>{D.push(N.x.slice(M)),U.push(N.y.slice(M)),C.push(c+B)}),D.length>0&&D[0].length>0&&i.extendTraces(n,{x:D,y:U},C),l=E}function S(){if(!i||!n)return;const E=h(s)?Fg(h(s)):{paper_bgcolor:"transparent",plot_bgcolor:"transparent",margin:{l:60,r:15,t:10,b:45}},M=pT(E);i.newPlot(n,[],M,Og)}function A(E){E.preventDefault(),so.openForPlot(e.nodeId,n,{x:E.clientX,y:E.clientY})}var _=gT(),I=se(_);I.__contextmenu=A,ji(I,E=>n=E,()=>n),Q(_),j(t,_),Dt()}Kn(["contextmenu"]);var mT=Me('<div class="plot-tile svelte-qkhkod"><!></div>'),vT=Me("<div></div>"),yT=Me('<div class="plot-area svelte-qkhkod"></div>'),bT=Me('<div class="placeholder svelte-qkhkod"><p>Run simulation to see plots</p> <p class="hint svelte-qkhkod">Add Scope or Spectrum nodes to record signals</p></div>'),wT=Me('<div class="plot-content svelte-qkhkod"><!></div>'),xT=Me("<div><!></div>");function _T(t,e){Tt(e,!0);let n=ct(e,"collapsed",3,!1),i=ct(e,"activeTab",15,0),r=ct(e,"viewMode",3,"tabs"),s=Oe(void 0),a=Oe(0),o=Oe(0),l=null;const c=320,u=220;function f(M,T){if(M<=1)return{cols:1,rows:1,needsScroll:!1};if(T===0)return{cols:1,rows:M,needsScroll:!1};const D=Math.min(Math.max(1,Math.floor(T/c)),M),U=Math.ceil(M/D),C=U*u>h(o);return{cols:D,rows:U,needsScroll:C}}mn(()=>(h(s)&&(l?.disconnect(),l=new ResizeObserver(M=>{for(const T of M)J(a,T.contentRect.width,!0),J(o,T.contentRect.height,!0)}),l.observe(h(s))),()=>{l?.disconnect()}));let p=Oe(Rn([]));const d=wp.subscribe(M=>{J(p,Array.from(M.plots.values()),!0)});Ei(()=>{d()});const y=ne(()=>()=>h(p));mn(()=>{const M=h(y)();i()>=M.length&&M.length>0&&i(0)});const m=ne(()=>h(y)().length>0),w=ne(()=>f(h(y)().length,h(a)));function b(){return h(y)()}var S={getPlots:b},A=xT();let _;var I=se(A);{var E=M=>{var T=wT(),D=se(T);{var U=N=>{var B=$e(),P=Ue(B);{var F=Z=>{var W=vT();let Y;fn(W,21,()=>h(y)(),ue=>ue.nodeId,(ue,le)=>{var O=mT(),V=se(O);I2(V,{get nodeId(){return h(le).nodeId}}),Q(O),j(ue,O)}),Q(W),_e(()=>{Y=Xt(W,1,"plot-grid svelte-qkhkod",null,Y,{scrollable:h(w).needsScroll}),An(W,`grid-template-columns: repeat(${h(w).cols??""}, 1fr); --min-tile-height: 220px;`)}),j(Z,W)},q=Z=>{var W=yT();fn(W,23,()=>h(y)(),Y=>Y.nodeId,(Y,ue,le)=>{var O=$e(),V=Ue(O);{var G=re=>{I2(re,{get nodeId(){return h(ue).nodeId}})};ke(V,re=>{i()===h(le)&&re(G)})}j(Y,O)}),Q(W),j(Z,W)};ke(P,Z=>{r()==="tiles"?Z(F):Z(q,!1)})}j(N,B)},C=N=>{var B=bT();j(N,B)};ke(D,N=>{h(m)?N(U):N(C,!1)})}Q(T),ji(T,N=>J(s,N),()=>h(s)),j(M,T)};ke(I,M=>{n()||M(E)})}return Q(A),_e(()=>_=Xt(A,1,"plot-panel svelte-qkhkod",null,_,{collapsed:n()})),j(t,A),Dt(S)}var ST=Me('<div class="placeholder svelte-gwrzq5"><p>Run simulation to see output</p> <p class="shortcut svelte-gwrzq5">Ctrl+Enter</p></div>'),kT=Me('<div><span class="log-message svelte-gwrzq5"> </span></div>'),AT=Me('<button class="scroll-to-bottom svelte-gwrzq5" aria-label="Scroll to bottom"><!></button>'),NT=Me('<div class="console-panel svelte-gwrzq5"><div class="console-content svelte-gwrzq5"><!></div> <!></div>');function CT(t,e){Tt(e,!0);let n=Oe(Rn([])),i=Oe(void 0),r=Oe(!0),s=-1,a=null;const o=ri.subscribe(b=>{J(n,b,!0)});mn(()=>{const b=h(n).length>0?h(n)[h(n).length-1].id:-1;b>s&&h(r)&&h(i)&&(a!==null&&clearTimeout(a),a=setTimeout(()=>{a=null,h(i)&&(h(i).scrollTop=h(i).scrollHeight)},0)),s=b}),Ei(()=>{o(),a!==null&&clearTimeout(a)});function l(){if(!h(i))return;const{scrollTop:b,scrollHeight:S,clientHeight:A}=h(i);J(r,b+A>=S-20)}function c(){h(i)&&(h(i).scrollTop=h(i).scrollHeight,J(r,!0))}var u=NT(),f=se(u),p=se(f);{var d=b=>{var S=ST();j(b,S)},y=b=>{var S=$e(),A=Ue(S);fn(A,17,()=>h(n),_=>_.id,(_,I)=>{var E=kT(),M=se(E),T=se(M,!0);Q(M),Q(E),_e(()=>{Xt(E,1,`log-entry ${h(I).level??""}`,"svelte-gwrzq5"),Wt(T,h(I).message)}),j(_,E)}),j(b,S)};ke(p,b=>{h(n).length===0?b(d):b(y,!1)})}Q(f),ji(f,b=>J(i,b),()=>h(i));var m=be(f,2);{var w=b=>{var S=AT();S.__click=c;var A=se(S);qt(A,{name:"chevron-down",size:16}),Q(S),j(b,S)};ke(m,b=>{!h(r)&&h(n).length>0&&b(w)})}Q(u),yn("scroll",f,l),j(t,u),Dt()}Kn(["click"]);var PT=Me('<div class="loading svelte-1q7n0z0">Loading editor...</div>'),ET=Me('<div class="error-bar svelte-1q7n0z0"> </div>'),IT=Me('<div class="code-editor svelte-1q7n0z0"><div class="editor-container svelte-1q7n0z0"><!></div> <!> <div class="footer svelte-1q7n0z0">Define Python variables and functions to use in node parameters.</div></div>');function LT(t,e){Tt(e,!0);let n,i=null,r=null,s=Oe(!0),a=Oe("dark"),o=Oe(""),l=Oe(null),c=[];function u(){return r?$d(r,h(a)==="dark",{keymaps:[{key:"Mod-Enter",run:()=>(window.dispatchEvent(new CustomEvent("run-simulation")),!0)},{key:"Shift-Enter",run:()=>(window.dispatchEvent(new CustomEvent("continue-simulation")),!0)},{key:"Escape",run:_=>(_.contentDOM.blur(),!0)}],onDocChange:_=>{Os.setCode(_)}}):[]}function f(){if(!i||!n||!r)return;const _=i.state.doc.toString();i.destroy(),i=new r.EditorView({doc:_,extensions:u(),parent:n})}function p(){i?.focus()}ju(async()=>{c.push(Os.code.subscribe(_=>{J(o,_,!0),i&&i.state.doc.toString()!==_&&i.dispatch({changes:{from:0,to:i.state.doc.length,insert:_}})})),c.push(Os.lastError.subscribe(_=>{J(l,_,!0)})),c.push(ol.subscribe(_=>{J(a,_,!0),i&&r&&f()})),r=await Pp(),i=new r.EditorView({doc:h(o),extensions:u(),parent:n}),J(s,!1)}),Ei(()=>{c.forEach(_=>_()),i&&i.destroy()});var d={focus:p},y=IT(),m=se(y),w=se(m);{var b=_=>{var I=PT();j(_,I)};ke(w,_=>{h(s)&&_(b)})}Q(m),ji(m,_=>n=_,()=>n);var S=be(m,2);{var A=_=>{var I=ET(),E=se(I,!0);Q(I),_e(()=>Wt(E,h(l))),j(_,I)};ke(S,_=>{h(l)&&_(A)})}return Ri(2),Q(y),j(t,y),Dt(d)}var MT=Me('<div><span class="node-name svelte-1yeydg2"> </span></div>');function L2(t,e){Tt(e,!0);const n=ne(()=>e.node.category==="Subsystem"),i=ne(()=>()=>Y5(e.node));var r=MT();let s;var a=se(r),o=se(a,!0);Q(a),Q(r),_e(l=>{s=Xt(r,1,`node-preview ${l??""}`,"svelte-1yeydg2",s,{"subsystem-type":h(n)}),Wt(o,e.node.name)},[()=>h(i)()]),j(t,r),Dt()}var TT=Me('<button class="clear-btn svelte-xht9mx"><!></button>'),DT=Me('<button draggable="true"><!></button>'),OT=Me('<div class="tile-grid svelte-xht9mx"></div>'),FT=Me('<div class="category svelte-xht9mx"><button class="category-header svelte-xht9mx"><span><!></span> <span class="category-name svelte-xht9mx"> </span></button> <!></div>'),RT=Me('<div class="empty svelte-xht9mx"><span>No nodes found</span> <span class="hint svelte-xht9mx">Try "gain", "source", or "plot"</span></div>'),BT=Me('<div class="drag-preview-wrapper svelte-xht9mx"><!></div>'),zT=Me('<div class="node-library svelte-xht9mx"><div class="search-container svelte-xht9mx"><span class="search-icon svelte-xht9mx"><!></span> <input type="text" placeholder="Search nodes..." class="search-input svelte-xht9mx"/> <!></div> <div class="node-grid-container svelte-xht9mx"></div> <div class="footer svelte-xht9mx"><span>Click or drag to add</span> <span>ââ Enter</span></div> <div class="drag-preview-container svelte-xht9mx" aria-hidden="true"><!></div></div>');function qT(t,e){Tt(e,!0);let n=ct(e,"focusSearch",3,!1),i=Oe(""),r,s=Oe(-1),a=Oe(!1),o=Oe(null),l,c=Oe(Rn(new Set));function u(Y){J(c,new Set(h(c)),!0),h(c).has(Y)?h(c).delete(Y):h(c).add(Y)}const f=[...Object.keys(G5),"Subsystem"],p=Pi.getAll(),d=ne(()=>()=>{let Y=p.filter(le=>le.type!==_n.INTERFACE);if(!h(i).trim())return Y;const ue=h(i).toLowerCase();return Y.filter(le=>le.name.toLowerCase().includes(ue)||le.category.toLowerCase().includes(ue)||le.description.toLowerCase().includes(ue))}),y=ne(()=>()=>{const Y=new Map;for(const le of h(d)())Y.has(le.category)||Y.set(le.category,[]),Y.get(le.category).push(le);const ue=new Map;for(const le of f)Y.has(le)&&ue.set(le,Y.get(le));return ue}),m=ne(()=>()=>{const Y=[];for(const[,ue]of h(y)())Y.push(...ue);return Y});function w(Y){J(o,Y,!0)}function b(Y,ue){if(J(a,!0),Y.dataTransfer&&(Y.dataTransfer.setData("application/pathview-node",ue.type),Y.dataTransfer.effectAllowed="copy",l)){const le=l.getBoundingClientRect();Y.dataTransfer.setDragImage(l,le.width/2,le.height/2)}}function S(){setTimeout(()=>{J(a,!1),J(o,null)},100)}function A(Y){h(a)||e.onAddNode&&e.onAddNode(Y.type)}function _(Y){const ue=h(m)();if(Y.key==="ArrowDown")Y.preventDefault(),J(s,Math.min(h(s)+1,ue.length-1),!0);else if(Y.key==="ArrowUp")Y.preventDefault(),J(s,Math.max(h(s)-1,-1),!0);else if(Y.key==="Enter"&&h(s)>=0){Y.preventDefault();const le=ue[h(s)];le&&e.onAddNode&&e.onAddNode(le.type)}else Y.key==="Escape"&&(h(i)?(J(i,""),J(s,-1),Y.stopPropagation()):r?.blur())}mn(()=>{h(i),J(s,h(i)?0:-1,!0)}),mn(()=>{n()&&r&&r.focus()});function I(Y){return h(m)()[h(s)]?.type===Y.type}function E(){r?.focus()}var M={focus:E},T=zT();T.__keydown=_;var D=se(T),U=se(D),C=se(U);qt(C,{name:"search",size:14}),Q(U);var N=be(U,2);Br(N),ji(N,Y=>r=Y,()=>r);var B=be(N,2);{var P=Y=>{var ue=TT();ue.__click=()=>J(i,"");var le=se(ue);qt(le,{name:"x",size:12}),Q(ue),j(Y,ue)};ke(B,Y=>{h(i)&&Y(P)})}Q(D);var F=be(D,2);fn(F,21,()=>Array.from(h(y)().entries()),Nn,(Y,ue)=>{var le=ne(()=>Rc(h(ue),2));let O=()=>h(le)[0],V=()=>h(le)[1];var G=FT(),re=se(G);re.__click=()=>u(O());var ae=se(re);let ee;var de=se(ae);qt(de,{name:"chevron-right",size:12}),Q(ae);var he=be(ae,2),pe=se(he,!0);Q(he),Q(re);var ge=be(re,2);{var Ee=Ae=>{var Ye=OT();fn(Ye,21,V,Nn,(K,Re)=>{var Qe=DT();let Be;Qe.__click=()=>A(h(Re));var Ie=se(Qe);L2(Ie,{get node(){return h(Re)}}),Q(Qe),wt(Qe,(lt,We)=>$t?.(lt,We),()=>h(Re).description),_e(lt=>Be=Xt(Qe,1,"node-tile svelte-xht9mx",null,Be,lt),[()=>({selected:I(h(Re))})]),yn("mouseenter",Qe,()=>w(h(Re))),yn("dragstart",Qe,lt=>b(lt,h(Re))),yn("dragend",Qe,S),j(K,Qe)}),Q(Ye),j(Ae,Ye)};ke(ge,Ae=>{h(c).has(O())||Ae(Ee)})}Q(G),_e(Ae=>{ee=Xt(ae,1,"chevron svelte-xht9mx",null,ee,Ae),Wt(pe,O())},[()=>({expanded:!h(c).has(O())})]),j(Y,G)},Y=>{var ue=RT();j(Y,ue)}),Q(F);var q=be(F,4),Z=se(q);{var W=Y=>{var ue=BT(),le=se(ue);L2(le,{get node(){return h(o)}}),Q(ue),ji(ue,O=>l=O,()=>l),j(Y,ue)};ke(Z,Y=>{h(o)&&Y(W)})}return Q(q),Q(T),Rb(N,()=>h(i),Y=>J(i,Y)),j(t,T),Dt(M)}Kn(["keydown","click"]);var jT=Me('<div class="event-preview-wrapper svelte-1s8vqme"><div class="event-preview svelte-1s8vqme"><span class="event-name svelte-1s8vqme"> </span></div></div>');function HT(t,e){Tt(e,!0);var n=jT(),i=se(n),r=se(i),s=se(r,!0);Q(r),Q(i),Q(n),_e(()=>Wt(s,e.event.name)),j(t,n),Dt()}var UT=Me('<button class="event-tile svelte-d3r2aj"><!></button>'),WT=Me('<div class="events-panel svelte-d3r2aj"><div class="event-grid-container svelte-d3r2aj"><div class="tile-grid svelte-d3r2aj"></div></div> <div class="footer svelte-d3r2aj">Click or drag to add</div></div>');function VT(t,e){Tt(e,!0);const n=oa.getAll();let i=Oe(!0);Fe.currentPath.subscribe(p=>{J(i,p.length===0)});let r=Oe(!1);function s(p,d){const y=oa.get(p);y&&It.mutate(()=>{if(h(i))vn.addEvent(p,d);else{const m={id:crypto.randomUUID(),type:p,name:y.name,position:d,params:{}};Fe.addSubsystemEvent(m)}})}function a(p,d){J(r,!0),p.dataTransfer&&(p.dataTransfer.setData("application/pathview-event",d.type),p.dataTransfer.effectAllowed="copy")}function o(){setTimeout(()=>{J(r,!1)},100)}function l(p){if(!h(r))if(e.onAddEvent)e.onAddEvent(p.type);else{const d=uo({x:window.innerWidth/2,y:window.innerHeight/2});s(p.type,d)}}var c=WT(),u=se(c),f=se(u);fn(f,21,()=>n,Nn,(p,d)=>{var y=UT();fe(y,"draggable",!0),y.__click=()=>l(h(d));var m=se(y);HT(m,{get event(){return h(d)}}),Q(y),wt(y,(w,b)=>$t?.(w,b),()=>h(d).description),yn("dragstart",y,w=>a(w,h(d))),yn("dragend",y,o),j(p,y)}),Q(f),Q(u),Ri(2),Q(c),j(t,c),Dt()}Kn(["click"]);var GT=Me('<div class="divider svelte-192vamk"></div>'),XT=Me('<span class="icon svelte-192vamk"><!></span>'),YT=Me('<kbd class="shortcut svelte-192vamk"> </kbd>'),KT=Me('<button role="menuitem"><!> <span class="label svelte-192vamk"> </span> <!></button>'),ZT=Me('<div class="backdrop svelte-192vamk" role="presentation"><div class="context-menu glass-panel svelte-192vamk" role="menu" tabindex="-1"></div></div>');function JT(t,e){Tt(e,!0);let n,i=Oe(null);mn(()=>{n&&J(i,n.getBoundingClientRect(),!0)});const r=ne(()=>()=>{if(!h(i))return e.x;const u=window.innerWidth;return e.x+h(i).width>u-10?e.x-h(i).width:e.x}),s=ne(()=>()=>{if(!h(i))return e.y;const u=window.innerHeight;return e.y+h(i).height>u-10?e.y-h(i).height:e.y});function a(u){u.disabled||(u.action(),e.onClose())}function o(u){u.key==="Escape"&&e.onClose()}var l=ZT();yn("keydown",ii,o),l.__click=function(...u){e.onClose?.apply(this,u)},l.__contextmenu=u=>{u.preventDefault(),e.onClose()},l.__keydown=u=>u.key==="Escape"&&e.onClose();var c=se(l);c.__click=u=>u.stopPropagation(),fn(c,21,()=>e.items,Nn,(u,f)=>{var p=$e(),d=Ue(p);{var y=w=>{var b=GT();j(w,b)},m=w=>{var b=KT();let S;b.__click=()=>a(h(f));var A=se(b);{var _=D=>{var U=XT(),C=se(U);qt(C,{get name(){return h(f).icon}}),Q(U),j(D,U)};ke(A,D=>{h(f).icon&&D(_)})}var I=be(A,2),E=se(I,!0);Q(I);var M=be(I,2);{var T=D=>{var U=YT(),C=se(U,!0);Q(U),_e(()=>Wt(C,h(f).shortcut)),j(D,U)};ke(M,D=>{h(f).shortcut&&D(T)})}Q(b),_e(()=>{S=Xt(b,1,"menu-item svelte-192vamk",null,S,{disabled:h(f).disabled}),b.disabled=h(f).disabled,Wt(E,h(f).label)}),j(w,b)};ke(d,w=>{h(f).divider?w(y):w(m,!1)})}j(u,p)}),Q(c),ji(c,u=>n=u,()=>n),Q(l),_e((u,f)=>An(c,`left: ${u??""}px; top: ${f??""}px;`),[()=>h(r)(),()=>h(s)()]),Si(3,c,()=>po,()=>({start:.95,duration:100,easing:Da})),j(t,l),Dt()}Kn(["click","contextmenu","keydown"]);function QT(){const t=Je(Fe.selectedNodeIds),e=Je(vn.selectedEventIds);return t.size===0&&e.size===0?!1:It.mutate(()=>{for(const n of t)Fe.getAnnotation(n)?Fe.removeAnnotation(n):Fe.removeNode(n);if(Fe.isAtRoot())for(const n of e)vn.removeEvent(n);else for(const n of e)Fe.removeSubsystemEvent(n);return!0})}const _x="pathview-clipboard",Qm="1.0",Yu=ln(null);function Uf(t){return{x:Math.round(t.x/Fn)*Fn,y:Math.round(t.y/Fn)*Fn}}function $T(t){if(t.length===0)return{x:0,y:0};let e=1/0,n=1/0,i=-1/0,r=-1/0;for(const s of t)e=Math.min(e,s.position.x),n=Math.min(n,s.position.y),i=Math.max(i,s.position.x),r=Math.max(r,s.position.y);return{x:(e+i)/2,y:(n+r)/2}}function eD(t){if(typeof t!="object"||t===null)return!1;const e=t;if(e.type!==_x||typeof e.version!="string")return!1;const n=e.content;return!n||typeof n!="object"?!1:Array.isArray(n.nodes)&&Array.isArray(n.connections)&&Array.isArray(n.events)&&typeof n.center=="object"&&n.center!==null}async function tD(t){try{const e={type:_x,version:Qm,content:t};return await navigator.clipboard.writeText(JSON.stringify(e)),!0}catch(e){return console.debug("System clipboard write failed:",e),!1}}async function nD(){try{const t=await navigator.clipboard.readText();if(!t)return null;const e=JSON.parse(t);return eD(e)?(e.version!==Qm&&console.warn(`Clipboard version mismatch: ${e.version} vs ${Qm}`),e.content):null}catch{return null}}async function Sx(){const t=Je(Fe.selectedNodeIds),e=Je(vn.selectedEventIds),n=[];for(const p of t){const d=Fe.getAnnotation(p);d&&n.push(JSON.parse(JSON.stringify(d)))}const i=new Set;for(const p of t)Fe.getAnnotation(p)||i.add(p);if(i.size===0&&e.size===0&&n.length===0)return!1;const r=Je(Fe.nodes),s=Je(Fe.connections),a=[];for(const p of i){const d=r.get(p);d&&d.type!==_n.INTERFACE&&a.push(JSON.parse(JSON.stringify(d)))}const o=[];for(const p of s)i.has(p.sourceNodeId)&&i.has(p.targetNodeId)&&o.push(JSON.parse(JSON.stringify(p)));const l=[];if(Fe.isAtRoot())for(const p of e){const d=vn.getEvent(p);d&&l.push(JSON.parse(JSON.stringify(d)))}else for(const p of e){const d=Fe.getSubsystemEvent(p);d&&l.push(JSON.parse(JSON.stringify(d)))}const c=[...a.map(p=>({position:p.position})),...l.map(p=>({position:p.position})),...n.map(p=>({position:p.position}))],u=$T(c),f={nodes:a,connections:o,events:l,annotations:n,center:u};return Yu.set(f),await tD(f),!0}async function iD(t){let e=await nD();if(e||(e=Je(Yu)),e?.annotations||(e=e?{...e,annotations:[]}:null),!e||e.nodes.length===0&&e.events.length===0&&e.annotations.length===0)return{nodeIds:[],eventIds:[],annotationIds:[]};const n=Xh(e.nodes);if(n.length>0){console.warn(`Clipboard paste: skipping unknown block types: ${n.join(", ")}`);const i=e.nodes.filter(a=>a.type===_n.SUBSYSTEM||a.type===_n.INTERFACE||Pi.has(a.type)),r=new Set(i.map(a=>a.id)),s=e.connections.filter(a=>r.has(a.sourceNodeId)&&r.has(a.targetNodeId));if(e={...e,nodes:i,connections:s},e.nodes.length===0&&e.events.length===0&&e.annotations.length===0)return{nodeIds:[],eventIds:[],annotationIds:[]}}return It.mutate(()=>{const i=Uf(t),r={x:i.x-e.center.x,y:i.y-e.center.y},s=new Map,a=[];for(const f of e.nodes){const p=sr();s.set(f.id,p);const d=Uf({x:f.position.x+r.x,y:f.position.y+r.y}),y=ow(f,d,p);a.push(y)}const o=[];for(const f of e.connections){const p=s.get(f.sourceNodeId),d=s.get(f.targetNodeId);p&&d&&o.push({id:sr(),sourceNodeId:p,sourcePortIndex:f.sourcePortIndex,targetNodeId:d,targetPortIndex:f.targetPortIndex})}Fe.clearSelection(),vn.clearSelection();const l=Fe.pasteNodes(a,o),c=[];for(const f of e.events){const p=Uf({x:f.position.x+r.x,y:f.position.y+r.y});if(Fe.isAtRoot()){const d=vn.addEvent(f.type,p,f.name);d&&(Object.keys(f.params).length>0&&vn.updateEventParams(d.id,f.params),f.color&&vn.updateEventColor(d.id,f.color),c.push(d.id),vn.selectEvent(d.id,!0))}else{const d=sr(),y={...f,id:d,position:p};Fe.addSubsystemEvent(y),c.push(d)}}const u=[];for(const f of e.annotations){const p=Uf({x:f.position.x+r.x,y:f.position.y+r.y}),d=Fe.addAnnotation(p);Fe.updateAnnotation(d,{content:f.content,width:f.width,height:f.height,color:f.color,fontSize:f.fontSize}),u.push(d)}return{nodeIds:l,eventIds:c,annotationIds:u}})}async function rD(){return await Sx()?(QT(),!0):!1}function sD(){const t=Je(Yu);return t!==null&&(t.nodes.length>0||t.events.length>0||t.annotations.length>0)}function aD(){Yu.set(null)}function oD(){const t=Je(Yu);return t?{nodes:t.nodes.length,connections:t.connections.length,events:t.events.length,annotations:t.annotations.length}:null}const fo={subscribe:Yu.subscribe,copy:Sx,cut:rD,paste:iD,hasContent:sD,clear:aD,getSummary:oD};function Un(t){"@babel/helpers - typeof";return Un=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Un(t)}var Ma=Uint8Array,Ds=Uint16Array,_0=Int32Array,S0=new Ma([0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0,0,0,0]),k0=new Ma([0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13,0,0]),M2=new Ma([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]),kx=function(t,e){for(var n=new Ds(31),i=0;i<31;++i)n[i]=e+=1<<t[i-1];for(var r=new _0(n[30]),i=1;i<30;++i)for(var s=n[i];s<n[i+1];++s)r[s]=s-n[i]<<5|i;return{b:n,r}},Ax=kx(S0,2),lD=Ax.b,$m=Ax.r;lD[28]=258,$m[258]=28;var cD=kx(k0,0),T2=cD.r,e1=new Ds(32768);for(var di=0;di<32768;++di){var Fl=(di&43690)>>1|(di&21845)<<1;Fl=(Fl&52428)>>2|(Fl&13107)<<2,Fl=(Fl&61680)>>4|(Fl&3855)<<4,e1[di]=((Fl&65280)>>8|(Fl&255)<<8)>>1}var Ed=(function(t,e,n){for(var i=t.length,r=0,s=new Ds(e);r<i;++r)t[r]&&++s[t[r]-1];var a=new Ds(e);for(r=1;r<e;++r)a[r]=a[r-1]+s[r-1]<<1;var o;if(n){o=new Ds(1<<e);var l=15-e;for(r=0;r<i;++r)if(t[r])for(var c=r<<4|t[r],u=e-t[r],f=a[t[r]-1]++<<u,p=f|(1<<u)-1;f<=p;++f)o[e1[f]>>l]=c}else for(o=new Ds(i),r=0;r<i;++r)t[r]&&(o[r]=e1[a[t[r]-1]++]>>15-t[r]);return o}),Mc=new Ma(288);for(var di=0;di<144;++di)Mc[di]=8;for(var di=144;di<256;++di)Mc[di]=9;for(var di=256;di<280;++di)Mc[di]=7;for(var di=280;di<288;++di)Mc[di]=8;var Zh=new Ma(32);for(var di=0;di<32;++di)Zh[di]=5;var uD=Ed(Mc,9,0),dD=Ed(Zh,5,0),Nx=function(t){return(t+7)/8|0},fD=function(t,e,n){return(n==null||n>t.length)&&(n=t.length),new Ma(t.subarray(e,n))},Wo=function(t,e,n){n<<=e&7;var i=e/8|0;t[i]|=n,t[i+1]|=n>>8},ud=function(t,e,n){n<<=e&7;var i=e/8|0;t[i]|=n,t[i+1]|=n>>8,t[i+2]|=n>>16},Rg=function(t,e){for(var n=[],i=0;i<t.length;++i)t[i]&&n.push({s:i,f:t[i]});var r=n.length,s=n.slice();if(!r)return{t:Px,l:0};if(r==1){var a=new Ma(n[0].s+1);return a[n[0].s]=1,{t:a,l:1}}n.sort(function(I,E){return I.f-E.f}),n.push({s:-1,f:25001});var o=n[0],l=n[1],c=0,u=1,f=2;for(n[0]={s:-1,f:o.f+l.f,l:o,r:l};u!=r-1;)o=n[n[c].f<n[f].f?c++:f++],l=n[c!=u&&n[c].f<n[f].f?c++:f++],n[u++]={s:-1,f:o.f+l.f,l:o,r:l};for(var p=s[0].s,i=1;i<r;++i)s[i].s>p&&(p=s[i].s);var d=new Ds(p+1),y=t1(n[u-1],d,0);if(y>e){var i=0,m=0,w=y-e,b=1<<w;for(s.sort(function(E,M){return d[M.s]-d[E.s]||E.f-M.f});i<r;++i){var S=s[i].s;if(d[S]>e)m+=b-(1<<y-d[S]),d[S]=e;else break}for(m>>=w;m>0;){var A=s[i].s;d[A]<e?m-=1<<e-d[A]++-1:++i}for(;i>=0&&m;--i){var _=s[i].s;d[_]==e&&(--d[_],++m)}y=e}return{t:new Ma(d),l:y}},t1=function(t,e,n){return t.s==-1?Math.max(t1(t.l,e,n+1),t1(t.r,e,n+1)):e[t.s]=n},D2=function(t){for(var e=t.length;e&&!t[--e];);for(var n=new Ds(++e),i=0,r=t[0],s=1,a=function(l){n[i++]=l},o=1;o<=e;++o)if(t[o]==r&&o!=e)++s;else{if(!r&&s>2){for(;s>138;s-=138)a(32754);s>2&&(a(s>10?s-11<<5|28690:s-3<<5|12305),s=0)}else if(s>3){for(a(r),--s;s>6;s-=6)a(8304);s>2&&(a(s-3<<5|8208),s=0)}for(;s--;)a(r);s=1,r=t[o]}return{c:n.subarray(0,i),n:e}},dd=function(t,e){for(var n=0,i=0;i<e.length;++i)n+=t[i]*e[i];return n},Cx=function(t,e,n){var i=n.length,r=Nx(e+2);t[r]=i&255,t[r+1]=i>>8,t[r+2]=t[r]^255,t[r+3]=t[r+1]^255;for(var s=0;s<i;++s)t[r+s+4]=n[s];return(r+4+i)*8},O2=function(t,e,n,i,r,s,a,o,l,c,u){Wo(e,u++,n),++r[256];for(var f=Rg(r,15),p=f.t,d=f.l,y=Rg(s,15),m=y.t,w=y.l,b=D2(p),S=b.c,A=b.n,_=D2(m),I=_.c,E=_.n,M=new Ds(19),T=0;T<S.length;++T)++M[S[T]&31];for(var T=0;T<I.length;++T)++M[I[T]&31];for(var D=Rg(M,7),U=D.t,C=D.l,N=19;N>4&&!U[M2[N-1]];--N);var B=c+5<<3,P=dd(r,Mc)+dd(s,Zh)+a,F=dd(r,p)+dd(s,m)+a+14+3*N+dd(M,U)+2*M[16]+3*M[17]+7*M[18];if(l>=0&&B<=P&&B<=F)return Cx(e,u,t.subarray(l,l+c));var q,Z,W,Y;if(Wo(e,u,1+(F<P)),u+=2,F<P){q=Ed(p,d,0),Z=p,W=Ed(m,w,0),Y=m;var ue=Ed(U,C,0);Wo(e,u,A-257),Wo(e,u+5,E-1),Wo(e,u+10,N-4),u+=14;for(var T=0;T<N;++T)Wo(e,u+3*T,U[M2[T]]);u+=3*N;for(var le=[S,I],O=0;O<2;++O)for(var V=le[O],T=0;T<V.length;++T){var G=V[T]&31;Wo(e,u,ue[G]),u+=U[G],G>15&&(Wo(e,u,V[T]>>5&127),u+=V[T]>>12)}}else q=uD,Z=Mc,W=dD,Y=Zh;for(var T=0;T<o;++T){var re=i[T];if(re>255){var G=re>>18&31;ud(e,u,q[G+257]),u+=Z[G+257],G>7&&(Wo(e,u,re>>23&31),u+=S0[G]);var ae=re&31;ud(e,u,W[ae]),u+=Y[ae],ae>3&&(ud(e,u,re>>5&8191),u+=k0[ae])}else ud(e,u,q[re]),u+=Z[re]}return ud(e,u,q[256]),u+Z[256]},hD=new _0([65540,131080,131088,131104,262176,1048704,1048832,2114560,2117632]),Px=new Ma(0),pD=function(t,e,n,i,r,s){var a=s.z||t.length,o=new Ma(i+a+5*(1+Math.ceil(a/7e3))+r),l=o.subarray(i,o.length-r),c=s.l,u=(s.r||0)&7;if(e){u&&(l[0]=s.r>>3);for(var f=hD[e-1],p=f>>13,d=f&8191,y=(1<<n)-1,m=s.p||new Ds(32768),w=s.h||new Ds(y+1),b=Math.ceil(n/3),S=2*b,A=function(Ye){return(t[Ye]^t[Ye+1]<<b^t[Ye+2]<<S)&y},_=new _0(25e3),I=new Ds(288),E=new Ds(32),M=0,T=0,D=s.i||0,U=0,C=s.w||0,N=0;D+2<a;++D){var B=A(D),P=D&32767,F=w[B];if(m[P]=F,w[B]=P,C<=D){var q=a-D;if((M>7e3||U>24576)&&(q>423||!c)){u=O2(t,l,0,_,I,E,T,U,N,D-N,u),U=M=T=0,N=D;for(var Z=0;Z<286;++Z)I[Z]=0;for(var Z=0;Z<30;++Z)E[Z]=0}var W=2,Y=0,ue=d,le=P-F&32767;if(q>2&&B==A(D-le))for(var O=Math.min(p,q)-1,V=Math.min(32767,D),G=Math.min(258,q);le<=V&&--ue&&P!=F;){if(t[D+W]==t[D+W-le]){for(var re=0;re<G&&t[D+re]==t[D+re-le];++re);if(re>W){if(W=re,Y=le,re>O)break;for(var ae=Math.min(le,re-2),ee=0,Z=0;Z<ae;++Z){var de=D-le+Z&32767,he=m[de],pe=de-he&32767;pe>ee&&(ee=pe,F=de)}}}P=F,F=m[P],le+=P-F&32767}if(Y){_[U++]=268435456|$m[W]<<18|T2[Y];var ge=$m[W]&31,Ee=T2[Y]&31;T+=S0[ge]+k0[Ee],++I[257+ge],++E[Ee],C=D+W,++M}else _[U++]=t[D],++I[t[D]]}}for(D=Math.max(D,C);D<a;++D)_[U++]=t[D],++I[t[D]];u=O2(t,l,c,_,I,E,T,U,N,D-N,u),c||(s.r=u&7|l[u/8|0]<<3,u-=7,s.h=w,s.p=m,s.i=D,s.w=C)}else{for(var D=s.w||0;D<a+c;D+=65535){var Ae=D+65535;Ae>=a&&(l[u/8|0]=c,Ae=a),u=Cx(l,u+1,t.subarray(D,Ae))}s.i=a}return fD(o,0,i+Nx(u)+r)},Ex=function(){var t=1,e=0;return{p:function(n){for(var i=t,r=e,s=n.length|0,a=0;a!=s;){for(var o=Math.min(a+2655,s);a<o;++a)r+=i+=n[a];i=(i&65535)+15*(i>>16),r=(r&65535)+15*(r>>16)}t=i,e=r},d:function(){return t%=65521,e%=65521,(t&255)<<24|(t&65280)<<8|(e&255)<<8|e>>8}}},gD=function(t,e,n,i,r){if(!r&&(r={l:1},e.dictionary)){var s=e.dictionary.subarray(-32768),a=new Ma(s.length+t.length);a.set(s),a.set(t,s.length),t=a,r.w=s.length}return pD(t,e.level==null?6:e.level,e.mem==null?r.l?Math.ceil(Math.max(8,Math.min(13,Math.log(t.length)))*1.5):20:12+e.mem,n,i,r)},Ix=function(t,e,n){for(;n;++e)t[e]=n,n>>>=8},mD=function(t,e){var n=e.level,i=n==0?0:n<6?1:n==9?3:2;if(t[0]=120,t[1]=i<<6|(e.dictionary&&32),t[1]|=31-(t[0]<<8|t[1])%31,e.dictionary){var r=Ex();r.p(e.dictionary),Ix(t,2,r.d())}};function n1(t,e){e||(e={});var n=Ex();n.p(t);var i=gD(t,e,e.dictionary?6:2,4);return mD(i,e),Ix(i,i.length-4,n.d()),i}var vD=typeof TextDecoder<"u"&&new TextDecoder,yD=0;try{vD.decode(Px,{stream:!0}),yD=1}catch{}function bD(t){if(Array.isArray(t))return t}function wD(t,e){var n=t==null?null:typeof Symbol<"u"&&t[Symbol.iterator]||t["@@iterator"];if(n!=null){var i,r,s,a,o=[],l=!0,c=!1;try{if(s=(n=n.call(t)).next,e!==0)for(;!(l=(i=s.call(n)).done)&&(o.push(i.value),o.length!==e);l=!0);}catch(u){c=!0,r=u}finally{try{if(!l&&n.return!=null&&(a=n.return(),Object(a)!==a))return}finally{if(c)throw r}}return o}}function F2(t,e){(e==null||e>t.length)&&(e=t.length);for(var n=0,i=Array(e);n<e;n++)i[n]=t[n];return i}function xD(t,e){if(t){if(typeof t=="string")return F2(t,e);var n={}.toString.call(t).slice(8,-1);return n==="Object"&&t.constructor&&(n=t.constructor.name),n==="Map"||n==="Set"?Array.from(t):n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?F2(t,e):void 0}}function _D(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function R2(t,e){return bD(t)||wD(t,e)||xD(t,e)||_D()}function B2(t,e="utf8"){return new TextDecoder(e).decode(t)}const SD=new TextEncoder;function kD(t){return SD.encode(t)}const AD=1024*8,ND=(()=>{const t=new Uint8Array(4),e=new Uint32Array(t.buffer);return!((e[0]=1)&t[0])})(),Bg={int8:globalThis.Int8Array,uint8:globalThis.Uint8Array,int16:globalThis.Int16Array,uint16:globalThis.Uint16Array,int32:globalThis.Int32Array,uint32:globalThis.Uint32Array,uint64:globalThis.BigUint64Array,int64:globalThis.BigInt64Array,float32:globalThis.Float32Array,float64:globalThis.Float64Array};class A0{buffer;byteLength;byteOffset;length;offset;lastWrittenByte;littleEndian;_data;_mark;_marks;constructor(e=AD,n={}){let i=!1;typeof e=="number"?e=new ArrayBuffer(e):(i=!0,this.lastWrittenByte=e.byteLength);const r=n.offset?n.offset>>>0:0,s=e.byteLength-r;let a=r;(ArrayBuffer.isView(e)||e instanceof A0)&&(e.byteLength!==e.buffer.byteLength&&(a=e.byteOffset+r),e=e.buffer),i?this.lastWrittenByte=s:this.lastWrittenByte=0,this.buffer=e,this.length=s,this.byteLength=s,this.byteOffset=a,this.offset=0,this.littleEndian=!0,this._data=new DataView(this.buffer,a,s),this._mark=0,this._marks=[]}available(e=1){return this.offset+e<=this.length}isLittleEndian(){return this.littleEndian}setLittleEndian(){return this.littleEndian=!0,this}isBigEndian(){return!this.littleEndian}setBigEndian(){return this.littleEndian=!1,this}skip(e=1){return this.offset+=e,this}back(e=1){return this.offset-=e,this}seek(e){return this.offset=e,this}mark(){return this._mark=this.offset,this}reset(){return this.offset=this._mark,this}pushMark(){return this._marks.push(this.offset),this}popMark(){const e=this._marks.pop();if(e===void 0)throw new Error("Mark stack empty");return this.seek(e),this}rewind(){return this.offset=0,this}ensureAvailable(e=1){if(!this.available(e)){const i=(this.offset+e)*2,r=new Uint8Array(i);r.set(new Uint8Array(this.buffer)),this.buffer=r.buffer,this.length=i,this.byteLength=i,this._data=new DataView(this.buffer)}return this}readBoolean(){return this.readUint8()!==0}readInt8(){return this._data.getInt8(this.offset++)}readUint8(){return this._data.getUint8(this.offset++)}readByte(){return this.readUint8()}readBytes(e=1){return this.readArray(e,"uint8")}readArray(e,n){const i=Bg[n].BYTES_PER_ELEMENT*e,r=this.byteOffset+this.offset,s=this.buffer.slice(r,r+i);if(this.littleEndian===ND&&n!=="uint8"&&n!=="int8"){const o=new Uint8Array(this.buffer.slice(r,r+i));o.reverse();const l=new Bg[n](o.buffer);return this.offset+=i,l.reverse(),l}const a=new Bg[n](s);return this.offset+=i,a}readInt16(){const e=this._data.getInt16(this.offset,this.littleEndian);return this.offset+=2,e}readUint16(){const e=this._data.getUint16(this.offset,this.littleEndian);return this.offset+=2,e}readInt32(){const e=this._data.getInt32(this.offset,this.littleEndian);return this.offset+=4,e}readUint32(){const e=this._data.getUint32(this.offset,this.littleEndian);return this.offset+=4,e}readFloat32(){const e=this._data.getFloat32(this.offset,this.littleEndian);return this.offset+=4,e}readFloat64(){const e=this._data.getFloat64(this.offset,this.littleEndian);return this.offset+=8,e}readBigInt64(){const e=this._data.getBigInt64(this.offset,this.littleEndian);return this.offset+=8,e}readBigUint64(){const e=this._data.getBigUint64(this.offset,this.littleEndian);return this.offset+=8,e}readChar(){return String.fromCharCode(this.readInt8())}readChars(e=1){let n="";for(let i=0;i<e;i++)n+=this.readChar();return n}readUtf8(e=1){return B2(this.readBytes(e))}decodeText(e=1,n="utf8"){return B2(this.readBytes(e),n)}writeBoolean(e){return this.writeUint8(e?255:0),this}writeInt8(e){return this.ensureAvailable(1),this._data.setInt8(this.offset++,e),this._updateLastWrittenByte(),this}writeUint8(e){return this.ensureAvailable(1),this._data.setUint8(this.offset++,e),this._updateLastWrittenByte(),this}writeByte(e){return this.writeUint8(e)}writeBytes(e){this.ensureAvailable(e.length);for(let n=0;n<e.length;n++)this._data.setUint8(this.offset++,e[n]);return this._updateLastWrittenByte(),this}writeInt16(e){return this.ensureAvailable(2),this._data.setInt16(this.offset,e,this.littleEndian),this.offset+=2,this._updateLastWrittenByte(),this}writeUint16(e){return this.ensureAvailable(2),this._data.setUint16(this.offset,e,this.littleEndian),this.offset+=2,this._updateLastWrittenByte(),this}writeInt32(e){return this.ensureAvailable(4),this._data.setInt32(this.offset,e,this.littleEndian),this.offset+=4,this._updateLastWrittenByte(),this}writeUint32(e){return this.ensureAvailable(4),this._data.setUint32(this.offset,e,this.littleEndian),this.offset+=4,this._updateLastWrittenByte(),this}writeFloat32(e){return this.ensureAvailable(4),this._data.setFloat32(this.offset,e,this.littleEndian),this.offset+=4,this._updateLastWrittenByte(),this}writeFloat64(e){return this.ensureAvailable(8),this._data.setFloat64(this.offset,e,this.littleEndian),this.offset+=8,this._updateLastWrittenByte(),this}writeBigInt64(e){return this.ensureAvailable(8),this._data.setBigInt64(this.offset,e,this.littleEndian),this.offset+=8,this._updateLastWrittenByte(),this}writeBigUint64(e){return this.ensureAvailable(8),this._data.setBigUint64(this.offset,e,this.littleEndian),this.offset+=8,this._updateLastWrittenByte(),this}writeChar(e){return this.writeUint8(e.charCodeAt(0))}writeChars(e){for(let n=0;n<e.length;n++)this.writeUint8(e.charCodeAt(n));return this}writeUtf8(e){return this.writeBytes(kD(e))}toArray(){return new Uint8Array(this.buffer,this.byteOffset,this.lastWrittenByte)}getWrittenByteLength(){return this.lastWrittenByte-this.byteOffset}_updateLastWrittenByte(){this.offset>this.lastWrittenByte&&(this.lastWrittenByte=this.offset)}}function Ku(t){let e=t.length;for(;--e>=0;)t[e]=0}const CD=3,PD=258,Lx=29,ED=256,ID=ED+1+Lx,Mx=30,LD=512,MD=new Array((ID+2)*2);Ku(MD);const TD=new Array(Mx*2);Ku(TD);const DD=new Array(LD);Ku(DD);const OD=new Array(PD-CD+1);Ku(OD);const FD=new Array(Lx);Ku(FD);const RD=new Array(Mx);Ku(RD);const BD=(t,e,n,i)=>{let r=t&65535|0,s=t>>>16&65535|0,a=0;for(;n!==0;){a=n>2e3?2e3:n,n-=a;do r=r+e[i++]|0,s=s+r|0;while(--a);r%=65521,s%=65521}return r|s<<16|0};var i1=BD;const zD=()=>{let t,e=[];for(var n=0;n<256;n++){t=n;for(var i=0;i<8;i++)t=t&1?3988292384^t>>>1:t>>>1;e[n]=t}return e},qD=new Uint32Array(zD()),jD=(t,e,n,i)=>{const r=qD,s=i+n;t^=-1;for(let a=i;a<s;a++)t=t>>>8^r[(t^e[a])&255];return t^-1};var to=jD,r1={2:"need dictionary",1:"stream end",0:"","-1":"file error","-2":"stream error","-3":"data error","-4":"insufficient memory","-5":"buffer error","-6":"incompatible version"},Tx={Z_NO_FLUSH:0,Z_FINISH:4,Z_BLOCK:5,Z_TREES:6,Z_OK:0,Z_STREAM_END:1,Z_NEED_DICT:2,Z_STREAM_ERROR:-2,Z_DATA_ERROR:-3,Z_MEM_ERROR:-4,Z_BUF_ERROR:-5,Z_DEFLATED:8};const HD=(t,e)=>Object.prototype.hasOwnProperty.call(t,e);var UD=function(t){const e=Array.prototype.slice.call(arguments,1);for(;e.length;){const n=e.shift();if(n){if(typeof n!="object")throw new TypeError(n+"must be non-object");for(const i in n)HD(n,i)&&(t[i]=n[i])}}return t},WD=t=>{let e=0;for(let i=0,r=t.length;i<r;i++)e+=t[i].length;const n=new Uint8Array(e);for(let i=0,r=0,s=t.length;i<s;i++){let a=t[i];n.set(a,r),r+=a.length}return n},Dx={assign:UD,flattenChunks:WD};let Ox=!0;try{String.fromCharCode.apply(null,new Uint8Array(1))}catch{Ox=!1}const Ud=new Uint8Array(256);for(let t=0;t<256;t++)Ud[t]=t>=252?6:t>=248?5:t>=240?4:t>=224?3:t>=192?2:1;Ud[254]=Ud[254]=1;var VD=t=>{if(typeof TextEncoder=="function"&&TextEncoder.prototype.encode)return new TextEncoder().encode(t);let e,n,i,r,s,a=t.length,o=0;for(r=0;r<a;r++)n=t.charCodeAt(r),(n&64512)===55296&&r+1<a&&(i=t.charCodeAt(r+1),(i&64512)===56320&&(n=65536+(n-55296<<10)+(i-56320),r++)),o+=n<128?1:n<2048?2:n<65536?3:4;for(e=new Uint8Array(o),s=0,r=0;s<o;r++)n=t.charCodeAt(r),(n&64512)===55296&&r+1<a&&(i=t.charCodeAt(r+1),(i&64512)===56320&&(n=65536+(n-55296<<10)+(i-56320),r++)),n<128?e[s++]=n:n<2048?(e[s++]=192|n>>>6,e[s++]=128|n&63):n<65536?(e[s++]=224|n>>>12,e[s++]=128|n>>>6&63,e[s++]=128|n&63):(e[s++]=240|n>>>18,e[s++]=128|n>>>12&63,e[s++]=128|n>>>6&63,e[s++]=128|n&63);return e};const GD=(t,e)=>{if(e<65534&&t.subarray&&Ox)return String.fromCharCode.apply(null,t.length===e?t:t.subarray(0,e));let n="";for(let i=0;i<e;i++)n+=String.fromCharCode(t[i]);return n};var XD=(t,e)=>{const n=e||t.length;if(typeof TextDecoder=="function"&&TextDecoder.prototype.decode)return new TextDecoder().decode(t.subarray(0,e));let i,r;const s=new Array(n*2);for(r=0,i=0;i<n;){let a=t[i++];if(a<128){s[r++]=a;continue}let o=Ud[a];if(o>4){s[r++]=65533,i+=o-1;continue}for(a&=o===2?31:o===3?15:7;o>1&&i<n;)a=a<<6|t[i++]&63,o--;if(o>1){s[r++]=65533;continue}a<65536?s[r++]=a:(a-=65536,s[r++]=55296|a>>10&1023,s[r++]=56320|a&1023)}return GD(s,r)},YD=(t,e)=>{e=e||t.length,e>t.length&&(e=t.length);let n=e-1;for(;n>=0&&(t[n]&192)===128;)n--;return n<0||n===0?e:n+Ud[t[n]]>e?n:e},s1={string2buf:VD,buf2string:XD,utf8border:YD};function KD(){this.input=null,this.next_in=0,this.avail_in=0,this.total_in=0,this.output=null,this.next_out=0,this.avail_out=0,this.total_out=0,this.msg="",this.state=null,this.data_type=2,this.adler=0}var ZD=KD;const Wf=16209,JD=16191;var QD=function(e,n){let i,r,s,a,o,l,c,u,f,p,d,y,m,w,b,S,A,_,I,E,M,T,D,U;const C=e.state;i=e.next_in,D=e.input,r=i+(e.avail_in-5),s=e.next_out,U=e.output,a=s-(n-e.avail_out),o=s+(e.avail_out-257),l=C.dmax,c=C.wsize,u=C.whave,f=C.wnext,p=C.window,d=C.hold,y=C.bits,m=C.lencode,w=C.distcode,b=(1<<C.lenbits)-1,S=(1<<C.distbits)-1;e:do{y<15&&(d+=D[i++]<<y,y+=8,d+=D[i++]<<y,y+=8),A=m[d&b];t:for(;;){if(_=A>>>24,d>>>=_,y-=_,_=A>>>16&255,_===0)U[s++]=A&65535;else if(_&16){I=A&65535,_&=15,_&&(y<_&&(d+=D[i++]<<y,y+=8),I+=d&(1<<_)-1,d>>>=_,y-=_),y<15&&(d+=D[i++]<<y,y+=8,d+=D[i++]<<y,y+=8),A=w[d&S];n:for(;;){if(_=A>>>24,d>>>=_,y-=_,_=A>>>16&255,_&16){if(E=A&65535,_&=15,y<_&&(d+=D[i++]<<y,y+=8,y<_&&(d+=D[i++]<<y,y+=8)),E+=d&(1<<_)-1,E>l){e.msg="invalid distance too far back",C.mode=Wf;break e}if(d>>>=_,y-=_,_=s-a,E>_){if(_=E-_,_>u&&C.sane){e.msg="invalid distance too far back",C.mode=Wf;break e}if(M=0,T=p,f===0){if(M+=c-_,_<I){I-=_;do U[s++]=p[M++];while(--_);M=s-E,T=U}}else if(f<_){if(M+=c+f-_,_-=f,_<I){I-=_;do U[s++]=p[M++];while(--_);if(M=0,f<I){_=f,I-=_;do U[s++]=p[M++];while(--_);M=s-E,T=U}}}else if(M+=f-_,_<I){I-=_;do U[s++]=p[M++];while(--_);M=s-E,T=U}for(;I>2;)U[s++]=T[M++],U[s++]=T[M++],U[s++]=T[M++],I-=3;I&&(U[s++]=T[M++],I>1&&(U[s++]=T[M++]))}else{M=s-E;do U[s++]=U[M++],U[s++]=U[M++],U[s++]=U[M++],I-=3;while(I>2);I&&(U[s++]=U[M++],I>1&&(U[s++]=U[M++]))}}else if((_&64)===0){A=w[(A&65535)+(d&(1<<_)-1)];continue n}else{e.msg="invalid distance code",C.mode=Wf;break e}break}}else if((_&64)===0){A=m[(A&65535)+(d&(1<<_)-1)];continue t}else if(_&32){C.mode=JD;break e}else{e.msg="invalid literal/length code",C.mode=Wf;break e}break}}while(i<r&&s<o);I=y>>3,i-=I,y-=I<<3,d&=(1<<y)-1,e.next_in=i,e.next_out=s,e.avail_in=i<r?5+(r-i):5-(i-r),e.avail_out=s<o?257+(o-s):257-(s-o),C.hold=d,C.bits=y};const nu=15,z2=852,q2=592,j2=0,zg=1,H2=2,$D=new Uint16Array([3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,0,0]),eO=new Uint8Array([16,16,16,16,16,16,16,16,17,17,17,17,18,18,18,18,19,19,19,19,20,20,20,20,21,21,21,21,16,72,78]),tO=new Uint16Array([1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577,0,0]),nO=new Uint8Array([16,16,16,16,17,17,18,18,19,19,20,20,21,21,22,22,23,23,24,24,25,25,26,26,27,27,28,28,29,29,64,64]),iO=(t,e,n,i,r,s,a,o)=>{const l=o.bits;let c=0,u=0,f=0,p=0,d=0,y=0,m=0,w=0,b=0,S=0,A,_,I,E,M,T=null,D;const U=new Uint16Array(nu+1),C=new Uint16Array(nu+1);let N=null,B,P,F;for(c=0;c<=nu;c++)U[c]=0;for(u=0;u<i;u++)U[e[n+u]]++;for(d=l,p=nu;p>=1&&U[p]===0;p--);if(d>p&&(d=p),p===0)return r[s++]=1<<24|64<<16|0,r[s++]=1<<24|64<<16|0,o.bits=1,0;for(f=1;f<p&&U[f]===0;f++);for(d<f&&(d=f),w=1,c=1;c<=nu;c++)if(w<<=1,w-=U[c],w<0)return-1;if(w>0&&(t===j2||p!==1))return-1;for(C[1]=0,c=1;c<nu;c++)C[c+1]=C[c]+U[c];for(u=0;u<i;u++)e[n+u]!==0&&(a[C[e[n+u]]++]=u);if(t===j2?(T=N=a,D=20):t===zg?(T=$D,N=eO,D=257):(T=tO,N=nO,D=0),S=0,u=0,c=f,M=s,y=d,m=0,I=-1,b=1<<d,E=b-1,t===zg&&b>z2||t===H2&&b>q2)return 1;for(;;){B=c-m,a[u]+1<D?(P=0,F=a[u]):a[u]>=D?(P=N[a[u]-D],F=T[a[u]-D]):(P=96,F=0),A=1<<c-m,_=1<<y,f=_;do _-=A,r[M+(S>>m)+_]=B<<24|P<<16|F|0;while(_!==0);for(A=1<<c-1;S&A;)A>>=1;if(A!==0?(S&=A-1,S+=A):S=0,u++,--U[c]===0){if(c===p)break;c=e[n+a[u]]}if(c>d&&(S&E)!==I){for(m===0&&(m=d),M+=f,y=c-m,w=1<<y;y+m<p&&(w-=U[y+m],!(w<=0));)y++,w<<=1;if(b+=1<<y,t===zg&&b>z2||t===H2&&b>q2)return 1;I=S&E,r[I]=d<<24|y<<16|M-s|0}}return S!==0&&(r[M+S]=c-m<<24|64<<16|0),o.bits=d,0};var Id=iO;const rO=0,Fx=1,Rx=2,{Z_FINISH:U2,Z_BLOCK:sO,Z_TREES:Vf,Z_OK:Tc,Z_STREAM_END:aO,Z_NEED_DICT:oO,Z_STREAM_ERROR:ca,Z_DATA_ERROR:Bx,Z_MEM_ERROR:zx,Z_BUF_ERROR:lO,Z_DEFLATED:W2}=Tx,Ep=16180,V2=16181,G2=16182,X2=16183,Y2=16184,K2=16185,Z2=16186,J2=16187,Q2=16188,$2=16189,Jh=16190,Vo=16191,qg=16192,ey=16193,jg=16194,ty=16195,ny=16196,iy=16197,ry=16198,Gf=16199,Xf=16200,sy=16201,ay=16202,oy=16203,ly=16204,cy=16205,Hg=16206,uy=16207,dy=16208,wi=16209,qx=16210,jx=16211,cO=852,uO=592,dO=15,fO=dO,fy=t=>(t>>>24&255)+(t>>>8&65280)+((t&65280)<<8)+((t&255)<<24);function hO(){this.strm=null,this.mode=0,this.last=!1,this.wrap=0,this.havedict=!1,this.flags=0,this.dmax=0,this.check=0,this.total=0,this.head=null,this.wbits=0,this.wsize=0,this.whave=0,this.wnext=0,this.window=null,this.hold=0,this.bits=0,this.length=0,this.offset=0,this.extra=0,this.lencode=null,this.distcode=null,this.lenbits=0,this.distbits=0,this.ncode=0,this.nlen=0,this.ndist=0,this.have=0,this.next=null,this.lens=new Uint16Array(320),this.work=new Uint16Array(288),this.lendyn=null,this.distdyn=null,this.sane=0,this.back=0,this.was=0}const Hc=t=>{if(!t)return 1;const e=t.state;return!e||e.strm!==t||e.mode<Ep||e.mode>jx?1:0},Hx=t=>{if(Hc(t))return ca;const e=t.state;return t.total_in=t.total_out=e.total=0,t.msg="",e.wrap&&(t.adler=e.wrap&1),e.mode=Ep,e.last=0,e.havedict=0,e.flags=-1,e.dmax=32768,e.head=null,e.hold=0,e.bits=0,e.lencode=e.lendyn=new Int32Array(cO),e.distcode=e.distdyn=new Int32Array(uO),e.sane=1,e.back=-1,Tc},Ux=t=>{if(Hc(t))return ca;const e=t.state;return e.wsize=0,e.whave=0,e.wnext=0,Hx(t)},Wx=(t,e)=>{let n;if(Hc(t))return ca;const i=t.state;return e<0?(n=0,e=-e):(n=(e>>4)+5,e<48&&(e&=15)),e&&(e<8||e>15)?ca:(i.window!==null&&i.wbits!==e&&(i.window=null),i.wrap=n,i.wbits=e,Ux(t))},Vx=(t,e)=>{if(!t)return ca;const n=new hO;t.state=n,n.strm=t,n.window=null,n.mode=Ep;const i=Wx(t,e);return i!==Tc&&(t.state=null),i},pO=t=>Vx(t,fO);let hy=!0,Ug,Wg;const gO=t=>{if(hy){Ug=new Int32Array(512),Wg=new Int32Array(32);let e=0;for(;e<144;)t.lens[e++]=8;for(;e<256;)t.lens[e++]=9;for(;e<280;)t.lens[e++]=7;for(;e<288;)t.lens[e++]=8;for(Id(Fx,t.lens,0,288,Ug,0,t.work,{bits:9}),e=0;e<32;)t.lens[e++]=5;Id(Rx,t.lens,0,32,Wg,0,t.work,{bits:5}),hy=!1}t.lencode=Ug,t.lenbits=9,t.distcode=Wg,t.distbits=5},Gx=(t,e,n,i)=>{let r;const s=t.state;return s.window===null&&(s.wsize=1<<s.wbits,s.wnext=0,s.whave=0,s.window=new Uint8Array(s.wsize)),i>=s.wsize?(s.window.set(e.subarray(n-s.wsize,n),0),s.wnext=0,s.whave=s.wsize):(r=s.wsize-s.wnext,r>i&&(r=i),s.window.set(e.subarray(n-i,n-i+r),s.wnext),i-=r,i?(s.window.set(e.subarray(n-i,n),0),s.wnext=i,s.whave=s.wsize):(s.wnext+=r,s.wnext===s.wsize&&(s.wnext=0),s.whave<s.wsize&&(s.whave+=r))),0},mO=(t,e)=>{let n,i,r,s,a,o,l,c,u,f,p,d,y,m,w=0,b,S,A,_,I,E,M,T;const D=new Uint8Array(4);let U,C;const N=new Uint8Array([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]);if(Hc(t)||!t.output||!t.input&&t.avail_in!==0)return ca;n=t.state,n.mode===Vo&&(n.mode=qg),a=t.next_out,r=t.output,l=t.avail_out,s=t.next_in,i=t.input,o=t.avail_in,c=n.hold,u=n.bits,f=o,p=l,T=Tc;e:for(;;)switch(n.mode){case Ep:if(n.wrap===0){n.mode=qg;break}for(;u<16;){if(o===0)break e;o--,c+=i[s++]<<u,u+=8}if(n.wrap&2&&c===35615){n.wbits===0&&(n.wbits=15),n.check=0,D[0]=c&255,D[1]=c>>>8&255,n.check=to(n.check,D,2,0),c=0,u=0,n.mode=V2;break}if(n.head&&(n.head.done=!1),!(n.wrap&1)||(((c&255)<<8)+(c>>8))%31){t.msg="incorrect header check",n.mode=wi;break}if((c&15)!==W2){t.msg="unknown compression method",n.mode=wi;break}if(c>>>=4,u-=4,M=(c&15)+8,n.wbits===0&&(n.wbits=M),M>15||M>n.wbits){t.msg="invalid window size",n.mode=wi;break}n.dmax=1<<n.wbits,n.flags=0,t.adler=n.check=1,n.mode=c&512?$2:Vo,c=0,u=0;break;case V2:for(;u<16;){if(o===0)break e;o--,c+=i[s++]<<u,u+=8}if(n.flags=c,(n.flags&255)!==W2){t.msg="unknown compression method",n.mode=wi;break}if(n.flags&57344){t.msg="unknown header flags set",n.mode=wi;break}n.head&&(n.head.text=c>>8&1),n.flags&512&&n.wrap&4&&(D[0]=c&255,D[1]=c>>>8&255,n.check=to(n.check,D,2,0)),c=0,u=0,n.mode=G2;case G2:for(;u<32;){if(o===0)break e;o--,c+=i[s++]<<u,u+=8}n.head&&(n.head.time=c),n.flags&512&&n.wrap&4&&(D[0]=c&255,D[1]=c>>>8&255,D[2]=c>>>16&255,D[3]=c>>>24&255,n.check=to(n.check,D,4,0)),c=0,u=0,n.mode=X2;case X2:for(;u<16;){if(o===0)break e;o--,c+=i[s++]<<u,u+=8}n.head&&(n.head.xflags=c&255,n.head.os=c>>8),n.flags&512&&n.wrap&4&&(D[0]=c&255,D[1]=c>>>8&255,n.check=to(n.check,D,2,0)),c=0,u=0,n.mode=Y2;case Y2:if(n.flags&1024){for(;u<16;){if(o===0)break e;o--,c+=i[s++]<<u,u+=8}n.length=c,n.head&&(n.head.extra_len=c),n.flags&512&&n.wrap&4&&(D[0]=c&255,D[1]=c>>>8&255,n.check=to(n.check,D,2,0)),c=0,u=0}else n.head&&(n.head.extra=null);n.mode=K2;case K2:if(n.flags&1024&&(d=n.length,d>o&&(d=o),d&&(n.head&&(M=n.head.extra_len-n.length,n.head.extra||(n.head.extra=new Uint8Array(n.head.extra_len)),n.head.extra.set(i.subarray(s,s+d),M)),n.flags&512&&n.wrap&4&&(n.check=to(n.check,i,d,s)),o-=d,s+=d,n.length-=d),n.length))break e;n.length=0,n.mode=Z2;case Z2:if(n.flags&2048){if(o===0)break e;d=0;do M=i[s+d++],n.head&&M&&n.length<65536&&(n.head.name+=String.fromCharCode(M));while(M&&d<o);if(n.flags&512&&n.wrap&4&&(n.check=to(n.check,i,d,s)),o-=d,s+=d,M)break e}else n.head&&(n.head.name=null);n.length=0,n.mode=J2;case J2:if(n.flags&4096){if(o===0)break e;d=0;do M=i[s+d++],n.head&&M&&n.length<65536&&(n.head.comment+=String.fromCharCode(M));while(M&&d<o);if(n.flags&512&&n.wrap&4&&(n.check=to(n.check,i,d,s)),o-=d,s+=d,M)break e}else n.head&&(n.head.comment=null);n.mode=Q2;case Q2:if(n.flags&512){for(;u<16;){if(o===0)break e;o--,c+=i[s++]<<u,u+=8}if(n.wrap&4&&c!==(n.check&65535)){t.msg="header crc mismatch",n.mode=wi;break}c=0,u=0}n.head&&(n.head.hcrc=n.flags>>9&1,n.head.done=!0),t.adler=n.check=0,n.mode=Vo;break;case $2:for(;u<32;){if(o===0)break e;o--,c+=i[s++]<<u,u+=8}t.adler=n.check=fy(c),c=0,u=0,n.mode=Jh;case Jh:if(n.havedict===0)return t.next_out=a,t.avail_out=l,t.next_in=s,t.avail_in=o,n.hold=c,n.bits=u,oO;t.adler=n.check=1,n.mode=Vo;case Vo:if(e===sO||e===Vf)break e;case qg:if(n.last){c>>>=u&7,u-=u&7,n.mode=Hg;break}for(;u<3;){if(o===0)break e;o--,c+=i[s++]<<u,u+=8}switch(n.last=c&1,c>>>=1,u-=1,c&3){case 0:n.mode=ey;break;case 1:if(gO(n),n.mode=Gf,e===Vf){c>>>=2,u-=2;break e}break;case 2:n.mode=ny;break;case 3:t.msg="invalid block type",n.mode=wi}c>>>=2,u-=2;break;case ey:for(c>>>=u&7,u-=u&7;u<32;){if(o===0)break e;o--,c+=i[s++]<<u,u+=8}if((c&65535)!==(c>>>16^65535)){t.msg="invalid stored block lengths",n.mode=wi;break}if(n.length=c&65535,c=0,u=0,n.mode=jg,e===Vf)break e;case jg:n.mode=ty;case ty:if(d=n.length,d){if(d>o&&(d=o),d>l&&(d=l),d===0)break e;r.set(i.subarray(s,s+d),a),o-=d,s+=d,l-=d,a+=d,n.length-=d;break}n.mode=Vo;break;case ny:for(;u<14;){if(o===0)break e;o--,c+=i[s++]<<u,u+=8}if(n.nlen=(c&31)+257,c>>>=5,u-=5,n.ndist=(c&31)+1,c>>>=5,u-=5,n.ncode=(c&15)+4,c>>>=4,u-=4,n.nlen>286||n.ndist>30){t.msg="too many length or distance symbols",n.mode=wi;break}n.have=0,n.mode=iy;case iy:for(;n.have<n.ncode;){for(;u<3;){if(o===0)break e;o--,c+=i[s++]<<u,u+=8}n.lens[N[n.have++]]=c&7,c>>>=3,u-=3}for(;n.have<19;)n.lens[N[n.have++]]=0;if(n.lencode=n.lendyn,n.lenbits=7,U={bits:n.lenbits},T=Id(rO,n.lens,0,19,n.lencode,0,n.work,U),n.lenbits=U.bits,T){t.msg="invalid code lengths set",n.mode=wi;break}n.have=0,n.mode=ry;case ry:for(;n.have<n.nlen+n.ndist;){for(;w=n.lencode[c&(1<<n.lenbits)-1],b=w>>>24,S=w>>>16&255,A=w&65535,!(b<=u);){if(o===0)break e;o--,c+=i[s++]<<u,u+=8}if(A<16)c>>>=b,u-=b,n.lens[n.have++]=A;else{if(A===16){for(C=b+2;u<C;){if(o===0)break e;o--,c+=i[s++]<<u,u+=8}if(c>>>=b,u-=b,n.have===0){t.msg="invalid bit length repeat",n.mode=wi;break}M=n.lens[n.have-1],d=3+(c&3),c>>>=2,u-=2}else if(A===17){for(C=b+3;u<C;){if(o===0)break e;o--,c+=i[s++]<<u,u+=8}c>>>=b,u-=b,M=0,d=3+(c&7),c>>>=3,u-=3}else{for(C=b+7;u<C;){if(o===0)break e;o--,c+=i[s++]<<u,u+=8}c>>>=b,u-=b,M=0,d=11+(c&127),c>>>=7,u-=7}if(n.have+d>n.nlen+n.ndist){t.msg="invalid bit length repeat",n.mode=wi;break}for(;d--;)n.lens[n.have++]=M}}if(n.mode===wi)break;if(n.lens[256]===0){t.msg="invalid code -- missing end-of-block",n.mode=wi;break}if(n.lenbits=9,U={bits:n.lenbits},T=Id(Fx,n.lens,0,n.nlen,n.lencode,0,n.work,U),n.lenbits=U.bits,T){t.msg="invalid literal/lengths set",n.mode=wi;break}if(n.distbits=6,n.distcode=n.distdyn,U={bits:n.distbits},T=Id(Rx,n.lens,n.nlen,n.ndist,n.distcode,0,n.work,U),n.distbits=U.bits,T){t.msg="invalid distances set",n.mode=wi;break}if(n.mode=Gf,e===Vf)break e;case Gf:n.mode=Xf;case Xf:if(o>=6&&l>=258){t.next_out=a,t.avail_out=l,t.next_in=s,t.avail_in=o,n.hold=c,n.bits=u,QD(t,p),a=t.next_out,r=t.output,l=t.avail_out,s=t.next_in,i=t.input,o=t.avail_in,c=n.hold,u=n.bits,n.mode===Vo&&(n.back=-1);break}for(n.back=0;w=n.lencode[c&(1<<n.lenbits)-1],b=w>>>24,S=w>>>16&255,A=w&65535,!(b<=u);){if(o===0)break e;o--,c+=i[s++]<<u,u+=8}if(S&&(S&240)===0){for(_=b,I=S,E=A;w=n.lencode[E+((c&(1<<_+I)-1)>>_)],b=w>>>24,S=w>>>16&255,A=w&65535,!(_+b<=u);){if(o===0)break e;o--,c+=i[s++]<<u,u+=8}c>>>=_,u-=_,n.back+=_}if(c>>>=b,u-=b,n.back+=b,n.length=A,S===0){n.mode=cy;break}if(S&32){n.back=-1,n.mode=Vo;break}if(S&64){t.msg="invalid literal/length code",n.mode=wi;break}n.extra=S&15,n.mode=sy;case sy:if(n.extra){for(C=n.extra;u<C;){if(o===0)break e;o--,c+=i[s++]<<u,u+=8}n.length+=c&(1<<n.extra)-1,c>>>=n.extra,u-=n.extra,n.back+=n.extra}n.was=n.length,n.mode=ay;case ay:for(;w=n.distcode[c&(1<<n.distbits)-1],b=w>>>24,S=w>>>16&255,A=w&65535,!(b<=u);){if(o===0)break e;o--,c+=i[s++]<<u,u+=8}if((S&240)===0){for(_=b,I=S,E=A;w=n.distcode[E+((c&(1<<_+I)-1)>>_)],b=w>>>24,S=w>>>16&255,A=w&65535,!(_+b<=u);){if(o===0)break e;o--,c+=i[s++]<<u,u+=8}c>>>=_,u-=_,n.back+=_}if(c>>>=b,u-=b,n.back+=b,S&64){t.msg="invalid distance code",n.mode=wi;break}n.offset=A,n.extra=S&15,n.mode=oy;case oy:if(n.extra){for(C=n.extra;u<C;){if(o===0)break e;o--,c+=i[s++]<<u,u+=8}n.offset+=c&(1<<n.extra)-1,c>>>=n.extra,u-=n.extra,n.back+=n.extra}if(n.offset>n.dmax){t.msg="invalid distance too far back",n.mode=wi;break}n.mode=ly;case ly:if(l===0)break e;if(d=p-l,n.offset>d){if(d=n.offset-d,d>n.whave&&n.sane){t.msg="invalid distance too far back",n.mode=wi;break}d>n.wnext?(d-=n.wnext,y=n.wsize-d):y=n.wnext-d,d>n.length&&(d=n.length),m=n.window}else m=r,y=a-n.offset,d=n.length;d>l&&(d=l),l-=d,n.length-=d;do r[a++]=m[y++];while(--d);n.length===0&&(n.mode=Xf);break;case cy:if(l===0)break e;r[a++]=n.length,l--,n.mode=Xf;break;case Hg:if(n.wrap){for(;u<32;){if(o===0)break e;o--,c|=i[s++]<<u,u+=8}if(p-=l,t.total_out+=p,n.total+=p,n.wrap&4&&p&&(t.adler=n.check=n.flags?to(n.check,r,p,a-p):i1(n.check,r,p,a-p)),p=l,n.wrap&4&&(n.flags?c:fy(c))!==n.check){t.msg="incorrect data check",n.mode=wi;break}c=0,u=0}n.mode=uy;case uy:if(n.wrap&&n.flags){for(;u<32;){if(o===0)break e;o--,c+=i[s++]<<u,u+=8}if(n.wrap&4&&c!==(n.total&4294967295)){t.msg="incorrect length check",n.mode=wi;break}c=0,u=0}n.mode=dy;case dy:T=aO;break e;case wi:T=Bx;break e;case qx:return zx;case jx:default:return ca}return t.next_out=a,t.avail_out=l,t.next_in=s,t.avail_in=o,n.hold=c,n.bits=u,(n.wsize||p!==t.avail_out&&n.mode<wi&&(n.mode<Hg||e!==U2))&&Gx(t,t.output,t.next_out,p-t.avail_out),f-=t.avail_in,p-=t.avail_out,t.total_in+=f,t.total_out+=p,n.total+=p,n.wrap&4&&p&&(t.adler=n.check=n.flags?to(n.check,r,p,t.next_out-p):i1(n.check,r,p,t.next_out-p)),t.data_type=n.bits+(n.last?64:0)+(n.mode===Vo?128:0)+(n.mode===Gf||n.mode===jg?256:0),(f===0&&p===0||e===U2)&&T===Tc&&(T=lO),T},vO=t=>{if(Hc(t))return ca;let e=t.state;return e.window&&(e.window=null),t.state=null,Tc},yO=(t,e)=>{if(Hc(t))return ca;const n=t.state;return(n.wrap&2)===0?ca:(n.head=e,e.done=!1,Tc)},bO=(t,e)=>{const n=e.length;let i,r,s;return Hc(t)||(i=t.state,i.wrap!==0&&i.mode!==Jh)?ca:i.mode===Jh&&(r=1,r=i1(r,e,n,0),r!==i.check)?Bx:(s=Gx(t,e,n,n),s?(i.mode=qx,zx):(i.havedict=1,Tc))};var wO=Ux,xO=Wx,_O=Hx,SO=pO,kO=Vx,AO=mO,NO=vO,CO=yO,PO=bO,EO="pako inflate (from Nodeca project)",Yo={inflateReset:wO,inflateReset2:xO,inflateResetKeep:_O,inflateInit:SO,inflateInit2:kO,inflate:AO,inflateEnd:NO,inflateGetHeader:CO,inflateSetDictionary:PO,inflateInfo:EO};function IO(){this.text=0,this.time=0,this.xflags=0,this.os=0,this.extra=null,this.extra_len=0,this.name="",this.comment="",this.hcrc=0,this.done=!1}var LO=IO;const Xx=Object.prototype.toString,{Z_NO_FLUSH:MO,Z_FINISH:TO,Z_OK:Wd,Z_STREAM_END:Vg,Z_NEED_DICT:Gg,Z_STREAM_ERROR:DO,Z_DATA_ERROR:py,Z_MEM_ERROR:OO}=Tx;function ef(t){this.options=Dx.assign({chunkSize:1024*64,windowBits:15,to:""},t||{});const e=this.options;e.raw&&e.windowBits>=0&&e.windowBits<16&&(e.windowBits=-e.windowBits,e.windowBits===0&&(e.windowBits=-15)),e.windowBits>=0&&e.windowBits<16&&!(t&&t.windowBits)&&(e.windowBits+=32),e.windowBits>15&&e.windowBits<48&&(e.windowBits&15)===0&&(e.windowBits|=15),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new ZD,this.strm.avail_out=0;let n=Yo.inflateInit2(this.strm,e.windowBits);if(n!==Wd)throw new Error(r1[n]);if(this.header=new LO,Yo.inflateGetHeader(this.strm,this.header),e.dictionary&&(typeof e.dictionary=="string"?e.dictionary=s1.string2buf(e.dictionary):Xx.call(e.dictionary)==="[object ArrayBuffer]"&&(e.dictionary=new Uint8Array(e.dictionary)),e.raw&&(n=Yo.inflateSetDictionary(this.strm,e.dictionary),n!==Wd)))throw new Error(r1[n])}ef.prototype.push=function(t,e){const n=this.strm,i=this.options.chunkSize,r=this.options.dictionary;let s,a,o;if(this.ended)return!1;for(e===~~e?a=e:a=e===!0?TO:MO,Xx.call(t)==="[object ArrayBuffer]"?n.input=new Uint8Array(t):n.input=t,n.next_in=0,n.avail_in=n.input.length;;){for(n.avail_out===0&&(n.output=new Uint8Array(i),n.next_out=0,n.avail_out=i),s=Yo.inflate(n,a),s===Gg&&r&&(s=Yo.inflateSetDictionary(n,r),s===Wd?s=Yo.inflate(n,a):s===py&&(s=Gg));n.avail_in>0&&s===Vg&&n.state.wrap>0&&t[n.next_in]!==0;)Yo.inflateReset(n),s=Yo.inflate(n,a);switch(s){case DO:case py:case Gg:case OO:return this.onEnd(s),this.ended=!0,!1}if(o=n.avail_out,n.next_out&&(n.avail_out===0||s===Vg))if(this.options.to==="string"){let l=s1.utf8border(n.output,n.next_out),c=n.next_out-l,u=s1.buf2string(n.output,l);n.next_out=c,n.avail_out=i-c,c&&n.output.set(n.output.subarray(l,l+c),0),this.onData(u)}else this.onData(n.output.length===n.next_out?n.output:n.output.subarray(0,n.next_out));if(!(s===Wd&&o===0)){if(s===Vg)return s=Yo.inflateEnd(this.strm),this.onEnd(s),this.ended=!0,!0;if(n.avail_in===0)break}}return!0};ef.prototype.onData=function(t){this.chunks.push(t)};ef.prototype.onEnd=function(t){t===Wd&&(this.options.to==="string"?this.result=this.chunks.join(""):this.result=Dx.flattenChunks(this.chunks)),this.chunks=[],this.err=t,this.msg=this.strm.msg};function FO(t,e){const n=new ef(e);if(n.push(t),n.err)throw n.msg||r1[n.err];return n.result}var RO=ef,BO=FO,zO={Inflate:RO,inflate:BO};const{Inflate:qO,inflate:jO}=zO;var gy=qO,HO=jO;const Yx=[];for(let t=0;t<256;t++){let e=t;for(let n=0;n<8;n++)e&1?e=3988292384^e>>>1:e=e>>>1;Yx[t]=e}const my=4294967295;function UO(t,e,n){let i=t;for(let r=0;r<n;r++)i=Yx[(i^e[r])&255]^i>>>8;return i}function WO(t,e){return(UO(my,t,e)^my)>>>0}function vy(t,e,n){const i=t.readUint32(),r=WO(new Uint8Array(t.buffer,t.byteOffset+t.offset-e-4,e),e);if(r!==i)throw new Error(`CRC mismatch for chunk ${n}. Expected ${i}, found ${r}`)}function Kx(t,e,n){for(let i=0;i<n;i++)e[i]=t[i]}function Zx(t,e,n,i){let r=0;for(;r<i;r++)e[r]=t[r];for(;r<n;r++)e[r]=t[r]+e[r-i]&255}function Jx(t,e,n,i){let r=0;if(n.length===0)for(;r<i;r++)e[r]=t[r];else for(;r<i;r++)e[r]=t[r]+n[r]&255}function Qx(t,e,n,i,r){let s=0;if(n.length===0){for(;s<r;s++)e[s]=t[s];for(;s<i;s++)e[s]=t[s]+(e[s-r]>>1)&255}else{for(;s<r;s++)e[s]=t[s]+(n[s]>>1)&255;for(;s<i;s++)e[s]=t[s]+(e[s-r]+n[s]>>1)&255}}function $x(t,e,n,i,r){let s=0;if(n.length===0){for(;s<r;s++)e[s]=t[s];for(;s<i;s++)e[s]=t[s]+e[s-r]&255}else{for(;s<r;s++)e[s]=t[s]+n[s]&255;for(;s<i;s++)e[s]=t[s]+VO(e[s-r],n[s],n[s-r])&255}}function VO(t,e,n){const i=t+e-n,r=Math.abs(i-t),s=Math.abs(i-e),a=Math.abs(i-n);return r<=s&&r<=a?t:s<=a?e:n}function GO(t,e,n,i,r,s){switch(t){case 0:Kx(e,n,r);break;case 1:Zx(e,n,r,s);break;case 2:Jx(e,n,i,r);break;case 3:Qx(e,n,i,r,s);break;case 4:$x(e,n,i,r,s);break;default:throw new Error(`Unsupported filter: ${t}`)}}const XO=new Uint16Array([255]),YO=new Uint8Array(XO.buffer),KO=YO[0]===255;function ZO(t){const{data:e,width:n,height:i,channels:r,depth:s}=t,a=[{x:0,y:0,xStep:8,yStep:8},{x:4,y:0,xStep:8,yStep:8},{x:0,y:4,xStep:4,yStep:8},{x:2,y:0,xStep:4,yStep:4},{x:0,y:2,xStep:2,yStep:4},{x:1,y:0,xStep:2,yStep:2},{x:0,y:1,xStep:1,yStep:2}],o=Math.ceil(s/8)*r,l=new Uint8Array(i*n*o);let c=0;for(let u=0;u<7;u++){const f=a[u],p=Math.ceil((n-f.x)/f.xStep),d=Math.ceil((i-f.y)/f.yStep);if(p<=0||d<=0)continue;const y=p*o,m=new Uint8Array(y);for(let w=0;w<d;w++){const b=e[c++],S=e.subarray(c,c+y);c+=y;const A=new Uint8Array(y);GO(b,S,A,m,y,o),m.set(A);for(let _=0;_<p;_++){const I=f.x+_*f.xStep,E=f.y+w*f.yStep;if(!(I>=n||E>=i))for(let M=0;M<o;M++)l[(E*n+I)*o+M]=A[_*o+M]}}}if(s===16){const u=new Uint16Array(l.buffer);if(KO)for(let f=0;f<u.length;f++)u[f]=JO(u[f]);return u}else return l}function JO(t){return(t&255)<<8|t>>8&255}const QO=new Uint16Array([255]),$O=new Uint8Array(QO.buffer),eF=$O[0]===255,tF=new Uint8Array(0);function yy(t){const{data:e,width:n,height:i,channels:r,depth:s}=t,a=Math.ceil(s/8)*r,o=Math.ceil(s/8*r*n),l=new Uint8Array(i*o);let c=tF,u=0,f,p;for(let d=0;d<i;d++){switch(f=e.subarray(u+1,u+1+o),p=l.subarray(d*o,(d+1)*o),e[u]){case 0:Kx(f,p,o);break;case 1:Zx(f,p,o,a);break;case 2:Jx(f,p,c,o);break;case 3:Qx(f,p,c,o,a);break;case 4:$x(f,p,c,o,a);break;default:throw new Error(`Unsupported filter: ${e[u]}`)}c=p,u+=o+1}if(s===16){const d=new Uint16Array(l.buffer);if(eF)for(let y=0;y<d.length;y++)d[y]=nF(d[y]);return d}else return l}function nF(t){return(t&255)<<8|t>>8&255}const gh=Uint8Array.of(137,80,78,71,13,10,26,10);function by(t){if(!iF(t.readBytes(gh.length)))throw new Error("wrong PNG signature")}function iF(t){if(t.length<gh.length)return!1;for(let e=0;e<gh.length;e++)if(t[e]!==gh[e])return!1;return!0}const rF="tEXt",sF=0,e_=new TextDecoder("latin1");function aF(t){if(lF(t),t.length===0||t.length>79)throw new Error("keyword length must be between 1 and 79")}const oF=/^[\u0000-\u00FF]*$/;function lF(t){if(!oF.test(t))throw new Error("invalid latin1 text")}function cF(t,e,n){const i=t_(e);t[i]=uF(e,n-i.length-1)}function t_(t){for(t.mark();t.readByte()!==sF;);const e=t.offset;t.reset();const n=e_.decode(t.readBytes(e-t.offset-1));return t.skip(1),aF(n),n}function uF(t,e){return e_.decode(t.readBytes(e))}const Ms={UNKNOWN:-1,GREYSCALE:0,TRUECOLOUR:2,INDEXED_COLOUR:3,GREYSCALE_ALPHA:4,TRUECOLOUR_ALPHA:6},Xg={UNKNOWN:-1,DEFLATE:0},wy={UNKNOWN:-1,ADAPTIVE:0},Yg={UNKNOWN:-1,NO_INTERLACE:0,ADAM7:1},Yf={NONE:0,BACKGROUND:1,PREVIOUS:2},Kg={SOURCE:0,OVER:1};class dF extends A0{_checkCrc;_inflator;_png;_apng;_end;_hasPalette;_palette;_hasTransparency;_transparency;_compressionMethod;_filterMethod;_interlaceMethod;_colorType;_isAnimated;_numberOfFrames;_numberOfPlays;_frames;_writingDataChunks;constructor(e,n={}){super(e);const{checkCrc:i=!1}=n;this._checkCrc=i,this._inflator=new gy,this._png={width:-1,height:-1,channels:-1,data:new Uint8Array(0),depth:1,text:{}},this._apng={width:-1,height:-1,channels:-1,depth:1,numberOfFrames:1,numberOfPlays:0,text:{},frames:[]},this._end=!1,this._hasPalette=!1,this._palette=[],this._hasTransparency=!1,this._transparency=new Uint16Array(0),this._compressionMethod=Xg.UNKNOWN,this._filterMethod=wy.UNKNOWN,this._interlaceMethod=Yg.UNKNOWN,this._colorType=Ms.UNKNOWN,this._isAnimated=!1,this._numberOfFrames=1,this._numberOfPlays=0,this._frames=[],this._writingDataChunks=!1,this.setBigEndian()}decode(){for(by(this);!this._end;){const e=this.readUint32(),n=this.readChars(4);this.decodeChunk(e,n)}return this.decodeImage(),this._png}decodeApng(){for(by(this);!this._end;){const e=this.readUint32(),n=this.readChars(4);this.decodeApngChunk(e,n)}return this.decodeApngImage(),this._apng}decodeChunk(e,n){const i=this.offset;switch(n){case"IHDR":this.decodeIHDR();break;case"PLTE":this.decodePLTE(e);break;case"IDAT":this.decodeIDAT(e);break;case"IEND":this._end=!0;break;case"tRNS":this.decodetRNS(e);break;case"iCCP":this.decodeiCCP(e);break;case rF:cF(this._png.text,this,e);break;case"pHYs":this.decodepHYs();break;default:this.skip(e);break}if(this.offset-i!==e)throw new Error(`Length mismatch while decoding chunk ${n}`);this._checkCrc?vy(this,e+4,n):this.skip(4)}decodeApngChunk(e,n){const i=this.offset;switch(n!=="fdAT"&&n!=="IDAT"&&this._writingDataChunks&&this.pushDataToFrame(),n){case"acTL":this.decodeACTL();break;case"fcTL":this.decodeFCTL();break;case"fdAT":this.decodeFDAT(e);break;default:this.decodeChunk(e,n),this.offset=i+e;break}if(this.offset-i!==e)throw new Error(`Length mismatch while decoding chunk ${n}`);this._checkCrc?vy(this,e+4,n):this.skip(4)}decodeIHDR(){const e=this._png;e.width=this.readUint32(),e.height=this.readUint32(),e.depth=fF(this.readUint8());const n=this.readUint8();this._colorType=n;let i;switch(n){case Ms.GREYSCALE:i=1;break;case Ms.TRUECOLOUR:i=3;break;case Ms.INDEXED_COLOUR:i=1;break;case Ms.GREYSCALE_ALPHA:i=2;break;case Ms.TRUECOLOUR_ALPHA:i=4;break;case Ms.UNKNOWN:default:throw new Error(`Unknown color type: ${n}`)}if(this._png.channels=i,this._compressionMethod=this.readUint8(),this._compressionMethod!==Xg.DEFLATE)throw new Error(`Unsupported compression method: ${this._compressionMethod}`);this._filterMethod=this.readUint8(),this._interlaceMethod=this.readUint8()}decodeACTL(){this._numberOfFrames=this.readUint32(),this._numberOfPlays=this.readUint32(),this._isAnimated=!0}decodeFCTL(){const e={sequenceNumber:this.readUint32(),width:this.readUint32(),height:this.readUint32(),xOffset:this.readUint32(),yOffset:this.readUint32(),delayNumber:this.readUint16(),delayDenominator:this.readUint16(),disposeOp:this.readUint8(),blendOp:this.readUint8(),data:new Uint8Array(0)};this._frames.push(e)}decodePLTE(e){if(e%3!==0)throw new RangeError(`PLTE field length must be a multiple of 3. Got ${e}`);const n=e/3;this._hasPalette=!0;const i=[];this._palette=i;for(let r=0;r<n;r++)i.push([this.readUint8(),this.readUint8(),this.readUint8()])}decodeIDAT(e){this._writingDataChunks=!0;const n=e,i=this.offset+this.byteOffset;if(this._inflator.push(new Uint8Array(this.buffer,i,n)),this._inflator.err)throw new Error(`Error while decompressing the data: ${this._inflator.err}`);this.skip(e)}decodeFDAT(e){this._writingDataChunks=!0;let n=e,i=this.offset+this.byteOffset;if(i+=4,n-=4,this._inflator.push(new Uint8Array(this.buffer,i,n)),this._inflator.err)throw new Error(`Error while decompressing the data: ${this._inflator.err}`);this.skip(e)}decodetRNS(e){switch(this._colorType){case Ms.GREYSCALE:case Ms.TRUECOLOUR:{if(e%2!==0)throw new RangeError(`tRNS chunk length must be a multiple of 2. Got ${e}`);if(e/2>this._png.width*this._png.height)throw new Error(`tRNS chunk contains more alpha values than there are pixels (${e/2} vs ${this._png.width*this._png.height})`);this._hasTransparency=!0,this._transparency=new Uint16Array(e/2);for(let n=0;n<e/2;n++)this._transparency[n]=this.readUint16();break}case Ms.INDEXED_COLOUR:{if(e>this._palette.length)throw new Error(`tRNS chunk contains more alpha values than there are palette colors (${e} vs ${this._palette.length})`);let n=0;for(;n<e;n++){const i=this.readByte();this._palette[n].push(i)}for(;n<this._palette.length;n++)this._palette[n].push(255);break}case Ms.UNKNOWN:case Ms.GREYSCALE_ALPHA:case Ms.TRUECOLOUR_ALPHA:default:throw new Error(`tRNS chunk is not supported for color type ${this._colorType}`)}}decodeiCCP(e){const n=t_(this),i=this.readUint8();if(i!==Xg.DEFLATE)throw new Error(`Unsupported iCCP compression method: ${i}`);const r=this.readBytes(e-n.length-2);this._png.iccEmbeddedProfile={name:n,profile:HO(r)}}decodepHYs(){const e=this.readUint32(),n=this.readUint32(),i=this.readByte();this._png.resolution={x:e,y:n,unit:i}}decodeApngImage(){this._apng.width=this._png.width,this._apng.height=this._png.height,this._apng.channels=this._png.channels,this._apng.depth=this._png.depth,this._apng.numberOfFrames=this._numberOfFrames,this._apng.numberOfPlays=this._numberOfPlays,this._apng.text=this._png.text,this._apng.resolution=this._png.resolution;for(let e=0;e<this._numberOfFrames;e++){const n={sequenceNumber:this._frames[e].sequenceNumber,delayNumber:this._frames[e].delayNumber,delayDenominator:this._frames[e].delayDenominator,data:this._apng.depth===8?new Uint8Array(this._apng.width*this._apng.height*this._apng.channels):new Uint16Array(this._apng.width*this._apng.height*this._apng.channels)},i=this._frames.at(e);if(i){if(i.data=yy({data:i.data,width:i.width,height:i.height,channels:this._apng.channels,depth:this._apng.depth}),this._hasPalette&&(this._apng.palette=this._palette),this._hasTransparency&&(this._apng.transparency=this._transparency),e===0||i.xOffset===0&&i.yOffset===0&&i.width===this._png.width&&i.height===this._png.height)n.data=i.data;else{const r=this._apng.frames.at(e-1);this.disposeFrame(i,r,n),this.addFrameDataToCanvas(n,i)}this._apng.frames.push(n)}}return this._apng}disposeFrame(e,n,i){switch(e.disposeOp){case Yf.NONE:break;case Yf.BACKGROUND:for(let r=0;r<this._png.height;r++)for(let s=0;s<this._png.width;s++){const a=(r*e.width+s)*this._png.channels;for(let o=0;o<this._png.channels;o++)i.data[a+o]=0}break;case Yf.PREVIOUS:i.data.set(n.data);break;default:throw new Error("Unknown disposeOp")}}addFrameDataToCanvas(e,n){const i=1<<this._png.depth,r=(s,a)=>{const o=((s+n.yOffset)*this._png.width+n.xOffset+a)*this._png.channels,l=(s*n.width+a)*this._png.channels;return{index:o,frameIndex:l}};switch(n.blendOp){case Kg.SOURCE:for(let s=0;s<n.height;s++)for(let a=0;a<n.width;a++){const{index:o,frameIndex:l}=r(s,a);for(let c=0;c<this._png.channels;c++)e.data[o+c]=n.data[l+c]}break;case Kg.OVER:for(let s=0;s<n.height;s++)for(let a=0;a<n.width;a++){const{index:o,frameIndex:l}=r(s,a);for(let c=0;c<this._png.channels;c++){const u=n.data[l+this._png.channels-1]/i,f=c%(this._png.channels-1)===0?1:n.data[l+c],p=Math.floor(u*f+(1-u)*e.data[o+c]);e.data[o+c]+=p}}break;default:throw new Error("Unknown blendOp")}}decodeImage(){if(this._inflator.err)throw new Error(`Error while decompressing the data: ${this._inflator.err}`);const e=this._isAnimated?(this._frames?.at(0)).data:this._inflator.result;if(this._filterMethod!==wy.ADAPTIVE)throw new Error(`Filter method ${this._filterMethod} not supported`);if(this._interlaceMethod===Yg.NO_INTERLACE)this._png.data=yy({data:e,width:this._png.width,height:this._png.height,channels:this._png.channels,depth:this._png.depth});else if(this._interlaceMethod===Yg.ADAM7)this._png.data=ZO({data:e,width:this._png.width,height:this._png.height,channels:this._png.channels,depth:this._png.depth});else throw new Error(`Interlace method ${this._interlaceMethod} not supported`);this._hasPalette&&(this._png.palette=this._palette),this._hasTransparency&&(this._png.transparency=this._transparency)}pushDataToFrame(){const e=this._inflator.result,n=this._frames.at(-1);n?n.data=e:this._frames.push({sequenceNumber:0,width:this._png.width,height:this._png.height,xOffset:0,yOffset:0,delayNumber:0,delayDenominator:0,disposeOp:Yf.NONE,blendOp:Kg.SOURCE,data:e}),this._inflator=new gy,this._writingDataChunks=!1}}function fF(t){if(t!==1&&t!==2&&t!==4&&t!==8&&t!==16)throw new Error(`invalid bit depth: ${t}`);return t}var xy;(function(t){t[t.UNKNOWN=0]="UNKNOWN",t[t.METRE=1]="METRE"})(xy||(xy={}));function hF(t,e){return new dF(t,e).decode()}var an=(function(){return typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:this})();function Zg(){an.console&&typeof an.console.log=="function"&&an.console.log.apply(an.console,arguments)}var ni={log:Zg,warn:function(t){an.console&&(typeof an.console.warn=="function"?an.console.warn.apply(an.console,arguments):Zg.call(null,arguments))},error:function(t){an.console&&(typeof an.console.error=="function"?an.console.error.apply(an.console,arguments):Zg(t))}};function Jg(t,e,n){var i=new XMLHttpRequest;i.open("GET",t),i.responseType="blob",i.onload=function(){yc(i.response,e,n)},i.onerror=function(){ni.error("could not download file")},i.send()}function _y(t){var e=new XMLHttpRequest;e.open("HEAD",t,!1);try{e.send()}catch{}return e.status>=200&&e.status<=299}function Kf(t){try{t.dispatchEvent(new MouseEvent("click"))}catch{var e=document.createEvent("MouseEvents");e.initMouseEvent("click",!0,!0,window,0,0,0,80,20,!1,!1,!1,!1,0,null),t.dispatchEvent(e)}}var yc=an.saveAs||((typeof window>"u"?"undefined":Un(window))!=="object"||window!==an?function(){}:typeof HTMLAnchorElement<"u"&&"download"in HTMLAnchorElement.prototype?function(t,e,n){var i=an.URL||an.webkitURL,r=document.createElement("a");e=e||t.name||"download",r.download=e,r.rel="noopener",typeof t=="string"?(r.href=t,r.origin!==location.origin?_y(r.href)?Jg(t,e,n):Kf(r,r.target="_blank"):Kf(r)):(r.href=i.createObjectURL(t),setTimeout(function(){i.revokeObjectURL(r.href)},4e4),setTimeout(function(){Kf(r)},0))}:"msSaveOrOpenBlob"in navigator?function(t,e,n){if(e=e||t.name||"download",typeof t=="string")if(_y(t))Jg(t,e,n);else{var i=document.createElement("a");i.href=t,i.target="_blank",setTimeout(function(){Kf(i)})}else navigator.msSaveOrOpenBlob((function(r,s){return s===void 0?s={autoBom:!1}:Un(s)!=="object"&&(ni.warn("Deprecated: Expected third argument to be a object"),s={autoBom:!s}),s.autoBom&&/^\s*(?:text\/\S*|application\/xml|\S*\/\S*\+xml)\s*;.*charset\s*=\s*utf-8/i.test(r.type)?new Blob(["\uFEFF",r],{type:r.type}):r})(t,n),e)}:function(t,e,n,i){if((i=i||open("","_blank"))&&(i.document.title=i.document.body.innerText="downloading..."),typeof t=="string")return Jg(t,e,n);var r=t.type==="application/octet-stream",s=/constructor/i.test(an.HTMLElement)||an.safari,a=/CriOS\/[\d]+/.test(navigator.userAgent);if((a||r&&s)&&(typeof FileReader>"u"?"undefined":Un(FileReader))==="object"){var o=new FileReader;o.onloadend=function(){var u=o.result;u=a?u:u.replace(/^data:[^;]*;/,"data:attachment/file;"),i?i.location.href=u:location=u,i=null},o.readAsDataURL(t)}else{var l=an.URL||an.webkitURL,c=l.createObjectURL(t);i?i.location=c:location.href=c,i=null,setTimeout(function(){l.revokeObjectURL(c)},4e4)}});function n_(t){var e;t=t||"",this.ok=!1,t.charAt(0)=="#"&&(t=t.substr(1,6)),t={aliceblue:"f0f8ff",antiquewhite:"faebd7",aqua:"00ffff",aquamarine:"7fffd4",azure:"f0ffff",beige:"f5f5dc",bisque:"ffe4c4",black:"000000",blanchedalmond:"ffebcd",blue:"0000ff",blueviolet:"8a2be2",brown:"a52a2a",burlywood:"deb887",cadetblue:"5f9ea0",chartreuse:"7fff00",chocolate:"d2691e",coral:"ff7f50",cornflowerblue:"6495ed",cornsilk:"fff8dc",crimson:"dc143c",cyan:"00ffff",darkblue:"00008b",darkcyan:"008b8b",darkgoldenrod:"b8860b",darkgray:"a9a9a9",darkgreen:"006400",darkkhaki:"bdb76b",darkmagenta:"8b008b",darkolivegreen:"556b2f",darkorange:"ff8c00",darkorchid:"9932cc",darkred:"8b0000",darksalmon:"e9967a",darkseagreen:"8fbc8f",darkslateblue:"483d8b",darkslategray:"2f4f4f",darkturquoise:"00ced1",darkviolet:"9400d3",deeppink:"ff1493",deepskyblue:"00bfff",dimgray:"696969",dodgerblue:"1e90ff",feldspar:"d19275",firebrick:"b22222",floralwhite:"fffaf0",forestgreen:"228b22",fuchsia:"ff00ff",gainsboro:"dcdcdc",ghostwhite:"f8f8ff",gold:"ffd700",goldenrod:"daa520",gray:"808080",green:"008000",greenyellow:"adff2f",honeydew:"f0fff0",hotpink:"ff69b4",indianred:"cd5c5c",indigo:"4b0082",ivory:"fffff0",khaki:"f0e68c",lavender:"e6e6fa",lavenderblush:"fff0f5",lawngreen:"7cfc00",lemonchiffon:"fffacd",lightblue:"add8e6",lightcoral:"f08080",lightcyan:"e0ffff",lightgoldenrodyellow:"fafad2",lightgrey:"d3d3d3",lightgreen:"90ee90",lightpink:"ffb6c1",lightsalmon:"ffa07a",lightseagreen:"20b2aa",lightskyblue:"87cefa",lightslateblue:"8470ff",lightslategray:"778899",lightsteelblue:"b0c4de",lightyellow:"ffffe0",lime:"00ff00",limegreen:"32cd32",linen:"faf0e6",magenta:"ff00ff",maroon:"800000",mediumaquamarine:"66cdaa",mediumblue:"0000cd",mediumorchid:"ba55d3",mediumpurple:"9370d8",mediumseagreen:"3cb371",mediumslateblue:"7b68ee",mediumspringgreen:"00fa9a",mediumturquoise:"48d1cc",mediumvioletred:"c71585",midnightblue:"191970",mintcream:"f5fffa",mistyrose:"ffe4e1",moccasin:"ffe4b5",navajowhite:"ffdead",navy:"000080",oldlace:"fdf5e6",olive:"808000",olivedrab:"6b8e23",orange:"ffa500",orangered:"ff4500",orchid:"da70d6",palegoldenrod:"eee8aa",palegreen:"98fb98",paleturquoise:"afeeee",palevioletred:"d87093",papayawhip:"ffefd5",peachpuff:"ffdab9",peru:"cd853f",pink:"ffc0cb",plum:"dda0dd",powderblue:"b0e0e6",purple:"800080",red:"ff0000",rosybrown:"bc8f8f",royalblue:"4169e1",saddlebrown:"8b4513",salmon:"fa8072",sandybrown:"f4a460",seagreen:"2e8b57",seashell:"fff5ee",sienna:"a0522d",silver:"c0c0c0",skyblue:"87ceeb",slateblue:"6a5acd",slategray:"708090",snow:"fffafa",springgreen:"00ff7f",steelblue:"4682b4",tan:"d2b48c",teal:"008080",thistle:"d8bfd8",tomato:"ff6347",turquoise:"40e0d0",violet:"ee82ee",violetred:"d02090",wheat:"f5deb3",white:"ffffff",whitesmoke:"f5f5f5",yellow:"ffff00",yellowgreen:"9acd32"}[t=(t=t.replace(/ /g,"")).toLowerCase()]||t;for(var n=[{re:/^rgb\((\d{1,3}),\s*(\d{1,3}),\s*(\d{1,3})\)$/,example:["rgb(123, 234, 45)","rgb(255,234,245)"],process:function(o){return[parseInt(o[1]),parseInt(o[2]),parseInt(o[3])]}},{re:/^(\w{2})(\w{2})(\w{2})$/,example:["#00ff00","336699"],process:function(o){return[parseInt(o[1],16),parseInt(o[2],16),parseInt(o[3],16)]}},{re:/^(\w{1})(\w{1})(\w{1})$/,example:["#fb0","f0f"],process:function(o){return[parseInt(o[1]+o[1],16),parseInt(o[2]+o[2],16),parseInt(o[3]+o[3],16)]}}],i=0;i<n.length;i++){var r=n[i].re,s=n[i].process,a=r.exec(t);a&&(e=s(a),this.r=e[0],this.g=e[1],this.b=e[2],this.ok=!0)}this.r=this.r<0||isNaN(this.r)?0:this.r>255?255:this.r,this.g=this.g<0||isNaN(this.g)?0:this.g>255?255:this.g,this.b=this.b<0||isNaN(this.b)?0:this.b>255?255:this.b,this.toRGB=function(){return"rgb("+this.r+", "+this.g+", "+this.b+")"},this.toHex=function(){var o=this.r.toString(16),l=this.g.toString(16),c=this.b.toString(16);return o.length==1&&(o="0"+o),l.length==1&&(l="0"+l),c.length==1&&(c="0"+c),"#"+o+l+c}}var mh=an.atob.bind(an),Sy=an.btoa.bind(an);function Qg(t,e){var n=t[0],i=t[1],r=t[2],s=t[3];n=Tr(n,i,r,s,e[0],7,-680876936),s=Tr(s,n,i,r,e[1],12,-389564586),r=Tr(r,s,n,i,e[2],17,606105819),i=Tr(i,r,s,n,e[3],22,-1044525330),n=Tr(n,i,r,s,e[4],7,-176418897),s=Tr(s,n,i,r,e[5],12,1200080426),r=Tr(r,s,n,i,e[6],17,-1473231341),i=Tr(i,r,s,n,e[7],22,-45705983),n=Tr(n,i,r,s,e[8],7,1770035416),s=Tr(s,n,i,r,e[9],12,-1958414417),r=Tr(r,s,n,i,e[10],17,-42063),i=Tr(i,r,s,n,e[11],22,-1990404162),n=Tr(n,i,r,s,e[12],7,1804603682),s=Tr(s,n,i,r,e[13],12,-40341101),r=Tr(r,s,n,i,e[14],17,-1502002290),n=Dr(n,i=Tr(i,r,s,n,e[15],22,1236535329),r,s,e[1],5,-165796510),s=Dr(s,n,i,r,e[6],9,-1069501632),r=Dr(r,s,n,i,e[11],14,643717713),i=Dr(i,r,s,n,e[0],20,-373897302),n=Dr(n,i,r,s,e[5],5,-701558691),s=Dr(s,n,i,r,e[10],9,38016083),r=Dr(r,s,n,i,e[15],14,-660478335),i=Dr(i,r,s,n,e[4],20,-405537848),n=Dr(n,i,r,s,e[9],5,568446438),s=Dr(s,n,i,r,e[14],9,-1019803690),r=Dr(r,s,n,i,e[3],14,-187363961),i=Dr(i,r,s,n,e[8],20,1163531501),n=Dr(n,i,r,s,e[13],5,-1444681467),s=Dr(s,n,i,r,e[2],9,-51403784),r=Dr(r,s,n,i,e[7],14,1735328473),n=Or(n,i=Dr(i,r,s,n,e[12],20,-1926607734),r,s,e[5],4,-378558),s=Or(s,n,i,r,e[8],11,-2022574463),r=Or(r,s,n,i,e[11],16,1839030562),i=Or(i,r,s,n,e[14],23,-35309556),n=Or(n,i,r,s,e[1],4,-1530992060),s=Or(s,n,i,r,e[4],11,1272893353),r=Or(r,s,n,i,e[7],16,-155497632),i=Or(i,r,s,n,e[10],23,-1094730640),n=Or(n,i,r,s,e[13],4,681279174),s=Or(s,n,i,r,e[0],11,-358537222),r=Or(r,s,n,i,e[3],16,-722521979),i=Or(i,r,s,n,e[6],23,76029189),n=Or(n,i,r,s,e[9],4,-640364487),s=Or(s,n,i,r,e[12],11,-421815835),r=Or(r,s,n,i,e[15],16,530742520),n=Fr(n,i=Or(i,r,s,n,e[2],23,-995338651),r,s,e[0],6,-198630844),s=Fr(s,n,i,r,e[7],10,1126891415),r=Fr(r,s,n,i,e[14],15,-1416354905),i=Fr(i,r,s,n,e[5],21,-57434055),n=Fr(n,i,r,s,e[12],6,1700485571),s=Fr(s,n,i,r,e[3],10,-1894986606),r=Fr(r,s,n,i,e[10],15,-1051523),i=Fr(i,r,s,n,e[1],21,-2054922799),n=Fr(n,i,r,s,e[8],6,1873313359),s=Fr(s,n,i,r,e[15],10,-30611744),r=Fr(r,s,n,i,e[6],15,-1560198380),i=Fr(i,r,s,n,e[13],21,1309151649),n=Fr(n,i,r,s,e[4],6,-145523070),s=Fr(s,n,i,r,e[11],10,-1120210379),r=Fr(r,s,n,i,e[2],15,718787259),i=Fr(i,r,s,n,e[9],21,-343485551),t[0]=Vl(n,t[0]),t[1]=Vl(i,t[1]),t[2]=Vl(r,t[2]),t[3]=Vl(s,t[3])}function Ip(t,e,n,i,r,s){return e=Vl(Vl(e,t),Vl(i,s)),Vl(e<<r|e>>>32-r,n)}function Tr(t,e,n,i,r,s,a){return Ip(e&n|~e&i,t,e,r,s,a)}function Dr(t,e,n,i,r,s,a){return Ip(e&i|n&~i,t,e,r,s,a)}function Or(t,e,n,i,r,s,a){return Ip(e^n^i,t,e,r,s,a)}function Fr(t,e,n,i,r,s,a){return Ip(n^(e|~i),t,e,r,s,a)}function i_(t){var e,n=t.length,i=[1732584193,-271733879,-1732584194,271733878];for(e=64;e<=t.length;e+=64)Qg(i,pF(t.substring(e-64,e)));t=t.substring(e-64);var r=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0];for(e=0;e<t.length;e++)r[e>>2]|=t.charCodeAt(e)<<(e%4<<3);if(r[e>>2]|=128<<(e%4<<3),e>55)for(Qg(i,r),e=0;e<16;e++)r[e]=0;return r[14]=8*n,Qg(i,r),i}function pF(t){var e,n=[];for(e=0;e<64;e+=4)n[e>>2]=t.charCodeAt(e)+(t.charCodeAt(e+1)<<8)+(t.charCodeAt(e+2)<<16)+(t.charCodeAt(e+3)<<24);return n}var ky="0123456789abcdef".split("");function gF(t){for(var e="",n=0;n<4;n++)e+=ky[t>>8*n+4&15]+ky[t>>8*n&15];return e}function mF(t){return String.fromCharCode(255&t,(65280&t)>>8,(16711680&t)>>16,(4278190080&t)>>24)}function a1(t){return i_(t).map(mF).join("")}var vF=(function(t){for(var e=0;e<t.length;e++)t[e]=gF(t[e]);return t.join("")})(i_("hello"))!="5d41402abc4b2a76b9719d911017c592";function Vl(t,e){if(vF){var n=(65535&t)+(65535&e);return(t>>16)+(e>>16)+(n>>16)<<16|65535&n}return t+e&4294967295}function o1(t,e){var n,i,r,s;if(t!==n){for(var a=(r=t,s=1+(256/t.length|0),new Array(s+1).join(r)),o=[],l=0;l<256;l++)o[l]=l;var c=0;for(l=0;l<256;l++){var u=o[l];c=(c+u+a.charCodeAt(l))%256,o[l]=o[c],o[c]=u}n=t,i=o}else o=i;var f=e.length,p=0,d=0,y="";for(l=0;l<f;l++)d=(d+(u=o[p=(p+1)%256]))%256,o[p]=o[d],o[d]=u,a=o[(o[p]+o[d])%256],y+=String.fromCharCode(e.charCodeAt(l)^a);return y}var Ay={print:4,modify:8,copy:16,"annot-forms":32};function uu(t,e,n,i){this.v=1,this.r=2;var r=192;t.forEach(function(o){if(Ay.perm!==void 0)throw new Error("Invalid permission: "+o);r+=Ay[o]}),this.padding="(Â¿N^NuÂAd\0NVÃ¿Ãº\b..\0Â¶Ãh>Â/\fÂ©Ã¾dSiz";var s=(e+this.padding).substr(0,32),a=(n+this.padding).substr(0,32);this.O=this.processOwnerPassword(s,a),this.P=-(1+(255^r)),this.encryptionKey=a1(s+this.O+this.lsbFirstWord(this.P)+this.hexToBytes(i)).substr(0,5),this.U=o1(this.encryptionKey,this.padding)}function du(t){if(/[^\u0000-\u00ff]/.test(t))throw new Error("Invalid PDF Name Object: "+t+", Only accept ASCII characters.");for(var e="",n=t.length,i=0;i<n;i++){var r=t.charCodeAt(i);e+=r<33||r===35||r===37||r===40||r===41||r===47||r===60||r===62||r===91||r===93||r===123||r===125||r>126?"#"+("0"+r.toString(16)).slice(-2):t[i]}return e}function Ny(t){if(Un(t)!=="object")throw new Error("Invalid Context passed to initialize PubSub (jsPDF-module)");var e={};this.subscribe=function(n,i,r){if(r=r||!1,typeof n!="string"||typeof i!="function"||typeof r!="boolean")throw new Error("Invalid arguments passed to PubSub.subscribe (jsPDF-module)");e.hasOwnProperty(n)||(e[n]={});var s=Math.random().toString(35);return e[n][s]=[i,!!r],s},this.unsubscribe=function(n){for(var i in e)if(e[i][n])return delete e[i][n],Object.keys(e[i]).length===0&&delete e[i],!0;return!1},this.publish=function(n){if(e.hasOwnProperty(n)){var i=Array.prototype.slice.call(arguments,1),r=[];for(var s in e[n]){var a=e[n][s];try{a[0].apply(t,i)}catch(o){an.console&&ni.error("jsPDF PubSub Error",o.message,o)}a[1]&&r.push(s)}r.length&&r.forEach(this.unsubscribe)}},this.getTopics=function(){return e}}function Dc(t){if(!(this instanceof Dc))return new Dc(t);var e="opacity,stroke-opacity".split(",");for(var n in t)t.hasOwnProperty(n)&&e.indexOf(n)>=0&&(this[n]=t[n]);this.id="",this.objectNumber=-1}function r_(t,e){this.gState=t,this.matrix=e,this.id="",this.objectNumber=-1}function Hl(t,e,n,i,r){if(!(this instanceof Hl))return new Hl(t,e,n,i,r);this.type=t==="axial"?2:3,this.coords=e,this.colors=n,r_.call(this,i,r)}function _c(t,e,n,i,r){if(!(this instanceof _c))return new _c(t,e,n,i,r);this.boundingBox=t,this.xStep=e,this.yStep=n,this.stream="",this.cloneIndex=0,r_.call(this,i,r)}function Ut(t){var e,n=typeof arguments[0]=="string"?arguments[0]:"p",i=arguments[1],r=arguments[2],s=arguments[3],a=[],o=1,l=16,c="S",u=null;Un(t=t||{})==="object"&&(n=t.orientation,i=t.unit||i,r=t.format||r,s=t.compress||t.compressPdf||s,(u=t.encryption||null)!==null&&(u.userPassword=u.userPassword||"",u.ownerPassword=u.ownerPassword||"",u.userPermissions=u.userPermissions||[]),o=typeof t.userUnit=="number"?Math.abs(t.userUnit):1,t.precision!==void 0&&(e=t.precision),t.floatPrecision!==void 0&&(l=t.floatPrecision),c=t.defaultPathOperation||"S"),a=t.filters||(s===!0?["FlateEncode"]:a),i=i||"mm",n=(""+(n||"P")).toLowerCase();var f=t.putOnlyUsedFonts||!1,p={},d={internal:{},__private__:{}};d.__private__.PubSub=Ny;var y="1.3",m=d.__private__.getPdfVersion=function(){return y};d.__private__.setPdfVersion=function(x){y=x};var w={a0:[2383.94,3370.39],a1:[1683.78,2383.94],a2:[1190.55,1683.78],a3:[841.89,1190.55],a4:[595.28,841.89],a5:[419.53,595.28],a6:[297.64,419.53],a7:[209.76,297.64],a8:[147.4,209.76],a9:[104.88,147.4],a10:[73.7,104.88],b0:[2834.65,4008.19],b1:[2004.09,2834.65],b2:[1417.32,2004.09],b3:[1000.63,1417.32],b4:[708.66,1000.63],b5:[498.9,708.66],b6:[354.33,498.9],b7:[249.45,354.33],b8:[175.75,249.45],b9:[124.72,175.75],b10:[87.87,124.72],c0:[2599.37,3676.54],c1:[1836.85,2599.37],c2:[1298.27,1836.85],c3:[918.43,1298.27],c4:[649.13,918.43],c5:[459.21,649.13],c6:[323.15,459.21],c7:[229.61,323.15],c8:[161.57,229.61],c9:[113.39,161.57],c10:[79.37,113.39],dl:[311.81,623.62],letter:[612,792],"government-letter":[576,756],legal:[612,1008],"junior-legal":[576,360],ledger:[1224,792],tabloid:[792,1224],"credit-card":[153,243]};d.__private__.getPageFormats=function(){return w};var b=d.__private__.getPageFormat=function(x){return w[x]};r=r||"a4";var S="compat",A="advanced",_=S;function I(){this.saveGraphicsState(),K(new Bt(it,0,0,-it,0,Ve()*it).toString()+" cm"),this.setFontSize(this.getFontSize()/it),c="n",_=A}function E(){this.restoreGraphicsState(),c="S",_=S}var M=d.__private__.combineFontStyleAndFontWeight=function(x,R){if(x=="bold"&&R=="normal"||x=="bold"&&R==400||x=="normal"&&R=="italic"||x=="bold"&&R=="italic")throw new Error("Invalid Combination of fontweight and fontstyle");return R&&(x=R==400||R==="normal"?x==="italic"?"italic":"normal":R!=700&&R!=="bold"||x!=="normal"?(R==700?"bold":R)+""+x:"bold"),x};d.advancedAPI=function(x){var R=_===S;return R&&I.call(this),typeof x!="function"||(x(this),R&&E.call(this)),this},d.compatAPI=function(x){var R=_===A;return R&&E.call(this),typeof x!="function"||(x(this),R&&I.call(this)),this},d.isAdvancedAPI=function(){return _===A};var T,D=function(x){if(_!==A)throw new Error(x+" is only available in 'advanced' API mode. You need to call advancedAPI() first.")},U=d.roundToPrecision=d.__private__.roundToPrecision=function(x,R){var te=e||R;if(isNaN(x)||isNaN(te))throw new Error("Invalid argument passed to jsPDF.roundToPrecision");return x.toFixed(te).replace(/0+$/,"")};T=d.hpf=d.__private__.hpf=typeof l=="number"?function(x){if(isNaN(x))throw new Error("Invalid argument passed to jsPDF.hpf");return U(x,l)}:l==="smart"?function(x){if(isNaN(x))throw new Error("Invalid argument passed to jsPDF.hpf");return U(x,x>-1&&x<1?16:5)}:function(x){if(isNaN(x))throw new Error("Invalid argument passed to jsPDF.hpf");return U(x,16)};var C=d.f2=d.__private__.f2=function(x){if(isNaN(x))throw new Error("Invalid argument passed to jsPDF.f2");return U(x,2)},N=d.__private__.f3=function(x){if(isNaN(x))throw new Error("Invalid argument passed to jsPDF.f3");return U(x,3)},B=d.scale=d.__private__.scale=function(x){if(isNaN(x))throw new Error("Invalid argument passed to jsPDF.scale");return _===S?x*it:_===A?x:void 0},P=function(x){return B((function(R){return _===S?Ve()-R:_===A?R:void 0})(x))};d.__private__.setPrecision=d.setPrecision=function(x){typeof parseInt(x,10)=="number"&&(e=parseInt(x,10))};var F,q="00000000000000000000000000000000",Z=d.__private__.getFileId=function(){return q},W=d.__private__.setFileId=function(x){return q=x!==void 0&&/^[a-fA-F0-9]{32}$/.test(x)?x.toUpperCase():q.split("").map(function(){return"ABCDEF0123456789".charAt(Math.floor(16*Math.random()))}).join(""),u!==null&&(hi=new uu(u.userPermissions,u.userPassword,u.ownerPassword,q)),q};d.setFileId=function(x){return W(x),this},d.getFileId=function(){return Z()};var Y=d.__private__.convertDateToPDFDate=function(x){var R=x.getTimezoneOffset(),te=R<0?"+":"-",me=Math.floor(Math.abs(R/60)),Ne=Math.abs(R%60),ze=[te,G(me),"'",G(Ne),"'"].join("");return["D:",x.getFullYear(),G(x.getMonth()+1),G(x.getDate()),G(x.getHours()),G(x.getMinutes()),G(x.getSeconds()),ze].join("")},ue=d.__private__.convertPDFDateToDate=function(x){var R=parseInt(x.substr(2,4),10),te=parseInt(x.substr(6,2),10)-1,me=parseInt(x.substr(8,2),10),Ne=parseInt(x.substr(10,2),10),ze=parseInt(x.substr(12,2),10),Ge=parseInt(x.substr(14,2),10);return new Date(R,te,me,Ne,ze,Ge,0)},le=d.__private__.setCreationDate=function(x){var R;if(x===void 0&&(x=new Date),x instanceof Date)R=Y(x);else{if(!/^D:(20[0-2][0-9]|203[0-7]|19[7-9][0-9])(0[0-9]|1[0-2])([0-2][0-9]|3[0-1])(0[0-9]|1[0-9]|2[0-3])(0[0-9]|[1-5][0-9])(0[0-9]|[1-5][0-9])(\+0[0-9]|\+1[0-4]|-0[0-9]|-1[0-1])'(0[0-9]|[1-5][0-9])'?$/.test(x))throw new Error("Invalid argument passed to jsPDF.setCreationDate");R=x}return F=R},O=d.__private__.getCreationDate=function(x){var R=F;return x==="jsDate"&&(R=ue(F)),R};d.setCreationDate=function(x){return le(x),this},d.getCreationDate=function(x){return O(x)};var V,G=d.__private__.padd2=function(x){return("0"+parseInt(x)).slice(-2)},re=d.__private__.padd2Hex=function(x){return("00"+(x=x.toString())).substr(x.length)},ae=0,ee=[],de=[],he=0,pe=[],ge=[],Ee=!1,Ae=de;d.__private__.setCustomOutputDestination=function(x){Ee=!0,Ae=x};var Ye=function(x){Ee||(Ae=x)};d.__private__.resetCustomOutputDestination=function(){Ee=!1,Ae=de};var K=d.__private__.out=function(x){return x=x.toString(),he+=x.length+1,Ae.push(x),Ae},Re=d.__private__.write=function(x){return K(arguments.length===1?x.toString():Array.prototype.join.call(arguments," "))},Qe=d.__private__.getArrayBuffer=function(x){for(var R=x.length,te=new ArrayBuffer(R),me=new Uint8Array(te);R--;)me[R]=x.charCodeAt(R);return te},Be=[["Helvetica","helvetica","normal","WinAnsiEncoding"],["Helvetica-Bold","helvetica","bold","WinAnsiEncoding"],["Helvetica-Oblique","helvetica","italic","WinAnsiEncoding"],["Helvetica-BoldOblique","helvetica","bolditalic","WinAnsiEncoding"],["Courier","courier","normal","WinAnsiEncoding"],["Courier-Bold","courier","bold","WinAnsiEncoding"],["Courier-Oblique","courier","italic","WinAnsiEncoding"],["Courier-BoldOblique","courier","bolditalic","WinAnsiEncoding"],["Times-Roman","times","normal","WinAnsiEncoding"],["Times-Bold","times","bold","WinAnsiEncoding"],["Times-Italic","times","italic","WinAnsiEncoding"],["Times-BoldItalic","times","bolditalic","WinAnsiEncoding"],["ZapfDingbats","zapfdingbats","normal",null],["Symbol","symbol","normal",null]];d.__private__.getStandardFonts=function(){return Be};var Ie=t.fontSize||16;d.__private__.setFontSize=d.setFontSize=function(x){return Ie=_===A?x/it:x,this};var lt,We=d.__private__.getFontSize=d.getFontSize=function(){return _===S?Ie:Ie*it},Ke=t.R2L||!1;d.__private__.setR2L=d.setR2L=function(x){return Ke=x,this},d.__private__.getR2L=d.getR2L=function(){return Ke};var ht,Rt=d.__private__.setZoomMode=function(x){if(/^(?:\d+\.\d*|\d*\.\d+|\d+)%$/.test(x))lt=x;else if(isNaN(x)){if([void 0,null,"fullwidth","fullheight","fullpage","original"].indexOf(x)===-1)throw new Error('zoom must be Integer (e.g. 2), a percentage Value (e.g. 300%) or fullwidth, fullheight, fullpage, original. "'+x+'" is not recognized.');lt=x}else lt=parseInt(x,10)};d.__private__.getZoomMode=function(){return lt};var ye,qe=d.__private__.setPageMode=function(x){if([void 0,null,"UseNone","UseOutlines","UseThumbs","FullScreen"].indexOf(x)==-1)throw new Error('Page mode must be one of UseNone, UseOutlines, UseThumbs, or FullScreen. "'+x+'" is not recognized.');ht=x};d.__private__.getPageMode=function(){return ht};var ve=d.__private__.setLayoutMode=function(x){if([void 0,null,"continuous","single","twoleft","tworight","two"].indexOf(x)==-1)throw new Error('Layout mode must be one of continuous, single, twoleft, tworight. "'+x+'" is not recognized.');ye=x};d.__private__.getLayoutMode=function(){return ye},d.__private__.setDisplayMode=d.setDisplayMode=function(x,R,te){return Rt(x),ve(R),qe(te),this};var Pe={title:"",subject:"",author:"",keywords:"",creator:""};d.__private__.getDocumentProperty=function(x){if(Object.keys(Pe).indexOf(x)===-1)throw new Error("Invalid argument passed to jsPDF.getDocumentProperty");return Pe[x]},d.__private__.getDocumentProperties=function(){return Pe},d.__private__.setDocumentProperties=d.setProperties=d.setDocumentProperties=function(x){for(var R in Pe)Pe.hasOwnProperty(R)&&x[R]&&(Pe[R]=x[R]);return this},d.__private__.setDocumentProperty=function(x,R){if(Object.keys(Pe).indexOf(x)===-1)throw new Error("Invalid arguments passed to jsPDF.setDocumentProperty");return Pe[x]=R};var Le,it,nt,_t,At,St={},st={},Ot=[],dt={},bt={},ot={},vt={},jt=null,kt=0,gt=[],Gt=new Ny(d),oi=t.hotfixes||[],bn={},Cn={},li=[],Bt=function x(R,te,me,Ne,ze,Ge){if(!(this instanceof x))return new x(R,te,me,Ne,ze,Ge);isNaN(R)&&(R=1),isNaN(te)&&(te=0),isNaN(me)&&(me=0),isNaN(Ne)&&(Ne=1),isNaN(ze)&&(ze=0),isNaN(Ge)&&(Ge=0),this._matrix=[R,te,me,Ne,ze,Ge]};Object.defineProperty(Bt.prototype,"sx",{get:function(){return this._matrix[0]},set:function(x){this._matrix[0]=x}}),Object.defineProperty(Bt.prototype,"shy",{get:function(){return this._matrix[1]},set:function(x){this._matrix[1]=x}}),Object.defineProperty(Bt.prototype,"shx",{get:function(){return this._matrix[2]},set:function(x){this._matrix[2]=x}}),Object.defineProperty(Bt.prototype,"sy",{get:function(){return this._matrix[3]},set:function(x){this._matrix[3]=x}}),Object.defineProperty(Bt.prototype,"tx",{get:function(){return this._matrix[4]},set:function(x){this._matrix[4]=x}}),Object.defineProperty(Bt.prototype,"ty",{get:function(){return this._matrix[5]},set:function(x){this._matrix[5]=x}}),Object.defineProperty(Bt.prototype,"a",{get:function(){return this._matrix[0]},set:function(x){this._matrix[0]=x}}),Object.defineProperty(Bt.prototype,"b",{get:function(){return this._matrix[1]},set:function(x){this._matrix[1]=x}}),Object.defineProperty(Bt.prototype,"c",{get:function(){return this._matrix[2]},set:function(x){this._matrix[2]=x}}),Object.defineProperty(Bt.prototype,"d",{get:function(){return this._matrix[3]},set:function(x){this._matrix[3]=x}}),Object.defineProperty(Bt.prototype,"e",{get:function(){return this._matrix[4]},set:function(x){this._matrix[4]=x}}),Object.defineProperty(Bt.prototype,"f",{get:function(){return this._matrix[5]},set:function(x){this._matrix[5]=x}}),Object.defineProperty(Bt.prototype,"rotation",{get:function(){return Math.atan2(this.shx,this.sx)}}),Object.defineProperty(Bt.prototype,"scaleX",{get:function(){return this.decompose().scale.sx}}),Object.defineProperty(Bt.prototype,"scaleY",{get:function(){return this.decompose().scale.sy}}),Object.defineProperty(Bt.prototype,"isIdentity",{get:function(){return this.sx===1&&this.shy===0&&this.shx===0&&this.sy===1&&this.tx===0&&this.ty===0}}),Bt.prototype.join=function(x){return[this.sx,this.shy,this.shx,this.sy,this.tx,this.ty].map(T).join(x)},Bt.prototype.multiply=function(x){var R=x.sx*this.sx+x.shy*this.shx,te=x.sx*this.shy+x.shy*this.sy,me=x.shx*this.sx+x.sy*this.shx,Ne=x.shx*this.shy+x.sy*this.sy,ze=x.tx*this.sx+x.ty*this.shx+this.tx,Ge=x.tx*this.shy+x.ty*this.sy+this.ty;return new Bt(R,te,me,Ne,ze,Ge)},Bt.prototype.decompose=function(){var x=this.sx,R=this.shy,te=this.shx,me=this.sy,Ne=this.tx,ze=this.ty,Ge=Math.sqrt(x*x+R*R),mt=(x/=Ge)*te+(R/=Ge)*me;te-=x*mt,me-=R*mt;var yt=Math.sqrt(te*te+me*me);return mt/=yt,x*(me/=yt)<R*(te/=yt)&&(x=-x,R=-R,mt=-mt,Ge=-Ge),{scale:new Bt(Ge,0,0,yt,0,0),translate:new Bt(1,0,0,1,Ne,ze),rotate:new Bt(x,R,-R,x,0,0),skew:new Bt(1,0,mt,1,0,0)}},Bt.prototype.toString=function(x){return this.join(" ")},Bt.prototype.inversed=function(){var x=this.sx,R=this.shy,te=this.shx,me=this.sy,Ne=this.tx,ze=this.ty,Ge=1/(x*me-R*te),mt=me*Ge,yt=-R*Ge,ft=-te*Ge,zt=x*Ge;return new Bt(mt,yt,ft,zt,-mt*Ne-ft*ze,-yt*Ne-zt*ze)},Bt.prototype.applyToPoint=function(x){var R=x.x*this.sx+x.y*this.shx+this.tx,te=x.x*this.shy+x.y*this.sy+this.ty;return new $i(R,te)},Bt.prototype.applyToRectangle=function(x){var R=this.applyToPoint(x),te=this.applyToPoint(new $i(x.x+x.w,x.y+x.h));return new Ha(R.x,R.y,te.x-R.x,te.y-R.y)},Bt.prototype.clone=function(){var x=this.sx,R=this.shy,te=this.shx,me=this.sy,Ne=this.tx,ze=this.ty;return new Bt(x,R,te,me,Ne,ze)},d.Matrix=Bt;var Jn=d.matrixMult=function(x,R){return R.multiply(x)},qn=new Bt(1,0,0,1,0,0);d.unitMatrix=d.identityMatrix=qn;var Pn=function(x,R){if(!bt[x]){var te=(R instanceof Hl?"Sh":"P")+(Object.keys(dt).length+1).toString(10);R.id=te,bt[x]=te,dt[te]=R,Gt.publish("addPattern",R)}};d.ShadingPattern=Hl,d.TilingPattern=_c,d.addShadingPattern=function(x,R){return D("addShadingPattern()"),Pn(x,R),this},d.beginTilingPattern=function(x){D("beginTilingPattern()"),Ua(x.boundingBox[0],x.boundingBox[1],x.boundingBox[2]-x.boundingBox[0],x.boundingBox[3]-x.boundingBox[1],x.matrix)},d.endTilingPattern=function(x,R){D("endTilingPattern()"),R.stream=ge[V].join(`
`),Pn(x,R),Gt.publish("endTilingPattern",R),li.pop().restore()};var jn,wn=d.__private__.newObject=function(){var x=je();return tt(x,!0),x},je=d.__private__.newObjectDeferred=function(){return ae++,ee[ae]=function(){return he},ae},tt=function(x,R){return R=typeof R=="boolean"&&R,ee[x]=he,R&&K(x+" 0 obj"),x},Ft=d.__private__.newAdditionalObject=function(){var x={objId:je(),content:""};return pe.push(x),x},nn=je(),Yt=je(),Vt=d.__private__.decodeColorString=function(x){var R=x.split(" ");if(R.length!==2||R[1]!=="g"&&R[1]!=="G")R.length!==5||R[4]!=="k"&&R[4]!=="K"||(R=[(1-R[0])*(1-R[3]),(1-R[1])*(1-R[3]),(1-R[2])*(1-R[3]),"r"]);else{var te=parseFloat(R[0]);R=[te,te,te,"r"]}for(var me="#",Ne=0;Ne<3;Ne++)me+=("0"+Math.floor(255*parseFloat(R[Ne])).toString(16)).slice(-2);return me},Lt=d.__private__.encodeColorString=function(x){var R;typeof x=="string"&&(x={ch1:x});var te=x.ch1,me=x.ch2,Ne=x.ch3,ze=x.ch4,Ge=x.pdfColorType==="draw"?["G","RG","K"]:["g","rg","k"];if(typeof te=="string"&&te.charAt(0)!=="#"){var mt=new n_(te);if(mt.ok)te=mt.toHex();else if(!/^\d*\.?\d*$/.test(te))throw new Error('Invalid color "'+te+'" passed to jsPDF.encodeColorString.')}if(typeof te=="string"&&/^#[0-9A-Fa-f]{3}$/.test(te)&&(te="#"+te[1]+te[1]+te[2]+te[2]+te[3]+te[3]),typeof te=="string"&&/^#[0-9A-Fa-f]{6}$/.test(te)){var yt=parseInt(te.substr(1),16);te=yt>>16&255,me=yt>>8&255,Ne=255&yt}if(me===void 0||ze===void 0&&te===me&&me===Ne)R=typeof te=="string"?te+" "+Ge[0]:x.precision===2?C(te/255)+" "+Ge[0]:N(te/255)+" "+Ge[0];else if(ze===void 0||Un(ze)==="object"){if(ze&&!isNaN(ze.a)&&ze.a===0)return["1.","1.","1.",Ge[1]].join(" ");R=typeof te=="string"?[te,me,Ne,Ge[1]].join(" "):x.precision===2?[C(te/255),C(me/255),C(Ne/255),Ge[1]].join(" "):[N(te/255),N(me/255),N(Ne/255),Ge[1]].join(" ")}else R=typeof te=="string"?[te,me,Ne,ze,Ge[2]].join(" "):x.precision===2?[C(te),C(me),C(Ne),C(ze),Ge[2]].join(" "):[N(te),N(me),N(Ne),N(ze),Ge[2]].join(" ");return R},Qt=d.__private__.getFilters=function(){return a},rn=d.__private__.putStream=function(x){var R=(x=x||{}).data||"",te=x.filters||Qt(),me=x.alreadyAppliedFilters||[],Ne=x.addLength1||!1,ze=R.length,Ge=x.objectId,mt=function(zn){return zn};if(u!==null&&Ge===void 0)throw new Error("ObjectId must be passed to putStream for file encryption");u!==null&&(mt=hi.encryptor(Ge,0));var yt={};te===!0&&(te=["FlateEncode"]);var ft=x.additionalKeyValues||[],zt=(yt=Ut.API.processDataByFilters!==void 0?Ut.API.processDataByFilters(R,te):{data:R,reverseChain:[]}).reverseChain+(Array.isArray(me)?me.join(" "):me.toString());if(yt.data.length!==0&&(ft.push({key:"Length",value:yt.data.length}),Ne===!0&&ft.push({key:"Length1",value:ze})),zt.length!=0)if(zt.split("/").length-1==1)ft.push({key:"Filter",value:zt});else{ft.push({key:"Filter",value:"["+zt+"]"});for(var sn=0;sn<ft.length;sn+=1)if(ft[sn].key==="DecodeParms"){for(var tn=[],In=0;In<yt.reverseChain.split("/").length-1;In+=1)tn.push("null");tn.push(ft[sn].value),ft[sn].value="["+tn.join(" ")+"]"}}K("<<");for(var Sn=0;Sn<ft.length;Sn++)K("/"+ft[Sn].key+" "+ft[Sn].value);K(">>"),yt.data.length!==0&&(K("stream"),K(mt(yt.data)),K("endstream"))},Mn=d.__private__.putPage=function(x){var R=x.number,te=x.data,me=x.objId,Ne=x.contentsObjId;tt(me,!0),K("<</Type /Page"),K("/Parent "+x.rootDictionaryObjId+" 0 R"),K("/Resources "+x.resourceDictionaryObjId+" 0 R"),K("/MediaBox ["+parseFloat(T(x.mediaBox.bottomLeftX))+" "+parseFloat(T(x.mediaBox.bottomLeftY))+" "+T(x.mediaBox.topRightX)+" "+T(x.mediaBox.topRightY)+"]"),x.cropBox!==null&&K("/CropBox ["+T(x.cropBox.bottomLeftX)+" "+T(x.cropBox.bottomLeftY)+" "+T(x.cropBox.topRightX)+" "+T(x.cropBox.topRightY)+"]"),x.bleedBox!==null&&K("/BleedBox ["+T(x.bleedBox.bottomLeftX)+" "+T(x.bleedBox.bottomLeftY)+" "+T(x.bleedBox.topRightX)+" "+T(x.bleedBox.topRightY)+"]"),x.trimBox!==null&&K("/TrimBox ["+T(x.trimBox.bottomLeftX)+" "+T(x.trimBox.bottomLeftY)+" "+T(x.trimBox.topRightX)+" "+T(x.trimBox.topRightY)+"]"),x.artBox!==null&&K("/ArtBox ["+T(x.artBox.bottomLeftX)+" "+T(x.artBox.bottomLeftY)+" "+T(x.artBox.topRightX)+" "+T(x.artBox.topRightY)+"]"),typeof x.userUnit=="number"&&x.userUnit!==1&&K("/UserUnit "+x.userUnit),Gt.publish("putPage",{objId:me,pageContext:gt[R],pageNumber:R,page:te}),K("/Contents "+Ne+" 0 R"),K(">>"),K("endobj");var ze=te.join(`
`);return _===A&&(ze+=`
Q`),tt(Ne,!0),rn({data:ze,filters:Qt(),objectId:Ne}),K("endobj"),me},Zt=d.__private__.putPages=function(){var x,R,te=[];for(x=1;x<=kt;x++)gt[x].objId=je(),gt[x].contentsObjId=je();for(x=1;x<=kt;x++)te.push(Mn({number:x,data:ge[x],objId:gt[x].objId,contentsObjId:gt[x].contentsObjId,mediaBox:gt[x].mediaBox,cropBox:gt[x].cropBox,bleedBox:gt[x].bleedBox,trimBox:gt[x].trimBox,artBox:gt[x].artBox,userUnit:gt[x].userUnit,rootDictionaryObjId:nn,resourceDictionaryObjId:Yt}));tt(nn,!0),K("<</Type /Pages");var me="/Kids [";for(R=0;R<kt;R++)me+=te[R]+" 0 R ";K(me+"]"),K("/Count "+kt),K(">>"),K("endobj"),Gt.publish("postPutPages")},Qn=function(x){Gt.publish("putFont",{font:x,out:K,newObject:wn,putStream:rn}),x.isAlreadyPutted!==!0&&(x.objectNumber=wn(),K("<<"),K("/Type /Font"),K("/BaseFont /"+du(x.postScriptName)),K("/Subtype /Type1"),typeof x.encoding=="string"&&K("/Encoding /"+x.encoding),K("/FirstChar 32"),K("/LastChar 255"),K(">>"),K("endobj"))},En=function(x){x.objectNumber=wn();var R=[];R.push({key:"Type",value:"/XObject"}),R.push({key:"Subtype",value:"/Form"}),R.push({key:"BBox",value:"["+[T(x.x),T(x.y),T(x.x+x.width),T(x.y+x.height)].join(" ")+"]"}),R.push({key:"Matrix",value:"["+x.matrix.toString()+"]"});var te=x.pages[1].join(`
`);rn({data:te,additionalKeyValues:R,objectId:x.objectNumber}),K("endobj")},Wn=function(x,R){R||(R=21);var te=wn(),me=(function(Ge,mt){var yt,ft=[],zt=1/(mt-1);for(yt=0;yt<1;yt+=zt)ft.push(yt);if(ft.push(1),Ge[0].offset!=0){var sn={offset:0,color:Ge[0].color};Ge.unshift(sn)}if(Ge[Ge.length-1].offset!=1){var tn={offset:1,color:Ge[Ge.length-1].color};Ge.push(tn)}for(var In="",Sn=0,zn=0;zn<ft.length;zn++){for(yt=ft[zn];yt>Ge[Sn+1].offset;)Sn++;var pn=Ge[Sn].offset,Tn=(yt-pn)/(Ge[Sn+1].offset-pn),ha=Ge[Sn].color,Ps=Ge[Sn+1].color;In+=re(Math.round((1-Tn)*ha[0]+Tn*Ps[0]).toString(16))+re(Math.round((1-Tn)*ha[1]+Tn*Ps[1]).toString(16))+re(Math.round((1-Tn)*ha[2]+Tn*Ps[2]).toString(16))}return In.trim()})(x.colors,R),Ne=[];Ne.push({key:"FunctionType",value:"0"}),Ne.push({key:"Domain",value:"[0.0 1.0]"}),Ne.push({key:"Size",value:"["+R+"]"}),Ne.push({key:"BitsPerSample",value:"8"}),Ne.push({key:"Range",value:"[0.0 1.0 0.0 1.0 0.0 1.0]"}),Ne.push({key:"Decode",value:"[0.0 1.0 0.0 1.0 0.0 1.0]"}),rn({data:me,additionalKeyValues:Ne,alreadyAppliedFilters:["/ASCIIHexDecode"],objectId:te}),K("endobj"),x.objectNumber=wn(),K("<< /ShadingType "+x.type),K("/ColorSpace /DeviceRGB");var ze="/Coords ["+T(parseFloat(x.coords[0]))+" "+T(parseFloat(x.coords[1]))+" ";x.type===2?ze+=T(parseFloat(x.coords[2]))+" "+T(parseFloat(x.coords[3])):ze+=T(parseFloat(x.coords[2]))+" "+T(parseFloat(x.coords[3]))+" "+T(parseFloat(x.coords[4]))+" "+T(parseFloat(x.coords[5])),K(ze+="]"),x.matrix&&K("/Matrix ["+x.matrix.toString()+"]"),K("/Function "+te+" 0 R"),K("/Extend [true true]"),K(">>"),K("endobj")},Bs=function(x,R){var te=je(),me=wn();R.push({resourcesOid:te,objectOid:me}),x.objectNumber=me;var Ne=[];Ne.push({key:"Type",value:"/Pattern"}),Ne.push({key:"PatternType",value:"1"}),Ne.push({key:"PaintType",value:"1"}),Ne.push({key:"TilingType",value:"1"}),Ne.push({key:"BBox",value:"["+x.boundingBox.map(T).join(" ")+"]"}),Ne.push({key:"XStep",value:T(x.xStep)}),Ne.push({key:"YStep",value:T(x.yStep)}),Ne.push({key:"Resources",value:te+" 0 R"}),x.matrix&&Ne.push({key:"Matrix",value:"["+x.matrix.toString()+"]"}),rn({data:x.stream,additionalKeyValues:Ne,objectId:x.objectNumber}),K("endobj")},vo=function(x){for(var R in x.objectNumber=wn(),K("<<"),x)switch(R){case"opacity":K("/ca "+C(x[R]));break;case"stroke-opacity":K("/CA "+C(x[R]))}K(">>"),K("endobj")},or=function(x){tt(x.resourcesOid,!0),K("<<"),K("/ProcSet [/PDF /Text /ImageB /ImageC /ImageI]"),(function(){for(var R in K("/Font <<"),St)St.hasOwnProperty(R)&&(f===!1||f===!0&&p.hasOwnProperty(R))&&K("/"+R+" "+St[R].objectNumber+" 0 R");K(">>")})(),(function(){if(Object.keys(dt).length>0){for(var R in K("/Shading <<"),dt)dt.hasOwnProperty(R)&&dt[R]instanceof Hl&&dt[R].objectNumber>=0&&K("/"+R+" "+dt[R].objectNumber+" 0 R");Gt.publish("putShadingPatternDict"),K(">>")}})(),(function(R){if(Object.keys(dt).length>0){for(var te in K("/Pattern <<"),dt)dt.hasOwnProperty(te)&&dt[te]instanceof d.TilingPattern&&dt[te].objectNumber>=0&&dt[te].objectNumber<R&&K("/"+te+" "+dt[te].objectNumber+" 0 R");Gt.publish("putTilingPatternDict"),K(">>")}})(x.objectOid),(function(){if(Object.keys(ot).length>0){var R;for(R in K("/ExtGState <<"),ot)ot.hasOwnProperty(R)&&ot[R].objectNumber>=0&&K("/"+R+" "+ot[R].objectNumber+" 0 R");Gt.publish("putGStateDict"),K(">>")}})(),(function(){for(var R in K("/XObject <<"),bn)bn.hasOwnProperty(R)&&bn[R].objectNumber>=0&&K("/"+R+" "+bn[R].objectNumber+" 0 R");Gt.publish("putXobjectDict"),K(">>")})(),K(">>"),K("endobj")},bs=function(x){st[x.fontName]=st[x.fontName]||{},st[x.fontName][x.fontStyle]=x.id},zs=function(x,R,te,me,Ne){var ze={id:"F"+(Object.keys(St).length+1).toString(10),postScriptName:x,fontName:R,fontStyle:te,encoding:me,isStandardFont:Ne||!1,metadata:{}};return Gt.publish("addFont",{font:ze,instance:this}),St[ze.id]=ze,bs(ze),ze.id},Pr=d.__private__.pdfEscape=d.pdfEscape=function(x,R){return(function(te,me){var Ne,ze,Ge,mt,yt,ft,zt,sn,tn;if(Ge=(me=me||{}).sourceEncoding||"Unicode",yt=me.outputEncoding,(me.autoencode||yt)&&St[Le].metadata&&St[Le].metadata[Ge]&&St[Le].metadata[Ge].encoding&&(mt=St[Le].metadata[Ge].encoding,!yt&&St[Le].encoding&&(yt=St[Le].encoding),!yt&&mt.codePages&&(yt=mt.codePages[0]),typeof yt=="string"&&(yt=mt[yt]),yt)){for(zt=!1,ft=[],Ne=0,ze=te.length;Ne<ze;Ne++)(sn=yt[te.charCodeAt(Ne)])?ft.push(String.fromCharCode(sn)):ft.push(te[Ne]),ft[Ne].charCodeAt(0)>>8&&(zt=!0);te=ft.join("")}for(Ne=te.length;zt===void 0&&Ne!==0;)te.charCodeAt(Ne-1)>>8&&(zt=!0),Ne--;if(!zt)return te;for(ft=me.noBOM?[]:[254,255],Ne=0,ze=te.length;Ne<ze;Ne++){if((tn=(sn=te.charCodeAt(Ne))>>8)>>8)throw new Error("Character at position "+Ne+" of string '"+te+"' exceeds 16bits. Cannot be encoded into UCS-2 BE");ft.push(tn),ft.push(sn-(tn<<8))}return String.fromCharCode.apply(void 0,ft)})(x,R).replace(/\\/g,"\\\\").replace(/\(/g,"\\(").replace(/\)/g,"\\)")},ws=d.__private__.beginPage=function(x){ge[++kt]=[],gt[kt]={objId:0,contentsObjId:0,userUnit:Number(o),artBox:null,bleedBox:null,cropBox:null,trimBox:null,mediaBox:{bottomLeftX:0,bottomLeftY:0,topRightX:Number(x[0]),topRightY:Number(x[1])}},pl(kt),Ye(ge[V])},xs=function(x,R){var te,me,Ne;switch(n=R||n,typeof x=="string"&&(te=b(x.toLowerCase()),Array.isArray(te)&&(me=te[0],Ne=te[1])),Array.isArray(x)&&(me=x[0]*it,Ne=x[1]*it),isNaN(me)&&(me=r[0],Ne=r[1]),(me>14400||Ne>14400)&&(ni.warn("A page in a PDF can not be wider or taller than 14400 userUnit. jsPDF limits the width/height to 14400"),me=Math.min(14400,me),Ne=Math.min(14400,Ne)),r=[me,Ne],n.substr(0,1)){case"l":Ne>me&&(r=[Ne,me]);break;case"p":me>Ne&&(r=[Ne,me])}ws(r),Jt(qa),K(da),ja!==0&&K(ja+" J"),wo!==0&&K(wo+" j"),Gt.publish("addPage",{pageNumber:kt})},lr=function(x){x>0&&x<=kt&&(ge.splice(x,1),gt.splice(x,1),kt--,V>kt&&(V=kt),this.setPage(V))},pl=function(x){x>0&&x<=kt&&(V=x)},ua=d.__private__.getNumberOfPages=d.getNumberOfPages=function(){return ge.length-1},gl=function(x,R,te){var me,Ne=void 0;return te=te||{},x=x!==void 0?x:St[Le].fontName,R=R!==void 0?R:St[Le].fontStyle,me=x.toLowerCase(),st[me]!==void 0&&st[me][R]!==void 0?Ne=st[me][R]:st[x]!==void 0&&st[x][R]!==void 0?Ne=st[x][R]:te.disableWarning===!1&&ni.warn("Unable to look up font label for font '"+x+"', '"+R+"'. Refer to getFontList() for available fonts."),Ne||te.noFallback||(Ne=st.times[R])==null&&(Ne=st.times.normal),Ne},Hi=d.__private__.putInfo=function(){var x=wn(),R=function(me){return me};for(var te in u!==null&&(R=hi.encryptor(x,0)),K("<<"),K("/Producer ("+Pr(R("jsPDF "+Ut.version))+")"),Pe)Pe.hasOwnProperty(te)&&Pe[te]&&K("/"+te.substr(0,1).toUpperCase()+te.substr(1)+" ("+Pr(R(Pe[te]))+")");K("/CreationDate ("+Pr(R(F))+")"),K(">>"),K("endobj")},cr=d.__private__.putCatalog=function(x){var R=(x=x||{}).rootDictionaryObjId||nn;switch(wn(),K("<<"),K("/Type /Catalog"),K("/Pages "+R+" 0 R"),lt||(lt="fullwidth"),lt){case"fullwidth":K("/OpenAction [3 0 R /FitH null]");break;case"fullheight":K("/OpenAction [3 0 R /FitV null]");break;case"fullpage":K("/OpenAction [3 0 R /Fit]");break;case"original":K("/OpenAction [3 0 R /XYZ null null 1]");break;default:var te=""+lt;te.substr(te.length-1)==="%"&&(lt=parseInt(lt)/100),typeof lt=="number"&&K("/OpenAction [3 0 R /XYZ null null "+C(lt)+"]")}switch(ye||(ye="continuous"),ye){case"continuous":K("/PageLayout /OneColumn");break;case"single":K("/PageLayout /SinglePage");break;case"two":case"twoleft":K("/PageLayout /TwoColumnLeft");break;case"tworight":K("/PageLayout /TwoColumnRight")}ht&&K("/PageMode /"+ht),Gt.publish("putCatalog"),K(">>"),K("endobj")},nc=d.__private__.putTrailer=function(){K("trailer"),K("<<"),K("/Size "+(ae+1)),K("/Root "+ae+" 0 R"),K("/Info "+(ae-1)+" 0 R"),u!==null&&K("/Encrypt "+hi.oid+" 0 R"),K("/ID [ <"+q+"> <"+q+"> ]"),K(">>")},$n=d.__private__.putHeader=function(){K("%PDF-"+y),K("%ÂºÃÂ¬Ã ")},Ba=d.__private__.putXRef=function(){var x="0000000000";K("xref"),K("0 "+(ae+1)),K("0000000000 65535 f ");for(var R=1;R<=ae;R++)typeof ee[R]=="function"?K((x+ee[R]()).slice(-10)+" 00000 n "):ee[R]!==void 0?K((x+ee[R]).slice(-10)+" 00000 n "):K("0000000000 00000 n ")},fi=d.__private__.buildDocument=function(){var x;ae=0,he=0,de=[],ee=[],pe=[],nn=je(),Yt=je(),Ye(de),Gt.publish("buildDocument"),$n(),Zt(),(function(){Gt.publish("putAdditionalObjects");for(var te=0;te<pe.length;te++){var me=pe[te];tt(me.objId,!0),K(me.content),K("endobj")}Gt.publish("postPutAdditionalObjects")})(),x=[],(function(){for(var te in St)St.hasOwnProperty(te)&&(f===!1||f===!0&&p.hasOwnProperty(te))&&Qn(St[te])})(),(function(){var te;for(te in ot)ot.hasOwnProperty(te)&&vo(ot[te])})(),(function(){for(var te in bn)bn.hasOwnProperty(te)&&En(bn[te])})(),(function(te){var me;for(me in dt)dt.hasOwnProperty(me)&&(dt[me]instanceof Hl?Wn(dt[me]):dt[me]instanceof _c&&Bs(dt[me],te))})(x),Gt.publish("putResources"),x.forEach(or),or({resourcesOid:Yt,objectOid:Number.MAX_SAFE_INTEGER}),Gt.publish("postPutResources"),u!==null&&(hi.oid=wn(),K("<<"),K("/Filter /Standard"),K("/V "+hi.v),K("/R "+hi.r),K("/U <"+hi.toHexString(hi.U)+">"),K("/O <"+hi.toHexString(hi.O)+">"),K("/P "+hi.P),K(">>"),K("endobj")),Hi(),cr();var R=he;return Ba(),nc(),K("startxref"),K(""+R),K("%%EOF"),Ye(ge[V]),de.join(`
`)},Er=d.__private__.getBlob=function(x){return new Blob([Qe(x)],{type:"application/pdf"})},ml=d.output=d.__private__.output=(jn=function(x,R){switch(typeof(R=R||{})=="string"?R={filename:R}:R.filename=R.filename||"generated.pdf",x){case void 0:return fi();case"save":d.save(R.filename);break;case"arraybuffer":return Qe(fi());case"blob":return Er(fi());case"bloburi":case"bloburl":if(an.URL!==void 0&&typeof an.URL.createObjectURL=="function")return an.URL&&an.URL.createObjectURL(Er(fi()))||void 0;ni.warn("bloburl is not supported by your system, because URL.createObjectURL is not supported by your browser.");break;case"datauristring":case"dataurlstring":var te="",me=fi();try{te=Sy(me)}catch{te=Sy(unescape(encodeURIComponent(me)))}return"data:application/pdf;filename="+R.filename+";base64,"+te;case"pdfobjectnewwindow":if(Object.prototype.toString.call(an)==="[object Window]"){var Ne="https://cdnjs.cloudflare.com/ajax/libs/pdfobject/2.1.1/pdfobject.min.js",ze=' integrity="sha512-4ze/a9/4jqu+tX9dfOqJYSvyYd5M6qum/3HpCLr+/Jqf0whc37VUbkpNGHR7/8pSnCFw47T1fmIpwBV7UySh3g==" crossorigin="anonymous"';R.pdfObjectUrl&&(Ne=R.pdfObjectUrl,ze="");var Ge='<html><style>html, body { padding: 0; margin: 0; } iframe { width: 100%; height: 100%; border: 0;}  </style><body><script src="'+Ne+'"'+ze+'><\/script><script >PDFObject.embed("'+this.output("dataurlstring")+'", '+JSON.stringify(R)+");<\/script></body></html>",mt=an.open();return mt!==null&&mt.document.write(Ge),mt}throw new Error("The option pdfobjectnewwindow just works in a browser-environment.");case"pdfjsnewwindow":if(Object.prototype.toString.call(an)==="[object Window]"){var yt='<html><style>html, body { padding: 0; margin: 0; } iframe { width: 100%; height: 100%; border: 0;}  </style><body><iframe id="pdfViewer" src="'+(R.pdfJsUrl||"examples/PDF.js/web/viewer.html")+"?file=&downloadName="+R.filename+'" width="500px" height="400px" /></body></html>',ft=an.open();if(ft!==null){ft.document.write(yt);var zt=this;ft.document.documentElement.querySelector("#pdfViewer").onload=function(){ft.document.title=R.filename,ft.document.documentElement.querySelector("#pdfViewer").contentWindow.PDFViewerApplication.open(zt.output("bloburl"))}}return ft}throw new Error("The option pdfjsnewwindow just works in a browser-environment.");case"dataurlnewwindow":if(Object.prototype.toString.call(an)!=="[object Window]")throw new Error("The option dataurlnewwindow just works in a browser-environment.");var sn='<html><style>html, body { padding: 0; margin: 0; } iframe { width: 100%; height: 100%; border: 0;}  </style><body><iframe src="'+this.output("datauristring",R)+'"></iframe></body></html>',tn=an.open();if(tn!==null&&(tn.document.write(sn),tn.document.title=R.filename),tn||typeof safari>"u")return tn;break;case"datauri":case"dataurl":return an.document.location.href=this.output("datauristring",R);default:return null}},jn.foo=function(){try{return jn.apply(this,arguments)}catch(te){var x=te.stack||"";~x.indexOf(" at ")&&(x=x.split(" at ")[1]);var R="Error in function "+x.split(`
`)[0].split("<")[0]+": "+te.message;if(!an.console)throw new Error(R);an.console.error(R,te),an.alert&&alert(R)}},jn.foo.bar=jn,jn.foo),Ii=function(x){return Array.isArray(oi)===!0&&oi.indexOf(x)>-1};switch(i){case"pt":it=1;break;case"mm":it=72/25.4;break;case"cm":it=72/2.54;break;case"in":it=72;break;case"px":it=Ii("px_scaling")==1?.75:96/72;break;case"pc":case"em":it=12;break;case"ex":it=6;break;default:if(typeof i!="number")throw new Error("Invalid unit: "+i);it=i}var hi=null;le(),W();var ur=d.__private__.getPageInfo=d.getPageInfo=function(x){if(isNaN(x)||x%1!=0)throw new Error("Invalid argument passed to jsPDF.getPageInfo");return{objId:gt[x].objId,pageNumber:x,pageContext:gt[x]}},yr=d.__private__.getPageInfoByObjId=function(x){if(isNaN(x)||x%1!=0)throw new Error("Invalid argument passed to jsPDF.getPageInfoByObjId");for(var R in gt)if(gt[R].objId===x)break;return ur(R)},vl=d.__private__.getCurrentPageInfo=d.getCurrentPageInfo=function(){return{objId:gt[V].objId,pageNumber:V,pageContext:gt[V]}};d.addPage=function(){return xs.apply(this,arguments),this},d.setPage=function(){return pl.apply(this,arguments),Ye.call(this,ge[V]),this},d.insertPage=function(x){return this.addPage(),this.movePage(V,x),this},d.movePage=function(x,R){var te,me;if(x>R){te=ge[x],me=gt[x];for(var Ne=x;Ne>R;Ne--)ge[Ne]=ge[Ne-1],gt[Ne]=gt[Ne-1];ge[R]=te,gt[R]=me,this.setPage(R)}else if(x<R){te=ge[x],me=gt[x];for(var ze=x;ze<R;ze++)ge[ze]=ge[ze+1],gt[ze]=gt[ze+1];ge[R]=te,gt[R]=me,this.setPage(R)}return this},d.deletePage=function(){return lr.apply(this,arguments),this},d.__private__.text=d.text=function(x,R,te,me,Ne){var ze,Ge,mt,yt,ft,zt,sn,tn,In,Sn=(me=me||{}).scope||this;if(typeof x=="number"&&typeof R=="number"&&(typeof te=="string"||Array.isArray(te))){var zn=te;te=R,R=x,x=zn}if(arguments[3]instanceof Bt==0?(mt=arguments[4],yt=arguments[5],Un(sn=arguments[3])==="object"&&sn!==null||(typeof mt=="string"&&(yt=mt,mt=null),typeof sn=="string"&&(yt=sn,sn=null),typeof sn=="number"&&(mt=sn,sn=null),me={flags:sn,angle:mt,align:yt})):(D("The transform parameter of text() with a Matrix value"),In=Ne),isNaN(R)||isNaN(te)||x==null)throw new Error("Invalid arguments passed to jsPDF.text");if(x.length===0)return Sn;var pn,Tn="",ha=typeof me.lineHeightFactor=="number"?me.lineHeightFactor:Li,Ps=Sn.internal.scaleFactor;function pa(Ln){return Ln=Ln.split("	").join(Array(me.TabLen||9).join(" ")),Pr(Ln,sn)}function Vs(Ln){for(var kn,Vn=Ln.concat(),Mi=[],va=Vn.length;va--;)typeof(kn=Vn.shift())=="string"?Mi.push(kn):Array.isArray(Ln)&&(kn.length===1||kn[1]===void 0&&kn[2]===void 0)?Mi.push(kn[0]):Mi.push([kn[0],kn[1],kn[2]]);return Mi}function Es(Ln,kn){var Vn;if(typeof Ln=="string")Vn=kn(Ln)[0];else if(Array.isArray(Ln)){for(var Mi,va,hc=Ln.concat(),Is=[],ya=hc.length;ya--;)typeof(Mi=hc.shift())=="string"?Is.push(kn(Mi)[0]):Array.isArray(Mi)&&typeof Mi[0]=="string"&&(va=kn(Mi[0],Mi[1],Mi[2]),Is.push([va[0],va[1],va[2]]));Vn=Is}return Vn}var Wa=!1,So=!0;if(typeof x=="string")Wa=!0;else if(Array.isArray(x)){var ko=x.concat();Ge=[];for(var Ur,pi=ko.length;pi--;)(typeof(Ur=ko.shift())!="string"||Array.isArray(Ur)&&typeof Ur[0]!="string")&&(So=!1);Wa=So}if(Wa===!1)throw new Error('Type of text must be string or Array. "'+x+'" is not recognized.');typeof x=="string"&&(x=x.match(/[\r?\n]/)?x.split(/\r\n|\r|\n/g):[x]);var Ao=Ie/Sn.internal.scaleFactor,No=Ao*(ha-1);switch(me.baseline){case"bottom":te-=No;break;case"top":te+=Ao-No;break;case"hanging":te+=Ao-2*No;break;case"middle":te+=Ao/2-No}if((zt=me.maxWidth||0)>0&&(typeof x=="string"?x=Sn.splitTextToSize(x,zt):Object.prototype.toString.call(x)==="[object Array]"&&(x=x.reduce(function(Ln,kn){return Ln.concat(Sn.splitTextToSize(kn,zt))},[]))),ze={text:x,x:R,y:te,options:me,mutex:{pdfEscape:Pr,activeFontKey:Le,fonts:St,activeFontSize:Ie}},Gt.publish("preProcessText",ze),x=ze.text,mt=(me=ze.options).angle,In instanceof Bt==0&&mt&&typeof mt=="number"){mt*=Math.PI/180,me.rotationDirection===0&&(mt=-mt),_===A&&(mt=-mt);var oc=Math.cos(mt),Gs=Math.sin(mt);In=new Bt(oc,Gs,-Gs,oc,0,0)}else mt&&mt instanceof Bt&&(In=mt);_!==A||In||(In=qn),(ft=me.charSpace||Qi)!==void 0&&(Tn+=T(B(ft))+` Tc
`,this.setCharSpace(this.getCharSpace()||0)),(tn=me.horizontalScale)!==void 0&&(Tn+=T(100*tn)+` Tz
`),me.lang;var ki=-1,ga=me.renderingMode!==void 0?me.renderingMode:me.stroke,bl=Sn.internal.getCurrentPageInfo().pageContext;switch(ga){case 0:case!1:case"fill":ki=0;break;case 1:case!0:case"stroke":ki=1;break;case 2:case"fillThenStroke":ki=2;break;case 3:case"invisible":ki=3;break;case 4:case"fillAndAddForClipping":ki=4;break;case 5:case"strokeAndAddPathForClipping":ki=5;break;case 6:case"fillThenStrokeAndAddToPathForClipping":ki=6;break;case 7:case"addToPathForClipping":ki=7}var Vc=bl.usedRenderingMode!==void 0?bl.usedRenderingMode:-1;ki!==-1?Tn+=ki+` Tr
`:Vc!==-1&&(Tn+=`0 Tr
`),ki!==-1&&(bl.usedRenderingMode=ki),yt=me.align||"left";var er,ls=Ie*ha,lc=Sn.internal.pageSize.getWidth(),cc=St[Le];ft=me.charSpace||Qi,zt=me.maxWidth||0,sn=Object.assign({autoencode:!0,noBOM:!0},me.flags);var Va=[],cs=function(Ln){return Sn.getStringUnitWidth(Ln,{font:cc,charSpace:ft,fontSize:Ie,doKerning:!1})*Ie/Ps};if(Object.prototype.toString.call(x)==="[object Array]"){var Ui;Ge=Vs(x),yt!=="left"&&(er=Ge.map(cs));var Wr,Ga=0;if(yt==="right"){R-=er[0],x=[],pi=Ge.length;for(var ma=0;ma<pi;ma++)ma===0?(Wr=as(R),Ui=As(te)):(Wr=B(Ga-er[ma]),Ui=-ls),x.push([Ge[ma],Wr,Ui]),Ga=er[ma]}else if(yt==="center"){R-=er[0]/2,x=[],pi=Ge.length;for(var Vr=0;Vr<pi;Vr++)Vr===0?(Wr=as(R),Ui=As(te)):(Wr=B((Ga-er[Vr])/2),Ui=-ls),x.push([Ge[Vr],Wr,Ui]),Ga=er[Vr]}else if(yt==="left"){x=[],pi=Ge.length;for(var Xs=0;Xs<pi;Xs++)x.push(Ge[Xs])}else if(yt==="justify"&&cc.encoding==="Identity-H"){x=[],pi=Ge.length,zt=zt!==0?zt:lc;for(var wl=0,xi=0;xi<pi;xi++)if(Ui=xi===0?As(te):-ls,Wr=xi===0?as(R):wl,xi<pi-1){var Gc=B((zt-er[xi])/(Ge[xi].split(" ").length-1)),wr=Ge[xi].split(" ");x.push([wr[0]+" ",Wr,Ui]),wl=0;for(var xr=1;xr<wr.length;xr++){var uc=(cs(wr[xr-1]+" "+wr[xr])-cs(wr[xr]))*Ps+Gc;xr==wr.length-1?x.push([wr[xr],uc,0]):x.push([wr[xr]+" ",uc,0]),wl-=uc}}else x.push([Ge[xi],Wr,Ui]);x.push(["",wl,0])}else{if(yt!=="justify")throw new Error('Unrecognized alignment option, use "left", "center", "right" or "justify".');for(x=[],pi=Ge.length,zt=zt!==0?zt:lc,xi=0;xi<pi;xi++){Ui=xi===0?As(te):-ls,Wr=xi===0?as(R):0;var dc=Ge[xi].split(" ").length-1,fc=dc>0?(zt-er[xi])/dc:0;xi<pi-1?Va.push(T(B(fc))):Va.push(0),x.push([Ge[xi],Wr,Ui])}}}(typeof me.R2L=="boolean"?me.R2L:Ke)===!0&&(x=Es(x,function(Ln,kn,Vn){return[Ln.split("").reverse().join(""),kn,Vn]})),ze={text:x,x:R,y:te,options:me,mutex:{pdfEscape:Pr,activeFontKey:Le,fonts:St,activeFontSize:Ie}},Gt.publish("postProcessText",ze),x=ze.text,pn=ze.mutex.isHex||!1;var Ys=St[Le].encoding;Ys!=="WinAnsiEncoding"&&Ys!=="StandardEncoding"||(x=Es(x,function(Ln,kn,Vn){return[pa(Ln),kn,Vn]})),Ge=Vs(x),x=[];for(var Gr,Xa,Ya,Co=Array.isArray(Ge[0])?1:0,Xr="",us=function(Ln,kn,Vn){var Mi="";return Vn instanceof Bt?(Vn=typeof me.angle=="number"?Jn(Vn,new Bt(1,0,0,1,Ln,kn)):Jn(new Bt(1,0,0,1,Ln,kn),Vn),_===A&&(Vn=Jn(new Bt(1,0,0,-1,0,0),Vn)),Mi=Vn.join(" ")+` Tm
`):Mi=T(Ln)+" "+T(kn)+` Td
`,Mi},ds=0;ds<Ge.length;ds++){switch(Xr="",Co){case 1:Ya=(pn?"<":"(")+Ge[ds][0]+(pn?">":")"),Gr=parseFloat(Ge[ds][1]),Xa=parseFloat(Ge[ds][2]);break;case 0:Ya=(pn?"<":"(")+Ge[ds]+(pn?">":")"),Gr=as(R),Xa=As(te)}Va!==void 0&&Va[ds]!==void 0&&(Xr=Va[ds]+` Tw
`),ds===0?x.push(Xr+us(Gr,Xa,In)+Ya):Co===0?x.push(Xr+Ya):Co===1&&x.push(Xr+us(Gr,Xa,In)+Ya)}x=Co===0?x.join(` Tj
T* `):x.join(` Tj
`),x+=` Tj
`;var Ks=`BT
/`;return Ks+=Le+" "+Ie+` Tf
`,Ks+=T(Ie*ha)+` TL
`,Ks+=Us+`
`,Ks+=Tn,Ks+=x,K(Ks+="ET"),p[Le]=!0,Sn};var ic=d.__private__.clip=d.clip=function(x){return K(x==="evenodd"?"W*":"W"),this};d.clipEvenOdd=function(){return ic("evenodd")},d.__private__.discardPath=d.discardPath=function(){return K("n"),this};var Ir=d.__private__.isValidStyle=function(x){var R=!1;return[void 0,null,"S","D","F","DF","FD","f","f*","B","B*","n"].indexOf(x)!==-1&&(R=!0),R};d.__private__.setDefaultPathOperation=d.setDefaultPathOperation=function(x){return Ir(x)&&(c=x),this};var dr=d.__private__.getStyle=d.getStyle=function(x){var R=c;switch(x){case"D":case"S":R="S";break;case"F":R="f";break;case"FD":case"DF":R="B";break;case"f":case"f*":case"B":case"B*":R=x}return R},rs=d.close=function(){return K("h"),this};d.stroke=function(){return K("S"),this},d.fill=function(x){return za("f",x),this},d.fillEvenOdd=function(x){return za("f*",x),this},d.fillStroke=function(x){return za("B",x),this},d.fillStrokeEvenOdd=function(x){return za("B*",x),this};var za=function(x,R){Un(R)==="object"?qs(R,x):K(x)},qr=function(x){x===null||_===A&&x===void 0||(x=dr(x),K(x))};function yl(x,R,te,me,Ne){var ze=new _c(R||this.boundingBox,te||this.xStep,me||this.yStep,this.gState,Ne||this.matrix);ze.stream=this.stream;var Ge=x+"$$"+this.cloneIndex+++"$$";return Pn(Ge,ze),ze}var qs=function(x,R){var te=bt[x.key],me=dt[te];if(me instanceof Hl)K("q"),K(ss(R)),me.gState&&d.setGState(me.gState),K(x.matrix.toString()+" cm"),K("/"+te+" sh"),K("Q");else if(me instanceof _c){var Ne=new Bt(1,0,0,-1,0,Ve());x.matrix&&(Ne=Ne.multiply(x.matrix||qn),te=yl.call(me,x.key,x.boundingBox,x.xStep,x.yStep,Ne).id),K("q"),K("/Pattern cs"),K("/"+te+" scn"),me.gState&&d.setGState(me.gState),K(R),K("Q")}},ss=function(x){switch(x){case"f":case"F":case"n":return"W n";case"f*":return"W* n";case"B":case"S":return"W S";case"B*":return"W* S"}},_s=d.moveTo=function(x,R){return K(T(B(x))+" "+T(P(R))+" m"),this},yo=d.lineTo=function(x,R){return K(T(B(x))+" "+T(P(R))+" l"),this},jr=d.curveTo=function(x,R,te,me,Ne,ze){return K([T(B(x)),T(P(R)),T(B(te)),T(P(me)),T(B(Ne)),T(P(ze)),"c"].join(" ")),this};d.__private__.line=d.line=function(x,R,te,me,Ne){if(isNaN(x)||isNaN(R)||isNaN(te)||isNaN(me)||!Ir(Ne))throw new Error("Invalid arguments passed to jsPDF.line");return _===S?this.lines([[te-x,me-R]],x,R,[1,1],Ne||"S"):this.lines([[te-x,me-R]],x,R,[1,1]).stroke()},d.__private__.lines=d.lines=function(x,R,te,me,Ne,ze){var Ge,mt,yt,ft,zt,sn,tn,In,Sn,zn,pn,Tn;if(typeof x=="number"&&(Tn=te,te=R,R=x,x=Tn),me=me||[1,1],ze=ze||!1,isNaN(R)||isNaN(te)||!Array.isArray(x)||!Array.isArray(me)||!Ir(Ne)||typeof ze!="boolean")throw new Error("Invalid arguments passed to jsPDF.lines");for(_s(R,te),Ge=me[0],mt=me[1],ft=x.length,zn=R,pn=te,yt=0;yt<ft;yt++)(zt=x[yt]).length===2?(zn=zt[0]*Ge+zn,pn=zt[1]*mt+pn,yo(zn,pn)):(sn=zt[0]*Ge+zn,tn=zt[1]*mt+pn,In=zt[2]*Ge+zn,Sn=zt[3]*mt+pn,zn=zt[4]*Ge+zn,pn=zt[5]*mt+pn,jr(sn,tn,In,Sn,zn,pn));return ze&&rs(),qr(Ne),this},d.path=function(x){for(var R=0;R<x.length;R++){var te=x[R],me=te.c;switch(te.op){case"m":_s(me[0],me[1]);break;case"l":yo(me[0],me[1]);break;case"c":jr.apply(this,me);break;case"h":rs()}}return this},d.__private__.rect=d.rect=function(x,R,te,me,Ne){if(isNaN(x)||isNaN(R)||isNaN(te)||isNaN(me)||!Ir(Ne))throw new Error("Invalid arguments passed to jsPDF.rect");return _===S&&(me=-me),K([T(B(x)),T(P(R)),T(B(te)),T(B(me)),"re"].join(" ")),qr(Ne),this},d.__private__.triangle=d.triangle=function(x,R,te,me,Ne,ze,Ge){if(isNaN(x)||isNaN(R)||isNaN(te)||isNaN(me)||isNaN(Ne)||isNaN(ze)||!Ir(Ge))throw new Error("Invalid arguments passed to jsPDF.triangle");return this.lines([[te-x,me-R],[Ne-te,ze-me],[x-Ne,R-ze]],x,R,[1,1],Ge,!0),this},d.__private__.roundedRect=d.roundedRect=function(x,R,te,me,Ne,ze,Ge){if(isNaN(x)||isNaN(R)||isNaN(te)||isNaN(me)||isNaN(Ne)||isNaN(ze)||!Ir(Ge))throw new Error("Invalid arguments passed to jsPDF.roundedRect");var mt=4/3*(Math.SQRT2-1);return Ne=Math.min(Ne,.5*te),ze=Math.min(ze,.5*me),this.lines([[te-2*Ne,0],[Ne*mt,0,Ne,ze-ze*mt,Ne,ze],[0,me-2*ze],[0,ze*mt,-Ne*mt,ze,-Ne,ze],[2*Ne-te,0],[-Ne*mt,0,-Ne,-ze*mt,-Ne,-ze],[0,2*ze-me],[0,-ze*mt,Ne*mt,-ze,Ne,-ze]],x+Ne,R,[1,1],Ge,!0),this},d.__private__.ellipse=d.ellipse=function(x,R,te,me,Ne){if(isNaN(x)||isNaN(R)||isNaN(te)||isNaN(me)||!Ir(Ne))throw new Error("Invalid arguments passed to jsPDF.ellipse");var ze=4/3*(Math.SQRT2-1)*te,Ge=4/3*(Math.SQRT2-1)*me;return _s(x+te,R),jr(x+te,R-Ge,x+ze,R-me,x,R-me),jr(x-ze,R-me,x-te,R-Ge,x-te,R),jr(x-te,R+Ge,x-ze,R+me,x,R+me),jr(x+ze,R+me,x+te,R+Ge,x+te,R),qr(Ne),this},d.__private__.circle=d.circle=function(x,R,te,me){if(isNaN(x)||isNaN(R)||isNaN(te)||!Ir(me))throw new Error("Invalid arguments passed to jsPDF.circle");return this.ellipse(x,R,te,te,me)},d.setFont=function(x,R,te){return te&&(R=M(R,te)),Le=gl(x,R,{disableWarning:!1}),this};var Ss=d.__private__.getFont=d.getFont=function(){return St[gl.apply(d,arguments)]};d.__private__.getFontList=d.getFontList=function(){var x,R,te={};for(x in st)if(st.hasOwnProperty(x))for(R in te[x]=[],st[x])st[x].hasOwnProperty(R)&&te[x].push(R);return te},d.addFont=function(x,R,te,me,Ne){var ze=["StandardEncoding","MacRomanEncoding","Identity-H","WinAnsiEncoding"];return arguments[3]&&ze.indexOf(arguments[3])!==-1?Ne=arguments[3]:arguments[3]&&ze.indexOf(arguments[3])==-1&&(te=M(te,me)),zs.call(this,x,R,te,Ne=Ne||"Identity-H")};var Li,qa=t.lineWidth||.200025,rc=d.__private__.getLineWidth=d.getLineWidth=function(){return qa},Jt=d.__private__.setLineWidth=d.setLineWidth=function(x){return qa=x,K(T(B(x))+" w"),this};d.__private__.setLineDash=Ut.API.setLineDash=Ut.API.setLineDashPattern=function(x,R){if(x=x||[],R=R||0,isNaN(R)||!Array.isArray(x))throw new Error("Invalid arguments passed to jsPDF.setLineDash");return x=x.map(function(te){return T(B(te))}).join(" "),R=T(B(R)),K("["+x+"] "+R+" d"),this};var js=d.__private__.getLineHeight=d.getLineHeight=function(){return Ie*Li};d.__private__.getLineHeight=d.getLineHeight=function(){return Ie*Li};var ks=d.__private__.setLineHeightFactor=d.setLineHeightFactor=function(x){return typeof(x=x||1.15)=="number"&&(Li=x),this},sc=d.__private__.getLineHeightFactor=d.getLineHeightFactor=function(){return Li};ks(t.lineHeight);var as=d.__private__.getHorizontalCoordinate=function(x){return B(x)},As=d.__private__.getVerticalCoordinate=function(x){return _===A?x:gt[V].mediaBox.topRightY-gt[V].mediaBox.bottomLeftY-B(x)},Ns=d.__private__.getHorizontalCoordinateString=d.getHorizontalCoordinateString=function(x){return T(as(x))},Hs=d.__private__.getVerticalCoordinateString=d.getVerticalCoordinateString=function(x){return T(As(x))},da=t.strokeColor||"0 G";d.__private__.getStrokeColor=d.getDrawColor=function(){return Vt(da)},d.__private__.setStrokeColor=d.setDrawColor=function(x,R,te,me){return da=Lt({ch1:x,ch2:R,ch3:te,ch4:me,pdfColorType:"draw",precision:2}),K(da),this};var bo=t.fillColor||"0 g";d.__private__.getFillColor=d.getFillColor=function(){return Vt(bo)},d.__private__.setFillColor=d.setFillColor=function(x,R,te,me){return bo=Lt({ch1:x,ch2:R,ch3:te,ch4:me,pdfColorType:"fill",precision:2}),K(bo),this};var Us=t.textColor||"0 g",Ws=d.__private__.getTextColor=d.getTextColor=function(){return Vt(Us)};d.__private__.setTextColor=d.setTextColor=function(x,R,te,me){return Us=Lt({ch1:x,ch2:R,ch3:te,ch4:me,pdfColorType:"text",precision:3}),this};var Qi=t.charSpace,ac=d.__private__.getCharSpace=d.getCharSpace=function(){return parseFloat(Qi||0)};d.__private__.setCharSpace=d.setCharSpace=function(x){if(isNaN(x))throw new Error("Invalid argument passed to jsPDF.setCharSpace");return Qi=x,this};var ja=0;d.CapJoinStyles={0:0,butt:0,but:0,miter:0,1:1,round:1,rounded:1,circle:1,2:2,projecting:2,project:2,square:2,bevel:2},d.__private__.setLineCap=d.setLineCap=function(x){var R=d.CapJoinStyles[x];if(R===void 0)throw new Error("Line cap style of '"+x+"' is not recognized. See or extend .CapJoinStyles property for valid styles");return ja=R,K(R+" J"),this};var wo=0;d.__private__.setLineJoin=d.setLineJoin=function(x){var R=d.CapJoinStyles[x];if(R===void 0)throw new Error("Line join style of '"+x+"' is not recognized. See or extend .CapJoinStyles property for valid styles");return wo=R,K(R+" j"),this},d.__private__.setLineMiterLimit=d.__private__.setMiterLimit=d.setLineMiterLimit=d.setMiterLimit=function(x){if(x=x||0,isNaN(x))throw new Error("Invalid argument passed to jsPDF.setLineMiterLimit");return K(T(B(x))+" M"),this},d.GState=Dc,d.setGState=function(x){(x=typeof x=="string"?ot[vt[x]]:os(null,x)).equals(jt)||(K("/"+x.id+" gs"),jt=x)};var os=function(x,R){if(!x||!vt[x]){var te=!1;for(var me in ot)if(ot.hasOwnProperty(me)&&ot[me].equals(R)){te=!0;break}if(te)R=ot[me];else{var Ne="GS"+(Object.keys(ot).length+1).toString(10);ot[Ne]=R,R.id=Ne}return x&&(vt[x]=R.id),Gt.publish("addGState",R),R}};d.addGState=function(x,R){return os(x,R),this},d.saveGraphicsState=function(){return K("q"),Ot.push({key:Le,size:Ie,color:Us}),this},d.restoreGraphicsState=function(){K("Q");var x=Ot.pop();return Le=x.key,Ie=x.size,Us=x.color,jt=null,this},d.setCurrentTransformationMatrix=function(x){return K(x.toString()+" cm"),this},d.comment=function(x){return K("#"+x),this};var $i=function(x,R){var te=x||0;Object.defineProperty(this,"x",{enumerable:!0,get:function(){return te},set:function(ze){isNaN(ze)||(te=parseFloat(ze))}});var me=R||0;Object.defineProperty(this,"y",{enumerable:!0,get:function(){return me},set:function(ze){isNaN(ze)||(me=parseFloat(ze))}});var Ne="pt";return Object.defineProperty(this,"type",{enumerable:!0,get:function(){return Ne},set:function(ze){Ne=ze.toString()}}),this},Ha=function(x,R,te,me){$i.call(this,x,R),this.type="rect";var Ne=te||0;Object.defineProperty(this,"w",{enumerable:!0,get:function(){return Ne},set:function(Ge){isNaN(Ge)||(Ne=parseFloat(Ge))}});var ze=me||0;return Object.defineProperty(this,"h",{enumerable:!0,get:function(){return ze},set:function(Ge){isNaN(Ge)||(ze=parseFloat(Ge))}}),this},fa=function(){this.page=kt,this.currentPage=V,this.pages=ge.slice(0),this.pagesContext=gt.slice(0),this.x=nt,this.y=_t,this.matrix=At,this.width=Hr(V),this.height=_o(V),this.outputDestination=Ae,this.id="",this.objectNumber=-1};fa.prototype.restore=function(){kt=this.page,V=this.currentPage,gt=this.pagesContext,ge=this.pages,nt=this.x,_t=this.y,At=this.matrix,xo(V,this.width),Cs(V,this.height),Ae=this.outputDestination};var Ua=function(x,R,te,me,Ne){li.push(new fa),kt=V=0,ge=[],nt=x,_t=R,At=Ne,ws([te,me])};for(var br in d.beginFormObject=function(x,R,te,me,Ne){return Ua(x,R,te,me,Ne),this},d.endFormObject=function(x){return(function(R){if(Cn[R])li.pop().restore();else{var te=new fa,me="Xo"+(Object.keys(bn).length+1).toString(10);te.id=me,Cn[R]=me,bn[me]=te,Gt.publish("addFormObject",te),li.pop().restore()}})(x),this},d.doFormObject=function(x,R){var te=bn[Cn[x]];return K("q"),K(R.toString()+" cm"),K("/"+te.id+" Do"),K("Q"),this},d.getFormObject=function(x){var R=bn[Cn[x]];return{x:R.x,y:R.y,width:R.width,height:R.height,matrix:R.matrix}},d.save=function(x,R){return x=x||"generated.pdf",(R=R||{}).returnPromise=R.returnPromise||!1,R.returnPromise===!1?(yc(Er(fi()),x),typeof yc.unload=="function"&&an.setTimeout&&setTimeout(yc.unload,911),this):new Promise(function(te,me){try{var Ne=yc(Er(fi()),x);typeof yc.unload=="function"&&an.setTimeout&&setTimeout(yc.unload,911),te(Ne)}catch(ze){me(ze.message)}})},Ut.API)Ut.API.hasOwnProperty(br)&&(br==="events"&&Ut.API.events.length?(function(x,R){var te,me,Ne;for(Ne=R.length-1;Ne!==-1;Ne--)te=R[Ne][0],me=R[Ne][1],x.subscribe.apply(x,[te].concat(typeof me=="function"?[me]:me))})(Gt,Ut.API.events):d[br]=Ut.API[br]);function Hr(x){return gt[x].mediaBox.topRightX-gt[x].mediaBox.bottomLeftX}function xo(x,R){gt[x].mediaBox.topRightX=R+gt[x].mediaBox.bottomLeftX}function _o(x){return gt[x].mediaBox.topRightY-gt[x].mediaBox.bottomLeftY}function Cs(x,R){gt[x].mediaBox.topRightY=R+gt[x].mediaBox.bottomLeftY}var fr=d.getPageWidth=function(x){return Hr(x=x||V)/it},xe=d.setPageWidth=function(x,R){xo(x,R*it)},Ve=d.getPageHeight=function(x){return _o(x=x||V)/it},Ct=d.setPageHeight=function(x,R){Cs(x,R*it)};return d.internal={pdfEscape:Pr,getStyle:dr,getFont:Ss,getFontSize:We,getCharSpace:ac,getTextColor:Ws,getLineHeight:js,getLineHeightFactor:sc,getLineWidth:rc,write:Re,getHorizontalCoordinate:as,getVerticalCoordinate:As,getCoordinateString:Ns,getVerticalCoordinateString:Hs,collections:{},newObject:wn,newAdditionalObject:Ft,newObjectDeferred:je,newObjectDeferredBegin:tt,getFilters:Qt,putStream:rn,events:Gt,scaleFactor:it,pageSize:{getWidth:function(){return fr(V)},setWidth:function(x){xe(V,x)},getHeight:function(){return Ve(V)},setHeight:function(x){Ct(V,x)}},encryptionOptions:u,encryption:hi,getEncryptor:function(x){return u!==null?hi.encryptor(x,0):function(R){return R}},output:ml,getNumberOfPages:ua,get pages(){return ge},out:K,f2:C,f3:N,getPageInfo:ur,getPageInfoByObjId:yr,getCurrentPageInfo:vl,getPDFVersion:m,Point:$i,Rectangle:Ha,Matrix:Bt,hasHotfix:Ii},Object.defineProperty(d.internal.pageSize,"width",{get:function(){return fr(V)},set:function(x){xe(V,x)},enumerable:!0,configurable:!0}),Object.defineProperty(d.internal.pageSize,"height",{get:function(){return Ve(V)},set:function(x){Ct(V,x)},enumerable:!0,configurable:!0}),(function(x){for(var R=0,te=Be.length;R<te;R++){var me=zs.call(this,x[R][0],x[R][1],x[R][2],Be[R][3],!0);f===!1&&(p[me]=!0);var Ne=x[R][0].split("-");bs({id:me,fontName:Ne[0],fontStyle:Ne[1]||""})}Gt.publish("addFonts",{fonts:St,dictionary:st})}).call(d,Be),Le="F1",xs(r,n),Gt.publish("initialized"),d}uu.prototype.lsbFirstWord=function(t){return String.fromCharCode(255&t,t>>8&255,t>>16&255,t>>24&255)},uu.prototype.toHexString=function(t){return t.split("").map(function(e){return("0"+(255&e.charCodeAt(0)).toString(16)).slice(-2)}).join("")},uu.prototype.hexToBytes=function(t){for(var e=[],n=0;n<t.length;n+=2)e.push(String.fromCharCode(parseInt(t.substr(n,2),16)));return e.join("")},uu.prototype.processOwnerPassword=function(t,e){return o1(a1(e).substr(0,5),t)},uu.prototype.encryptor=function(t,e){var n=a1(this.encryptionKey+String.fromCharCode(255&t,t>>8&255,t>>16&255,255&e,e>>8&255)).substr(0,10);return function(i){return o1(n,i)}},Dc.prototype.equals=function(t){var e,n="id,objectNumber,equals";if(!t||Un(t)!==Un(this))return!1;var i=0;for(e in this)if(!(n.indexOf(e)>=0)){if(this.hasOwnProperty(e)&&!t.hasOwnProperty(e)||this[e]!==t[e])return!1;i++}for(e in t)t.hasOwnProperty(e)&&n.indexOf(e)<0&&i--;return i===0},Ut.API={events:[]},Ut.version="4.1.0";var Ni=Ut.API,N0=1,Uc=function(t){return t.replace(/\\/g,"\\\\").replace(/\(/g,"\\(").replace(/\)/g,"\\)")},iu=function(t){return t.replace(/\\\\/g,"\\").replace(/\\\(/g,"(").replace(/\\\)/g,")")},Qh=function(t){return t.toString().replace(/#/g,"#23").replace(/[\s\n\r()<>[\]{}\/%]/g,function(e){var n=e.charCodeAt(0).toString(16).toUpperCase();return"#"+(n.length===1?"0"+n:n)})},cn=function(t){return t.toFixed(2)},Rl=function(t){return t.toFixed(5)};Ni.__acroform__={};var ys=function(t,e){t.prototype=Object.create(e.prototype),t.prototype.constructor=t},Cy=function(t){return t*N0},no=function(t){var e=new a_,n=Et.internal.getHeight(t)||0,i=Et.internal.getWidth(t)||0;return e.BBox=[0,0,Number(cn(i)),Number(cn(n))],e},yF=Ni.__acroform__.setBit=function(t,e){if(t=t||0,e=e||0,isNaN(t)||isNaN(e))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.setBit");return t|1<<e},bF=Ni.__acroform__.clearBit=function(t,e){if(t=t||0,e=e||0,isNaN(t)||isNaN(e))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.clearBit");return t&~(1<<e)},wF=Ni.__acroform__.getBit=function(t,e){if(isNaN(t)||isNaN(e))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.getBit");return t&1<<e?1:0},Bi=Ni.__acroform__.getBitForPdf=function(t,e){if(isNaN(t)||isNaN(e))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.getBitForPdf");return wF(t,e-1)},zi=Ni.__acroform__.setBitForPdf=function(t,e){if(isNaN(t)||isNaN(e))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.setBitForPdf");return yF(t,e-1)},qi=Ni.__acroform__.clearBitForPdf=function(t,e){if(isNaN(t)||isNaN(e))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.clearBitForPdf");return bF(t,e-1)},xF=Ni.__acroform__.calculateCoordinates=function(t,e){var n=e.internal.getHorizontalCoordinate,i=e.internal.getVerticalCoordinate,r=t[0],s=t[1],a=t[2],o=t[3],l={};return l.lowerLeft_X=n(r)||0,l.lowerLeft_Y=i(s+o)||0,l.upperRight_X=n(r+a)||0,l.upperRight_Y=i(s)||0,[Number(cn(l.lowerLeft_X)),Number(cn(l.lowerLeft_Y)),Number(cn(l.upperRight_X)),Number(cn(l.upperRight_Y))]},_F=function(t){if(t.appearanceStreamContent)return t.appearanceStreamContent;if(t.V||t.DV){var e=[],n=t._V||t.DV,i=l1(t,n),r=t.scope.internal.getFont(t.fontName,t.fontStyle).id;e.push("/Tx BMC"),e.push("q"),e.push("BT"),e.push(t.scope.__private__.encodeColorString(t.color)),e.push("/"+r+" "+cn(i.fontSize)+" Tf"),e.push("1 0 0 1 0 0 Tm"),e.push(i.text),e.push("ET"),e.push("Q"),e.push("EMC");var s=no(t);return s.scope=t.scope,s.stream=e.join(`
`),s}},l1=function(t,e){var n=t.fontSize===0?t.maxFontSize:t.fontSize,i={text:"",fontSize:""},r=(e=(e=e.substr(0,1)=="("?e.substr(1):e).substr(e.length-1)==")"?e.substr(0,e.length-1):e).split(" ");r=t.multiline?r.map(function(C){return C.split(`
`)}):r.map(function(C){return[C]});var s=n,a=Et.internal.getHeight(t)||0;a=a<0?-a:a;var o=Et.internal.getWidth(t)||0;o=o<0?-o:o;var l=function(C,N,B){if(C+1<r.length){var P=N+" "+r[C+1][0];return Zf(P,t,B).width<=o-4}return!1};s++;e:for(;s>0;){e="",s--;var c,u,f=Zf("3",t,s).height,p=t.multiline?a-s:(a-f)/2,d=p+=2,y=0,m=0,w=0;if(s<=0){e=`(...) Tj
`,e+="% Width of Text: "+Zf(e,t,s=12).width+", FieldWidth:"+o+`
`;break}for(var b="",S=0,A=0;A<r.length;A++)if(r.hasOwnProperty(A)){var _=!1;if(r[A].length!==1&&w!==r[A].length-1){if((f+2)*(S+2)+2>a)continue e;b+=r[A][w],_=!0,m=A,A--}else{b=(b+=r[A][w]+" ").substr(b.length-1)==" "?b.substr(0,b.length-1):b;var I=parseInt(A),E=l(I,b,s),M=A>=r.length-1;if(E&&!M){b+=" ",w=0;continue}if(E||M){if(M)m=I;else if(t.multiline&&(f+2)*(S+2)+2>a)continue e}else{if(!t.multiline||(f+2)*(S+2)+2>a)continue e;m=I}}for(var T="",D=y;D<=m;D++){var U=r[D];if(t.multiline){if(D===m){T+=U[w]+" ",w=(w+1)%U.length;continue}if(D===y){T+=U[U.length-1]+" ";continue}}T+=U[0]+" "}switch(T=T.substr(T.length-1)==" "?T.substr(0,T.length-1):T,u=Zf(T,t,s).width,t.textAlign){case"right":c=o-u-2;break;case"center":c=(o-u)/2;break;default:c=2}e+=cn(c)+" "+cn(d)+` Td
`,e+="("+Uc(T)+`) Tj
`,e+=-cn(c)+` 0 Td
`,d=-(s+2),u=0,y=_?m:m+1,S++,b=""}break}return i.text=e,i.fontSize=s,i},Zf=function(t,e,n){var i=e.scope.internal.getFont(e.fontName,e.fontStyle),r=e.scope.getStringUnitWidth(t,{font:i,fontSize:parseFloat(n),charSpace:0})*parseFloat(n);return{height:e.scope.getStringUnitWidth("3",{font:i,fontSize:parseFloat(n),charSpace:0})*parseFloat(n)*1.5,width:r}},SF={fields:[],xForms:[],acroFormDictionaryRoot:null,printedOut:!1,internal:null,isInitialized:!1},kF=function(t,e){var n={type:"reference",object:t};e.internal.getPageInfo(t.page).pageContext.annotations.find(function(i){return i.type===n.type&&i.object===n.object})===void 0&&e.internal.getPageInfo(t.page).pageContext.annotations.push(n)},AF=function(t,e){if(e.scope=t,t.internal!==void 0&&(t.internal.acroformPlugin===void 0||t.internal.acroformPlugin.isInitialized===!1)){if(Fa.FieldNum=0,t.internal.acroformPlugin=JSON.parse(JSON.stringify(SF)),t.internal.acroformPlugin.acroFormDictionaryRoot)throw new Error("Exception while creating AcroformDictionary");N0=t.internal.scaleFactor,t.internal.acroformPlugin.acroFormDictionaryRoot=new o_,t.internal.acroformPlugin.acroFormDictionaryRoot.scope=t,t.internal.acroformPlugin.acroFormDictionaryRoot._eventID=t.internal.events.subscribe("postPutResources",function(){(function(n){n.internal.events.unsubscribe(n.internal.acroformPlugin.acroFormDictionaryRoot._eventID),delete n.internal.acroformPlugin.acroFormDictionaryRoot._eventID,n.internal.acroformPlugin.printedOut=!0})(t)}),t.internal.events.subscribe("buildDocument",function(){(function(n){n.internal.acroformPlugin.acroFormDictionaryRoot.objId=void 0;var i=n.internal.acroformPlugin.acroFormDictionaryRoot.Fields;for(var r in i)if(i.hasOwnProperty(r)){var s=i[r];s.objId=void 0,s.hasAnnotation&&kF(s,n)}})(t)}),t.internal.events.subscribe("putCatalog",function(){(function(n){if(n.internal.acroformPlugin.acroFormDictionaryRoot===void 0)throw new Error("putCatalogCallback: Root missing.");n.internal.write("/AcroForm "+n.internal.acroformPlugin.acroFormDictionaryRoot.objId+" 0 R")})(t)}),t.internal.events.subscribe("postPutPages",function(n){(function(i,r){var s=!i;for(var a in i||(r.internal.newObjectDeferredBegin(r.internal.acroformPlugin.acroFormDictionaryRoot.objId,!0),r.internal.acroformPlugin.acroFormDictionaryRoot.putStream()),i=i||r.internal.acroformPlugin.acroFormDictionaryRoot.Kids)if(i.hasOwnProperty(a)){var o=i[a],l=[],c=o.Rect;if(o.Rect&&(o.Rect=xF(o.Rect,r)),r.internal.newObjectDeferredBegin(o.objId,!0),o.DA=Et.createDefaultAppearanceStream(o),Un(o)==="object"&&typeof o.getKeyValueListForStream=="function"&&(l=o.getKeyValueListForStream()),o.Rect=c,o.hasAppearanceStream&&!o.appearanceStreamContent){var u=_F(o);l.push({key:"AP",value:"<</N "+u+">>"}),r.internal.acroformPlugin.xForms.push(u)}if(o.appearanceStreamContent){var f="";for(var p in o.appearanceStreamContent)if(o.appearanceStreamContent.hasOwnProperty(p)){var d=o.appearanceStreamContent[p];if(f+="/"+p+" ",f+="<<",Object.keys(d).length>=1||Array.isArray(d)){for(var a in d)if(d.hasOwnProperty(a)){var y=d[a];typeof y=="function"&&(y=y.call(r,o)),f+="/"+a+" "+y+" ",r.internal.acroformPlugin.xForms.indexOf(y)>=0||r.internal.acroformPlugin.xForms.push(y)}}else typeof(y=d)=="function"&&(y=y.call(r,o)),f+="/"+a+" "+y,r.internal.acroformPlugin.xForms.indexOf(y)>=0||r.internal.acroformPlugin.xForms.push(y);f+=">>"}l.push({key:"AP",value:`<<
`+f+">>"})}r.internal.putStream({additionalKeyValues:l,objectId:o.objId}),r.internal.out("endobj")}s&&(function(m,w){for(var b in m)if(m.hasOwnProperty(b)){var S=b,A=m[b];w.internal.newObjectDeferredBegin(A.objId,!0),Un(A)==="object"&&typeof A.putStream=="function"&&A.putStream(),delete m[S]}})(r.internal.acroformPlugin.xForms,r)})(n,t)}),t.internal.acroformPlugin.isInitialized=!0}},s_=Ni.__acroform__.arrayToPdfArray=function(t,e,n){var i=function(a){return a};if(Array.isArray(t)){for(var r="[",s=0;s<t.length;s++)switch(s!==0&&(r+=" "),Un(t[s])){case"boolean":case"number":case"object":r+=t[s].toString();break;case"string":t[s].substr(0,1)==="/"?r+="/"+Qh(t[s].substr(1)):(e!==void 0&&n&&(i=n.internal.getEncryptor(e)),r+="("+Uc(i(t[s].toString()))+")")}return r+"]"}throw new Error("Invalid argument passed to jsPDF.__acroform__.arrayToPdfArray")},$g=function(t,e,n){var i=function(r){return r};return e!==void 0&&n&&(i=n.internal.getEncryptor(e)),(t=t||"").toString(),"("+Uc(i(t))+")"},lo=function(){this._objId=void 0,this._scope=void 0,Object.defineProperty(this,"objId",{get:function(){if(this._objId===void 0){if(this.scope===void 0)return;this._objId=this.scope.internal.newObjectDeferred()}return this._objId},set:function(t){this._objId=t}}),Object.defineProperty(this,"scope",{value:this._scope,writable:!0})};lo.prototype.toString=function(){return this.objId+" 0 R"},lo.prototype.putStream=function(){var t=this.getKeyValueListForStream();this.scope.internal.putStream({data:this.stream,additionalKeyValues:t,objectId:this.objId}),this.scope.internal.out("endobj")},lo.prototype.getKeyValueListForStream=function(){var t=[],e=Object.getOwnPropertyNames(this).filter(function(s){return s!="content"&&s!="appearanceStreamContent"&&s!="scope"&&s!="objId"&&s.substring(0,1)!="_"});for(var n in e)if(Object.getOwnPropertyDescriptor(this,e[n]).configurable===!1){var i=e[n],r=this[i];r&&(Array.isArray(r)?t.push({key:i,value:s_(r,this.objId,this.scope)}):r instanceof lo?(r.scope=this.scope,t.push({key:i,value:r.objId+" 0 R"})):typeof r!="function"&&t.push({key:i,value:r}))}return t};var a_=function(){lo.call(this),Object.defineProperty(this,"Type",{value:"/XObject",configurable:!1,writable:!0}),Object.defineProperty(this,"Subtype",{value:"/Form",configurable:!1,writable:!0}),Object.defineProperty(this,"FormType",{value:1,configurable:!1,writable:!0});var t,e=[];Object.defineProperty(this,"BBox",{configurable:!1,get:function(){return e},set:function(n){e=n}}),Object.defineProperty(this,"Resources",{value:"2 0 R",configurable:!1,writable:!0}),Object.defineProperty(this,"stream",{enumerable:!1,configurable:!0,set:function(n){t=n.trim()},get:function(){return t||null}})};ys(a_,lo);var o_=function(){lo.call(this);var t,e=[];Object.defineProperty(this,"Kids",{enumerable:!1,configurable:!0,get:function(){return e.length>0?e:void 0}}),Object.defineProperty(this,"Fields",{enumerable:!1,configurable:!1,get:function(){return e}}),Object.defineProperty(this,"DA",{enumerable:!1,configurable:!1,get:function(){if(t){var n=function(i){return i};return this.scope&&(n=this.scope.internal.getEncryptor(this.objId)),"("+Uc(n(t))+")"}},set:function(n){t=n}})};ys(o_,lo);var Fa=function t(){lo.call(this);var e=4;Object.defineProperty(this,"F",{enumerable:!1,configurable:!1,get:function(){return e},set:function(b){if(isNaN(b))throw new Error('Invalid value "'+b+'" for attribute F supplied.');e=b}}),Object.defineProperty(this,"showWhenPrinted",{enumerable:!0,configurable:!0,get:function(){return!!Bi(e,3)},set:function(b){b?this.F=zi(e,3):this.F=qi(e,3)}});var n=0;Object.defineProperty(this,"Ff",{enumerable:!1,configurable:!1,get:function(){return n},set:function(b){if(isNaN(b))throw new Error('Invalid value "'+b+'" for attribute Ff supplied.');n=b}});var i=[];Object.defineProperty(this,"Rect",{enumerable:!1,configurable:!1,get:function(){if(i.length!==0)return i},set:function(b){i=b!==void 0?b:[]}}),Object.defineProperty(this,"x",{enumerable:!0,configurable:!0,get:function(){return!i||isNaN(i[0])?0:i[0]},set:function(b){i[0]=b}}),Object.defineProperty(this,"y",{enumerable:!0,configurable:!0,get:function(){return!i||isNaN(i[1])?0:i[1]},set:function(b){i[1]=b}}),Object.defineProperty(this,"width",{enumerable:!0,configurable:!0,get:function(){return!i||isNaN(i[2])?0:i[2]},set:function(b){i[2]=b}}),Object.defineProperty(this,"height",{enumerable:!0,configurable:!0,get:function(){return!i||isNaN(i[3])?0:i[3]},set:function(b){i[3]=b}});var r="";Object.defineProperty(this,"FT",{enumerable:!0,configurable:!1,get:function(){return r},set:function(b){switch(b){case"/Btn":case"/Tx":case"/Ch":case"/Sig":r=b;break;default:throw new Error('Invalid value "'+b+'" for attribute FT supplied.')}}});var s=null;Object.defineProperty(this,"T",{enumerable:!0,configurable:!1,get:function(){if(!s||s.length<1){if(this instanceof $h)return;s="FieldObject"+t.FieldNum++}var b=function(S){return S};return this.scope&&(b=this.scope.internal.getEncryptor(this.objId)),"("+Uc(b(s))+")"},set:function(b){s=b.toString()}}),Object.defineProperty(this,"fieldName",{configurable:!0,enumerable:!0,get:function(){return s},set:function(b){s=b}});var a="helvetica";Object.defineProperty(this,"fontName",{enumerable:!0,configurable:!0,get:function(){return a},set:function(b){a=b}});var o="normal";Object.defineProperty(this,"fontStyle",{enumerable:!0,configurable:!0,get:function(){return o},set:function(b){o=b}});var l=0;Object.defineProperty(this,"fontSize",{enumerable:!0,configurable:!0,get:function(){return l},set:function(b){l=b}});var c=void 0;Object.defineProperty(this,"maxFontSize",{enumerable:!0,configurable:!0,get:function(){return c===void 0?50/N0:c},set:function(b){c=b}});var u="black";Object.defineProperty(this,"color",{enumerable:!0,configurable:!0,get:function(){return u},set:function(b){u=b}});var f="/F1 0 Tf 0 g";Object.defineProperty(this,"DA",{enumerable:!0,configurable:!1,get:function(){if(!(!f||this instanceof $h||this instanceof Ac))return $g(f,this.objId,this.scope)},set:function(b){b=b.toString(),f=b}});var p=null;Object.defineProperty(this,"DV",{enumerable:!1,configurable:!1,get:function(){if(p)return this instanceof vr==0?$g(p,this.objId,this.scope):p},set:function(b){b=b.toString(),p=this instanceof vr==0?b.substr(0,1)==="("?iu(b.substr(1,b.length-2)):iu(b):b}}),Object.defineProperty(this,"defaultValue",{enumerable:!0,configurable:!0,get:function(){return this instanceof vr==1?iu(p.substr(1,p.length-1)):p},set:function(b){b=b.toString(),p=this instanceof vr==1?"/"+Qh(b):b}});var d=null;Object.defineProperty(this,"_V",{enumerable:!1,configurable:!1,get:function(){if(d)return d},set:function(b){this.V=b}}),Object.defineProperty(this,"V",{enumerable:!1,configurable:!1,get:function(){if(d)return this instanceof vr==0?$g(d,this.objId,this.scope):d},set:function(b){b=b.toString(),d=this instanceof vr==0?b.substr(0,1)==="("?iu(b.substr(1,b.length-2)):iu(b):b}}),Object.defineProperty(this,"value",{enumerable:!0,configurable:!0,get:function(){return this instanceof vr==1?iu(d.substr(1,d.length-1)):d},set:function(b){b=b.toString(),d=this instanceof vr==1?"/"+Qh(b):b}}),Object.defineProperty(this,"hasAnnotation",{enumerable:!0,configurable:!0,get:function(){return this.Rect}}),Object.defineProperty(this,"Type",{enumerable:!0,configurable:!1,get:function(){return this.hasAnnotation?"/Annot":null}}),Object.defineProperty(this,"Subtype",{enumerable:!0,configurable:!1,get:function(){return this.hasAnnotation?"/Widget":null}});var y,m=!1;Object.defineProperty(this,"hasAppearanceStream",{enumerable:!0,configurable:!0,get:function(){return m},set:function(b){b=!!b,m=b}}),Object.defineProperty(this,"page",{enumerable:!0,configurable:!0,get:function(){if(y)return y},set:function(b){y=b}}),Object.defineProperty(this,"readOnly",{enumerable:!0,configurable:!0,get:function(){return!!Bi(this.Ff,1)},set:function(b){b?this.Ff=zi(this.Ff,1):this.Ff=qi(this.Ff,1)}}),Object.defineProperty(this,"required",{enumerable:!0,configurable:!0,get:function(){return!!Bi(this.Ff,2)},set:function(b){b?this.Ff=zi(this.Ff,2):this.Ff=qi(this.Ff,2)}}),Object.defineProperty(this,"noExport",{enumerable:!0,configurable:!0,get:function(){return!!Bi(this.Ff,3)},set:function(b){b?this.Ff=zi(this.Ff,3):this.Ff=qi(this.Ff,3)}});var w=null;Object.defineProperty(this,"Q",{enumerable:!0,configurable:!1,get:function(){if(w!==null)return w},set:function(b){if([0,1,2].indexOf(b)===-1)throw new Error('Invalid value "'+b+'" for attribute Q supplied.');w=b}}),Object.defineProperty(this,"textAlign",{get:function(){var b;switch(w){case 0:default:b="left";break;case 1:b="center";break;case 2:b="right"}return b},configurable:!0,enumerable:!0,set:function(b){switch(b){case"right":case 2:w=2;break;case"center":case 1:w=1;break;default:w=0}}})};ys(Fa,lo);var Su=function(){Fa.call(this),this.FT="/Ch",this.V="()",this.fontName="zapfdingbats";var t=0;Object.defineProperty(this,"TI",{enumerable:!0,configurable:!1,get:function(){return t},set:function(n){t=n}}),Object.defineProperty(this,"topIndex",{enumerable:!0,configurable:!0,get:function(){return t},set:function(n){t=n}});var e=[];Object.defineProperty(this,"Opt",{enumerable:!0,configurable:!1,get:function(){return s_(e,this.objId,this.scope)},set:function(n){var i,r;r=[],typeof(i=n)=="string"&&(r=(function(s,a,o){o||(o=1);for(var l,c=[];l=a.exec(s);)c.push(l[o]);return c})(i,/\((.*?)\)/g)),e=r}}),this.getOptions=function(){return e},this.setOptions=function(n){e=n,this.sort&&e.sort()},this.addOption=function(n){n=(n=n||"").toString(),e.push(n),this.sort&&e.sort()},this.removeOption=function(n,i){for(i=i||!1,n=(n=n||"").toString();e.indexOf(n)!==-1&&(e.splice(e.indexOf(n),1),i!==!1););},Object.defineProperty(this,"combo",{enumerable:!0,configurable:!0,get:function(){return!!Bi(this.Ff,18)},set:function(n){n?this.Ff=zi(this.Ff,18):this.Ff=qi(this.Ff,18)}}),Object.defineProperty(this,"edit",{enumerable:!0,configurable:!0,get:function(){return!!Bi(this.Ff,19)},set:function(n){this.combo===!0&&(n?this.Ff=zi(this.Ff,19):this.Ff=qi(this.Ff,19))}}),Object.defineProperty(this,"sort",{enumerable:!0,configurable:!0,get:function(){return!!Bi(this.Ff,20)},set:function(n){n?(this.Ff=zi(this.Ff,20),e.sort()):this.Ff=qi(this.Ff,20)}}),Object.defineProperty(this,"multiSelect",{enumerable:!0,configurable:!0,get:function(){return!!Bi(this.Ff,22)},set:function(n){n?this.Ff=zi(this.Ff,22):this.Ff=qi(this.Ff,22)}}),Object.defineProperty(this,"doNotSpellCheck",{enumerable:!0,configurable:!0,get:function(){return!!Bi(this.Ff,23)},set:function(n){n?this.Ff=zi(this.Ff,23):this.Ff=qi(this.Ff,23)}}),Object.defineProperty(this,"commitOnSelChange",{enumerable:!0,configurable:!0,get:function(){return!!Bi(this.Ff,27)},set:function(n){n?this.Ff=zi(this.Ff,27):this.Ff=qi(this.Ff,27)}}),this.hasAppearanceStream=!1};ys(Su,Fa);var ku=function(){Su.call(this),this.fontName="helvetica",this.combo=!1};ys(ku,Su);var Au=function(){ku.call(this),this.combo=!0};ys(Au,ku);var vh=function(){Au.call(this),this.edit=!0};ys(vh,Au);var vr=function(){Fa.call(this),this.FT="/Btn",Object.defineProperty(this,"noToggleToOff",{enumerable:!0,configurable:!0,get:function(){return!!Bi(this.Ff,15)},set:function(n){n?this.Ff=zi(this.Ff,15):this.Ff=qi(this.Ff,15)}}),Object.defineProperty(this,"radio",{enumerable:!0,configurable:!0,get:function(){return!!Bi(this.Ff,16)},set:function(n){n?this.Ff=zi(this.Ff,16):this.Ff=qi(this.Ff,16)}}),Object.defineProperty(this,"pushButton",{enumerable:!0,configurable:!0,get:function(){return!!Bi(this.Ff,17)},set:function(n){n?this.Ff=zi(this.Ff,17):this.Ff=qi(this.Ff,17)}}),Object.defineProperty(this,"radioIsUnison",{enumerable:!0,configurable:!0,get:function(){return!!Bi(this.Ff,26)},set:function(n){n?this.Ff=zi(this.Ff,26):this.Ff=qi(this.Ff,26)}});var t,e={};Object.defineProperty(this,"MK",{enumerable:!1,configurable:!1,get:function(){var n=function(s){return s};if(this.scope&&(n=this.scope.internal.getEncryptor(this.objId)),Object.keys(e).length!==0){var i,r=[];for(i in r.push("<<"),e)r.push("/"+i+" ("+Uc(n(e[i]))+")");return r.push(">>"),r.join(`
`)}},set:function(n){Un(n)==="object"&&(e=n)}}),Object.defineProperty(this,"caption",{enumerable:!0,configurable:!0,get:function(){return e.CA||""},set:function(n){typeof n=="string"&&(e.CA=n)}}),Object.defineProperty(this,"AS",{enumerable:!1,configurable:!1,get:function(){return t},set:function(n){t=n}}),Object.defineProperty(this,"appearanceState",{enumerable:!0,configurable:!0,get:function(){return t.substr(1,t.length-1)},set:function(n){t="/"+Qh(n)}})};ys(vr,Fa);var yh=function(){vr.call(this),this.pushButton=!0};ys(yh,vr);var Nu=function(){vr.call(this),this.radio=!0,this.pushButton=!1;var t=[];Object.defineProperty(this,"Kids",{enumerable:!0,configurable:!1,get:function(){return t},set:function(e){t=e!==void 0?e:[]}})};ys(Nu,vr);var $h=function(){var t,e;Fa.call(this),Object.defineProperty(this,"Parent",{enumerable:!1,configurable:!1,get:function(){return t},set:function(r){t=r}}),Object.defineProperty(this,"optionName",{enumerable:!1,configurable:!0,get:function(){return e},set:function(r){e=r}});var n,i={};Object.defineProperty(this,"MK",{enumerable:!1,configurable:!1,get:function(){var r=function(o){return o};this.scope&&(r=this.scope.internal.getEncryptor(this.objId));var s,a=[];for(s in a.push("<<"),i)a.push("/"+s+" ("+Uc(r(i[s]))+")");return a.push(">>"),a.join(`
`)},set:function(r){Un(r)==="object"&&(i=r)}}),Object.defineProperty(this,"caption",{enumerable:!0,configurable:!0,get:function(){return i.CA||""},set:function(r){typeof r=="string"&&(i.CA=r)}}),Object.defineProperty(this,"AS",{enumerable:!1,configurable:!1,get:function(){return n},set:function(r){n=r}}),Object.defineProperty(this,"appearanceState",{enumerable:!0,configurable:!0,get:function(){return n.substr(1,n.length-1)},set:function(r){n="/"+r}}),this.caption="l",this.appearanceState="Off",this._AppearanceType=Et.RadioButton.Circle,this.appearanceStreamContent=this._AppearanceType.createAppearanceStream(this.optionName)};ys($h,Fa),Nu.prototype.setAppearance=function(t){if(!("createAppearanceStream"in t)||!("getCA"in t))throw new Error("Couldn't assign Appearance to RadioButton. Appearance was Invalid!");for(var e in this.Kids)if(this.Kids.hasOwnProperty(e)){var n=this.Kids[e];n.appearanceStreamContent=t.createAppearanceStream(n.optionName),n.caption=t.getCA()}},Nu.prototype.createOption=function(t){var e=new $h;return e.Parent=this,e.optionName=t,this.Kids.push(e),NF.call(this.scope,e),e};var bh=function(){vr.call(this),this.fontName="zapfdingbats",this.caption="3",this.appearanceState="On",this.value="On",this.textAlign="center",this.appearanceStreamContent=Et.CheckBox.createAppearanceStream()};ys(bh,vr);var Ac=function(){Fa.call(this),this.FT="/Tx",Object.defineProperty(this,"multiline",{enumerable:!0,configurable:!0,get:function(){return!!Bi(this.Ff,13)},set:function(e){e?this.Ff=zi(this.Ff,13):this.Ff=qi(this.Ff,13)}}),Object.defineProperty(this,"fileSelect",{enumerable:!0,configurable:!0,get:function(){return!!Bi(this.Ff,21)},set:function(e){e?this.Ff=zi(this.Ff,21):this.Ff=qi(this.Ff,21)}}),Object.defineProperty(this,"doNotSpellCheck",{enumerable:!0,configurable:!0,get:function(){return!!Bi(this.Ff,23)},set:function(e){e?this.Ff=zi(this.Ff,23):this.Ff=qi(this.Ff,23)}}),Object.defineProperty(this,"doNotScroll",{enumerable:!0,configurable:!0,get:function(){return!!Bi(this.Ff,24)},set:function(e){e?this.Ff=zi(this.Ff,24):this.Ff=qi(this.Ff,24)}}),Object.defineProperty(this,"comb",{enumerable:!0,configurable:!0,get:function(){return!!Bi(this.Ff,25)},set:function(e){e?this.Ff=zi(this.Ff,25):this.Ff=qi(this.Ff,25)}}),Object.defineProperty(this,"richText",{enumerable:!0,configurable:!0,get:function(){return!!Bi(this.Ff,26)},set:function(e){e?this.Ff=zi(this.Ff,26):this.Ff=qi(this.Ff,26)}});var t=null;Object.defineProperty(this,"MaxLen",{enumerable:!0,configurable:!1,get:function(){return t},set:function(e){t=e}}),Object.defineProperty(this,"maxLength",{enumerable:!0,configurable:!0,get:function(){return t},set:function(e){Number.isInteger(e)&&(t=e)}}),Object.defineProperty(this,"hasAppearanceStream",{enumerable:!0,configurable:!0,get:function(){return this.V||this.DV}})};ys(Ac,Fa);var wh=function(){Ac.call(this),Object.defineProperty(this,"password",{enumerable:!0,configurable:!0,get:function(){return!!Bi(this.Ff,14)},set:function(t){t?this.Ff=zi(this.Ff,14):this.Ff=qi(this.Ff,14)}}),this.password=!0};ys(wh,Ac);var Et={CheckBox:{createAppearanceStream:function(){return{N:{On:Et.CheckBox.YesNormal},D:{On:Et.CheckBox.YesPushDown,Off:Et.CheckBox.OffPushDown}}},YesPushDown:function(t){var e=no(t);e.scope=t.scope;var n=[],i=t.scope.internal.getFont(t.fontName,t.fontStyle).id,r=t.scope.__private__.encodeColorString(t.color),s=l1(t,t.caption);return n.push("0.749023 g"),n.push("0 0 "+cn(Et.internal.getWidth(t))+" "+cn(Et.internal.getHeight(t))+" re"),n.push("f"),n.push("BMC"),n.push("q"),n.push("0 0 1 rg"),n.push("/"+i+" "+cn(s.fontSize)+" Tf "+r),n.push("BT"),n.push(s.text),n.push("ET"),n.push("Q"),n.push("EMC"),e.stream=n.join(`
`),e},YesNormal:function(t){var e=no(t);e.scope=t.scope;var n=t.scope.internal.getFont(t.fontName,t.fontStyle).id,i=t.scope.__private__.encodeColorString(t.color),r=[],s=Et.internal.getHeight(t),a=Et.internal.getWidth(t),o=l1(t,t.caption);return r.push("1 g"),r.push("0 0 "+cn(a)+" "+cn(s)+" re"),r.push("f"),r.push("q"),r.push("0 0 1 rg"),r.push("0 0 "+cn(a-1)+" "+cn(s-1)+" re"),r.push("W"),r.push("n"),r.push("0 g"),r.push("BT"),r.push("/"+n+" "+cn(o.fontSize)+" Tf "+i),r.push(o.text),r.push("ET"),r.push("Q"),e.stream=r.join(`
`),e},OffPushDown:function(t){var e=no(t);e.scope=t.scope;var n=[];return n.push("0.749023 g"),n.push("0 0 "+cn(Et.internal.getWidth(t))+" "+cn(Et.internal.getHeight(t))+" re"),n.push("f"),e.stream=n.join(`
`),e}},RadioButton:{Circle:{createAppearanceStream:function(t){var e={D:{Off:Et.RadioButton.Circle.OffPushDown},N:{}};return e.N[t]=Et.RadioButton.Circle.YesNormal,e.D[t]=Et.RadioButton.Circle.YesPushDown,e},getCA:function(){return"l"},YesNormal:function(t){var e=no(t);e.scope=t.scope;var n=[],i=Et.internal.getWidth(t)<=Et.internal.getHeight(t)?Et.internal.getWidth(t)/4:Et.internal.getHeight(t)/4;i=Number((.9*i).toFixed(5));var r=Et.internal.Bezier_C,s=Number((i*r).toFixed(5));return n.push("q"),n.push("1 0 0 1 "+Rl(Et.internal.getWidth(t)/2)+" "+Rl(Et.internal.getHeight(t)/2)+" cm"),n.push(i+" 0 m"),n.push(i+" "+s+" "+s+" "+i+" 0 "+i+" c"),n.push("-"+s+" "+i+" -"+i+" "+s+" -"+i+" 0 c"),n.push("-"+i+" -"+s+" -"+s+" -"+i+" 0 -"+i+" c"),n.push(s+" -"+i+" "+i+" -"+s+" "+i+" 0 c"),n.push("f"),n.push("Q"),e.stream=n.join(`
`),e},YesPushDown:function(t){var e=no(t);e.scope=t.scope;var n=[],i=Et.internal.getWidth(t)<=Et.internal.getHeight(t)?Et.internal.getWidth(t)/4:Et.internal.getHeight(t)/4;i=Number((.9*i).toFixed(5));var r=Number((2*i).toFixed(5)),s=Number((r*Et.internal.Bezier_C).toFixed(5)),a=Number((i*Et.internal.Bezier_C).toFixed(5));return n.push("0.749023 g"),n.push("q"),n.push("1 0 0 1 "+Rl(Et.internal.getWidth(t)/2)+" "+Rl(Et.internal.getHeight(t)/2)+" cm"),n.push(r+" 0 m"),n.push(r+" "+s+" "+s+" "+r+" 0 "+r+" c"),n.push("-"+s+" "+r+" -"+r+" "+s+" -"+r+" 0 c"),n.push("-"+r+" -"+s+" -"+s+" -"+r+" 0 -"+r+" c"),n.push(s+" -"+r+" "+r+" -"+s+" "+r+" 0 c"),n.push("f"),n.push("Q"),n.push("0 g"),n.push("q"),n.push("1 0 0 1 "+Rl(Et.internal.getWidth(t)/2)+" "+Rl(Et.internal.getHeight(t)/2)+" cm"),n.push(i+" 0 m"),n.push(i+" "+a+" "+a+" "+i+" 0 "+i+" c"),n.push("-"+a+" "+i+" -"+i+" "+a+" -"+i+" 0 c"),n.push("-"+i+" -"+a+" -"+a+" -"+i+" 0 -"+i+" c"),n.push(a+" -"+i+" "+i+" -"+a+" "+i+" 0 c"),n.push("f"),n.push("Q"),e.stream=n.join(`
`),e},OffPushDown:function(t){var e=no(t);e.scope=t.scope;var n=[],i=Et.internal.getWidth(t)<=Et.internal.getHeight(t)?Et.internal.getWidth(t)/4:Et.internal.getHeight(t)/4;i=Number((.9*i).toFixed(5));var r=Number((2*i).toFixed(5)),s=Number((r*Et.internal.Bezier_C).toFixed(5));return n.push("0.749023 g"),n.push("q"),n.push("1 0 0 1 "+Rl(Et.internal.getWidth(t)/2)+" "+Rl(Et.internal.getHeight(t)/2)+" cm"),n.push(r+" 0 m"),n.push(r+" "+s+" "+s+" "+r+" 0 "+r+" c"),n.push("-"+s+" "+r+" -"+r+" "+s+" -"+r+" 0 c"),n.push("-"+r+" -"+s+" -"+s+" -"+r+" 0 -"+r+" c"),n.push(s+" -"+r+" "+r+" -"+s+" "+r+" 0 c"),n.push("f"),n.push("Q"),e.stream=n.join(`
`),e}},Cross:{createAppearanceStream:function(t){var e={D:{Off:Et.RadioButton.Cross.OffPushDown},N:{}};return e.N[t]=Et.RadioButton.Cross.YesNormal,e.D[t]=Et.RadioButton.Cross.YesPushDown,e},getCA:function(){return"8"},YesNormal:function(t){var e=no(t);e.scope=t.scope;var n=[],i=Et.internal.calculateCross(t);return n.push("q"),n.push("1 1 "+cn(Et.internal.getWidth(t)-2)+" "+cn(Et.internal.getHeight(t)-2)+" re"),n.push("W"),n.push("n"),n.push(cn(i.x1.x)+" "+cn(i.x1.y)+" m"),n.push(cn(i.x2.x)+" "+cn(i.x2.y)+" l"),n.push(cn(i.x4.x)+" "+cn(i.x4.y)+" m"),n.push(cn(i.x3.x)+" "+cn(i.x3.y)+" l"),n.push("s"),n.push("Q"),e.stream=n.join(`
`),e},YesPushDown:function(t){var e=no(t);e.scope=t.scope;var n=Et.internal.calculateCross(t),i=[];return i.push("0.749023 g"),i.push("0 0 "+cn(Et.internal.getWidth(t))+" "+cn(Et.internal.getHeight(t))+" re"),i.push("f"),i.push("q"),i.push("1 1 "+cn(Et.internal.getWidth(t)-2)+" "+cn(Et.internal.getHeight(t)-2)+" re"),i.push("W"),i.push("n"),i.push(cn(n.x1.x)+" "+cn(n.x1.y)+" m"),i.push(cn(n.x2.x)+" "+cn(n.x2.y)+" l"),i.push(cn(n.x4.x)+" "+cn(n.x4.y)+" m"),i.push(cn(n.x3.x)+" "+cn(n.x3.y)+" l"),i.push("s"),i.push("Q"),e.stream=i.join(`
`),e},OffPushDown:function(t){var e=no(t);e.scope=t.scope;var n=[];return n.push("0.749023 g"),n.push("0 0 "+cn(Et.internal.getWidth(t))+" "+cn(Et.internal.getHeight(t))+" re"),n.push("f"),e.stream=n.join(`
`),e}}},createDefaultAppearanceStream:function(t){var e=t.scope.internal.getFont(t.fontName,t.fontStyle).id,n=t.scope.__private__.encodeColorString(t.color);return"/"+e+" "+t.fontSize+" Tf "+n}};Et.internal={Bezier_C:.551915024494,calculateCross:function(t){var e=Et.internal.getWidth(t),n=Et.internal.getHeight(t),i=Math.min(e,n);return{x1:{x:(e-i)/2,y:(n-i)/2+i},x2:{x:(e-i)/2+i,y:(n-i)/2},x3:{x:(e-i)/2,y:(n-i)/2},x4:{x:(e-i)/2+i,y:(n-i)/2+i}}}},Et.internal.getWidth=function(t){var e=0;return Un(t)==="object"&&(e=Cy(t.Rect[2])),e},Et.internal.getHeight=function(t){var e=0;return Un(t)==="object"&&(e=Cy(t.Rect[3])),e};var NF=Ni.addField=function(t){if(AF(this,t),!(t instanceof Fa))throw new Error("Invalid argument passed to jsPDF.addField.");var e;return(e=t).scope.internal.acroformPlugin.printedOut&&(e.scope.internal.acroformPlugin.printedOut=!1,e.scope.internal.acroformPlugin.acroFormDictionaryRoot=null),e.scope.internal.acroformPlugin.acroFormDictionaryRoot.Fields.push(e),t.page=t.scope.internal.getCurrentPageInfo().pageNumber,this};Ni.AcroFormChoiceField=Su,Ni.AcroFormListBox=ku,Ni.AcroFormComboBox=Au,Ni.AcroFormEditBox=vh,Ni.AcroFormButton=vr,Ni.AcroFormPushButton=yh,Ni.AcroFormRadioButton=Nu,Ni.AcroFormCheckBox=bh,Ni.AcroFormTextField=Ac,Ni.AcroFormPasswordField=wh,Ni.AcroFormAppearance=Et,Ni.AcroForm={ChoiceField:Su,ListBox:ku,ComboBox:Au,EditBox:vh,Button:vr,PushButton:yh,RadioButton:Nu,CheckBox:bh,TextField:Ac,PasswordField:wh,Appearance:Et},Ut.AcroForm={ChoiceField:Su,ListBox:ku,ComboBox:Au,EditBox:vh,Button:vr,PushButton:yh,RadioButton:Nu,CheckBox:bh,TextField:Ac,PasswordField:wh,Appearance:Et};Ut.AcroForm;function l_(t){return t.reduce(function(e,n,i){return e[n]=i,e},{})}(function(t){var e="addImage_";t.__addimage__={};var n="UNKNOWN",i={PNG:[[137,80,78,71]],TIFF:[[77,77,0,42],[73,73,42,0]],JPEG:[[255,216,255,224,void 0,void 0,74,70,73,70,0],[255,216,255,225,void 0,void 0,69,120,105,102,0,0],[255,216,255,219],[255,216,255,238]],JPEG2000:[[0,0,0,12,106,80,32,32]],GIF87a:[[71,73,70,56,55,97]],GIF89a:[[71,73,70,56,57,97]],WEBP:[[82,73,70,70,void 0,void 0,void 0,void 0,87,69,66,80]],BMP:[[66,77],[66,65],[67,73],[67,80],[73,67],[80,84]]},r=t.__addimage__.getImageFileTypeByImageData=function(C,N){var B,P,F,q,Z,W=n;if((N=N||n)==="RGBA"||C.data!==void 0&&C.data instanceof Uint8ClampedArray&&"height"in C&&"width"in C)return"RGBA";if(E(C))for(Z in i)for(F=i[Z],B=0;B<F.length;B+=1){for(q=!0,P=0;P<F[B].length;P+=1)if(F[B][P]!==void 0&&F[B][P]!==C[P]){q=!1;break}if(q===!0){W=Z;break}}else for(Z in i)for(F=i[Z],B=0;B<F.length;B+=1){for(q=!0,P=0;P<F[B].length;P+=1)if(F[B][P]!==void 0&&F[B][P]!==C.charCodeAt(P)){q=!1;break}if(q===!0){W=Z;break}}return W===n&&N!==n&&(W=N),W},s=function C(N){for(var B=this.internal.write,P=this.internal.putStream,F=(0,this.internal.getFilters)();F.indexOf("FlateEncode")!==-1;)F.splice(F.indexOf("FlateEncode"),1);N.objectId=this.internal.newObject();var q=[];if(q.push({key:"Type",value:"/XObject"}),q.push({key:"Subtype",value:"/Image"}),q.push({key:"Width",value:N.width}),q.push({key:"Height",value:N.height}),N.colorSpace===b.INDEXED?q.push({key:"ColorSpace",value:"[/Indexed /DeviceRGB "+(N.palette.length/3-1)+" "+("sMask"in N&&N.sMask!==void 0?N.objectId+2:N.objectId+1)+" 0 R]"}):(q.push({key:"ColorSpace",value:"/"+N.colorSpace}),N.colorSpace===b.DEVICE_CMYK&&q.push({key:"Decode",value:"[1 0 1 0 1 0 1 0]"})),q.push({key:"BitsPerComponent",value:N.bitsPerComponent}),"decodeParameters"in N&&N.decodeParameters!==void 0&&q.push({key:"DecodeParms",value:"<<"+N.decodeParameters+">>"}),"transparency"in N&&Array.isArray(N.transparency)&&N.transparency.length>0){for(var Z="",W=0,Y=N.transparency.length;W<Y;W++)Z+=N.transparency[W]+" "+N.transparency[W]+" ";q.push({key:"Mask",value:"["+Z+"]"})}N.sMask!==void 0&&q.push({key:"SMask",value:N.objectId+1+" 0 R"});var ue=N.filter!==void 0?["/"+N.filter]:void 0;if(P({data:N.data,additionalKeyValues:q,alreadyAppliedFilters:ue,objectId:N.objectId}),B("endobj"),"sMask"in N&&N.sMask!==void 0){var le,O=(le=N.sMaskBitsPerComponent)!==null&&le!==void 0?le:N.bitsPerComponent,V={width:N.width,height:N.height,colorSpace:"DeviceGray",bitsPerComponent:O,data:N.sMask};"filter"in N&&(V.decodeParameters="/Predictor ".concat(N.predictor," /Colors 1 /BitsPerComponent ").concat(O," /Columns ").concat(N.width),V.filter=N.filter),C.call(this,V)}if(N.colorSpace===b.INDEXED){var G=this.internal.newObject();P({data:T(new Uint8Array(N.palette)),objectId:G}),B("endobj")}},a=function(){var C=this.internal.collections[e+"images"];for(var N in C)s.call(this,C[N])},o=function(){var C,N=this.internal.collections[e+"images"],B=this.internal.write;for(var P in N)B("/I"+(C=N[P]).index,C.objectId,"0","R")},l=function(){this.internal.collections[e+"images"]||(this.internal.collections[e+"images"]={},this.internal.events.subscribe("putResources",a),this.internal.events.subscribe("putXobjectDict",o))},c=function(){var C=this.internal.collections[e+"images"];return l.call(this),C},u=function(){return Object.keys(this.internal.collections[e+"images"]).length},f=function(C){return typeof t["process"+C.toUpperCase()]=="function"},p=function(C){return Un(C)==="object"&&C.nodeType===1},d=function(C,N){if(C.nodeName==="IMG"&&C.hasAttribute("src")){var B=""+C.getAttribute("src");if(B.indexOf("data:image/")===0)return mh(unescape(B).split("base64,").pop());var P=t.loadFile(B,!0);if(P!==void 0)return P}if(C.nodeName==="CANVAS"){if(C.width===0||C.height===0)throw new Error("Given canvas must have data. Canvas width: "+C.width+", height: "+C.height);var F;switch(N){case"PNG":F="image/png";break;case"WEBP":F="image/webp";break;default:F="image/jpeg"}return mh(C.toDataURL(F,1).split("base64,").pop())}},y=function(C){var N=this.internal.collections[e+"images"];if(N){for(var B in N)if(C===N[B].alias)return N[B]}},m=function(C,N,B){return C||N||(C=-96,N=-96),C<0&&(C=-1*B.width*72/C/this.internal.scaleFactor),N<0&&(N=-1*B.height*72/N/this.internal.scaleFactor),C===0&&(C=N*B.width/B.height),N===0&&(N=C*B.height/B.width),[C,N]},w=function(C,N,B,P,F,q){var Z=m.call(this,B,P,F),W=this.internal.getCoordinateString,Y=this.internal.getVerticalCoordinateString,ue=c.call(this);if(B=Z[0],P=Z[1],ue[F.index]=F,q){q*=Math.PI/180;var le=Math.cos(q),O=Math.sin(q),V=function(re){return re.toFixed(4)},G=[V(le),V(O),V(-1*O),V(le),0,0,"cm"]}this.internal.write("q"),q?(this.internal.write([1,"0","0",1,W(C),Y(N+P),"cm"].join(" ")),this.internal.write(G.join(" ")),this.internal.write([W(B),"0","0",W(P),"0","0","cm"].join(" "))):this.internal.write([W(B),"0","0",W(P),W(C),Y(N+P),"cm"].join(" ")),this.isAdvancedAPI()&&this.internal.write([1,0,0,-1,0,0,"cm"].join(" ")),this.internal.write("/I"+F.index+" Do"),this.internal.write("Q")},b=t.color_spaces={DEVICE_RGB:"DeviceRGB",DEVICE_GRAY:"DeviceGray",DEVICE_CMYK:"DeviceCMYK",CAL_GREY:"CalGray",CAL_RGB:"CalRGB",LAB:"Lab",ICC_BASED:"ICCBased",INDEXED:"Indexed",PATTERN:"Pattern",SEPARATION:"Separation",DEVICE_N:"DeviceN"};t.decode={DCT_DECODE:"DCTDecode",FLATE_DECODE:"FlateDecode",LZW_DECODE:"LZWDecode",JPX_DECODE:"JPXDecode",JBIG2_DECODE:"JBIG2Decode",ASCII85_DECODE:"ASCII85Decode",ASCII_HEX_DECODE:"ASCIIHexDecode",RUN_LENGTH_DECODE:"RunLengthDecode",CCITT_FAX_DECODE:"CCITTFaxDecode"};var S=t.image_compression={NONE:"NONE",FAST:"FAST",MEDIUM:"MEDIUM",SLOW:"SLOW"},A=t.__addimage__.sHashCode=function(C){var N,B,P=0;if(typeof C=="string")for(B=C.length,N=0;N<B;N++)P=(P<<5)-P+C.charCodeAt(N),P|=0;else if(E(C))for(B=C.byteLength/2,N=0;N<B;N++)P=(P<<5)-P+C[N],P|=0;return P},_=t.__addimage__.validateStringAsBase64=function(C){(C=C||"").toString().trim();var N=!0;return C.length===0&&(N=!1),C.length%4!=0&&(N=!1),/^[A-Za-z0-9+/]+$/.test(C.substr(0,C.length-2))===!1&&(N=!1),/^[A-Za-z0-9/][A-Za-z0-9+/]|[A-Za-z0-9+/]=|==$/.test(C.substr(-2))===!1&&(N=!1),N},I=t.__addimage__.extractImageFromDataUrl=function(C){if(C==null||!(C=C.trim()).startsWith("data:"))return null;var N=C.indexOf(",");return N<0?null:C.substring(0,N).trim().endsWith("base64")?C.substring(N+1):null};t.__addimage__.isArrayBuffer=function(C){return C instanceof ArrayBuffer};var E=t.__addimage__.isArrayBufferView=function(C){return C instanceof Int8Array||C instanceof Uint8Array||C instanceof Uint8ClampedArray||C instanceof Int16Array||C instanceof Uint16Array||C instanceof Int32Array||C instanceof Uint32Array||C instanceof Float32Array||C instanceof Float64Array},M=t.__addimage__.binaryStringToUint8Array=function(C){for(var N=C.length,B=new Uint8Array(N),P=0;P<N;P++)B[P]=C.charCodeAt(P);return B},T=t.__addimage__.arrayBufferToBinaryString=function(C){for(var N="",B=E(C)?C:new Uint8Array(C),P=0;P<B.length;P+=8192)N+=String.fromCharCode.apply(null,B.subarray(P,P+8192));return N};t.addImage=function(){var C,N,B,P,F,q,Z,W,Y;if(typeof arguments[1]=="number"?(N=n,B=arguments[1],P=arguments[2],F=arguments[3],q=arguments[4],Z=arguments[5],W=arguments[6],Y=arguments[7]):(N=arguments[1],B=arguments[2],P=arguments[3],F=arguments[4],q=arguments[5],Z=arguments[6],W=arguments[7],Y=arguments[8]),Un(C=arguments[0])==="object"&&!p(C)&&"imageData"in C){var ue=C;C=ue.imageData,N=ue.format||N||n,B=ue.x||B||0,P=ue.y||P||0,F=ue.w||ue.width||F,q=ue.h||ue.height||q,Z=ue.alias||Z,W=ue.compression||W,Y=ue.rotation||ue.angle||Y}var le=this.internal.getFilters();if(W===void 0&&le.indexOf("FlateEncode")!==-1&&(W="SLOW"),isNaN(B)||isNaN(P))throw new Error("Invalid coordinates passed to jsPDF.addImage");l.call(this);var O=D.call(this,C,N,Z,W);return w.call(this,B,P,F,q,O,Y),this};var D=function(C,N,B,P){var F,q,Z;if(typeof C=="string"&&r(C)===n){C=unescape(C);var W=U(C,!1);(W!==""||(W=t.loadFile(C,!0))!==void 0)&&(C=W)}if(p(C)&&(C=d(C,N)),N=r(C,N),!f(N))throw new Error("addImage does not support files of type '"+N+"', please ensure that a plugin for '"+N+"' support is added.");if(((Z=B)==null||Z.length===0)&&(B=(function(Y){return typeof Y=="string"||E(Y)?A(Y):E(Y.data)?A(Y.data):null})(C)),(F=y.call(this,B))||(C instanceof Uint8Array||N==="RGBA"||(q=C,C=M(C)),F=this["process"+N.toUpperCase()](C,u.call(this),B,(function(Y){return Y&&typeof Y=="string"&&(Y=Y.toUpperCase()),Y in t.image_compression?Y:S.NONE})(P),q)),!F)throw new Error("An unknown error occurred whilst processing the image.");return F},U=t.__addimage__.convertBase64ToBinaryString=function(C,N){N=typeof N!="boolean"||N;var B,P="";if(typeof C=="string"){var F;B=(F=I(C))!==null&&F!==void 0?F:C;try{P=mh(B)}catch(q){if(N)throw _(B)?new Error("atob-Error in jsPDF.convertBase64ToBinaryString "+q.message):new Error("Supplied Data is not a valid base64-String jsPDF.convertBase64ToBinaryString ")}}return P};t.getImageProperties=function(C){var N,B,P="";if(p(C)&&(C=d(C)),typeof C=="string"&&r(C)===n&&((P=U(C,!1))===""&&(P=t.loadFile(C)||""),C=P),B=r(C),!f(B))throw new Error("addImage does not support files of type '"+B+"', please ensure that a plugin for '"+B+"' support is added.");if(C instanceof Uint8Array||(C=M(C)),!(N=this["process"+B.toUpperCase()](C)))throw new Error("An unknown error occurred whilst processing the image");return N.fileType=B,N}})(Ut.API),(function(t){var e=function(n){if(n!==void 0&&n!="")return!0};Ut.API.events.push(["addPage",function(n){this.internal.getPageInfo(n.pageNumber).pageContext.annotations=[]}]),t.events.push(["putPage",function(n){for(var i,r,s,a=this.internal.getCoordinateString,o=this.internal.getVerticalCoordinateString,l=this.internal.getPageInfoByObjId(n.objId),c=n.pageContext.annotations,u=!1,f=0;f<c.length&&!u;f++)switch((i=c[f]).type){case"link":(e(i.options.url)||e(i.options.pageNumber))&&(u=!0);break;case"reference":case"text":case"freetext":u=!0}if(u!=0){this.internal.write("/Annots [");for(var p=0;p<c.length;p++){i=c[p];var d=this.internal.pdfEscape,y=this.internal.getEncryptor(n.objId);switch(i.type){case"reference":this.internal.write(" "+i.object.objId+" 0 R ");break;case"text":var m=this.internal.newAdditionalObject(),w=this.internal.newAdditionalObject(),b=this.internal.getEncryptor(m.objId),S=i.title||"Note";s="<</Type /Annot /Subtype /Text "+(r="/Rect ["+a(i.bounds.x)+" "+o(i.bounds.y+i.bounds.h)+" "+a(i.bounds.x+i.bounds.w)+" "+o(i.bounds.y)+"] ")+"/Contents ("+d(b(i.contents))+")",s+=" /Popup "+w.objId+" 0 R",s+=" /P "+l.objId+" 0 R",s+=" /T ("+d(b(S))+") >>",m.content=s;var A=m.objId+" 0 R";s="<</Type /Annot /Subtype /Popup "+(r="/Rect ["+a(i.bounds.x+30)+" "+o(i.bounds.y+i.bounds.h)+" "+a(i.bounds.x+i.bounds.w+30)+" "+o(i.bounds.y)+"] ")+" /Parent "+A,i.open&&(s+=" /Open true"),s+=" >>",w.content=s,this.internal.write(m.objId,"0 R",w.objId,"0 R");break;case"freetext":r="/Rect ["+a(i.bounds.x)+" "+o(i.bounds.y)+" "+a(i.bounds.x+i.bounds.w)+" "+o(i.bounds.y+i.bounds.h)+"] ";var _=i.color||"#000000";s="<</Type /Annot /Subtype /FreeText "+r+"/Contents ("+d(y(i.contents))+")",s+=" /DS(font: Helvetica,sans-serif 12.0pt; text-align:left; color:#"+_+")",s+=" /Border [0 0 0]",s+=" >>",this.internal.write(s);break;case"link":if(i.options.name){var I=this.annotations._nameMap[i.options.name];i.options.pageNumber=I.page,i.options.top=I.y}else i.options.top||(i.options.top=0);if(r="/Rect ["+i.finalBounds.x+" "+i.finalBounds.y+" "+i.finalBounds.w+" "+i.finalBounds.h+"] ",s="",i.options.url)s="<</Type /Annot /Subtype /Link "+r+"/Border [0 0 0] /A <</S /URI /URI ("+d(y(i.options.url))+") >>";else if(i.options.pageNumber)switch(s="<</Type /Annot /Subtype /Link "+r+"/Border [0 0 0] /Dest ["+this.internal.getPageInfo(i.options.pageNumber).objId+" 0 R",i.options.magFactor=i.options.magFactor||"XYZ",i.options.magFactor){case"Fit":s+=" /Fit]";break;case"FitH":s+=" /FitH "+i.options.top+"]";break;case"FitV":i.options.left=i.options.left||0,s+=" /FitV "+i.options.left+"]";break;default:var E=o(i.options.top);i.options.left=i.options.left||0,i.options.zoom===void 0&&(i.options.zoom=0),s+=" /XYZ "+i.options.left+" "+E+" "+i.options.zoom+"]"}s!=""&&(s+=" >>",this.internal.write(s))}}this.internal.write("]")}}]),t.createAnnotation=function(n){var i=this.internal.getCurrentPageInfo();switch(n.type){case"link":this.link(n.bounds.x,n.bounds.y,n.bounds.w,n.bounds.h,n);break;case"text":case"freetext":i.pageContext.annotations.push(n)}},t.link=function(n,i,r,s,a){var o=this.internal.getCurrentPageInfo(),l=this.internal.getCoordinateString,c=this.internal.getVerticalCoordinateString;o.pageContext.annotations.push({finalBounds:{x:l(n),y:c(i),w:l(n+r),h:c(i+s)},options:a,type:"link"})},t.textWithLink=function(n,i,r,s){var a,o,l=this.getTextWidth(n),c=this.internal.getLineHeight()/this.internal.scaleFactor;if(s.maxWidth!==void 0){o=s.maxWidth;var u=this.splitTextToSize(n,o).length;a=Math.ceil(c*u)}else o=l,a=c;return this.text(n,i,r,s),r+=.2*c,s.align==="center"&&(i-=l/2),s.align==="right"&&(i-=l),this.link(i,r-c,o,a,s),l},t.getTextWidth=function(n){var i=this.internal.getFontSize();return this.getStringUnitWidth(n)*i/this.internal.scaleFactor}})(Ut.API),(function(t){var e={1569:[65152],1570:[65153,65154],1571:[65155,65156],1572:[65157,65158],1573:[65159,65160],1574:[65161,65162,65163,65164],1575:[65165,65166],1576:[65167,65168,65169,65170],1577:[65171,65172],1578:[65173,65174,65175,65176],1579:[65177,65178,65179,65180],1580:[65181,65182,65183,65184],1581:[65185,65186,65187,65188],1582:[65189,65190,65191,65192],1583:[65193,65194],1584:[65195,65196],1585:[65197,65198],1586:[65199,65200],1587:[65201,65202,65203,65204],1588:[65205,65206,65207,65208],1589:[65209,65210,65211,65212],1590:[65213,65214,65215,65216],1591:[65217,65218,65219,65220],1592:[65221,65222,65223,65224],1593:[65225,65226,65227,65228],1594:[65229,65230,65231,65232],1601:[65233,65234,65235,65236],1602:[65237,65238,65239,65240],1603:[65241,65242,65243,65244],1604:[65245,65246,65247,65248],1605:[65249,65250,65251,65252],1606:[65253,65254,65255,65256],1607:[65257,65258,65259,65260],1608:[65261,65262],1609:[65263,65264,64488,64489],1610:[65265,65266,65267,65268],1649:[64336,64337],1655:[64477],1657:[64358,64359,64360,64361],1658:[64350,64351,64352,64353],1659:[64338,64339,64340,64341],1662:[64342,64343,64344,64345],1663:[64354,64355,64356,64357],1664:[64346,64347,64348,64349],1667:[64374,64375,64376,64377],1668:[64370,64371,64372,64373],1670:[64378,64379,64380,64381],1671:[64382,64383,64384,64385],1672:[64392,64393],1676:[64388,64389],1677:[64386,64387],1678:[64390,64391],1681:[64396,64397],1688:[64394,64395],1700:[64362,64363,64364,64365],1702:[64366,64367,64368,64369],1705:[64398,64399,64400,64401],1709:[64467,64468,64469,64470],1711:[64402,64403,64404,64405],1713:[64410,64411,64412,64413],1715:[64406,64407,64408,64409],1722:[64414,64415],1723:[64416,64417,64418,64419],1726:[64426,64427,64428,64429],1728:[64420,64421],1729:[64422,64423,64424,64425],1733:[64480,64481],1734:[64473,64474],1735:[64471,64472],1736:[64475,64476],1737:[64482,64483],1739:[64478,64479],1740:[64508,64509,64510,64511],1744:[64484,64485,64486,64487],1746:[64430,64431],1747:[64432,64433]},n={65247:{65154:65269,65156:65271,65160:65273,65166:65275},65248:{65154:65270,65156:65272,65160:65274,65166:65276},65165:{65247:{65248:{65258:65010}}},1617:{1612:64606,1613:64607,1614:64608,1615:64609,1616:64610}},i={1612:64606,1613:64607,1614:64608,1615:64609,1616:64610},r=[1570,1571,1573,1575];t.__arabicParser__={};var s=t.__arabicParser__.isInArabicSubstitutionA=function(m){return e[m.charCodeAt(0)]!==void 0},a=t.__arabicParser__.isArabicLetter=function(m){return typeof m=="string"&&/^[\u0600-\u06FF\u0750-\u077F\u08A0-\u08FF\uFB50-\uFDFF\uFE70-\uFEFF]+$/.test(m)},o=t.__arabicParser__.isArabicEndLetter=function(m){return a(m)&&s(m)&&e[m.charCodeAt(0)].length<=2},l=t.__arabicParser__.isArabicAlfLetter=function(m){return a(m)&&r.indexOf(m.charCodeAt(0))>=0};t.__arabicParser__.arabicLetterHasIsolatedForm=function(m){return a(m)&&s(m)&&e[m.charCodeAt(0)].length>=1};var c=t.__arabicParser__.arabicLetterHasFinalForm=function(m){return a(m)&&s(m)&&e[m.charCodeAt(0)].length>=2};t.__arabicParser__.arabicLetterHasInitialForm=function(m){return a(m)&&s(m)&&e[m.charCodeAt(0)].length>=3};var u=t.__arabicParser__.arabicLetterHasMedialForm=function(m){return a(m)&&s(m)&&e[m.charCodeAt(0)].length==4},f=t.__arabicParser__.resolveLigatures=function(m){var w=0,b=n,S="",A=0;for(w=0;w<m.length;w+=1)b[m.charCodeAt(w)]!==void 0?(A++,typeof(b=b[m.charCodeAt(w)])=="number"&&(S+=String.fromCharCode(b),b=n,A=0),w===m.length-1&&(b=n,S+=m.charAt(w-(A-1)),w-=A-1,A=0)):(b=n,S+=m.charAt(w-A),w-=A,A=0);return S};t.__arabicParser__.isArabicDiacritic=function(m){return m!==void 0&&i[m.charCodeAt(0)]!==void 0};var p=t.__arabicParser__.getCorrectForm=function(m,w,b){return a(m)?s(m)===!1?-1:!c(m)||!a(w)&&!a(b)||!a(b)&&o(w)||o(m)&&!a(w)||o(m)&&l(w)||o(m)&&o(w)?0:u(m)&&a(w)&&!o(w)&&a(b)&&c(b)?3:o(m)||!a(b)?1:2:-1},d=function(m){var w=0,b=0,S=0,A="",_="",I="",E=(m=m||"").split("\\s+"),M=[];for(w=0;w<E.length;w+=1){for(M.push(""),b=0;b<E[w].length;b+=1)A=E[w][b],_=E[w][b-1],I=E[w][b+1],a(A)?(S=p(A,_,I),M[w]+=S!==-1?String.fromCharCode(e[A.charCodeAt(0)][S]):A):M[w]+=A;M[w]=f(M[w])}return M.join(" ")},y=t.__arabicParser__.processArabic=t.processArabic=function(){var m,w=typeof arguments[0]=="string"?arguments[0]:arguments[0].text,b=[];if(Array.isArray(w)){var S=0;for(b=[],S=0;S<w.length;S+=1)Array.isArray(w[S])?b.push([d(w[S][0]),w[S][1],w[S][2]]):b.push([d(w[S])]);m=b}else m=d(w);return typeof arguments[0]=="string"?m:(arguments[0].text=m,arguments[0])};t.events.push(["preProcessText",y])})(Ut.API),Ut.API.autoPrint=function(t){var e;return(t=t||{}).variant=t.variant||"non-conform",t.variant==="javascript"?this.addJS("print({});"):(this.internal.events.subscribe("postPutResources",function(){e=this.internal.newObject(),this.internal.out("<<"),this.internal.out("/S /Named"),this.internal.out("/Type /Action"),this.internal.out("/N /Print"),this.internal.out(">>"),this.internal.out("endobj")}),this.internal.events.subscribe("putCatalog",function(){this.internal.out("/OpenAction "+e+" 0 R")})),this},(function(t){var e=function(){var n=void 0;Object.defineProperty(this,"pdf",{get:function(){return n},set:function(o){n=o}});var i=150;Object.defineProperty(this,"width",{get:function(){return i},set:function(o){i=isNaN(o)||Number.isInteger(o)===!1||o<0?150:o,this.getContext("2d").pageWrapXEnabled&&(this.getContext("2d").pageWrapX=i+1)}});var r=300;Object.defineProperty(this,"height",{get:function(){return r},set:function(o){r=isNaN(o)||Number.isInteger(o)===!1||o<0?300:o,this.getContext("2d").pageWrapYEnabled&&(this.getContext("2d").pageWrapY=r+1)}});var s=[];Object.defineProperty(this,"childNodes",{get:function(){return s},set:function(o){s=o}});var a={};Object.defineProperty(this,"style",{get:function(){return a},set:function(o){a=o}}),Object.defineProperty(this,"parentNode",{})};e.prototype.getContext=function(n,i){var r;if((n=n||"2d")!=="2d")return null;for(r in i)this.pdf.context2d.hasOwnProperty(r)&&(this.pdf.context2d[r]=i[r]);return this.pdf.context2d._canvas=this,this.pdf.context2d},e.prototype.toDataURL=function(){throw new Error("toDataURL is not implemented.")},t.events.push(["initialized",function(){this.canvas=new e,this.canvas.pdf=this}])})(Ut.API),(function(t){var e={left:0,top:0,bottom:0,right:0},n=!1,i=function(){this.internal.__cell__===void 0&&(this.internal.__cell__={},this.internal.__cell__.padding=3,this.internal.__cell__.headerFunction=void 0,this.internal.__cell__.margins=Object.assign({},e),this.internal.__cell__.margins.width=this.getPageWidth(),r.call(this))},r=function(){this.internal.__cell__.lastCell=new s,this.internal.__cell__.pages=1},s=function(){var l=arguments[0];Object.defineProperty(this,"x",{enumerable:!0,get:function(){return l},set:function(m){l=m}});var c=arguments[1];Object.defineProperty(this,"y",{enumerable:!0,get:function(){return c},set:function(m){c=m}});var u=arguments[2];Object.defineProperty(this,"width",{enumerable:!0,get:function(){return u},set:function(m){u=m}});var f=arguments[3];Object.defineProperty(this,"height",{enumerable:!0,get:function(){return f},set:function(m){f=m}});var p=arguments[4];Object.defineProperty(this,"text",{enumerable:!0,get:function(){return p},set:function(m){p=m}});var d=arguments[5];Object.defineProperty(this,"lineNumber",{enumerable:!0,get:function(){return d},set:function(m){d=m}});var y=arguments[6];return Object.defineProperty(this,"align",{enumerable:!0,get:function(){return y},set:function(m){y=m}}),this};s.prototype.clone=function(){return new s(this.x,this.y,this.width,this.height,this.text,this.lineNumber,this.align)},s.prototype.toArray=function(){return[this.x,this.y,this.width,this.height,this.text,this.lineNumber,this.align]},t.setHeaderFunction=function(l){return i.call(this),this.internal.__cell__.headerFunction=typeof l=="function"?l:void 0,this},t.getTextDimensions=function(l,c){i.call(this);var u=(c=c||{}).fontSize||this.getFontSize(),f=c.font||this.getFont(),p=c.scaleFactor||this.internal.scaleFactor,d=0,y=0,m=0,w=this;if(!Array.isArray(l)&&typeof l!="string"){if(typeof l!="number")throw new Error("getTextDimensions expects text-parameter to be of type String or type Number or an Array of Strings.");l=String(l)}var b=c.maxWidth;b>0?typeof l=="string"?l=this.splitTextToSize(l,b):Object.prototype.toString.call(l)==="[object Array]"&&(l=l.reduce(function(A,_){return A.concat(w.splitTextToSize(_,b))},[])):l=Array.isArray(l)?l:[l];for(var S=0;S<l.length;S++)d<(m=this.getStringUnitWidth(l[S],{font:f})*u)&&(d=m);return d!==0&&(y=l.length),{w:d/=p,h:Math.max((y*u*this.getLineHeightFactor()-u*(this.getLineHeightFactor()-1))/p,0)}},t.cellAddPage=function(){i.call(this),this.addPage();var l=this.internal.__cell__.margins||e;return this.internal.__cell__.lastCell=new s(l.left,l.top,void 0,void 0),this.internal.__cell__.pages+=1,this};var a=t.cell=function(){var l;l=arguments[0]instanceof s?arguments[0]:new s(arguments[0],arguments[1],arguments[2],arguments[3],arguments[4],arguments[5],arguments[6]),i.call(this);var c=this.internal.__cell__.lastCell,u=this.internal.__cell__.padding,f=this.internal.__cell__.margins||e,p=this.internal.__cell__.tableHeaderRow,d=this.internal.__cell__.printHeaders;return c.lineNumber!==void 0&&(c.lineNumber===l.lineNumber?(l.x=(c.x||0)+(c.width||0),l.y=c.y||0):c.y+c.height+l.height+f.bottom>this.getPageHeight()?(this.cellAddPage(),l.y=f.top,d&&p&&(this.printHeaderRow(l.lineNumber,!0),l.y+=p[0].height)):l.y=c.y+c.height||l.y),l.text[0]!==void 0&&(this.rect(l.x,l.y,l.width,l.height,n===!0?"FD":void 0),l.align==="right"?this.text(l.text,l.x+l.width-u,l.y+u,{align:"right",baseline:"top"}):l.align==="center"?this.text(l.text,l.x+l.width/2,l.y+u,{align:"center",baseline:"top",maxWidth:l.width-u-u}):this.text(l.text,l.x+u,l.y+u,{align:"left",baseline:"top",maxWidth:l.width-u-u})),this.internal.__cell__.lastCell=l,this};t.table=function(l,c,u,f,p){if(i.call(this),!u)throw new Error("No data for PDF table.");var d,y,m,w,b=[],S=[],A=[],_={},I={},E=[],M=[],T=(p=p||{}).autoSize||!1,D=p.printHeaders!==!1,U=p.css&&p.css["font-size"]!==void 0?16*p.css["font-size"]:p.fontSize||12,C=p.margins||Object.assign({width:this.getPageWidth()},e),N=typeof p.padding=="number"?p.padding:3,B=p.headerBackgroundColor||"#c8c8c8",P=p.headerTextColor||"#000";if(r.call(this),this.internal.__cell__.printHeaders=D,this.internal.__cell__.margins=C,this.internal.__cell__.table_font_size=U,this.internal.__cell__.padding=N,this.internal.__cell__.headerBackgroundColor=B,this.internal.__cell__.headerTextColor=P,this.setFontSize(U),f==null)S=b=Object.keys(u[0]),A=b.map(function(){return"left"});else if(Array.isArray(f)&&Un(f[0])==="object")for(b=f.map(function(ue){return ue.name}),S=f.map(function(ue){return ue.prompt||ue.name||""}),A=f.map(function(ue){return ue.align||"left"}),d=0;d<f.length;d+=1)I[f[d].name]=.7499990551181103*f[d].width;else Array.isArray(f)&&typeof f[0]=="string"&&(S=b=f,A=b.map(function(){return"left"}));if(T||Array.isArray(f)&&typeof f[0]=="string")for(d=0;d<b.length;d+=1){for(_[w=b[d]]=u.map(function(ue){return ue[w]}),this.setFont(void 0,"bold"),E.push(this.getTextDimensions(S[d],{fontSize:this.internal.__cell__.table_font_size,scaleFactor:this.internal.scaleFactor}).w),y=_[w],this.setFont(void 0,"normal"),m=0;m<y.length;m+=1)E.push(this.getTextDimensions(y[m],{fontSize:this.internal.__cell__.table_font_size,scaleFactor:this.internal.scaleFactor}).w);I[w]=Math.max.apply(null,E)+N+N,E=[]}if(D){var F={};for(d=0;d<b.length;d+=1)F[b[d]]={},F[b[d]].text=S[d],F[b[d]].align=A[d];var q=o.call(this,F,I);M=b.map(function(ue){return new s(l,c,I[ue],q,F[ue].text,void 0,F[ue].align)}),this.setTableHeaderRow(M),this.printHeaderRow(1,!1)}var Z=f.reduce(function(ue,le){return ue[le.name]=le.align,ue},{});for(d=0;d<u.length;d+=1){"rowStart"in p&&p.rowStart instanceof Function&&p.rowStart({row:d,data:u[d]},this);var W=o.call(this,u[d],I);for(m=0;m<b.length;m+=1){var Y=u[d][b[m]];"cellStart"in p&&p.cellStart instanceof Function&&p.cellStart({row:d,col:m,data:Y},this),a.call(this,new s(l,c,I[b[m]],W,Y,d+2,Z[b[m]]))}}return this.internal.__cell__.table_x=l,this.internal.__cell__.table_y=c,this};var o=function(l,c){var u=this.internal.__cell__.padding,f=this.internal.__cell__.table_font_size,p=this.internal.scaleFactor;return Object.keys(l).map(function(d){var y=l[d];return this.splitTextToSize(y.hasOwnProperty("text")?y.text:y,c[d]-u-u)},this).map(function(d){return this.getLineHeightFactor()*d.length*f/p+u+u},this).reduce(function(d,y){return Math.max(d,y)},0)};t.setTableHeaderRow=function(l){i.call(this),this.internal.__cell__.tableHeaderRow=l},t.printHeaderRow=function(l,c){if(i.call(this),!this.internal.__cell__.tableHeaderRow)throw new Error("Property tableHeaderRow does not exist.");var u;if(n=!0,typeof this.internal.__cell__.headerFunction=="function"){var f=this.internal.__cell__.headerFunction(this,this.internal.__cell__.pages);this.internal.__cell__.lastCell=new s(f[0],f[1],f[2],f[3],void 0,-1)}this.setFont(void 0,"bold");for(var p=[],d=0;d<this.internal.__cell__.tableHeaderRow.length;d+=1){u=this.internal.__cell__.tableHeaderRow[d].clone(),c&&(u.y=this.internal.__cell__.margins.top||0,p.push(u)),u.lineNumber=l;var y=this.getTextColor();this.setTextColor(this.internal.__cell__.headerTextColor),this.setFillColor(this.internal.__cell__.headerBackgroundColor),a.call(this,u),this.setTextColor(y)}p.length>0&&this.setTableHeaderRow(p),this.setFont(void 0,"normal"),n=!1}})(Ut.API);var c_={italic:["italic","oblique","normal"],oblique:["oblique","italic","normal"],normal:["normal","oblique","italic"]},u_=["ultra-condensed","extra-condensed","condensed","semi-condensed","normal","semi-expanded","expanded","extra-expanded","ultra-expanded"],c1=l_(u_),d_=[100,200,300,400,500,600,700,800,900],CF=l_(d_);function em(t){var e=t.family.replace(/"|'/g,"").toLowerCase(),n=(function(s){return c_[s=s||"normal"]?s:"normal"})(t.style),i=(function(s){return s?typeof s=="number"?s>=100&&s<=900&&s%100==0?s:400:/^\d00$/.test(s)?parseInt(s):s==="bold"?700:400:400})(t.weight),r=(function(s){return typeof c1[s=s||"normal"]=="number"?s:"normal"})(t.stretch);return{family:e,style:n,weight:i,stretch:r,src:t.src||[],ref:t.ref||{name:e,style:[r,n,i].join(" ")}}}function Py(t,e,n,i){var r;for(r=n;r>=0&&r<e.length;r+=i)if(t[e[r]])return t[e[r]];for(r=n;r>=0&&r<e.length;r-=i)if(t[e[r]])return t[e[r]]}var PF={"sans-serif":"helvetica",fixed:"courier",monospace:"courier",terminal:"courier",cursive:"times",fantasy:"times",serif:"times"},Ey={caption:"times",icon:"times",menu:"times","message-box":"times","small-caption":"times","status-bar":"times"};function Iy(t){return[t.stretch,t.style,t.weight,t.family].join(" ")}function Ly(t){return t.trimLeft()}function EF(t,e){for(var n=0;n<t.length;){if(t.charAt(n)===e)return[t.substring(0,n),t.substring(n+1)];n+=1}return null}function IF(t){var e=t.match(/^(-[a-z_]|[a-z_])[a-z0-9_-]*/i);return e===null?null:[e[0],t.substring(e[0].length)]}var ru,Jf,My,Ty,Dy,tm=["times"];function Oy(t,e,n,i,r){var s=4,a=Ry;switch(r){case Ut.API.image_compression.FAST:s=1,a=Fy;break;case Ut.API.image_compression.MEDIUM:s=6,a=By;break;case Ut.API.image_compression.SLOW:s=9,a=zy}t=(function(l,c,u,f){for(var p,d=l.length/c,y=new Uint8Array(l.length+d),m=[LF,Fy,Ry,By,zy],w=0;w<d;w+=1){var b=w*c,S=l.subarray(b,b+c);if(f)y.set(f(S,u,p),b+w);else{for(var A=m.length,_=[],I=0;I<A;I+=1)_[I]=m[I](S,u,p);var E=TF(_.concat());y.set(_[E],b+w)}p=S}return y})(t,e,Math.ceil(n*i/8),a);var o=n1(t,{level:s});return Ut.API.__addimage__.arrayBufferToBinaryString(o)}function LF(t){var e=Array.apply([],t);return e.unshift(0),e}function Fy(t,e){var n=t.length,i=[];i[0]=1;for(var r=0;r<n;r+=1){var s=t[r-e]||0;i[r+1]=t[r]-s+256&255}return i}function Ry(t,e,n){var i=t.length,r=[];r[0]=2;for(var s=0;s<i;s+=1){var a=n&&n[s]||0;r[s+1]=t[s]-a+256&255}return r}function By(t,e,n){var i=t.length,r=[];r[0]=3;for(var s=0;s<i;s+=1){var a=t[s-e]||0,o=n&&n[s]||0;r[s+1]=t[s]+256-(a+o>>>1)&255}return r}function zy(t,e,n){var i=t.length,r=[];r[0]=4;for(var s=0;s<i;s+=1){var a=MF(t[s-e]||0,n&&n[s]||0,n&&n[s-e]||0);r[s+1]=t[s]-a+256&255}return r}function MF(t,e,n){if(t===e&&e===n)return t;var i=Math.abs(e-n),r=Math.abs(t-n),s=Math.abs(t+e-n-n);return i<=r&&i<=s?t:r<=s?e:n}function TF(t){var e=t.map(function(n){return n.reduce(function(i,r){return i+Math.abs(r)},0)});return e.indexOf(Math.min.apply(null,e))}function nm(t,e,n){var i=e*n,r=Math.floor(i/8),s=16-(i-8*r+n),a=(1<<n)-1;return f_(t,r)>>s&a}function qy(t,e,n,i){var r=n*i,s=Math.floor(r/8),a=16-(r-8*s+i),o=(1<<i)-1,l=(e&o)<<a;(function(c,u,f){if(u+1<c.byteLength)c.setUint16(u,f,!1);else{var p=f>>8&255;c.setUint8(u,p)}})(t,s,f_(t,s)&~(o<<a)&65535|l)}function f_(t,e){return e+1<t.byteLength?t.getUint16(e,!1):t.getUint8(e)<<8}function DF(t){var e=0;if(t[e++]!==71||t[e++]!==73||t[e++]!==70||t[e++]!==56||(t[e++]+1&253)!=56||t[e++]!==97)throw new Error("Invalid GIF 87a/89a header.");var n=t[e++]|t[e++]<<8,i=t[e++]|t[e++]<<8,r=t[e++],s=r>>7,a=1<<1+(7&r);t[e++],t[e++];var o=null,l=null;s&&(o=e,l=a,e+=3*a);var c=!0,u=[],f=0,p=null,d=0,y=null;for(this.width=n,this.height=i;c&&e<t.length;)switch(t[e++]){case 33:switch(t[e++]){case 255:if(t[e]!==11||t[e+1]==78&&t[e+2]==69&&t[e+3]==84&&t[e+4]==83&&t[e+5]==67&&t[e+6]==65&&t[e+7]==80&&t[e+8]==69&&t[e+9]==50&&t[e+10]==46&&t[e+11]==48&&t[e+12]==3&&t[e+13]==1&&t[e+16]==0)e+=14,y=t[e++]|t[e++]<<8,e++;else for(e+=12;;){if(!((C=t[e++])>=0))throw Error("Invalid block size");if(C===0)break;e+=C}break;case 249:if(t[e++]!==4||t[e+4]!==0)throw new Error("Invalid graphics extension block.");var m=t[e++];f=t[e++]|t[e++]<<8,p=t[e++],1&m||(p=null),d=m>>2&7,e++;break;case 254:for(;;){if(!((C=t[e++])>=0))throw Error("Invalid block size");if(C===0)break;e+=C}break;default:throw new Error("Unknown graphic control label: 0x"+t[e-1].toString(16))}break;case 44:var w=t[e++]|t[e++]<<8,b=t[e++]|t[e++]<<8,S=t[e++]|t[e++]<<8,A=t[e++]|t[e++]<<8,_=t[e++],I=_>>6&1,E=1<<1+(7&_),M=o,T=l,D=!1;_>>7&&(D=!0,M=e,T=E,e+=3*E);var U=e;for(e++;;){var C;if(!((C=t[e++])>=0))throw Error("Invalid block size");if(C===0)break;e+=C}u.push({x:w,y:b,width:S,height:A,has_local_palette:D,palette_offset:M,palette_size:T,data_offset:U,data_length:e-U,transparent_index:p,interlaced:!!I,delay:f,disposal:d});break;case 59:c=!1;break;default:throw new Error("Unknown gif block: 0x"+t[e-1].toString(16))}this.numFrames=function(){return u.length},this.loopCount=function(){return y},this.frameInfo=function(N){if(N<0||N>=u.length)throw new Error("Frame index out of range.");return u[N]},this.decodeAndBlitFrameBGRA=function(N,B){var P=this.frameInfo(N),F=P.width*P.height,q=new Uint8Array(F);jy(t,P.data_offset,q,F);var Z=P.palette_offset,W=P.transparent_index;W===null&&(W=256);var Y=P.width,ue=n-Y,le=Y,O=4*(P.y*n+P.x),V=4*((P.y+P.height)*n+P.x),G=O,re=4*ue;P.interlaced===!0&&(re+=4*n*7);for(var ae=8,ee=0,de=q.length;ee<de;++ee){var he=q[ee];if(le===0&&(le=Y,(G+=re)>=V&&(re=4*ue+4*n*(ae-1),G=O+(Y+ue)*(ae<<1),ae>>=1)),he===W)G+=4;else{var pe=t[Z+3*he],ge=t[Z+3*he+1],Ee=t[Z+3*he+2];B[G++]=Ee,B[G++]=ge,B[G++]=pe,B[G++]=255}--le}},this.decodeAndBlitFrameRGBA=function(N,B){var P=this.frameInfo(N),F=P.width*P.height,q=new Uint8Array(F);jy(t,P.data_offset,q,F);var Z=P.palette_offset,W=P.transparent_index;W===null&&(W=256);var Y=P.width,ue=n-Y,le=Y,O=4*(P.y*n+P.x),V=4*((P.y+P.height)*n+P.x),G=O,re=4*ue;P.interlaced===!0&&(re+=4*n*7);for(var ae=8,ee=0,de=q.length;ee<de;++ee){var he=q[ee];if(le===0&&(le=Y,(G+=re)>=V&&(re=4*ue+4*n*(ae-1),G=O+(Y+ue)*(ae<<1),ae>>=1)),he===W)G+=4;else{var pe=t[Z+3*he],ge=t[Z+3*he+1],Ee=t[Z+3*he+2];B[G++]=pe,B[G++]=ge,B[G++]=Ee,B[G++]=255}--le}}}function jy(t,e,n,i){for(var r=t[e++],s=1<<r,a=s+1,o=a+1,l=r+1,c=(1<<l)-1,u=0,f=0,p=0,d=t[e++],y=new Int32Array(4096),m=null;;){for(;u<16&&d!==0;)f|=t[e++]<<u,u+=8,d===1?d=t[e++]:--d;if(u<l)break;var w=f&c;if(f>>=l,u-=l,w!==s){if(w===a)break;for(var b=w<o?w:m,S=0,A=b;A>s;)A=y[A]>>8,++S;var _=A;if(p+S+(b!==w?1:0)>i)return void ni.log("Warning, gif stream longer than expected.");n[p++]=_;var I=p+=S;for(b!==w&&(n[p++]=_),A=b;S--;)A=y[A],n[--I]=255&A,A>>=8;m!==null&&o<4096&&(y[o++]=m<<8|_,o>=c+1&&l<12&&(++l,c=c<<1|1)),m=w}else o=a+1,c=(1<<(l=r+1))-1,m=null}return p!==i&&ni.log("Warning, gif stream shorter than expected."),n}function im(t){var e,n,i,r,s,a=Math.floor,o=new Array(64),l=new Array(64),c=new Array(64),u=new Array(64),f=new Array(65535),p=new Array(65535),d=new Array(64),y=new Array(64),m=[],w=0,b=7,S=new Array(64),A=new Array(64),_=new Array(64),I=new Array(256),E=new Array(2048),M=[0,1,5,6,14,15,27,28,2,4,7,13,16,26,29,42,3,8,12,17,25,30,41,43,9,11,18,24,31,40,44,53,10,19,23,32,39,45,52,54,20,22,33,38,46,51,55,60,21,34,37,47,50,56,59,61,35,36,48,49,57,58,62,63],T=[0,0,1,5,1,1,1,1,1,1,0,0,0,0,0,0,0],D=[0,1,2,3,4,5,6,7,8,9,10,11],U=[0,0,2,1,3,3,2,4,3,5,5,4,4,0,0,1,125],C=[1,2,3,0,4,17,5,18,33,49,65,6,19,81,97,7,34,113,20,50,129,145,161,8,35,66,177,193,21,82,209,240,36,51,98,114,130,9,10,22,23,24,25,26,37,38,39,40,41,42,52,53,54,55,56,57,58,67,68,69,70,71,72,73,74,83,84,85,86,87,88,89,90,99,100,101,102,103,104,105,106,115,116,117,118,119,120,121,122,131,132,133,134,135,136,137,138,146,147,148,149,150,151,152,153,154,162,163,164,165,166,167,168,169,170,178,179,180,181,182,183,184,185,186,194,195,196,197,198,199,200,201,202,210,211,212,213,214,215,216,217,218,225,226,227,228,229,230,231,232,233,234,241,242,243,244,245,246,247,248,249,250],N=[0,0,3,1,1,1,1,1,1,1,1,1,0,0,0,0,0],B=[0,1,2,3,4,5,6,7,8,9,10,11],P=[0,0,2,1,2,4,4,3,4,7,5,4,4,0,1,2,119],F=[0,1,2,3,17,4,5,33,49,6,18,65,81,7,97,113,19,34,50,129,8,20,66,145,161,177,193,9,35,51,82,240,21,98,114,209,10,22,36,52,225,37,241,23,24,25,26,38,39,40,41,42,53,54,55,56,57,58,67,68,69,70,71,72,73,74,83,84,85,86,87,88,89,90,99,100,101,102,103,104,105,106,115,116,117,118,119,120,121,122,130,131,132,133,134,135,136,137,138,146,147,148,149,150,151,152,153,154,162,163,164,165,166,167,168,169,170,178,179,180,181,182,183,184,185,186,194,195,196,197,198,199,200,201,202,210,211,212,213,214,215,216,217,218,226,227,228,229,230,231,232,233,234,242,243,244,245,246,247,248,249,250];function q(O,V){for(var G=0,re=0,ae=new Array,ee=1;ee<=16;ee++){for(var de=1;de<=O[ee];de++)ae[V[re]]=[],ae[V[re]][0]=G,ae[V[re]][1]=ee,re++,G++;G*=2}return ae}function Z(O){for(var V=O[0],G=O[1]-1;G>=0;)V&1<<G&&(w|=1<<b),G--,--b<0&&(w==255?(W(255),W(0)):W(w),b=7,w=0)}function W(O){m.push(O)}function Y(O){W(O>>8&255),W(255&O)}function ue(O,V,G,re,ae){for(var ee,de=ae[0],he=ae[240],pe=(function(Ie,lt){var We,Ke,ht,Rt,ye,qe,ve,Pe,Le,it,nt=0;for(Le=0;Le<8;++Le){We=Ie[nt],Ke=Ie[nt+1],ht=Ie[nt+2],Rt=Ie[nt+3],ye=Ie[nt+4],qe=Ie[nt+5],ve=Ie[nt+6];var _t=We+(Pe=Ie[nt+7]),At=We-Pe,St=Ke+ve,st=Ke-ve,Ot=ht+qe,dt=ht-qe,bt=Rt+ye,ot=Rt-ye,vt=_t+bt,jt=_t-bt,kt=St+Ot,gt=St-Ot;Ie[nt]=vt+kt,Ie[nt+4]=vt-kt;var Gt=.707106781*(gt+jt);Ie[nt+2]=jt+Gt,Ie[nt+6]=jt-Gt;var oi=.382683433*((vt=ot+dt)-(gt=st+At)),bn=.5411961*vt+oi,Cn=1.306562965*gt+oi,li=.707106781*(kt=dt+st),Bt=At+li,Jn=At-li;Ie[nt+5]=Jn+bn,Ie[nt+3]=Jn-bn,Ie[nt+1]=Bt+Cn,Ie[nt+7]=Bt-Cn,nt+=8}for(nt=0,Le=0;Le<8;++Le){We=Ie[nt],Ke=Ie[nt+8],ht=Ie[nt+16],Rt=Ie[nt+24],ye=Ie[nt+32],qe=Ie[nt+40],ve=Ie[nt+48];var qn=We+(Pe=Ie[nt+56]),Pn=We-Pe,jn=Ke+ve,wn=Ke-ve,je=ht+qe,tt=ht-qe,Ft=Rt+ye,nn=Rt-ye,Yt=qn+Ft,Vt=qn-Ft,Lt=jn+je,Qt=jn-je;Ie[nt]=Yt+Lt,Ie[nt+32]=Yt-Lt;var rn=.707106781*(Qt+Vt);Ie[nt+16]=Vt+rn,Ie[nt+48]=Vt-rn;var Mn=.382683433*((Yt=nn+tt)-(Qt=wn+Pn)),Zt=.5411961*Yt+Mn,Qn=1.306562965*Qt+Mn,En=.707106781*(Lt=tt+wn),Wn=Pn+En,Bs=Pn-En;Ie[nt+40]=Bs+Zt,Ie[nt+24]=Bs-Zt,Ie[nt+8]=Wn+Qn,Ie[nt+56]=Wn-Qn,nt++}for(Le=0;Le<64;++Le)it=Ie[Le]*lt[Le],d[Le]=it>0?it+.5|0:it-.5|0;return d})(O,V),ge=0;ge<64;++ge)y[M[ge]]=pe[ge];var Ee=y[0]-G;G=y[0],Ee==0?Z(re[0]):(Z(re[p[ee=32767+Ee]]),Z(f[ee]));for(var Ae=63;Ae>0&&y[Ae]==0;)Ae--;if(Ae==0)return Z(de),G;for(var Ye,K=1;K<=Ae;){for(var Re=K;y[K]==0&&K<=Ae;)++K;var Qe=K-Re;if(Qe>=16){Ye=Qe>>4;for(var Be=1;Be<=Ye;++Be)Z(he);Qe&=15}ee=32767+y[K],Z(ae[(Qe<<4)+p[ee]]),Z(f[ee]),K++}return Ae!=63&&Z(de),G}function le(O){O=Math.min(Math.max(O,1),100),s!=O&&((function(V){for(var G=[16,11,10,16,24,40,51,61,12,12,14,19,26,58,60,55,14,13,16,24,40,57,69,56,14,17,22,29,51,87,80,62,18,22,37,56,68,109,103,77,24,35,55,64,81,104,113,92,49,64,78,87,103,121,120,101,72,92,95,98,112,100,103,99],re=0;re<64;re++){var ae=a((G[re]*V+50)/100);ae=Math.min(Math.max(ae,1),255),o[M[re]]=ae}for(var ee=[17,18,24,47,99,99,99,99,18,21,26,66,99,99,99,99,24,26,56,99,99,99,99,99,47,66,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99],de=0;de<64;de++){var he=a((ee[de]*V+50)/100);he=Math.min(Math.max(he,1),255),l[M[de]]=he}for(var pe=[1,1.387039845,1.306562965,1.175875602,1,.785694958,.5411961,.275899379],ge=0,Ee=0;Ee<8;Ee++)for(var Ae=0;Ae<8;Ae++)c[ge]=1/(o[M[ge]]*pe[Ee]*pe[Ae]*8),u[ge]=1/(l[M[ge]]*pe[Ee]*pe[Ae]*8),ge++})(O<50?Math.floor(5e3/O):Math.floor(200-2*O)),s=O)}this.encode=function(O,V){V&&le(V),m=new Array,w=0,b=7,Y(65496),Y(65504),Y(16),W(74),W(70),W(73),W(70),W(0),W(1),W(1),W(0),Y(1),Y(1),W(0),W(0),(function(){Y(65499),Y(132),W(0);for(var Ke=0;Ke<64;Ke++)W(o[Ke]);W(1);for(var ht=0;ht<64;ht++)W(l[ht])})(),(function(Ke,ht){Y(65472),Y(17),W(8),Y(ht),Y(Ke),W(3),W(1),W(17),W(0),W(2),W(17),W(1),W(3),W(17),W(1)})(O.width,O.height),(function(){Y(65476),Y(418),W(0);for(var Ke=0;Ke<16;Ke++)W(T[Ke+1]);for(var ht=0;ht<=11;ht++)W(D[ht]);W(16);for(var Rt=0;Rt<16;Rt++)W(U[Rt+1]);for(var ye=0;ye<=161;ye++)W(C[ye]);W(1);for(var qe=0;qe<16;qe++)W(N[qe+1]);for(var ve=0;ve<=11;ve++)W(B[ve]);W(17);for(var Pe=0;Pe<16;Pe++)W(P[Pe+1]);for(var Le=0;Le<=161;Le++)W(F[Le])})(),Y(65498),Y(12),W(3),W(1),W(0),W(2),W(17),W(3),W(17),W(0),W(63),W(0);var G=0,re=0,ae=0;w=0,b=7,this.encode.displayName="_encode_";for(var ee,de,he,pe,ge,Ee,Ae,Ye,K,Re=O.data,Qe=O.width,Be=O.height,Ie=4*Qe,lt=0;lt<Be;){for(ee=0;ee<Ie;){for(ge=Ie*lt+ee,Ae=-1,Ye=0,K=0;K<64;K++)Ee=ge+(Ye=K>>3)*Ie+(Ae=4*(7&K)),lt+Ye>=Be&&(Ee-=Ie*(lt+1+Ye-Be)),ee+Ae>=Ie&&(Ee-=ee+Ae-Ie+4),de=Re[Ee++],he=Re[Ee++],pe=Re[Ee++],S[K]=(E[de]+E[he+256|0]+E[pe+512|0]>>16)-128,A[K]=(E[de+768|0]+E[he+1024|0]+E[pe+1280|0]>>16)-128,_[K]=(E[de+1280|0]+E[he+1536|0]+E[pe+1792|0]>>16)-128;G=ue(S,c,G,e,i),re=ue(A,u,re,n,r),ae=ue(_,u,ae,n,r),ee+=32}lt+=8}if(b>=0){var We=[];We[1]=b+1,We[0]=(1<<b+1)-1,Z(We)}return Y(65497),new Uint8Array(m)},t=t||50,(function(){for(var O=String.fromCharCode,V=0;V<256;V++)I[V]=O(V)})(),e=q(T,D),n=q(N,B),i=q(U,C),r=q(P,F),(function(){for(var O=1,V=2,G=1;G<=15;G++){for(var re=O;re<V;re++)p[32767+re]=G,f[32767+re]=[],f[32767+re][1]=G,f[32767+re][0]=re;for(var ae=-(V-1);ae<=-O;ae++)p[32767+ae]=G,f[32767+ae]=[],f[32767+ae][1]=G,f[32767+ae][0]=V-1+ae;O<<=1,V<<=1}})(),(function(){for(var O=0;O<256;O++)E[O]=19595*O,E[O+256|0]=38470*O,E[O+512|0]=7471*O+32768,E[O+768|0]=-11059*O,E[O+1024|0]=-21709*O,E[O+1280|0]=32768*O+8421375,E[O+1536|0]=-27439*O,E[O+1792|0]=-5329*O})(),le(t)}function Aa(t,e){if(this.pos=0,this.buffer=t,this.datav=new DataView(t.buffer),this.is_with_alpha=!!e,this.bottom_up=!0,this.flag=String.fromCharCode(this.buffer[0])+String.fromCharCode(this.buffer[1]),this.pos+=2,["BM","BA","CI","CP","IC","PT"].indexOf(this.flag)===-1)throw new Error("Invalid BMP File");this.parseHeader(),this.parseBGR()}function Hy(t){function e(D){if(!D)throw Error("assert :P")}function n(D,U,C){for(var N=0;4>N;N++)if(D[U+N]!=C.charCodeAt(N))return!0;return!1}function i(D,U,C,N,B){for(var P=0;P<B;P++)D[U+P]=C[N+P]}function r(D,U,C,N){for(var B=0;B<N;B++)D[U+B]=C}function s(D){return new Int32Array(D)}function a(D,U){for(var C=[],N=0;N<D;N++)C.push(new U);return C}function o(D,U){var C=[];return(function N(B,P,F){for(var q=F[P],Z=0;Z<q&&(B.push(F.length>P+1?[]:new U),!(F.length<P+1));Z++)N(B[Z],P+1,F)})(C,0,D),C}var l=function(){var D=this;function U(g,v){for(var k=1<<v-1>>>0;g&k;)k>>>=1;return k?(g&k-1)+k:g}function C(g,v,k,L,z){e(!(L%k));do g[v+(L-=k)]=z;while(0<L)}function N(g,v,k,L,z){if(e(2328>=z),512>=z)var H=s(512);else if((H=s(z))==null)return 0;return(function(X,$,ie,oe,we,De){var ce,Se,Ce=$,He=1<<ie,Te=s(16),Xe=s(16);for(e(we!=0),e(oe!=null),e(X!=null),e(0<ie),Se=0;Se<we;++Se){if(15<oe[Se])return 0;++Te[oe[Se]]}if(Te[0]==we)return 0;for(Xe[1]=0,ce=1;15>ce;++ce){if(Te[ce]>1<<ce)return 0;Xe[ce+1]=Xe[ce]+Te[ce]}for(Se=0;Se<we;++Se)ce=oe[Se],0<oe[Se]&&(De[Xe[ce]++]=Se);if(Xe[15]==1)return(oe=new B).g=0,oe.value=De[0],C(X,Ce,1,He,oe),He;var Ze,at=-1,et=He-1,Ht=0,Pt=1,un=1,Nt=1<<ie;for(Se=0,ce=1,we=2;ce<=ie;++ce,we<<=1){if(Pt+=un<<=1,0>(un-=Te[ce]))return 0;for(;0<Te[ce];--Te[ce])(oe=new B).g=ce,oe.value=De[Se++],C(X,Ce+Ht,we,Nt,oe),Ht=U(Ht,ce)}for(ce=ie+1,we=2;15>=ce;++ce,we<<=1){if(Pt+=un<<=1,0>(un-=Te[ce]))return 0;for(;0<Te[ce];--Te[ce]){if(oe=new B,(Ht&et)!=at){for(Ce+=Nt,Ze=1<<(at=ce)-ie;15>at&&!(0>=(Ze-=Te[at]));)++at,Ze<<=1;He+=Nt=1<<(Ze=at-ie),X[$+(at=Ht&et)].g=Ze+ie,X[$+at].value=Ce-$-at}oe.g=ce-ie,oe.value=De[Se++],C(X,Ce+(Ht>>ie),we,Nt,oe),Ht=U(Ht,ce)}}return Pt!=2*Xe[15]-1?0:He})(g,v,k,L,z,H)}function B(){this.value=this.g=0}function P(){this.value=this.g=0}function F(){this.G=a(5,B),this.H=s(5),this.jc=this.Qb=this.qb=this.nd=0,this.pd=a(cs,P)}function q(g,v,k,L){e(g!=null),e(v!=null),e(2147483648>L),g.Ca=254,g.I=0,g.b=-8,g.Ka=0,g.oa=v,g.pa=k,g.Jd=v,g.Yc=k+L,g.Zc=4<=L?k+L-4+1:k,de(g)}function Z(g,v){for(var k=0;0<v--;)k|=pe(g,128)<<v;return k}function W(g,v){var k=Z(g,v);return he(g)?-k:k}function Y(g,v,k,L){var z,H=0;for(e(g!=null),e(v!=null),e(4294967288>L),g.Sb=L,g.Ra=0,g.u=0,g.h=0,4<L&&(L=4),z=0;z<L;++z)H+=v[k+z]<<8*z;g.Ra=H,g.bb=L,g.oa=v,g.pa=k}function ue(g){for(;8<=g.u&&g.bb<g.Sb;)g.Ra>>>=8,g.Ra+=g.oa[g.pa+g.bb]<<Ga-8>>>0,++g.bb,g.u-=8;re(g)&&(g.h=1,g.u=0)}function le(g,v){if(e(0<=v),!g.h&&v<=Wr){var k=G(g)&Ui[v];return g.u+=v,ue(g),k}return g.h=1,g.u=0}function O(){this.b=this.Ca=this.I=0,this.oa=[],this.pa=0,this.Jd=[],this.Yc=0,this.Zc=[],this.Ka=0}function V(){this.Ra=0,this.oa=[],this.h=this.u=this.bb=this.Sb=this.pa=0}function G(g){return g.Ra>>>(g.u&Ga-1)>>>0}function re(g){return e(g.bb<=g.Sb),g.h||g.bb==g.Sb&&g.u>Ga}function ae(g,v){g.u=v,g.h=re(g)}function ee(g){g.u>=ma&&(e(g.u>=ma),ue(g))}function de(g){e(g!=null&&g.oa!=null),g.pa<g.Zc?(g.I=(g.oa[g.pa++]|g.I<<8)>>>0,g.b+=8):(e(g!=null&&g.oa!=null),g.pa<g.Yc?(g.b+=8,g.I=g.oa[g.pa++]|g.I<<8):g.Ka?g.b=0:(g.I<<=8,g.b+=8,g.Ka=1))}function he(g){return Z(g,1)}function pe(g,v){var k=g.Ca;0>g.b&&de(g);var L=g.b,z=k*v>>>8,H=(g.I>>>L>z)+0;for(H?(k-=z,g.I-=z+1<<L>>>0):k=z+1,L=k,z=0;256<=L;)z+=8,L>>=8;return L=7^z+Vr[L],g.b-=L,g.Ca=(k<<L)-1,H}function ge(g,v,k){g[v+0]=k>>24&255,g[v+1]=k>>16&255,g[v+2]=k>>8&255,g[v+3]=255&k}function Ee(g,v){return g[v+0]|g[v+1]<<8}function Ae(g,v){return Ee(g,v)|g[v+2]<<16}function Ye(g,v){return Ee(g,v)|Ee(g,v+2)<<16}function K(g,v){var k=1<<v;return e(g!=null),e(0<v),g.X=s(k),g.X==null?0:(g.Mb=32-v,g.Xa=v,1)}function Re(g,v){e(g!=null),e(v!=null),e(g.Xa==v.Xa),i(v.X,0,g.X,0,1<<v.Xa)}function Qe(){this.X=[],this.Xa=this.Mb=0}function Be(g,v,k,L){e(k!=null),e(L!=null);var z=k[0],H=L[0];return z==0&&(z=(g*H+v/2)/v),H==0&&(H=(v*z+g/2)/g),0>=z||0>=H?0:(k[0]=z,L[0]=H,1)}function Ie(g,v){return g+(1<<v)-1>>>v}function lt(g,v){return((4278255360&g)+(4278255360&v)>>>0&4278255360)+((16711935&g)+(16711935&v)>>>0&16711935)>>>0}function We(g,v){D[v]=function(k,L,z,H,X,$,ie){var oe;for(oe=0;oe<X;++oe){var we=D[g]($[ie+oe-1],z,H+oe);$[ie+oe]=lt(k[L+oe],we)}}}function Ke(){this.ud=this.hd=this.jd=0}function ht(g,v){return((4278124286&(g^v))>>>1)+(g&v)>>>0}function Rt(g){return 0<=g&&256>g?g:0>g?0:255<g?255:void 0}function ye(g,v){return Rt(g+(g-v+.5>>1))}function qe(g,v,k){return Math.abs(v-k)-Math.abs(g-k)}function ve(g,v,k,L,z,H,X){for(L=H[X-1],k=0;k<z;++k)H[X+k]=L=lt(g[v+k],L)}function Pe(g,v,k,L,z){var H;for(H=0;H<k;++H){var X=g[v+H],$=X>>8&255,ie=16711935&(ie=(ie=16711935&X)+(($<<16)+$));L[z+H]=(4278255360&X)+ie>>>0}}function Le(g,v){v.jd=255&g,v.hd=g>>8&255,v.ud=g>>16&255}function it(g,v,k,L,z,H){var X;for(X=0;X<L;++X){var $=v[k+X],ie=$>>>8,oe=$,we=255&(we=(we=$>>>16)+((g.jd<<24>>24)*(ie<<24>>24)>>>5));oe=255&(oe=(oe+=(g.hd<<24>>24)*(ie<<24>>24)>>>5)+((g.ud<<24>>24)*(we<<24>>24)>>>5)),z[H+X]=(4278255360&$)+(we<<16)+oe}}function nt(g,v,k,L,z){D[v]=function(H,X,$,ie,oe,we,De,ce,Se){for(ie=De;ie<ce;++ie)for(De=0;De<Se;++De)oe[we++]=z($[L(H[X++])])},D[g]=function(H,X,$,ie,oe,we,De){var ce=8>>H.b,Se=H.Ea,Ce=H.K[0],He=H.w;if(8>ce)for(H=(1<<H.b)-1,He=(1<<ce)-1;X<$;++X){var Te,Xe=0;for(Te=0;Te<Se;++Te)Te&H||(Xe=L(ie[oe++])),we[De++]=z(Ce[Xe&He]),Xe>>=ce}else D["VP8LMapColor"+k](ie,oe,Ce,He,we,De,X,$,Se)}}function _t(g,v,k,L,z){for(k=v+k;v<k;){var H=g[v++];L[z++]=H>>16&255,L[z++]=H>>8&255,L[z++]=255&H}}function At(g,v,k,L,z){for(k=v+k;v<k;){var H=g[v++];L[z++]=H>>16&255,L[z++]=H>>8&255,L[z++]=255&H,L[z++]=H>>24&255}}function St(g,v,k,L,z){for(k=v+k;v<k;){var H=(X=g[v++])>>16&240|X>>12&15,X=240&X|X>>28&15;L[z++]=H,L[z++]=X}}function st(g,v,k,L,z){for(k=v+k;v<k;){var H=(X=g[v++])>>16&248|X>>13&7,X=X>>5&224|X>>3&31;L[z++]=H,L[z++]=X}}function Ot(g,v,k,L,z){for(k=v+k;v<k;){var H=g[v++];L[z++]=255&H,L[z++]=H>>8&255,L[z++]=H>>16&255}}function dt(g,v,k,L,z,H){if(H==0)for(k=v+k;v<k;)ge(L,((H=g[v++])[0]>>24|H[1]>>8&65280|H[2]<<8&16711680|H[3]<<24)>>>0),z+=32;else i(L,z,g,v,k)}function bt(g,v){D[v][0]=D[g+"0"],D[v][1]=D[g+"1"],D[v][2]=D[g+"2"],D[v][3]=D[g+"3"],D[v][4]=D[g+"4"],D[v][5]=D[g+"5"],D[v][6]=D[g+"6"],D[v][7]=D[g+"7"],D[v][8]=D[g+"8"],D[v][9]=D[g+"9"],D[v][10]=D[g+"10"],D[v][11]=D[g+"11"],D[v][12]=D[g+"12"],D[v][13]=D[g+"13"],D[v][14]=D[g+"0"],D[v][15]=D[g+"0"]}function ot(g){return g==Ju||g==Qu||g==xa||g==Za}function vt(){this.eb=[],this.size=this.A=this.fb=0}function jt(){this.y=[],this.f=[],this.ea=[],this.F=[],this.Tc=this.Ed=this.Cd=this.Fd=this.lb=this.Db=this.Ab=this.fa=this.J=this.W=this.N=this.O=0}function kt(){this.Rd=this.height=this.width=this.S=0,this.f={},this.f.RGBA=new vt,this.f.kb=new jt,this.sd=null}function gt(){this.width=[0],this.height=[0],this.Pd=[0],this.Qd=[0],this.format=[0]}function Gt(){this.Id=this.fd=this.Md=this.hb=this.ib=this.da=this.bd=this.cd=this.j=this.v=this.Da=this.Sd=this.ob=0}function oi(g){return alert("todo:WebPSamplerProcessPlane"),g.T}function bn(g,v){var k=g.T,L=v.ba.f.RGBA,z=L.eb,H=L.fb+g.ka*L.A,X=nr[v.ba.S],$=g.y,ie=g.O,oe=g.f,we=g.N,De=g.ea,ce=g.W,Se=v.cc,Ce=v.dc,He=v.Mc,Te=v.Nc,Xe=g.ka,Ze=g.ka+g.T,at=g.U,et=at+1>>1;for(Xe==0?X($,ie,null,null,oe,we,De,ce,oe,we,De,ce,z,H,null,null,at):(X(v.ec,v.fc,$,ie,Se,Ce,He,Te,oe,we,De,ce,z,H-L.A,z,H,at),++k);Xe+2<Ze;Xe+=2)Se=oe,Ce=we,He=De,Te=ce,we+=g.Rc,ce+=g.Rc,H+=2*L.A,X($,(ie+=2*g.fa)-g.fa,$,ie,Se,Ce,He,Te,oe,we,De,ce,z,H-L.A,z,H,at);return ie+=g.fa,g.j+Ze<g.o?(i(v.ec,v.fc,$,ie,at),i(v.cc,v.dc,oe,we,et),i(v.Mc,v.Nc,De,ce,et),k--):1&Ze||X($,ie,null,null,oe,we,De,ce,oe,we,De,ce,z,H+L.A,null,null,at),k}function Cn(g,v,k){var L=g.F,z=[g.J];if(L!=null){var H=g.U,X=v.ba.S,$=X==wa||X==xa;v=v.ba.f.RGBA;var ie=[0],oe=g.ka;ie[0]=g.T,g.Kb&&(oe==0?--ie[0]:(--oe,z[0]-=g.width),g.j+g.ka+g.T==g.o&&(ie[0]=g.o-g.j-oe));var we=v.eb;oe=v.fb+oe*v.A,g=Io(L,z[0],g.width,H,ie,we,oe+($?0:3),v.A),e(k==ie),g&&ot(X)&&pc(we,oe,$,H,ie,v.A)}return 0}function li(g){var v=g.ma,k=v.ba.S,L=11>k,z=k==Yc||k==Kc||k==wa||k==Ka||k==12||ot(k);if(v.memory=null,v.Ib=null,v.Jb=null,v.Nd=null,!lc(v.Oa,g,z?11:12))return 0;if(z&&ot(k)&&Vs(),g.da)alert("todo:use_scaling");else{if(L){if(v.Ib=oi,g.Kb){if(k=g.U+1>>1,v.memory=s(g.U+2*k),v.memory==null)return 0;v.ec=v.memory,v.fc=0,v.cc=v.ec,v.dc=v.fc+g.U,v.Mc=v.cc,v.Nc=v.dc+k,v.Ib=bn,Vs()}}else alert("todo:EmitYUV");z&&(v.Jb=Cn,L&&Ps())}if(L&&!xf){for(g=0;256>g;++g)kl[g]=89858*(g-128)+Sa>>Zc,Zp[g]=-22014*(g-128)+Sa,Kp[g]=-45773*(g-128),Al[g]=113618*(g-128)+Sa>>Zc;for(g=Zs;g<$u;++g)v=76283*(g-16)+Sa>>Zc,Jp[g-Zs]=Hi(v,255),Nl[g-Zs]=Hi(v+8>>4,15);xf=1}return 1}function Bt(g){var v=g.ma,k=g.U,L=g.T;return e(!(1&g.ka)),0>=k||0>=L?0:(k=v.Ib(g,v),v.Jb!=null&&v.Jb(g,v,k),v.Dc+=k,1)}function Jn(g){g.ma.memory=null}function qn(g,v,k,L){return le(g,8)!=47?0:(v[0]=le(g,14)+1,k[0]=le(g,14)+1,L[0]=le(g,1),le(g,3)!=0?0:!g.h)}function Pn(g,v){if(4>g)return g+1;var k=g-2>>1;return(2+(1&g)<<k)+le(v,k)+1}function jn(g,v){return 120<v?v-120:1<=(k=((k=Fp[v-1])>>4)*g+(8-(15&k)))?k:1;var k}function wn(g,v,k){var L=G(k),z=g[v+=255&L].g-8;return 0<z&&(ae(k,k.u+8),L=G(k),v+=g[v].value,v+=L&(1<<z)-1),ae(k,k.u+g[v].g),g[v].value}function je(g,v,k){return k.g+=g.g,k.value+=g.value<<v>>>0,e(8>=k.g),g.g}function tt(g,v,k){var L=g.xc;return e((v=L==0?0:g.vc[g.md*(k>>L)+(v>>L)])<g.Wb),g.Ya[v]}function Ft(g,v,k,L){var z=g.ab,H=g.c*v,X=g.C;v=X+v;var $=k,ie=L;for(L=g.Ta,k=g.Ua;0<z--;){var oe=g.gc[z],we=X,De=v,ce=$,Se=ie,Ce=(ie=L,$=k,oe.Ea);switch(e(we<De),e(De<=oe.nc),oe.hc){case 2:xi(ce,Se,(De-we)*Ce,ie,$);break;case 0:var He=we,Te=De,Xe=ie,Ze=$,at=(Nt=oe).Ea;He==0&&(Xs(ce,Se,null,null,1,Xe,Ze),ve(ce,Se+1,0,0,at-1,Xe,Ze+1),Se+=at,Ze+=at,++He);for(var et=1<<Nt.b,Ht=et-1,Pt=Ie(at,Nt.b),un=Nt.K,Nt=Nt.w+(He>>Nt.b)*Pt;He<Te;){var hn=un,Ti=Nt,dn=1;for(wl(ce,Se,Xe,Ze-at,1,Xe,Ze);dn<at;){var Mt=(dn&~Ht)+et;Mt>at&&(Mt=at),(0,dc[hn[Ti++]>>8&15])(ce,Se+ +dn,Xe,Ze+dn-at,Mt-dn,Xe,Ze+dn),dn=Mt}Se+=at,Ze+=at,++He&Ht||(Nt+=Pt)}De!=oe.nc&&i(ie,$-Ce,ie,$+(De-we-1)*Ce,Ce);break;case 1:for(Ce=ce,Te=Se,at=(ce=oe.Ea)-(Ze=ce&~(Xe=(Se=1<<oe.b)-1)),He=Ie(ce,oe.b),et=oe.K,oe=oe.w+(we>>oe.b)*He;we<De;){for(Ht=et,Pt=oe,un=new Ke,Nt=Te+Ze,hn=Te+ce;Te<Nt;)Le(Ht[Pt++],un),fc(un,Ce,Te,Se,ie,$),Te+=Se,$+=Se;Te<hn&&(Le(Ht[Pt++],un),fc(un,Ce,Te,at,ie,$),Te+=at,$+=at),++we&Xe||(oe+=He)}break;case 3:if(ce==ie&&Se==$&&0<oe.b){for(Te=ie,ce=Ce=$+(De-we)*Ce-(Ze=(De-we)*Ie(oe.Ea,oe.b)),Se=ie,Xe=$,He=[],Ze=(at=Ze)-1;0<=Ze;--Ze)He[Ze]=Se[Xe+Ze];for(Ze=at-1;0<=Ze;--Ze)Te[ce+Ze]=He[Ze];Gc(oe,we,De,ie,Ce,ie,$)}else Gc(oe,we,De,ce,Se,ie,$)}$=L,ie=k}ie!=k&&i(L,k,$,ie,H)}function nn(g,v){var k=g.V,L=g.Ba+g.c*g.C,z=v-g.C;if(e(v<=g.l.o),e(16>=z),0<z){var H=g.l,X=g.Ta,$=g.Ua,ie=H.width;if(Ft(g,z,k,L),z=$=[$],e((k=g.C)<(L=v)),e(H.v<H.va),L>H.o&&(L=H.o),k<H.j){var oe=H.j-k;k=H.j,z[0]+=oe*ie}if(k>=L?k=0:(z[0]+=4*H.v,H.ka=k-H.j,H.U=H.va-H.v,H.T=L-k,k=1),k){if($=$[0],11>(k=g.ca).S){var we=k.f.RGBA,De=(L=k.S,z=H.U,H=H.T,oe=we.eb,we.A),ce=H;for(we=we.fb+g.Ma*we.A;0<ce--;){var Se=X,Ce=$,He=z,Te=oe,Xe=we;switch(L){case ba:Ys(Se,Ce,He,Te,Xe);break;case Yc:Gr(Se,Ce,He,Te,Xe);break;case Ju:Gr(Se,Ce,He,Te,Xe),pc(Te,Xe,0,He,1,0);break;case gf:Co(Se,Ce,He,Te,Xe);break;case Kc:dt(Se,Ce,He,Te,Xe,1);break;case Qu:dt(Se,Ce,He,Te,Xe,1),pc(Te,Xe,0,He,1,0);break;case wa:dt(Se,Ce,He,Te,Xe,0);break;case xa:dt(Se,Ce,He,Te,Xe,0),pc(Te,Xe,1,He,1,0);break;case Ka:Xa(Se,Ce,He,Te,Xe);break;case Za:Xa(Se,Ce,He,Te,Xe),df(Te,Xe,He,1,0);break;case mf:Ya(Se,Ce,He,Te,Xe);break;default:e(0)}$+=ie,we+=De}g.Ma+=H}else alert("todo:EmitRescaledRowsYUVA");e(g.Ma<=k.height)}}g.C=v,e(g.C<=g.i)}function Yt(g){var v;if(0<g.ua)return 0;for(v=0;v<g.Wb;++v){var k=g.Ya[v].G,L=g.Ya[v].H;if(0<k[1][L[1]+0].g||0<k[2][L[2]+0].g||0<k[3][L[3]+0].g)return 0}return 1}function Vt(g,v,k,L,z,H){if(g.Z!=0){var X=g.qd,$=g.rd;for(e(Zr[g.Z]!=null);v<k;++v)Zr[g.Z](X,$,L,z,L,z,H),X=L,$=z,z+=H;g.qd=X,g.rd=$}}function Lt(g,v){var k=g.l.ma,L=k.Z==0||k.Z==1?g.l.j:g.C;if(L=g.C<L?L:g.C,e(v<=g.l.o),v>L){var z=g.l.width,H=k.ca,X=k.tb+z*L,$=g.V,ie=g.Ba+g.c*L,oe=g.gc;e(g.ab==1),e(oe[0].hc==3),xr(oe[0],L,v,$,ie,H,X),Vt(k,L,v,H,X,z)}g.C=g.Ma=v}function Qt(g,v,k,L,z,H,X){var $=g.$/L,ie=g.$%L,oe=g.m,we=g.s,De=k+g.$,ce=De;z=k+L*z;var Se=k+L*H,Ce=280+we.ua,He=g.Pb?$:16777216,Te=0<we.ua?we.Wa:null,Xe=we.wc,Ze=De<Se?tt(we,ie,$):null;e(g.C<H),e(Se<=z);var at=!1;e:for(;;){for(;at||De<Se;){var et=0;if($>=He){var Ht=De-k;e((He=g).Pb),He.wd=He.m,He.xd=Ht,0<He.s.ua&&Re(He.s.Wa,He.s.vb),He=$+Bp}if(ie&Xe||(Ze=tt(we,ie,$)),e(Ze!=null),Ze.Qb&&(v[De]=Ze.qb,at=!0),!at)if(ee(oe),Ze.jc){et=oe,Ht=v;var Pt=De,un=Ze.pd[G(et)&cs-1];e(Ze.jc),256>un.g?(ae(et,et.u+un.g),Ht[Pt]=un.value,et=0):(ae(et,et.u+un.g-256),e(256<=un.value),et=un.value),et==0&&(at=!0)}else et=wn(Ze.G[0],Ze.H[0],oe);if(oe.h)break;if(at||256>et){if(!at)if(Ze.nd)v[De]=(Ze.qb|et<<8)>>>0;else{if(ee(oe),at=wn(Ze.G[1],Ze.H[1],oe),ee(oe),Ht=wn(Ze.G[2],Ze.H[2],oe),Pt=wn(Ze.G[3],Ze.H[3],oe),oe.h)break;v[De]=(Pt<<24|at<<16|et<<8|Ht)>>>0}if(at=!1,++De,++ie>=L&&(ie=0,++$,X!=null&&$<=H&&!($%16)&&X(g,$),Te!=null))for(;ce<De;)et=v[ce++],Te.X[(506832829*et&4294967295)>>>Te.Mb]=et}else if(280>et){if(et=Pn(et-256,oe),Ht=wn(Ze.G[4],Ze.H[4],oe),ee(oe),Ht=jn(L,Ht=Pn(Ht,oe)),oe.h)break;if(De-k<Ht||z-De<et)break e;for(Pt=0;Pt<et;++Pt)v[De+Pt]=v[De+Pt-Ht];for(De+=et,ie+=et;ie>=L;)ie-=L,++$,X!=null&&$<=H&&!($%16)&&X(g,$);if(e(De<=z),ie&Xe&&(Ze=tt(we,ie,$)),Te!=null)for(;ce<De;)et=v[ce++],Te.X[(506832829*et&4294967295)>>>Te.Mb]=et}else{if(!(et<Ce))break e;for(at=et-280,e(Te!=null);ce<De;)et=v[ce++],Te.X[(506832829*et&4294967295)>>>Te.Mb]=et;et=De,e(!(at>>>(Ht=Te).Xa)),v[et]=Ht.X[at],at=!0}at||e(oe.h==re(oe))}if(g.Pb&&oe.h&&De<z)e(g.m.h),g.a=5,g.m=g.wd,g.$=g.xd,0<g.s.ua&&Re(g.s.vb,g.s.Wa);else{if(oe.h)break e;X?.(g,$>H?H:$),g.a=0,g.$=De-k}return 1}return g.a=3,0}function rn(g){e(g!=null),g.vc=null,g.yc=null,g.Ya=null;var v=g.Wa;v!=null&&(v.X=null),g.vb=null,e(g!=null)}function Mn(){var g=new ft;return g==null?null:(g.a=0,g.xb=yf,bt("Predictor","VP8LPredictors"),bt("Predictor","VP8LPredictors_C"),bt("PredictorAdd","VP8LPredictorsAdd"),bt("PredictorAdd","VP8LPredictorsAdd_C"),xi=Pe,fc=it,Ys=_t,Gr=At,Xa=St,Ya=st,Co=Ot,D.VP8LMapColor32b=wr,D.VP8LMapColor8b=uc,g)}function Zt(g,v,k,L,z){var H=1,X=[g],$=[v],ie=L.m,oe=L.s,we=null,De=0;e:for(;;){if(k)for(;H&&le(ie,1);){var ce=X,Se=$,Ce=L,He=1,Te=Ce.m,Xe=Ce.gc[Ce.ab],Ze=le(Te,2);if(Ce.Oc&1<<Ze)H=0;else{switch(Ce.Oc|=1<<Ze,Xe.hc=Ze,Xe.Ea=ce[0],Xe.nc=Se[0],Xe.K=[null],++Ce.ab,e(4>=Ce.ab),Ze){case 0:case 1:Xe.b=le(Te,3)+2,He=Zt(Ie(Xe.Ea,Xe.b),Ie(Xe.nc,Xe.b),0,Ce,Xe.K),Xe.K=Xe.K[0];break;case 3:var at,et=le(Te,8)+1,Ht=16<et?0:4<et?1:2<et?2:3;if(ce[0]=Ie(Xe.Ea,Ht),Xe.b=Ht,at=He=Zt(et,1,0,Ce,Xe.K)){var Pt,un=et,Nt=Xe,hn=1<<(8>>Nt.b),Ti=s(hn);if(Ti==null)at=0;else{var dn=Nt.K[0],Mt=Nt.w;for(Ti[0]=Nt.K[0][0],Pt=1;Pt<1*un;++Pt)Ti[Pt]=lt(dn[Mt+Pt],Ti[Pt-1]);for(;Pt<4*hn;++Pt)Ti[Pt]=0;Nt.K[0]=null,Nt.K[0]=Ti,at=1}}He=at;break;case 2:break;default:e(0)}H=He}}if(X=X[0],$=$[0],H&&le(ie,1)&&!(H=1<=(De=le(ie,4))&&11>=De)){L.a=3;break e}var pt;if(pt=H)t:{var Gn,on,xn,ei=L,gi=X,Ai=$,mi=De,pr=k,_r=ei.m,ci=ei.s,gn=[null],Dn=1,vi=0,On=Rp[mi];n:for(;;){if(pr&&le(_r,1)){var yi=le(_r,3)+2,gr=Ie(gi,yi),_i=Ie(Ai,yi),Lr=gr*_i;if(!Zt(gr,_i,0,ei,gn))break n;for(gn=gn[0],ci.xc=yi,Gn=0;Gn<Lr;++Gn){var Hn=gn[Gn]>>8&65535;gn[Gn]=Hn,Hn>=Dn&&(Dn=Hn+1)}}if(_r.h)break n;for(on=0;5>on;++on){var ui=vf[on];!on&&0<mi&&(ui+=1<<mi),vi<ui&&(vi=ui)}var Wi=a(Dn*On,B),Sr=Dn,Jr=a(Sr,F);if(Jr==null)var Qr=null;else e(65536>=Sr),Qr=Jr;var Di=s(vi);if(Qr==null||Di==null||Wi==null){ei.a=1;break n}var Vi=Wi;for(Gn=xn=0;Gn<Dn;++Gn){var Xn=Qr[Gn],$r=Xn.G,Ls=Xn.H,fs=0,Mr=1,ir=0;for(on=0;5>on;++on){ui=vf[on],$r[on]=Vi,Ls[on]=xn,!on&&0<mi&&(ui+=1<<mi);r:{var Qc,ed=ui,ka=ei,Js=Di,eg=Vi,tg=xn,td=0,es=ka.m,zo=le(es,1);if(r(Js,0,0,ed),zo){var ng=le(es,1)+1,J_=le(es,1),R0=le(es,J_==0?1:8);Js[R0]=1,ng==2&&(Js[R0=le(es,8)]=1);var _f=1}else{var B0=s(19),z0=le(es,4)+4;if(19<z0){ka.a=3;var Sf=0;break r}for(Qc=0;Qc<z0;++Qc)B0[_l[Qc]]=le(es,3);var ig=void 0,nd=void 0,q0=ka,Q_=B0,kf=ed,j0=Js,rg=0,Cl=q0.m,H0=8,U0=a(128,B);i:for(;N(U0,0,7,Q_,19);){if(le(Cl,1)){var $_=2+2*le(Cl,3);if((ig=2+le(Cl,$_))>kf)break i}else ig=kf;for(nd=0;nd<kf&&ig--;){ee(Cl);var W0=U0[0+(127&G(Cl))];ae(Cl,Cl.u+W0.g);var $c=W0.value;if(16>$c)j0[nd++]=$c,$c!=0&&(H0=$c);else{var e3=$c==16,V0=$c-16,t3=Op[V0],G0=le(Cl,Dp[V0])+t3;if(nd+G0>kf)break i;for(var n3=e3?H0:0;0<G0--;)j0[nd++]=n3}}rg=1;break i}rg||(q0.a=3),_f=rg}(_f=_f&&!es.h)&&(td=N(eg,tg,8,Js,ed)),_f&&td!=0?Sf=td:(ka.a=3,Sf=0)}if(Sf==0)break n;if(Mr&&xl[on]==1&&(Mr=Vi[xn].g==0),fs+=Vi[xn].g,xn+=Sf,3>=on){var id,sg=Di[0];for(id=1;id<ui;++id)Di[id]>sg&&(sg=Di[id]);ir+=sg}}if(Xn.nd=Mr,Xn.Qb=0,Mr&&(Xn.qb=($r[3][Ls[3]+0].value<<24|$r[1][Ls[1]+0].value<<16|$r[2][Ls[2]+0].value)>>>0,fs==0&&256>$r[0][Ls[0]+0].value&&(Xn.Qb=1,Xn.qb+=$r[0][Ls[0]+0].value<<8)),Xn.jc=!Xn.Qb&&6>ir,Xn.jc){var Af,qo=Xn;for(Af=0;Af<cs;++Af){var Pl=Af,El=qo.pd[Pl],Nf=qo.G[0][qo.H[0]+Pl];256<=Nf.value?(El.g=Nf.g+256,El.value=Nf.value):(El.g=0,El.value=0,Pl>>=je(Nf,8,El),Pl>>=je(qo.G[1][qo.H[1]+Pl],16,El),Pl>>=je(qo.G[2][qo.H[2]+Pl],0,El),je(qo.G[3][qo.H[3]+Pl],24,El))}}}ci.vc=gn,ci.Wb=Dn,ci.Ya=Qr,ci.yc=Wi,pt=1;break t}pt=0}if(!(H=pt)){L.a=3;break e}if(0<De){if(oe.ua=1<<De,!K(oe.Wa,De)){L.a=1,H=0;break e}}else oe.ua=0;var ag=L,X0=X,i3=$,og=ag.s,lg=og.xc;if(ag.c=X0,ag.i=i3,og.md=Ie(X0,lg),og.wc=lg==0?-1:(1<<lg)-1,k){L.xb=Wp;break e}if((we=s(X*$))==null){L.a=1,H=0;break e}H=(H=Qt(L,we,0,X,$,$,null))&&!ie.h;break e}return H?(z!=null?z[0]=we:(e(we==null),e(k)),L.$=0,k||rn(oe)):rn(oe),H}function Qn(g,v){var k=g.c*g.i,L=k+v+16*v;return e(g.c<=v),g.V=s(L),g.V==null?(g.Ta=null,g.Ua=0,g.a=1,0):(g.Ta=g.V,g.Ua=g.Ba+k+v,1)}function En(g,v){var k=g.C,L=v-k,z=g.V,H=g.Ba+g.c*k;for(e(v<=g.l.o);0<L;){var X=16<L?16:L,$=g.l.ma,ie=g.l.width,oe=ie*X,we=$.ca,De=$.tb+ie*k,ce=g.Ta,Se=g.Ua;Ft(g,X,z,H),Lo(ce,Se,we,De,oe),Vt($,k,k+X,we,De,ie),L-=X,z+=X*g.c,k+=X}e(k==v),g.C=g.Ma=v}function Wn(){this.ub=this.yd=this.td=this.Rb=0}function Bs(){this.Kd=this.Ld=this.Ud=this.Td=this.i=this.c=0}function vo(){this.Fb=this.Bb=this.Cb=0,this.Zb=s(4),this.Lb=s(4)}function or(){this.Yb=(function(){var g=[];return(function v(k,L,z){for(var H=z[L],X=0;X<H&&(k.push(z.length>L+1?[]:0),!(z.length<L+1));X++)v(k[X],L+1,z)})(g,0,[3,11]),g})()}function bs(){this.jb=s(3),this.Wc=o([4,8],or),this.Xc=o([4,17],or)}function zs(){this.Pc=this.wb=this.Tb=this.zd=0,this.vd=new s(4),this.od=new s(4)}function Pr(){this.ld=this.La=this.dd=this.tc=0}function ws(){this.Na=this.la=0}function xs(){this.Sc=[0,0],this.Eb=[0,0],this.Qc=[0,0],this.ia=this.lc=0}function lr(){this.ad=s(384),this.Za=0,this.Ob=s(16),this.$b=this.Ad=this.ia=this.Gc=this.Hc=this.Dd=0}function pl(){this.uc=this.M=this.Nb=0,this.wa=Array(new Pr),this.Y=0,this.ya=Array(new lr),this.aa=0,this.l=new cr}function ua(){this.y=s(16),this.f=s(8),this.ea=s(8)}function gl(){this.cb=this.a=0,this.sc="",this.m=new O,this.Od=new Wn,this.Kc=new Bs,this.ed=new zs,this.Qa=new vo,this.Ic=this.$c=this.Aa=0,this.D=new pl,this.Xb=this.Va=this.Hb=this.zb=this.yb=this.Ub=this.za=0,this.Jc=a(8,O),this.ia=0,this.pb=a(4,xs),this.Pa=new bs,this.Bd=this.kc=0,this.Ac=[],this.Bc=0,this.zc=[0,0,0,0],this.Gd=Array(new ua),this.Hd=0,this.rb=Array(new ws),this.sb=0,this.wa=Array(new Pr),this.Y=0,this.oc=[],this.pc=0,this.sa=[],this.ta=0,this.qa=[],this.ra=0,this.Ha=[],this.B=this.R=this.Ia=0,this.Ec=[],this.M=this.ja=this.Vb=this.Fc=0,this.ya=Array(new lr),this.L=this.aa=0,this.gd=o([4,2],Pr),this.ga=null,this.Fa=[],this.Cc=this.qc=this.P=0,this.Gb=[],this.Uc=0,this.mb=[],this.nb=0,this.rc=[],this.Ga=this.Vc=0}function Hi(g,v){return 0>g?0:g>v?v:g}function cr(){this.T=this.U=this.ka=this.height=this.width=0,this.y=[],this.f=[],this.ea=[],this.Rc=this.fa=this.W=this.N=this.O=0,this.ma="void",this.put="VP8IoPutHook",this.ac="VP8IoSetupHook",this.bc="VP8IoTeardownHook",this.ha=this.Kb=0,this.data=[],this.hb=this.ib=this.da=this.o=this.j=this.va=this.v=this.Da=this.ob=this.w=0,this.F=[],this.J=0}function nc(){var g=new gl;return g!=null&&(g.a=0,g.sc="OK",g.cb=0,g.Xb=0,gc||(gc=Er)),g}function $n(g,v,k){return g.a==0&&(g.a=v,g.sc=k,g.cb=0),0}function Ba(g,v,k){return 3<=k&&g[v+0]==157&&g[v+1]==1&&g[v+2]==42}function fi(g,v){if(g==null)return 0;if(g.a=0,g.sc="OK",v==null)return $n(g,2,"null VP8Io passed to VP8GetHeaders()");var k=v.data,L=v.w,z=v.ha;if(4>z)return $n(g,7,"Truncated header.");var H=k[L+0]|k[L+1]<<8|k[L+2]<<16,X=g.Od;if(X.Rb=!(1&H),X.td=H>>1&7,X.yd=H>>4&1,X.ub=H>>5,3<X.td)return $n(g,3,"Incorrect keyframe parameters.");if(!X.yd)return $n(g,4,"Frame not displayable.");L+=3,z-=3;var $=g.Kc;if(X.Rb){if(7>z)return $n(g,7,"cannot parse picture header");if(!Ba(k,L,z))return $n(g,3,"Bad code word");$.c=16383&(k[L+4]<<8|k[L+3]),$.Td=k[L+4]>>6,$.i=16383&(k[L+6]<<8|k[L+5]),$.Ud=k[L+6]>>6,L+=7,z-=7,g.za=$.c+15>>4,g.Ub=$.i+15>>4,v.width=$.c,v.height=$.i,v.Da=0,v.j=0,v.v=0,v.va=v.width,v.o=v.height,v.da=0,v.ib=v.width,v.hb=v.height,v.U=v.width,v.T=v.height,r((H=g.Pa).jb,0,255,H.jb.length),e((H=g.Qa)!=null),H.Cb=0,H.Bb=0,H.Fb=1,r(H.Zb,0,0,H.Zb.length),r(H.Lb,0,0,H.Lb)}if(X.ub>z)return $n(g,7,"bad partition length");q(H=g.m,k,L,X.ub),L+=X.ub,z-=X.ub,X.Rb&&($.Ld=he(H),$.Kd=he(H)),$=g.Qa;var ie,oe=g.Pa;if(e(H!=null),e($!=null),$.Cb=he(H),$.Cb){if($.Bb=he(H),he(H)){for($.Fb=he(H),ie=0;4>ie;++ie)$.Zb[ie]=he(H)?W(H,7):0;for(ie=0;4>ie;++ie)$.Lb[ie]=he(H)?W(H,6):0}if($.Bb)for(ie=0;3>ie;++ie)oe.jb[ie]=he(H)?Z(H,8):255}else $.Bb=0;if(H.Ka)return $n(g,3,"cannot parse segment header");if(($=g.ed).zd=he(H),$.Tb=Z(H,6),$.wb=Z(H,3),$.Pc=he(H),$.Pc&&he(H)){for(oe=0;4>oe;++oe)he(H)&&($.vd[oe]=W(H,6));for(oe=0;4>oe;++oe)he(H)&&($.od[oe]=W(H,6))}if(g.L=$.Tb==0?0:$.zd?1:2,H.Ka)return $n(g,3,"cannot parse filter header");var we=z;if(z=ie=L,L=ie+we,$=we,g.Xb=(1<<Z(g.m,2))-1,we<3*(oe=g.Xb))k=7;else{for(ie+=3*oe,$-=3*oe,we=0;we<oe;++we){var De=k[z+0]|k[z+1]<<8|k[z+2]<<16;De>$&&(De=$),q(g.Jc[+we],k,ie,De),ie+=De,$-=De,z+=3}q(g.Jc[+oe],k,ie,$),k=ie<L?0:5}if(k!=0)return $n(g,k,"cannot parse partitions");for(k=Z(ie=g.m,7),z=he(ie)?W(ie,4):0,L=he(ie)?W(ie,4):0,$=he(ie)?W(ie,4):0,oe=he(ie)?W(ie,4):0,ie=he(ie)?W(ie,4):0,we=g.Qa,De=0;4>De;++De){if(we.Cb){var ce=we.Zb[De];we.Fb||(ce+=k)}else{if(0<De){g.pb[De]=g.pb[0];continue}ce=k}var Se=g.pb[De];Se.Sc[0]=Ja[Hi(ce+z,127)],Se.Sc[1]=Qa[Hi(ce+0,127)],Se.Eb[0]=2*Ja[Hi(ce+L,127)],Se.Eb[1]=101581*Qa[Hi(ce+$,127)]>>16,8>Se.Eb[1]&&(Se.Eb[1]=8),Se.Qc[0]=Ja[Hi(ce+oe,117)],Se.Qc[1]=Qa[Hi(ce+ie,127)],Se.lc=ce+ie}if(!X.Rb)return $n(g,4,"Not a key frame.");for(he(H),X=g.Pa,k=0;4>k;++k){for(z=0;8>z;++z)for(L=0;3>L;++L)for($=0;11>$;++$)oe=pe(H,Hp[k][z][L][$])?Z(H,8):Sl[k][z][L][$],X.Wc[k][z].Yb[L][$]=oe;for(z=0;17>z;++z)X.Xc[k][z]=X.Wc[k][Up[z]]}return g.kc=he(H),g.kc&&(g.Bd=Z(H,8)),g.cb=1}function Er(g,v,k,L,z,H,X){var $=v[z].Yb[k];for(k=0;16>z;++z){if(!pe(g,$[k+0]))return z;for(;!pe(g,$[k+1]);)if($=v[++z].Yb[0],k=0,z==16)return 16;var ie=v[z+1].Yb;if(pe(g,$[k+2])){var oe=g,we=0;if(pe(oe,(ce=$)[(De=k)+3]))if(pe(oe,ce[De+6])){for($=0,De=2*(we=pe(oe,ce[De+8]))+(ce=pe(oe,ce[De+9+we])),we=0,ce=zp[De];ce[$];++$)we+=we+pe(oe,ce[$]);we+=3+(8<<De)}else pe(oe,ce[De+7])?(we=7+2*pe(oe,165),we+=pe(oe,145)):we=5+pe(oe,159);else we=pe(oe,ce[De+4])?3+pe(oe,ce[De+5]):2;$=ie[2]}else we=1,$=ie[1];ie=X+qp[z],0>(oe=g).b&&de(oe);var De,ce=oe.b,Se=(De=oe.Ca>>1)-(oe.I>>ce)>>31;--oe.b,oe.Ca+=Se,oe.Ca|=1,oe.I-=(De+1&Se)<<ce,H[ie]=((we^Se)-Se)*L[(0<z)+0]}return 16}function ml(g){var v=g.rb[g.sb-1];v.la=0,v.Na=0,r(g.zc,0,0,g.zc.length),g.ja=0}function Ii(g,v,k,L,z){z=g[v+k+32*L]+(z>>3),g[v+k+32*L]=-256&z?0>z?0:255:z}function hi(g,v,k,L,z,H){Ii(g,v,0,k,L+z),Ii(g,v,1,k,L+H),Ii(g,v,2,k,L-H),Ii(g,v,3,k,L-z)}function ur(g){return(20091*g>>16)+g}function yr(g,v,k,L){var z,H=0,X=s(16);for(z=0;4>z;++z){var $=g[v+0]+g[v+8],ie=g[v+0]-g[v+8],oe=(35468*g[v+4]>>16)-ur(g[v+12]),we=ur(g[v+4])+(35468*g[v+12]>>16);X[H+0]=$+we,X[H+1]=ie+oe,X[H+2]=ie-oe,X[H+3]=$-we,H+=4,v++}for(z=H=0;4>z;++z)$=(g=X[H+0]+4)+X[H+8],ie=g-X[H+8],oe=(35468*X[H+4]>>16)-ur(X[H+12]),Ii(k,L,0,0,$+(we=ur(X[H+4])+(35468*X[H+12]>>16))),Ii(k,L,1,0,ie+oe),Ii(k,L,2,0,ie-oe),Ii(k,L,3,0,$-we),H++,L+=32}function vl(g,v,k,L){var z=g[v+0]+4,H=35468*g[v+4]>>16,X=ur(g[v+4]),$=35468*g[v+1]>>16;hi(k,L,0,z+X,g=ur(g[v+1]),$),hi(k,L,1,z+H,g,$),hi(k,L,2,z-H,g,$),hi(k,L,3,z-X,g,$)}function ic(g,v,k,L,z){yr(g,v,k,L),z&&yr(g,v+16,k,L+4)}function Ir(g,v,k,L){us(g,v+0,k,L,1),us(g,v+32,k,L+128,1)}function dr(g,v,k,L){var z;for(g=g[v+0]+4,z=0;4>z;++z)for(v=0;4>v;++v)Ii(k,L,v,z,g)}function rs(g,v,k,L){g[v+0]&&Ln(g,v+0,k,L),g[v+16]&&Ln(g,v+16,k,L+4),g[v+32]&&Ln(g,v+32,k,L+128),g[v+48]&&Ln(g,v+48,k,L+128+4)}function za(g,v,k,L){var z,H=s(16);for(z=0;4>z;++z){var X=g[v+0+z]+g[v+12+z],$=g[v+4+z]+g[v+8+z],ie=g[v+4+z]-g[v+8+z],oe=g[v+0+z]-g[v+12+z];H[0+z]=X+$,H[8+z]=X-$,H[4+z]=oe+ie,H[12+z]=oe-ie}for(z=0;4>z;++z)X=(g=H[0+4*z]+3)+H[3+4*z],$=H[1+4*z]+H[2+4*z],ie=H[1+4*z]-H[2+4*z],oe=g-H[3+4*z],k[L+0]=X+$>>3,k[L+16]=oe+ie>>3,k[L+32]=X-$>>3,k[L+48]=oe-ie>>3,L+=64}function qr(g,v,k){var L,z=v-32,H=Yr,X=255-g[z-1];for(L=0;L<k;++L){var $,ie=H,oe=X+g[v-1];for($=0;$<k;++$)g[v+$]=ie[oe+g[z+$]];v+=32}}function yl(g,v){qr(g,v,4)}function qs(g,v){qr(g,v,8)}function ss(g,v){qr(g,v,16)}function _s(g,v){var k;for(k=0;16>k;++k)i(g,v+32*k,g,v-32,16)}function yo(g,v){var k;for(k=16;0<k;--k)r(g,v,g[v-1],16),v+=32}function jr(g,v,k){var L;for(L=0;16>L;++L)r(v,k+32*L,g,16)}function Ss(g,v){var k,L=16;for(k=0;16>k;++k)L+=g[v-1+32*k]+g[v+k-32];jr(L>>5,g,v)}function Li(g,v){var k,L=8;for(k=0;16>k;++k)L+=g[v-1+32*k];jr(L>>4,g,v)}function qa(g,v){var k,L=8;for(k=0;16>k;++k)L+=g[v+k-32];jr(L>>4,g,v)}function rc(g,v){jr(128,g,v)}function Jt(g,v,k){return g+2*v+k+2>>2}function js(g,v){var k,L=v-32;for(L=new Uint8Array([Jt(g[L-1],g[L+0],g[L+1]),Jt(g[L+0],g[L+1],g[L+2]),Jt(g[L+1],g[L+2],g[L+3]),Jt(g[L+2],g[L+3],g[L+4])]),k=0;4>k;++k)i(g,v+32*k,L,0,L.length)}function ks(g,v){var k=g[v-1],L=g[v-1+32],z=g[v-1+64],H=g[v-1+96];ge(g,v+0,16843009*Jt(g[v-1-32],k,L)),ge(g,v+32,16843009*Jt(k,L,z)),ge(g,v+64,16843009*Jt(L,z,H)),ge(g,v+96,16843009*Jt(z,H,H))}function sc(g,v){var k,L=4;for(k=0;4>k;++k)L+=g[v+k-32]+g[v-1+32*k];for(L>>=3,k=0;4>k;++k)r(g,v+32*k,L,4)}function as(g,v){var k=g[v-1+0],L=g[v-1+32],z=g[v-1+64],H=g[v-1-32],X=g[v+0-32],$=g[v+1-32],ie=g[v+2-32],oe=g[v+3-32];g[v+0+96]=Jt(L,z,g[v-1+96]),g[v+1+96]=g[v+0+64]=Jt(k,L,z),g[v+2+96]=g[v+1+64]=g[v+0+32]=Jt(H,k,L),g[v+3+96]=g[v+2+64]=g[v+1+32]=g[v+0+0]=Jt(X,H,k),g[v+3+64]=g[v+2+32]=g[v+1+0]=Jt($,X,H),g[v+3+32]=g[v+2+0]=Jt(ie,$,X),g[v+3+0]=Jt(oe,ie,$)}function As(g,v){var k=g[v+1-32],L=g[v+2-32],z=g[v+3-32],H=g[v+4-32],X=g[v+5-32],$=g[v+6-32],ie=g[v+7-32];g[v+0+0]=Jt(g[v+0-32],k,L),g[v+1+0]=g[v+0+32]=Jt(k,L,z),g[v+2+0]=g[v+1+32]=g[v+0+64]=Jt(L,z,H),g[v+3+0]=g[v+2+32]=g[v+1+64]=g[v+0+96]=Jt(z,H,X),g[v+3+32]=g[v+2+64]=g[v+1+96]=Jt(H,X,$),g[v+3+64]=g[v+2+96]=Jt(X,$,ie),g[v+3+96]=Jt($,ie,ie)}function Ns(g,v){var k=g[v-1+0],L=g[v-1+32],z=g[v-1+64],H=g[v-1-32],X=g[v+0-32],$=g[v+1-32],ie=g[v+2-32],oe=g[v+3-32];g[v+0+0]=g[v+1+64]=H+X+1>>1,g[v+1+0]=g[v+2+64]=X+$+1>>1,g[v+2+0]=g[v+3+64]=$+ie+1>>1,g[v+3+0]=ie+oe+1>>1,g[v+0+96]=Jt(z,L,k),g[v+0+64]=Jt(L,k,H),g[v+0+32]=g[v+1+96]=Jt(k,H,X),g[v+1+32]=g[v+2+96]=Jt(H,X,$),g[v+2+32]=g[v+3+96]=Jt(X,$,ie),g[v+3+32]=Jt($,ie,oe)}function Hs(g,v){var k=g[v+0-32],L=g[v+1-32],z=g[v+2-32],H=g[v+3-32],X=g[v+4-32],$=g[v+5-32],ie=g[v+6-32],oe=g[v+7-32];g[v+0+0]=k+L+1>>1,g[v+1+0]=g[v+0+64]=L+z+1>>1,g[v+2+0]=g[v+1+64]=z+H+1>>1,g[v+3+0]=g[v+2+64]=H+X+1>>1,g[v+0+32]=Jt(k,L,z),g[v+1+32]=g[v+0+96]=Jt(L,z,H),g[v+2+32]=g[v+1+96]=Jt(z,H,X),g[v+3+32]=g[v+2+96]=Jt(H,X,$),g[v+3+64]=Jt(X,$,ie),g[v+3+96]=Jt($,ie,oe)}function da(g,v){var k=g[v-1+0],L=g[v-1+32],z=g[v-1+64],H=g[v-1+96];g[v+0+0]=k+L+1>>1,g[v+2+0]=g[v+0+32]=L+z+1>>1,g[v+2+32]=g[v+0+64]=z+H+1>>1,g[v+1+0]=Jt(k,L,z),g[v+3+0]=g[v+1+32]=Jt(L,z,H),g[v+3+32]=g[v+1+64]=Jt(z,H,H),g[v+3+64]=g[v+2+64]=g[v+0+96]=g[v+1+96]=g[v+2+96]=g[v+3+96]=H}function bo(g,v){var k=g[v-1+0],L=g[v-1+32],z=g[v-1+64],H=g[v-1+96],X=g[v-1-32],$=g[v+0-32],ie=g[v+1-32],oe=g[v+2-32];g[v+0+0]=g[v+2+32]=k+X+1>>1,g[v+0+32]=g[v+2+64]=L+k+1>>1,g[v+0+64]=g[v+2+96]=z+L+1>>1,g[v+0+96]=H+z+1>>1,g[v+3+0]=Jt($,ie,oe),g[v+2+0]=Jt(X,$,ie),g[v+1+0]=g[v+3+32]=Jt(k,X,$),g[v+1+32]=g[v+3+64]=Jt(L,k,X),g[v+1+64]=g[v+3+96]=Jt(z,L,k),g[v+1+96]=Jt(H,z,L)}function Us(g,v){var k;for(k=0;8>k;++k)i(g,v+32*k,g,v-32,8)}function Ws(g,v){var k;for(k=0;8>k;++k)r(g,v,g[v-1],8),v+=32}function Qi(g,v,k){var L;for(L=0;8>L;++L)r(v,k+32*L,g,8)}function ac(g,v){var k,L=8;for(k=0;8>k;++k)L+=g[v+k-32]+g[v-1+32*k];Qi(L>>4,g,v)}function ja(g,v){var k,L=4;for(k=0;8>k;++k)L+=g[v+k-32];Qi(L>>3,g,v)}function wo(g,v){var k,L=4;for(k=0;8>k;++k)L+=g[v-1+32*k];Qi(L>>3,g,v)}function os(g,v){Qi(128,g,v)}function $i(g,v,k){var L=g[v-k],z=g[v+0],H=3*(z-L)+Zu[1020+g[v-2*k]-g[v+k]],X=Xc[112+(H+4>>3)];g[v-k]=Yr[255+L+Xc[112+(H+3>>3)]],g[v+0]=Yr[255+z-X]}function Ha(g,v,k,L){var z=g[v+0],H=g[v+k];return tr[255+g[v-2*k]-g[v-k]]>L||tr[255+H-z]>L}function fa(g,v,k,L){return 4*tr[255+g[v-k]-g[v+0]]+tr[255+g[v-2*k]-g[v+k]]<=L}function Ua(g,v,k,L,z){var H=g[v-3*k],X=g[v-2*k],$=g[v-k],ie=g[v+0],oe=g[v+k],we=g[v+2*k],De=g[v+3*k];return 4*tr[255+$-ie]+tr[255+X-oe]>L?0:tr[255+g[v-4*k]-H]<=z&&tr[255+H-X]<=z&&tr[255+X-$]<=z&&tr[255+De-we]<=z&&tr[255+we-oe]<=z&&tr[255+oe-ie]<=z}function br(g,v,k,L){var z=2*L+1;for(L=0;16>L;++L)fa(g,v+L,k,z)&&$i(g,v+L,k)}function Hr(g,v,k,L){var z=2*L+1;for(L=0;16>L;++L)fa(g,v+L*k,1,z)&&$i(g,v+L*k,1)}function xo(g,v,k,L){var z;for(z=3;0<z;--z)br(g,v+=4*k,k,L)}function _o(g,v,k,L){var z;for(z=3;0<z;--z)Hr(g,v+=4,k,L)}function Cs(g,v,k,L,z,H,X,$){for(H=2*H+1;0<z--;){if(Ua(g,v,k,H,X))if(Ha(g,v,k,$))$i(g,v,k);else{var ie=g,oe=v,we=k,De=ie[oe-2*we],ce=ie[oe-we],Se=ie[oe+0],Ce=ie[oe+we],He=ie[oe+2*we],Te=27*(Ze=Zu[1020+3*(Se-ce)+Zu[1020+De-Ce]])+63>>7,Xe=18*Ze+63>>7,Ze=9*Ze+63>>7;ie[oe-3*we]=Yr[255+ie[oe-3*we]+Ze],ie[oe-2*we]=Yr[255+De+Xe],ie[oe-we]=Yr[255+ce+Te],ie[oe+0]=Yr[255+Se-Te],ie[oe+we]=Yr[255+Ce-Xe],ie[oe+2*we]=Yr[255+He-Ze]}v+=L}}function fr(g,v,k,L,z,H,X,$){for(H=2*H+1;0<z--;){if(Ua(g,v,k,H,X))if(Ha(g,v,k,$))$i(g,v,k);else{var ie=g,oe=v,we=k,De=ie[oe-we],ce=ie[oe+0],Se=ie[oe+we],Ce=Xc[112+(4+(He=3*(ce-De))>>3)],He=Xc[112+(He+3>>3)],Te=Ce+1>>1;ie[oe-2*we]=Yr[255+ie[oe-2*we]+Te],ie[oe-we]=Yr[255+De+He],ie[oe+0]=Yr[255+ce-Ce],ie[oe+we]=Yr[255+Se-Te]}v+=L}}function xe(g,v,k,L,z,H){Cs(g,v,k,1,16,L,z,H)}function Ve(g,v,k,L,z,H){Cs(g,v,1,k,16,L,z,H)}function Ct(g,v,k,L,z,H){var X;for(X=3;0<X;--X)fr(g,v+=4*k,k,1,16,L,z,H)}function x(g,v,k,L,z,H){var X;for(X=3;0<X;--X)fr(g,v+=4,1,k,16,L,z,H)}function R(g,v,k,L,z,H,X,$){Cs(g,v,z,1,8,H,X,$),Cs(k,L,z,1,8,H,X,$)}function te(g,v,k,L,z,H,X,$){Cs(g,v,1,z,8,H,X,$),Cs(k,L,1,z,8,H,X,$)}function me(g,v,k,L,z,H,X,$){fr(g,v+4*z,z,1,8,H,X,$),fr(k,L+4*z,z,1,8,H,X,$)}function Ne(g,v,k,L,z,H,X,$){fr(g,v+4,1,z,8,H,X,$),fr(k,L+4,1,z,8,H,X,$)}function ze(){this.ba=new kt,this.ec=[],this.cc=[],this.Mc=[],this.Dc=this.Nc=this.dc=this.fc=0,this.Oa=new Gt,this.memory=0,this.Ib="OutputFunc",this.Jb="OutputAlphaFunc",this.Nd="OutputRowFunc"}function Ge(){this.data=[],this.offset=this.kd=this.ha=this.w=0,this.na=[],this.xa=this.gb=this.Ja=this.Sa=this.P=0}function mt(){this.nc=this.Ea=this.b=this.hc=0,this.K=[],this.w=0}function yt(){this.ua=0,this.Wa=new Qe,this.vb=new Qe,this.md=this.xc=this.wc=0,this.vc=[],this.Wb=0,this.Ya=new F,this.yc=new B}function ft(){this.xb=this.a=0,this.l=new cr,this.ca=new kt,this.V=[],this.Ba=0,this.Ta=[],this.Ua=0,this.m=new V,this.Pb=0,this.wd=new V,this.Ma=this.$=this.C=this.i=this.c=this.xd=0,this.s=new yt,this.ab=0,this.gc=a(4,mt),this.Oc=0}function zt(){this.Lc=this.Z=this.$a=this.i=this.c=0,this.l=new cr,this.ic=0,this.ca=[],this.tb=0,this.qd=null,this.rd=0}function sn(g,v,k,L,z,H,X){for(g=g==null?0:g[v+0],v=0;v<X;++v)z[H+v]=g+k[L+v]&255,g=z[H+v]}function tn(g,v,k,L,z,H,X){var $;if(g==null)sn(null,null,k,L,z,H,X);else for($=0;$<X;++$)z[H+$]=g[v+$]+k[L+$]&255}function In(g,v,k,L,z,H,X){if(g==null)sn(null,null,k,L,z,H,X);else{var $,ie=g[v+0],oe=ie,we=ie;for($=0;$<X;++$)oe=we+(ie=g[v+$])-oe,we=k[L+$]+(-256&oe?0>oe?0:255:oe)&255,oe=ie,z[H+$]=we}}function Sn(g,v,k,L){var z=v.width,H=v.o;if(e(g!=null&&v!=null),0>k||0>=L||k+L>H)return null;if(!g.Cc){if(g.ga==null){var X;if(g.ga=new zt,(X=g.ga==null)||(X=v.width*v.o,e(g.Gb.length==0),g.Gb=s(X),g.Uc=0,g.Gb==null?X=0:(g.mb=g.Gb,g.nb=g.Uc,g.rc=null,X=1),X=!X),!X){X=g.ga;var $=g.Fa,ie=g.P,oe=g.qc,we=g.mb,De=g.nb,ce=ie+1,Se=oe-1,Ce=X.l;if(e($!=null&&we!=null&&v!=null),Zr[0]=null,Zr[1]=sn,Zr[2]=tn,Zr[3]=In,X.ca=we,X.tb=De,X.c=v.width,X.i=v.height,e(0<X.c&&0<X.i),1>=oe)v=0;else if(X.$a=3&$[ie+0],X.Z=$[ie+0]>>2&3,X.Lc=$[ie+0]>>4&3,ie=$[ie+0]>>6&3,0>X.$a||1<X.$a||4<=X.Z||1<X.Lc||ie)v=0;else if(Ce.put=Bt,Ce.ac=li,Ce.bc=Jn,Ce.ma=X,Ce.width=v.width,Ce.height=v.height,Ce.Da=v.Da,Ce.v=v.v,Ce.va=v.va,Ce.j=v.j,Ce.o=v.o,X.$a)e:{e(X.$a==1),v=Mn();t:for(;;){if(v==null){v=0;break e}if(e(X!=null),X.mc=v,v.c=X.c,v.i=X.i,v.l=X.l,v.l.ma=X,v.l.width=X.c,v.l.height=X.i,v.a=0,Y(v.m,$,ce,Se),!Zt(X.c,X.i,1,v,null)||(v.ab==1&&v.gc[0].hc==3&&Yt(v.s)?(X.ic=1,$=v.c*v.i,v.Ta=null,v.Ua=0,v.V=s($),v.Ba=0,v.V==null?(v.a=1,v=0):v=1):(X.ic=0,v=Qn(v,X.c)),!v))break t;v=1;break e}X.mc=null,v=0}else v=Se>=X.c*X.i;X=!v}if(X)return null;g.ga.Lc!=1?g.Ga=0:L=H-k}e(g.ga!=null),e(k+L<=H);e:{if(v=($=g.ga).c,H=$.l.o,$.$a==0){if(ce=g.rc,Se=g.Vc,Ce=g.Fa,ie=g.P+1+k*v,oe=g.mb,we=g.nb+k*v,e(ie<=g.P+g.qc),$.Z!=0)for(e(Zr[$.Z]!=null),X=0;X<L;++X)Zr[$.Z](ce,Se,Ce,ie,oe,we,v),ce=oe,Se=we,we+=v,ie+=v;else for(X=0;X<L;++X)i(oe,we,Ce,ie,v),ce=oe,Se=we,we+=v,ie+=v;g.rc=ce,g.Vc=Se}else{if(e($.mc!=null),v=k+L,e((X=$.mc)!=null),e(v<=X.i),X.C>=v)v=1;else if($.ic||Ps(),$.ic){$=X.V,ce=X.Ba,Se=X.c;var He=X.i,Te=(Ce=1,ie=X.$/Se,oe=X.$%Se,we=X.m,De=X.s,X.$),Xe=Se*He,Ze=Se*v,at=De.wc,et=Te<Ze?tt(De,oe,ie):null;e(Te<=Xe),e(v<=He),e(Yt(De));t:for(;;){for(;!we.h&&Te<Ze;){if(oe&at||(et=tt(De,oe,ie)),e(et!=null),ee(we),256>(He=wn(et.G[0],et.H[0],we)))$[ce+Te]=He,++Te,++oe>=Se&&(oe=0,++ie<=v&&!(ie%16)&&Lt(X,ie));else{if(!(280>He)){Ce=0;break t}He=Pn(He-256,we);var Ht,Pt=wn(et.G[4],et.H[4],we);if(ee(we),!(Te>=(Pt=jn(Se,Pt=Pn(Pt,we)))&&Xe-Te>=He)){Ce=0;break t}for(Ht=0;Ht<He;++Ht)$[ce+Te+Ht]=$[ce+Te+Ht-Pt];for(Te+=He,oe+=He;oe>=Se;)oe-=Se,++ie<=v&&!(ie%16)&&Lt(X,ie);Te<Ze&&oe&at&&(et=tt(De,oe,ie))}e(we.h==re(we))}Lt(X,ie>v?v:ie);break t}!Ce||we.h&&Te<Xe?(Ce=0,X.a=we.h?5:3):X.$=Te,v=Ce}else v=Qt(X,X.V,X.Ba,X.c,X.i,v,En);if(!v){L=0;break e}}k+L>=H&&(g.Cc=1),L=1}if(!L)return null;if(g.Cc&&((L=g.ga)!=null&&(L.mc=null),g.ga=null,0<g.Ga))return alert("todo:WebPDequantizeLevels"),null}return g.nb+k*z}function zn(g,v,k,L,z,H){for(;0<z--;){var X,$=g,ie=v+(k?1:0),oe=g,we=v+(k?0:3);for(X=0;X<L;++X){var De=oe[we+4*X];De!=255&&(De*=32897,$[ie+4*X+0]=$[ie+4*X+0]*De>>23,$[ie+4*X+1]=$[ie+4*X+1]*De>>23,$[ie+4*X+2]=$[ie+4*X+2]*De>>23)}v+=H}}function pn(g,v,k,L,z){for(;0<L--;){var H;for(H=0;H<k;++H){var X=g[v+2*H+0],$=15&(oe=g[v+2*H+1]),ie=4369*$,oe=(240&oe|oe>>4)*ie>>16;g[v+2*H+0]=(240&X|X>>4)*ie>>16&240|(15&X|X<<4)*ie>>16>>4&15,g[v+2*H+1]=240&oe|$}v+=z}}function Tn(g,v,k,L,z,H,X,$){var ie,oe,we=255;for(oe=0;oe<z;++oe){for(ie=0;ie<L;++ie){var De=g[v+ie];H[X+4*ie]=De,we&=De}v+=k,X+=$}return we!=255}function ha(g,v,k,L,z){var H;for(H=0;H<z;++H)k[L+H]=g[v+H]>>8}function Ps(){pc=zn,df=pn,Io=Tn,Lo=ha}function pa(g,v,k){D[g]=function(L,z,H,X,$,ie,oe,we,De,ce,Se,Ce,He,Te,Xe,Ze,at){var et,Ht=at-1>>1,Pt=$[ie+0]|oe[we+0]<<16,un=De[ce+0]|Se[Ce+0]<<16;e(L!=null);var Nt=3*Pt+un+131074>>2;for(v(L[z+0],255&Nt,Nt>>16,He,Te),H!=null&&(Nt=3*un+Pt+131074>>2,v(H[X+0],255&Nt,Nt>>16,Xe,Ze)),et=1;et<=Ht;++et){var hn=$[ie+et]|oe[we+et]<<16,Ti=De[ce+et]|Se[Ce+et]<<16,dn=Pt+hn+un+Ti+524296,Mt=dn+2*(hn+un)>>3;Nt=Mt+Pt>>1,Pt=(dn=dn+2*(Pt+Ti)>>3)+hn>>1,v(L[z+2*et-1],255&Nt,Nt>>16,He,Te+(2*et-1)*k),v(L[z+2*et-0],255&Pt,Pt>>16,He,Te+(2*et-0)*k),H!=null&&(Nt=dn+un>>1,Pt=Mt+Ti>>1,v(H[X+2*et-1],255&Nt,Nt>>16,Xe,Ze+(2*et-1)*k),v(H[X+2*et+0],255&Pt,Pt>>16,Xe,Ze+(2*et+0)*k)),Pt=hn,un=Ti}1&at||(Nt=3*Pt+un+131074>>2,v(L[z+at-1],255&Nt,Nt>>16,He,Te+(at-1)*k),H!=null&&(Nt=3*un+Pt+131074>>2,v(H[X+at-1],255&Nt,Nt>>16,Xe,Ze+(at-1)*k)))}}function Vs(){nr[ba]=Vp,nr[Yc]=bf,nr[gf]=Gp,nr[Kc]=Oo,nr[wa]=Fo,nr[Ka]=wf,nr[mf]=Xp,nr[Ju]=bf,nr[Qu]=Oo,nr[xa]=Fo,nr[Za]=wf}function Es(g){return g&-16384?0>g?0:255:g>>Yp}function Wa(g,v){return Es((19077*g>>8)+(26149*v>>8)-14234)}function So(g,v,k){return Es((19077*g>>8)-(6419*v>>8)-(13320*k>>8)+8708)}function ko(g,v){return Es((19077*g>>8)+(33050*v>>8)-17685)}function Ur(g,v,k,L,z){L[z+0]=Wa(g,k),L[z+1]=So(g,v,k),L[z+2]=ko(g,v)}function pi(g,v,k,L,z){L[z+0]=ko(g,v),L[z+1]=So(g,v,k),L[z+2]=Wa(g,k)}function Ao(g,v,k,L,z){var H=So(g,v,k);v=H<<3&224|ko(g,v)>>3,L[z+0]=248&Wa(g,k)|H>>5,L[z+1]=v}function No(g,v,k,L,z){var H=240&ko(g,v)|15;L[z+0]=240&Wa(g,k)|So(g,v,k)>>4,L[z+1]=H}function oc(g,v,k,L,z){L[z+0]=255,Ur(g,v,k,L,z+1)}function Gs(g,v,k,L,z){pi(g,v,k,L,z),L[z+3]=255}function ki(g,v,k,L,z){Ur(g,v,k,L,z),L[z+3]=255}function ga(g,v,k){D[g]=function(L,z,H,X,$,ie,oe,we,De){for(var ce=we+(-2&De)*k;we!=ce;)v(L[z+0],H[X+0],$[ie+0],oe,we),v(L[z+1],H[X+0],$[ie+0],oe,we+k),z+=2,++X,++ie,we+=2*k;1&De&&v(L[z+0],H[X+0],$[ie+0],oe,we)}}function bl(g,v,k){return k==0?g==0?v==0?6:5:v==0?4:0:k}function Vc(g,v,k,L,z){switch(g>>>30){case 3:us(v,k,L,z,0);break;case 2:ds(v,k,L,z);break;case 1:Ln(v,k,L,z)}}function er(g,v){var k,L,z=v.M,H=v.Nb,X=g.oc,$=g.pc+40,ie=g.oc,oe=g.pc+584,we=g.oc,De=g.pc+600;for(k=0;16>k;++k)X[$+32*k-1]=129;for(k=0;8>k;++k)ie[oe+32*k-1]=129,we[De+32*k-1]=129;for(0<z?X[$-1-32]=ie[oe-1-32]=we[De-1-32]=129:(r(X,$-32-1,127,21),r(ie,oe-32-1,127,9),r(we,De-32-1,127,9)),L=0;L<g.za;++L){var ce=v.ya[v.aa+L];if(0<L){for(k=-1;16>k;++k)i(X,$+32*k-4,X,$+32*k+12,4);for(k=-1;8>k;++k)i(ie,oe+32*k-4,ie,oe+32*k+4,4),i(we,De+32*k-4,we,De+32*k+4,4)}var Se=g.Gd,Ce=g.Hd+L,He=ce.ad,Te=ce.Hc;if(0<z&&(i(X,$-32,Se[Ce].y,0,16),i(ie,oe-32,Se[Ce].f,0,8),i(we,De-32,Se[Ce].ea,0,8)),ce.Za){var Xe=X,Ze=$-32+16;for(0<z&&(L>=g.za-1?r(Xe,Ze,Se[Ce].y[15],4):i(Xe,Ze,Se[Ce+1].y,0,4)),k=0;4>k;k++)Xe[Ze+128+k]=Xe[Ze+256+k]=Xe[Ze+384+k]=Xe[Ze+0+k];for(k=0;16>k;++k,Te<<=2)Xe=X,Ze=$+Ro[k],hr[ce.Ob[k]](Xe,Ze),Vc(Te,He,16*+k,Xe,Ze)}else if(Xe=bl(L,z,ce.Ob[0]),Kr[Xe](X,$),Te!=0)for(k=0;16>k;++k,Te<<=2)Vc(Te,He,16*+k,X,$+Ro[k]);for(k=ce.Gc,Xe=bl(L,z,ce.Dd),_a[Xe](ie,oe),_a[Xe](we,De),Te=He,Xe=ie,Ze=oe,255&(ce=0|k)&&(170&ce?Ks(Te,256,Xe,Ze):kn(Te,256,Xe,Ze)),ce=we,Te=De,255&(k>>=8)&&(170&k?Ks(He,320,ce,Te):kn(He,320,ce,Te)),z<g.Ub-1&&(i(Se[Ce].y,0,X,$+480,16),i(Se[Ce].f,0,ie,oe+224,8),i(Se[Ce].ea,0,we,De+224,8)),k=8*H*g.B,Se=g.sa,Ce=g.ta+16*L+16*H*g.R,He=g.qa,ce=g.ra+8*L+k,Te=g.Ha,Xe=g.Ia+8*L+k,k=0;16>k;++k)i(Se,Ce+k*g.R,X,$+32*k,16);for(k=0;8>k;++k)i(He,ce+k*g.B,ie,oe+32*k,8),i(Te,Xe+k*g.B,we,De+32*k,8)}}function ls(g,v,k,L,z,H,X,$,ie){var oe=[0],we=[0],De=0,ce=ie!=null?ie.kd:0,Se=ie??new Ge;if(g==null||12>k)return 7;Se.data=g,Se.w=v,Se.ha=k,v=[v],k=[k],Se.gb=[Se.gb];e:{var Ce=v,He=k,Te=Se.gb;if(e(g!=null),e(He!=null),e(Te!=null),Te[0]=0,12<=He[0]&&!n(g,Ce[0],"RIFF")){if(n(g,Ce[0]+8,"WEBP")){Te=3;break e}var Xe=Ye(g,Ce[0]+4);if(12>Xe||4294967286<Xe){Te=3;break e}if(ce&&Xe>He[0]-8){Te=7;break e}Te[0]=Xe,Ce[0]+=12,He[0]-=12}Te=0}if(Te!=0)return Te;for(Xe=0<Se.gb[0],k=k[0];;){e:{var Ze=g;He=v,Te=k;var at=oe,et=we,Ht=Ce=[0];if((Nt=De=[De])[0]=0,8>Te[0])Te=7;else{if(!n(Ze,He[0],"VP8X")){if(Ye(Ze,He[0]+4)!=10){Te=3;break e}if(18>Te[0]){Te=7;break e}var Pt=Ye(Ze,He[0]+8),un=1+Ae(Ze,He[0]+12);if(2147483648<=un*(Ze=1+Ae(Ze,He[0]+15))){Te=3;break e}Ht!=null&&(Ht[0]=Pt),at!=null&&(at[0]=un),et!=null&&(et[0]=Ze),He[0]+=18,Te[0]-=18,Nt[0]=1}Te=0}}if(De=De[0],Ce=Ce[0],Te!=0)return Te;if(He=!!(2&Ce),!Xe&&De)return 3;if(H!=null&&(H[0]=!!(16&Ce)),X!=null&&(X[0]=He),$!=null&&($[0]=0),X=oe[0],Ce=we[0],De&&He&&ie==null){Te=0;break}if(4>k){Te=7;break}if(Xe&&De||!Xe&&!De&&!n(g,v[0],"ALPH")){k=[k],Se.na=[Se.na],Se.P=[Se.P],Se.Sa=[Se.Sa];e:{Pt=g,Te=v,Xe=k;var Nt=Se.gb;at=Se.na,et=Se.P,Ht=Se.Sa,un=22,e(Pt!=null),e(Xe!=null),Ze=Te[0];var hn=Xe[0];for(e(at!=null),e(Ht!=null),at[0]=null,et[0]=null,Ht[0]=0;;){if(Te[0]=Ze,Xe[0]=hn,8>hn){Te=7;break e}var Ti=Ye(Pt,Ze+4);if(4294967286<Ti){Te=3;break e}var dn=8+Ti+1&-2;if(un+=dn,0<Nt&&un>Nt){Te=3;break e}if(!n(Pt,Ze,"VP8 ")||!n(Pt,Ze,"VP8L")){Te=0;break e}if(hn[0]<dn){Te=7;break e}n(Pt,Ze,"ALPH")||(at[0]=Pt,et[0]=Ze+8,Ht[0]=Ti),Ze+=dn,hn-=dn}}if(k=k[0],Se.na=Se.na[0],Se.P=Se.P[0],Se.Sa=Se.Sa[0],Te!=0)break}k=[k],Se.Ja=[Se.Ja],Se.xa=[Se.xa];e:if(Nt=g,Te=v,Xe=k,at=Se.gb[0],et=Se.Ja,Ht=Se.xa,Pt=Te[0],Ze=!n(Nt,Pt,"VP8 "),un=!n(Nt,Pt,"VP8L"),e(Nt!=null),e(Xe!=null),e(et!=null),e(Ht!=null),8>Xe[0])Te=7;else{if(Ze||un){if(Nt=Ye(Nt,Pt+4),12<=at&&Nt>at-12){Te=3;break e}if(ce&&Nt>Xe[0]-8){Te=7;break e}et[0]=Nt,Te[0]+=8,Xe[0]-=8,Ht[0]=un}else Ht[0]=5<=Xe[0]&&Nt[Pt+0]==47&&!(Nt[Pt+4]>>5),et[0]=Xe[0];Te=0}if(k=k[0],Se.Ja=Se.Ja[0],Se.xa=Se.xa[0],v=v[0],Te!=0)break;if(4294967286<Se.Ja)return 3;if($==null||He||($[0]=Se.xa?2:1),X=[X],Ce=[Ce],Se.xa){if(5>k){Te=7;break}$=X,ce=Ce,He=H,g==null||5>k?g=0:5<=k&&g[v+0]==47&&!(g[v+4]>>5)?(Xe=[0],Nt=[0],at=[0],Y(et=new V,g,v,k),qn(et,Xe,Nt,at)?($!=null&&($[0]=Xe[0]),ce!=null&&(ce[0]=Nt[0]),He!=null&&(He[0]=at[0]),g=1):g=0):g=0}else{if(10>k){Te=7;break}$=Ce,g==null||10>k||!Ba(g,v+3,k-3)?g=0:(ce=g[v+0]|g[v+1]<<8|g[v+2]<<16,He=16383&(g[v+7]<<8|g[v+6]),g=16383&(g[v+9]<<8|g[v+8]),1&ce||3<(ce>>1&7)||!(ce>>4&1)||ce>>5>=Se.Ja||!He||!g?g=0:(X&&(X[0]=He),$&&($[0]=g),g=1))}if(!g||(X=X[0],Ce=Ce[0],De&&(oe[0]!=X||we[0]!=Ce)))return 3;ie!=null&&(ie[0]=Se,ie.offset=v-ie.w,e(4294967286>v-ie.w),e(ie.offset==ie.ha-k));break}return Te==0||Te==7&&De&&ie==null?(H!=null&&(H[0]|=Se.na!=null&&0<Se.na.length),L!=null&&(L[0]=X),z!=null&&(z[0]=Ce),0):Te}function lc(g,v,k){var L=v.width,z=v.height,H=0,X=0,$=L,ie=z;if(v.Da=g!=null&&0<g.Da,v.Da&&($=g.cd,ie=g.bd,H=g.v,X=g.j,11>k||(H&=-2,X&=-2),0>H||0>X||0>=$||0>=ie||H+$>L||X+ie>z))return 0;if(v.v=H,v.j=X,v.va=H+$,v.o=X+ie,v.U=$,v.T=ie,v.da=g!=null&&0<g.da,v.da){if(!Be($,ie,k=[g.ib],H=[g.hb]))return 0;v.ib=k[0],v.hb=H[0]}return v.ob=g!=null&&g.ob,v.Kb=g==null||!g.Sd,v.da&&(v.ob=v.ib<3*L/4&&v.hb<3*z/4,v.Kb=0),1}function cc(g){if(g==null)return 2;if(11>g.S){var v=g.f.RGBA;v.fb+=(g.height-1)*v.A,v.A=-v.A}else v=g.f.kb,g=g.height,v.O+=(g-1)*v.fa,v.fa=-v.fa,v.N+=(g-1>>1)*v.Ab,v.Ab=-v.Ab,v.W+=(g-1>>1)*v.Db,v.Db=-v.Db,v.F!=null&&(v.J+=(g-1)*v.lb,v.lb=-v.lb);return 0}function Va(g,v,k,L){if(L==null||0>=g||0>=v)return 2;if(k!=null){if(k.Da){var z=k.cd,H=k.bd,X=-2&k.v,$=-2&k.j;if(0>X||0>$||0>=z||0>=H||X+z>g||$+H>v)return 2;g=z,v=H}if(k.da){if(!Be(g,v,z=[k.ib],H=[k.hb]))return 2;g=z[0],v=H[0]}}L.width=g,L.height=v;e:{var ie=L.width,oe=L.height;if(g=L.S,0>=ie||0>=oe||!(g>=ba&&13>g))g=2;else{if(0>=L.Rd&&L.sd==null){X=H=z=v=0;var we=($=ie*Bo[g])*oe;if(11>g||(H=(oe+1)/2*(v=(ie+1)/2),g==12&&(X=(z=ie)*oe)),(oe=s(we+2*H+X))==null){g=1;break e}L.sd=oe,11>g?((ie=L.f.RGBA).eb=oe,ie.fb=0,ie.A=$,ie.size=we):((ie=L.f.kb).y=oe,ie.O=0,ie.fa=$,ie.Fd=we,ie.f=oe,ie.N=0+we,ie.Ab=v,ie.Cd=H,ie.ea=oe,ie.W=0+we+H,ie.Db=v,ie.Ed=H,g==12&&(ie.F=oe,ie.J=0+we+2*H),ie.Tc=X,ie.lb=z)}if(v=1,z=L.S,H=L.width,X=L.height,z>=ba&&13>z)if(11>z)g=L.f.RGBA,v&=($=Math.abs(g.A))*(X-1)+H<=g.size,v&=$>=H*Bo[z],v&=g.eb!=null;else{g=L.f.kb,$=(H+1)/2,we=(X+1)/2,ie=Math.abs(g.fa),oe=Math.abs(g.Ab);var De=Math.abs(g.Db),ce=Math.abs(g.lb),Se=ce*(X-1)+H;v&=ie*(X-1)+H<=g.Fd,v&=oe*(we-1)+$<=g.Cd,v=(v&=De*(we-1)+$<=g.Ed)&ie>=H&oe>=$&De>=$,v&=g.y!=null,v&=g.f!=null,v&=g.ea!=null,z==12&&(v&=ce>=H,v&=Se<=g.Tc,v&=g.F!=null)}else v=0;g=v?0:2}}return g!=0||k!=null&&k.fd&&(g=cc(L)),g}var cs=64,Ui=[0,1,3,7,15,31,63,127,255,511,1023,2047,4095,8191,16383,32767,65535,131071,262143,524287,1048575,2097151,4194303,8388607,16777215],Wr=24,Ga=32,ma=8,Vr=[0,0,1,1,2,2,2,2,3,3,3,3,3,3,3,3,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7];We("Predictor0","PredictorAdd0"),D.Predictor0=function(){return 4278190080},D.Predictor1=function(g){return g},D.Predictor2=function(g,v,k){return v[k+0]},D.Predictor3=function(g,v,k){return v[k+1]},D.Predictor4=function(g,v,k){return v[k-1]},D.Predictor5=function(g,v,k){return ht(ht(g,v[k+1]),v[k+0])},D.Predictor6=function(g,v,k){return ht(g,v[k-1])},D.Predictor7=function(g,v,k){return ht(g,v[k+0])},D.Predictor8=function(g,v,k){return ht(v[k-1],v[k+0])},D.Predictor9=function(g,v,k){return ht(v[k+0],v[k+1])},D.Predictor10=function(g,v,k){return ht(ht(g,v[k-1]),ht(v[k+0],v[k+1]))},D.Predictor11=function(g,v,k){var L=v[k+0];return 0>=qe(L>>24&255,g>>24&255,(v=v[k-1])>>24&255)+qe(L>>16&255,g>>16&255,v>>16&255)+qe(L>>8&255,g>>8&255,v>>8&255)+qe(255&L,255&g,255&v)?L:g},D.Predictor12=function(g,v,k){var L=v[k+0];return(Rt((g>>24&255)+(L>>24&255)-((v=v[k-1])>>24&255))<<24|Rt((g>>16&255)+(L>>16&255)-(v>>16&255))<<16|Rt((g>>8&255)+(L>>8&255)-(v>>8&255))<<8|Rt((255&g)+(255&L)-(255&v)))>>>0},D.Predictor13=function(g,v,k){var L=v[k-1];return(ye((g=ht(g,v[k+0]))>>24&255,L>>24&255)<<24|ye(g>>16&255,L>>16&255)<<16|ye(g>>8&255,L>>8&255)<<8|ye(255&g,255&L))>>>0};var Xs=D.PredictorAdd0;D.PredictorAdd1=ve,We("Predictor2","PredictorAdd2"),We("Predictor3","PredictorAdd3"),We("Predictor4","PredictorAdd4"),We("Predictor5","PredictorAdd5"),We("Predictor6","PredictorAdd6"),We("Predictor7","PredictorAdd7"),We("Predictor8","PredictorAdd8"),We("Predictor9","PredictorAdd9"),We("Predictor10","PredictorAdd10"),We("Predictor11","PredictorAdd11"),We("Predictor12","PredictorAdd12"),We("Predictor13","PredictorAdd13");var wl=D.PredictorAdd2;nt("ColorIndexInverseTransform","MapARGB","32b",function(g){return g>>8&255},function(g){return g}),nt("VP8LColorIndexInverseTransformAlpha","MapAlpha","8b",function(g){return g},function(g){return g>>8&255});var xi,Gc=D.ColorIndexInverseTransform,wr=D.MapARGB,xr=D.VP8LColorIndexInverseTransformAlpha,uc=D.MapAlpha,dc=D.VP8LPredictorsAdd=[];dc.length=16,(D.VP8LPredictors=[]).length=16,(D.VP8LPredictorsAdd_C=[]).length=16,(D.VP8LPredictors_C=[]).length=16;var fc,Ys,Gr,Xa,Ya,Co,Xr,us,ds,Ks,Ln,kn,Vn,Mi,va,hc,Is,ya,of,lf,cf,Po,Eo,uf,pc,df,Io,Lo,ff=s(511),hf=s(2041),pf=s(225),Mo=s(767),To=0,Zu=hf,Xc=pf,Yr=Mo,tr=ff,ba=0,Yc=1,gf=2,Kc=3,wa=4,Ka=5,mf=6,Ju=7,Qu=8,xa=9,Za=10,Dp=[2,3,7],Op=[3,3,11],vf=[280,256,256,256,40],xl=[0,1,1,1,0],_l=[17,18,0,1,2,3,4,5,16,6,7,8,9,10,11,12,13,14,15],Fp=[24,7,23,25,40,6,39,41,22,26,38,42,56,5,55,57,21,27,54,58,37,43,72,4,71,73,20,28,53,59,70,74,36,44,88,69,75,52,60,3,87,89,19,29,86,90,35,45,68,76,85,91,51,61,104,2,103,105,18,30,102,106,34,46,84,92,67,77,101,107,50,62,120,1,119,121,83,93,17,31,100,108,66,78,118,122,33,47,117,123,49,63,99,109,82,94,0,116,124,65,79,16,32,98,110,48,115,125,81,95,64,114,126,97,111,80,113,127,96,112],Rp=[2954,2956,2958,2962,2970,2986,3018,3082,3212,3468,3980,5004],Bp=8,Ja=[4,5,6,7,8,9,10,10,11,12,13,14,15,16,17,17,18,19,20,20,21,21,22,22,23,23,24,25,25,26,27,28,29,30,31,32,33,34,35,36,37,37,38,39,40,41,42,43,44,45,46,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76,76,77,78,79,80,81,82,83,84,85,86,87,88,89,91,93,95,96,98,100,101,102,104,106,108,110,112,114,116,118,122,124,126,128,130,132,134,136,138,140,143,145,148,151,154,157],Qa=[4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,60,62,64,66,68,70,72,74,76,78,80,82,84,86,88,90,92,94,96,98,100,102,104,106,108,110,112,114,116,119,122,125,128,131,134,137,140,143,146,149,152,155,158,161,164,167,170,173,177,181,185,189,193,197,201,205,209,213,217,221,225,229,234,239,245,249,254,259,264,269,274,279,284],gc=null,zp=[[173,148,140,0],[176,155,140,135,0],[180,157,141,134,130,0],[254,254,243,230,196,177,153,140,133,130,129,0]],qp=[0,1,4,8,5,2,3,6,9,12,13,10,7,11,14,15],Do=[-0,1,-1,2,-2,3,4,6,-3,5,-4,-5,-6,7,-7,8,-8,-9],Sl=[[[[128,128,128,128,128,128,128,128,128,128,128],[128,128,128,128,128,128,128,128,128,128,128],[128,128,128,128,128,128,128,128,128,128,128]],[[253,136,254,255,228,219,128,128,128,128,128],[189,129,242,255,227,213,255,219,128,128,128],[106,126,227,252,214,209,255,255,128,128,128]],[[1,98,248,255,236,226,255,255,128,128,128],[181,133,238,254,221,234,255,154,128,128,128],[78,134,202,247,198,180,255,219,128,128,128]],[[1,185,249,255,243,255,128,128,128,128,128],[184,150,247,255,236,224,128,128,128,128,128],[77,110,216,255,236,230,128,128,128,128,128]],[[1,101,251,255,241,255,128,128,128,128,128],[170,139,241,252,236,209,255,255,128,128,128],[37,116,196,243,228,255,255,255,128,128,128]],[[1,204,254,255,245,255,128,128,128,128,128],[207,160,250,255,238,128,128,128,128,128,128],[102,103,231,255,211,171,128,128,128,128,128]],[[1,152,252,255,240,255,128,128,128,128,128],[177,135,243,255,234,225,128,128,128,128,128],[80,129,211,255,194,224,128,128,128,128,128]],[[1,1,255,128,128,128,128,128,128,128,128],[246,1,255,128,128,128,128,128,128,128,128],[255,128,128,128,128,128,128,128,128,128,128]]],[[[198,35,237,223,193,187,162,160,145,155,62],[131,45,198,221,172,176,220,157,252,221,1],[68,47,146,208,149,167,221,162,255,223,128]],[[1,149,241,255,221,224,255,255,128,128,128],[184,141,234,253,222,220,255,199,128,128,128],[81,99,181,242,176,190,249,202,255,255,128]],[[1,129,232,253,214,197,242,196,255,255,128],[99,121,210,250,201,198,255,202,128,128,128],[23,91,163,242,170,187,247,210,255,255,128]],[[1,200,246,255,234,255,128,128,128,128,128],[109,178,241,255,231,245,255,255,128,128,128],[44,130,201,253,205,192,255,255,128,128,128]],[[1,132,239,251,219,209,255,165,128,128,128],[94,136,225,251,218,190,255,255,128,128,128],[22,100,174,245,186,161,255,199,128,128,128]],[[1,182,249,255,232,235,128,128,128,128,128],[124,143,241,255,227,234,128,128,128,128,128],[35,77,181,251,193,211,255,205,128,128,128]],[[1,157,247,255,236,231,255,255,128,128,128],[121,141,235,255,225,227,255,255,128,128,128],[45,99,188,251,195,217,255,224,128,128,128]],[[1,1,251,255,213,255,128,128,128,128,128],[203,1,248,255,255,128,128,128,128,128,128],[137,1,177,255,224,255,128,128,128,128,128]]],[[[253,9,248,251,207,208,255,192,128,128,128],[175,13,224,243,193,185,249,198,255,255,128],[73,17,171,221,161,179,236,167,255,234,128]],[[1,95,247,253,212,183,255,255,128,128,128],[239,90,244,250,211,209,255,255,128,128,128],[155,77,195,248,188,195,255,255,128,128,128]],[[1,24,239,251,218,219,255,205,128,128,128],[201,51,219,255,196,186,128,128,128,128,128],[69,46,190,239,201,218,255,228,128,128,128]],[[1,191,251,255,255,128,128,128,128,128,128],[223,165,249,255,213,255,128,128,128,128,128],[141,124,248,255,255,128,128,128,128,128,128]],[[1,16,248,255,255,128,128,128,128,128,128],[190,36,230,255,236,255,128,128,128,128,128],[149,1,255,128,128,128,128,128,128,128,128]],[[1,226,255,128,128,128,128,128,128,128,128],[247,192,255,128,128,128,128,128,128,128,128],[240,128,255,128,128,128,128,128,128,128,128]],[[1,134,252,255,255,128,128,128,128,128,128],[213,62,250,255,255,128,128,128,128,128,128],[55,93,255,128,128,128,128,128,128,128,128]],[[128,128,128,128,128,128,128,128,128,128,128],[128,128,128,128,128,128,128,128,128,128,128],[128,128,128,128,128,128,128,128,128,128,128]]],[[[202,24,213,235,186,191,220,160,240,175,255],[126,38,182,232,169,184,228,174,255,187,128],[61,46,138,219,151,178,240,170,255,216,128]],[[1,112,230,250,199,191,247,159,255,255,128],[166,109,228,252,211,215,255,174,128,128,128],[39,77,162,232,172,180,245,178,255,255,128]],[[1,52,220,246,198,199,249,220,255,255,128],[124,74,191,243,183,193,250,221,255,255,128],[24,71,130,219,154,170,243,182,255,255,128]],[[1,182,225,249,219,240,255,224,128,128,128],[149,150,226,252,216,205,255,171,128,128,128],[28,108,170,242,183,194,254,223,255,255,128]],[[1,81,230,252,204,203,255,192,128,128,128],[123,102,209,247,188,196,255,233,128,128,128],[20,95,153,243,164,173,255,203,128,128,128]],[[1,222,248,255,216,213,128,128,128,128,128],[168,175,246,252,235,205,255,255,128,128,128],[47,116,215,255,211,212,255,255,128,128,128]],[[1,121,236,253,212,214,255,255,128,128,128],[141,84,213,252,201,202,255,219,128,128,128],[42,80,160,240,162,185,255,205,128,128,128]],[[1,1,255,128,128,128,128,128,128,128,128],[244,1,255,128,128,128,128,128,128,128,128],[238,1,255,128,128,128,128,128,128,128,128]]]],jp=[[[231,120,48,89,115,113,120,152,112],[152,179,64,126,170,118,46,70,95],[175,69,143,80,85,82,72,155,103],[56,58,10,171,218,189,17,13,152],[114,26,17,163,44,195,21,10,173],[121,24,80,195,26,62,44,64,85],[144,71,10,38,171,213,144,34,26],[170,46,55,19,136,160,33,206,71],[63,20,8,114,114,208,12,9,226],[81,40,11,96,182,84,29,16,36]],[[134,183,89,137,98,101,106,165,148],[72,187,100,130,157,111,32,75,80],[66,102,167,99,74,62,40,234,128],[41,53,9,178,241,141,26,8,107],[74,43,26,146,73,166,49,23,157],[65,38,105,160,51,52,31,115,128],[104,79,12,27,217,255,87,17,7],[87,68,71,44,114,51,15,186,23],[47,41,14,110,182,183,21,17,194],[66,45,25,102,197,189,23,18,22]],[[88,88,147,150,42,46,45,196,205],[43,97,183,117,85,38,35,179,61],[39,53,200,87,26,21,43,232,171],[56,34,51,104,114,102,29,93,77],[39,28,85,171,58,165,90,98,64],[34,22,116,206,23,34,43,166,73],[107,54,32,26,51,1,81,43,31],[68,25,106,22,64,171,36,225,114],[34,19,21,102,132,188,16,76,124],[62,18,78,95,85,57,50,48,51]],[[193,101,35,159,215,111,89,46,111],[60,148,31,172,219,228,21,18,111],[112,113,77,85,179,255,38,120,114],[40,42,1,196,245,209,10,25,109],[88,43,29,140,166,213,37,43,154],[61,63,30,155,67,45,68,1,209],[100,80,8,43,154,1,51,26,71],[142,78,78,16,255,128,34,197,171],[41,40,5,102,211,183,4,1,221],[51,50,17,168,209,192,23,25,82]],[[138,31,36,171,27,166,38,44,229],[67,87,58,169,82,115,26,59,179],[63,59,90,180,59,166,93,73,154],[40,40,21,116,143,209,34,39,175],[47,15,16,183,34,223,49,45,183],[46,17,33,183,6,98,15,32,183],[57,46,22,24,128,1,54,17,37],[65,32,73,115,28,128,23,128,205],[40,3,9,115,51,192,18,6,223],[87,37,9,115,59,77,64,21,47]],[[104,55,44,218,9,54,53,130,226],[64,90,70,205,40,41,23,26,57],[54,57,112,184,5,41,38,166,213],[30,34,26,133,152,116,10,32,134],[39,19,53,221,26,114,32,73,255],[31,9,65,234,2,15,1,118,73],[75,32,12,51,192,255,160,43,51],[88,31,35,67,102,85,55,186,85],[56,21,23,111,59,205,45,37,192],[55,38,70,124,73,102,1,34,98]],[[125,98,42,88,104,85,117,175,82],[95,84,53,89,128,100,113,101,45],[75,79,123,47,51,128,81,171,1],[57,17,5,71,102,57,53,41,49],[38,33,13,121,57,73,26,1,85],[41,10,67,138,77,110,90,47,114],[115,21,2,10,102,255,166,23,6],[101,29,16,10,85,128,101,196,26],[57,18,10,102,102,213,34,20,43],[117,20,15,36,163,128,68,1,26]],[[102,61,71,37,34,53,31,243,192],[69,60,71,38,73,119,28,222,37],[68,45,128,34,1,47,11,245,171],[62,17,19,70,146,85,55,62,70],[37,43,37,154,100,163,85,160,1],[63,9,92,136,28,64,32,201,85],[75,15,9,9,64,255,184,119,16],[86,6,28,5,64,255,25,248,1],[56,8,17,132,137,255,55,116,128],[58,15,20,82,135,57,26,121,40]],[[164,50,31,137,154,133,25,35,218],[51,103,44,131,131,123,31,6,158],[86,40,64,135,148,224,45,183,128],[22,26,17,131,240,154,14,1,209],[45,16,21,91,64,222,7,1,197],[56,21,39,155,60,138,23,102,213],[83,12,13,54,192,255,68,47,28],[85,26,85,85,128,128,32,146,171],[18,11,7,63,144,171,4,4,246],[35,27,10,146,174,171,12,26,128]],[[190,80,35,99,180,80,126,54,45],[85,126,47,87,176,51,41,20,32],[101,75,128,139,118,146,116,128,85],[56,41,15,176,236,85,37,9,62],[71,30,17,119,118,255,17,18,138],[101,38,60,138,55,70,43,26,142],[146,36,19,30,171,255,97,27,20],[138,45,61,62,219,1,81,188,64],[32,41,20,117,151,142,20,21,163],[112,19,12,61,195,128,48,4,24]]],Hp=[[[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[176,246,255,255,255,255,255,255,255,255,255],[223,241,252,255,255,255,255,255,255,255,255],[249,253,253,255,255,255,255,255,255,255,255]],[[255,244,252,255,255,255,255,255,255,255,255],[234,254,254,255,255,255,255,255,255,255,255],[253,255,255,255,255,255,255,255,255,255,255]],[[255,246,254,255,255,255,255,255,255,255,255],[239,253,254,255,255,255,255,255,255,255,255],[254,255,254,255,255,255,255,255,255,255,255]],[[255,248,254,255,255,255,255,255,255,255,255],[251,255,254,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,253,254,255,255,255,255,255,255,255,255],[251,254,254,255,255,255,255,255,255,255,255],[254,255,254,255,255,255,255,255,255,255,255]],[[255,254,253,255,254,255,255,255,255,255,255],[250,255,254,255,254,255,255,255,255,255,255],[254,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]]],[[[217,255,255,255,255,255,255,255,255,255,255],[225,252,241,253,255,255,254,255,255,255,255],[234,250,241,250,253,255,253,254,255,255,255]],[[255,254,255,255,255,255,255,255,255,255,255],[223,254,254,255,255,255,255,255,255,255,255],[238,253,254,254,255,255,255,255,255,255,255]],[[255,248,254,255,255,255,255,255,255,255,255],[249,254,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,253,255,255,255,255,255,255,255,255,255],[247,254,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,253,254,255,255,255,255,255,255,255,255],[252,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,254,254,255,255,255,255,255,255,255,255],[253,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,254,253,255,255,255,255,255,255,255,255],[250,255,255,255,255,255,255,255,255,255,255],[254,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]]],[[[186,251,250,255,255,255,255,255,255,255,255],[234,251,244,254,255,255,255,255,255,255,255],[251,251,243,253,254,255,254,255,255,255,255]],[[255,253,254,255,255,255,255,255,255,255,255],[236,253,254,255,255,255,255,255,255,255,255],[251,253,253,254,254,255,255,255,255,255,255]],[[255,254,254,255,255,255,255,255,255,255,255],[254,254,254,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,254,255,255,255,255,255,255,255,255,255],[254,254,255,255,255,255,255,255,255,255,255],[254,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[254,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]]],[[[248,255,255,255,255,255,255,255,255,255,255],[250,254,252,254,255,255,255,255,255,255,255],[248,254,249,253,255,255,255,255,255,255,255]],[[255,253,253,255,255,255,255,255,255,255,255],[246,253,253,255,255,255,255,255,255,255,255],[252,254,251,254,254,255,255,255,255,255,255]],[[255,254,252,255,255,255,255,255,255,255,255],[248,254,253,255,255,255,255,255,255,255,255],[253,255,254,254,255,255,255,255,255,255,255]],[[255,251,254,255,255,255,255,255,255,255,255],[245,251,254,255,255,255,255,255,255,255,255],[253,253,254,255,255,255,255,255,255,255,255]],[[255,251,253,255,255,255,255,255,255,255,255],[252,253,254,255,255,255,255,255,255,255,255],[255,254,255,255,255,255,255,255,255,255,255]],[[255,252,255,255,255,255,255,255,255,255,255],[249,255,254,255,255,255,255,255,255,255,255],[255,255,254,255,255,255,255,255,255,255,255]],[[255,255,253,255,255,255,255,255,255,255,255],[250,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[254,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]]]],Up=[0,1,2,3,6,4,5,6,6,6,6,6,6,6,6,7,0],Kr=[],hr=[],_a=[],Wp=1,yf=2,Zr=[],nr=[];pa("UpsampleRgbLinePair",Ur,3),pa("UpsampleBgrLinePair",pi,3),pa("UpsampleRgbaLinePair",ki,4),pa("UpsampleBgraLinePair",Gs,4),pa("UpsampleArgbLinePair",oc,4),pa("UpsampleRgba4444LinePair",No,2),pa("UpsampleRgb565LinePair",Ao,2);var Vp=D.UpsampleRgbLinePair,Gp=D.UpsampleBgrLinePair,bf=D.UpsampleRgbaLinePair,Oo=D.UpsampleBgraLinePair,Fo=D.UpsampleArgbLinePair,wf=D.UpsampleRgba4444LinePair,Xp=D.UpsampleRgb565LinePair,Zc=16,Sa=1<<Zc-1,Zs=-227,$u=482,Yp=6,xf=0,kl=s(256),Al=s(256),Kp=s(256),Zp=s(256),Jp=s($u-Zs),Nl=s($u-Zs);ga("YuvToRgbRow",Ur,3),ga("YuvToBgrRow",pi,3),ga("YuvToRgbaRow",ki,4),ga("YuvToBgraRow",Gs,4),ga("YuvToArgbRow",oc,4),ga("YuvToRgba4444Row",No,2),ga("YuvToRgb565Row",Ao,2);var Ro=[0,4,8,12,128,132,136,140,256,260,264,268,384,388,392,396],Jc=[0,2,8],Qp=[8,7,6,4,4,2,2,2,1,1,1,1],$p=1;this.WebPDecodeRGBA=function(g,v,k,L,z){var H=Yc,X=new ze,$=new kt;X.ba=$,$.S=H,$.width=[$.width],$.height=[$.height];var ie=$.width,oe=$.height,we=new gt;if(we==null||g==null)var De=2;else e(we!=null),De=ls(g,v,k,we.width,we.height,we.Pd,we.Qd,we.format,null);if(De!=0?ie=0:(ie!=null&&(ie[0]=we.width[0]),oe!=null&&(oe[0]=we.height[0]),ie=1),ie){$.width=$.width[0],$.height=$.height[0],L!=null&&(L[0]=$.width),z!=null&&(z[0]=$.height);e:{if(L=new cr,(z=new Ge).data=g,z.w=v,z.ha=k,z.kd=1,v=[0],e(z!=null),((g=ls(z.data,z.w,z.ha,null,null,null,v,null,z))==0||g==7)&&v[0]&&(g=4),(v=g)==0){if(e(X!=null),L.data=z.data,L.w=z.w+z.offset,L.ha=z.ha-z.offset,L.put=Bt,L.ac=li,L.bc=Jn,L.ma=X,z.xa){if((g=Mn())==null){X=1;break e}if((function(ce,Se){var Ce=[0],He=[0],Te=[0];t:for(;;){if(ce==null)return 0;if(Se==null)return ce.a=2,0;if(ce.l=Se,ce.a=0,Y(ce.m,Se.data,Se.w,Se.ha),!qn(ce.m,Ce,He,Te)){ce.a=3;break t}if(ce.xb=yf,Se.width=Ce[0],Se.height=He[0],!Zt(Ce[0],He[0],1,ce,null))break t;return 1}return e(ce.a!=0),0})(g,L)){if(L=(v=Va(L.width,L.height,X.Oa,X.ba))==0){t:{L=g;n:for(;;){if(L==null){L=0;break t}if(e(L.s.yc!=null),e(L.s.Ya!=null),e(0<L.s.Wb),e((k=L.l)!=null),e((z=k.ma)!=null),L.xb!=0){if(L.ca=z.ba,L.tb=z.tb,e(L.ca!=null),!lc(z.Oa,k,Kc)){L.a=2;break n}if(!Qn(L,k.width)||k.da)break n;if((k.da||ot(L.ca.S))&&Ps(),11>L.ca.S||(alert("todo:WebPInitConvertARGBToYUV"),L.ca.f.kb.F!=null&&Ps()),L.Pb&&0<L.s.ua&&L.s.vb.X==null&&!K(L.s.vb,L.s.Wa.Xa)){L.a=1;break n}L.xb=0}if(!Qt(L,L.V,L.Ba,L.c,L.i,k.o,nn))break n;z.Dc=L.Ma,L=1;break t}e(L.a!=0),L=0}L=!L}L&&(v=g.a)}else v=g.a}else{if((g=new nc)==null){X=1;break e}if(g.Fa=z.na,g.P=z.P,g.qc=z.Sa,fi(g,L)){if((v=Va(L.width,L.height,X.Oa,X.ba))==0){if(g.Aa=0,k=X.Oa,e((z=g)!=null),k!=null){if(0<(ie=0>(ie=k.Md)?0:100<ie?255:255*ie/100)){for(oe=we=0;4>oe;++oe)12>(De=z.pb[oe]).lc&&(De.ia=ie*Qp[0>De.lc?0:De.lc]>>3),we|=De.ia;we&&(alert("todo:VP8InitRandom"),z.ia=1)}z.Ga=k.Id,100<z.Ga?z.Ga=100:0>z.Ga&&(z.Ga=0)}(function(ce,Se){if(ce==null)return 0;if(Se==null)return $n(ce,2,"NULL VP8Io parameter in VP8Decode().");if(!ce.cb&&!fi(ce,Se))return 0;if(e(ce.cb),Se.ac==null||Se.ac(Se)){Se.ob&&(ce.L=0);var Ce=Jc[ce.L];if(ce.L==2?(ce.yb=0,ce.zb=0):(ce.yb=Se.v-Ce>>4,ce.zb=Se.j-Ce>>4,0>ce.yb&&(ce.yb=0),0>ce.zb&&(ce.zb=0)),ce.Va=Se.o+15+Ce>>4,ce.Hb=Se.va+15+Ce>>4,ce.Hb>ce.za&&(ce.Hb=ce.za),ce.Va>ce.Ub&&(ce.Va=ce.Ub),0<ce.L){var He=ce.ed;for(Ce=0;4>Ce;++Ce){var Te;if(ce.Qa.Cb){var Xe=ce.Qa.Lb[Ce];ce.Qa.Fb||(Xe+=He.Tb)}else Xe=He.Tb;for(Te=0;1>=Te;++Te){var Ze=ce.gd[Ce][Te],at=Xe;if(He.Pc&&(at+=He.vd[0],Te&&(at+=He.od[0])),0<(at=0>at?0:63<at?63:at)){var et=at;0<He.wb&&(et=4<He.wb?et>>2:et>>1)>9-He.wb&&(et=9-He.wb),1>et&&(et=1),Ze.dd=et,Ze.tc=2*at+et,Ze.ld=40<=at?2:15<=at?1:0}else Ze.tc=0;Ze.La=Te}}}Ce=0}else $n(ce,6,"Frame setup failed"),Ce=ce.a;if(Ce=Ce==0){if(Ce){ce.$c=0,0<ce.Aa||(ce.Ic=$p);t:{Ce=ce.Ic,He=4*(et=ce.za);var Ht=32*et,Pt=et+1,un=0<ce.L?et*(0<ce.Aa?2:1):0,Nt=(ce.Aa==2?2:1)*et;if((Ze=He+832+(Te=3*(16*Ce+Jc[ce.L])/2*Ht)+(Xe=ce.Fa!=null&&0<ce.Fa.length?ce.Kc.c*ce.Kc.i:0))!=Ze)Ce=0;else{if(Ze>ce.Vb){if(ce.Vb=0,ce.Ec=s(Ze),ce.Fc=0,ce.Ec==null){Ce=$n(ce,1,"no memory during frame initialization.");break t}ce.Vb=Ze}Ze=ce.Ec,at=ce.Fc,ce.Ac=Ze,ce.Bc=at,at+=He,ce.Gd=a(Ht,ua),ce.Hd=0,ce.rb=a(Pt+1,ws),ce.sb=1,ce.wa=un?a(un,Pr):null,ce.Y=0,ce.D.Nb=0,ce.D.wa=ce.wa,ce.D.Y=ce.Y,0<ce.Aa&&(ce.D.Y+=et),e(!0),ce.oc=Ze,ce.pc=at,at+=832,ce.ya=a(Nt,lr),ce.aa=0,ce.D.ya=ce.ya,ce.D.aa=ce.aa,ce.Aa==2&&(ce.D.aa+=et),ce.R=16*et,ce.B=8*et,et=(Ht=Jc[ce.L])*ce.R,Ht=Ht/2*ce.B,ce.sa=Ze,ce.ta=at+et,ce.qa=ce.sa,ce.ra=ce.ta+16*Ce*ce.R+Ht,ce.Ha=ce.qa,ce.Ia=ce.ra+8*Ce*ce.B+Ht,ce.$c=0,at+=Te,ce.mb=Xe?Ze:null,ce.nb=Xe?at:null,e(at+Xe<=ce.Fc+ce.Vb),ml(ce),r(ce.Ac,ce.Bc,0,He),Ce=1}}if(Ce){if(Se.ka=0,Se.y=ce.sa,Se.O=ce.ta,Se.f=ce.qa,Se.N=ce.ra,Se.ea=ce.Ha,Se.Vd=ce.Ia,Se.fa=ce.R,Se.Rc=ce.B,Se.F=null,Se.J=0,!To){for(Ce=-255;255>=Ce;++Ce)ff[255+Ce]=0>Ce?-Ce:Ce;for(Ce=-1020;1020>=Ce;++Ce)hf[1020+Ce]=-128>Ce?-128:127<Ce?127:Ce;for(Ce=-112;112>=Ce;++Ce)pf[112+Ce]=-16>Ce?-16:15<Ce?15:Ce;for(Ce=-255;510>=Ce;++Ce)Mo[255+Ce]=0>Ce?0:255<Ce?255:Ce;To=1}Xr=za,us=ic,Ks=Ir,Ln=dr,kn=rs,ds=vl,Vn=xe,Mi=Ve,va=R,hc=te,Is=Ct,ya=x,of=me,lf=Ne,cf=br,Po=Hr,Eo=xo,uf=_o,hr[0]=sc,hr[1]=yl,hr[2]=js,hr[3]=ks,hr[4]=as,hr[5]=Ns,hr[6]=As,hr[7]=Hs,hr[8]=bo,hr[9]=da,Kr[0]=Ss,Kr[1]=ss,Kr[2]=_s,Kr[3]=yo,Kr[4]=Li,Kr[5]=qa,Kr[6]=rc,_a[0]=ac,_a[1]=qs,_a[2]=Us,_a[3]=Ws,_a[4]=wo,_a[5]=ja,_a[6]=os,Ce=1}else Ce=0}Ce&&(Ce=(function(hn,Ti){for(hn.M=0;hn.M<hn.Va;++hn.M){var dn,Mt=hn.Jc[hn.M&hn.Xb],pt=hn.m,Gn=hn;for(dn=0;dn<Gn.za;++dn){var on=pt,xn=Gn,ei=xn.Ac,gi=xn.Bc+4*dn,Ai=xn.zc,mi=xn.ya[xn.aa+dn];if(xn.Qa.Bb?mi.$b=pe(on,xn.Pa.jb[0])?2+pe(on,xn.Pa.jb[2]):pe(on,xn.Pa.jb[1]):mi.$b=0,xn.kc&&(mi.Ad=pe(on,xn.Bd)),mi.Za=!pe(on,145)+0,mi.Za){var pr=mi.Ob,_r=0;for(xn=0;4>xn;++xn){var ci,gn=Ai[0+xn];for(ci=0;4>ci;++ci){gn=jp[ei[gi+ci]][gn];for(var Dn=Do[pe(on,gn[0])];0<Dn;)Dn=Do[2*Dn+pe(on,gn[Dn])];gn=-Dn,ei[gi+ci]=gn}i(pr,_r,ei,gi,4),_r+=4,Ai[0+xn]=gn}}else gn=pe(on,156)?pe(on,128)?1:3:pe(on,163)?2:0,mi.Ob[0]=gn,r(ei,gi,gn,4),r(Ai,0,gn,4);mi.Dd=pe(on,142)?pe(on,114)?pe(on,183)?1:3:2:0}if(Gn.m.Ka)return $n(hn,7,"Premature end-of-partition0 encountered.");for(;hn.ja<hn.za;++hn.ja){if(Gn=Mt,on=(pt=hn).rb[pt.sb-1],ei=pt.rb[pt.sb+pt.ja],dn=pt.ya[pt.aa+pt.ja],gi=pt.kc?dn.Ad:0)on.la=ei.la=0,dn.Za||(on.Na=ei.Na=0),dn.Hc=0,dn.Gc=0,dn.ia=0;else{var vi,On;if(on=ei,ei=Gn,gi=pt.Pa.Xc,Ai=pt.ya[pt.aa+pt.ja],mi=pt.pb[Ai.$b],xn=Ai.ad,pr=0,_r=pt.rb[pt.sb-1],gn=ci=0,r(xn,pr,0,384),Ai.Za)var yi=0,gr=gi[3];else{Dn=s(16);var _i=on.Na+_r.Na;if(_i=gc(ei,gi[1],_i,mi.Eb,0,Dn,0),on.Na=_r.Na=(0<_i)+0,1<_i)Xr(Dn,0,xn,pr);else{var Lr=Dn[0]+3>>3;for(Dn=0;256>Dn;Dn+=16)xn[pr+Dn]=Lr}yi=1,gr=gi[0]}var Hn=15&on.la,ui=15&_r.la;for(Dn=0;4>Dn;++Dn){var Wi=1&ui;for(Lr=On=0;4>Lr;++Lr)Hn=Hn>>1|(Wi=(_i=gc(ei,gr,_i=Wi+(1&Hn),mi.Sc,yi,xn,pr))>yi)<<7,On=On<<2|(3<_i?3:1<_i?2:xn[pr+0]!=0),pr+=16;Hn>>=4,ui=ui>>1|Wi<<7,ci=(ci<<8|On)>>>0}for(gr=Hn,yi=ui>>4,vi=0;4>vi;vi+=2){for(On=0,Hn=on.la>>4+vi,ui=_r.la>>4+vi,Dn=0;2>Dn;++Dn){for(Wi=1&ui,Lr=0;2>Lr;++Lr)_i=Wi+(1&Hn),Hn=Hn>>1|(Wi=0<(_i=gc(ei,gi[2],_i,mi.Qc,0,xn,pr)))<<3,On=On<<2|(3<_i?3:1<_i?2:xn[pr+0]!=0),pr+=16;Hn>>=2,ui=ui>>1|Wi<<5}gn|=On<<4*vi,gr|=Hn<<4<<vi,yi|=(240&ui)<<vi}on.la=gr,_r.la=yi,Ai.Hc=ci,Ai.Gc=gn,Ai.ia=43690&gn?0:mi.ia,gi=!(ci|gn)}if(0<pt.L&&(pt.wa[pt.Y+pt.ja]=pt.gd[dn.$b][dn.Za],pt.wa[pt.Y+pt.ja].La|=!gi),Gn.Ka)return $n(hn,7,"Premature end-of-file encountered.")}if(ml(hn),pt=Ti,Gn=1,dn=(Mt=hn).D,on=0<Mt.L&&Mt.M>=Mt.zb&&Mt.M<=Mt.Va,Mt.Aa==0)t:{if(dn.M=Mt.M,dn.uc=on,er(Mt,dn),Gn=1,dn=(On=Mt.D).Nb,on=(gn=Jc[Mt.L])*Mt.R,ei=gn/2*Mt.B,Dn=16*dn*Mt.R,Lr=8*dn*Mt.B,gi=Mt.sa,Ai=Mt.ta-on+Dn,mi=Mt.qa,xn=Mt.ra-ei+Lr,pr=Mt.Ha,_r=Mt.Ia-ei+Lr,ui=(Hn=On.M)==0,ci=Hn>=Mt.Va-1,Mt.Aa==2&&er(Mt,On),On.uc)for(Wi=(_i=Mt).D.M,e(_i.D.uc),On=_i.yb;On<_i.Hb;++On){yi=On,gr=Wi;var Sr=(Jr=(ir=_i).D).Nb;vi=ir.R;var Jr=Jr.wa[Jr.Y+yi],Qr=ir.sa,Di=ir.ta+16*Sr*vi+16*yi,Vi=Jr.dd,Xn=Jr.tc;if(Xn!=0)if(e(3<=Xn),ir.L==1)0<yi&&Po(Qr,Di,vi,Xn+4),Jr.La&&uf(Qr,Di,vi,Xn),0<gr&&cf(Qr,Di,vi,Xn+4),Jr.La&&Eo(Qr,Di,vi,Xn);else{var $r=ir.B,Ls=ir.qa,fs=ir.ra+8*Sr*$r+8*yi,Mr=ir.Ha,ir=ir.Ia+8*Sr*$r+8*yi;Sr=Jr.ld,0<yi&&(Mi(Qr,Di,vi,Xn+4,Vi,Sr),hc(Ls,fs,Mr,ir,$r,Xn+4,Vi,Sr)),Jr.La&&(ya(Qr,Di,vi,Xn,Vi,Sr),lf(Ls,fs,Mr,ir,$r,Xn,Vi,Sr)),0<gr&&(Vn(Qr,Di,vi,Xn+4,Vi,Sr),va(Ls,fs,Mr,ir,$r,Xn+4,Vi,Sr)),Jr.La&&(Is(Qr,Di,vi,Xn,Vi,Sr),of(Ls,fs,Mr,ir,$r,Xn,Vi,Sr))}}if(Mt.ia&&alert("todo:DitherRow"),pt.put!=null){if(On=16*Hn,Hn=16*(Hn+1),ui?(pt.y=Mt.sa,pt.O=Mt.ta+Dn,pt.f=Mt.qa,pt.N=Mt.ra+Lr,pt.ea=Mt.Ha,pt.W=Mt.Ia+Lr):(On-=gn,pt.y=gi,pt.O=Ai,pt.f=mi,pt.N=xn,pt.ea=pr,pt.W=_r),ci||(Hn-=gn),Hn>pt.o&&(Hn=pt.o),pt.F=null,pt.J=null,Mt.Fa!=null&&0<Mt.Fa.length&&On<Hn&&(pt.J=Sn(Mt,pt,On,Hn-On),pt.F=Mt.mb,pt.F==null&&pt.F.length==0)){Gn=$n(Mt,3,"Could not decode alpha data.");break t}On<pt.j&&(gn=pt.j-On,On=pt.j,e(!(1&gn)),pt.O+=Mt.R*gn,pt.N+=Mt.B*(gn>>1),pt.W+=Mt.B*(gn>>1),pt.F!=null&&(pt.J+=pt.width*gn)),On<Hn&&(pt.O+=pt.v,pt.N+=pt.v>>1,pt.W+=pt.v>>1,pt.F!=null&&(pt.J+=pt.v),pt.ka=On-pt.j,pt.U=pt.va-pt.v,pt.T=Hn-On,Gn=pt.put(pt))}dn+1!=Mt.Ic||ci||(i(Mt.sa,Mt.ta-on,gi,Ai+16*Mt.R,on),i(Mt.qa,Mt.ra-ei,mi,xn+8*Mt.B,ei),i(Mt.Ha,Mt.Ia-ei,pr,_r+8*Mt.B,ei))}if(!Gn)return $n(hn,6,"Output aborted.")}return 1})(ce,Se)),Se.bc!=null&&Se.bc(Se),Ce&=1}return Ce?(ce.cb=0,Ce):0})(g,L)||(v=g.a)}}else v=g.a}v==0&&X.Oa!=null&&X.Oa.fd&&(v=cc(X.ba))}X=v}H=X!=0?null:11>H?$.f.RGBA.eb:$.f.kb.y}else H=null;return H};var Bo=[3,4,3,4,4,2,2,4,4,4,2,1,1]};function c(D,U){for(var C="",N=0;N<4;N++)C+=String.fromCharCode(D[U++]);return C}function u(D,U){return D[U+0]|D[U+1]<<8}function f(D,U){return(D[U+0]|D[U+1]<<8|D[U+2]<<16)>>>0}function p(D,U){return(D[U+0]|D[U+1]<<8|D[U+2]<<16|D[U+3]<<24)>>>0}new l;var d=[0],y=[0],m=[],w=new l,b=t,S=(function(D,U){var C={},N=0,B=!1,P=0,F=0;if(C.frames=[],!(function(O,V){for(var G=0;G<4;G++)if(O[V+G]!="RIFF".charCodeAt(G))return!0;return!1})(D,U)){for(p(D,U+=4),U+=8;U<D.length;){var q=c(D,U),Z=p(D,U+=4);U+=4;var W=Z+(1&Z);switch(q){case"VP8 ":case"VP8L":C.frames[N]===void 0&&(C.frames[N]={}),(le=C.frames[N]).src_off=B?F:U-8,le.src_size=P+Z+8,N++,B&&(B=!1,P=0,F=0);break;case"VP8X":(le=C.header={}).feature_flags=D[U];var Y=U+4;le.canvas_width=1+f(D,Y),Y+=3,le.canvas_height=1+f(D,Y),Y+=3;break;case"ALPH":B=!0,P=W+8,F=U-8;break;case"ANIM":(le=C.header).bgcolor=p(D,U),Y=U+4,le.loop_count=u(D,Y),Y+=2;break;case"ANMF":var ue,le;(le=C.frames[N]={}).offset_x=2*f(D,U),U+=3,le.offset_y=2*f(D,U),U+=3,le.width=1+f(D,U),U+=3,le.height=1+f(D,U),U+=3,le.duration=f(D,U),U+=3,ue=D[U++],le.dispose=1&ue,le.blend=ue>>1&1}q!="ANMF"&&(U+=W)}return C}})(b,0);S.response=b,S.rgbaoutput=!0,S.dataurl=!1;var A=S.header?S.header:null,_=S.frames?S.frames:null;if(A){A.loop_counter=A.loop_count,d=[A.canvas_height],y=[A.canvas_width];for(var I=0;I<_.length&&_[I].blend!=0;I++);}var E=_[0],M=w.WebPDecodeRGBA(b,E.src_off,E.src_size,y,d);E.rgba=M,E.imgwidth=y[0],E.imgheight=d[0];for(var T=0;T<y[0]*d[0]*4;T++)m[T]=M[T];return this.width=y,this.height=d,this.data=m,this}function OF(){var t,e=this.internal.__metadata__.metadata,n=unescape(encodeURIComponent(e));t=this.internal.__metadata__.rawXml?n:'<x:xmpmeta xmlns:x="adobe:ns:meta/"><rdf:RDF xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#"><rdf:Description rdf:about="" xmlns:jspdf="'+this.internal.__metadata__.namespaceUri+'"><jspdf:metadata>'+n.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&apos;")+"</jspdf:metadata></rdf:Description></rdf:RDF></x:xmpmeta>",this.internal.__metadata__.metadataObjectNumber=this.internal.newObject(),this.internal.write("<< /Type /Metadata /Subtype /XML /Length "+t.length+" >>"),this.internal.write("stream"),this.internal.write(t),this.internal.write("endstream"),this.internal.write("endobj")}function FF(){this.internal.__metadata__.metadataObjectNumber&&this.internal.write("/Metadata "+this.internal.__metadata__.metadataObjectNumber+" 0 R")}(function(t){var e,n,i,r,s,a,o,l,c,u=function(O){return O=O||{},this.isStrokeTransparent=O.isStrokeTransparent||!1,this.strokeOpacity=O.strokeOpacity||1,this.strokeStyle=O.strokeStyle||"#000000",this.fillStyle=O.fillStyle||"#000000",this.isFillTransparent=O.isFillTransparent||!1,this.fillOpacity=O.fillOpacity||1,this.font=O.font||"10px sans-serif",this.textBaseline=O.textBaseline||"alphabetic",this.textAlign=O.textAlign||"left",this.lineWidth=O.lineWidth||1,this.lineJoin=O.lineJoin||"miter",this.lineCap=O.lineCap||"butt",this.path=O.path||[],this.transform=O.transform!==void 0?O.transform.clone():new l,this.globalCompositeOperation=O.globalCompositeOperation||"normal",this.globalAlpha=O.globalAlpha||1,this.clip_path=O.clip_path||[],this.currentPoint=O.currentPoint||new a,this.miterLimit=O.miterLimit||10,this.lastPoint=O.lastPoint||new a,this.lineDashOffset=O.lineDashOffset||0,this.lineDash=O.lineDash||[],this.margin=O.margin||[0,0,0,0],this.prevPageLastElemOffset=O.prevPageLastElemOffset||0,this.ignoreClearRect=typeof O.ignoreClearRect!="boolean"||O.ignoreClearRect,this};t.events.push(["initialized",function(){this.context2d=new f(this),e=this.internal.f2,n=this.internal.getCoordinateString,i=this.internal.getVerticalCoordinateString,r=this.internal.getHorizontalCoordinate,s=this.internal.getVerticalCoordinate,a=this.internal.Point,o=this.internal.Rectangle,l=this.internal.Matrix,c=new u}]);var f=function(O){Object.defineProperty(this,"canvas",{get:function(){return{parentNode:!1,style:!1}}});var V=O;Object.defineProperty(this,"pdf",{get:function(){return V}});var G=!1;Object.defineProperty(this,"pageWrapXEnabled",{get:function(){return G},set:function(K){G=!!K}});var re=!1;Object.defineProperty(this,"pageWrapYEnabled",{get:function(){return re},set:function(K){re=!!K}});var ae=0;Object.defineProperty(this,"posX",{get:function(){return ae},set:function(K){isNaN(K)||(ae=K)}});var ee=0;Object.defineProperty(this,"posY",{get:function(){return ee},set:function(K){isNaN(K)||(ee=K)}}),Object.defineProperty(this,"margin",{get:function(){return c.margin},set:function(K){var Re;typeof K=="number"?Re=[K,K,K,K]:((Re=new Array(4))[0]=K[0],Re[1]=K.length>=2?K[1]:Re[0],Re[2]=K.length>=3?K[2]:Re[0],Re[3]=K.length>=4?K[3]:Re[1]),c.margin=Re}});var de=!1;Object.defineProperty(this,"autoPaging",{get:function(){return de},set:function(K){de=K}});var he=0;Object.defineProperty(this,"lastBreak",{get:function(){return he},set:function(K){he=K}});var pe=[];Object.defineProperty(this,"pageBreaks",{get:function(){return pe},set:function(K){pe=K}}),Object.defineProperty(this,"ctx",{get:function(){return c},set:function(K){K instanceof u&&(c=K)}}),Object.defineProperty(this,"path",{get:function(){return c.path},set:function(K){c.path=K}});var ge=[];Object.defineProperty(this,"ctxStack",{get:function(){return ge},set:function(K){ge=K}}),Object.defineProperty(this,"fillStyle",{get:function(){return this.ctx.fillStyle},set:function(K){var Re;Re=p(K),this.ctx.fillStyle=Re.style,this.ctx.isFillTransparent=Re.a===0,this.ctx.fillOpacity=Re.a,this.pdf.setFillColor(Re.r,Re.g,Re.b,{a:Re.a}),this.pdf.setTextColor(Re.r,Re.g,Re.b,{a:Re.a})}}),Object.defineProperty(this,"strokeStyle",{get:function(){return this.ctx.strokeStyle},set:function(K){var Re=p(K);this.ctx.strokeStyle=Re.style,this.ctx.isStrokeTransparent=Re.a===0,this.ctx.strokeOpacity=Re.a,Re.a===0?this.pdf.setDrawColor(255,255,255):(Re.a,this.pdf.setDrawColor(Re.r,Re.g,Re.b))}}),Object.defineProperty(this,"lineCap",{get:function(){return this.ctx.lineCap},set:function(K){["butt","round","square"].indexOf(K)!==-1&&(this.ctx.lineCap=K,this.pdf.setLineCap(K))}}),Object.defineProperty(this,"lineWidth",{get:function(){return this.ctx.lineWidth},set:function(K){isNaN(K)||(this.ctx.lineWidth=K,this.pdf.setLineWidth(K))}}),Object.defineProperty(this,"lineJoin",{get:function(){return this.ctx.lineJoin},set:function(K){["bevel","round","miter"].indexOf(K)!==-1&&(this.ctx.lineJoin=K,this.pdf.setLineJoin(K))}}),Object.defineProperty(this,"miterLimit",{get:function(){return this.ctx.miterLimit},set:function(K){isNaN(K)||(this.ctx.miterLimit=K,this.pdf.setMiterLimit(K))}}),Object.defineProperty(this,"textBaseline",{get:function(){return this.ctx.textBaseline},set:function(K){this.ctx.textBaseline=K}}),Object.defineProperty(this,"textAlign",{get:function(){return this.ctx.textAlign},set:function(K){["right","end","center","left","start"].indexOf(K)!==-1&&(this.ctx.textAlign=K)}});var Ee=null,Ae=null,Ye=null;Object.defineProperty(this,"fontFaces",{get:function(){return Ye},set:function(K){Ee=null,Ae=null,Ye=K}}),Object.defineProperty(this,"font",{get:function(){return this.ctx.font},set:function(K){var Re;if(this.ctx.font=K,(Re=/^\s*(?=(?:(?:[-a-z]+\s*){0,2}(italic|oblique))?)(?=(?:(?:[-a-z]+\s*){0,2}(small-caps))?)(?=(?:(?:[-a-z]+\s*){0,2}(bold(?:er)?|lighter|[1-9]00))?)(?:(?:normal|\1|\2|\3)\s*){0,3}((?:xx?-)?(?:small|large)|medium|smaller|larger|[.\d]+(?:\%|in|[cem]m|ex|p[ctx]))(?:\s*\/\s*(normal|[.\d]+(?:\%|in|[cem]m|ex|p[ctx])))?\s*([-_,\"\'\sa-z0-9]+?)\s*$/i.exec(K))!==null){var Qe=Re[1];Re[2];var Be=Re[3],Ie=Re[4];Re[5];var lt=Re[6],We=/^([.\d]+)((?:%|in|[cem]m|ex|p[ctx]))$/i.exec(Ie)[2];Ie=Math.floor(We==="px"?parseFloat(Ie)*this.pdf.internal.scaleFactor:We==="em"?parseFloat(Ie)*this.pdf.getFontSize():parseFloat(Ie)*this.pdf.internal.scaleFactor),this.pdf.setFontSize(Ie);var Ke=(function(nt){var _t,At,St=[],st=nt.trim();if(st==="")return tm;if(st in Ey)return[Ey[st]];for(;st!=="";){switch(At=null,_t=(st=Ly(st)).charAt(0)){case'"':case"'":At=EF(st.substring(1),_t);break;default:At=IF(st)}if(At===null||(St.push(At[0]),(st=Ly(At[1]))!==""&&st.charAt(0)!==","))return tm;st=st.replace(/^,/,"")}return St})(lt);if(this.fontFaces){var ht=(function(nt,_t){var At=nt.getFontList(),St=JSON.stringify(At);if(Ee===null||Ae!==St){var st=(function(Ot){var dt=[];return Object.keys(Ot).forEach(function(bt){Ot[bt].forEach(function(ot){var vt=null;switch(ot){case"bold":vt={family:bt,weight:"bold"};break;case"italic":vt={family:bt,style:"italic"};break;case"bolditalic":vt={family:bt,weight:"bold",style:"italic"};break;case"":case"normal":vt={family:bt}}vt!==null&&(vt.ref={name:bt,style:ot},dt.push(vt))})}),dt})(At);Ee=(function(Ot){for(var dt={},bt=0;bt<Ot.length;++bt){var ot=em(Ot[bt]),vt=ot.family,jt=ot.stretch,kt=ot.style,gt=ot.weight;dt[vt]=dt[vt]||{},dt[vt][jt]=dt[vt][jt]||{},dt[vt][jt][kt]=dt[vt][jt][kt]||{},dt[vt][jt][kt][gt]=ot}return dt})(st.concat(_t)),Ae=St}return Ee})(this.pdf,this.fontFaces),Rt=Ke.map(function(nt){return{family:nt,stretch:"normal",weight:Be,style:Qe}}),ye=(function(nt,_t,At){for(var St=(At=At||{}).defaultFontFamily||"times",st=Object.assign({},PF,At.genericFontFamilies||{}),Ot=null,dt=null,bt=0;bt<_t.length;++bt)if(st[(Ot=em(_t[bt])).family]&&(Ot.family=st[Ot.family]),nt.hasOwnProperty(Ot.family)){dt=nt[Ot.family];break}if(!(dt=dt||nt[St]))throw new Error("Could not find a font-family for the rule '"+Iy(Ot)+"' and default family '"+St+"'.");if(dt=(function(ot,vt){if(vt[ot])return vt[ot];var jt=c1[ot],kt=jt<=c1.normal?-1:1,gt=Py(vt,u_,jt,kt);if(!gt)throw new Error("Could not find a matching font-stretch value for "+ot);return gt})(Ot.stretch,dt),dt=(function(ot,vt){if(vt[ot])return vt[ot];for(var jt=c_[ot],kt=0;kt<jt.length;++kt)if(vt[jt[kt]])return vt[jt[kt]];throw new Error("Could not find a matching font-style for "+ot)})(Ot.style,dt),!(dt=(function(ot,vt){if(vt[ot])return vt[ot];if(ot===400&&vt[500])return vt[500];if(ot===500&&vt[400])return vt[400];var jt=CF[ot],kt=Py(vt,d_,jt,ot<400?-1:1);if(!kt)throw new Error("Could not find a matching font-weight for value "+ot);return kt})(Ot.weight,dt)))throw new Error("Failed to resolve a font for the rule '"+Iy(Ot)+"'.");return dt})(ht,Rt);this.pdf.setFont(ye.ref.name,ye.ref.style)}else{var qe="";(Be==="bold"||parseInt(Be,10)>=700||Qe==="bold")&&(qe="bold"),Qe==="italic"&&(qe+="italic"),qe.length===0&&(qe="normal");for(var ve="",Pe={arial:"Helvetica",Arial:"Helvetica",verdana:"Helvetica",Verdana:"Helvetica",helvetica:"Helvetica",Helvetica:"Helvetica","sans-serif":"Helvetica",fixed:"Courier",monospace:"Courier",terminal:"Courier",cursive:"Times",fantasy:"Times",serif:"Times"},Le=0;Le<Ke.length;Le++){if(this.pdf.internal.getFont(Ke[Le],qe,{noFallback:!0,disableWarning:!0})!==void 0){ve=Ke[Le];break}if(qe==="bolditalic"&&this.pdf.internal.getFont(Ke[Le],"bold",{noFallback:!0,disableWarning:!0})!==void 0)ve=Ke[Le],qe="bold";else if(this.pdf.internal.getFont(Ke[Le],"normal",{noFallback:!0,disableWarning:!0})!==void 0){ve=Ke[Le],qe="normal";break}}if(ve===""){for(var it=0;it<Ke.length;it++)if(Pe[Ke[it]]){ve=Pe[Ke[it]];break}}ve=ve===""?"Times":ve,this.pdf.setFont(ve,qe)}}}}),Object.defineProperty(this,"globalCompositeOperation",{get:function(){return this.ctx.globalCompositeOperation},set:function(K){this.ctx.globalCompositeOperation=K}}),Object.defineProperty(this,"globalAlpha",{get:function(){return this.ctx.globalAlpha},set:function(K){this.ctx.globalAlpha=K}}),Object.defineProperty(this,"lineDashOffset",{get:function(){return this.ctx.lineDashOffset},set:function(K){this.ctx.lineDashOffset=K,le.call(this)}}),Object.defineProperty(this,"lineDash",{get:function(){return this.ctx.lineDash},set:function(K){this.ctx.lineDash=K,le.call(this)}}),Object.defineProperty(this,"ignoreClearRect",{get:function(){return this.ctx.ignoreClearRect},set:function(K){this.ctx.ignoreClearRect=!!K}})};f.prototype.setLineDash=function(O){this.lineDash=O},f.prototype.getLineDash=function(){return this.lineDash.length%2?this.lineDash.concat(this.lineDash):this.lineDash.slice()},f.prototype.fill=function(){_.call(this,"fill",!1)},f.prototype.stroke=function(){_.call(this,"stroke",!1)},f.prototype.beginPath=function(){this.path=[{type:"begin"}]},f.prototype.moveTo=function(O,V){if(isNaN(O)||isNaN(V))throw ni.error("jsPDF.context2d.moveTo: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.moveTo");var G=this.ctx.transform.applyToPoint(new a(O,V));this.path.push({type:"mt",x:G.x,y:G.y}),this.ctx.lastPoint=new a(O,V)},f.prototype.closePath=function(){var O=new a(0,0),V=0;for(V=this.path.length-1;V!==-1;V--)if(this.path[V].type==="begin"&&Un(this.path[V+1])==="object"&&typeof this.path[V+1].x=="number"){O=new a(this.path[V+1].x,this.path[V+1].y);break}this.path.push({type:"close"}),this.ctx.lastPoint=new a(O.x,O.y)},f.prototype.lineTo=function(O,V){if(isNaN(O)||isNaN(V))throw ni.error("jsPDF.context2d.lineTo: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.lineTo");var G=this.ctx.transform.applyToPoint(new a(O,V));this.path.push({type:"lt",x:G.x,y:G.y}),this.ctx.lastPoint=new a(G.x,G.y)},f.prototype.clip=function(){this.ctx.clip_path=JSON.parse(JSON.stringify(this.path)),_.call(this,null,!0)},f.prototype.quadraticCurveTo=function(O,V,G,re){if(isNaN(G)||isNaN(re)||isNaN(O)||isNaN(V))throw ni.error("jsPDF.context2d.quadraticCurveTo: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.quadraticCurveTo");var ae=this.ctx.transform.applyToPoint(new a(G,re)),ee=this.ctx.transform.applyToPoint(new a(O,V));this.path.push({type:"qct",x1:ee.x,y1:ee.y,x:ae.x,y:ae.y}),this.ctx.lastPoint=new a(ae.x,ae.y)},f.prototype.bezierCurveTo=function(O,V,G,re,ae,ee){if(isNaN(ae)||isNaN(ee)||isNaN(O)||isNaN(V)||isNaN(G)||isNaN(re))throw ni.error("jsPDF.context2d.bezierCurveTo: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.bezierCurveTo");var de=this.ctx.transform.applyToPoint(new a(ae,ee)),he=this.ctx.transform.applyToPoint(new a(O,V)),pe=this.ctx.transform.applyToPoint(new a(G,re));this.path.push({type:"bct",x1:he.x,y1:he.y,x2:pe.x,y2:pe.y,x:de.x,y:de.y}),this.ctx.lastPoint=new a(de.x,de.y)},f.prototype.arc=function(O,V,G,re,ae,ee){if(isNaN(O)||isNaN(V)||isNaN(G)||isNaN(re)||isNaN(ae))throw ni.error("jsPDF.context2d.arc: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.arc");if(ee=!!ee,!this.ctx.transform.isIdentity){var de=this.ctx.transform.applyToPoint(new a(O,V));O=de.x,V=de.y;var he=this.ctx.transform.applyToPoint(new a(0,G)),pe=this.ctx.transform.applyToPoint(new a(0,0));G=Math.sqrt(Math.pow(he.x-pe.x,2)+Math.pow(he.y-pe.y,2))}Math.abs(ae-re)>=2*Math.PI&&(re=0,ae=2*Math.PI),this.path.push({type:"arc",x:O,y:V,radius:G,startAngle:re,endAngle:ae,counterclockwise:ee})},f.prototype.arcTo=function(O,V,G,re,ae){throw new Error("arcTo not implemented.")},f.prototype.rect=function(O,V,G,re){if(isNaN(O)||isNaN(V)||isNaN(G)||isNaN(re))throw ni.error("jsPDF.context2d.rect: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.rect");this.moveTo(O,V),this.lineTo(O+G,V),this.lineTo(O+G,V+re),this.lineTo(O,V+re),this.lineTo(O,V),this.lineTo(O+G,V),this.lineTo(O,V)},f.prototype.fillRect=function(O,V,G,re){if(isNaN(O)||isNaN(V)||isNaN(G)||isNaN(re))throw ni.error("jsPDF.context2d.fillRect: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.fillRect");if(!d.call(this)){var ae={};this.lineCap!=="butt"&&(ae.lineCap=this.lineCap,this.lineCap="butt"),this.lineJoin!=="miter"&&(ae.lineJoin=this.lineJoin,this.lineJoin="miter"),this.beginPath(),this.rect(O,V,G,re),this.fill(),ae.hasOwnProperty("lineCap")&&(this.lineCap=ae.lineCap),ae.hasOwnProperty("lineJoin")&&(this.lineJoin=ae.lineJoin)}},f.prototype.strokeRect=function(O,V,G,re){if(isNaN(O)||isNaN(V)||isNaN(G)||isNaN(re))throw ni.error("jsPDF.context2d.strokeRect: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.strokeRect");y.call(this)||(this.beginPath(),this.rect(O,V,G,re),this.stroke())},f.prototype.clearRect=function(O,V,G,re){if(isNaN(O)||isNaN(V)||isNaN(G)||isNaN(re))throw ni.error("jsPDF.context2d.clearRect: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.clearRect");this.ignoreClearRect||(this.fillStyle="#ffffff",this.fillRect(O,V,G,re))},f.prototype.save=function(O){O=typeof O!="boolean"||O;for(var V=this.pdf.internal.getCurrentPageInfo().pageNumber,G=0;G<this.pdf.internal.getNumberOfPages();G++)this.pdf.setPage(G+1),this.pdf.internal.out("q");if(this.pdf.setPage(V),O){this.ctx.fontSize=this.pdf.internal.getFontSize();var re=new u(this.ctx);this.ctxStack.push(this.ctx),this.ctx=re}},f.prototype.restore=function(O){O=typeof O!="boolean"||O;for(var V=this.pdf.internal.getCurrentPageInfo().pageNumber,G=0;G<this.pdf.internal.getNumberOfPages();G++)this.pdf.setPage(G+1),this.pdf.internal.out("Q");this.pdf.setPage(V),O&&this.ctxStack.length!==0&&(this.ctx=this.ctxStack.pop(),this.fillStyle=this.ctx.fillStyle,this.strokeStyle=this.ctx.strokeStyle,this.font=this.ctx.font,this.lineCap=this.ctx.lineCap,this.lineWidth=this.ctx.lineWidth,this.lineJoin=this.ctx.lineJoin,this.lineDash=this.ctx.lineDash,this.lineDashOffset=this.ctx.lineDashOffset)},f.prototype.toDataURL=function(){throw new Error("toDataUrl not implemented.")};var p=function(O){var V,G,re,ae;if(O.isCanvasGradient===!0&&(O=O.getColor()),!O)return{r:0,g:0,b:0,a:0,style:O};if(/transparent|rgba\s*\(\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*,\s*0+\s*\)/.test(O))V=0,G=0,re=0,ae=0;else{var ee=/rgb\s*\(\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*\)/.exec(O);if(ee!==null)V=parseInt(ee[1]),G=parseInt(ee[2]),re=parseInt(ee[3]),ae=1;else if((ee=/rgba\s*\(\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*,\s*([\d.]+)\s*\)/.exec(O))!==null)V=parseInt(ee[1]),G=parseInt(ee[2]),re=parseInt(ee[3]),ae=parseFloat(ee[4]);else{if(ae=1,typeof O=="string"&&O.charAt(0)!=="#"){var de=new n_(O);O=de.ok?de.toHex():"#000000"}O.length===4?(V=O.substring(1,2),V+=V,G=O.substring(2,3),G+=G,re=O.substring(3,4),re+=re):(V=O.substring(1,3),G=O.substring(3,5),re=O.substring(5,7)),V=parseInt(V,16),G=parseInt(G,16),re=parseInt(re,16)}}return{r:V,g:G,b:re,a:ae,style:O}},d=function(){return this.ctx.isFillTransparent||this.globalAlpha==0},y=function(){return!!(this.ctx.isStrokeTransparent||this.globalAlpha==0)};f.prototype.fillText=function(O,V,G,re){if(isNaN(V)||isNaN(G)||typeof O!="string")throw ni.error("jsPDF.context2d.fillText: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.fillText");if(re=isNaN(re)?void 0:re,!d.call(this)){var ae=W(this.ctx.transform.rotation),ee=this.ctx.transform.scaleX;N.call(this,{text:O,x:V,y:G,scale:ee,angle:ae,align:this.textAlign,maxWidth:re})}},f.prototype.strokeText=function(O,V,G,re){if(isNaN(V)||isNaN(G)||typeof O!="string")throw ni.error("jsPDF.context2d.strokeText: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.strokeText");if(!y.call(this)){re=isNaN(re)?void 0:re;var ae=W(this.ctx.transform.rotation),ee=this.ctx.transform.scaleX;N.call(this,{text:O,x:V,y:G,scale:ee,renderingMode:"stroke",angle:ae,align:this.textAlign,maxWidth:re})}},f.prototype.measureText=function(O){if(typeof O!="string")throw ni.error("jsPDF.context2d.measureText: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.measureText");var V=this.pdf,G=this.pdf.internal.scaleFactor,re=V.internal.getFontSize(),ae=V.getStringUnitWidth(O)*re/V.internal.scaleFactor;return new function(ee){var de=(ee=ee||{}).width||0;return Object.defineProperty(this,"width",{get:function(){return de}}),this}({width:ae*=Math.round(96*G/72*1e4)/1e4})},f.prototype.scale=function(O,V){if(isNaN(O)||isNaN(V))throw ni.error("jsPDF.context2d.scale: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.scale");var G=new l(O,0,0,V,0,0);this.ctx.transform=this.ctx.transform.multiply(G)},f.prototype.rotate=function(O){if(isNaN(O))throw ni.error("jsPDF.context2d.rotate: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.rotate");var V=new l(Math.cos(O),Math.sin(O),-Math.sin(O),Math.cos(O),0,0);this.ctx.transform=this.ctx.transform.multiply(V)},f.prototype.translate=function(O,V){if(isNaN(O)||isNaN(V))throw ni.error("jsPDF.context2d.translate: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.translate");var G=new l(1,0,0,1,O,V);this.ctx.transform=this.ctx.transform.multiply(G)},f.prototype.transform=function(O,V,G,re,ae,ee){if(isNaN(O)||isNaN(V)||isNaN(G)||isNaN(re)||isNaN(ae)||isNaN(ee))throw ni.error("jsPDF.context2d.transform: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.transform");var de=new l(O,V,G,re,ae,ee);this.ctx.transform=this.ctx.transform.multiply(de)},f.prototype.setTransform=function(O,V,G,re,ae,ee){O=isNaN(O)?1:O,V=isNaN(V)?0:V,G=isNaN(G)?0:G,re=isNaN(re)?1:re,ae=isNaN(ae)?0:ae,ee=isNaN(ee)?0:ee,this.ctx.transform=new l(O,V,G,re,ae,ee)};var m=function(){return this.margin[0]>0||this.margin[1]>0||this.margin[2]>0||this.margin[3]>0};f.prototype.drawImage=function(O,V,G,re,ae,ee,de,he,pe){var ge=this.pdf.getImageProperties(O),Ee=1,Ae=1,Ye=1,K=1;re!==void 0&&he!==void 0&&(Ye=he/re,K=pe/ae,Ee=ge.width/re*he/re,Ae=ge.height/ae*pe/ae),ee===void 0&&(ee=V,de=G,V=0,G=0),re!==void 0&&he===void 0&&(he=re,pe=ae),re===void 0&&he===void 0&&(he=ge.width,pe=ge.height);var Re=this.ctx.transform.decompose(),Qe=W(Re.rotate.shx),Be=new l,Ie=(Be=(Be=(Be=Be.multiply(Re.translate)).multiply(Re.skew)).multiply(Re.scale)).applyToRectangle(new o(ee-V*Ye,de-G*K,re*Ee,ae*Ae));if(this.autoPaging){for(var lt,We=w.call(this,Ie),Ke=[],ht=0;ht<We.length;ht+=1)Ke.indexOf(We[ht])===-1&&Ke.push(We[ht]);A(Ke);for(var Rt=Ke[0],ye=Ke[Ke.length-1],qe=Rt;qe<ye+1;qe++){this.pdf.setPage(qe);var ve=this.pdf.internal.pageSize.width-this.margin[3]-this.margin[1],Pe=qe===1?this.posY+this.margin[0]:this.margin[0],Le=this.pdf.internal.pageSize.height-this.posY-this.margin[0]-this.margin[2],it=this.pdf.internal.pageSize.height-this.margin[0]-this.margin[2],nt=qe===1?0:Le+(qe-2)*it;if(this.ctx.clip_path.length!==0){var _t=this.path;lt=JSON.parse(JSON.stringify(this.ctx.clip_path)),this.path=S(lt,this.posX+this.margin[3],-nt+Pe+this.ctx.prevPageLastElemOffset),I.call(this,"fill",!0),this.path=_t}var At=JSON.parse(JSON.stringify(Ie));At=S([At],this.posX+this.margin[3],-nt+Pe+this.ctx.prevPageLastElemOffset)[0];var St=(qe>Rt||qe<ye)&&m.call(this);St&&(this.pdf.saveGraphicsState(),this.pdf.rect(this.margin[3],this.margin[0],ve,it,null).clip().discardPath()),this.pdf.addImage(O,"JPEG",At.x,At.y,At.w,At.h,null,null,Qe),St&&this.pdf.restoreGraphicsState()}}else this.pdf.addImage(O,"JPEG",Ie.x,Ie.y,Ie.w,Ie.h,null,null,Qe)};var w=function(O,V,G){var re=[];V=V||this.pdf.internal.pageSize.width,G=G||this.pdf.internal.pageSize.height-this.margin[0]-this.margin[2];var ae=this.posY+this.ctx.prevPageLastElemOffset;switch(O.type){default:case"mt":case"lt":re.push(Math.floor((O.y+ae)/G)+1);break;case"arc":re.push(Math.floor((O.y+ae-O.radius)/G)+1),re.push(Math.floor((O.y+ae+O.radius)/G)+1);break;case"qct":var ee=Y(this.ctx.lastPoint.x,this.ctx.lastPoint.y,O.x1,O.y1,O.x,O.y);re.push(Math.floor((ee.y+ae)/G)+1),re.push(Math.floor((ee.y+ee.h+ae)/G)+1);break;case"bct":var de=ue(this.ctx.lastPoint.x,this.ctx.lastPoint.y,O.x1,O.y1,O.x2,O.y2,O.x,O.y);re.push(Math.floor((de.y+ae)/G)+1),re.push(Math.floor((de.y+de.h+ae)/G)+1);break;case"rect":re.push(Math.floor((O.y+ae)/G)+1),re.push(Math.floor((O.y+O.h+ae)/G)+1)}for(var he=0;he<re.length;he+=1)for(;this.pdf.internal.getNumberOfPages()<re[he];)b.call(this);return re},b=function(){var O=this.fillStyle,V=this.strokeStyle,G=this.font,re=this.lineCap,ae=this.lineWidth,ee=this.lineJoin;this.pdf.addPage(),this.fillStyle=O,this.strokeStyle=V,this.font=G,this.lineCap=re,this.lineWidth=ae,this.lineJoin=ee},S=function(O,V,G){for(var re=0;re<O.length;re++)switch(O[re].type){case"bct":O[re].x2+=V,O[re].y2+=G;case"qct":O[re].x1+=V,O[re].y1+=G;default:O[re].x+=V,O[re].y+=G}return O},A=function(O){return O.sort(function(V,G){return V-G})},_=function(O,V){var G=this.fillStyle,re=this.strokeStyle,ae=this.lineCap,ee=this.lineWidth,de=Math.abs(ee*this.ctx.transform.scaleX),he=this.lineJoin;if(this.autoPaging){for(var pe,ge,Ee=JSON.parse(JSON.stringify(this.path)),Ae=JSON.parse(JSON.stringify(this.path)),Ye=[],K=0;K<Ae.length;K++)if(Ae[K].x!==void 0)for(var Re=w.call(this,Ae[K]),Qe=0;Qe<Re.length;Qe+=1)Ye.indexOf(Re[Qe])===-1&&Ye.push(Re[Qe]);for(var Be=0;Be<Ye.length;Be++)for(;this.pdf.internal.getNumberOfPages()<Ye[Be];)b.call(this);A(Ye);for(var Ie=Ye[0],lt=Ye[Ye.length-1],We=Ie;We<lt+1;We++){this.pdf.setPage(We),this.fillStyle=G,this.strokeStyle=re,this.lineCap=ae,this.lineWidth=de,this.lineJoin=he;var Ke=this.pdf.internal.pageSize.width-this.margin[3]-this.margin[1],ht=We===1?this.posY+this.margin[0]:this.margin[0],Rt=this.pdf.internal.pageSize.height-this.posY-this.margin[0]-this.margin[2],ye=this.pdf.internal.pageSize.height-this.margin[0]-this.margin[2],qe=We===1?0:Rt+(We-2)*ye;if(this.ctx.clip_path.length!==0){var ve=this.path;pe=JSON.parse(JSON.stringify(this.ctx.clip_path)),this.path=S(pe,this.posX+this.margin[3],-qe+ht+this.ctx.prevPageLastElemOffset),I.call(this,O,!0),this.path=ve}if(ge=JSON.parse(JSON.stringify(Ee)),this.path=S(ge,this.posX+this.margin[3],-qe+ht+this.ctx.prevPageLastElemOffset),V===!1||We===0){var Pe=(We>Ie||We<lt)&&m.call(this);Pe&&(this.pdf.saveGraphicsState(),this.pdf.rect(this.margin[3],this.margin[0],Ke,ye,null).clip().discardPath()),I.call(this,O,V),Pe&&this.pdf.restoreGraphicsState()}this.lineWidth=ee}this.path=Ee}else this.lineWidth=de,I.call(this,O,V),this.lineWidth=ee},I=function(O,V){if((O!=="stroke"||V||!y.call(this))&&(O==="stroke"||V||!d.call(this))){for(var G,re,ae=[],ee=this.path,de=0;de<ee.length;de++){var he=ee[de];switch(he.type){case"begin":ae.push({begin:!0});break;case"close":ae.push({close:!0});break;case"mt":ae.push({start:he,deltas:[],abs:[]});break;case"lt":var pe=ae.length;if(ee[de-1]&&!isNaN(ee[de-1].x)&&(G=[he.x-ee[de-1].x,he.y-ee[de-1].y],pe>0)){for(;pe>=0;pe--)if(ae[pe-1].close!==!0&&ae[pe-1].begin!==!0){ae[pe-1].deltas.push(G),ae[pe-1].abs.push(he);break}}break;case"bct":G=[he.x1-ee[de-1].x,he.y1-ee[de-1].y,he.x2-ee[de-1].x,he.y2-ee[de-1].y,he.x-ee[de-1].x,he.y-ee[de-1].y],ae[ae.length-1].deltas.push(G);break;case"qct":var ge=ee[de-1].x+2/3*(he.x1-ee[de-1].x),Ee=ee[de-1].y+2/3*(he.y1-ee[de-1].y),Ae=he.x+2/3*(he.x1-he.x),Ye=he.y+2/3*(he.y1-he.y),K=he.x,Re=he.y;G=[ge-ee[de-1].x,Ee-ee[de-1].y,Ae-ee[de-1].x,Ye-ee[de-1].y,K-ee[de-1].x,Re-ee[de-1].y],ae[ae.length-1].deltas.push(G);break;case"arc":ae.push({deltas:[],abs:[],arc:!0}),Array.isArray(ae[ae.length-1].abs)&&ae[ae.length-1].abs.push(he)}}re=V?null:O==="stroke"?"stroke":"fill";for(var Qe=!1,Be=0;Be<ae.length;Be++)if(ae[Be].arc)for(var Ie=ae[Be].abs,lt=0;lt<Ie.length;lt++){var We=Ie[lt];We.type==="arc"?T.call(this,We.x,We.y,We.radius,We.startAngle,We.endAngle,We.counterclockwise,void 0,V,!Qe):B.call(this,We.x,We.y),Qe=!0}else if(ae[Be].close===!0)this.pdf.internal.out("h"),Qe=!1;else if(ae[Be].begin!==!0){var Ke=ae[Be].start.x,ht=ae[Be].start.y;P.call(this,ae[Be].deltas,Ke,ht),Qe=!0}re&&D.call(this,re),V&&U.call(this)}},E=function(O){var V=this.pdf.internal.getFontSize()/this.pdf.internal.scaleFactor,G=V*(this.pdf.internal.getLineHeightFactor()-1);switch(this.ctx.textBaseline){case"bottom":return O-G;case"top":return O+V-G;case"hanging":return O+V-2*G;case"middle":return O+V/2-G;default:return O}},M=function(O){return O+this.pdf.internal.getFontSize()/this.pdf.internal.scaleFactor*(this.pdf.internal.getLineHeightFactor()-1)};f.prototype.createLinearGradient=function(){var O=function(){};return O.colorStops=[],O.addColorStop=function(V,G){this.colorStops.push([V,G])},O.getColor=function(){return this.colorStops.length===0?"#000000":this.colorStops[0][1]},O.isCanvasGradient=!0,O},f.prototype.createPattern=function(){return this.createLinearGradient()},f.prototype.createRadialGradient=function(){return this.createLinearGradient()};var T=function(O,V,G,re,ae,ee,de,he,pe){for(var ge=q.call(this,G,re,ae,ee),Ee=0;Ee<ge.length;Ee++){var Ae=ge[Ee];Ee===0&&(pe?C.call(this,Ae.x1+O,Ae.y1+V):B.call(this,Ae.x1+O,Ae.y1+V)),F.call(this,O,V,Ae.x2,Ae.y2,Ae.x3,Ae.y3,Ae.x4,Ae.y4)}he?U.call(this):D.call(this,de)},D=function(O){switch(O){case"stroke":this.pdf.internal.out("S");break;case"fill":this.pdf.internal.out("f")}},U=function(){this.pdf.clip(),this.pdf.discardPath()},C=function(O,V){this.pdf.internal.out(n(O)+" "+i(V)+" m")},N=function(O){var V;switch(O.align){case"right":case"end":V="right";break;case"center":V="center";break;default:V="left"}var G,re,ae,ee=this.pdf.getTextDimensions(O.text),de=E.call(this,O.y),he=M.call(this,de)-ee.h,pe=this.ctx.transform.applyToPoint(new a(O.x,de));if(this.autoPaging){var ge=this.ctx.transform.decompose(),Ee=new l;Ee=(Ee=(Ee=Ee.multiply(ge.translate)).multiply(ge.skew)).multiply(ge.scale);for(var Ae=this.ctx.transform.applyToRectangle(new o(O.x,de,ee.w,ee.h)),Ye=Ee.applyToRectangle(new o(O.x,he,ee.w,ee.h)),K=w.call(this,Ye),Re=[],Qe=0;Qe<K.length;Qe+=1)Re.indexOf(K[Qe])===-1&&Re.push(K[Qe]);A(Re);for(var Be=Re[0],Ie=Re[Re.length-1],lt=Be;lt<Ie+1;lt++){this.pdf.setPage(lt);var We=lt===1?this.posY+this.margin[0]:this.margin[0],Ke=this.pdf.internal.pageSize.height-this.posY-this.margin[0]-this.margin[2],ht=this.pdf.internal.pageSize.height-this.margin[2],Rt=ht-this.margin[0],ye=this.pdf.internal.pageSize.width-this.margin[1],qe=ye-this.margin[3],ve=lt===1?0:Ke+(lt-2)*Rt;if(this.ctx.clip_path.length!==0){var Pe=this.path;G=JSON.parse(JSON.stringify(this.ctx.clip_path)),this.path=S(G,this.posX+this.margin[3],-1*ve+We),I.call(this,"fill",!0),this.path=Pe}var Le=S([JSON.parse(JSON.stringify(Ye))],this.posX+this.margin[3],-ve+We+this.ctx.prevPageLastElemOffset)[0];O.scale>=.01&&(re=this.pdf.internal.getFontSize(),this.pdf.setFontSize(re*O.scale),ae=this.lineWidth,this.lineWidth=ae*O.scale);var it=this.autoPaging!=="text";if(it||Le.y+Le.h<=ht){if(it||Le.y>=We&&Le.x<=ye){var nt=it?O.text:this.pdf.splitTextToSize(O.text,O.maxWidth||ye-Le.x)[0],_t=S([JSON.parse(JSON.stringify(Ae))],this.posX+this.margin[3],-ve+We+this.ctx.prevPageLastElemOffset)[0],At=it&&(lt>Be||lt<Ie)&&m.call(this);At&&(this.pdf.saveGraphicsState(),this.pdf.rect(this.margin[3],this.margin[0],qe,Rt,null).clip().discardPath()),this.pdf.text(nt,_t.x,_t.y,{angle:O.angle,align:V,renderingMode:O.renderingMode}),At&&this.pdf.restoreGraphicsState()}}else Le.y<ht&&(this.ctx.prevPageLastElemOffset+=ht-Le.y);O.scale>=.01&&(this.pdf.setFontSize(re),this.lineWidth=ae)}}else O.scale>=.01&&(re=this.pdf.internal.getFontSize(),this.pdf.setFontSize(re*O.scale),ae=this.lineWidth,this.lineWidth=ae*O.scale),this.pdf.text(O.text,pe.x+this.posX,pe.y+this.posY,{angle:O.angle,align:V,renderingMode:O.renderingMode,maxWidth:O.maxWidth}),O.scale>=.01&&(this.pdf.setFontSize(re),this.lineWidth=ae)},B=function(O,V,G,re){G=G||0,re=re||0,this.pdf.internal.out(n(O+G)+" "+i(V+re)+" l")},P=function(O,V,G){return this.pdf.lines(O,V,G,null,null)},F=function(O,V,G,re,ae,ee,de,he){this.pdf.internal.out([e(r(G+O)),e(s(re+V)),e(r(ae+O)),e(s(ee+V)),e(r(de+O)),e(s(he+V)),"c"].join(" "))},q=function(O,V,G,re){for(var ae=2*Math.PI,ee=Math.PI/2;V>G;)V-=ae;var de=Math.abs(G-V);de<ae&&re&&(de=ae-de);for(var he=[],pe=re?-1:1,ge=V;de>1e-5;){var Ee=ge+pe*Math.min(de,ee);he.push(Z.call(this,O,ge,Ee)),de-=Math.abs(Ee-ge),ge=Ee}return he},Z=function(O,V,G){var re=(G-V)/2,ae=O*Math.cos(re),ee=O*Math.sin(re),de=ae,he=-ee,pe=de*de+he*he,ge=pe+de*ae+he*ee,Ee=4/3*(Math.sqrt(2*pe*ge)-ge)/(de*ee-he*ae),Ae=de-Ee*he,Ye=he+Ee*de,K=Ae,Re=-Ye,Qe=re+V,Be=Math.cos(Qe),Ie=Math.sin(Qe);return{x1:O*Math.cos(V),y1:O*Math.sin(V),x2:Ae*Be-Ye*Ie,y2:Ae*Ie+Ye*Be,x3:K*Be-Re*Ie,y3:K*Ie+Re*Be,x4:O*Math.cos(G),y4:O*Math.sin(G)}},W=function(O){return 180*O/Math.PI},Y=function(O,V,G,re,ae,ee){var de=O+.5*(G-O),he=V+.5*(re-V),pe=ae+.5*(G-ae),ge=ee+.5*(re-ee),Ee=Math.min(O,ae,de,pe),Ae=Math.max(O,ae,de,pe),Ye=Math.min(V,ee,he,ge),K=Math.max(V,ee,he,ge);return new o(Ee,Ye,Ae-Ee,K-Ye)},ue=function(O,V,G,re,ae,ee,de,he){var pe,ge,Ee,Ae,Ye,K,Re,Qe,Be,Ie,lt,We,Ke,ht,Rt=G-O,ye=re-V,qe=ae-G,ve=ee-re,Pe=de-ae,Le=he-ee;for(ge=0;ge<41;ge++)Be=(Re=(Ee=O+(pe=ge/40)*Rt)+pe*((Ye=G+pe*qe)-Ee))+pe*(Ye+pe*(ae+pe*Pe-Ye)-Re),Ie=(Qe=(Ae=V+pe*ye)+pe*((K=re+pe*ve)-Ae))+pe*(K+pe*(ee+pe*Le-K)-Qe),ge==0?(lt=Be,We=Ie,Ke=Be,ht=Ie):(lt=Math.min(lt,Be),We=Math.min(We,Ie),Ke=Math.max(Ke,Be),ht=Math.max(ht,Ie));return new o(Math.round(lt),Math.round(We),Math.round(Ke-lt),Math.round(ht-We))},le=function(){if(this.prevLineDash||this.ctx.lineDash.length||this.ctx.lineDashOffset){var O,V,G=(O=this.ctx.lineDash,V=this.ctx.lineDashOffset,JSON.stringify({lineDash:O,lineDashOffset:V}));this.prevLineDash!==G&&(this.pdf.setLineDash(this.ctx.lineDash,this.ctx.lineDashOffset),this.prevLineDash=G)}}})(Ut.API),(function(t){var e=function(a){var o,l,c,u,f,p,d,y,m,w;for(l=[],c=0,u=(a+=o="\0\0\0\0".slice(a.length%4||4)).length;u>c;c+=4)(f=(a.charCodeAt(c)<<24)+(a.charCodeAt(c+1)<<16)+(a.charCodeAt(c+2)<<8)+a.charCodeAt(c+3))!==0?(p=(f=((f=((f=((f=(f-(w=f%85))/85)-(m=f%85))/85)-(y=f%85))/85)-(d=f%85))/85)%85,l.push(p+33,d+33,y+33,m+33,w+33)):l.push(122);return(function(b,S){for(var A=S;A>0;A--)b.pop()})(l,o.length),String.fromCharCode.apply(String,l)+"~>"},n=function(a){var o,l,c,u,f,p=String,d="length",y=255,m="charCodeAt",w="slice",b="replace";for(a[w](-2),a=a[w](0,-2)[b](/\s/g,"")[b]("z","!!!!!"),c=[],u=0,f=(a+=o="uuuuu"[w](a[d]%5||5))[d];f>u;u+=5)l=52200625*(a[m](u)-33)+614125*(a[m](u+1)-33)+7225*(a[m](u+2)-33)+85*(a[m](u+3)-33)+(a[m](u+4)-33),c.push(y&l>>24,y&l>>16,y&l>>8,y&l);return(function(S,A){for(var _=A;_>0;_--)S.pop()})(c,o[d]),p.fromCharCode.apply(p,c)},i=function(a){return a.split("").map(function(o){return("0"+o.charCodeAt().toString(16)).slice(-2)}).join("")+">"},r=function(a){var o=new RegExp(/^([0-9A-Fa-f]{2})+$/);if((a=a.replace(/\s/g,"")).indexOf(">")!==-1&&(a=a.substr(0,a.indexOf(">"))),a.length%2&&(a+="0"),o.test(a)===!1)return"";for(var l="",c=0;c<a.length;c+=2)l+=String.fromCharCode("0x"+(a[c]+a[c+1]));return l},s=function(a){for(var o=new Uint8Array(a.length),l=a.length;l--;)o[l]=a.charCodeAt(l);return(o=n1(o)).reduce(function(c,u){return c+String.fromCharCode(u)},"")};t.processDataByFilters=function(a,o){var l=0,c=a||"",u=[];for(typeof(o=o||[])=="string"&&(o=[o]),l=0;l<o.length;l+=1)switch(o[l]){case"ASCII85Decode":case"/ASCII85Decode":c=n(c),u.push("/ASCII85Encode");break;case"ASCII85Encode":case"/ASCII85Encode":c=e(c),u.push("/ASCII85Decode");break;case"ASCIIHexDecode":case"/ASCIIHexDecode":c=r(c),u.push("/ASCIIHexEncode");break;case"ASCIIHexEncode":case"/ASCIIHexEncode":c=i(c),u.push("/ASCIIHexDecode");break;case"FlateEncode":case"/FlateEncode":c=s(c),u.push("/FlateDecode");break;default:throw new Error('The filter: "'+o[l]+'" is not implemented')}return{data:c,reverseChain:u.reverse().join(" ")}}})(Ut.API),(function(t){t.loadFile=function(e,n,i){return(function(r,s,a){s=s!==!1,a=typeof a=="function"?a:function(){};var o=void 0;try{o=(function(l,c,u){var f=new XMLHttpRequest,p=0,d=function(y){var m=y.length,w=[],b=String.fromCharCode;for(p=0;p<m;p+=1)w.push(b(255&y.charCodeAt(p)));return w.join("")};if(f.open("GET",l,!c),f.overrideMimeType("text/plain; charset=x-user-defined"),c===!1&&(f.onload=function(){f.status===200?u(d(this.responseText)):u(void 0)}),f.send(null),c&&f.status===200)return d(f.responseText)})(r,s,a)}catch{}return o})(e,n,i)},t.allowFsRead=void 0,t.loadImageFile=t.loadFile})(Ut.API),(function(t){function e(){return(an.html2canvas?Promise.resolve(an.html2canvas):hs(()=>import("./DXEQVQnt.js"),[],import.meta.url)).catch(function(o){return Promise.reject(new Error("Could not load html2canvas: "+o))}).then(function(o){return o.default?o.default:o})}function n(){return(an.DOMPurify?Promise.resolve(an.DOMPurify):hs(()=>import("./Bzr520pe.js"),[],import.meta.url)).catch(function(o){return Promise.reject(new Error("Could not load dompurify: "+o))}).then(function(o){return o.default?o.default:o})}var i=function(o){var l=Un(o);return l==="undefined"?"undefined":l==="string"||o instanceof String?"string":l==="number"||o instanceof Number?"number":l==="function"||o instanceof Function?"function":o&&o.constructor===Array?"array":o&&o.nodeType===1?"element":l==="object"?"object":"unknown"},r=function(o,l){var c=document.createElement(o);for(var u in l.className&&(c.className=l.className),l.innerHTML&&l.dompurify&&(c.innerHTML=l.dompurify.sanitize(l.innerHTML)),l.style)c.style[u]=l.style[u];return c},s=function o(l,c){for(var u=l.nodeType===3?document.createTextNode(l.nodeValue):l.cloneNode(!1),f=l.firstChild;f;f=f.nextSibling)c!==!0&&f.nodeType===1&&f.nodeName==="SCRIPT"||u.appendChild(o(f,c));return l.nodeType===1&&(l.nodeName==="CANVAS"?(u.width=l.width,u.height=l.height,u.getContext("2d").drawImage(l,0,0)):l.nodeName!=="TEXTAREA"&&l.nodeName!=="SELECT"||(u.value=l.value),u.addEventListener("load",function(){u.scrollTop=l.scrollTop,u.scrollLeft=l.scrollLeft},!0)),u},a=function o(l){var c=Object.assign(o.convert(Promise.resolve()),JSON.parse(JSON.stringify(o.template))),u=o.convert(Promise.resolve(),c);return(u=u.setProgress(1,o,1,[o])).set(l)};(a.prototype=Object.create(Promise.prototype)).constructor=a,a.convert=function(o,l){return o.__proto__=l||a.prototype,o},a.template={prop:{src:null,container:null,overlay:null,canvas:null,img:null,pdf:null,pageSize:null,callback:function(){}},progress:{val:0,state:null,n:0,stack:[]},opt:{filename:"file.pdf",margin:[0,0,0,0],enableLinks:!0,x:0,y:0,html2canvas:{},jsPDF:{},backgroundColor:"transparent"}},a.prototype.from=function(o,l){return this.then(function(){switch(l=l||(function(c){switch(i(c)){case"string":return"string";case"element":return c.nodeName.toLowerCase()==="canvas"?"canvas":"element";default:return"unknown"}})(o),l){case"string":return this.then(n).then(function(c){return this.set({src:r("div",{innerHTML:o,dompurify:c})})});case"element":return this.set({src:o});case"canvas":return this.set({canvas:o});case"img":return this.set({img:o});default:return this.error("Unknown source type.")}})},a.prototype.to=function(o){switch(o){case"container":return this.toContainer();case"canvas":return this.toCanvas();case"img":return this.toImg();case"pdf":return this.toPdf();default:return this.error("Invalid target.")}},a.prototype.toContainer=function(){return this.thenList([function(){return this.prop.src||this.error("Cannot duplicate - no source HTML.")},function(){return this.prop.pageSize||this.setPageSize()}]).then(function(){var o={position:"relative",display:"inline-block",width:(typeof this.opt.width!="number"||isNaN(this.opt.width)||typeof this.opt.windowWidth!="number"||isNaN(this.opt.windowWidth)?Math.max(this.prop.src.clientWidth,this.prop.src.scrollWidth,this.prop.src.offsetWidth):this.opt.windowWidth)+"px",left:0,right:0,top:0,margin:"auto",backgroundColor:this.opt.backgroundColor},l=s(this.prop.src,this.opt.html2canvas.javascriptEnabled);l.tagName==="BODY"&&(o.height=Math.max(document.body.scrollHeight,document.body.offsetHeight,document.documentElement.clientHeight,document.documentElement.scrollHeight,document.documentElement.offsetHeight)+"px"),this.prop.overlay=r("div",{className:"html2pdf__overlay",style:{position:"fixed",overflow:"hidden",zIndex:1e3,left:"-100000px",right:0,bottom:0,top:0}}),this.prop.container=r("div",{className:"html2pdf__container",style:o}),this.prop.container.appendChild(l),this.prop.container.firstChild.appendChild(r("div",{style:{clear:"both",border:"0 none transparent",margin:0,padding:0,height:0}})),this.prop.container.style.float="none",this.prop.overlay.appendChild(this.prop.container),document.body.appendChild(this.prop.overlay),this.prop.container.firstChild.style.position="relative",this.prop.container.height=Math.max(this.prop.container.firstChild.clientHeight,this.prop.container.firstChild.scrollHeight,this.prop.container.firstChild.offsetHeight)+"px"})},a.prototype.toCanvas=function(){var o=[function(){return document.body.contains(this.prop.container)||this.toContainer()}];return this.thenList(o).then(e).then(function(l){var c=Object.assign({},this.opt.html2canvas);return delete c.onrendered,l(this.prop.container,c)}).then(function(l){(this.opt.html2canvas.onrendered||function(){})(l),this.prop.canvas=l,document.body.removeChild(this.prop.overlay)})},a.prototype.toContext2d=function(){var o=[function(){return document.body.contains(this.prop.container)||this.toContainer()}];return this.thenList(o).then(e).then(function(l){var c=this.opt.jsPDF,u=this.opt.fontFaces,f=typeof this.opt.width!="number"||isNaN(this.opt.width)||typeof this.opt.windowWidth!="number"||isNaN(this.opt.windowWidth)?1:this.opt.width/this.opt.windowWidth,p=Object.assign({async:!0,allowTaint:!0,scale:f,scrollX:this.opt.scrollX||0,scrollY:this.opt.scrollY||0,backgroundColor:"#ffffff",imageTimeout:15e3,logging:!0,proxy:null,removeContainer:!0,foreignObjectRendering:!1,useCORS:!1},this.opt.html2canvas);if(delete p.onrendered,c.context2d.autoPaging=this.opt.autoPaging===void 0||this.opt.autoPaging,c.context2d.posX=this.opt.x,c.context2d.posY=this.opt.y,c.context2d.margin=this.opt.margin,c.context2d.fontFaces=u,u)for(var d=0;d<u.length;++d){var y=u[d],m=y.src.find(function(w){return w.format==="truetype"});m&&c.addFont(m.url,y.ref.name,y.ref.style)}return p.windowHeight=p.windowHeight||0,p.windowHeight=p.windowHeight==0?Math.max(this.prop.container.clientHeight,this.prop.container.scrollHeight,this.prop.container.offsetHeight):p.windowHeight,c.context2d.save(!0),l(this.prop.container,p)}).then(function(l){this.opt.jsPDF.context2d.restore(!0),(this.opt.html2canvas.onrendered||function(){})(l),this.prop.canvas=l,document.body.removeChild(this.prop.overlay)})},a.prototype.toImg=function(){return this.thenList([function(){return this.prop.canvas||this.toCanvas()}]).then(function(){var o=this.prop.canvas.toDataURL("image/"+this.opt.image.type,this.opt.image.quality);this.prop.img=document.createElement("img"),this.prop.img.src=o})},a.prototype.toPdf=function(){return this.thenList([function(){return this.toContext2d()}]).then(function(){this.prop.pdf=this.prop.pdf||this.opt.jsPDF})},a.prototype.output=function(o,l,c){return(c=c||"pdf").toLowerCase()==="img"||c.toLowerCase()==="image"?this.outputImg(o,l):this.outputPdf(o,l)},a.prototype.outputPdf=function(o,l){return this.thenList([function(){return this.prop.pdf||this.toPdf()}]).then(function(){return this.prop.pdf.output(o,l)})},a.prototype.outputImg=function(o){return this.thenList([function(){return this.prop.img||this.toImg()}]).then(function(){switch(o){case void 0:case"img":return this.prop.img;case"datauristring":case"dataurlstring":return this.prop.img.src;case"datauri":case"dataurl":return document.location.href=this.prop.img.src;default:throw'Image output type "'+o+'" is not supported.'}})},a.prototype.save=function(o){return this.thenList([function(){return this.prop.pdf||this.toPdf()}]).set(o?{filename:o}:null).then(function(){this.prop.pdf.save(this.opt.filename)})},a.prototype.doCallback=function(){return this.thenList([function(){return this.prop.pdf||this.toPdf()}]).then(function(){this.prop.callback(this.prop.pdf)})},a.prototype.set=function(o){if(i(o)!=="object")return this;var l=Object.keys(o||{}).map(function(c){if(c in a.template.prop)return function(){this.prop[c]=o[c]};switch(c){case"margin":return this.setMargin.bind(this,o.margin);case"jsPDF":return function(){return this.opt.jsPDF=o.jsPDF,this.setPageSize()};case"pageSize":return this.setPageSize.bind(this,o.pageSize);default:return function(){this.opt[c]=o[c]}}},this);return this.then(function(){return this.thenList(l)})},a.prototype.get=function(o,l){return this.then(function(){var c=o in a.template.prop?this.prop[o]:this.opt[o];return l?l(c):c})},a.prototype.setMargin=function(o){return this.then(function(){switch(i(o)){case"number":o=[o,o,o,o];case"array":if(o.length===2&&(o=[o[0],o[1],o[0],o[1]]),o.length===4)break;default:return this.error("Invalid margin array.")}this.opt.margin=o}).then(this.setPageSize)},a.prototype.setPageSize=function(o){function l(c,u){return Math.floor(c*u/72*96)}return this.then(function(){(o=o||Ut.getPageSize(this.opt.jsPDF)).hasOwnProperty("inner")||(o.inner={width:o.width-this.opt.margin[1]-this.opt.margin[3],height:o.height-this.opt.margin[0]-this.opt.margin[2]},o.inner.px={width:l(o.inner.width,o.k),height:l(o.inner.height,o.k)},o.inner.ratio=o.inner.height/o.inner.width),this.prop.pageSize=o})},a.prototype.setProgress=function(o,l,c,u){return o!=null&&(this.progress.val=o),l!=null&&(this.progress.state=l),c!=null&&(this.progress.n=c),u!=null&&(this.progress.stack=u),this.progress.ratio=this.progress.val/this.progress.state,this},a.prototype.updateProgress=function(o,l,c,u){return this.setProgress(o?this.progress.val+o:null,l||null,c?this.progress.n+c:null,u?this.progress.stack.concat(u):null)},a.prototype.then=function(o,l){var c=this;return this.thenCore(o,l,function(u,f){return c.updateProgress(null,null,1,[u]),Promise.prototype.then.call(this,function(p){return c.updateProgress(null,u),p}).then(u,f).then(function(p){return c.updateProgress(1),p})})},a.prototype.thenCore=function(o,l,c){c=c||Promise.prototype.then;var u=this;o&&(o=o.bind(u)),l&&(l=l.bind(u));var f=Promise.toString().indexOf("[native code]")!==-1&&Promise.name==="Promise"?u:a.convert(Object.assign({},u),Promise.prototype),p=c.call(f,o,l);return a.convert(p,u.__proto__)},a.prototype.thenExternal=function(o,l){return Promise.prototype.then.call(this,o,l)},a.prototype.thenList=function(o){var l=this;return o.forEach(function(c){l=l.thenCore(c)}),l},a.prototype.catch=function(o){o&&(o=o.bind(this));var l=Promise.prototype.catch.call(this,o);return a.convert(l,this)},a.prototype.catchExternal=function(o){return Promise.prototype.catch.call(this,o)},a.prototype.error=function(o){return this.then(function(){throw new Error(o)})},a.prototype.using=a.prototype.set,a.prototype.saveAs=a.prototype.save,a.prototype.export=a.prototype.output,a.prototype.run=a.prototype.then,Ut.getPageSize=function(o,l,c){if(Un(o)==="object"){var u=o;o=u.orientation,l=u.unit||l,c=u.format||c}l=l||"mm",c=c||"a4",o=(""+(o||"P")).toLowerCase();var f,p=(""+c).toLowerCase(),d={a0:[2383.94,3370.39],a1:[1683.78,2383.94],a2:[1190.55,1683.78],a3:[841.89,1190.55],a4:[595.28,841.89],a5:[419.53,595.28],a6:[297.64,419.53],a7:[209.76,297.64],a8:[147.4,209.76],a9:[104.88,147.4],a10:[73.7,104.88],b0:[2834.65,4008.19],b1:[2004.09,2834.65],b2:[1417.32,2004.09],b3:[1000.63,1417.32],b4:[708.66,1000.63],b5:[498.9,708.66],b6:[354.33,498.9],b7:[249.45,354.33],b8:[175.75,249.45],b9:[124.72,175.75],b10:[87.87,124.72],c0:[2599.37,3676.54],c1:[1836.85,2599.37],c2:[1298.27,1836.85],c3:[918.43,1298.27],c4:[649.13,918.43],c5:[459.21,649.13],c6:[323.15,459.21],c7:[229.61,323.15],c8:[161.57,229.61],c9:[113.39,161.57],c10:[79.37,113.39],dl:[311.81,623.62],letter:[612,792],"government-letter":[576,756],legal:[612,1008],"junior-legal":[576,360],ledger:[1224,792],tabloid:[792,1224],"credit-card":[153,243]};switch(l){case"pt":f=1;break;case"mm":f=72/25.4;break;case"cm":f=72/2.54;break;case"in":f=72;break;case"px":f=.75;break;case"pc":case"em":f=12;break;case"ex":f=6;break;default:throw"Invalid unit: "+l}var y,m=0,w=0;if(d.hasOwnProperty(p))m=d[p][1]/f,w=d[p][0]/f;else try{m=c[1],w=c[0]}catch{throw new Error("Invalid format: "+c)}if(o==="p"||o==="portrait")o="p",w>m&&(y=w,w=m,m=y);else{if(o!=="l"&&o!=="landscape")throw"Invalid orientation: "+o;o="l",m>w&&(y=w,w=m,m=y)}return{width:w,height:m,unit:l,k:f,orientation:o}},t.html=function(o,l){(l=l||{}).callback=l.callback||function(){},l.html2canvas=l.html2canvas||{},l.html2canvas.canvas=l.html2canvas.canvas||this.canvas,l.jsPDF=l.jsPDF||this,l.fontFaces=l.fontFaces?l.fontFaces.map(em):null;var c=new a(l);return l.worker?c:c.from(o).doCallback()}})(Ut.API),Ut.API.addJS=function(t){var e,n,i=t;return this.internal.events.subscribe("postPutResources",function(){e=this.internal.newObject(),this.internal.out("<<"),this.internal.out("/Names [(EmbeddedJS) "+(e+1)+" 0 R]"),this.internal.out(">>"),this.internal.out("endobj"),n=this.internal.newObject(),this.internal.out("<<"),this.internal.out("/S /JavaScript"),this.internal.out("/JS ("+i+")"),this.internal.out(">>"),this.internal.out("endobj")}),this.internal.events.subscribe("putCatalog",function(){e!==void 0&&n!==void 0&&this.internal.out("/Names <</JavaScript "+e+" 0 R>>")}),this},(function(t){var e;t.events.push(["postPutResources",function(){var n=this,i=/^(\d+) 0 obj$/;if(this.outline.root.children.length>0)for(var r=n.outline.render().split(/\r\n/),s=0;s<r.length;s++){var a=r[s],o=i.exec(a);if(o!=null){var l=o[1];n.internal.newObjectDeferredBegin(l,!1)}n.internal.write(a)}if(this.outline.createNamedDestinations){var c=this.internal.pages.length,u=[];for(s=0;s<c;s++){var f=n.internal.newObject();u.push(f);var p=n.internal.getPageInfo(s+1);n.internal.write("<< /D["+p.objId+" 0 R /XYZ null null null]>> endobj")}var d=n.internal.newObject();for(n.internal.write("<< /Names [ "),s=0;s<u.length;s++)n.internal.write("(page_"+(s+1)+")"+u[s]+" 0 R");n.internal.write(" ] >>","endobj"),e=n.internal.newObject(),n.internal.write("<< /Dests "+d+" 0 R"),n.internal.write(">>","endobj")}}]),t.events.push(["putCatalog",function(){var n=this;n.outline.root.children.length>0&&(n.internal.write("/Outlines",this.outline.makeRef(this.outline.root)),this.outline.createNamedDestinations&&n.internal.write("/Names "+e+" 0 R"))}]),t.events.push(["initialized",function(){var n=this;n.outline={createNamedDestinations:!1,root:{children:[]}},n.outline.add=function(i,r,s){var a={title:r,options:s,children:[]};return i==null&&(i=this.root),i.children.push(a),a},n.outline.render=function(){return this.ctx={},this.ctx.val="",this.ctx.pdf=n,this.genIds_r(this.root),this.renderRoot(this.root),this.renderItems(this.root),this.ctx.val},n.outline.genIds_r=function(i){i.id=n.internal.newObjectDeferred();for(var r=0;r<i.children.length;r++)this.genIds_r(i.children[r])},n.outline.renderRoot=function(i){this.objStart(i),this.line("/Type /Outlines"),i.children.length>0&&(this.line("/First "+this.makeRef(i.children[0])),this.line("/Last "+this.makeRef(i.children[i.children.length-1]))),this.line("/Count "+this.count_r({count:0},i)),this.objEnd()},n.outline.renderItems=function(i){for(var r=this.ctx.pdf.internal.getVerticalCoordinateString,s=0;s<i.children.length;s++){var a=i.children[s];this.objStart(a),this.line("/Title "+this.makeString(a.title)),this.line("/Parent "+this.makeRef(i)),s>0&&this.line("/Prev "+this.makeRef(i.children[s-1])),s<i.children.length-1&&this.line("/Next "+this.makeRef(i.children[s+1])),a.children.length>0&&(this.line("/First "+this.makeRef(a.children[0])),this.line("/Last "+this.makeRef(a.children[a.children.length-1])));var o=this.count=this.count_r({count:0},a);if(o>0&&this.line("/Count "+o),a.options&&a.options.pageNumber){var l=n.internal.getPageInfo(a.options.pageNumber);this.line("/Dest ["+l.objId+" 0 R /XYZ 0 "+r(0)+" 0]")}this.objEnd()}for(var c=0;c<i.children.length;c++)this.renderItems(i.children[c])},n.outline.line=function(i){this.ctx.val+=i+`\r
`},n.outline.makeRef=function(i){return i.id+" 0 R"},n.outline.makeString=function(i){return"("+n.internal.pdfEscape(i)+")"},n.outline.objStart=function(i){this.ctx.val+=`\r
`+i.id+` 0 obj\r
<<\r
`},n.outline.objEnd=function(){this.ctx.val+=`>> \r
endobj\r
`},n.outline.count_r=function(i,r){for(var s=0;s<r.children.length;s++)i.count++,this.count_r(i,r.children[s]);return i.count}}])})(Ut.API),(function(t){var e=[192,193,194,195,196,197,198,199];t.processJPEG=function(n,i,r,s,a,o){var l,c=this.decode.DCT_DECODE,u=null;if(typeof n=="string"||this.__addimage__.isArrayBuffer(n)||this.__addimage__.isArrayBufferView(n)){switch(n=a||n,n=this.__addimage__.isArrayBuffer(n)?new Uint8Array(n):n,l=(function(f){for(var p,d=256*f.charCodeAt(4)+f.charCodeAt(5),y=f.length,m={width:0,height:0,numcomponents:1},w=4;w<y;w+=2){if(w+=d,e.indexOf(f.charCodeAt(w+1))!==-1){p=256*f.charCodeAt(w+5)+f.charCodeAt(w+6),m={width:256*f.charCodeAt(w+7)+f.charCodeAt(w+8),height:p,numcomponents:f.charCodeAt(w+9)};break}d=256*f.charCodeAt(w+2)+f.charCodeAt(w+3)}return m})(n=this.__addimage__.isArrayBufferView(n)?this.__addimage__.arrayBufferToBinaryString(n):n),l.numcomponents){case 1:o=this.color_spaces.DEVICE_GRAY;break;case 4:o=this.color_spaces.DEVICE_CMYK;break;case 3:o=this.color_spaces.DEVICE_RGB}u={data:n,width:l.width,height:l.height,colorSpace:o,bitsPerComponent:8,filter:c,index:i,alias:r}}return u}})(Ut.API),Ut.API.processPNG=function(t,e,n,i){if(this.__addimage__.isArrayBuffer(t)&&(t=new Uint8Array(t)),this.__addimage__.isArrayBufferView(t)){var r,s=hF(t,{checkCrc:!0}),a=s.width,o=s.height,l=s.channels,c=s.palette,u=s.depth;r=c&&l===1?(function(T){for(var D=T.width,U=T.height,C=T.data,N=T.palette,B=T.depth,P=!1,F=[],q=[],Z=void 0,W=!1,Y=0,ue=0;ue<N.length;ue++){var le=R2(N[ue],4),O=le[0],V=le[1],G=le[2],re=le[3];F.push(O,V,G),re!=null&&(re===0?(Y++,q.length<1&&q.push(ue)):re<255&&(W=!0))}if(W||Y>1){P=!0,q=void 0;var ae=D*U;Z=new Uint8Array(ae);for(var ee=new DataView(C.buffer),de=0;de<ae;de++){var he=nm(ee,de,B),pe=R2(N[he],4)[3];Z[de]=pe}}else Y===0&&(q=void 0);return{colorSpace:"Indexed",colorsPerPixel:1,sMaskBitsPerComponent:P?8:void 0,colorBytes:C,alphaBytes:Z,needSMask:P,palette:F,mask:q}})(s):l===2||l===4?(function(T){for(var D=T.data,U=T.width,C=T.height,N=T.channels,B=T.depth,P=N===2?"DeviceGray":"DeviceRGB",F=N-1,q=U*C,Z=F,W=q*Z,Y=1*q,ue=Math.ceil(W*B/8),le=Math.ceil(Y*B/8),O=new Uint8Array(ue),V=new Uint8Array(le),G=new DataView(D.buffer),re=new DataView(O.buffer),ae=new DataView(V.buffer),ee=!1,de=0;de<q;de++){for(var he=de*N,pe=0;pe<Z;pe++)qy(re,nm(G,he+pe,B),de*Z+pe,B);var ge=nm(G,he+Z,B);ge<(1<<B)-1&&(ee=!0),qy(ae,ge,1*de,B)}return{colorSpace:P,colorsPerPixel:F,sMaskBitsPerComponent:ee?B:void 0,colorBytes:O,alphaBytes:V,needSMask:ee}})(s):(function(T){var D=T.data,U=T.channels===1?"DeviceGray":"DeviceRGB";return{colorSpace:U,colorsPerPixel:U==="DeviceGray"?1:3,colorBytes:D instanceof Uint16Array?(function(C){for(var N=C.length,B=new Uint8Array(2*N),P=new DataView(B.buffer,B.byteOffset,B.byteLength),F=0;F<N;F++)P.setUint16(2*F,C[F],!1);return B})(D):D,needSMask:!1}})(s);var f,p,d,y=r,m=y.colorSpace,w=y.colorsPerPixel,b=y.sMaskBitsPerComponent,S=y.colorBytes,A=y.alphaBytes,_=y.needSMask,I=y.palette,E=y.mask,M=null;return i!==Ut.API.image_compression.NONE&&typeof n1=="function"?(M=(function(T){var D;switch(T){case Ut.API.image_compression.FAST:D=11;break;case Ut.API.image_compression.MEDIUM:D=13;break;case Ut.API.image_compression.SLOW:D=14;break;default:D=12}return D})(i),f=this.decode.FLATE_DECODE,p="/Predictor ".concat(M," /Colors ").concat(w," /BitsPerComponent ").concat(u," /Columns ").concat(a),t=Oy(S,Math.ceil(a*w*u/8),w,u,i),_&&(d=Oy(A,Math.ceil(a*b/8),1,b,i))):(f=void 0,p=void 0,t=S,_&&(d=A)),(this.__addimage__.isArrayBuffer(t)||this.__addimage__.isArrayBufferView(t))&&(t=this.__addimage__.arrayBufferToBinaryString(t)),(d&&this.__addimage__.isArrayBuffer(d)||this.__addimage__.isArrayBufferView(d))&&(d=this.__addimage__.arrayBufferToBinaryString(d)),{alias:n,data:t,index:e,filter:f,decodeParameters:p,transparency:E,palette:I,sMask:d,predictor:M,width:a,height:o,bitsPerComponent:u,sMaskBitsPerComponent:b,colorSpace:m}}},(function(t){t.processGIF89A=function(e,n,i,r){var s=new DF(e),a=s.width,o=s.height,l=[];s.decodeAndBlitFrameRGBA(0,l);var c={data:l,width:a,height:o},u=new im(100).encode(c,100);return t.processJPEG.call(this,u,n,i,r)},t.processGIF87A=t.processGIF89A})(Ut.API),Aa.prototype.parseHeader=function(){if(this.fileSize=this.datav.getUint32(this.pos,!0),this.pos+=4,this.reserved=this.datav.getUint32(this.pos,!0),this.pos+=4,this.offset=this.datav.getUint32(this.pos,!0),this.pos+=4,this.headerSize=this.datav.getUint32(this.pos,!0),this.pos+=4,this.width=this.datav.getUint32(this.pos,!0),this.pos+=4,this.height=this.datav.getInt32(this.pos,!0),this.pos+=4,this.planes=this.datav.getUint16(this.pos,!0),this.pos+=2,this.bitPP=this.datav.getUint16(this.pos,!0),this.pos+=2,this.compress=this.datav.getUint32(this.pos,!0),this.pos+=4,this.rawSize=this.datav.getUint32(this.pos,!0),this.pos+=4,this.hr=this.datav.getUint32(this.pos,!0),this.pos+=4,this.vr=this.datav.getUint32(this.pos,!0),this.pos+=4,this.colors=this.datav.getUint32(this.pos,!0),this.pos+=4,this.importantColors=this.datav.getUint32(this.pos,!0),this.pos+=4,this.bitPP===16&&this.is_with_alpha&&(this.bitPP=15),this.bitPP<15){var t=this.colors===0?1<<this.bitPP:this.colors;this.palette=new Array(t);for(var e=0;e<t;e++){var n=this.datav.getUint8(this.pos++,!0),i=this.datav.getUint8(this.pos++,!0),r=this.datav.getUint8(this.pos++,!0),s=this.datav.getUint8(this.pos++,!0);this.palette[e]={red:r,green:i,blue:n,quad:s}}}this.height<0&&(this.height*=-1,this.bottom_up=!1)},Aa.prototype.parseBGR=function(){this.pos=this.offset;var t="bit"+this.bitPP,e=this.width*this.height*4;if(e>536870912)throw new Error("Image dimensions exceed 512MB, which is too large.");this.data=new Uint8Array(e);try{this[t]()}catch(n){ni.log("bit decode error:"+n)}},Aa.prototype.bit1=function(){var t,e=Math.ceil(this.width/8),n=e%4;for(t=this.height-1;t>=0;t--){for(var i=this.bottom_up?t:this.height-1-t,r=0;r<e;r++)for(var s=this.datav.getUint8(this.pos++,!0),a=i*this.width*4+8*r*4,o=0;o<8&&8*r+o<this.width;o++){var l=this.palette[s>>7-o&1];this.data[a+4*o]=l.blue,this.data[a+4*o+1]=l.green,this.data[a+4*o+2]=l.red,this.data[a+4*o+3]=255}n!==0&&(this.pos+=4-n)}},Aa.prototype.bit4=function(){for(var t=Math.ceil(this.width/2),e=t%4,n=this.height-1;n>=0;n--){for(var i=this.bottom_up?n:this.height-1-n,r=0;r<t;r++){var s=this.datav.getUint8(this.pos++,!0),a=i*this.width*4+2*r*4,o=s>>4,l=15&s,c=this.palette[o];if(this.data[a]=c.blue,this.data[a+1]=c.green,this.data[a+2]=c.red,this.data[a+3]=255,2*r+1>=this.width)break;c=this.palette[l],this.data[a+4]=c.blue,this.data[a+4+1]=c.green,this.data[a+4+2]=c.red,this.data[a+4+3]=255}e!==0&&(this.pos+=4-e)}},Aa.prototype.bit8=function(){for(var t=this.width%4,e=this.height-1;e>=0;e--){for(var n=this.bottom_up?e:this.height-1-e,i=0;i<this.width;i++){var r=this.datav.getUint8(this.pos++,!0),s=n*this.width*4+4*i;if(r<this.palette.length){var a=this.palette[r];this.data[s]=a.red,this.data[s+1]=a.green,this.data[s+2]=a.blue,this.data[s+3]=255}else this.data[s]=255,this.data[s+1]=255,this.data[s+2]=255,this.data[s+3]=255}t!==0&&(this.pos+=4-t)}},Aa.prototype.bit15=function(){for(var t=this.width%3,e=parseInt("11111",2),n=this.height-1;n>=0;n--){for(var i=this.bottom_up?n:this.height-1-n,r=0;r<this.width;r++){var s=this.datav.getUint16(this.pos,!0);this.pos+=2;var a=(s&e)/e*255|0,o=(s>>5&e)/e*255|0,l=(s>>10&e)/e*255|0,c=s>>15?255:0,u=i*this.width*4+4*r;this.data[u]=l,this.data[u+1]=o,this.data[u+2]=a,this.data[u+3]=c}this.pos+=t}},Aa.prototype.bit16=function(){for(var t=this.width%3,e=parseInt("11111",2),n=parseInt("111111",2),i=this.height-1;i>=0;i--){for(var r=this.bottom_up?i:this.height-1-i,s=0;s<this.width;s++){var a=this.datav.getUint16(this.pos,!0);this.pos+=2;var o=(a&e)/e*255|0,l=(a>>5&n)/n*255|0,c=(a>>11)/e*255|0,u=r*this.width*4+4*s;this.data[u]=c,this.data[u+1]=l,this.data[u+2]=o,this.data[u+3]=255}this.pos+=t}},Aa.prototype.bit24=function(){for(var t=this.height-1;t>=0;t--){for(var e=this.bottom_up?t:this.height-1-t,n=0;n<this.width;n++){var i=this.datav.getUint8(this.pos++,!0),r=this.datav.getUint8(this.pos++,!0),s=this.datav.getUint8(this.pos++,!0),a=e*this.width*4+4*n;this.data[a]=s,this.data[a+1]=r,this.data[a+2]=i,this.data[a+3]=255}this.pos+=this.width%4}},Aa.prototype.bit32=function(){for(var t=this.height-1;t>=0;t--)for(var e=this.bottom_up?t:this.height-1-t,n=0;n<this.width;n++){var i=this.datav.getUint8(this.pos++,!0),r=this.datav.getUint8(this.pos++,!0),s=this.datav.getUint8(this.pos++,!0),a=this.datav.getUint8(this.pos++,!0),o=e*this.width*4+4*n;this.data[o]=s,this.data[o+1]=r,this.data[o+2]=i,this.data[o+3]=a}},Aa.prototype.getData=function(){return this.data},(function(t){t.processBMP=function(e,n,i,r){var s=new Aa(e,!1),a=s.width,o=s.height,l={data:s.getData(),width:a,height:o},c=new im(100).encode(l,100);return t.processJPEG.call(this,c,n,i,r)}})(Ut.API),Hy.prototype.getData=function(){return this.data},(function(t){t.processWEBP=function(e,n,i,r){var s=new Hy(e),a=s.width,o=s.height,l={data:s.getData(),width:a,height:o},c=new im(100).encode(l,100);return t.processJPEG.call(this,c,n,i,r)}})(Ut.API),Ut.API.processRGBA=function(t,e,n){for(var i=t.data,r=i.length,s=new Uint8Array(r/4*3),a=new Uint8Array(r/4),o=0,l=0,c=0;c<r;c+=4){var u=i[c],f=i[c+1],p=i[c+2],d=i[c+3];s[o++]=u,s[o++]=f,s[o++]=p,a[l++]=d}var y=this.__addimage__.arrayBufferToBinaryString(s);return{alpha:this.__addimage__.arrayBufferToBinaryString(a),data:y,index:e,alias:n,colorSpace:"DeviceRGB",bitsPerComponent:8,width:t.width,height:t.height}},Ut.API.setLanguage=function(t){return this.internal.languageSettings===void 0&&(this.internal.languageSettings={},this.internal.languageSettings.isSubscribed=!1),{af:"Afrikaans",sq:"Albanian",ar:"Arabic (Standard)","ar-DZ":"Arabic (Algeria)","ar-BH":"Arabic (Bahrain)","ar-EG":"Arabic (Egypt)","ar-IQ":"Arabic (Iraq)","ar-JO":"Arabic (Jordan)","ar-KW":"Arabic (Kuwait)","ar-LB":"Arabic (Lebanon)","ar-LY":"Arabic (Libya)","ar-MA":"Arabic (Morocco)","ar-OM":"Arabic (Oman)","ar-QA":"Arabic (Qatar)","ar-SA":"Arabic (Saudi Arabia)","ar-SY":"Arabic (Syria)","ar-TN":"Arabic (Tunisia)","ar-AE":"Arabic (U.A.E.)","ar-YE":"Arabic (Yemen)",an:"Aragonese",hy:"Armenian",as:"Assamese",ast:"Asturian",az:"Azerbaijani",eu:"Basque",be:"Belarusian",bn:"Bengali",bs:"Bosnian",br:"Breton",bg:"Bulgarian",my:"Burmese",ca:"Catalan",ch:"Chamorro",ce:"Chechen",zh:"Chinese","zh-HK":"Chinese (Hong Kong)","zh-CN":"Chinese (PRC)","zh-SG":"Chinese (Singapore)","zh-TW":"Chinese (Taiwan)",cv:"Chuvash",co:"Corsican",cr:"Cree",hr:"Croatian",cs:"Czech",da:"Danish",nl:"Dutch (Standard)","nl-BE":"Dutch (Belgian)",en:"English","en-AU":"English (Australia)","en-BZ":"English (Belize)","en-CA":"English (Canada)","en-IE":"English (Ireland)","en-JM":"English (Jamaica)","en-NZ":"English (New Zealand)","en-PH":"English (Philippines)","en-ZA":"English (South Africa)","en-TT":"English (Trinidad & Tobago)","en-GB":"English (United Kingdom)","en-US":"English (United States)","en-ZW":"English (Zimbabwe)",eo:"Esperanto",et:"Estonian",fo:"Faeroese",fj:"Fijian",fi:"Finnish",fr:"French (Standard)","fr-BE":"French (Belgium)","fr-CA":"French (Canada)","fr-FR":"French (France)","fr-LU":"French (Luxembourg)","fr-MC":"French (Monaco)","fr-CH":"French (Switzerland)",fy:"Frisian",fur:"Friulian",gd:"Gaelic (Scots)","gd-IE":"Gaelic (Irish)",gl:"Galacian",ka:"Georgian",de:"German (Standard)","de-AT":"German (Austria)","de-DE":"German (Germany)","de-LI":"German (Liechtenstein)","de-LU":"German (Luxembourg)","de-CH":"German (Switzerland)",el:"Greek",gu:"Gujurati",ht:"Haitian",he:"Hebrew",hi:"Hindi",hu:"Hungarian",is:"Icelandic",id:"Indonesian",iu:"Inuktitut",ga:"Irish",it:"Italian (Standard)","it-CH":"Italian (Switzerland)",ja:"Japanese",kn:"Kannada",ks:"Kashmiri",kk:"Kazakh",km:"Khmer",ky:"Kirghiz",tlh:"Klingon",ko:"Korean","ko-KP":"Korean (North Korea)","ko-KR":"Korean (South Korea)",la:"Latin",lv:"Latvian",lt:"Lithuanian",lb:"Luxembourgish",mk:"North Macedonia",ms:"Malay",ml:"Malayalam",mt:"Maltese",mi:"Maori",mr:"Marathi",mo:"Moldavian",nv:"Navajo",ng:"Ndonga",ne:"Nepali",no:"Norwegian",nb:"Norwegian (Bokmal)",nn:"Norwegian (Nynorsk)",oc:"Occitan",or:"Oriya",om:"Oromo",fa:"Persian","fa-IR":"Persian/Iran",pl:"Polish",pt:"Portuguese","pt-BR":"Portuguese (Brazil)",pa:"Punjabi","pa-IN":"Punjabi (India)","pa-PK":"Punjabi (Pakistan)",qu:"Quechua",rm:"Rhaeto-Romanic",ro:"Romanian","ro-MO":"Romanian (Moldavia)",ru:"Russian","ru-MO":"Russian (Moldavia)",sz:"Sami (Lappish)",sg:"Sango",sa:"Sanskrit",sc:"Sardinian",sd:"Sindhi",si:"Singhalese",sr:"Serbian",sk:"Slovak",sl:"Slovenian",so:"Somani",sb:"Sorbian",es:"Spanish","es-AR":"Spanish (Argentina)","es-BO":"Spanish (Bolivia)","es-CL":"Spanish (Chile)","es-CO":"Spanish (Colombia)","es-CR":"Spanish (Costa Rica)","es-DO":"Spanish (Dominican Republic)","es-EC":"Spanish (Ecuador)","es-SV":"Spanish (El Salvador)","es-GT":"Spanish (Guatemala)","es-HN":"Spanish (Honduras)","es-MX":"Spanish (Mexico)","es-NI":"Spanish (Nicaragua)","es-PA":"Spanish (Panama)","es-PY":"Spanish (Paraguay)","es-PE":"Spanish (Peru)","es-PR":"Spanish (Puerto Rico)","es-ES":"Spanish (Spain)","es-UY":"Spanish (Uruguay)","es-VE":"Spanish (Venezuela)",sx:"Sutu",sw:"Swahili",sv:"Swedish","sv-FI":"Swedish (Finland)","sv-SV":"Swedish (Sweden)",ta:"Tamil",tt:"Tatar",te:"Teluga",th:"Thai",tig:"Tigre",ts:"Tsonga",tn:"Tswana",tr:"Turkish",tk:"Turkmen",uk:"Ukrainian",hsb:"Upper Sorbian",ur:"Urdu",ve:"Venda",vi:"Vietnamese",vo:"Volapuk",wa:"Walloon",cy:"Welsh",xh:"Xhosa",ji:"Yiddish",zu:"Zulu"}[t]!==void 0&&(this.internal.languageSettings.languageCode=t,this.internal.languageSettings.isSubscribed===!1&&(this.internal.events.subscribe("putCatalog",function(){this.internal.write("/Lang ("+this.internal.languageSettings.languageCode+")")}),this.internal.languageSettings.isSubscribed=!0)),this},ru=Ut.API,Jf=ru.getCharWidthsArray=function(t,e){var n,i,r=(e=e||{}).font||this.internal.getFont(),s=e.fontSize||this.internal.getFontSize(),a=e.charSpace||this.internal.getCharSpace(),o=e.widths?e.widths:r.metadata.Unicode.widths,l=o.fof?o.fof:1,c=e.kerning?e.kerning:r.metadata.Unicode.kerning,u=c.fof?c.fof:1,f=e.doKerning!==!1,p=0,d=t.length,y=0,m=o[0]||l,w=[];for(n=0;n<d;n++)i=t.charCodeAt(n),typeof r.metadata.widthOfString=="function"?w.push((r.metadata.widthOfGlyph(r.metadata.characterToGlyph(i))+a*(1e3/s)||0)/1e3):(p=f&&Un(c[i])==="object"&&!isNaN(parseInt(c[i][y],10))?c[i][y]/u:0,w.push((o[i]||m)/l+p)),y=i;return w},My=ru.getStringUnitWidth=function(t,e){var n=(e=e||{}).fontSize||this.internal.getFontSize(),i=e.font||this.internal.getFont(),r=e.charSpace||this.internal.getCharSpace();return ru.processArabic&&(t=ru.processArabic(t)),typeof i.metadata.widthOfString=="function"?i.metadata.widthOfString(t,n,r)/n:Jf.apply(this,arguments).reduce(function(s,a){return s+a},0)},Ty=function(t,e,n,i){for(var r=[],s=0,a=t.length,o=0;s!==a&&o+e[s]<n;)o+=e[s],s++;r.push(t.slice(0,s));var l=s;for(o=0;s!==a;)o+e[s]>i&&(r.push(t.slice(l,s)),o=0,l=s),o+=e[s],s++;return l!==s&&r.push(t.slice(l,s)),r},Dy=function(t,e,n){n||(n={});var i,r,s,a,o,l,c,u=[],f=[u],p=n.textIndent||0,d=0,y=0,m=t.split(" "),w=Jf.apply(this,[" ",n])[0];if(l=n.lineIndent===-1?m[0].length+2:n.lineIndent||0){var b=Array(l).join(" "),S=[];m.map(function(_){(_=_.split(/\s*\n/)).length>1?S=S.concat(_.map(function(I,E){return(E&&I.length?`
`:"")+I})):S.push(_[0])}),m=S,l=My.apply(this,[b,n])}for(s=0,a=m.length;s<a;s++){var A=0;if(i=m[s],l&&i[0]==`
`&&(i=i.substr(1),A=1),p+d+(y=(r=Jf.apply(this,[i,n])).reduce(function(_,I){return _+I},0))>e||A){if(y>e){for(o=Ty.apply(this,[i,r,e-(p+d),e]),u.push(o.shift()),u=[o.pop()];o.length;)f.push([o.shift()]);y=r.slice(i.length-(u[0]?u[0].length:0)).reduce(function(_,I){return _+I},0)}else u=[i];f.push(u),p=y+l,d=w}else u.push(i),p+=d+y,d=w}return c=l?function(_,I){return(I?b:"")+_.join(" ")}:function(_){return _.join(" ")},f.map(c)},ru.splitTextToSize=function(t,e,n){var i,r=(n=n||{}).fontSize||this.internal.getFontSize(),s=(function(u){if(u.widths&&u.kerning)return{widths:u.widths,kerning:u.kerning};var f=this.internal.getFont(u.fontName,u.fontStyle),p="Unicode";return f.metadata[p]?{widths:f.metadata[p].widths||{0:1},kerning:f.metadata[p].kerning||{}}:{font:f.metadata,fontSize:this.internal.getFontSize(),charSpace:this.internal.getCharSpace()}}).call(this,n);i=Array.isArray(t)?t:String(t).split(/\r?\n/);var a=1*this.internal.scaleFactor*e/r;s.textIndent=n.textIndent?1*n.textIndent*this.internal.scaleFactor/r:0,s.lineIndent=n.lineIndent;var o,l,c=[];for(o=0,l=i.length;o<l;o++)c=c.concat(Dy.apply(this,[i[o],a,s]));return c},(function(t){t.__fontmetrics__=t.__fontmetrics__||{};for(var e="0123456789abcdef",n="klmnopqrstuvwxyz",i={},r={},s=0;s<16;s++)i[n[s]]=e[s],r[e[s]]=n[s];var a=function(p){return"0x"+parseInt(p,10).toString(16)},o=t.__fontmetrics__.compress=function(p){var d,y,m,w,b=["{"];for(var S in p){if(d=p[S],isNaN(parseInt(S,10))?y="'"+S+"'":(S=parseInt(S,10),y=(y=a(S).slice(2)).slice(0,-1)+r[y.slice(-1)]),typeof d=="number")d<0?(m=a(d).slice(3),w="-"):(m=a(d).slice(2),w=""),m=w+m.slice(0,-1)+r[m.slice(-1)];else{if(Un(d)!=="object")throw new Error("Don't know what to do with value type "+Un(d)+".");m=o(d)}b.push(y+m)}return b.push("}"),b.join("")},l=t.__fontmetrics__.uncompress=function(p){if(typeof p!="string")throw new Error("Invalid argument passed to uncompress.");for(var d,y,m,w,b={},S=1,A=b,_=[],I="",E="",M=p.length-1,T=1;T<M;T+=1)(w=p[T])=="'"?d?(m=d.join(""),d=void 0):d=[]:d?d.push(w):w=="{"?(_.push([A,m]),A={},m=void 0):w=="}"?((y=_.pop())[0][y[1]]=A,m=void 0,A=y[0]):w=="-"?S=-1:m===void 0?i.hasOwnProperty(w)?(I+=i[w],m=parseInt(I,16)*S,S=1,I=""):I+=w:i.hasOwnProperty(w)?(E+=i[w],A[m]=parseInt(E,16)*S,S=1,m=void 0,E=""):E+=w;return b},c={codePages:["WinAnsiEncoding"],WinAnsiEncoding:l("{19m8n201n9q201o9r201s9l201t9m201u8m201w9n201x9o201y8o202k8q202l8r202m9p202q8p20aw8k203k8t203t8v203u9v2cq8s212m9t15m8w15n9w2dw9s16k8u16l9u17s9z17x8y17y9y}")},u={Unicode:{Courier:c,"Courier-Bold":c,"Courier-BoldOblique":c,"Courier-Oblique":c,Helvetica:c,"Helvetica-Bold":c,"Helvetica-BoldOblique":c,"Helvetica-Oblique":c,"Times-Roman":c,"Times-Bold":c,"Times-BoldItalic":c,"Times-Italic":c}},f={Unicode:{"Courier-Oblique":l("{'widths'{k3w'fof'6o}'kerning'{'fof'-6o}}"),"Times-BoldItalic":l("{'widths'{k3o2q4ycx2r201n3m201o6o201s2l201t2l201u2l201w3m201x3m201y3m2k1t2l2r202m2n2n3m2o3m2p5n202q6o2r1w2s2l2t2l2u3m2v3t2w1t2x2l2y1t2z1w3k3m3l3m3m3m3n3m3o3m3p3m3q3m3r3m3s3m203t2l203u2l3v2l3w3t3x3t3y3t3z3m4k5n4l4m4m4m4n4m4o4s4p4m4q4m4r4s4s4y4t2r4u3m4v4m4w3x4x5t4y4s4z4s5k3x5l4s5m4m5n3r5o3x5p4s5q4m5r5t5s4m5t3x5u3x5v2l5w1w5x2l5y3t5z3m6k2l6l3m6m3m6n2w6o3m6p2w6q2l6r3m6s3r6t1w6u1w6v3m6w1w6x4y6y3r6z3m7k3m7l3m7m2r7n2r7o1w7p3r7q2w7r4m7s3m7t2w7u2r7v2n7w1q7x2n7y3t202l3mcl4mal2ram3man3mao3map3mar3mas2lat4uau1uav3maw3way4uaz2lbk2sbl3t'fof'6obo2lbp3tbq3mbr1tbs2lbu1ybv3mbz3mck4m202k3mcm4mcn4mco4mcp4mcq5ycr4mcs4mct4mcu4mcv4mcw2r2m3rcy2rcz2rdl4sdm4sdn4sdo4sdp4sdq4sds4sdt4sdu4sdv4sdw4sdz3mek3mel3mem3men3meo3mep3meq4ser2wes2wet2weu2wev2wew1wex1wey1wez1wfl3rfm3mfn3mfo3mfp3mfq3mfr3tfs3mft3rfu3rfv3rfw3rfz2w203k6o212m6o2dw2l2cq2l3t3m3u2l17s3x19m3m}'kerning'{cl{4qu5kt5qt5rs17ss5ts}201s{201ss}201t{cks4lscmscnscoscpscls2wu2yu201ts}201x{2wu2yu}2k{201ts}2w{4qx5kx5ou5qx5rs17su5tu}2x{17su5tu5ou}2y{4qx5kx5ou5qx5rs17ss5ts}'fof'-6ofn{17sw5tw5ou5qw5rs}7t{cksclscmscnscoscps4ls}3u{17su5tu5os5qs}3v{17su5tu5os5qs}7p{17su5tu}ck{4qu5kt5qt5rs17ss5ts}4l{4qu5kt5qt5rs17ss5ts}cm{4qu5kt5qt5rs17ss5ts}cn{4qu5kt5qt5rs17ss5ts}co{4qu5kt5qt5rs17ss5ts}cp{4qu5kt5qt5rs17ss5ts}6l{4qu5ou5qw5rt17su5tu}5q{ckuclucmucnucoucpu4lu}5r{ckuclucmucnucoucpu4lu}7q{cksclscmscnscoscps4ls}6p{4qu5ou5qw5rt17sw5tw}ek{4qu5ou5qw5rt17su5tu}el{4qu5ou5qw5rt17su5tu}em{4qu5ou5qw5rt17su5tu}en{4qu5ou5qw5rt17su5tu}eo{4qu5ou5qw5rt17su5tu}ep{4qu5ou5qw5rt17su5tu}es{17ss5ts5qs4qu}et{4qu5ou5qw5rt17sw5tw}eu{4qu5ou5qw5rt17ss5ts}ev{17ss5ts5qs4qu}6z{17sw5tw5ou5qw5rs}fm{17sw5tw5ou5qw5rs}7n{201ts}fo{17sw5tw5ou5qw5rs}fp{17sw5tw5ou5qw5rs}fq{17sw5tw5ou5qw5rs}7r{cksclscmscnscoscps4ls}fs{17sw5tw5ou5qw5rs}ft{17su5tu}fu{17su5tu}fv{17su5tu}fw{17su5tu}fz{cksclscmscnscoscps4ls}}}"),"Helvetica-Bold":l("{'widths'{k3s2q4scx1w201n3r201o6o201s1w201t1w201u1w201w3m201x3m201y3m2k1w2l2l202m2n2n3r2o3r2p5t202q6o2r1s2s2l2t2l2u2r2v3u2w1w2x2l2y1w2z1w3k3r3l3r3m3r3n3r3o3r3p3r3q3r3r3r3s3r203t2l203u2l3v2l3w3u3x3u3y3u3z3x4k6l4l4s4m4s4n4s4o4s4p4m4q3x4r4y4s4s4t1w4u3r4v4s4w3x4x5n4y4s4z4y5k4m5l4y5m4s5n4m5o3x5p4s5q4m5r5y5s4m5t4m5u3x5v2l5w1w5x2l5y3u5z3r6k2l6l3r6m3x6n3r6o3x6p3r6q2l6r3x6s3x6t1w6u1w6v3r6w1w6x5t6y3x6z3x7k3x7l3x7m2r7n3r7o2l7p3x7q3r7r4y7s3r7t3r7u3m7v2r7w1w7x2r7y3u202l3rcl4sal2lam3ran3rao3rap3rar3ras2lat4tau2pav3raw3uay4taz2lbk2sbl3u'fof'6obo2lbp3xbq3rbr1wbs2lbu2obv3rbz3xck4s202k3rcm4scn4sco4scp4scq6ocr4scs4mct4mcu4mcv4mcw1w2m2zcy1wcz1wdl4sdm4ydn4ydo4ydp4ydq4yds4ydt4sdu4sdv4sdw4sdz3xek3rel3rem3ren3reo3rep3req5ter3res3ret3reu3rev3rew1wex1wey1wez1wfl3xfm3xfn3xfo3xfp3xfq3xfr3ufs3xft3xfu3xfv3xfw3xfz3r203k6o212m6o2dw2l2cq2l3t3r3u2l17s4m19m3r}'kerning'{cl{4qs5ku5ot5qs17sv5tv}201t{2ww4wy2yw}201w{2ks}201x{2ww4wy2yw}2k{201ts201xs}2w{7qs4qu5kw5os5qw5rs17su5tu7tsfzs}2x{5ow5qs}2y{7qs4qu5kw5os5qw5rs17su5tu7tsfzs}'fof'-6o7p{17su5tu5ot}ck{4qs5ku5ot5qs17sv5tv}4l{4qs5ku5ot5qs17sv5tv}cm{4qs5ku5ot5qs17sv5tv}cn{4qs5ku5ot5qs17sv5tv}co{4qs5ku5ot5qs17sv5tv}cp{4qs5ku5ot5qs17sv5tv}6l{17st5tt5os}17s{2kwclvcmvcnvcovcpv4lv4wwckv}5o{2kucltcmtcntcotcpt4lt4wtckt}5q{2ksclscmscnscoscps4ls4wvcks}5r{2ks4ws}5t{2kwclvcmvcnvcovcpv4lv4wwckv}eo{17st5tt5os}fu{17su5tu5ot}6p{17ss5ts}ek{17st5tt5os}el{17st5tt5os}em{17st5tt5os}en{17st5tt5os}6o{201ts}ep{17st5tt5os}es{17ss5ts}et{17ss5ts}eu{17ss5ts}ev{17ss5ts}6z{17su5tu5os5qt}fm{17su5tu5os5qt}fn{17su5tu5os5qt}fo{17su5tu5os5qt}fp{17su5tu5os5qt}fq{17su5tu5os5qt}fs{17su5tu5os5qt}ft{17su5tu5ot}7m{5os}fv{17su5tu5ot}fw{17su5tu5ot}}}"),Courier:l("{'widths'{k3w'fof'6o}'kerning'{'fof'-6o}}"),"Courier-BoldOblique":l("{'widths'{k3w'fof'6o}'kerning'{'fof'-6o}}"),"Times-Bold":l("{'widths'{k3q2q5ncx2r201n3m201o6o201s2l201t2l201u2l201w3m201x3m201y3m2k1t2l2l202m2n2n3m2o3m2p6o202q6o2r1w2s2l2t2l2u3m2v3t2w1t2x2l2y1t2z1w3k3m3l3m3m3m3n3m3o3m3p3m3q3m3r3m3s3m203t2l203u2l3v2l3w3t3x3t3y3t3z3m4k5x4l4s4m4m4n4s4o4s4p4m4q3x4r4y4s4y4t2r4u3m4v4y4w4m4x5y4y4s4z4y5k3x5l4y5m4s5n3r5o4m5p4s5q4s5r6o5s4s5t4s5u4m5v2l5w1w5x2l5y3u5z3m6k2l6l3m6m3r6n2w6o3r6p2w6q2l6r3m6s3r6t1w6u2l6v3r6w1w6x5n6y3r6z3m7k3r7l3r7m2w7n2r7o2l7p3r7q3m7r4s7s3m7t3m7u2w7v2r7w1q7x2r7y3o202l3mcl4sal2lam3man3mao3map3mar3mas2lat4uau1yav3maw3tay4uaz2lbk2sbl3t'fof'6obo2lbp3rbr1tbs2lbu2lbv3mbz3mck4s202k3mcm4scn4sco4scp4scq6ocr4scs4mct4mcu4mcv4mcw2r2m3rcy2rcz2rdl4sdm4ydn4ydo4ydp4ydq4yds4ydt4sdu4sdv4sdw4sdz3rek3mel3mem3men3meo3mep3meq4ser2wes2wet2weu2wev2wew1wex1wey1wez1wfl3rfm3mfn3mfo3mfp3mfq3mfr3tfs3mft3rfu3rfv3rfw3rfz3m203k6o212m6o2dw2l2cq2l3t3m3u2l17s4s19m3m}'kerning'{cl{4qt5ks5ot5qy5rw17sv5tv}201t{cks4lscmscnscoscpscls4wv}2k{201ts}2w{4qu5ku7mu5os5qx5ru17su5tu}2x{17su5tu5ou5qs}2y{4qv5kv7mu5ot5qz5ru17su5tu}'fof'-6o7t{cksclscmscnscoscps4ls}3u{17su5tu5os5qu}3v{17su5tu5os5qu}fu{17su5tu5ou5qu}7p{17su5tu5ou5qu}ck{4qt5ks5ot5qy5rw17sv5tv}4l{4qt5ks5ot5qy5rw17sv5tv}cm{4qt5ks5ot5qy5rw17sv5tv}cn{4qt5ks5ot5qy5rw17sv5tv}co{4qt5ks5ot5qy5rw17sv5tv}cp{4qt5ks5ot5qy5rw17sv5tv}6l{17st5tt5ou5qu}17s{ckuclucmucnucoucpu4lu4wu}5o{ckuclucmucnucoucpu4lu4wu}5q{ckzclzcmzcnzcozcpz4lz4wu}5r{ckxclxcmxcnxcoxcpx4lx4wu}5t{ckuclucmucnucoucpu4lu4wu}7q{ckuclucmucnucoucpu4lu}6p{17sw5tw5ou5qu}ek{17st5tt5qu}el{17st5tt5ou5qu}em{17st5tt5qu}en{17st5tt5qu}eo{17st5tt5qu}ep{17st5tt5ou5qu}es{17ss5ts5qu}et{17sw5tw5ou5qu}eu{17sw5tw5ou5qu}ev{17ss5ts5qu}6z{17sw5tw5ou5qu5rs}fm{17sw5tw5ou5qu5rs}fn{17sw5tw5ou5qu5rs}fo{17sw5tw5ou5qu5rs}fp{17sw5tw5ou5qu5rs}fq{17sw5tw5ou5qu5rs}7r{cktcltcmtcntcotcpt4lt5os}fs{17sw5tw5ou5qu5rs}ft{17su5tu5ou5qu}7m{5os}fv{17su5tu5ou5qu}fw{17su5tu5ou5qu}fz{cksclscmscnscoscps4ls}}}"),Symbol:l("{'widths'{k3uaw4r19m3m2k1t2l2l202m2y2n3m2p5n202q6o3k3m2s2l2t2l2v3r2w1t3m3m2y1t2z1wbk2sbl3r'fof'6o3n3m3o3m3p3m3q3m3r3m3s3m3t3m3u1w3v1w3w3r3x3r3y3r3z2wbp3t3l3m5v2l5x2l5z3m2q4yfr3r7v3k7w1o7x3k}'kerning'{'fof'-6o}}"),Helvetica:l("{'widths'{k3p2q4mcx1w201n3r201o6o201s1q201t1q201u1q201w2l201x2l201y2l2k1w2l1w202m2n2n3r2o3r2p5t202q6o2r1n2s2l2t2l2u2r2v3u2w1w2x2l2y1w2z1w3k3r3l3r3m3r3n3r3o3r3p3r3q3r3r3r3s3r203t2l203u2l3v1w3w3u3x3u3y3u3z3r4k6p4l4m4m4m4n4s4o4s4p4m4q3x4r4y4s4s4t1w4u3m4v4m4w3r4x5n4y4s4z4y5k4m5l4y5m4s5n4m5o3x5p4s5q4m5r5y5s4m5t4m5u3x5v1w5w1w5x1w5y2z5z3r6k2l6l3r6m3r6n3m6o3r6p3r6q1w6r3r6s3r6t1q6u1q6v3m6w1q6x5n6y3r6z3r7k3r7l3r7m2l7n3m7o1w7p3r7q3m7r4s7s3m7t3m7u3m7v2l7w1u7x2l7y3u202l3rcl4mal2lam3ran3rao3rap3rar3ras2lat4tau2pav3raw3uay4taz2lbk2sbl3u'fof'6obo2lbp3rbr1wbs2lbu2obv3rbz3xck4m202k3rcm4mcn4mco4mcp4mcq6ocr4scs4mct4mcu4mcv4mcw1w2m2ncy1wcz1wdl4sdm4ydn4ydo4ydp4ydq4yds4ydt4sdu4sdv4sdw4sdz3xek3rel3rem3ren3reo3rep3req5ter3mes3ret3reu3rev3rew1wex1wey1wez1wfl3rfm3rfn3rfo3rfp3rfq3rfr3ufs3xft3rfu3rfv3rfw3rfz3m203k6o212m6o2dw2l2cq2l3t3r3u1w17s4m19m3r}'kerning'{5q{4wv}cl{4qs5kw5ow5qs17sv5tv}201t{2wu4w1k2yu}201x{2wu4wy2yu}17s{2ktclucmucnu4otcpu4lu4wycoucku}2w{7qs4qz5k1m17sy5ow5qx5rsfsu5ty7tufzu}2x{17sy5ty5oy5qs}2y{7qs4qz5k1m17sy5ow5qx5rsfsu5ty7tufzu}'fof'-6o7p{17sv5tv5ow}ck{4qs5kw5ow5qs17sv5tv}4l{4qs5kw5ow5qs17sv5tv}cm{4qs5kw5ow5qs17sv5tv}cn{4qs5kw5ow5qs17sv5tv}co{4qs5kw5ow5qs17sv5tv}cp{4qs5kw5ow5qs17sv5tv}6l{17sy5ty5ow}do{17st5tt}4z{17st5tt}7s{fst}dm{17st5tt}dn{17st5tt}5o{ckwclwcmwcnwcowcpw4lw4wv}dp{17st5tt}dq{17st5tt}7t{5ow}ds{17st5tt}5t{2ktclucmucnu4otcpu4lu4wycoucku}fu{17sv5tv5ow}6p{17sy5ty5ow5qs}ek{17sy5ty5ow}el{17sy5ty5ow}em{17sy5ty5ow}en{5ty}eo{17sy5ty5ow}ep{17sy5ty5ow}es{17sy5ty5qs}et{17sy5ty5ow5qs}eu{17sy5ty5ow5qs}ev{17sy5ty5ow5qs}6z{17sy5ty5ow5qs}fm{17sy5ty5ow5qs}fn{17sy5ty5ow5qs}fo{17sy5ty5ow5qs}fp{17sy5ty5qs}fq{17sy5ty5ow5qs}7r{5ow}fs{17sy5ty5ow5qs}ft{17sv5tv5ow}7m{5ow}fv{17sv5tv5ow}fw{17sv5tv5ow}}}"),"Helvetica-BoldOblique":l("{'widths'{k3s2q4scx1w201n3r201o6o201s1w201t1w201u1w201w3m201x3m201y3m2k1w2l2l202m2n2n3r2o3r2p5t202q6o2r1s2s2l2t2l2u2r2v3u2w1w2x2l2y1w2z1w3k3r3l3r3m3r3n3r3o3r3p3r3q3r3r3r3s3r203t2l203u2l3v2l3w3u3x3u3y3u3z3x4k6l4l4s4m4s4n4s4o4s4p4m4q3x4r4y4s4s4t1w4u3r4v4s4w3x4x5n4y4s4z4y5k4m5l4y5m4s5n4m5o3x5p4s5q4m5r5y5s4m5t4m5u3x5v2l5w1w5x2l5y3u5z3r6k2l6l3r6m3x6n3r6o3x6p3r6q2l6r3x6s3x6t1w6u1w6v3r6w1w6x5t6y3x6z3x7k3x7l3x7m2r7n3r7o2l7p3x7q3r7r4y7s3r7t3r7u3m7v2r7w1w7x2r7y3u202l3rcl4sal2lam3ran3rao3rap3rar3ras2lat4tau2pav3raw3uay4taz2lbk2sbl3u'fof'6obo2lbp3xbq3rbr1wbs2lbu2obv3rbz3xck4s202k3rcm4scn4sco4scp4scq6ocr4scs4mct4mcu4mcv4mcw1w2m2zcy1wcz1wdl4sdm4ydn4ydo4ydp4ydq4yds4ydt4sdu4sdv4sdw4sdz3xek3rel3rem3ren3reo3rep3req5ter3res3ret3reu3rev3rew1wex1wey1wez1wfl3xfm3xfn3xfo3xfp3xfq3xfr3ufs3xft3xfu3xfv3xfw3xfz3r203k6o212m6o2dw2l2cq2l3t3r3u2l17s4m19m3r}'kerning'{cl{4qs5ku5ot5qs17sv5tv}201t{2ww4wy2yw}201w{2ks}201x{2ww4wy2yw}2k{201ts201xs}2w{7qs4qu5kw5os5qw5rs17su5tu7tsfzs}2x{5ow5qs}2y{7qs4qu5kw5os5qw5rs17su5tu7tsfzs}'fof'-6o7p{17su5tu5ot}ck{4qs5ku5ot5qs17sv5tv}4l{4qs5ku5ot5qs17sv5tv}cm{4qs5ku5ot5qs17sv5tv}cn{4qs5ku5ot5qs17sv5tv}co{4qs5ku5ot5qs17sv5tv}cp{4qs5ku5ot5qs17sv5tv}6l{17st5tt5os}17s{2kwclvcmvcnvcovcpv4lv4wwckv}5o{2kucltcmtcntcotcpt4lt4wtckt}5q{2ksclscmscnscoscps4ls4wvcks}5r{2ks4ws}5t{2kwclvcmvcnvcovcpv4lv4wwckv}eo{17st5tt5os}fu{17su5tu5ot}6p{17ss5ts}ek{17st5tt5os}el{17st5tt5os}em{17st5tt5os}en{17st5tt5os}6o{201ts}ep{17st5tt5os}es{17ss5ts}et{17ss5ts}eu{17ss5ts}ev{17ss5ts}6z{17su5tu5os5qt}fm{17su5tu5os5qt}fn{17su5tu5os5qt}fo{17su5tu5os5qt}fp{17su5tu5os5qt}fq{17su5tu5os5qt}fs{17su5tu5os5qt}ft{17su5tu5ot}7m{5os}fv{17su5tu5ot}fw{17su5tu5ot}}}"),ZapfDingbats:l("{'widths'{k4u2k1w'fof'6o}'kerning'{'fof'-6o}}"),"Courier-Bold":l("{'widths'{k3w'fof'6o}'kerning'{'fof'-6o}}"),"Times-Italic":l("{'widths'{k3n2q4ycx2l201n3m201o5t201s2l201t2l201u2l201w3r201x3r201y3r2k1t2l2l202m2n2n3m2o3m2p5n202q5t2r1p2s2l2t2l2u3m2v4n2w1t2x2l2y1t2z1w3k3m3l3m3m3m3n3m3o3m3p3m3q3m3r3m3s3m203t2l203u2l3v2l3w4n3x4n3y4n3z3m4k5w4l3x4m3x4n4m4o4s4p3x4q3x4r4s4s4s4t2l4u2w4v4m4w3r4x5n4y4m4z4s5k3x5l4s5m3x5n3m5o3r5p4s5q3x5r5n5s3x5t3r5u3r5v2r5w1w5x2r5y2u5z3m6k2l6l3m6m3m6n2w6o3m6p2w6q1w6r3m6s3m6t1w6u1w6v2w6w1w6x4s6y3m6z3m7k3m7l3m7m2r7n2r7o1w7p3m7q2w7r4m7s2w7t2w7u2r7v2s7w1v7x2s7y3q202l3mcl3xal2ram3man3mao3map3mar3mas2lat4wau1vav3maw4nay4waz2lbk2sbl4n'fof'6obo2lbp3mbq3obr1tbs2lbu1zbv3mbz3mck3x202k3mcm3xcn3xco3xcp3xcq5tcr4mcs3xct3xcu3xcv3xcw2l2m2ucy2lcz2ldl4mdm4sdn4sdo4sdp4sdq4sds4sdt4sdu4sdv4sdw4sdz3mek3mel3mem3men3meo3mep3meq4mer2wes2wet2weu2wev2wew1wex1wey1wez1wfl3mfm3mfn3mfo3mfp3mfq3mfr4nfs3mft3mfu3mfv3mfw3mfz2w203k6o212m6m2dw2l2cq2l3t3m3u2l17s3r19m3m}'kerning'{cl{5kt4qw}201s{201sw}201t{201tw2wy2yy6q-t}201x{2wy2yy}2k{201tw}2w{7qs4qy7rs5ky7mw5os5qx5ru17su5tu}2x{17ss5ts5os}2y{7qs4qy7rs5ky7mw5os5qx5ru17su5tu}'fof'-6o6t{17ss5ts5qs}7t{5os}3v{5qs}7p{17su5tu5qs}ck{5kt4qw}4l{5kt4qw}cm{5kt4qw}cn{5kt4qw}co{5kt4qw}cp{5kt4qw}6l{4qs5ks5ou5qw5ru17su5tu}17s{2ks}5q{ckvclvcmvcnvcovcpv4lv}5r{ckuclucmucnucoucpu4lu}5t{2ks}6p{4qs5ks5ou5qw5ru17su5tu}ek{4qs5ks5ou5qw5ru17su5tu}el{4qs5ks5ou5qw5ru17su5tu}em{4qs5ks5ou5qw5ru17su5tu}en{4qs5ks5ou5qw5ru17su5tu}eo{4qs5ks5ou5qw5ru17su5tu}ep{4qs5ks5ou5qw5ru17su5tu}es{5ks5qs4qs}et{4qs5ks5ou5qw5ru17su5tu}eu{4qs5ks5qw5ru17su5tu}ev{5ks5qs4qs}ex{17ss5ts5qs}6z{4qv5ks5ou5qw5ru17su5tu}fm{4qv5ks5ou5qw5ru17su5tu}fn{4qv5ks5ou5qw5ru17su5tu}fo{4qv5ks5ou5qw5ru17su5tu}fp{4qv5ks5ou5qw5ru17su5tu}fq{4qv5ks5ou5qw5ru17su5tu}7r{5os}fs{4qv5ks5ou5qw5ru17su5tu}ft{17su5tu5qs}fu{17su5tu5qs}fv{17su5tu5qs}fw{17su5tu5qs}}}"),"Times-Roman":l("{'widths'{k3n2q4ycx2l201n3m201o6o201s2l201t2l201u2l201w2w201x2w201y2w2k1t2l2l202m2n2n3m2o3m2p5n202q6o2r1m2s2l2t2l2u3m2v3s2w1t2x2l2y1t2z1w3k3m3l3m3m3m3n3m3o3m3p3m3q3m3r3m3s3m203t2l203u2l3v1w3w3s3x3s3y3s3z2w4k5w4l4s4m4m4n4m4o4s4p3x4q3r4r4s4s4s4t2l4u2r4v4s4w3x4x5t4y4s4z4s5k3r5l4s5m4m5n3r5o3x5p4s5q4s5r5y5s4s5t4s5u3x5v2l5w1w5x2l5y2z5z3m6k2l6l2w6m3m6n2w6o3m6p2w6q2l6r3m6s3m6t1w6u1w6v3m6w1w6x4y6y3m6z3m7k3m7l3m7m2l7n2r7o1w7p3m7q3m7r4s7s3m7t3m7u2w7v3k7w1o7x3k7y3q202l3mcl4sal2lam3man3mao3map3mar3mas2lat4wau1vav3maw3say4waz2lbk2sbl3s'fof'6obo2lbp3mbq2xbr1tbs2lbu1zbv3mbz2wck4s202k3mcm4scn4sco4scp4scq5tcr4mcs3xct3xcu3xcv3xcw2l2m2tcy2lcz2ldl4sdm4sdn4sdo4sdp4sdq4sds4sdt4sdu4sdv4sdw4sdz3mek2wel2wem2wen2weo2wep2weq4mer2wes2wet2weu2wev2wew1wex1wey1wez1wfl3mfm3mfn3mfo3mfp3mfq3mfr3sfs3mft3mfu3mfv3mfw3mfz3m203k6o212m6m2dw2l2cq2l3t3m3u1w17s4s19m3m}'kerning'{cl{4qs5ku17sw5ou5qy5rw201ss5tw201ws}201s{201ss}201t{ckw4lwcmwcnwcowcpwclw4wu201ts}2k{201ts}2w{4qs5kw5os5qx5ru17sx5tx}2x{17sw5tw5ou5qu}2y{4qs5kw5os5qx5ru17sx5tx}'fof'-6o7t{ckuclucmucnucoucpu4lu5os5rs}3u{17su5tu5qs}3v{17su5tu5qs}7p{17sw5tw5qs}ck{4qs5ku17sw5ou5qy5rw201ss5tw201ws}4l{4qs5ku17sw5ou5qy5rw201ss5tw201ws}cm{4qs5ku17sw5ou5qy5rw201ss5tw201ws}cn{4qs5ku17sw5ou5qy5rw201ss5tw201ws}co{4qs5ku17sw5ou5qy5rw201ss5tw201ws}cp{4qs5ku17sw5ou5qy5rw201ss5tw201ws}6l{17su5tu5os5qw5rs}17s{2ktclvcmvcnvcovcpv4lv4wuckv}5o{ckwclwcmwcnwcowcpw4lw4wu}5q{ckyclycmycnycoycpy4ly4wu5ms}5r{cktcltcmtcntcotcpt4lt4ws}5t{2ktclvcmvcnvcovcpv4lv4wuckv}7q{cksclscmscnscoscps4ls}6p{17su5tu5qw5rs}ek{5qs5rs}el{17su5tu5os5qw5rs}em{17su5tu5os5qs5rs}en{17su5qs5rs}eo{5qs5rs}ep{17su5tu5os5qw5rs}es{5qs}et{17su5tu5qw5rs}eu{17su5tu5qs5rs}ev{5qs}6z{17sv5tv5os5qx5rs}fm{5os5qt5rs}fn{17sv5tv5os5qx5rs}fo{17sv5tv5os5qx5rs}fp{5os5qt5rs}fq{5os5qt5rs}7r{ckuclucmucnucoucpu4lu5os}fs{17sv5tv5os5qx5rs}ft{17ss5ts5qs}fu{17sw5tw5qs}fv{17sw5tw5qs}fw{17ss5ts5qs}fz{ckuclucmucnucoucpu4lu5os5rs}}}"),"Helvetica-Oblique":l("{'widths'{k3p2q4mcx1w201n3r201o6o201s1q201t1q201u1q201w2l201x2l201y2l2k1w2l1w202m2n2n3r2o3r2p5t202q6o2r1n2s2l2t2l2u2r2v3u2w1w2x2l2y1w2z1w3k3r3l3r3m3r3n3r3o3r3p3r3q3r3r3r3s3r203t2l203u2l3v1w3w3u3x3u3y3u3z3r4k6p4l4m4m4m4n4s4o4s4p4m4q3x4r4y4s4s4t1w4u3m4v4m4w3r4x5n4y4s4z4y5k4m5l4y5m4s5n4m5o3x5p4s5q4m5r5y5s4m5t4m5u3x5v1w5w1w5x1w5y2z5z3r6k2l6l3r6m3r6n3m6o3r6p3r6q1w6r3r6s3r6t1q6u1q6v3m6w1q6x5n6y3r6z3r7k3r7l3r7m2l7n3m7o1w7p3r7q3m7r4s7s3m7t3m7u3m7v2l7w1u7x2l7y3u202l3rcl4mal2lam3ran3rao3rap3rar3ras2lat4tau2pav3raw3uay4taz2lbk2sbl3u'fof'6obo2lbp3rbr1wbs2lbu2obv3rbz3xck4m202k3rcm4mcn4mco4mcp4mcq6ocr4scs4mct4mcu4mcv4mcw1w2m2ncy1wcz1wdl4sdm4ydn4ydo4ydp4ydq4yds4ydt4sdu4sdv4sdw4sdz3xek3rel3rem3ren3reo3rep3req5ter3mes3ret3reu3rev3rew1wex1wey1wez1wfl3rfm3rfn3rfo3rfp3rfq3rfr3ufs3xft3rfu3rfv3rfw3rfz3m203k6o212m6o2dw2l2cq2l3t3r3u1w17s4m19m3r}'kerning'{5q{4wv}cl{4qs5kw5ow5qs17sv5tv}201t{2wu4w1k2yu}201x{2wu4wy2yu}17s{2ktclucmucnu4otcpu4lu4wycoucku}2w{7qs4qz5k1m17sy5ow5qx5rsfsu5ty7tufzu}2x{17sy5ty5oy5qs}2y{7qs4qz5k1m17sy5ow5qx5rsfsu5ty7tufzu}'fof'-6o7p{17sv5tv5ow}ck{4qs5kw5ow5qs17sv5tv}4l{4qs5kw5ow5qs17sv5tv}cm{4qs5kw5ow5qs17sv5tv}cn{4qs5kw5ow5qs17sv5tv}co{4qs5kw5ow5qs17sv5tv}cp{4qs5kw5ow5qs17sv5tv}6l{17sy5ty5ow}do{17st5tt}4z{17st5tt}7s{fst}dm{17st5tt}dn{17st5tt}5o{ckwclwcmwcnwcowcpw4lw4wv}dp{17st5tt}dq{17st5tt}7t{5ow}ds{17st5tt}5t{2ktclucmucnu4otcpu4lu4wycoucku}fu{17sv5tv5ow}6p{17sy5ty5ow5qs}ek{17sy5ty5ow}el{17sy5ty5ow}em{17sy5ty5ow}en{5ty}eo{17sy5ty5ow}ep{17sy5ty5ow}es{17sy5ty5qs}et{17sy5ty5ow5qs}eu{17sy5ty5ow5qs}ev{17sy5ty5ow5qs}6z{17sy5ty5ow5qs}fm{17sy5ty5ow5qs}fn{17sy5ty5ow5qs}fo{17sy5ty5ow5qs}fp{17sy5ty5qs}fq{17sy5ty5ow5qs}7r{5ow}fs{17sy5ty5ow5qs}ft{17sv5tv5ow}7m{5ow}fv{17sv5tv5ow}fw{17sv5tv5ow}}}")}};t.events.push(["addFont",function(p){var d=p.font,y=f.Unicode[d.postScriptName];y&&(d.metadata.Unicode={},d.metadata.Unicode.widths=y.widths,d.metadata.Unicode.kerning=y.kerning);var m=u.Unicode[d.postScriptName];m&&(d.metadata.Unicode.encoding=m,d.encoding=m.codePages[0])}])})(Ut.API),(function(t){var e=function(n){for(var i=n.length,r=new Uint8Array(i),s=0;s<i;s++)r[s]=n.charCodeAt(s);return r};t.API.events.push(["addFont",function(n){var i=void 0,r=n.font,s=n.instance;if(!r.isStandardFont){if(s===void 0)throw new Error("Font does not exist in vFS, import fonts or remove declaration doc.addFont('"+r.postScriptName+"').");if(typeof(i=s.existsFileInVFS(r.postScriptName)===!1?s.loadFile(r.postScriptName):s.getFileFromVFS(r.postScriptName))!="string")throw new Error("Font is not stored as string-data in vFS, import fonts or remove declaration doc.addFont('"+r.postScriptName+"').");(function(a,o){o=/^\x00\x01\x00\x00/.test(o)?e(o):e(mh(o)),a.metadata=t.API.TTFFont.open(o),a.metadata.Unicode=a.metadata.Unicode||{encoding:{},kerning:{},widths:[]},a.metadata.glyIdsUsed=[0]})(r,i)}}])})(Ut),Ut.API.addSvgAsImage=function(t,e,n,i,r,s,a,o){if(isNaN(e)||isNaN(n))throw ni.error("jsPDF.addSvgAsImage: Invalid coordinates",arguments),new Error("Invalid coordinates passed to jsPDF.addSvgAsImage");if(isNaN(i)||isNaN(r))throw ni.error("jsPDF.addSvgAsImage: Invalid measurements",arguments),new Error("Invalid measurements (width and/or height) passed to jsPDF.addSvgAsImage");var l=document.createElement("canvas");l.width=i,l.height=r;var c=l.getContext("2d");c.fillStyle="#fff",c.fillRect(0,0,l.width,l.height);var u={ignoreMouse:!0,ignoreAnimation:!0,ignoreDimensions:!0},f=this;return(an.canvg?Promise.resolve(an.canvg):hs(()=>import("./D2buxWpW.js"),[],import.meta.url)).catch(function(p){return Promise.reject(new Error("Could not load canvg: "+p))}).then(function(p){return p.default?p.default:p}).then(function(p){return p.fromString(c,t,u)},function(){return Promise.reject(new Error("Could not load canvg."))}).then(function(p){return p.render(u)}).then(function(){f.addImage(l.toDataURL("image/jpeg",1),e,n,i,r,a,o)})},Ut.API.putTotalPages=function(t){var e,n=0;parseInt(this.internal.getFont().id.substr(1),10)<15?(e=new RegExp(t,"g"),n=this.internal.getNumberOfPages()):(e=new RegExp(this.pdfEscape16(t,this.internal.getFont()),"g"),n=this.pdfEscape16(this.internal.getNumberOfPages()+"",this.internal.getFont()));for(var i=1;i<=this.internal.getNumberOfPages();i++)for(var r=0;r<this.internal.pages[i].length;r++)this.internal.pages[i][r]=this.internal.pages[i][r].replace(e,n);return this},Ut.API.viewerPreferences=function(t,e){var n;t=t||{},e=e||!1;var i,r,s,a={HideToolbar:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.3},HideMenubar:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.3},HideWindowUI:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.3},FitWindow:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.3},CenterWindow:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.3},DisplayDocTitle:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.4},NonFullScreenPageMode:{defaultValue:"UseNone",value:"UseNone",type:"name",explicitSet:!1,valueSet:["UseNone","UseOutlines","UseThumbs","UseOC"],pdfVersion:1.3},Direction:{defaultValue:"L2R",value:"L2R",type:"name",explicitSet:!1,valueSet:["L2R","R2L"],pdfVersion:1.3},ViewArea:{defaultValue:"CropBox",value:"CropBox",type:"name",explicitSet:!1,valueSet:["MediaBox","CropBox","TrimBox","BleedBox","ArtBox"],pdfVersion:1.4},ViewClip:{defaultValue:"CropBox",value:"CropBox",type:"name",explicitSet:!1,valueSet:["MediaBox","CropBox","TrimBox","BleedBox","ArtBox"],pdfVersion:1.4},PrintArea:{defaultValue:"CropBox",value:"CropBox",type:"name",explicitSet:!1,valueSet:["MediaBox","CropBox","TrimBox","BleedBox","ArtBox"],pdfVersion:1.4},PrintClip:{defaultValue:"CropBox",value:"CropBox",type:"name",explicitSet:!1,valueSet:["MediaBox","CropBox","TrimBox","BleedBox","ArtBox"],pdfVersion:1.4},PrintScaling:{defaultValue:"AppDefault",value:"AppDefault",type:"name",explicitSet:!1,valueSet:["AppDefault","None"],pdfVersion:1.6},Duplex:{defaultValue:"",value:"none",type:"name",explicitSet:!1,valueSet:["Simplex","DuplexFlipShortEdge","DuplexFlipLongEdge","none"],pdfVersion:1.7},PickTrayByPDFSize:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.7},PrintPageRange:{defaultValue:"",value:"",type:"array",explicitSet:!1,valueSet:null,pdfVersion:1.7},NumCopies:{defaultValue:1,value:1,type:"integer",explicitSet:!1,valueSet:null,pdfVersion:1.7}},o=Object.keys(a),l=[],c=0,u=0,f=0;function p(y,m){var w,b=!1;for(w=0;w<y.length;w+=1)y[w]===m&&(b=!0);return b}if(this.internal.viewerpreferences===void 0&&(this.internal.viewerpreferences={},this.internal.viewerpreferences.configuration=JSON.parse(JSON.stringify(a)),this.internal.viewerpreferences.isSubscribed=!1),n=this.internal.viewerpreferences.configuration,t==="reset"||e===!0){var d=o.length;for(f=0;f<d;f+=1)n[o[f]].value=n[o[f]].defaultValue,n[o[f]].explicitSet=!1}if(Un(t)==="object"){for(r in t)if(s=t[r],p(o,r)&&s!==void 0){if(n[r].type==="boolean"&&typeof s=="boolean")n[r].value=s;else if(n[r].type==="name"&&p(n[r].valueSet,s))n[r].value=s;else if(n[r].type==="integer"&&Number.isInteger(s))n[r].value=s;else if(n[r].type==="array"){for(c=0;c<s.length;c+=1)if(i=!0,s[c].length===1&&typeof s[c][0]=="number")l.push(String(s[c]-1));else if(s[c].length>1){for(u=0;u<s[c].length;u+=1)typeof s[c][u]!="number"&&(i=!1);i===!0&&l.push([s[c][0]-1,s[c][1]-1].join(" "))}n[r].value="["+l.join(" ")+"]"}else n[r].value=n[r].defaultValue;n[r].explicitSet=!0}}return this.internal.viewerpreferences.isSubscribed===!1&&(this.internal.events.subscribe("putCatalog",function(){var y,m=[];for(y in n)n[y].explicitSet===!0&&(n[y].type==="name"?m.push("/"+y+" /"+n[y].value):m.push("/"+y+" "+n[y].value));m.length!==0&&this.internal.write(`/ViewerPreferences
<<
`+m.join(`
`)+`
>>`)}),this.internal.viewerpreferences.isSubscribed=!0),this.internal.viewerpreferences.configuration=n,this},Ut.API.addMetadata=function(t,e){return this.internal.__metadata__===void 0&&(this.internal.__metadata__={metadata:t,namespaceUri:e??"http://jspdf.default.namespaceuri/",rawXml:typeof e=="boolean"&&e},this.internal.events.subscribe("putCatalog",FF),this.internal.events.subscribe("postPutResources",OF)),this},(function(t){var e=t.API,n=e.pdfEscape16=function(s,a){for(var o,l=a.metadata.Unicode.widths,c=["","0","00","000","0000"],u=[""],f=0,p=s.length;f<p;++f){if(o=a.metadata.characterToGlyph(s.charCodeAt(f)),a.metadata.glyIdsUsed.push(o),a.metadata.toUnicode[o]=s.charCodeAt(f),l.indexOf(o)==-1&&(l.push(o),l.push([parseInt(a.metadata.widthOfGlyph(o),10)])),o=="0")return u.join("");o=o.toString(16),u.push(c[4-o.length],o)}return u.join("")},i=function(s){var a,o,l,c,u,f,p;for(u=`/CIDInit /ProcSet findresource begin
12 dict begin
begincmap
/CIDSystemInfo <<
  /Registry (Adobe)
  /Ordering (UCS)
  /Supplement 0
>> def
/CMapName /Adobe-Identity-UCS def
/CMapType 2 def
1 begincodespacerange
<0000><ffff>
endcodespacerange`,l=[],f=0,p=(o=Object.keys(s).sort(function(d,y){return d-y})).length;f<p;f++)a=o[f],l.length>=100&&(u+=`
`+l.length+` beginbfchar
`+l.join(`
`)+`
endbfchar`,l=[]),s[a]!==void 0&&s[a]!==null&&typeof s[a].toString=="function"&&(c=("0000"+s[a].toString(16)).slice(-4),a=("0000"+(+a).toString(16)).slice(-4),l.push("<"+a+"><"+c+">"));return l.length&&(u+=`
`+l.length+` beginbfchar
`+l.join(`
`)+`
endbfchar
`),u+`endcmap
CMapName currentdict /CMap defineresource pop
end
end`};e.events.push(["putFont",function(s){(function(a){var o=a.font,l=a.out,c=a.newObject,u=a.putStream;if(o.metadata instanceof t.API.TTFFont&&o.encoding==="Identity-H"){for(var f=o.metadata.Unicode.widths,p=o.metadata.subset.encode(o.metadata.glyIdsUsed,1),d="",y=0;y<p.length;y++)d+=String.fromCharCode(p[y]);var m=c();u({data:d,addLength1:!0,objectId:m}),l("endobj");var w=c();u({data:i(o.metadata.toUnicode),addLength1:!0,objectId:w}),l("endobj");var b=c();l("<<"),l("/Type /FontDescriptor"),l("/FontName /"+du(o.fontName)),l("/FontFile2 "+m+" 0 R"),l("/FontBBox "+t.API.PDFObject.convert(o.metadata.bbox)),l("/Flags "+o.metadata.flags),l("/StemV "+o.metadata.stemV),l("/ItalicAngle "+o.metadata.italicAngle),l("/Ascent "+o.metadata.ascender),l("/Descent "+o.metadata.decender),l("/CapHeight "+o.metadata.capHeight),l(">>"),l("endobj");var S=c();l("<<"),l("/Type /Font"),l("/BaseFont /"+du(o.fontName)),l("/FontDescriptor "+b+" 0 R"),l("/W "+t.API.PDFObject.convert(f)),l("/CIDToGIDMap /Identity"),l("/DW 1000"),l("/Subtype /CIDFontType2"),l("/CIDSystemInfo"),l("<<"),l("/Supplement 0"),l("/Registry (Adobe)"),l("/Ordering ("+o.encoding+")"),l(">>"),l(">>"),l("endobj"),o.objectNumber=c(),l("<<"),l("/Type /Font"),l("/Subtype /Type0"),l("/ToUnicode "+w+" 0 R"),l("/BaseFont /"+du(o.fontName)),l("/Encoding /"+o.encoding),l("/DescendantFonts ["+S+" 0 R]"),l(">>"),l("endobj"),o.isAlreadyPutted=!0}})(s)}]),e.events.push(["putFont",function(s){(function(a){var o=a.font,l=a.out,c=a.newObject,u=a.putStream;if(o.metadata instanceof t.API.TTFFont&&o.encoding==="WinAnsiEncoding"){for(var f=o.metadata.rawData,p="",d=0;d<f.length;d++)p+=String.fromCharCode(f[d]);var y=c();u({data:p,addLength1:!0,objectId:y}),l("endobj");var m=c();u({data:i(o.metadata.toUnicode),addLength1:!0,objectId:m}),l("endobj");var w=c();l("<<"),l("/Descent "+o.metadata.decender),l("/CapHeight "+o.metadata.capHeight),l("/StemV "+o.metadata.stemV),l("/Type /FontDescriptor"),l("/FontFile2 "+y+" 0 R"),l("/Flags 96"),l("/FontBBox "+t.API.PDFObject.convert(o.metadata.bbox)),l("/FontName /"+du(o.fontName)),l("/ItalicAngle "+o.metadata.italicAngle),l("/Ascent "+o.metadata.ascender),l(">>"),l("endobj"),o.objectNumber=c();for(var b=0;b<o.metadata.hmtx.widths.length;b++)o.metadata.hmtx.widths[b]=parseInt(o.metadata.hmtx.widths[b]*(1e3/o.metadata.head.unitsPerEm));l("<</Subtype/TrueType/Type/Font/ToUnicode "+m+" 0 R/BaseFont/"+du(o.fontName)+"/FontDescriptor "+w+" 0 R/Encoding/"+o.encoding+" /FirstChar 29 /LastChar 255 /Widths "+t.API.PDFObject.convert(o.metadata.hmtx.widths)+">>"),l("endobj"),o.isAlreadyPutted=!0}})(s)}]);var r=function(s){var a,o=s.text||"",l=s.x,c=s.y,u=s.options||{},f=s.mutex||{},p=f.pdfEscape,d=f.activeFontKey,y=f.fonts,m=d,w="",b=0,S="",A=y[m].encoding;if(y[m].encoding!=="Identity-H")return{text:o,x:l,y:c,options:u,mutex:f};for(S=o,m=d,Array.isArray(o)&&(S=o[0]),b=0;b<S.length;b+=1)y[m].metadata.hasOwnProperty("cmap")&&(a=y[m].metadata.cmap.unicode.codeMap[S[b].charCodeAt(0)]),a||S[b].charCodeAt(0)<256&&y[m].metadata.hasOwnProperty("Unicode")?w+=S[b]:w+="";var _="";return parseInt(m.slice(1))<14||A==="WinAnsiEncoding"?_=p(w,m).split("").map(function(I){return I.charCodeAt(0).toString(16)}).join(""):A==="Identity-H"&&(_=n(w,y[m])),f.isHex=!0,{text:_,x:l,y:c,options:u,mutex:f}};e.events.push(["postProcessText",function(s){var a=s.text||"",o=[],l={text:a,x:s.x,y:s.y,options:s.options,mutex:s.mutex};if(Array.isArray(a)){var c=0;for(c=0;c<a.length;c+=1)Array.isArray(a[c])&&a[c].length===3?o.push([r(Object.assign({},l,{text:a[c][0]})).text,a[c][1],a[c][2]]):o.push(r(Object.assign({},l,{text:a[c]})).text);s.text=o}else s.text=r(Object.assign({},l,{text:a})).text}])})(Ut),(function(t){var e=function(){return this.internal.vFS===void 0&&(this.internal.vFS={}),!0};t.existsFileInVFS=function(n){return e.call(this),this.internal.vFS[n]!==void 0},t.addFileToVFS=function(n,i){return e.call(this),this.internal.vFS[n]=i,this},t.getFileFromVFS=function(n){return e.call(this),this.internal.vFS[n]!==void 0?this.internal.vFS[n]:null}})(Ut.API),(function(t){t.__bidiEngine__=t.prototype.__bidiEngine__=function(i){var r,s,a,o,l,c,u,f=e,p=[[0,3,0,1,0,0,0],[0,3,0,1,2,2,0],[0,3,0,17,2,0,1],[0,3,5,5,4,1,0],[0,3,21,21,4,0,1],[0,3,5,5,4,2,0]],d=[[2,0,1,1,0,1,0],[2,0,1,1,0,2,0],[2,0,2,1,3,2,0],[2,0,2,33,3,1,1]],y={L:0,R:1,EN:2,AN:3,N:4,B:5,S:6},m={0:0,5:1,6:2,7:3,32:4,251:5,254:6,255:7},w=["(",")","(","<",">","<","[","]","[","{","}","{","Â«","Â»","Â«","â¹","âº","â¹","â","â","â","â½","â¾","â½","â","â","â","â¤","â¥","â¤","â©","âª","â©","ï¹","ï¹","ï¹","ï¹","ï¹","ï¹","ï¹","ï¹","ï¹","ï¹¤","ï¹¥","ï¹¤"],b=new RegExp(/^([1-4|9]|1[0-9]|2[0-9]|3[0168]|4[04589]|5[012]|7[78]|159|16[0-9]|17[0-2]|21[569]|22[03489]|250)$/),S=!1,A=0;this.__bidiEngine__={};var _=function(C){var N=C.charCodeAt(),B=N>>8,P=m[B];return P!==void 0?f[256*P+(255&N)]:B===252||B===253?"AL":b.test(B)?"L":B===8?"R":"N"},I=function(C){for(var N,B=0;B<C.length;B++){if((N=_(C.charAt(B)))==="L")return!1;if(N==="R")return!0}return!1},E=function(C,N,B,P){var F,q,Z,W,Y=N[P];switch(Y){case"L":case"R":case"LRE":case"RLE":case"LRO":case"RLO":case"PDF":S=!1;break;case"N":case"AN":break;case"EN":S&&(Y="AN");break;case"AL":S=!0,Y="R";break;case"WS":case"BN":Y="N";break;case"CS":P<1||P+1>=N.length||(F=B[P-1])!=="EN"&&F!=="AN"||(q=N[P+1])!=="EN"&&q!=="AN"?Y="N":S&&(q="AN"),Y=q===F?q:"N";break;case"ES":Y=(F=P>0?B[P-1]:"B")==="EN"&&P+1<N.length&&N[P+1]==="EN"?"EN":"N";break;case"ET":if(P>0&&B[P-1]==="EN"){Y="EN";break}if(S){Y="N";break}for(Z=P+1,W=N.length;Z<W&&N[Z]==="ET";)Z++;Y=Z<W&&N[Z]==="EN"?"EN":"N";break;case"NSM":if(a&&!o){for(W=N.length,Z=P+1;Z<W&&N[Z]==="NSM";)Z++;if(Z<W){var ue=C[P],le=ue>=1425&&ue<=2303||ue===64286;if(F=N[Z],le&&(F==="R"||F==="AL")){Y="R";break}}}Y=P<1||(F=N[P-1])==="B"?"N":B[P-1];break;case"B":S=!1,r=!0,Y=A;break;case"S":s=!0,Y="N"}return Y},M=function(C,N,B){var P=C.split("");return B&&T(P,B,{hiLevel:A}),P.reverse(),N&&N.reverse(),P.join("")},T=function(C,N,B){var P,F,q,Z,W,Y=-1,ue=C.length,le=0,O=[],V=A?d:p,G=[];for(S=!1,r=!1,s=!1,F=0;F<ue;F++)G[F]=_(C[F]);for(q=0;q<ue;q++){if(W=le,O[q]=E(C,G,O,q),P=240&(le=V[W][y[O[q]]]),le&=15,N[q]=Z=V[le][5],P>0)if(P===16){for(F=Y;F<q;F++)N[F]=1;Y=-1}else Y=-1;if(V[le][6])Y===-1&&(Y=q);else if(Y>-1){for(F=Y;F<q;F++)N[F]=Z;Y=-1}G[q]==="B"&&(N[q]=0),B.hiLevel|=Z}s&&(function(re,ae,ee){for(var de=0;de<ee;de++)if(re[de]==="S"){ae[de]=A;for(var he=de-1;he>=0&&re[he]==="WS";he--)ae[he]=A}})(G,N,ue)},D=function(C,N,B,P,F){if(!(F.hiLevel<C)){if(C===1&&A===1&&!r)return N.reverse(),void(B&&B.reverse());for(var q,Z,W,Y,ue=N.length,le=0;le<ue;){if(P[le]>=C){for(W=le+1;W<ue&&P[W]>=C;)W++;for(Y=le,Z=W-1;Y<Z;Y++,Z--)q=N[Y],N[Y]=N[Z],N[Z]=q,B&&(q=B[Y],B[Y]=B[Z],B[Z]=q);le=W}le++}}},U=function(C,N,B){var P=C.split(""),F={hiLevel:A};return B||(B=[]),T(P,B,F),(function(q,Z,W){if(W.hiLevel!==0&&u)for(var Y,ue=0;ue<q.length;ue++)Z[ue]===1&&(Y=w.indexOf(q[ue]))>=0&&(q[ue]=w[Y+1])})(P,B,F),D(2,P,N,B,F),D(1,P,N,B,F),P.join("")};return this.__bidiEngine__.doBidiReorder=function(C,N,B){if((function(F,q){if(q)for(var Z=0;Z<F.length;Z++)q[Z]=Z;o===void 0&&(o=I(F)),c===void 0&&(c=I(F))})(C,N),a||!l||c)if(a&&l&&o^c)A=o?1:0,C=M(C,N,B);else if(!a&&l&&c)A=o?1:0,C=U(C,N,B),C=M(C,N);else if(!a||o||l||c){if(a&&!l&&o^c)C=M(C,N),o?(A=0,C=U(C,N,B)):(A=1,C=U(C,N,B),C=M(C,N));else if(a&&o&&!l&&c)A=1,C=U(C,N,B),C=M(C,N);else if(!a&&!l&&o^c){var P=u;o?(A=1,C=U(C,N,B),A=0,u=!1,C=U(C,N,B),u=P):(A=0,C=U(C,N,B),C=M(C,N),A=1,u=!1,C=U(C,N,B),u=P,C=M(C,N))}}else A=0,C=U(C,N,B);else A=o?1:0,C=U(C,N,B);return C},this.__bidiEngine__.setOptions=function(C){C&&(a=C.isInputVisual,l=C.isOutputVisual,o=C.isInputRtl,c=C.isOutputRtl,u=C.isSymmetricSwapping)},this.__bidiEngine__.setOptions(i),this.__bidiEngine__};var e=["BN","BN","BN","BN","BN","BN","BN","BN","BN","S","B","S","WS","B","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","B","B","B","S","WS","N","N","ET","ET","ET","N","N","N","N","N","ES","CS","ES","CS","CS","EN","EN","EN","EN","EN","EN","EN","EN","EN","EN","CS","N","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","N","BN","BN","BN","BN","BN","BN","B","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","CS","N","ET","ET","ET","ET","N","N","N","N","L","N","N","BN","N","N","ET","ET","EN","EN","N","L","N","N","N","EN","L","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","L","L","L","L","L","L","L","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","L","N","N","N","N","N","ET","N","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","R","NSM","R","NSM","NSM","R","NSM","NSM","R","NSM","N","N","N","N","N","N","N","N","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","N","N","N","N","N","R","R","R","R","R","N","N","N","N","N","N","N","N","N","N","N","AN","AN","AN","AN","AN","AN","N","N","AL","ET","ET","AL","CS","AL","N","N","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","AL","AL","N","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","AN","AN","AN","AN","AN","AN","AN","AN","AN","AN","ET","AN","AN","AL","AL","AL","NSM","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","NSM","NSM","NSM","NSM","NSM","NSM","NSM","AN","N","NSM","NSM","NSM","NSM","NSM","NSM","AL","AL","NSM","NSM","N","NSM","NSM","NSM","NSM","AL","AL","EN","EN","EN","EN","EN","EN","EN","EN","EN","EN","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","N","AL","AL","NSM","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","N","N","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","AL","N","N","N","N","N","N","N","N","N","N","N","N","N","N","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","R","R","N","N","N","N","R","N","N","N","N","N","WS","WS","WS","WS","WS","WS","WS","WS","WS","WS","WS","BN","BN","BN","L","R","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","WS","B","LRE","RLE","PDF","LRO","RLO","CS","ET","ET","ET","ET","ET","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","CS","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","WS","BN","BN","BN","BN","BN","N","LRI","RLI","FSI","PDI","BN","BN","BN","BN","BN","BN","EN","L","N","N","EN","EN","EN","EN","EN","EN","ES","ES","N","N","N","L","EN","EN","EN","EN","EN","EN","EN","EN","EN","EN","ES","ES","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","L","L","L","L","L","L","L","N","N","N","N","N","N","N","N","N","N","N","N","L","L","L","L","L","N","N","N","N","N","R","NSM","R","R","R","R","R","R","R","R","R","R","ES","R","R","R","R","R","R","R","R","R","R","R","R","R","N","R","R","R","R","R","N","R","N","R","R","N","R","R","N","R","R","R","R","R","R","R","R","R","R","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","CS","N","CS","N","N","CS","N","N","N","N","N","N","N","N","N","ET","N","N","ES","ES","N","N","N","N","N","ET","ET","N","N","N","N","N","AL","AL","AL","AL","AL","N","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","N","N","BN","N","N","N","ET","ET","ET","N","N","N","N","N","ES","CS","ES","CS","CS","EN","EN","EN","EN","EN","EN","EN","EN","EN","EN","CS","N","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","N","N","N","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","L","L","L","L","L","L","N","N","L","L","L","L","L","L","N","N","L","L","L","L","L","L","N","N","L","L","L","N","N","N","ET","ET","N","N","N","ET","ET","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N"],n=new t.__bidiEngine__({isInputVisual:!0});t.API.events.push(["postProcessText",function(i){var r=i.text;i.x,i.y;var s=i.options||{};i.mutex,s.lang;var a=[];if(s.isInputVisual=typeof s.isInputVisual!="boolean"||s.isInputVisual,n.setOptions(s),Object.prototype.toString.call(r)==="[object Array]"){var o=0;for(a=[],o=0;o<r.length;o+=1)Object.prototype.toString.call(r[o])==="[object Array]"?a.push([n.doBidiReorder(r[o][0]),r[o][1],r[o][2]]):a.push([n.doBidiReorder(r[o])]);i.text=a}else i.text=n.doBidiReorder(r);n.setOptions({isInputVisual:!0})}])})(Ut),Ut.API.TTFFont=(function(){function t(e){var n;if(this.rawData=e,n=this.contents=new Yl(e),this.contents.pos=4,n.readString(4)==="ttcf")throw new Error("TTCF not supported.");n.pos=0,this.parse(),this.subset=new JF(this),this.registerTTF()}return t.open=function(e){return new t(e)},t.prototype.parse=function(){return this.directory=new RF(this.contents),this.head=new zF(this),this.name=new WF(this),this.cmap=new h_(this),this.toUnicode={},this.hhea=new qF(this),this.maxp=new VF(this),this.hmtx=new GF(this),this.post=new HF(this),this.os2=new jF(this),this.loca=new ZF(this),this.glyf=new XF(this),this.ascender=this.os2.exists&&this.os2.ascender||this.hhea.ascender,this.decender=this.os2.exists&&this.os2.decender||this.hhea.decender,this.lineGap=this.os2.exists&&this.os2.lineGap||this.hhea.lineGap,this.bbox=[this.head.xMin,this.head.yMin,this.head.xMax,this.head.yMax]},t.prototype.registerTTF=function(){var e,n,i,r,s;if(this.scaleFactor=1e3/this.head.unitsPerEm,this.bbox=(function(){var a,o,l,c;for(c=[],a=0,o=(l=this.bbox).length;a<o;a++)e=l[a],c.push(Math.round(e*this.scaleFactor));return c}).call(this),this.stemV=0,this.post.exists?(i=255&(r=this.post.italic_angle),32768&(n=r>>16)&&(n=-(1+(65535^n))),this.italicAngle=+(n+"."+i)):this.italicAngle=0,this.ascender=Math.round(this.ascender*this.scaleFactor),this.decender=Math.round(this.decender*this.scaleFactor),this.lineGap=Math.round(this.lineGap*this.scaleFactor),this.capHeight=this.os2.exists&&this.os2.capHeight||this.ascender,this.xHeight=this.os2.exists&&this.os2.xHeight||0,this.familyClass=(this.os2.exists&&this.os2.familyClass||0)>>8,this.isSerif=(s=this.familyClass)===1||s===2||s===3||s===4||s===5||s===7,this.isScript=this.familyClass===10,this.flags=0,this.post.isFixedPitch&&(this.flags|=1),this.isSerif&&(this.flags|=2),this.isScript&&(this.flags|=8),this.italicAngle!==0&&(this.flags|=64),this.flags|=32,!this.cmap.unicode)throw new Error("No unicode cmap for font")},t.prototype.characterToGlyph=function(e){var n;return((n=this.cmap.unicode)!=null?n.codeMap[e]:void 0)||0},t.prototype.widthOfGlyph=function(e){var n;return n=1e3/this.head.unitsPerEm,this.hmtx.forGlyph(e).advance*n},t.prototype.widthOfString=function(e,n,i){var r,s,a,o;for(a=0,s=0,o=(e=""+e).length;0<=o?s<o:s>o;s=0<=o?++s:--s)r=e.charCodeAt(s),a+=this.widthOfGlyph(this.characterToGlyph(r))+i*(1e3/n)||0;return a*(n/1e3)},t.prototype.lineHeight=function(e,n){var i;return n==null&&(n=!1),i=n?this.lineGap:0,(this.ascender+i-this.decender)/1e3*e},t})();var Ra,Yl=(function(){function t(e){this.data=e??[],this.pos=0,this.length=this.data.length}return t.prototype.readByte=function(){return this.data[this.pos++]},t.prototype.writeByte=function(e){return this.data[this.pos++]=e},t.prototype.readUInt32=function(){return 16777216*this.readByte()+(this.readByte()<<16)+(this.readByte()<<8)+this.readByte()},t.prototype.writeUInt32=function(e){return this.writeByte(e>>>24&255),this.writeByte(e>>16&255),this.writeByte(e>>8&255),this.writeByte(255&e)},t.prototype.readInt32=function(){var e;return(e=this.readUInt32())>=2147483648?e-4294967296:e},t.prototype.writeInt32=function(e){return e<0&&(e+=4294967296),this.writeUInt32(e)},t.prototype.readUInt16=function(){return this.readByte()<<8|this.readByte()},t.prototype.writeUInt16=function(e){return this.writeByte(e>>8&255),this.writeByte(255&e)},t.prototype.readInt16=function(){var e;return(e=this.readUInt16())>=32768?e-65536:e},t.prototype.writeInt16=function(e){return e<0&&(e+=65536),this.writeUInt16(e)},t.prototype.readString=function(e){var n,i;for(i=[],n=0;0<=e?n<e:n>e;n=0<=e?++n:--n)i[n]=String.fromCharCode(this.readByte());return i.join("")},t.prototype.writeString=function(e){var n,i,r;for(r=[],n=0,i=e.length;0<=i?n<i:n>i;n=0<=i?++n:--n)r.push(this.writeByte(e.charCodeAt(n)));return r},t.prototype.readShort=function(){return this.readInt16()},t.prototype.writeShort=function(e){return this.writeInt16(e)},t.prototype.readLongLong=function(){var e,n,i,r,s,a,o,l;return e=this.readByte(),n=this.readByte(),i=this.readByte(),r=this.readByte(),s=this.readByte(),a=this.readByte(),o=this.readByte(),l=this.readByte(),128&e?-1*(72057594037927940*(255^e)+281474976710656*(255^n)+1099511627776*(255^i)+4294967296*(255^r)+16777216*(255^s)+65536*(255^a)+256*(255^o)+(255^l)+1):72057594037927940*e+281474976710656*n+1099511627776*i+4294967296*r+16777216*s+65536*a+256*o+l},t.prototype.writeLongLong=function(e){var n,i;return n=Math.floor(e/4294967296),i=4294967295&e,this.writeByte(n>>24&255),this.writeByte(n>>16&255),this.writeByte(n>>8&255),this.writeByte(255&n),this.writeByte(i>>24&255),this.writeByte(i>>16&255),this.writeByte(i>>8&255),this.writeByte(255&i)},t.prototype.readInt=function(){return this.readInt32()},t.prototype.writeInt=function(e){return this.writeInt32(e)},t.prototype.read=function(e){var n,i;for(n=[],i=0;0<=e?i<e:i>e;i=0<=e?++i:--i)n.push(this.readByte());return n},t.prototype.write=function(e){var n,i,r,s;for(s=[],i=0,r=e.length;i<r;i++)n=e[i],s.push(this.writeByte(n));return s},t})(),RF=(function(){var t;function e(n){var i,r,s;for(this.scalarType=n.readInt(),this.tableCount=n.readShort(),this.searchRange=n.readShort(),this.entrySelector=n.readShort(),this.rangeShift=n.readShort(),this.tables={},r=0,s=this.tableCount;0<=s?r<s:r>s;r=0<=s?++r:--r)i={tag:n.readString(4),checksum:n.readInt(),offset:n.readInt(),length:n.readInt()},this.tables[i.tag]=i}return e.prototype.encode=function(n){var i,r,s,a,o,l,c,u,f,p,d,y,m;for(m in d=Object.keys(n).length,l=Math.log(2),f=16*Math.floor(Math.log(d)/l),a=Math.floor(f/l),u=16*d-f,(r=new Yl).writeInt(this.scalarType),r.writeShort(d),r.writeShort(f),r.writeShort(a),r.writeShort(u),s=16*d,c=r.pos+s,o=null,y=[],n)for(p=n[m],r.writeString(m),r.writeInt(t(p)),r.writeInt(c),r.writeInt(p.length),y=y.concat(p),m==="head"&&(o=c),c+=p.length;c%4;)y.push(0),c++;return r.write(y),i=2981146554-t(r.data),r.pos=o+8,r.writeUInt32(i),r.data},t=function(n){var i,r,s,a;for(n=p_.call(n);n.length%4;)n.push(0);for(s=new Yl(n),r=0,i=0,a=n.length;i<a;i=i+=4)r+=s.readUInt32();return 4294967295&r},e})(),BF={}.hasOwnProperty,mo=function(t,e){for(var n in e)BF.call(e,n)&&(t[n]=e[n]);function i(){this.constructor=t}return i.prototype=e.prototype,t.prototype=new i,t.__super__=e.prototype,t};Ra=(function(){function t(e){var n;this.file=e,n=this.file.directory.tables[this.tag],this.exists=!!n,n&&(this.offset=n.offset,this.length=n.length,this.parse(this.file.contents))}return t.prototype.parse=function(){},t.prototype.encode=function(){},t.prototype.raw=function(){return this.exists?(this.file.contents.pos=this.offset,this.file.contents.read(this.length)):null},t})();var zF=(function(){function t(){return t.__super__.constructor.apply(this,arguments)}return mo(t,Ra),t.prototype.tag="head",t.prototype.parse=function(e){return e.pos=this.offset,this.version=e.readInt(),this.revision=e.readInt(),this.checkSumAdjustment=e.readInt(),this.magicNumber=e.readInt(),this.flags=e.readShort(),this.unitsPerEm=e.readShort(),this.created=e.readLongLong(),this.modified=e.readLongLong(),this.xMin=e.readShort(),this.yMin=e.readShort(),this.xMax=e.readShort(),this.yMax=e.readShort(),this.macStyle=e.readShort(),this.lowestRecPPEM=e.readShort(),this.fontDirectionHint=e.readShort(),this.indexToLocFormat=e.readShort(),this.glyphDataFormat=e.readShort()},t.prototype.encode=function(e){var n;return(n=new Yl).writeInt(this.version),n.writeInt(this.revision),n.writeInt(this.checkSumAdjustment),n.writeInt(this.magicNumber),n.writeShort(this.flags),n.writeShort(this.unitsPerEm),n.writeLongLong(this.created),n.writeLongLong(this.modified),n.writeShort(this.xMin),n.writeShort(this.yMin),n.writeShort(this.xMax),n.writeShort(this.yMax),n.writeShort(this.macStyle),n.writeShort(this.lowestRecPPEM),n.writeShort(this.fontDirectionHint),n.writeShort(e),n.writeShort(this.glyphDataFormat),n.data},t})(),Uy=(function(){function t(e,n){var i,r,s,a,o,l,c,u,f,p,d,y,m,w,b,S,A;switch(this.platformID=e.readUInt16(),this.encodingID=e.readShort(),this.offset=n+e.readInt(),f=e.pos,e.pos=this.offset,this.format=e.readUInt16(),this.length=e.readUInt16(),this.language=e.readUInt16(),this.isUnicode=this.platformID===3&&this.encodingID===1&&this.format===4||this.platformID===0&&this.format===4,this.codeMap={},this.format){case 0:for(l=0;l<256;++l)this.codeMap[l]=e.readByte();break;case 4:for(d=e.readUInt16(),p=d/2,e.pos+=6,s=(function(){var _,I;for(I=[],l=_=0;0<=p?_<p:_>p;l=0<=p?++_:--_)I.push(e.readUInt16());return I})(),e.pos+=2,m=(function(){var _,I;for(I=[],l=_=0;0<=p?_<p:_>p;l=0<=p?++_:--_)I.push(e.readUInt16());return I})(),c=(function(){var _,I;for(I=[],l=_=0;0<=p?_<p:_>p;l=0<=p?++_:--_)I.push(e.readUInt16());return I})(),u=(function(){var _,I;for(I=[],l=_=0;0<=p?_<p:_>p;l=0<=p?++_:--_)I.push(e.readUInt16());return I})(),r=(this.length-e.pos+this.offset)/2,o=(function(){var _,I;for(I=[],l=_=0;0<=r?_<r:_>r;l=0<=r?++_:--_)I.push(e.readUInt16());return I})(),l=b=0,A=s.length;b<A;l=++b)for(w=s[l],i=S=y=m[l];y<=w?S<=w:S>=w;i=y<=w?++S:--S)u[l]===0?a=i+c[l]:(a=o[u[l]/2+(i-y)-(p-l)]||0)!==0&&(a+=c[l]),this.codeMap[i]=65535&a}e.pos=f}return t.encode=function(e,n){var i,r,s,a,o,l,c,u,f,p,d,y,m,w,b,S,A,_,I,E,M,T,D,U,C,N,B,P,F,q,Z,W,Y,ue,le,O,V,G,re,ae,ee,de,he,pe,ge,Ee;switch(P=new Yl,a=Object.keys(e).sort(function(Ae,Ye){return Ae-Ye}),n){case"macroman":for(m=0,w=(function(){var Ae=[];for(y=0;y<256;++y)Ae.push(0);return Ae})(),S={0:0},s={},F=0,Y=a.length;F<Y;F++)S[he=e[r=a[F]]]==null&&(S[he]=++m),s[r]={old:e[r],new:S[e[r]]},w[r]=S[e[r]];return P.writeUInt16(1),P.writeUInt16(0),P.writeUInt32(12),P.writeUInt16(0),P.writeUInt16(262),P.writeUInt16(0),P.write(w),{charMap:s,subtable:P.data,maxGlyphID:m+1};case"unicode":for(N=[],f=[],A=0,S={},i={},b=c=null,q=0,ue=a.length;q<ue;q++)S[I=e[r=a[q]]]==null&&(S[I]=++A),i[r]={old:I,new:S[I]},o=S[I]-r,b!=null&&o===c||(b&&f.push(b),N.push(r),c=o),b=r;for(b&&f.push(b),f.push(65535),N.push(65535),U=2*(D=N.length),T=2*Math.pow(Math.log(D)/Math.LN2,2),p=Math.log(T/2)/Math.LN2,M=2*D-T,l=[],E=[],d=[],y=Z=0,le=N.length;Z<le;y=++Z){if(C=N[y],u=f[y],C===65535){l.push(0),E.push(0);break}if(C-(B=i[C].new)>=32768)for(l.push(0),E.push(2*(d.length+D-y)),r=W=C;C<=u?W<=u:W>=u;r=C<=u?++W:--W)d.push(i[r].new);else l.push(B-C),E.push(0)}for(P.writeUInt16(3),P.writeUInt16(1),P.writeUInt32(12),P.writeUInt16(4),P.writeUInt16(16+8*D+2*d.length),P.writeUInt16(0),P.writeUInt16(U),P.writeUInt16(T),P.writeUInt16(p),P.writeUInt16(M),ee=0,O=f.length;ee<O;ee++)r=f[ee],P.writeUInt16(r);for(P.writeUInt16(0),de=0,V=N.length;de<V;de++)r=N[de],P.writeUInt16(r);for(pe=0,G=l.length;pe<G;pe++)o=l[pe],P.writeUInt16(o);for(ge=0,re=E.length;ge<re;ge++)_=E[ge],P.writeUInt16(_);for(Ee=0,ae=d.length;Ee<ae;Ee++)m=d[Ee],P.writeUInt16(m);return{charMap:i,subtable:P.data,maxGlyphID:A+1}}},t})(),h_=(function(){function t(){return t.__super__.constructor.apply(this,arguments)}return mo(t,Ra),t.prototype.tag="cmap",t.prototype.parse=function(e){var n,i,r;for(e.pos=this.offset,this.version=e.readUInt16(),r=e.readUInt16(),this.tables=[],this.unicode=null,i=0;0<=r?i<r:i>r;i=0<=r?++i:--i)n=new Uy(e,this.offset),this.tables.push(n),n.isUnicode&&this.unicode==null&&(this.unicode=n);return!0},t.encode=function(e,n){var i,r;return n==null&&(n="macroman"),i=Uy.encode(e,n),(r=new Yl).writeUInt16(0),r.writeUInt16(1),i.table=r.data.concat(i.subtable),i},t})(),qF=(function(){function t(){return t.__super__.constructor.apply(this,arguments)}return mo(t,Ra),t.prototype.tag="hhea",t.prototype.parse=function(e){return e.pos=this.offset,this.version=e.readInt(),this.ascender=e.readShort(),this.decender=e.readShort(),this.lineGap=e.readShort(),this.advanceWidthMax=e.readShort(),this.minLeftSideBearing=e.readShort(),this.minRightSideBearing=e.readShort(),this.xMaxExtent=e.readShort(),this.caretSlopeRise=e.readShort(),this.caretSlopeRun=e.readShort(),this.caretOffset=e.readShort(),e.pos+=8,this.metricDataFormat=e.readShort(),this.numberOfMetrics=e.readUInt16()},t})(),jF=(function(){function t(){return t.__super__.constructor.apply(this,arguments)}return mo(t,Ra),t.prototype.tag="OS/2",t.prototype.parse=function(e){if(e.pos=this.offset,this.version=e.readUInt16(),this.averageCharWidth=e.readShort(),this.weightClass=e.readUInt16(),this.widthClass=e.readUInt16(),this.type=e.readShort(),this.ySubscriptXSize=e.readShort(),this.ySubscriptYSize=e.readShort(),this.ySubscriptXOffset=e.readShort(),this.ySubscriptYOffset=e.readShort(),this.ySuperscriptXSize=e.readShort(),this.ySuperscriptYSize=e.readShort(),this.ySuperscriptXOffset=e.readShort(),this.ySuperscriptYOffset=e.readShort(),this.yStrikeoutSize=e.readShort(),this.yStrikeoutPosition=e.readShort(),this.familyClass=e.readShort(),this.panose=(function(){var n,i;for(i=[],n=0;n<10;++n)i.push(e.readByte());return i})(),this.charRange=(function(){var n,i;for(i=[],n=0;n<4;++n)i.push(e.readInt());return i})(),this.vendorID=e.readString(4),this.selection=e.readShort(),this.firstCharIndex=e.readShort(),this.lastCharIndex=e.readShort(),this.version>0&&(this.ascent=e.readShort(),this.descent=e.readShort(),this.lineGap=e.readShort(),this.winAscent=e.readShort(),this.winDescent=e.readShort(),this.codePageRange=(function(){var n,i;for(i=[],n=0;n<2;n=++n)i.push(e.readInt());return i})(),this.version>1))return this.xHeight=e.readShort(),this.capHeight=e.readShort(),this.defaultChar=e.readShort(),this.breakChar=e.readShort(),this.maxContext=e.readShort()},t})(),HF=(function(){function t(){return t.__super__.constructor.apply(this,arguments)}return mo(t,Ra),t.prototype.tag="post",t.prototype.parse=function(e){var n,i,r;switch(e.pos=this.offset,this.format=e.readInt(),this.italicAngle=e.readInt(),this.underlinePosition=e.readShort(),this.underlineThickness=e.readShort(),this.isFixedPitch=e.readInt(),this.minMemType42=e.readInt(),this.maxMemType42=e.readInt(),this.minMemType1=e.readInt(),this.maxMemType1=e.readInt(),this.format){case 65536:case 196608:break;case 131072:var s;for(i=e.readUInt16(),this.glyphNameIndex=[],s=0;0<=i?s<i:s>i;s=0<=i?++s:--s)this.glyphNameIndex.push(e.readUInt16());for(this.names=[],r=[];e.pos<this.offset+this.length;)n=e.readByte(),r.push(this.names.push(e.readString(n)));return r;case 151552:return i=e.readUInt16(),this.offsets=e.read(i);case 262144:return this.map=(function(){var a,o,l;for(l=[],s=a=0,o=this.file.maxp.numGlyphs;0<=o?a<o:a>o;s=0<=o?++a:--a)l.push(e.readUInt32());return l}).call(this)}},t})(),UF=function(t,e){this.raw=t,this.length=t.length,this.platformID=e.platformID,this.encodingID=e.encodingID,this.languageID=e.languageID},WF=(function(){function t(){return t.__super__.constructor.apply(this,arguments)}return mo(t,Ra),t.prototype.tag="name",t.prototype.parse=function(e){var n,i,r,s,a,o,l,c,u,f,p;for(e.pos=this.offset,e.readShort(),n=e.readShort(),o=e.readShort(),i=[],s=0;0<=n?s<n:s>n;s=0<=n?++s:--s)i.push({platformID:e.readShort(),encodingID:e.readShort(),languageID:e.readShort(),nameID:e.readShort(),length:e.readShort(),offset:this.offset+o+e.readShort()});for(l={},s=u=0,f=i.length;u<f;s=++u)r=i[s],e.pos=r.offset,c=e.readString(r.length),a=new UF(c,r),l[p=r.nameID]==null&&(l[p]=[]),l[r.nameID].push(a);this.strings=l,this.copyright=l[0],this.fontFamily=l[1],this.fontSubfamily=l[2],this.uniqueSubfamily=l[3],this.fontName=l[4],this.version=l[5];try{this.postscriptName=l[6][0].raw.replace(/[\x00-\x19\x80-\xff]/g,"")}catch{this.postscriptName=l[4][0].raw.replace(/[\x00-\x19\x80-\xff]/g,"")}return this.trademark=l[7],this.manufacturer=l[8],this.designer=l[9],this.description=l[10],this.vendorUrl=l[11],this.designerUrl=l[12],this.license=l[13],this.licenseUrl=l[14],this.preferredFamily=l[15],this.preferredSubfamily=l[17],this.compatibleFull=l[18],this.sampleText=l[19]},t})(),VF=(function(){function t(){return t.__super__.constructor.apply(this,arguments)}return mo(t,Ra),t.prototype.tag="maxp",t.prototype.parse=function(e){return e.pos=this.offset,this.version=e.readInt(),this.numGlyphs=e.readUInt16(),this.maxPoints=e.readUInt16(),this.maxContours=e.readUInt16(),this.maxCompositePoints=e.readUInt16(),this.maxComponentContours=e.readUInt16(),this.maxZones=e.readUInt16(),this.maxTwilightPoints=e.readUInt16(),this.maxStorage=e.readUInt16(),this.maxFunctionDefs=e.readUInt16(),this.maxInstructionDefs=e.readUInt16(),this.maxStackElements=e.readUInt16(),this.maxSizeOfInstructions=e.readUInt16(),this.maxComponentElements=e.readUInt16(),this.maxComponentDepth=e.readUInt16()},t})(),GF=(function(){function t(){return t.__super__.constructor.apply(this,arguments)}return mo(t,Ra),t.prototype.tag="hmtx",t.prototype.parse=function(e){var n,i,r,s,a,o,l;for(e.pos=this.offset,this.metrics=[],n=0,o=this.file.hhea.numberOfMetrics;0<=o?n<o:n>o;n=0<=o?++n:--n)this.metrics.push({advance:e.readUInt16(),lsb:e.readInt16()});for(r=this.file.maxp.numGlyphs-this.file.hhea.numberOfMetrics,this.leftSideBearings=(function(){var c,u;for(u=[],n=c=0;0<=r?c<r:c>r;n=0<=r?++c:--c)u.push(e.readInt16());return u})(),this.widths=(function(){var c,u,f,p;for(p=[],c=0,u=(f=this.metrics).length;c<u;c++)s=f[c],p.push(s.advance);return p}).call(this),i=this.widths[this.widths.length-1],l=[],n=a=0;0<=r?a<r:a>r;n=0<=r?++a:--a)l.push(this.widths.push(i));return l},t.prototype.forGlyph=function(e){return e in this.metrics?this.metrics[e]:{advance:this.metrics[this.metrics.length-1].advance,lsb:this.leftSideBearings[e-this.metrics.length]}},t})(),p_=[].slice,XF=(function(){function t(){return t.__super__.constructor.apply(this,arguments)}return mo(t,Ra),t.prototype.tag="glyf",t.prototype.parse=function(){return this.cache={}},t.prototype.glyphFor=function(e){var n,i,r,s,a,o,l,c,u,f;return e in this.cache?this.cache[e]:(s=this.file.loca,n=this.file.contents,i=s.indexOf(e),(r=s.lengthOf(e))===0?this.cache[e]=null:(n.pos=this.offset+i,a=(o=new Yl(n.read(r))).readShort(),c=o.readShort(),f=o.readShort(),l=o.readShort(),u=o.readShort(),this.cache[e]=a===-1?new KF(o,c,f,l,u):new YF(o,a,c,f,l,u),this.cache[e]))},t.prototype.encode=function(e,n,i){var r,s,a,o,l;for(a=[],s=[],o=0,l=n.length;o<l;o++)r=e[n[o]],s.push(a.length),r&&(a=a.concat(r.encode(i)));return s.push(a.length),{table:a,offsets:s}},t})(),YF=(function(){function t(e,n,i,r,s,a){this.raw=e,this.numberOfContours=n,this.xMin=i,this.yMin=r,this.xMax=s,this.yMax=a,this.compound=!1}return t.prototype.encode=function(){return this.raw.data},t})(),KF=(function(){function t(e,n,i,r,s){var a,o;for(this.raw=e,this.xMin=n,this.yMin=i,this.xMax=r,this.yMax=s,this.compound=!0,this.glyphIDs=[],this.glyphOffsets=[],a=this.raw;o=a.readShort(),this.glyphOffsets.push(a.pos),this.glyphIDs.push(a.readUInt16()),32&o;)a.pos+=1&o?4:2,128&o?a.pos+=8:64&o?a.pos+=4:8&o&&(a.pos+=2)}return t.prototype.encode=function(){var e,n,i;for(n=new Yl(p_.call(this.raw.data)),e=0,i=this.glyphIDs.length;e<i;++e)n.pos=this.glyphOffsets[e];return n.data},t})(),ZF=(function(){function t(){return t.__super__.constructor.apply(this,arguments)}return mo(t,Ra),t.prototype.tag="loca",t.prototype.parse=function(e){var n,i;return e.pos=this.offset,n=this.file.head.indexToLocFormat,this.offsets=n===0?(function(){var r,s;for(s=[],i=0,r=this.length;i<r;i+=2)s.push(2*e.readUInt16());return s}).call(this):(function(){var r,s;for(s=[],i=0,r=this.length;i<r;i+=4)s.push(e.readUInt32());return s}).call(this)},t.prototype.indexOf=function(e){return this.offsets[e]},t.prototype.lengthOf=function(e){return this.offsets[e+1]-this.offsets[e]},t.prototype.encode=function(e,n){for(var i=new Uint32Array(this.offsets.length),r=0,s=0,a=0;a<i.length;++a)if(i[a]=r,s<n.length&&n[s]==a){++s,i[a]=r;var o=this.offsets[a],l=this.offsets[a+1]-o;l>0&&(r+=l)}for(var c=new Array(4*i.length),u=0;u<i.length;++u)c[4*u+3]=255&i[u],c[4*u+2]=(65280&i[u])>>8,c[4*u+1]=(16711680&i[u])>>16,c[4*u]=(4278190080&i[u])>>24;return c},t})(),JF=(function(){function t(e){this.font=e,this.subset={},this.unicodes={},this.next=33}return t.prototype.generateCmap=function(){var e,n,i,r,s;for(n in r=this.font.cmap.tables[0].codeMap,e={},s=this.subset)i=s[n],e[n]=r[i];return e},t.prototype.glyphsFor=function(e){var n,i,r,s,a,o,l;for(r={},a=0,o=e.length;a<o;a++)r[s=e[a]]=this.font.glyf.glyphFor(s);for(s in n=[],r)(i=r[s])!=null&&i.compound&&n.push.apply(n,i.glyphIDs);if(n.length>0)for(s in l=this.glyphsFor(n))i=l[s],r[s]=i;return r},t.prototype.encode=function(e,n){var i,r,s,a,o,l,c,u,f,p,d,y,m,w,b;for(r in i=h_.encode(this.generateCmap(),"unicode"),a=this.glyphsFor(e),d={0:0},b=i.charMap)d[(l=b[r]).old]=l.new;for(y in p=i.maxGlyphID,a)y in d||(d[y]=p++);return u=(function(S){var A,_;for(A in _={},S)_[S[A]]=A;return _})(d),f=Object.keys(u).sort(function(S,A){return S-A}),m=(function(){var S,A,_;for(_=[],S=0,A=f.length;S<A;S++)o=f[S],_.push(u[o]);return _})(),s=this.font.glyf.encode(a,m,d),c=this.font.loca.encode(s.offsets,m),w={cmap:this.font.cmap.raw(),glyf:s.table,loca:c,hmtx:this.font.hmtx.raw(),hhea:this.font.hhea.raw(),maxp:this.font.maxp.raw(),post:this.font.post.raw(),name:this.font.name.raw(),head:this.font.head.encode(n)},this.font.os2.exists&&(w["OS/2"]=this.font.os2.raw()),this.font.directory.encode(w)},t})();Ut.API.PDFObject=(function(){var t;function e(){}return t=function(n,i){return(Array(i+1).join("0")+n).slice(-i)},e.convert=function(n){var i,r,s,a;if(Array.isArray(n))return"["+(function(){var o,l,c;for(c=[],o=0,l=n.length;o<l;o++)i=n[o],c.push(e.convert(i));return c})().join(" ")+"]";if(typeof n=="string")return"/"+n;if(n?.isString)return"("+n+")";if(n instanceof Date)return"(D:"+t(n.getUTCFullYear(),4)+t(n.getUTCMonth(),2)+t(n.getUTCDate(),2)+t(n.getUTCHours(),2)+t(n.getUTCMinutes(),2)+t(n.getUTCSeconds(),2)+"Z)";if({}.toString.call(n)==="[object Object]"){for(r in s=["<<"],n)a=n[r],s.push("/"+r+" "+e.convert(a));return s.push(">>"),s.join(`
`)}return""+n},e})();var nq=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function C0(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}var rm,Wy;function QF(){if(Wy)return rm;Wy=1;var t={},e=t.hasOwnProperty,n=function(l,c){if(!l)return c;var u={};for(var f in c)u[f]=e.call(l,f)?l[f]:c[f];return u},i=/[ -,\.\/:-@\[-\^`\{-~]/,r=/[ -,\.\/:-@\[\]\^`\{-~]/,s=/(^|\\+)?(\\[A-F0-9]{1,6})\x20(?![a-fA-F0-9\x20])/g,a=function o(l,c){c=n(c,o.options),c.quotes!="single"&&c.quotes!="double"&&(c.quotes="single");for(var u=c.quotes=="double"?'"':"'",f=c.isIdentifier,p=l.charAt(0),d="",y=0,m=l.length;y<m;){var w=l.charAt(y++),b=w.charCodeAt(),S=void 0;if(b<32||b>126){if(b>=55296&&b<=56319&&y<m){var A=l.charCodeAt(y++);(A&64512)==56320?b=((b&1023)<<10)+(A&1023)+65536:y--}S="\\"+b.toString(16).toUpperCase()+" "}else c.escapeEverything?i.test(w)?S="\\"+w:S="\\"+b.toString(16).toUpperCase()+" ":/[\t\n\f\r\x0B]/.test(w)?S="\\"+b.toString(16).toUpperCase()+" ":w=="\\"||!f&&(w=='"'&&u==w||w=="'"&&u==w)||f&&r.test(w)?S="\\"+w:S=w;d+=S}return f&&(/^-[-\d]/.test(d)?d="\\-"+d.slice(1):/\d/.test(p)&&(d="\\3"+p+" "+d.slice(1))),d=d.replace(s,function(_,I,E){return I&&I.length%2?_:(I||"")+E}),!f&&c.wrap?u+d+u:d};return a.options={escapeEverything:!1,isIdentifier:!1,quotes:"single",wrap:!1},a.version="3.0.0",rm=a,rm}var $F=QF();const g_=C0($F);var sm,Vy;function eR(){if(Vy)return sm;Vy=1;var t=0,e=1,n=2,i=3,r=4,s=5,a=6,o=/[a-z0-9_-]/i,l=/[\s\t]/,c=function(p){for(var d=!0,y=t,m="",w=0,b,S,A=[];;){if(S=p[w],y===t){if(!S&&d)break;if(!S&&!d)throw new Error("Parse error");if(S==='"'||S==="'")b=S,y=e,d=!1;else if(!l.test(S))if(o.test(S))y=i,d=!1,w--;else throw new Error("Parse error")}else if(y===e)if(S)S==="\\"?y=n:S===b?(A.push(m),m="",y=r):m+=S;else throw new Error("Parse Error");else if(y===n)if(S===b||S==="\\")m+=S,y=e;else throw new Error("Parse error");else if(y===i)if(S)o.test(S)?m+=S:S===","?(A.push(m),m="",y=t):l.test(S)?y=s:S==="\\"&&(y=a);else{A.push(m);break}else if(y===a){if(/[0-9a-f]/i.test(S))throw new Error("Parse error");m+=S,y=i}else if(y===s)if(S){if(o.test(S))m+=" "+S,y=i;else if(S===",")A.push(m),m="",y=t;else if(!l.test(S))throw new Error("Parse error")}else{A.push(m);break}else if(y===r)if(S){if(S===",")y=t;else if(!l.test(S))throw new Error("Parse error")}else break;w++}return A},u=/[^a-z0-9_-]/i,f=function(p,d){var y=d&&d.quote||'"';if(y!=='"'&&y!=="'")throw new Error("Quote must be `'` or `\"`");for(var m=new RegExp(y,"g"),w=[],b=0;b<p.length;++b){var S=p[b];u.test(S)&&(S=S.replace(/\\/g,"\\\\").replace(m,"\\"+y),S=y+S+y),w.push(S)}return w.join(", ")};return sm={parse:c,stringify:f},sm}var tR=eR();const nR=C0(tR);var am,Gy;function iR(){if(Gy)return am;Gy=1;var t={a:7,c:6,h:1,l:2,m:2,r:4,q:4,s:4,t:2,v:1,z:0},e=[5760,6158,8192,8193,8194,8195,8196,8197,8198,8199,8200,8201,8202,8239,8287,12288,65279];function n(d){return d===10||d===13||d===8232||d===8233||d===32||d===9||d===11||d===12||d===160||d>=5760&&e.indexOf(d)>=0}function i(d){switch(d|32){case 109:case 122:case 108:case 104:case 118:case 99:case 115:case 113:case 116:case 97:case 114:return!0}return!1}function r(d){return(d|32)===97}function s(d){return d>=48&&d<=57}function a(d){return d>=48&&d<=57||d===43||d===45||d===46}function o(d){this.index=0,this.path=d,this.max=d.length,this.result=[],this.param=0,this.err="",this.segmentStart=0,this.data=[]}function l(d){for(;d.index<d.max&&n(d.path.charCodeAt(d.index));)d.index++}function c(d){var y=d.path.charCodeAt(d.index);if(y===48){d.param=0,d.index++;return}if(y===49){d.param=1,d.index++;return}d.err="SvgPath: arc flag can be 0 or 1 only (at pos "+d.index+")"}function u(d){var y=d.index,m=y,w=d.max,b=!1,S=!1,A=!1,_=!1,I;if(m>=w){d.err="SvgPath: missed param (at pos "+m+")";return}if(I=d.path.charCodeAt(m),(I===43||I===45)&&(m++,I=m<w?d.path.charCodeAt(m):0),!s(I)&&I!==46){d.err="SvgPath: param should start with 0..9 or `.` (at pos "+m+")";return}if(I!==46){if(b=I===48,m++,I=m<w?d.path.charCodeAt(m):0,b&&m<w&&I&&s(I)){d.err="SvgPath: numbers started with `0` such as `09` are illegal (at pos "+y+")";return}for(;m<w&&s(d.path.charCodeAt(m));)m++,S=!0;I=m<w?d.path.charCodeAt(m):0}if(I===46){for(_=!0,m++;s(d.path.charCodeAt(m));)m++,A=!0;I=m<w?d.path.charCodeAt(m):0}if(I===101||I===69){if(_&&!S&&!A){d.err="SvgPath: invalid float exponent (at pos "+m+")";return}if(m++,I=m<w?d.path.charCodeAt(m):0,(I===43||I===45)&&m++,m<w&&s(d.path.charCodeAt(m)))for(;m<w&&s(d.path.charCodeAt(m));)m++;else{d.err="SvgPath: invalid float exponent (at pos "+m+")";return}}d.index=m,d.param=parseFloat(d.path.slice(y,m))+0}function f(d){var y,m;y=d.path[d.segmentStart],m=y.toLowerCase();var w=d.data;if(m==="m"&&w.length>2&&(d.result.push([y,w[0],w[1]]),w=w.slice(2),m="l",y=y==="m"?"l":"L"),m==="r")d.result.push([y].concat(w));else for(;w.length>=t[m]&&(d.result.push([y].concat(w.splice(0,t[m]))),!!t[m]););}function p(d){var y=d.max,m,w,b,S,A;if(d.segmentStart=d.index,m=d.path.charCodeAt(d.index),w=r(m),!i(m)){d.err="SvgPath: bad command "+d.path[d.index]+" (at pos "+d.index+")";return}if(S=t[d.path[d.index].toLowerCase()],d.index++,l(d),d.data=[],!S){f(d);return}for(b=!1;;){for(A=S;A>0;A--){if(w&&(A===3||A===4)?c(d):u(d),d.err.length){f(d);return}d.data.push(d.param),l(d),b=!1,d.index<y&&d.path.charCodeAt(d.index)===44&&(d.index++,l(d),b=!0)}if(!b&&(d.index>=d.max||!a(d.path.charCodeAt(d.index))))break}f(d)}return am=function(y){var m=new o(y),w=m.max;for(l(m);m.index<w&&!m.err.length;)p(m);return m.result.length&&("mM".indexOf(m.result[0][0])<0?(m.err="SvgPath: string should start with `M` or `m`",m.result=[]):m.result[0][0]="M"),{err:m.err,segments:m.result}},am}var om,Xy;function m_(){if(Xy)return om;Xy=1;function t(n,i){return[n[0]*i[0]+n[2]*i[1],n[1]*i[0]+n[3]*i[1],n[0]*i[2]+n[2]*i[3],n[1]*i[2]+n[3]*i[3],n[0]*i[4]+n[2]*i[5]+n[4],n[1]*i[4]+n[3]*i[5]+n[5]]}function e(){if(!(this instanceof e))return new e;this.queue=[],this.cache=null}return e.prototype.matrix=function(n){return n[0]===1&&n[1]===0&&n[2]===0&&n[3]===1&&n[4]===0&&n[5]===0?this:(this.cache=null,this.queue.push(n),this)},e.prototype.translate=function(n,i){return(n!==0||i!==0)&&(this.cache=null,this.queue.push([1,0,0,1,n,i])),this},e.prototype.scale=function(n,i){return(n!==1||i!==1)&&(this.cache=null,this.queue.push([n,0,0,i,0,0])),this},e.prototype.rotate=function(n,i,r){var s,a,o;return n!==0&&(this.translate(i,r),s=n*Math.PI/180,a=Math.cos(s),o=Math.sin(s),this.queue.push([a,o,-o,a,0,0]),this.cache=null,this.translate(-i,-r)),this},e.prototype.skewX=function(n){return n!==0&&(this.cache=null,this.queue.push([1,0,Math.tan(n*Math.PI/180),1,0,0])),this},e.prototype.skewY=function(n){return n!==0&&(this.cache=null,this.queue.push([1,Math.tan(n*Math.PI/180),0,1,0,0])),this},e.prototype.toArray=function(){if(this.cache)return this.cache;if(!this.queue.length)return this.cache=[1,0,0,1,0,0],this.cache;if(this.cache=this.queue[0],this.queue.length===1)return this.cache;for(var n=1;n<this.queue.length;n++)this.cache=t(this.cache,this.queue[n]);return this.cache},e.prototype.calc=function(n,i,r){var s;return this.queue.length?(this.cache||(this.cache=this.toArray()),s=this.cache,[n*s[0]+i*s[2]+(r?0:s[4]),n*s[1]+i*s[3]+(r?0:s[5])]):[n,i]},om=e,om}var lm,Yy;function rR(){if(Yy)return lm;Yy=1;var t=m_(),e={matrix:!0,scale:!0,rotate:!0,translate:!0,skewX:!0,skewY:!0},n=/\s*(matrix|translate|scale|rotate|skewX|skewY)\s*\(\s*(.+?)\s*\)[\s,]*/,i=/[\s,]+/;return lm=function(s){var a=new t,o,l;return s.split(n).forEach(function(c){if(c.length){if(typeof e[c]<"u"){o=c;return}switch(l=c.split(i).map(function(u){return+u||0}),o){case"matrix":l.length===6&&a.matrix(l);return;case"scale":l.length===1?a.scale(l[0],l[0]):l.length===2&&a.scale(l[0],l[1]);return;case"rotate":l.length===1?a.rotate(l[0],0,0):l.length===3&&a.rotate(l[0],l[1],l[2]);return;case"translate":l.length===1?a.translate(l[0],0):l.length===2&&a.translate(l[0],l[1]);return;case"skewX":l.length===1&&a.skewX(l[0]);return;case"skewY":l.length===1&&a.skewY(l[0]);return}}}),a},lm}var cm,Ky;function sR(){if(Ky)return cm;Ky=1;var t=Math.PI*2;function e(r,s,a,o){var l=r*o-s*a<0?-1:1,c=r*a+s*o;return c>1&&(c=1),c<-1&&(c=-1),l*Math.acos(c)}function n(r,s,a,o,l,c,u,f,p,d){var y=d*(r-a)/2+p*(s-o)/2,m=-p*(r-a)/2+d*(s-o)/2,w=u*u,b=f*f,S=y*y,A=m*m,_=w*b-w*A-b*S;_<0&&(_=0),_/=w*A+b*S,_=Math.sqrt(_)*(l===c?-1:1);var I=_*u/f*m,E=_*-f/u*y,M=d*I-p*E+(r+a)/2,T=p*I+d*E+(s+o)/2,D=(y-I)/u,U=(m-E)/f,C=(-y-I)/u,N=(-m-E)/f,B=e(1,0,D,U),P=e(D,U,C,N);return c===0&&P>0&&(P-=t),c===1&&P<0&&(P+=t),[M,T,B,P]}function i(r,s){var a=1.3333333333333333*Math.tan(s/4),o=Math.cos(r),l=Math.sin(r),c=Math.cos(r+s),u=Math.sin(r+s);return[o,l,o-l*a,l+o*a,c+u*a,u-c*a,c,u]}return cm=function(s,a,o,l,c,u,f,p,d){var y=Math.sin(d*t/360),m=Math.cos(d*t/360),w=m*(s-o)/2+y*(a-l)/2,b=-y*(s-o)/2+m*(a-l)/2;if(w===0&&b===0)return[];if(f===0||p===0)return[];f=Math.abs(f),p=Math.abs(p);var S=w*w/(f*f)+b*b/(p*p);S>1&&(f*=Math.sqrt(S),p*=Math.sqrt(S));var A=n(s,a,o,l,c,u,f,p,y,m),_=[],I=A[2],E=A[3],M=Math.max(Math.ceil(Math.abs(E)/(t/4)),1);E/=M;for(var T=0;T<M;T++)_.push(i(I,E)),I+=E;return _.map(function(D){for(var U=0;U<D.length;U+=2){var C=D[U+0],N=D[U+1];C*=f,N*=p;var B=m*C-y*N,P=y*C+m*N;D[U+0]=B+A[0],D[U+1]=P+A[1]}return D})},cm}var um,Zy;function aR(){if(Zy)return um;Zy=1;var t=1e-10,e=Math.PI/180;function n(i,r,s){if(!(this instanceof n))return new n(i,r,s);this.rx=i,this.ry=r,this.ax=s}return n.prototype.transform=function(i){var r=Math.cos(this.ax*e),s=Math.sin(this.ax*e),a=[this.rx*(i[0]*r+i[2]*s),this.rx*(i[1]*r+i[3]*s),this.ry*(-i[0]*s+i[2]*r),this.ry*(-i[1]*s+i[3]*r)],o=a[0]*a[0]+a[2]*a[2],l=a[1]*a[1]+a[3]*a[3],c=((a[0]-a[3])*(a[0]-a[3])+(a[2]+a[1])*(a[2]+a[1]))*((a[0]+a[3])*(a[0]+a[3])+(a[2]-a[1])*(a[2]-a[1])),u=(o+l)/2;if(c<t*u)return this.rx=this.ry=Math.sqrt(u),this.ax=0,this;var f=a[0]*a[1]+a[2]*a[3];c=Math.sqrt(c);var p=u+c/2,d=u-c/2;return this.ax=Math.abs(f)<t&&Math.abs(p-l)<t?90:Math.atan(Math.abs(f)>Math.abs(p-l)?(p-o)/f:f/(p-l))*180/Math.PI,this.ax>=0?(this.rx=Math.sqrt(p),this.ry=Math.sqrt(d)):(this.ax+=90,this.rx=Math.sqrt(d),this.ry=Math.sqrt(p)),this},n.prototype.isDegenerate=function(){return this.rx<t*this.ry||this.ry<t*this.rx},um=n,um}var dm,Jy;function oR(){if(Jy)return dm;Jy=1;var t=iR(),e=rR(),n=m_(),i=sR(),r=aR();function s(a){if(!(this instanceof s))return new s(a);var o=t(a);this.segments=o.segments,this.err=o.err,this.__stack=[]}return s.from=function(a){if(typeof a=="string")return new s(a);if(a instanceof s){var o=new s("");return o.err=a.err,o.segments=a.segments.map(function(l){return l.slice()}),o.__stack=a.__stack.map(function(l){return n().matrix(l.toArray())}),o}throw new Error("SvgPath.from: invalid param type "+a)},s.prototype.__matrix=function(a){var o=this,l;a.queue.length&&this.iterate(function(c,u,f,p){var d,y,m,w;switch(c[0]){case"v":d=a.calc(0,c[1],!0),y=d[0]===0?["v",d[1]]:["l",d[0],d[1]];break;case"V":d=a.calc(f,c[1],!1),y=d[0]===a.calc(f,p,!1)[0]?["V",d[1]]:["L",d[0],d[1]];break;case"h":d=a.calc(c[1],0,!0),y=d[1]===0?["h",d[0]]:["l",d[0],d[1]];break;case"H":d=a.calc(c[1],p,!1),y=d[1]===a.calc(f,p,!1)[1]?["H",d[0]]:["L",d[0],d[1]];break;case"a":case"A":var b=a.toArray(),S=r(c[1],c[2],c[3]).transform(b);if(b[0]*b[3]-b[1]*b[2]<0&&(c[5]=c[5]?"0":"1"),d=a.calc(c[6],c[7],c[0]==="a"),c[0]==="A"&&c[6]===f&&c[7]===p||c[0]==="a"&&c[6]===0&&c[7]===0){y=[c[0]==="a"?"l":"L",d[0],d[1]];break}S.isDegenerate()?y=[c[0]==="a"?"l":"L",d[0],d[1]]:y=[c[0],S.rx,S.ry,S.ax,c[4],c[5],d[0],d[1]];break;case"m":w=u>0,d=a.calc(c[1],c[2],w),y=["m",d[0],d[1]];break;default:for(m=c[0],y=[m],w=m.toLowerCase()===m,l=1;l<c.length;l+=2)d=a.calc(c[l],c[l+1],w),y.push(d[0],d[1])}o.segments[u]=y},!0)},s.prototype.__evaluateStack=function(){var a,o;if(this.__stack.length){if(this.__stack.length===1){this.__matrix(this.__stack[0]),this.__stack=[];return}for(a=n(),o=this.__stack.length;--o>=0;)a.matrix(this.__stack[o].toArray());this.__matrix(a),this.__stack=[]}},s.prototype.toString=function(){var a="",o="",l=!1;this.__evaluateStack();for(var c=0,u=this.segments.length;c<u;c++){var f=this.segments[c],p=f[0];p!==o||p==="m"||p==="M"?(p==="m"&&o==="z"&&(a+=" "),a+=p,l=!1):l=!0;for(var d=1;d<f.length;d++){var y=f[d];d===1?l&&y>=0&&(a+=" "):y>=0&&(a+=" "),a+=y}o=p}return a},s.prototype.translate=function(a,o){return this.__stack.push(n().translate(a,o||0)),this},s.prototype.scale=function(a,o){return this.__stack.push(n().scale(a,!o&&o!==0?a:o)),this},s.prototype.rotate=function(a,o,l){return this.__stack.push(n().rotate(a,o||0,l||0)),this},s.prototype.skewX=function(a){return this.__stack.push(n().skewX(a)),this},s.prototype.skewY=function(a){return this.__stack.push(n().skewY(a)),this},s.prototype.matrix=function(a){return this.__stack.push(n().matrix(a)),this},s.prototype.transform=function(a){return a.trim()?(this.__stack.push(e(a)),this):this},s.prototype.round=function(a){var o=0,l=0,c=0,u=0,f;return a=a||0,this.__evaluateStack(),this.segments.forEach(function(p){var d=p[0].toLowerCase()===p[0];switch(p[0]){case"H":case"h":d&&(p[1]+=c),c=p[1]-p[1].toFixed(a),p[1]=+p[1].toFixed(a);return;case"V":case"v":d&&(p[1]+=u),u=p[1]-p[1].toFixed(a),p[1]=+p[1].toFixed(a);return;case"Z":case"z":c=o,u=l;return;case"M":case"m":d&&(p[1]+=c,p[2]+=u),c=p[1]-p[1].toFixed(a),u=p[2]-p[2].toFixed(a),o=c,l=u,p[1]=+p[1].toFixed(a),p[2]=+p[2].toFixed(a);return;case"A":case"a":d&&(p[6]+=c,p[7]+=u),c=p[6]-p[6].toFixed(a),u=p[7]-p[7].toFixed(a),p[1]=+p[1].toFixed(a),p[2]=+p[2].toFixed(a),p[3]=+p[3].toFixed(a+2),p[6]=+p[6].toFixed(a),p[7]=+p[7].toFixed(a);return;default:f=p.length,d&&(p[f-2]+=c,p[f-1]+=u),c=p[f-2]-p[f-2].toFixed(a),u=p[f-1]-p[f-1].toFixed(a),p.forEach(function(y,m){m&&(p[m]=+p[m].toFixed(a))});return}}),this},s.prototype.iterate=function(a,o){var l=this.segments,c={},u=!1,f=0,p=0,d=0,y=0,m,w,b;if(o||this.__evaluateStack(),l.forEach(function(S,A){var _=a(S,A,f,p);Array.isArray(_)&&(c[A]=_,u=!0);var I=S[0]===S[0].toLowerCase();switch(S[0]){case"m":case"M":f=S[1]+(I?f:0),p=S[2]+(I?p:0),d=f,y=p;return;case"h":case"H":f=S[1]+(I?f:0);return;case"v":case"V":p=S[1]+(I?p:0);return;case"z":case"Z":f=d,p=y;return;default:f=S[S.length-2]+(I?f:0),p=S[S.length-1]+(I?p:0)}}),!u)return this;for(b=[],m=0;m<l.length;m++)if(typeof c[m]<"u")for(w=0;w<c[m].length;w++)b.push(c[m][w]);else b.push(l[m]);return this.segments=b,this},s.prototype.abs=function(){return this.iterate(function(a,o,l,c){var u=a[0],f=u.toUpperCase(),p;if(u!==f)switch(a[0]=f,u){case"v":a[1]+=c;return;case"a":a[6]+=l,a[7]+=c;return;default:for(p=1;p<a.length;p++)a[p]+=p%2?l:c}},!0),this},s.prototype.rel=function(){return this.iterate(function(a,o,l,c){var u=a[0],f=u.toLowerCase(),p;if(u!==f&&!(o===0&&u==="M"))switch(a[0]=f,u){case"V":a[1]-=c;return;case"A":a[6]-=l,a[7]-=c;return;default:for(p=1;p<a.length;p++)a[p]-=p%2?l:c}},!0),this},s.prototype.unarc=function(){return this.iterate(function(a,o,l,c){var u,f,p,d=[],y=a[0];return y!=="A"&&y!=="a"?null:(y==="a"?(f=l+a[6],p=c+a[7]):(f=a[6],p=a[7]),u=i(l,c,f,p,a[4],a[5],a[1],a[2],a[3]),u.length===0?[[a[0]==="a"?"l":"L",a[6],a[7]]]:(u.forEach(function(m){d.push(["C",m[2],m[3],m[4],m[5],m[6],m[7]])}),d))}),this},s.prototype.unshort=function(){var a=this.segments,o,l,c,u,f;return this.iterate(function(p,d,y,m){var w=p[0],b=w.toUpperCase(),S;d&&(b==="T"?(S=w==="t",c=a[d-1],c[0]==="Q"?(o=c[1]-y,l=c[2]-m):c[0]==="q"?(o=c[1]-c[3],l=c[2]-c[4]):(o=0,l=0),u=-o,f=-l,S||(u+=y,f+=m),a[d]=[S?"q":"Q",u,f,p[1],p[2]]):b==="S"&&(S=w==="s",c=a[d-1],c[0]==="C"?(o=c[3]-y,l=c[4]-m):c[0]==="c"?(o=c[3]-c[5],l=c[4]-c[6]):(o=0,l=0),u=-o,f=-l,S||(u+=y,f+=m),a[d]=[S?"c":"C",u,f,p[1],p[2],p[3],p[4]]))}),this},dm=s,dm}var fm,Qy;function lR(){return Qy||(Qy=1,fm=oR()),fm}var cR=lR();const uR=C0(cR);var $y=function(t){var e=t,n,i={a:0,b:0,c:0},r=[],s=/(\[[^\]]+\])/g,a=/(#[^\#\s\+>~\.\[:\)]+)/g,o=/(\.[^\s\+>~\.\[:\)]+)/g,l=/(::[^\s\+>~\.\[:]+|:first-line|:first-letter|:before|:after)/gi,c=/(:(?!not|global|local)[\w-]+\([^\)]*\))/gi,u=/(:(?!not|global|local)[^\s\+>~\.\[:]+)/g,f=/([^\s\+>~\.\[:]+)/g;return n=function(p,d){var y,m,w,b,S,A;if(p.test(e))for(y=e.match(p),m=0,w=y.length;m<w;m+=1)i[d]+=1,b=y[m],S=e.indexOf(b),A=b.length,r.push({selector:t.substr(S,A),type:d,index:S,length:A}),e=e.replace(b,Array(A+1).join(" "))},(function(){var p=function(w){var b,S,A,_;if(w.test(e))for(b=e.match(w),S=0,A=b.length;S<A;S+=1)_=b[S],e=e.replace(_,Array(_.length+1).join("A"))},d=/\\[0-9A-Fa-f]{6}\s?/g,y=/\\[0-9A-Fa-f]{1,5}\s/g,m=/\\./g;p(d),p(y),p(m)})(),(function(){var p=/{[^]*/gm,d,y,m,w;if(p.test(e))for(d=e.match(p),y=0,m=d.length;y<m;y+=1)w=d[y],e=e.replace(w,Array(w.length+1).join(" "))})(),n(s,"b"),n(a,"a"),n(o,"b"),n(l,"c"),n(c,"b"),n(u,"b"),e=e.replace(/[\*\s\+>~]/g," "),e=e.replace(/[#\.]/g," "),e=e.replace(/:not/g,"    "),e=e.replace(/:local/g,"      "),e=e.replace(/:global/g,"       "),e=e.replace(/[\(\)]/g," "),n(f,"c"),r.sort(function(p,d){return p.index-d.index}),{selector:t,specificity:"0,"+i.a.toString()+","+i.b.toString()+","+i.c.toString(),specificityArray:[0,i.a,i.b,i.c],parts:r}},dR=function(t,e){var n,i,r;if(typeof t=="string"){if(t.indexOf(",")!==-1)throw"Invalid CSS selector";n=$y(t).specificityArray}else if(Array.isArray(t)){if(t.filter(function(s){return typeof s=="number"}).length!==4)throw"Invalid specificity array";n=t}else throw"Invalid CSS selector or specificity array";if(typeof e=="string"){if(e.indexOf(",")!==-1)throw"Invalid CSS selector";i=$y(e).specificityArray}else if(Array.isArray(e)){if(e.filter(function(s){return typeof s=="number"}).length!==4)throw"Invalid specificity array";i=e}else throw"Invalid CSS selector or specificity array";for(r=0;r<4;r+=1){if(n[r]<i[r])return-1;if(n[r]>i[r])return 1}return 0},u1=function(t,e){return u1=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,i){n.__proto__=i}||function(n,i){for(var r in i)Object.prototype.hasOwnProperty.call(i,r)&&(n[r]=i[r])},u1(t,e)};function Zn(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");function n(){this.constructor=t}u1(t,e),t.prototype=e===null?Object.create(e):(n.prototype=e.prototype,new n)}var ep=function(){return ep=Object.assign||function(t){for(var e,n=1,i=arguments.length;n<i;n++)for(var r in e=arguments[n])Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t},ep.apply(this,arguments)};function si(t,e,n,i){return new(n||(n=Promise))((function(r,s){function a(c){try{l(i.next(c))}catch(u){s(u)}}function o(c){try{l(i.throw(c))}catch(u){s(u)}}function l(c){var u;c.done?r(c.value):(u=c.value,u instanceof n?u:new n((function(f){f(u)}))).then(a,o)}l((i=i.apply(t,e||[])).next())}))}function ai(t,e){var n,i,r,s,a={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]};return s={next:o(0),throw:o(1),return:o(2)},typeof Symbol=="function"&&(s[Symbol.iterator]=function(){return this}),s;function o(l){return function(c){return(function(u){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,i&&(r=2&u[0]?i.return:u[0]?i.throw||((r=i.return)&&r.call(i),0):i.next)&&!(r=r.call(i,u[1])).done)return r;switch(i=0,r&&(u=[2&u[0],r.value]),u[0]){case 0:case 1:r=u;break;case 4:return a.label++,{value:u[1],done:!1};case 5:a.label++,i=u[1],u=[0];continue;case 7:u=a.ops.pop(),a.trys.pop();continue;default:if(r=a.trys,!((r=r.length>0&&r[r.length-1])||u[0]!==6&&u[0]!==2)){a=0;continue}if(u[0]===3&&(!r||u[1]>r[0]&&u[1]<r[3])){a.label=u[1];break}if(u[0]===6&&a.label<r[1]){a.label=r[1],r=u;break}if(r&&a.label<r[2]){a.label=r[2],a.ops.push(u);break}r[2]&&a.ops.pop(),a.trys.pop();continue}u=e.call(t,a)}catch(f){u=[6,f],i=0}finally{n=r=0}if(5&u[0])throw u[1];return{value:u[0]?u[1]:void 0,done:!0}})([l,c])}}}var Ca=(function(){function t(e){if(this.a=void 0,this.r=0,this.g=0,this.b=0,this.simpleColors={},this.colorDefs=[],this.ok=!1,e){for(var n in e.charAt(0)=="#"&&(e=e.substr(1,6)),e=(e=e.replace(/ /g,"")).toLowerCase(),this.simpleColors={aliceblue:"f0f8ff",antiquewhite:"faebd7",aqua:"00ffff",aquamarine:"7fffd4",azure:"f0ffff",beige:"f5f5dc",bisque:"ffe4c4",black:"000000",blanchedalmond:"ffebcd",blue:"0000ff",blueviolet:"8a2be2",brown:"a52a2a",burlywood:"deb887",cadetblue:"5f9ea0",chartreuse:"7fff00",chocolate:"d2691e",coral:"ff7f50",cornflowerblue:"6495ed",cornsilk:"fff8dc",crimson:"dc143c",cyan:"00ffff",darkblue:"00008b",darkcyan:"008b8b",darkgoldenrod:"b8860b",darkgray:"a9a9a9",darkgrey:"a9a9a9",darkgreen:"006400",darkkhaki:"bdb76b",darkmagenta:"8b008b",darkolivegreen:"556b2f",darkorange:"ff8c00",darkorchid:"9932cc",darkred:"8b0000",darksalmon:"e9967a",darkseagreen:"8fbc8f",darkslateblue:"483d8b",darkslategray:"2f4f4f",darkslategrey:"2f4f4f",darkturquoise:"00ced1",darkviolet:"9400d3",deeppink:"ff1493",deepskyblue:"00bfff",dimgray:"696969",dimgrey:"696969",dodgerblue:"1e90ff",feldspar:"d19275",firebrick:"b22222",floralwhite:"fffaf0",forestgreen:"228b22",fuchsia:"ff00ff",gainsboro:"dcdcdc",ghostwhite:"f8f8ff",gold:"ffd700",goldenrod:"daa520",gray:"808080",grey:"808080",green:"008000",greenyellow:"adff2f",honeydew:"f0fff0",hotpink:"ff69b4",indianred:"cd5c5c",indigo:"4b0082",ivory:"fffff0",khaki:"f0e68c",lavender:"e6e6fa",lavenderblush:"fff0f5",lawngreen:"7cfc00",lemonchiffon:"fffacd",lightblue:"add8e6",lightcoral:"f08080",lightcyan:"e0ffff",lightgoldenrodyellow:"fafad2",lightgray:"d3d3d3",lightgrey:"d3d3d3",lightgreen:"90ee90",lightpink:"ffb6c1",lightsalmon:"ffa07a",lightseagreen:"20b2aa",lightskyblue:"87cefa",lightslateblue:"8470ff",lightslategray:"778899",lightslategrey:"778899",lightsteelblue:"b0c4de",lightyellow:"ffffe0",lime:"00ff00",limegreen:"32cd32",linen:"faf0e6",magenta:"ff00ff",maroon:"800000",mediumaquamarine:"66cdaa",mediumblue:"0000cd",mediumorchid:"ba55d3",mediumpurple:"9370d8",mediumseagreen:"3cb371",mediumslateblue:"7b68ee",mediumspringgreen:"00fa9a",mediumturquoise:"48d1cc",mediumvioletred:"c71585",midnightblue:"191970",mintcream:"f5fffa",mistyrose:"ffe4e1",moccasin:"ffe4b5",navajowhite:"ffdead",navy:"000080",oldlace:"fdf5e6",olive:"808000",olivedrab:"6b8e23",orange:"ffa500",orangered:"ff4500",orchid:"da70d6",palegoldenrod:"eee8aa",palegreen:"98fb98",paleturquoise:"afeeee",palevioletred:"d87093",papayawhip:"ffefd5",peachpuff:"ffdab9",peru:"cd853f",pink:"ffc0cb",plum:"dda0dd",powderblue:"b0e0e6",purple:"800080",red:"ff0000",rosybrown:"bc8f8f",royalblue:"4169e1",saddlebrown:"8b4513",salmon:"fa8072",sandybrown:"f4a460",seagreen:"2e8b57",seashell:"fff5ee",sienna:"a0522d",silver:"c0c0c0",skyblue:"87ceeb",slateblue:"6a5acd",slategray:"708090",slategrey:"708090",snow:"fffafa",springgreen:"00ff7f",steelblue:"4682b4",tan:"d2b48c",teal:"008080",thistle:"d8bfd8",tomato:"ff6347",turquoise:"40e0d0",violet:"ee82ee",violetred:"d02090",wheat:"f5deb3",white:"ffffff",whitesmoke:"f5f5f5",yellow:"ffff00",yellowgreen:"9acd32"},this.simpleColors)e==n&&(e=this.simpleColors[n]);this.colorDefs=[{re:/^rgb\((\d{1,3}),\s*(\d{1,3}),\s*(\d{1,3})\)$/,example:["rgb(123, 234, 45)","rgb(255,234,245)"],process:function(l){return[parseInt(l[1]),parseInt(l[2]),parseInt(l[3])]}},{re:/^rgb\(([0-9.]+)%,\s*([0-9.]+)%,\s*([0-9.]+)%\)$/,example:["rgb(50.5%, 25.75%, 75.5%)","rgb(100%,0%,0%)"],process:function(l){return[Math.round(2.55*parseFloat(l[1])),Math.round(2.55*parseFloat(l[2])),Math.round(2.55*parseFloat(l[3]))]}},{re:/^(\w{2})(\w{2})(\w{2})$/,example:["#00ff00","336699"],process:function(l){return[parseInt(l[1],16),parseInt(l[2],16),parseInt(l[3],16)]}},{re:/^(\w{1})(\w{1})(\w{1})$/,example:["#fb0","f0f"],process:function(l){return[parseInt(l[1]+l[1],16),parseInt(l[2]+l[2],16),parseInt(l[3]+l[3],16)]}}];for(var i=0;i<this.colorDefs.length;i++){var r=this.colorDefs[i].re,s=this.colorDefs[i].process,a=r.exec(e);if(a){var o=s(a);this.r=o[0],this.g=o[1],this.b=o[2],this.ok=!0}}this.r=this.r<0||isNaN(this.r)?0:this.r>255?255:this.r,this.g=this.g<0||isNaN(this.g)?0:this.g>255?255:this.g,this.b=this.b<0||isNaN(this.b)?0:this.b>255?255:this.b}}return t.prototype.toRGB=function(){return"rgb("+this.r+", "+this.g+", "+this.b+")"},t.prototype.toRGBA=function(){return"rgba("+this.r+", "+this.g+", "+this.b+", "+(this.a||"1")+")"},t.prototype.toHex=function(){var e=this.r.toString(16),n=this.g.toString(16),i=this.b.toString(16);return e.length==1&&(e="0"+e),n.length==1&&(n="0"+n),i.length==1&&(i="0"+i),"#"+e+n+i},t.prototype.getHelpXML=function(){for(var e=[],n=0;n<this.colorDefs.length;n++)for(var i=this.colorDefs[n].example,r=0;r<i.length;r++)e[e.length]=i[r];for(var s in this.simpleColors)e[e.length]=s;var a=document.createElement("ul");for(a.setAttribute("id","rgbcolor-examples"),n=0;n<e.length;n++)try{var o=document.createElement("li"),l=new t(e[n]),c=document.createElement("div");c.style.cssText="margin: 3px; border: 1px solid black; background:"+l.toHex()+"; color:"+l.toHex(),c.appendChild(document.createTextNode("test"));var u=document.createTextNode(" "+e[n]+" -> "+l.toRGB()+" -> "+l.toHex());o.appendChild(c),o.appendChild(u),a.appendChild(o)}catch{}return a},t})(),Nr=(function(){function t(e){this.color=e}return t.prototype.getFillData=function(e,n){return si(this,void 0,void 0,(function(){return ai(this,(function(i){return[2,void 0]}))}))},t})(),zu=(function(){function t(){this.xmlSpace="",this.whiteSpace="",this.fill=null,this.fillOpacity=1,this.fontFamily="",this.fontSize=16,this.fontStyle="",this.fontWeight="",this.opacity=1,this.stroke=null,this.strokeDasharray=null,this.strokeDashoffset=0,this.strokeLinecap="",this.strokeLinejoin="",this.strokeMiterlimit=4,this.strokeOpacity=1,this.strokeWidth=1,this.alignmentBaseline="",this.textAnchor="",this.visibility="",this.color=null,this.contextFill=null,this.contextStroke=null,this.fillRule=null}return t.prototype.clone=function(){var e=new t;return e.xmlSpace=this.xmlSpace,e.whiteSpace=this.whiteSpace,e.fill=this.fill,e.fillOpacity=this.fillOpacity,e.fontFamily=this.fontFamily,e.fontSize=this.fontSize,e.fontStyle=this.fontStyle,e.fontWeight=this.fontWeight,e.opacity=this.opacity,e.stroke=this.stroke,e.strokeDasharray=this.strokeDasharray,e.strokeDashoffset=this.strokeDashoffset,e.strokeLinecap=this.strokeLinecap,e.strokeLinejoin=this.strokeLinejoin,e.strokeMiterlimit=this.strokeMiterlimit,e.strokeOpacity=this.strokeOpacity,e.strokeWidth=this.strokeWidth,e.textAnchor=this.textAnchor,e.alignmentBaseline=this.alignmentBaseline,e.visibility=this.visibility,e.color=this.color,e.fillRule=this.fillRule,e.contextFill=this.contextFill,e.contextStroke=this.contextStroke,e},t.default=function(){var e=new t;return e.xmlSpace="default",e.whiteSpace="normal",e.fill=new Nr(new Ca("rgb(0, 0, 0)")),e.fillOpacity=1,e.fontFamily="times",e.fontSize=16,e.fontStyle="normal",e.fontWeight="normal",e.opacity=1,e.stroke=null,e.strokeDasharray=null,e.strokeDashoffset=0,e.strokeLinecap="butt",e.strokeLinejoin="miter",e.strokeMiterlimit=4,e.strokeOpacity=1,e.strokeWidth=1,e.alignmentBaseline="baseline",e.textAnchor="start",e.visibility="visible",e.color=new Ca("rgb(0, 0, 0)"),e.fillRule="nonzero",e.contextFill=null,e.contextStroke=null,e},t.getContextColors=function(e,n){n===void 0&&(n=!1);var i={};return e.attributeState.contextFill&&(i.contextFill=e.attributeState.contextFill),e.attributeState.contextStroke&&(i.contextStroke=e.attributeState.contextStroke),n&&e.attributeState.color&&(i.color=e.attributeState.color),i},t})(),ec=(function(){function t(e,n){var i,r,s;this.pdf=e,this.svg2pdfParameters=n.svg2pdfParameters,this.attributeState=n.attributeState?n.attributeState.clone():zu.default(),this.viewport=n.viewport,this.refsHandler=n.refsHandler,this.styleSheets=n.styleSheets,this.textMeasure=n.textMeasure,this.transform=(i=n.transform)!==null&&i!==void 0?i:this.pdf.unitMatrix,this.withinClipPath=(r=n.withinClipPath)!==null&&r!==void 0&&r,this.withinUse=(s=n.withinUse)!==null&&s!==void 0&&s}return t.prototype.clone=function(e){var n,i,r,s;return e===void 0&&(e={}),new t(this.pdf,{svg2pdfParameters:this.svg2pdfParameters,attributeState:e.attributeState?e.attributeState.clone():this.attributeState.clone(),viewport:(n=e.viewport)!==null&&n!==void 0?n:this.viewport,refsHandler:this.refsHandler,styleSheets:this.styleSheets,textMeasure:this.textMeasure,transform:(i=e.transform)!==null&&i!==void 0?i:this.transform,withinClipPath:(r=e.withinClipPath)!==null&&r!==void 0?r:this.withinClipPath,withinUse:(s=e.withinUse)!==null&&s!==void 0?s:this.withinUse})},t})(),v_=(function(){function t(e){this.renderedElements={},this.idMap=e,this.idPrefix=String(t.instanceCounter++)}return t.prototype.getRendered=function(e,n,i){return si(this,void 0,void 0,(function(){var r,s;return ai(this,(function(a){switch(a.label){case 0:return r=this.generateKey(e,n),this.renderedElements.hasOwnProperty(r)?[2,this.renderedElements[e]]:(s=this.get(e),this.renderedElements[r]=s,[4,i(s)]);case 1:return a.sent(),[2,s]}}))}))},t.prototype.get=function(e){return this.idMap[g_(e,{isIdentifier:!0})]},t.prototype.generateKey=function(e,n){var i="";return n&&(i=["color","contextFill","contextStroke"].map((function(r){var s,a;return(a=(s=n[r])===null||s===void 0?void 0:s.toRGBA())!==null&&a!==void 0?a:""})).join("|")),this.idPrefix+"|"+e+"|"+i},t.instanceCounter=0,t})();function eb(t,e){return Math.atan2(e[1]-t[1],e[0]-t[0])}var tb=2/3;function nb(t,e){return[tb*(e[0]-t[0])+t[0],tb*(e[1]-t[1])+t[1]]}function xd(t){var e=Math.sqrt(t[0]*t[0]+t[1]*t[1]);return[t[0]/e,t[1]/e]}function su(t,e){return xd([e[0]-t[0],e[1]-t[1]])}function Qf(t,e){return[t[0]+e[0],t[1]+e[1]]}function hm(t,e){var n=t[0],i=t[1];return[e.a*n+e.c*i+e.e,e.b*n+e.d*i+e.f]}var qu=(function(){function t(){this.segments=[]}return t.prototype.moveTo=function(e,n){return this.segments.push(new mr(e,n)),this},t.prototype.lineTo=function(e,n){return this.segments.push(new Ul(e,n)),this},t.prototype.curveTo=function(e,n,i,r,s,a){return this.segments.push(new ao(e,n,i,r,s,a)),this},t.prototype.close=function(){return this.segments.push(new d1),this},t.prototype.transform=function(e){this.segments.forEach((function(n){if(n instanceof mr||n instanceof Ul||n instanceof ao){var i=hm([n.x,n.y],e);n.x=i[0],n.y=i[1]}if(n instanceof ao){var r=hm([n.x1,n.y1],e),s=hm([n.x2,n.y2],e);n.x1=r[0],n.y1=r[1],n.x2=s[0],n.y2=s[1]}}))},t.prototype.draw=function(e){var n=e.pdf;this.segments.forEach((function(i){i instanceof mr?n.moveTo(i.x,i.y):i instanceof Ul?n.lineTo(i.x,i.y):i instanceof ao?n.curveTo(i.x1,i.y1,i.x2,i.y2,i.x,i.y):n.close()}))},t})(),mr=function(t,e){this.x=t,this.y=e},Ul=function(t,e){this.x=t,this.y=e},ao=function(t,e,n,i,r,s){this.x1=t,this.y1=e,this.x2=n,this.y2=i,this.x=r,this.y=s},d1=function(){};function Kl(t,e){return e.split(",").indexOf((t.nodeName||t.tagName).toLowerCase())>=0}function ut(t,e,n,i){var r;i===void 0&&(i=n);var s=(r=t.style)===null||r===void 0?void 0:r.getPropertyValue(i);if(s)return s;var a=e.getPropertyValue(t,i);return a||t.hasAttribute(n)&&t.getAttribute(n)||void 0}function hl(t,e,n){if(ut(t.element,n.styleSheets,"display")==="none")return!1;var i=e,r=ut(t.element,n.styleSheets,"visibility");return r&&(i=r!=="hidden"),i}function tc(t,e,n){var i=hl(t,e,n);return t.element.childNodes.length!==0&&(t.children.forEach((function(r){r.isVisible(i,n)&&(i=!0)})),i)}var fR=(function(){function t(){this.markers=[]}return t.prototype.addMarker=function(e){this.markers.push(e)},t.prototype.draw=function(e){return si(this,void 0,void 0,(function(){var n,i,r,s,a,o,l,c;return ai(this,(function(u){switch(u.label){case 0:n=0,u.label=1;case 1:return n<this.markers.length?(i=this.markers[n],r=void 0,s=i.angle,a=i.anchor,o=Math.cos(s),l=Math.sin(s),r=e.pdf.Matrix(o,l,-l,o,a[0],a[1]),r=e.pdf.matrixMult(e.pdf.Matrix(e.attributeState.strokeWidth,0,0,e.attributeState.strokeWidth,0,0),r),r=e.pdf.matrixMult(r,e.transform),e.pdf.saveGraphicsState(),c=zu.getContextColors(e),[4,e.refsHandler.getRendered(i.id,c,(function(f){return f.apply(e)}))]):[3,4];case 2:u.sent(),e.pdf.doFormObject(e.refsHandler.generateKey(i.id,c),r),e.pdf.restoreGraphicsState(),u.label=3;case 3:return n++,[3,1];case 4:return[2]}}))}))},t})(),Bl=function(t,e,n,i){i===void 0&&(i=!1),this.id=t,this.anchor=e,this.angle=n,this.isStartMarker=i},P0=/url\(["']?#([^"']+)["']?\)/,hR={bottom:"bottom","text-bottom":"bottom",top:"top","text-top":"top",hanging:"hanging",middle:"middle",central:"middle",center:"middle",mathematical:"middle",ideographic:"ideographic",alphabetic:"alphabetic",baseline:"alphabetic"},ib="http://www.w3.org/2000/svg";function Ko(t,e){var n;return(n=t&&t.toString().match(/^([\-0-9.]+)em$/))?parseFloat(n[1])*e:(n=t&&t.toString().match(/^([\-0-9.]+)(px|)$/))?parseFloat(n[1]):0}function y_(t){return hR[t]||"alphabetic"}function aa(t){for(var e,n=[],i=/[+-]?(?:(?:\d+\.?\d*)|(?:\d*\.?\d+))(?:[eE][+-]?\d+)?/g;e=i.exec(t);)n.push(parseFloat(e[0]));return n}function Cu(t,e){if(t==="transparent"){var n=new Ca("rgb(0,0,0)");return n.a=0,n}if(e&&t.toLowerCase()==="currentcolor")return e.color||new Ca("rgb(0,0,0)");if(e&&t.toLowerCase()==="context-stroke")return e.contextStroke||new Ca("rgb(0,0,0)");if(e&&t.toLowerCase()==="context-fill")return e.contextFill||new Ca("rgb(0,0,0)");var i=/\s*rgba\(((?:[^,\)]*,){3}[^,\)]*)\)\s*/.exec(t);if(i){var r=aa(i[1]),s=new Ca("rgb("+r.slice(0,3).join(",")+")");return s.a=r[3],s}return new Ca(t)}var nl={"sans-serif":"helvetica",verdana:"helvetica",arial:"helvetica",fixed:"courier",monospace:"courier",terminal:"courier",serif:"times",cursive:"times",fantasy:"times"},pm,pR=(pm=Ut.version.split("."),parseFloat(pm[0])===2&&parseFloat(pm[1])===3);function b_(t,e){return pR?e==400?t=="italic"?"italic":"normal":e==700&&t!=="italic"?"bold":t+""+e:e==400||e==="normal"?t==="italic"?"italic":"normal":e!=700&&e!=="bold"||t!=="normal"?(e==700?"bold":e)+""+t:"bold"}function E0(t,e){if(ut(e.element,t.styleSheets,"display")==="none")return[0,0,0,0];var n=[];return e.children.forEach((function(i){var r=i.getBoundingBox(t);if(r[0]!==0||r[1]!==0||r[2]!==0||r[3]!==0){var s=i.computeNodeTransform(t);r[0]=r[0]*s.sx+s.tx,r[1]=r[1]*s.sy+s.ty,r[2]=r[2]*s.sx,r[3]=r[3]*s.sy,n=n.length===0?r:[Math.min(n[0],r[0]),Math.min(n[1],r[1]),Math.max(n[0]+n[2],r[0]+r[2])-Math.min(n[0],r[0]),Math.max(n[1]+n[3],r[1]+r[3])-Math.min(n[1],r[1])]}})),n.length===0?[0,0,0,0]:n}function tf(t,e){var n=parseFloat,i=n(t.getAttribute("x1"))||n(ut(t,e.styleSheets,"x"))||n(ut(t,e.styleSheets,"cx"))-n(ut(t,e.styleSheets,"r"))||0,r=n(t.getAttribute("x2"))||i+n(ut(t,e.styleSheets,"width"))||n(ut(t,e.styleSheets,"cx"))+n(ut(t,e.styleSheets,"r"))||0,s=n(t.getAttribute("y1"))||n(ut(t,e.styleSheets,"y"))||n(ut(t,e.styleSheets,"cy"))-n(ut(t,e.styleSheets,"r"))||0,a=n(t.getAttribute("y2"))||s+n(ut(t,e.styleSheets,"height"))||n(ut(t,e.styleSheets,"cy"))+n(ut(t,e.styleSheets,"r"))||0;return[Math.min(i,r),Math.min(s,a),Math.max(i,r)-Math.min(i,r),Math.max(s,a)-Math.min(s,a)]}function nf(t,e,n,i,r,s,a,o){o===void 0&&(o=!1);var l,c,u=e[0],f=e[1],p=e[2],d=e[3],y=r/p,m=s/d,w=t.getAttribute("preserveAspectRatio");if(w){var b=w.split(" ");b[0]==="defer"&&(b=b.slice(1)),l=b[0],c=b[1]||"meet"}else l="xMidYMid",c="meet";if(l!=="none"&&(c==="meet"?y=m=Math.min(y,m):c==="slice"&&(y=m=Math.max(y,m))),o)return a.pdf.Matrix(y,0,0,m,0,0);var S=n-u*y,A=i-f*m;l.indexOf("xMid")>=0?S+=(r-p*y)/2:l.indexOf("xMax")>=0&&(S+=r-p*y),l.indexOf("YMid")>=0?A+=(s-d*m)/2:l.indexOf("YMax")>=0&&(A+=s-d*m);var _=a.pdf.Matrix(1,0,0,1,S,A),I=a.pdf.Matrix(y,0,0,m,0,0);return a.pdf.matrixMult(I,_)}function Lp(t,e){if(!t||t==="none")return e.pdf.unitMatrix;for(var n,i,r=/^[\s,]*matrix\(([^)]+)\)\s*/,s=/^[\s,]*translate\(([^)]+)\)\s*/,a=/^[\s,]*rotate\(([^)]+)\)\s*/,o=/^[\s,]*scale\(([^)]+)\)\s*/,l=/^[\s,]*skewX\(([^)]+)\)\s*/,c=/^[\s,]*skewY\(([^)]+)\)\s*/,u=e.pdf.unitMatrix;t.length>0&&t.length!==i;){i=t.length;var f=r.exec(t);if(f&&(n=aa(f[1]),u=e.pdf.matrixMult(e.pdf.Matrix(n[0],n[1],n[2],n[3],n[4],n[5]),u),t=t.substr(f[0].length)),f=a.exec(t)){n=aa(f[1]);var p=Math.PI*n[0]/180;if(u=e.pdf.matrixMult(e.pdf.Matrix(Math.cos(p),Math.sin(p),-Math.sin(p),Math.cos(p),0,0),u),n[1]||n[2]){var d=e.pdf.Matrix(1,0,0,1,n[1],n[2]),y=e.pdf.Matrix(1,0,0,1,-n[1],-n[2]);u=e.pdf.matrixMult(y,e.pdf.matrixMult(u,d))}t=t.substr(f[0].length)}(f=s.exec(t))&&(n=aa(f[1]),u=e.pdf.matrixMult(e.pdf.Matrix(1,0,0,1,n[0],n[1]||0),u),t=t.substr(f[0].length)),(f=o.exec(t))&&((n=aa(f[1]))[1]||(n[1]=n[0]),u=e.pdf.matrixMult(e.pdf.Matrix(n[0],0,0,n[1],0,0),u),t=t.substr(f[0].length)),(f=l.exec(t))&&(n=parseFloat(f[1]),n*=Math.PI/180,u=e.pdf.matrixMult(e.pdf.Matrix(1,0,Math.tan(n),1,0,0),u),t=t.substr(f[0].length)),(f=c.exec(t))&&(n=parseFloat(f[1]),n*=Math.PI/180,u=e.pdf.matrixMult(e.pdf.Matrix(1,Math.tan(n),0,1,0,0),u),t=t.substr(f[0].length))}return u}var I0=(function(){function t(e,n){this.element=e,this.children=n,this.parent=null}return t.prototype.setParent=function(e){this.parent=e},t.prototype.getParent=function(){return this.parent},t.prototype.getBoundingBox=function(e){return ut(this.element,e.styleSheets,"display")==="none"?[0,0,0,0]:this.getBoundingBoxCore(e)},t.prototype.computeNodeTransform=function(e){var n=this.computeNodeTransformCore(e),i=ut(this.element,e.styleSheets,"transform");return i?e.pdf.matrixMult(n,Lp(i,e)):n},t})(),rf=(function(t){function e(){return t!==null&&t.apply(this,arguments)||this}return Zn(e,t),e.prototype.render=function(n){return Promise.resolve()},e.prototype.getBoundingBoxCore=function(n){return[]},e.prototype.computeNodeTransformCore=function(n){return n.pdf.unitMatrix},e})(I0),w_=(function(t){function e(n,i,r){var s=t.call(this,i,r)||this;return s.pdfGradientType=n,s.contextColor=void 0,s}return Zn(e,t),e.prototype.apply=function(n){return si(this,void 0,void 0,(function(){var i,r,s,a,o,l;return ai(this,(function(c){return(i=this.element.getAttribute("id"))?(r=this.getStops(n.styleSheets),s=0,a=!1,r.forEach((function(u){var f=u.opacity;f&&f!==1&&(s+=f,a=!0)})),a&&(o=new Dc({opacity:s/r.length})),l=new Hl(this.pdfGradientType,this.getCoordinates(),r,o),n.pdf.addShadingPattern(i,l),[2]):[2]}))}))},e.prototype.getStops=function(n){var i=this;if(this.stops)return this.stops;if(this.contextColor===void 0){this.contextColor=null;for(var r=this;r;){var s=ut(r.element,n,"color");if(s){this.contextColor=Cu(s,null);break}r=r.getParent()}}var a=[];return this.children.forEach((function(o){if(o.element.tagName.toLowerCase()==="stop"){var l=ut(o.element,n,"color"),c=Cu(ut(o.element,n,"stop-color")||"",l?{color:Cu(l,null)}:{color:i.contextColor}),u=parseFloat(ut(o.element,n,"stop-opacity")||"1");a.push({offset:e.parseGradientOffset(o.element.getAttribute("offset")||"0"),color:[c.r,c.g,c.b],opacity:u})}})),this.stops=a},e.prototype.getBoundingBoxCore=function(n){return tf(this.element,n)},e.prototype.computeNodeTransformCore=function(n){return n.pdf.unitMatrix},e.prototype.isVisible=function(n,i){return tc(this,n,i)},e.parseGradientOffset=function(n){var i=parseFloat(n);return!isNaN(i)&&n.indexOf("%")>=0?i/100:i},e})(rf),x_=(function(t){function e(n,i){return t.call(this,"axial",n,i)||this}return Zn(e,t),e.prototype.getCoordinates=function(){return[parseFloat(this.element.getAttribute("x1")||"0"),parseFloat(this.element.getAttribute("y1")||"0"),parseFloat(this.element.getAttribute("x2")||"1"),parseFloat(this.element.getAttribute("y2")||"0")]},e})(w_),__=(function(t){function e(n,i){return t.call(this,"radial",n,i)||this}return Zn(e,t),e.prototype.getCoordinates=function(){var n=this.element.getAttribute("cx"),i=this.element.getAttribute("cy"),r=this.element.getAttribute("fx"),s=this.element.getAttribute("fy");return[parseFloat(r||n||"0.5"),parseFloat(s||i||"0.5"),0,parseFloat(n||"0.5"),parseFloat(i||"0.5"),parseFloat(this.element.getAttribute("r")||"0.5")]},e})(w_),gR=(function(){function t(e,n){this.key=e,this.gradient=n}return t.prototype.getFillData=function(e,n){return si(this,void 0,void 0,(function(){var i,r,s;return ai(this,(function(a){switch(a.label){case 0:return[4,n.refsHandler.getRendered(this.key,null,(function(o){return o.apply(new ec(n.pdf,{refsHandler:n.refsHandler,textMeasure:n.textMeasure,styleSheets:n.styleSheets,viewport:n.viewport,svg2pdfParameters:n.svg2pdfParameters}))}))];case 1:return a.sent(),this.gradient.element.hasAttribute("gradientUnits")&&this.gradient.element.getAttribute("gradientUnits").toLowerCase()!=="objectboundingbox"?i=n.pdf.unitMatrix:(r=e.getBoundingBox(n),i=n.pdf.Matrix(r[2],0,0,r[3],r[0],r[1])),s=Lp(ut(this.gradient.element,n.styleSheets,"gradientTransform","transform"),n),[2,{key:this.key,matrix:n.pdf.matrixMult(s,i)}]}}))}))},t})(),S_=(function(t){function e(){return t!==null&&t.apply(this,arguments)||this}return Zn(e,t),e.prototype.apply=function(n){return si(this,void 0,void 0,(function(){var i,r,s,a,o;return ai(this,(function(l){switch(l.label){case 0:if(!(i=this.element.getAttribute("id")))return[2];r=this.getBoundingBox(n),s=new _c([r[0],r[1],r[0]+r[2],r[1]+r[3]],r[2],r[3]),n.pdf.beginTilingPattern(s),a=0,o=this.children,l.label=1;case 1:return a<o.length?[4,o[a].render(new ec(n.pdf,{attributeState:n.attributeState,refsHandler:n.refsHandler,styleSheets:n.styleSheets,viewport:n.viewport,svg2pdfParameters:n.svg2pdfParameters,textMeasure:n.textMeasure}))]:[3,4];case 2:l.sent(),l.label=3;case 3:return a++,[3,1];case 4:return n.pdf.endTilingPattern(i,s),[2]}}))}))},e.prototype.getBoundingBoxCore=function(n){return tf(this.element,n)},e.prototype.computeNodeTransformCore=function(n){return n.pdf.unitMatrix},e.prototype.isVisible=function(n,i){return tc(this,n,i)},e})(rf),mR=(function(){function t(e,n){this.key=e,this.pattern=n}return t.prototype.getFillData=function(e,n){return si(this,void 0,void 0,(function(){var i,r,s,a,o,l,c,u,f,p,d,y;return ai(this,(function(m){switch(m.label){case 0:return[4,n.refsHandler.getRendered(this.key,null,(function(w){return w.apply(new ec(n.pdf,{refsHandler:n.refsHandler,textMeasure:n.textMeasure,styleSheets:n.styleSheets,viewport:n.viewport,svg2pdfParameters:n.svg2pdfParameters}))}))];case 1:return m.sent(),i={key:this.key,boundingBox:void 0,xStep:0,yStep:0,matrix:void 0},s=n.pdf.unitMatrix,this.pattern.element.hasAttribute("patternUnits")&&this.pattern.element.getAttribute("patternUnits").toLowerCase()!=="objectboundingbox"||(r=e.getBoundingBox(n),s=n.pdf.Matrix(1,0,0,1,r[0],r[1]),o=this.pattern.getBoundingBox(n),l=o[0]*r[0]||0,c=o[1]*r[1]||0,u=o[2]*r[2]||0,f=o[3]*r[3]||0,i.boundingBox=[l,c,l+u,c+f],i.xStep=u,i.yStep=f),a=n.pdf.unitMatrix,this.pattern.element.hasAttribute("patternContentUnits")&&this.pattern.element.getAttribute("patternContentUnits").toLowerCase()==="objectboundingbox"&&(r||(r=e.getBoundingBox(n)),a=n.pdf.Matrix(r[2],0,0,r[3],0,0),o=i.boundingBox||this.pattern.getBoundingBox(n),l=o[0]/r[0]||0,c=o[1]/r[1]||0,u=o[2]/r[2]||0,f=o[3]/r[3]||0,i.boundingBox=[l,c,l+u,c+f],i.xStep=u,i.yStep=f),p=n.pdf.unitMatrix,(d=ut(this.pattern.element,n.styleSheets,"patternTransform","transform"))&&(p=Lp(d,n)),y=a,y=n.pdf.matrixMult(y,s),y=n.pdf.matrixMult(y,p),y=n.pdf.matrixMult(y,n.transform),i.matrix=y,[2,i]}}))}))},t})();function vR(t,e){var n=P0.exec(t);if(n){var i=n[1],r=e.refsHandler.get(i);return r&&(r instanceof x_||r instanceof __)?(function(a,o,l){var c=o.getStops(l.styleSheets);if(c.length===0)return null;if(c.length===1){var u=c[0].color,f=new Ca;return f.ok=!0,f.r=u[0],f.g=u[1],f.b=u[2],f.a=c[0].opacity,new Nr(f)}return new gR(a,o)})(i,r,e):r&&r instanceof S_?new mR(i,r):new Nr(new Ca("rgb(0, 0, 0)"))}var s=Cu(t,e.attributeState);return s.ok?new Nr(s):null}function L0(t,e,n){var i=n||e.element,r=ut(i,t.styleSheets,"color");if(r){var s=Cu(r,t.attributeState);s.ok?t.attributeState.color=s:t.attributeState.color=new Ca("rgb(0,0,0)")}var a=ut(i,t.styleSheets,"visibility");a&&(t.attributeState.visibility=a);var o=ut(i,t.styleSheets,"fill");o&&(t.attributeState.fill=vR(o,t));var l=ut(i,t.styleSheets,"fill-opacity");l&&(t.attributeState.fillOpacity=parseFloat(l));var c=ut(i,t.styleSheets,"stroke-opacity");c&&(t.attributeState.strokeOpacity=parseFloat(c));var u=ut(i,t.styleSheets,"opacity");u&&(t.attributeState.opacity=parseFloat(u));var f=ut(i,t.styleSheets,"stroke-width");f!==void 0&&f!==""&&(t.attributeState.strokeWidth=Math.abs(parseFloat(f)));var p=ut(i,t.styleSheets,"stroke");if(p)if(p==="none")t.attributeState.stroke=null;else{var d=Cu(p,t.attributeState);d.ok&&(t.attributeState.stroke=new Nr(d))}p&&t.attributeState.stroke instanceof Nr&&(t.attributeState.contextStroke=t.attributeState.stroke.color),o&&t.attributeState.fill instanceof Nr&&(t.attributeState.contextFill=t.attributeState.fill.color);var y=ut(i,t.styleSheets,"stroke-linecap");y&&(t.attributeState.strokeLinecap=y);var m=ut(i,t.styleSheets,"stroke-linejoin");m&&(t.attributeState.strokeLinejoin=m);var w=ut(i,t.styleSheets,"stroke-dasharray");if(w){var b=parseInt(ut(i,t.styleSheets,"stroke-dashoffset")||"0");t.attributeState.strokeDasharray=aa(w),t.attributeState.strokeDashoffset=b}var S=ut(i,t.styleSheets,"stroke-miterlimit");S!==void 0&&S!==""&&(t.attributeState.strokeMiterlimit=parseFloat(S));var A=i.getAttribute("xml:space");A&&(t.attributeState.xmlSpace=A);var _=ut(i,t.styleSheets,"white-space");_&&(t.attributeState.whiteSpace=_);var I=ut(i,t.styleSheets,"font-weight");I&&(t.attributeState.fontWeight=I);var E=ut(i,t.styleSheets,"font-style");E&&(t.attributeState.fontStyle=E);var M=ut(i,t.styleSheets,"font-family");if(M){var T=nR.parse(M);t.attributeState.fontFamily=(function(F,q,Z){var W=b_(F.fontStyle,F.fontWeight),Y=Z.pdf.getFontList(),ue="";return q.some((function(le){var O=Y[le];return O&&O.indexOf(W)>=0?(ue=le,!0):(le=le.toLowerCase(),!!nl.hasOwnProperty(le)&&(ue=le,!0))}))||(ue="times"),ue})(t.attributeState,T,t)}var D=ut(i,t.styleSheets,"font-size");if(D){var U=t.pdf.getFontSize();t.attributeState.fontSize=Ko(D,U)}var C=ut(i,t.styleSheets,"vertical-align")||ut(i,t.styleSheets,"alignment-baseline");if(C){var N=C.match(/(baseline|text-bottom|alphabetic|ideographic|middle|central|mathematical|text-top|bottom|center|top|hanging)/);N&&(t.attributeState.alignmentBaseline=N[0])}var B=ut(i,t.styleSheets,"text-anchor");B&&(t.attributeState.textAnchor=B);var P=ut(i,t.styleSheets,"fill-rule");P&&(t.attributeState.fillRule=P)}function M0(t,e,n){var i=1,r=1;i*=t.attributeState.fillOpacity,i*=t.attributeState.opacity,t.attributeState.fill instanceof Nr&&t.attributeState.fill.color.a!==void 0&&(i*=t.attributeState.fill.color.a),r*=t.attributeState.strokeOpacity,r*=t.attributeState.opacity,t.attributeState.stroke instanceof Nr&&t.attributeState.stroke.color.a!==void 0&&(r*=t.attributeState.stroke.color.a);var s,a,o=i<1,l=r<1;if(Kl(n,"use")?(o=!0,l=!0,i*=t.attributeState.fill?1:0,r*=t.attributeState.stroke?1:0):t.withinUse&&(t.attributeState.fill!==e.attributeState.fill?(o=!0,i*=t.attributeState.fill?1:0):o&&!t.attributeState.fill&&(i=0),t.attributeState.stroke!==e.attributeState.stroke?(l=!0,r*=t.attributeState.stroke?1:0):l&&!t.attributeState.stroke&&(r=0)),o||l){var c={};o&&(c.opacity=i),l&&(c["stroke-opacity"]=r),t.pdf.setGState(new Dc(c))}if(t.attributeState.fill&&t.attributeState.fill!==e.attributeState.fill&&t.attributeState.fill instanceof Nr&&t.attributeState.fill.color.ok&&!Kl(n,"text")&&t.pdf.setFillColor(t.attributeState.fill.color.r,t.attributeState.fill.color.g,t.attributeState.fill.color.b),t.attributeState.strokeWidth!==e.attributeState.strokeWidth&&t.pdf.setLineWidth(t.attributeState.strokeWidth),t.attributeState.stroke!==e.attributeState.stroke&&t.attributeState.stroke instanceof Nr&&t.pdf.setDrawColor(t.attributeState.stroke.color.r,t.attributeState.stroke.color.g,t.attributeState.stroke.color.b),t.attributeState.strokeLinecap!==e.attributeState.strokeLinecap&&t.pdf.setLineCap(t.attributeState.strokeLinecap),t.attributeState.strokeLinejoin!==e.attributeState.strokeLinejoin&&t.pdf.setLineJoin(t.attributeState.strokeLinejoin),t.attributeState.strokeDasharray===e.attributeState.strokeDasharray&&t.attributeState.strokeDashoffset===e.attributeState.strokeDashoffset||!t.attributeState.strokeDasharray||t.pdf.setLineDashPattern(t.attributeState.strokeDasharray,t.attributeState.strokeDashoffset),t.attributeState.strokeMiterlimit!==e.attributeState.strokeMiterlimit&&t.pdf.setLineMiterLimit(t.attributeState.strokeMiterlimit),t.attributeState.fontFamily!==e.attributeState.fontFamily&&(s=nl.hasOwnProperty(t.attributeState.fontFamily)?nl[t.attributeState.fontFamily]:t.attributeState.fontFamily),t.attributeState.fill&&t.attributeState.fill!==e.attributeState.fill&&t.attributeState.fill instanceof Nr&&t.attributeState.fill.color.ok){var u=t.attributeState.fill.color;t.pdf.setTextColor(u.r,u.g,u.b)}t.attributeState.fontWeight===e.attributeState.fontWeight&&t.attributeState.fontStyle===e.attributeState.fontStyle||(a=b_(t.attributeState.fontStyle,t.attributeState.fontWeight)),s===void 0&&a===void 0||(s===void 0&&(s=nl.hasOwnProperty(t.attributeState.fontFamily)?nl[t.attributeState.fontFamily]:t.attributeState.fontFamily),t.pdf.setFont(s,a)),t.attributeState.fontSize!==e.attributeState.fontSize&&t.pdf.setFontSize(t.attributeState.fontSize*t.pdf.internal.scaleFactor)}function k_(t,e,n){var i=P0.exec(t);if(i){var r=i[1];return n.refsHandler.get(r)||void 0}}function A_(t,e,n){return si(this,void 0,void 0,(function(){var i,r;return ai(this,(function(s){switch(s.label){case 0:return i=n.clone(),e.element.hasAttribute("clipPathUnits")&&e.element.getAttribute("clipPathUnits").toLowerCase()==="objectboundingbox"&&(r=t.getBoundingBox(n),i.transform=n.pdf.matrixMult(n.pdf.Matrix(r[2],0,0,r[3],r[0],r[1]),n.transform)),[4,e.apply(i)];case 1:return s.sent(),[2]}}))}))}var N_=(function(t){function e(){return t!==null&&t.apply(this,arguments)||this}return Zn(e,t),e.prototype.render=function(n){return si(this,void 0,void 0,(function(){var i,r,s,a;return ai(this,(function(o){switch(o.label){case 0:return this.isVisible(n.attributeState.visibility!=="hidden",n)?((i=n.clone()).transform=i.pdf.matrixMult(this.computeNodeTransform(i),n.transform),L0(i,this),r=ut(this.element,i.styleSheets,"clip-path"),(s=r&&r!=="none")?(a=k_(r,0,i))?a.isVisible(!0,i)?(i.pdf.saveGraphicsState(),[4,A_(this,a,i)]):[3,2]:[3,4]:[3,5]):[2];case 1:return o.sent(),[3,3];case 2:return[2];case 3:return[3,5];case 4:s=!1,o.label=5;case 5:return i.withinClipPath||i.pdf.saveGraphicsState(),M0(i,n,this.element),[4,this.renderCore(i)];case 6:return o.sent(),i.withinClipPath||i.pdf.restoreGraphicsState(),s&&i.pdf.restoreGraphicsState(),[2]}}))}))},e})(I0),Mp=(function(t){function e(){return t!==null&&t.apply(this,arguments)||this}return Zn(e,t),e})(N_),sf=(function(t){function e(n,i,r){var s=t.call(this,i,r)||this;return s.cachedPath=null,s.hasMarkers=n,s}return Zn(e,t),e.prototype.renderCore=function(n){return si(this,void 0,void 0,(function(){var i;return ai(this,(function(r){switch(r.label){case 0:return(i=this.getCachedPath(n))===null||i.segments.length===0?[2]:(n.withinClipPath?i.transform(n.transform):n.pdf.setCurrentTransformationMatrix(n.transform),i.draw(n),[4,this.fillOrStroke(n)]);case 1:return r.sent(),this.hasMarkers?[4,this.drawMarkers(n,i)]:[3,3];case 2:r.sent(),r.label=3;case 3:return[2]}}))}))},e.prototype.getCachedPath=function(n){return this.cachedPath||(this.cachedPath=this.getPath(n))},e.prototype.drawMarkers=function(n,i){return si(this,void 0,void 0,(function(){return ai(this,(function(r){switch(r.label){case 0:return[4,this.getMarkers(i,n).draw(n.clone({transform:n.pdf.unitMatrix}))];case 1:return r.sent(),[2]}}))}))},e.prototype.fillOrStroke=function(n){return si(this,void 0,void 0,(function(){var i,r,s,a,o;return ai(this,(function(l){switch(l.label){case 0:return n.withinClipPath?[2]:(i=n.attributeState.fill,r=n.attributeState.stroke&&n.attributeState.strokeWidth!==0,i?[4,i.getFillData(this,n)]:[3,2]);case 1:return a=l.sent(),[3,3];case 2:a=void 0,l.label=3;case 3:return s=a,o=n.attributeState.fillRule==="evenodd",i&&r||n.withinUse?o?n.pdf.fillStrokeEvenOdd(s):n.pdf.fillStroke(s):i?o?n.pdf.fillEvenOdd(s):n.pdf.fill(s):r?n.pdf.stroke():n.pdf.discardPath(),[2]}}))}))},e.prototype.getBoundingBoxCore=function(n){var i=this.getCachedPath(n);if(!i||!i.segments.length)return[0,0,0,0];for(var r=Number.POSITIVE_INFINITY,s=Number.POSITIVE_INFINITY,a=Number.NEGATIVE_INFINITY,o=Number.NEGATIVE_INFINITY,l=0,c=0,u=0;u<i.segments.length;u++){var f=i.segments[u];(f instanceof mr||f instanceof Ul||f instanceof ao)&&(l=f.x,c=f.y),f instanceof ao?(r=Math.min(r,l,f.x1,f.x2,f.x),a=Math.max(a,l,f.x1,f.x2,f.x),s=Math.min(s,c,f.y1,f.y2,f.y),o=Math.max(o,c,f.y1,f.y2,f.y)):(r=Math.min(r,l),a=Math.max(a,l),s=Math.min(s,c),o=Math.max(o,c))}return[r,s,a-r,o-s]},e.prototype.getMarkers=function(n,i){var r=ut(this.element,i.styleSheets,"marker-start"),s=ut(this.element,i.styleSheets,"marker-mid"),a=ut(this.element,i.styleSheets,"marker-end"),o=new fR;if(r||s||a){a&&(a=gm(a)),r&&(r=gm(r)),s&&(s=gm(s));for(var l=n.segments,c=[1,0],u=void 0,f=!1,p=[1,0],d=!1,y=function(w){var b=l[w],S=r&&(w===1||!(l[w]instanceof mr)&&l[w-1]instanceof mr);S&&l.forEach((function(T,D){if(!d&&T instanceof d1&&D>w){var U=l[D-1];d=(U instanceof mr||U instanceof Ul||U instanceof ao)&&U}}));var A=a&&(w===l.length-1||!(l[w]instanceof mr)&&l[w+1]instanceof mr),_=s&&w>0&&!(w===1&&l[w-1]instanceof mr),I=l[w-1]||null;if(I instanceof mr||I instanceof Ul||I instanceof ao)if(b instanceof ao)S&&o.addMarker(new Bl(r,[I.x,I.y],eb(d?[d.x,d.y]:[I.x,I.y],[b.x1,b.y1]),!0)),A&&o.addMarker(new Bl(a,[b.x,b.y],eb([b.x2,b.y2],[b.x,b.y]))),_&&(u=su([I.x,I.y],[b.x1,b.y1]),u=I instanceof mr?u:xd(Qf(c,u)),o.addMarker(new Bl(s,[I.x,I.y],Math.atan2(u[1],u[0])))),c=su([b.x2,b.y2],[b.x,b.y]);else if(b instanceof mr||b instanceof Ul){if(u=su([I.x,I.y],[b.x,b.y]),S){var E=d?su([d.x,d.y],[b.x,b.y]):u;o.addMarker(new Bl(r,[I.x,I.y],Math.atan2(E[1],E[0]),!0))}A&&o.addMarker(new Bl(a,[b.x,b.y],Math.atan2(u[1],u[0]))),_&&(E=b instanceof mr?c:I instanceof mr?u:xd(Qf(c,u)),o.addMarker(new Bl(s,[I.x,I.y],Math.atan2(E[1],E[0])))),c=u}else b instanceof d1&&(u=su([I.x,I.y],[f.x,f.y]),_&&(E=I instanceof mr?u:xd(Qf(c,u)),o.addMarker(new Bl(s,[I.x,I.y],Math.atan2(E[1],E[0])))),A&&(E=xd(Qf(u,p)),o.addMarker(new Bl(a,[f.x,f.y],Math.atan2(E[1],E[0])))),c=u);else{f=b instanceof mr&&b;var M=l[w+1];(M instanceof mr||M instanceof Ul||M instanceof ao)&&(p=su([f.x,f.y],[M.x,M.y]))}},m=0;m<l.length;m++)y(m)}return o.markers.forEach((function(w){var b=i.refsHandler.get(w.id);if(b){var S=ut(b.element,i.styleSheets,"orient");S!=null&&(w.isStartMarker&&S==="auto-start-reverse"&&(w.angle+=Math.PI),isNaN(Number(S))||(w.angle=parseFloat(S)/180*Math.PI))}})),o},e})(Mp);function gm(t){var e=P0.exec(t);return e&&e[1]||void 0}var yR=(function(t){function e(n,i){return t.call(this,!0,n,i)||this}return Zn(e,t),e.prototype.getPath=function(n){if(n.withinClipPath||n.attributeState.stroke===null)return null;var i=parseFloat(this.element.getAttribute("x1")||"0"),r=parseFloat(this.element.getAttribute("y1")||"0"),s=parseFloat(this.element.getAttribute("x2")||"0"),a=parseFloat(this.element.getAttribute("y2")||"0");return i||s||r||a?new qu().moveTo(i,r).lineTo(s,a):null},e.prototype.computeNodeTransformCore=function(n){return n.pdf.unitMatrix},e.prototype.isVisible=function(n,i){return hl(this,n,i)},e.prototype.fillOrStroke=function(n){return si(this,void 0,void 0,(function(){return ai(this,(function(i){switch(i.label){case 0:return n.attributeState.fill=null,[4,t.prototype.fillOrStroke.call(this,n)];case 1:return i.sent(),[2]}}))}))},e})(sf),C_=(function(t){function e(){return t!==null&&t.apply(this,arguments)||this}return Zn(e,t),e.prototype.apply=function(n){return si(this,void 0,void 0,(function(){var i,r,s,a,o;return ai(this,(function(l){switch(l.label){case 0:return this.isVisible(n.attributeState.visibility!=="hidden",n)?((i=n.clone()).transform=i.pdf.unitMatrix,L0(i,this),r=ut(this.element,i.styleSheets,"clip-path"),r&&r!=="none"&&(s=k_(r,0,i))?s.isVisible(!0,i)?[4,A_(this,s,i)]:[3,2]:[3,3]):[2];case 1:return l.sent(),[3,3];case 2:return[2];case 3:M0(i,n,this.element),a=0,o=this.children,l.label=4;case 4:return a<o.length?[4,o[a].render(i)]:[3,7];case 5:l.sent(),l.label=6;case 6:return a++,[3,4];case 7:return[2]}}))}))},e.prototype.getBoundingBoxCore=function(n){return E0(n,this)},e.prototype.isVisible=function(n,i){return tc(this,n,i)},e.prototype.computeNodeTransformCore=function(n){var i=parseFloat(ut(this.element,n.styleSheets,"x")||"0"),r=parseFloat(ut(this.element,n.styleSheets,"y")||"0"),s=this.element.getAttribute("viewBox");if(s){var a=aa(s),o=parseFloat(ut(this.element,n.styleSheets,"width")||ut(this.element.ownerSVGElement,n.styleSheets,"width")||s[2]),l=parseFloat(ut(this.element,n.styleSheets,"height")||ut(this.element.ownerSVGElement,n.styleSheets,"height")||s[3]);return nf(this.element,a,i,r,o,l,n)}return n.pdf.Matrix(1,0,0,1,i,r)},e})(rf),Tp=function(t,e){this.width=t,this.height=e},bR=(function(t){function e(){return t!==null&&t.apply(this,arguments)||this}return Zn(e,t),e.prototype.renderCore=function(n){return si(this,void 0,void 0,(function(){var i,r,s,a,o,l,c,u,f,p,d,y,m;return ai(this,(function(w){switch(w.label){case 0:return i=parseFloat,(r=this.element.getAttribute("href")||this.element.getAttribute("xlink:href"))?(s=r.substring(1),a=n.refsHandler.get(s),o=Kl(a.element,"symbol,svg")&&a.element.hasAttribute("viewBox"),l=i(ut(this.element,n.styleSheets,"x")||"0"),c=i(ut(this.element,n.styleSheets,"y")||"0"),u=void 0,f=void 0,o?(u=i(ut(this.element,n.styleSheets,"width")||ut(a.element,n.styleSheets,"width")||"0"),f=i(ut(this.element,n.styleSheets,"height")||ut(a.element,n.styleSheets,"height")||"0"),l+=i(ut(a.element,n.styleSheets,"x")||"0"),c+=i(ut(a.element,n.styleSheets,"y")||"0"),d=aa(a.element.getAttribute("viewBox")),p=nf(a.element,d,l,c,u,f,n)):p=n.pdf.Matrix(1,0,0,1,l,c),y=zu.getContextColors(n,!0),m=new ec(n.pdf,{refsHandler:n.refsHandler,styleSheets:n.styleSheets,withinUse:!0,viewport:o?new Tp(u,f):n.viewport,svg2pdfParameters:n.svg2pdfParameters,textMeasure:n.textMeasure,attributeState:Object.assign(zu.default(),y)}),[4,n.refsHandler.getRendered(s,y,(function(b){return e.renderReferencedNode(b,s,m)}))]):[2];case 1:return w.sent(),n.pdf.saveGraphicsState(),n.pdf.setCurrentTransformationMatrix(n.transform),o&&ut(a.element,n.styleSheets,"overflow")!=="visible"&&(n.pdf.rect(l,c,u,f),n.pdf.clip().discardPath()),n.pdf.doFormObject(n.refsHandler.generateKey(s,y),p),n.pdf.restoreGraphicsState(),[2]}}))}))},e.renderReferencedNode=function(n,i,r){return si(this,void 0,void 0,(function(){var s;return ai(this,(function(a){switch(a.label){case 0:return s=[(s=n.getBoundingBox(r))[0]-.5*s[2],s[1]-.5*s[3],2*s[2],2*s[3]],r.pdf.beginFormObject(s[0],s[1],s[2],s[3],r.pdf.unitMatrix),n instanceof C_?[4,n.apply(r)]:[3,2];case 1:return a.sent(),[3,4];case 2:return[4,n.render(r)];case 3:a.sent(),a.label=4;case 4:return r.pdf.endFormObject(r.refsHandler.generateKey(i,r.attributeState)),[2]}}))}))},e.prototype.getBoundingBoxCore=function(n){return tf(this.element,n)},e.prototype.isVisible=function(n,i){return hl(this,n,i)},e.prototype.computeNodeTransformCore=function(n){return n.pdf.unitMatrix},e})(Mp),wR=(function(t){function e(n,i){return t.call(this,!1,n,i)||this}return Zn(e,t),e.prototype.getPath=function(n){var i=parseFloat(ut(this.element,n.styleSheets,"width")||"0"),r=parseFloat(ut(this.element,n.styleSheets,"height")||"0");if(!isFinite(i)||i<=0||!isFinite(r)||r<=0)return null;var s=ut(this.element,n.styleSheets,"rx"),a=ut(this.element,n.styleSheets,"ry"),o=Math.min(parseFloat(s||a||"0"),.5*i),l=Math.min(parseFloat(a||s||"0"),.5*r),c=parseFloat(ut(this.element,n.styleSheets,"x")||"0"),u=parseFloat(ut(this.element,n.styleSheets,"y")||"0"),f=4/3*(Math.SQRT2-1);return o===0&&l===0?new qu().moveTo(c,u).lineTo(c+i,u).lineTo(c+i,u+r).lineTo(c,u+r).close():new qu().moveTo(c+=o,u).lineTo(c+=i-2*o,u).curveTo(c+o*f,u,c+o,u+(l-l*f),c+=o,u+=l).lineTo(c,u+=r-2*l).curveTo(c,u+l*f,c-o*f,u+l,c-=o,u+=l).lineTo(c+=2*o-i,u).curveTo(c-o*f,u,c-o,u-l*f,c-=o,u-=l).lineTo(c,u+=2*l-r).curveTo(c,u-l*f,c+o*f,u-l,c+=o,u-=l).close()},e.prototype.computeNodeTransformCore=function(n){return n.pdf.unitMatrix},e.prototype.isVisible=function(n,i){return hl(this,n,i)},e})(sf),P_=(function(t){function e(n,i){return t.call(this,!1,n,i)||this}return Zn(e,t),e.prototype.getPath=function(n){var i=this.getRx(n),r=this.getRy(n);if(!isFinite(i)||r<=0||!isFinite(r)||r<=0)return null;var s=parseFloat(ut(this.element,n.styleSheets,"cx")||"0"),a=parseFloat(ut(this.element,n.styleSheets,"cy")||"0"),o=4/3*(Math.SQRT2-1)*i,l=4/3*(Math.SQRT2-1)*r;return new qu().moveTo(s+i,a).curveTo(s+i,a-l,s+o,a-r,s,a-r).curveTo(s-o,a-r,s-i,a-l,s-i,a).curveTo(s-i,a+l,s-o,a+r,s,a+r).curveTo(s+o,a+r,s+i,a+l,s+i,a)},e.prototype.computeNodeTransformCore=function(n){return n.pdf.unitMatrix},e.prototype.isVisible=function(n,i){return hl(this,n,i)},e})(sf),xR=(function(t){function e(n,i){return t.call(this,n,i)||this}return Zn(e,t),e.prototype.getRx=function(n){return parseFloat(ut(this.element,n.styleSheets,"rx")||"0")},e.prototype.getRy=function(n){return parseFloat(ut(this.element,n.styleSheets,"ry")||"0")},e})(P_);function E_(t){var e="invisible",n=t.stroke&&t.strokeWidth!==0,i=t.fill;return i&&n?e="fillThenStroke":i?e="fill":n&&(e="stroke"),e}function rb(t){return t.replace(/[\n\r]/g,"")}function sb(t){return t.replace(/[\t]/g," ")}function ab(t){return t.replace(/ +/g," ")}function ob(t,e,n){switch(ut(t,n.styleSheets,"text-transform")){case"uppercase":return e.toUpperCase();case"lowercase":return e.toLowerCase();default:return e}}var mm=(function(){function t(e,n,i,r){this.textNode=e,this.texts=[],this.textNodes=[],this.contexts=[],this.textAnchor=n,this.originX=i,this.originY=r,this.textMeasures=[]}return t.prototype.setX=function(e){this.originX=e},t.prototype.setY=function(e){this.originY=e},t.prototype.add=function(e,n,i){this.texts.push(n),this.textNodes.push(e),this.contexts.push(i)},t.prototype.rightTrimText=function(){for(var e=this.texts.length-1;e>=0;e--)if(this.contexts[e].attributeState.xmlSpace==="preserve"||this.contexts[e].attributeState.whiteSpace==="pre"||(this.texts[e]=this.texts[e].replace(/\s+$/,"")),this.texts[e].match(/[^\s]/))return!1;return!0},t.prototype.measureText=function(e){for(var n=0;n<this.texts.length;n++)this.textMeasures.push({width:e.textMeasure.measureTextWidth(this.texts[n],this.contexts[n].attributeState),length:this.texts[n].length})},t.prototype.put=function(e,n){var i,r,s,a,o=[],l=[],c=[],u=this.originX,f=this.originY,p=u,d=u;for(i=0;i<this.textNodes.length;i++){r=this.textNodes[i],s=this.contexts[i],a=this.textMeasures[i]||{width:e.textMeasure.measureTextWidth(this.texts[i],this.contexts[i].attributeState),length:this.texts[i].length};var y=u,m=f;if(r.nodeName!=="#text"&&!o.includes(r)){o.push(r);var w=t.resolveRelativePositionAttribute(r,"dx");w!==null&&(y+=Ko(w,s.attributeState.fontSize));var b=t.resolveRelativePositionAttribute(r,"dy");b!==null&&(m+=Ko(b,s.attributeState.fontSize))}l[i]=y,c[i]=m,u=y+a.width+a.length*n,f=m,p=Math.min(p,y),d=Math.max(d,u)}var S=0;switch(this.textAnchor){case"start":S=0;break;case"middle":S=(d-p)/2;break;case"end":S=d-p}for(i=0;i<this.textNodes.length;i++)if(r=this.textNodes[i],s=this.contexts[i],r.nodeName==="#text"||s.attributeState.visibility!=="hidden"){e.pdf.saveGraphicsState(),M0(s,e,r);var A=s.attributeState.alignmentBaseline,_=E_(s.attributeState);e.pdf.text(this.texts[i],l[i]-S,c[i],{baseline:y_(A),angle:e.transform,renderingMode:_==="fill"?void 0:_,charSpace:n===0?void 0:n}),e.pdf.restoreGraphicsState()}return[u,f]},t.resolveRelativePositionAttribute=function(e,n){for(var i,r=e;r&&Kl(r,"tspan");){if(r.hasAttribute(n))return r.getAttribute(n);if(((i=e.parentElement)===null||i===void 0?void 0:i.firstChild)!==e)break;r=r.parentElement}return null},t})(),_R=(function(t){function e(){var n=t!==null&&t.apply(this,arguments)||this;return n.boundingBox=[],n}return Zn(e,t),e.prototype.processTSpans=function(n,i,r,s,a,o){for(var l=r.pdf.getFontSize(),c=r.attributeState.xmlSpace==="preserve"||r.attributeState.whiteSpace==="pre",u=!0,f=!1,p=0;p<i.childNodes.length;p++){var d=i.childNodes[p];if(d.textContent){var y=d.textContent;if(d.nodeName==="#text"){var m=rb(y);m=sb(m),c||(m=ab(m),u&&m.match(/^\s/)&&(f=!0),m.match(/[^\s]/)&&(u=!1),o.prevText.match(/\s$/)&&(m=m.replace(/^\s+/,"")));var w=ob(i,m,r);a.add(i,w,r),o.prevText=y,o.prevContext=r}else if(!Kl(d,"title")){if(Kl(d,"tspan")){var b=d,S=b.getAttribute("x");if(S!==null){var A=Ko(S,l);a=new mm(this,ut(b,r.styleSheets,"text-anchor")||r.attributeState.textAnchor,A,0),s.push({type:"y",chunk:a})}var _=b.getAttribute("y");if(_!==null){var I=Ko(_,l);a=new mm(this,ut(b,r.styleSheets,"text-anchor")||r.attributeState.textAnchor,0,I),s.push({type:"x",chunk:a})}var E=r.clone();L0(E,n,b),this.processTSpans(n,b,E,s,a,o)}}}}return f},e.prototype.renderCore=function(n){return si(this,void 0,void 0,(function(){var i,r,s,a,o,l,c,u,f,p,d,y,m,w,b,S,A,_,I,E,M,T,D;return ai(this,(function(U){if(n.pdf.saveGraphicsState(),i=0,r=0,s=1,a=n.pdf.getFontSize(),o=Ko(this.element.getAttribute("x"),a),l=Ko(this.element.getAttribute("y"),a),c=Ko(this.element.getAttribute("dx"),a),u=Ko(this.element.getAttribute("dy"),a),f=parseFloat(this.element.getAttribute("textLength")||"0"),p=n.attributeState.visibility,this.element.childElementCount===0)d=this.element.textContent||"",y=(function(C,N){return C=sb(C=rb(C)),N.xmlSpace==="preserve"||N.whiteSpace==="pre"||(C=ab(C=C.trim())),C})(d,n.attributeState),m=ob(this.element,y,n),i=n.textMeasure.getTextOffset(m,n.attributeState),f>0&&(w=n.textMeasure.measureTextWidth(m,n.attributeState),!(n.attributeState.xmlSpace==="preserve"||n.attributeState.whiteSpace==="pre")&&d.match(/^\s/)&&(s=0),r=(f-w)/(m.length-s)||0),p==="visible"&&(b=n.attributeState.alignmentBaseline,S=E_(n.attributeState),n.pdf.text(m,o+c-i,l+u,{baseline:y_(b),angle:n.transform,renderingMode:S==="fill"?void 0:S,charSpace:r===0?void 0:r}),this.boundingBox=[o+c-i,l+u+.1*a,n.textMeasure.measureTextWidth(m,n.attributeState),a]);else{for(A=[],_=new mm(this,n.attributeState.textAnchor,o+c,l+u),A.push({type:"",chunk:_}),I=this.processTSpans(this,this.element,n,A,_,{prevText:" ",prevContext:n}),s=I?0:1,E=!0,M=A.length-1;M>=0;M--)E&&(E=A[M].chunk.rightTrimText());f>0&&(T=0,D=0,A.forEach((function(C){var N=C.chunk;N.measureText(n),N.textMeasures.forEach((function(B){var P=B.width,F=B.length;T+=P,D+=F}))})),r=(f-T)/(D-s)),A.reduce((function(C,N){var B=N.type,P=N.chunk;return B==="x"?P.setX(C[0]):B==="y"&&P.setY(C[1]),P.put(n,r)}),[0,0])}return n.pdf.restoreGraphicsState(),[2]}))}))},e.prototype.isVisible=function(n,i){return tc(this,n,i)},e.prototype.getBoundingBoxCore=function(n){return this.boundingBox.length>0?this.boundingBox:tf(this.element,n)},e.prototype.computeNodeTransformCore=function(n){return n.pdf.unitMatrix},e})(Mp),SR=(function(t){function e(n,i){return t.call(this,!0,n,i)||this}return Zn(e,t),e.prototype.computeNodeTransformCore=function(n){return n.pdf.unitMatrix},e.prototype.isVisible=function(n,i){return hl(this,n,i)},e.prototype.getPath=function(n){var i,r,s=new uR(ut(this.element,n.styleSheets,"d")||"").unshort().unarc().abs(),a=new qu;return s.iterate((function(o){switch(o[0]){case"M":a.moveTo(o[1],o[2]);break;case"L":a.lineTo(o[1],o[2]);break;case"H":a.lineTo(o[1],r);break;case"V":a.lineTo(i,o[1]);break;case"C":a.curveTo(o[1],o[2],o[3],o[4],o[5],o[6]);break;case"Q":var l=nb([i,r],[o[1],o[2]]),c=nb([o[3],o[4]],[o[1],o[2]]);a.curveTo(l[0],l[1],c[0],c[1],o[3],o[4]);break;case"Z":a.close()}switch(o[0]){case"M":case"L":i=o[1],r=o[2];break;case"H":i=o[1];break;case"V":r=o[1];break;case"C":i=o[5],r=o[6];break;case"Q":i=o[3],r=o[4]}})),a},e})(sf),kR=/^\s*data:(([^/,;]+\/[^/,;]+)(?:;([^,;=]+=[^,;=]+))?)?(?:;(base64))?,((?:.|\s)*)$/i,AR=(function(t){function e(n,i){var r=t.call(this,n,i)||this;return r.imageLoadingPromise=null,r.imageUrl=r.element.getAttribute("xlink:href")||r.element.getAttribute("href"),r.imageUrl&&(r.imageLoadingPromise=e.fetchImageData(r.imageUrl)),r}return Zn(e,t),e.prototype.renderCore=function(n){return si(this,void 0,void 0,(function(){var i,r,s,a,o,l,c,u,f,p,d,y,m,w,b,S,A,_;return ai(this,(function(I){switch(I.label){case 0:return this.imageLoadingPromise?(n.pdf.setCurrentTransformationMatrix(n.transform),i=parseFloat(ut(this.element,n.styleSheets,"width")||"0"),r=parseFloat(ut(this.element,n.styleSheets,"height")||"0"),s=parseFloat(ut(this.element,n.styleSheets,"x")||"0"),a=parseFloat(ut(this.element,n.styleSheets,"y")||"0"),!isFinite(i)||i<=0||!isFinite(r)||r<=0?[2]:[4,this.imageLoadingPromise]):[2];case 1:return o=I.sent(),l=o.data,(c=o.format).indexOf("svg")!==0?[3,3]:(u=new DOMParser,f=u.parseFromString(l,"image/svg+xml").firstElementChild,(!(p=this.element.getAttribute("preserveAspectRatio"))||p.indexOf("defer")<0||!f.getAttribute("preserveAspectRatio"))&&f.setAttribute("preserveAspectRatio",p||""),f.setAttribute("x",String(s)),f.setAttribute("y",String(a)),f.setAttribute("width",String(i)),f.setAttribute("height",String(r)),[4,T0(f,d={}).render(new ec(n.pdf,{refsHandler:new v_(d),styleSheets:n.styleSheets,viewport:new Tp(i,r),svg2pdfParameters:n.svg2pdfParameters,textMeasure:n.textMeasure}))]);case 2:return I.sent(),[2];case 3:y="data:image/".concat(c,";base64,").concat(btoa(l)),I.label=4;case 4:return I.trys.push([4,6,,7]),[4,e.getImageDimensions(y)];case 5:return m=I.sent(),w=m[0],b=m[1],S=[0,0,w,b],A=nf(this.element,S,s,a,i,r,n),n.pdf.setCurrentTransformationMatrix(A),n.pdf.addImage(y,"",0,0,w,b),[3,7];case 6:return _=I.sent(),typeof console=="object"&&console.warn&&console.warn("Could not load image ".concat(this.imageUrl,`. 
`).concat(_)),[3,7];case 7:return[2]}}))}))},e.prototype.getBoundingBoxCore=function(n){return tf(this.element,n)},e.prototype.computeNodeTransformCore=function(n){return n.pdf.unitMatrix},e.prototype.isVisible=function(n,i){return hl(this,n,i)},e.fetchImageData=function(n){return si(this,void 0,void 0,(function(){var i,r,s,a,o;return ai(this,(function(l){switch(l.label){case 0:if(!(s=n.match(kR)))return[3,1];if(a=s[2],(o=a.split("/"))[0]!=="image")throw new Error("Unsupported image URL: ".concat(n));return r=o[1],i=s[5],s[4]==="base64"?(i=i.replace(/\s/g,""),i=atob(i)):i=decodeURIComponent(i),[3,3];case 1:return[4,e.fetchImage(n)];case 2:i=l.sent(),r=n.substring(n.lastIndexOf(".")+1),l.label=3;case 3:return[2,{data:i,format:r}]}}))}))},e.fetchImage=function(n){return new Promise((function(i,r){var s=new XMLHttpRequest;s.open("GET",n,!0),s.responseType="arraybuffer",s.onload=function(){if(s.status!==200)throw new Error("Error ".concat(s.status,": Failed to load image '").concat(n,"'"));for(var a=new Uint8Array(s.response),o="",l=0;l<a.length;l++)o+=String.fromCharCode(a[l]);i(o)},s.onerror=r,s.onabort=r,s.send(null)}))},e.getMimeType=function(n){switch(n=n.toLowerCase()){case"jpg":case"jpeg":return"image/jpeg";default:return"image/".concat(n)}},e.getImageDimensions=function(n){return new Promise((function(i,r){var s=new Image;s.onload=function(){i([s.width,s.height])},s.onerror=r,s.src=n}))},e})(Mp),I_=(function(t){function e(n,i,r){var s=t.call(this,!0,i,r)||this;return s.closed=n,s}return Zn(e,t),e.prototype.getPath=function(n){if(!this.element.hasAttribute("points")||this.element.getAttribute("points")==="")return null;var i=e.parsePointsString(this.element.getAttribute("points")),r=new qu;if(i.length<1)return r;r.moveTo(i[0][0],i[0][1]);for(var s=1;s<i.length;s++)r.lineTo(i[s][0],i[s][1]);return this.closed&&r.close(),r},e.prototype.isVisible=function(n,i){return hl(this,n,i)},e.prototype.computeNodeTransformCore=function(n){return n.pdf.unitMatrix},e.parsePointsString=function(n){for(var i=aa(n),r=[],s=0;s<i.length-1;s+=2){var a=i[s],o=i[s+1];r.push([a,o])}return r},e})(sf),NR=(function(t){function e(n,i){return t.call(this,!0,n,i)||this}return Zn(e,t),e})(I_),CR=(function(t){function e(){return t!==null&&t.apply(this,arguments)||this}return Zn(e,t),e.prototype.render=function(n){return Promise.resolve()},e.prototype.getBoundingBoxCore=function(n){return[0,0,0,0]},e.prototype.computeNodeTransformCore=function(n){return n.pdf.unitMatrix},e.prototype.isVisible=function(n,i){return hl(this,n,i)},e})(I0),PR=(function(t){function e(){return t!==null&&t.apply(this,arguments)||this}return Zn(e,t),e.prototype.apply=function(n){return si(this,void 0,void 0,(function(){var i,r,s,a,o,l;return ai(this,(function(c){switch(c.label){case 0:i=this.computeNodeTransform(n),r=this.getBoundingBox(n),n.pdf.beginFormObject(r[0],r[1],r[2],r[3],i),s=zu.getContextColors(n),(function(u){var f=u.attributeState,p=u.pdf,d=1,y=1;d*=f.fillOpacity,d*=f.opacity,f.fill instanceof Nr&&f.fill.color.a!==void 0&&(d*=f.fill.color.a),y*=f.strokeOpacity,y*=f.opacity,f.stroke instanceof Nr&&f.stroke.color.a!==void 0&&(y*=f.stroke.color.a);var m,w={};if(w.opacity=d,w["stroke-opacity"]=y,p.setGState(new Dc(w)),f.fill&&f.fill instanceof Nr&&f.fill.color.ok?p.setFillColor(f.fill.color.r,f.fill.color.g,f.fill.color.b):p.setFillColor(0,0,0),p.setLineWidth(f.strokeWidth),f.stroke instanceof Nr?p.setDrawColor(f.stroke.color.r,f.stroke.color.g,f.stroke.color.b):p.setDrawColor(0,0,0),p.setLineCap(f.strokeLinecap),p.setLineJoin(f.strokeLinejoin),f.strokeDasharray?p.setLineDashPattern(f.strokeDasharray,f.strokeDashoffset):p.setLineDashPattern([],0),p.setLineMiterLimit(f.strokeMiterlimit),m=nl.hasOwnProperty(f.fontFamily)?nl[f.fontFamily]:f.fontFamily,f.fill&&f.fill instanceof Nr&&f.fill.color.ok){var b=f.fill.color;p.setTextColor(b.r,b.g,b.b)}else p.setTextColor(0,0,0);var S="";f.fontWeight==="bold"&&(S="bold"),f.fontStyle==="italic"&&(S+="italic"),S===""&&(S="normal"),m!==void 0||S!==void 0?(m===void 0&&(m=nl.hasOwnProperty(f.fontFamily)?nl[f.fontFamily]:f.fontFamily),p.setFont(m,S)):p.setFont("helvetica",S),p.setFontSize(f.fontSize*p.internal.scaleFactor)})(a=new ec(n.pdf,{refsHandler:n.refsHandler,styleSheets:n.styleSheets,viewport:n.viewport,svg2pdfParameters:n.svg2pdfParameters,textMeasure:n.textMeasure,attributeState:Object.assign(zu.default(),s)})),o=0,l=this.children,c.label=1;case 1:return o<l.length?[4,l[o].render(a)]:[3,4];case 2:c.sent(),c.label=3;case 3:return o++,[3,1];case 4:return n.pdf.endFormObject(a.refsHandler.generateKey(this.element.getAttribute("id"),s)),[2]}}))}))},e.prototype.getBoundingBoxCore=function(n){var i,r=this.element.getAttribute("viewBox");return r&&(i=aa(r)),[i&&i[0]||0,i&&i[1]||0,i&&i[2]||parseFloat(this.element.getAttribute("markerWidth")||"3"),i&&i[3]||parseFloat(this.element.getAttribute("markerHeight")||"3")]},e.prototype.computeNodeTransformCore=function(n){var i,r=parseFloat(this.element.getAttribute("refX")||"0"),s=parseFloat(this.element.getAttribute("refY")||"0"),a=this.element.getAttribute("viewBox");if(a){var o=aa(a);i=nf(this.element,o,0,0,parseFloat(this.element.getAttribute("markerWidth")||"3"),parseFloat(this.element.getAttribute("markerHeight")||"3"),n,!0),i=n.pdf.matrixMult(n.pdf.Matrix(1,0,0,1,-r,-s),i)}else i=n.pdf.Matrix(1,0,0,1,-r,-s);return i},e.prototype.isVisible=function(n,i){return tc(this,n,i)},e})(rf),ER=(function(t){function e(n,i){return t.call(this,n,i)||this}return Zn(e,t),e.prototype.getR=function(n){var i;return(i=this.r)!==null&&i!==void 0?i:this.r=parseFloat(ut(this.element,n.styleSheets,"r")||"0")},e.prototype.getRx=function(n){return this.getR(n)},e.prototype.getRy=function(n){return this.getR(n)},e})(P_),IR=(function(t){function e(n,i){return t.call(this,!1,n,i)||this}return Zn(e,t),e})(I_),L_=(function(t){function e(){return t!==null&&t.apply(this,arguments)||this}return Zn(e,t),e.prototype.renderCore=function(n){return si(this,void 0,void 0,(function(){var i,r;return ai(this,(function(s){switch(s.label){case 0:i=0,r=this.children,s.label=1;case 1:return i<r.length?[4,r[i].render(n)]:[3,4];case 2:s.sent(),s.label=3;case 3:return i++,[3,1];case 4:return[2]}}))}))},e.prototype.getBoundingBoxCore=function(n){return E0(n,this)},e})(N_),LR=(function(t){function e(){return t!==null&&t.apply(this,arguments)||this}return Zn(e,t),e.prototype.isVisible=function(n,i){return tc(this,n,i)},e.prototype.render=function(n){return si(this,void 0,void 0,(function(){var i,r,s,a,o;return ai(this,(function(l){switch(l.label){case 0:return this.isVisible(n.attributeState.visibility!=="hidden",n)?(i=this.getX(n),r=this.getY(n),s=this.getWidth(n),a=this.getHeight(n),n.pdf.saveGraphicsState(),o=n.transform,this.element.hasAttribute("transform")&&(o=n.pdf.matrixMult(Lp(this.element.getAttribute("transform"),n),o)),n.pdf.setCurrentTransformationMatrix(o),n.withinUse||ut(this.element,n.styleSheets,"overflow")==="visible"||n.pdf.rect(i,r,s,a).clip().discardPath(),[4,t.prototype.render.call(this,n.clone({transform:n.pdf.unitMatrix,viewport:n.withinUse?n.viewport:new Tp(s,a)}))]):[2];case 1:return l.sent(),n.pdf.restoreGraphicsState(),[2]}}))}))},e.prototype.computeNodeTransform=function(n){return this.computeNodeTransformCore(n)},e.prototype.computeNodeTransformCore=function(n){if(n.withinUse)return n.pdf.unitMatrix;var i,r=this.getX(n),s=this.getY(n),a=this.getViewBox();if(a){var o=this.getWidth(n),l=this.getHeight(n);i=nf(this.element,a,r,s,o,l,n)}else i=n.pdf.Matrix(1,0,0,1,r,s);return i},e.prototype.getWidth=function(n){if(this.width!==void 0)return this.width;var i,r,s=n.svg2pdfParameters;if(this.isOutermostSvg(n))if(s.width!=null)i=s.width;else if(r=ut(this.element,n.styleSheets,"width"))i=parseFloat(r);else{var a=this.getViewBox();if(a&&(s.height!=null||ut(this.element,n.styleSheets,"height"))){var o=a[2]/a[3];i=this.getHeight(n)*o}else i=Math.min(300,n.viewport.width,2*n.viewport.height)}else i=(r=ut(this.element,n.styleSheets,"width"))?parseFloat(r):n.viewport.width;return this.width=i},e.prototype.getHeight=function(n){if(this.height!==void 0)return this.height;var i,r,s=n.svg2pdfParameters;if(this.isOutermostSvg(n))if(s.height!=null)i=s.height;else if(r=ut(this.element,n.styleSheets,"height"))i=parseFloat(r);else{var a=this.getViewBox();if(a){var o=a[2]/a[3];i=this.getWidth(n)/o}else i=Math.min(150,n.viewport.width/2,n.viewport.height)}else i=(r=ut(this.element,n.styleSheets,"height"))?parseFloat(r):n.viewport.height;return this.height=i},e.prototype.getX=function(n){if(this.x!==void 0)return this.x;if(this.isOutermostSvg(n))return this.x=0;var i=ut(this.element,n.styleSheets,"x");return this.x=i?parseFloat(i):0},e.prototype.getY=function(n){if(this.y!==void 0)return this.y;if(this.isOutermostSvg(n))return this.y=0;var i=ut(this.element,n.styleSheets,"y");return this.y=i?parseFloat(i):0},e.prototype.getViewBox=function(){if(this.viewBox!==void 0)return this.viewBox;var n=this.element.getAttribute("viewBox");return this.viewBox=n?aa(n):void 0},e.prototype.isOutermostSvg=function(n){return n.svg2pdfParameters.element===this.element},e})(L_),M_=(function(t){function e(){return t!==null&&t.apply(this,arguments)||this}return Zn(e,t),e.prototype.isVisible=function(n,i){return tc(this,n,i)},e.prototype.computeNodeTransformCore=function(n){return n.pdf.unitMatrix},e})(L_),MR=(function(t){function e(){return t!==null&&t.apply(this,arguments)||this}return Zn(e,t),e.prototype.renderCore=function(n){return si(this,void 0,void 0,(function(){var i,r,s,a;return ai(this,(function(o){switch(o.label){case 0:return[4,t.prototype.renderCore.call(this,n)];case 1:return o.sent(),(i=ut(this.element,n.styleSheets,"href"))&&(r=this.getBoundingBox(n),s=n.pdf.internal.scaleFactor,a=n.pdf.internal.pageSize.getHeight(),n.pdf.link(s*(r[0]*n.transform.sx+n.transform.tx),a-s*(r[1]*n.transform.sy+n.transform.ty),s*r[2],s*r[3],{url:i})),[2]}}))}))},e})(M_),TR=(function(t){function e(){return t!==null&&t.apply(this,arguments)||this}return Zn(e,t),e.prototype.apply=function(n){return si(this,void 0,void 0,(function(){var i,r,s,a,o;return ai(this,(function(l){switch(l.label){case 0:if(!this.isVisible(!0,n))return[2];i=n.pdf.matrixMult(this.computeNodeTransform(n),n.transform),n.pdf.setCurrentTransformationMatrix(i),r=0,s=this.children,l.label=1;case 1:return r<s.length?[4,s[r].render(new ec(n.pdf,{refsHandler:n.refsHandler,styleSheets:n.styleSheets,viewport:n.viewport,withinClipPath:!0,svg2pdfParameters:n.svg2pdfParameters,textMeasure:n.textMeasure}))]:[3,4];case 2:l.sent(),l.label=3;case 3:return r++,[3,1];case 4:return a=this.children.length>0&&!!ut(this.children[0].element,n.styleSheets,"clip-rule"),o=a?this.getClipRuleAttr(this.children[0].element,n.styleSheets):this.getClipRuleAttr(this.element,n.styleSheets),n.pdf.clip(o).discardPath(),n.pdf.setCurrentTransformationMatrix(i.inversed()),[2]}}))}))},e.prototype.getBoundingBoxCore=function(n){return E0(n,this)},e.prototype.isVisible=function(n,i){return tc(this,n,i)},e.prototype.getClipRuleAttr=function(n,i){return ut(n,i,"clip-rule")==="evenodd"?"evenodd":void 0},e})(rf);function T0(t,e){var n,i=[];switch((function(s,a){for(var o=[],l=0;l<s.childNodes.length;l++){var c=s.childNodes[l];c.nodeName.charAt(0)!=="#"&&o.push(c)}for(l=0;l<o.length;l++)a(l,o[l])})(t,(function(s,a){return i.push(T0(a,e))})),t.tagName.toLowerCase()){case"a":n=new MR(t,i);break;case"g":n=new M_(t,i);break;case"circle":n=new ER(t,i);break;case"clippath":n=new TR(t,i);break;case"ellipse":n=new xR(t,i);break;case"lineargradient":n=new x_(t,i);break;case"image":n=new AR(t,i);break;case"line":n=new yR(t,i);break;case"marker":n=new PR(t,i);break;case"path":n=new SR(t,i);break;case"pattern":n=new S_(t,i);break;case"polygon":n=new NR(t,i);break;case"polyline":n=new IR(t,i);break;case"radialgradient":n=new __(t,i);break;case"rect":n=new wR(t,i);break;case"svg":n=new LR(t,i);break;case"symbol":n=new C_(t,i);break;case"text":n=new _R(t,i);break;case"use":n=new bR(t,i);break;default:n=new CR(t,i)}if(e!=null&&n.element.hasAttribute("id")){var r=g_(n.element.id,{isIdentifier:!0});e[r]=e[r]||n}return n.children.forEach((function(s){return s.setParent(n)})),n}var DR=(function(){function t(e,n){this.rootSvg=e,this.loadExternalSheets=n,this.styleSheets=[]}return t.prototype.load=function(){return si(this,void 0,void 0,(function(){var e;return ai(this,(function(n){switch(n.label){case 0:return[4,this.collectStyleSheetTexts()];case 1:return e=n.sent(),this.parseCssSheets(e),[2]}}))}))},t.prototype.collectStyleSheetTexts=function(){return si(this,void 0,void 0,(function(){var e,n,i,r,s;return ai(this,(function(a){switch(a.label){case 0:if(e=[],this.loadExternalSheets&&this.rootSvg.ownerDocument)for(r=0;r<this.rootSvg.ownerDocument.childNodes.length;r++)(n=this.rootSvg.ownerDocument.childNodes[r]).nodeName==="xml-stylesheet"&&typeof n.data=="string"&&e.push(t.loadSheet(n.data.match(/href=["'].*?["']/)[0].split("=")[1].slice(1,-1)));for(i=this.rootSvg.querySelectorAll("style,link"),r=0;r<i.length;r++)Kl(s=i[r],"style")?e.push(s.textContent):this.loadExternalSheets&&Kl(s,"link")&&s.getAttribute("rel")==="stylesheet"&&s.hasAttribute("href")&&e.push(t.loadSheet(s.getAttribute("href")));return[4,Promise.all(e)];case 1:return[2,a.sent().filter((function(o){return o!==null}))]}}))}))},t.prototype.parseCssSheets=function(e){for(var n=document.implementation.createHTMLDocument(""),i=0,r=e;i<r.length;i++){var s=r[i],a=n.createElement("style");a.textContent=s,n.body.appendChild(a);var o=a.sheet;if(o instanceof CSSStyleSheet){for(var l=o.cssRules.length-1;l>=0;l--){var c=o.cssRules[l];if(c instanceof CSSStyleRule){var u=c;if(u.selectorText.indexOf(",")>=0){o.deleteRule(l);for(var f=u.cssText.substring(u.selectorText.length),p=t.splitSelectorAtCommas(u.selectorText),d=0;d<p.length;d++)o.insertRule(p[d]+f,l+d)}}else o.deleteRule(l)}this.styleSheets.push(o)}}},t.splitSelectorAtCommas=function(e){for(var n,i=/,|["']/g,r=/[^\\]["]/g,s=/[^\\][']/g,a=[],o="initial",l=-1,c=r,u=0;u<e.length;)switch(o){case"initial":i.lastIndex=u,(n=i.exec(e))?(n[0]===","?(a.push(e.substring(l+1,i.lastIndex-1).trim()),l=i.lastIndex-1):(o="withinQuotes",c=n[0]==='"'?r:s),u=i.lastIndex):(a.push(e.substring(l+1).trim()),u=e.length);break;case"withinQuotes":c.lastIndex=u,(n=c.exec(e))&&(u=c.lastIndex,o="initial")}return a},t.loadSheet=function(e){return new Promise((function(n,i){var r=new XMLHttpRequest;r.open("GET",e,!0),r.responseType="text",r.onload=function(){r.status!==200&&i(new Error("Error ".concat(r.status,": Failed to load '").concat(e,"'"))),n(r.responseText)},r.onerror=i,r.onabort=i,r.send(null)})).catch((function(){return null}))},t.prototype.getPropertyValue=function(e,n){for(var i=[],r=0,s=this.styleSheets;r<s.length;r++)for(var a=s[r],o=0;o<a.cssRules.length;o++){var l=a.cssRules[o];l.style.getPropertyValue(n)&&e.matches(l.selectorText)&&i.push(l)}if(i.length!==0)return i.reduce((function(c,u){return p=u,((d=(f=c).style.getPropertyPriority(n))!==p.style.getPropertyPriority(n)?d==="important"?1:-1:dR(f.selectorText,p.selectorText))===1?c:u;var f,p,d})).style.getPropertyValue(n)||void 0},t})(),OR=(function(){function t(){this.measureMethods={}}return t.prototype.getTextOffset=function(e,n){var i=n.textAnchor;if(i==="start")return 0;var r=this.measureTextWidth(e,n),s=0;switch(i){case"end":s=r;break;case"middle":s=r/2}return s},t.prototype.measureTextWidth=function(e,n){if(e.length===0)return 0;var i=n.fontFamily;return this.getMeasureFunction(i).call(this,e,n.fontFamily,n.fontSize+"px",n.fontStyle,n.fontWeight)},t.prototype.getMeasurementTextNode=function(){if(!this.textMeasuringTextElement){this.textMeasuringTextElement=document.createElementNS(ib,"text");var e=document.createElementNS(ib,"svg");e.appendChild(this.textMeasuringTextElement),e.style.setProperty("position","absolute"),e.style.setProperty("visibility","hidden"),document.body.appendChild(e)}return this.textMeasuringTextElement},t.prototype.canvasTextMeasure=function(e,n,i,r,s){var a=document.createElement("canvas").getContext("2d");return a!=null?(a.font=[r,s,i,n].join(" "),a.measureText(e).width):0},t.prototype.svgTextMeasure=function(e,n,i,r,s,a){a===void 0&&(a=this.getMeasurementTextNode());var o=a;return o.setAttribute("font-family",n),o.setAttribute("font-size",i),o.setAttribute("font-style",r),o.setAttribute("font-weight",s),o.setAttributeNS("http://www.w3.org/XML/1998/namespace","xml:space","preserve"),o.textContent=e,o.getBBox().width},t.prototype.getMeasureFunction=function(e){var n=this.measureMethods[e];if(!n){var i="16px",r="normal",s="normal",a=this.canvasTextMeasure(t.testString,e,i,r,s),o=this.svgTextMeasure(t.testString,e,i,r,s);n=Math.abs(a-o)<t.epsilon?this.canvasTextMeasure:this.svgTextMeasure,this.measureMethods[e]=n}return n},t.prototype.cleanupTextMeasuring=function(){if(this.textMeasuringTextElement){var e=this.textMeasuringTextElement.parentNode;e&&document.body.removeChild(e),this.textMeasuringTextElement=void 0}},t.testString=`abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ 0123456789!"$%&/()=?'\\+*-_.:,;^}][{#~|<>`,t.epsilon=.1,t})();function FR(t,e){return si(this,arguments,void 0,(function(n,i,r){var s,a,o,l,c,u,f,p,d,y,m,w,b,S;return r===void 0&&(r={}),ai(this,(function(A){switch(A.label){case 0:return s=(w=r.x)!==null&&w!==void 0?w:0,a=(b=r.y)!==null&&b!==void 0?b:0,o=(S=r.loadExternalStyleSheets)!==null&&S!==void 0&&S,c=new v_(l={}),[4,(u=new DR(n,o)).load()];case 1:return A.sent(),f=new Tp(i.internal.pageSize.getWidth(),i.internal.pageSize.getHeight()),p=ep(ep({},r),{element:n}),d=new OR,y=new ec(i,{refsHandler:c,styleSheets:u,viewport:f,svg2pdfParameters:p,textMeasure:d}),i.advancedAPI(),i.saveGraphicsState(),i.setCurrentTransformationMatrix(i.Matrix(1,0,0,1,s,a)),i.setLineWidth(y.attributeState.strokeWidth),m=y.attributeState.fill.color,i.setFillColor(m.r,m.g,m.b),i.setFont(y.attributeState.fontFamily),i.setFontSize(y.attributeState.fontSize*i.internal.scaleFactor),[4,T0(n,l).render(y)];case 2:return A.sent(),i.restoreGraphicsState(),i.compatAPI(),y.textMeasure.cleanupTextMeasuring(),[2,i]}}))}))}Ut.API.svg=function(t,e){return e===void 0&&(e={}),FR(t,this,e)};var Oc="http://www.w3.org/2000/svg",Fc="http://www.w3.org/1999/xlink",RR="http://www.w3.org/2000/xmlns/";function f1(t){return t.nodeType===Node.ELEMENT_NODE}function T_(t){return t.nodeType===Node.TEXT_NODE}function BR(t){return t.namespaceURI===Oc}function zR(t){return t instanceof HTMLImageElement}function qR(t){return t instanceof HTMLCanvasElement}function jR(t){return t instanceof HTMLInputElement||t instanceof HTMLTextAreaElement||t instanceof HTMLSelectElement}function xt(t,e){return t.createElementNS(Oc,e)}function en(t,e){for(const[n,i]of Object.entries(e))t.setAttribute(n,String(i)),n==="href"&&t.setAttributeNS(Fc,"xlink:href",String(i))}function HR(t,e){return window.getComputedStyle(t,e)}var UR=0;function WR(){return{next(t="d2s"){return`${t}-${UR++}`}}}function VR(t){return t.display==="none"}function GR(t){return t.visibility==="hidden"}function $f(t,e,n){return{width:parseFloat(t)||0,style:e,color:n}}function XR(t){return{top:$f(t.borderTopWidth,t.borderTopStyle,t.borderTopColor),right:$f(t.borderRightWidth,t.borderRightStyle,t.borderRightColor),bottom:$f(t.borderBottomWidth,t.borderBottomStyle,t.borderBottomColor),left:$f(t.borderLeftWidth,t.borderLeftStyle,t.borderLeftColor)}}function D_(t){return{topLeft:eh(t.borderTopLeftRadius),topRight:eh(t.borderTopRightRadius),bottomRight:eh(t.borderBottomRightRadius),bottomLeft:eh(t.borderBottomLeftRadius)}}function eh(t){const e=t.split(/\s+/).map(n=>parseFloat(n)||0);return[e[0]??0,e[1]??e[0]??0]}function YR(t){return t.top.width>0&&t.top.style!=="none"||t.right.width>0&&t.right.style!=="none"||t.bottom.width>0&&t.bottom.style!=="none"||t.left.width>0&&t.left.style!=="none"}function Zl(t){return t.topLeft[0]>0||t.topLeft[1]>0||t.topRight[0]>0||t.topRight[1]>0||t.bottomRight[0]>0||t.bottomRight[1]>0||t.bottomLeft[0]>0||t.bottomLeft[1]>0}function Vd(t){const[e,n]=t.topLeft;return t.topRight[0]===e&&t.topRight[1]===n&&t.bottomRight[0]===e&&t.bottomRight[1]===n&&t.bottomLeft[0]===e&&t.bottomLeft[1]===n}function O_(t){const e=new Set(["hidden","clip","scroll","auto"]);return e.has(t.overflow)||e.has(t.overflowX)||e.has(t.overflowY)}function tp(t){const e=t.backgroundColor;return!e||e==="transparent"||e==="rgba(0, 0, 0, 0)"?null:e}function F_(t){return!!t.backgroundImage&&t.backgroundImage!=="none"}function KR(t){return!!(t.position!=="static"&&t.position!==""&&t.zIndex!=="auto"||parseFloat(t.opacity)<1||t.transform&&t.transform!=="none"||t.filter&&t.filter!=="none"||t.isolation==="isolate"||t.mixBlendMode&&t.mixBlendMode!=="normal")}function ZR(t){return t.zIndex==="auto"||!t.zIndex?0:parseInt(t.zIndex,10)||0}function JR(t){return t.position!=="static"&&t.position!==""}function QR(t){return t.cssFloat!=="none"&&t.cssFloat!==""}function R_(t,e,n){const i=t.topLeft[0]+t.topRight[0],r=t.bottomLeft[0]+t.bottomRight[0],s=t.topLeft[1]+t.bottomLeft[1],a=t.topRight[1]+t.bottomRight[1];let o=1;return i>0&&(o=Math.min(o,e/i)),r>0&&(o=Math.min(o,e/r)),s>0&&(o=Math.min(o,n/s)),a>0&&(o=Math.min(o,n/a)),o>=1?t:{topLeft:[t.topLeft[0]*o,t.topLeft[1]*o],topRight:[t.topRight[0]*o,t.topRight[1]*o],bottomRight:[t.bottomRight[0]*o,t.bottomRight[1]*o],bottomLeft:[t.bottomLeft[0]*o,t.bottomLeft[1]*o]}}function $R(t){const e=t.display;return e==="inline"||e==="inline-block"||e==="inline-flex"||e==="inline-grid"||e==="inline-table"}function B_(t,e){const n=t.getBoundingClientRect(),i=e.getBoundingClientRect();return{x:n.left-i.left,y:n.top-i.top,width:n.width,height:n.height}}function af(t,e,n,i,r){const[s,a]=r.topLeft,[o,l]=r.topRight,[c,u]=r.bottomRight,[f,p]=r.bottomLeft;return[`M ${t+s} ${e}`,`L ${t+n-o} ${e}`,o||l?`A ${o} ${l} 0 0 1 ${t+n} ${e+l}`:"",`L ${t+n} ${e+i-u}`,c||u?`A ${c} ${u} 0 0 1 ${t+n-c} ${e+i}`:"",`L ${t+f} ${e+i}`,f||p?`A ${f} ${p} 0 0 1 ${t} ${e+i-p}`:"",`L ${t} ${e+a}`,s||a?`A ${s} ${a} 0 0 1 ${t+s} ${e}`:"","Z"].filter(Boolean).join(" ")}function e9(t){const e=t.match(/linear-gradient\((.+)\)/);if(!e)return null;const n=e[1],i=O0(n);if(i.length<2)return null;let r=180,s=0;const a=i[0].trim();a.startsWith("to ")?(r=s9(a),s=1):a.match(/^-?[\d.]+(?:deg|rad|turn|grad)/)&&(r=z_(a),s=1);const o=[],l=i.slice(s);for(let c=0;c<l.length;c++){const{color:u,position:f}=D0(l[c].trim(),c,l.length);o.push({color:u,position:f})}return{angle:r,stops:o}}function t9(t,e,n){const i=n.idGenerator.next("grad"),r=xt(n.svgDocument,"linearGradient"),s=e.x+e.width/2,a=e.y+e.height/2,o=t.angle*Math.PI/180,l=Math.sin(o),c=-Math.cos(o),u=Math.abs(e.width/2*l)+Math.abs(e.height/2*c),f=s-l*u,p=a-c*u,d=s+l*u,y=a+c*u;en(r,{id:i,gradientUnits:"userSpaceOnUse",x1:f.toFixed(2),y1:p.toFixed(2),x2:d.toFixed(2),y2:y.toFixed(2)});for(const m of t.stops){const w=xt(n.svgDocument,"stop");en(w,{offset:`${(m.position*100).toFixed(1)}%`,"stop-color":m.color}),r.appendChild(w)}return n.defs.appendChild(r),r}function n9(t,e,n){return t.includes("conic-gradient")?i9(t,e,n):t.includes("radial-gradient")?r9(t,e,n):null}function i9(t,e,n){const i=t.match(/conic-gradient\((.+)\)/);if(!i)return null;const r=2,s=document.createElement("canvas");s.width=Math.ceil(e*r),s.height=Math.ceil(n*r);const a=s.getContext("2d");if(!a||!("createConicGradient"in a))return null;a.scale(r,r);const o=i[1],l=O0(o);let c=0,u=0;const p=l[0].trim().match(/^from\s+(-?[\d.]+)(deg|rad|turn|grad)/);p&&(c=z_(p[1]+p[2]),u=1);const d=e/2,y=n/2,m=(c-90)*Math.PI/180,w=a.createConicGradient(m,d,y),b=l.slice(u);for(let S=0;S<b.length;S++){const A=b[S].trim(),{color:_,position:I}=D0(A,S,b.length);try{w.addColorStop(I,_)}catch{}}return a.fillStyle=w,a.fillRect(0,0,e,n),s.toDataURL("image/png")}function r9(t,e,n){const i=t.match(/radial-gradient\((.+)\)/);if(!i)return null;const r=2,s=document.createElement("canvas");s.width=Math.ceil(e*r),s.height=Math.ceil(n*r);const a=s.getContext("2d");if(!a)return null;a.scale(r,r);const o=i[1],l=O0(o);let c=!1,u=0,f=null,p=null;const d=l[0].trim();if(d==="circle"||d.startsWith("circle ")?(c=!0,u=1):(d==="ellipse"||d.startsWith("ellipse ")||d.includes("at ")&&!d.includes("#")&&!d.match(/^(rgb|hsl)/))&&(u=1),u===1){const I=d.match(/at\s+(.+)/);if(I){const E=I[1].trim().split(/\s+/);f=lb(E[0],e),p=lb(E[1]??E[0],n)}}const y=f??e/2,m=p??n/2,w=e/2,b=n/2,S=c?Math.sqrt(w*w+b*b):Math.max(w,b);a.save(),!c&&w!==b&&(a.translate(y,m),a.scale(w/S,b/S),a.translate(-y,-m));const A=a.createRadialGradient(y,m,0,y,m,S),_=l.slice(u);for(let I=0;I<_.length;I++){const E=_[I].trim(),{color:M,position:T}=D0(E,I,_.length);try{A.addColorStop(T,M)}catch{}}if(a.fillStyle=A,!c&&w!==b){const I=S/w,E=S/b;a.fillRect(y*(1-I),m*(1-E),e*I,n*E)}else a.fillRect(0,0,e,n);return a.restore(),s.toDataURL("image/png")}function D0(t,e,n){const i=t.lastIndexOf(")"),s=(i>=0?t.slice(i+1):t).match(/\s+([\d.]+%)\s*$/);if(s){const a=s[1],o=t.length-s[0].length;return{color:t.slice(0,o).trim(),position:parseFloat(a)/100}}if(i<0){const a=t.lastIndexOf(" ");if(a>0&&t.slice(a).match(/[\d.]+%/))return{color:t.slice(0,a).trim(),position:parseFloat(t.slice(a))/100}}return{color:t,position:n>1?e/(n-1):0}}function O0(t){const e=[];let n=0,i="";for(const r of t)r==="("?n++:r===")"&&n--,r===","&&n===0?(e.push(i),i=""):i+=r;return i&&e.push(i),e}function s9(t){return{"to top":0,"to right":90,"to bottom":180,"to left":270,"to top right":45,"to top left":315,"to bottom right":135,"to bottom left":225}[t]??180}function z_(t){return t.endsWith("deg")?parseFloat(t):t.endsWith("rad")?parseFloat(t)*180/Math.PI:t.endsWith("turn")?parseFloat(t)*360:t.endsWith("grad")?parseFloat(t)*.9:parseFloat(t)}function lb(t,e){if(t==="center")return e/2;if(t==="left"||t==="top")return 0;if(t==="right"||t==="bottom")return e;if(t.endsWith("%"))return parseFloat(t)/100*e;const n=parseFloat(t);return isNaN(n)?null:n}var cb=1e4,vm=4096;async function F0(t){return t.startsWith("data:")?t:new Promise(e=>{const n=new Image;n.crossOrigin="anonymous";const i=setTimeout(()=>{console.warn(`dom2svg: Image load timed out after ${cb}ms, using original URL: ${t}`),n.onload=null,n.onerror=null,e(t)},cb);n.onload=()=>{clearTimeout(i);try{const r=document.createElement("canvas");let s=n.naturalWidth,a=n.naturalHeight;if(s>vm||a>vm){const l=vm/Math.max(s,a);s=Math.round(s*l),a=Math.round(a*l)}r.width=s,r.height=a;const o=r.getContext("2d");o?(o.drawImage(n,0,0,s,a),e(r.toDataURL("image/png"))):e(t)}catch{console.warn(`dom2svg: CORS prevented inlining image, external URL will remain in SVG: ${t}`),e(t)}},n.onerror=()=>{clearTimeout(i),console.warn(`dom2svg: Failed to load image, external URL will remain in SVG: ${t}`),e(t)},n.src=t})}function q_(t){return t.match(/url\(["']?([^"')]+)["']?\)/)?.[1]??null}function a9(t){try{return t.toDataURL("image/png")}catch{return""}}function o9(t){if(!t||t==="none")return[];const e=[],n=/(\w+)\(([^)]+)\)/g;let i;for(;(i=n.exec(t))!==null;){const r=i[1],s=i[2].split(",").map(a=>a.trim());switch(r){case"matrix":{const a=s.map(parseFloat);a.length===6&&e.push({type:"matrix",values:a});break}case"translate":{const a=th(s[0]),o=s[1]?th(s[1]):0;e.push({type:"translate",x:a,y:o});break}case"translateX":{e.push({type:"translate",x:th(s[0]),y:0});break}case"translateY":{e.push({type:"translate",x:0,y:th(s[0])});break}case"scale":{const a=parseFloat(s[0]),o=s[1]?parseFloat(s[1]):a;e.push({type:"scale",x:a,y:o});break}case"scaleX":{e.push({type:"scale",x:parseFloat(s[0]),y:1});break}case"scaleY":{e.push({type:"scale",x:1,y:parseFloat(s[0])});break}case"rotate":{e.push({type:"rotate",angle:ym(s[0])});break}case"skewX":{e.push({type:"skewX",angle:ym(s[0])});break}case"skewY":{e.push({type:"skewY",angle:ym(s[0])});break}}}return e}function th(t){return parseFloat(t)||0}function ym(t){return t=t.trim(),t.endsWith("rad")?parseFloat(t)*180/Math.PI:t.endsWith("turn")?parseFloat(t)*360:t.endsWith("grad")?parseFloat(t)*.9:parseFloat(t)||0}function l9(){return[1,0,0,1,0,0]}function bm(t,e){return[t[0]*e[0]+t[2]*e[1],t[1]*e[0]+t[3]*e[1],t[0]*e[2]+t[2]*e[3],t[1]*e[2]+t[3]*e[3],t[0]*e[4]+t[2]*e[5]+t[4],t[1]*e[4]+t[3]*e[5]+t[5]]}function h1(t,e){return[1,0,0,1,t,e]}function c9(t,e){return[t,0,0,e,0,0]}function u9(t){const e=t*Math.PI/180,n=Math.cos(e),i=Math.sin(e);return[n,i,-i,n,0,0]}function d9(t){const e=t*Math.PI/180;return[1,0,Math.tan(e),1,0,0]}function f9(t){const e=t*Math.PI/180;return[1,Math.tan(e),0,1,0,0]}function h9(t){return Math.abs(t[0]-1)<1e-10&&Math.abs(t[1])<1e-10&&Math.abs(t[2])<1e-10&&Math.abs(t[3]-1)<1e-10&&Math.abs(t[4])<1e-10&&Math.abs(t[5])<1e-10}function p9(t){return`matrix(${t.map(e=>e.toFixed(6)).join(",")})`}function g9(t,e,n){const i=o9(t);if(i.length===0)return null;const[r,s]=v9(e,n);let a=l9();a=bm(a,h1(r,s));for(const o of i)a=bm(a,m9(o));return a=bm(a,h1(-r,-s)),h9(a)?null:p9(a)}function m9(t){switch(t.type){case"matrix":return t.values;case"translate":return h1(t.x,t.y);case"scale":return c9(t.x,t.y);case"rotate":return u9(t.angle);case"skewX":return d9(t.angle);case"skewY":return f9(t.angle)}}function v9(t,e){const n=t.split(/\s+/),i=ub(n[0]??"50%",e.width,e.x),r=ub(n[1]??"50%",e.height,e.y);return[i,r]}function ub(t,e,n){return t==="left"||t==="top"?n:t==="right"||t==="bottom"?n+e:t==="center"?n+e/2:t.endsWith("%")?n+parseFloat(t)/100*e:n+parseFloat(t)}function y9(t,e){const n=x9(t);if(n.length===0)return null;const i=e.idGenerator.next("filter"),r=xt(e.svgDocument,"filter");en(r,{id:i,x:"-50%",y:"-50%",width:"200%",height:"200%"});let s=!1;for(const a of n){const o=w9(a,e);for(const l of o)r.appendChild(l),s=!0}return s?(e.defs.appendChild(r),i):null}function vc(t){const e=t.trim();return e.endsWith("%")?(parseFloat(e)||0)/100:parseFloat(e)||0}function b9(t){const e=t.trim();return e.endsWith("rad")?(parseFloat(e)||0)*(180/Math.PI):e.endsWith("grad")?(parseFloat(e)||0)*.9:e.endsWith("turn")?(parseFloat(e)||0)*360:parseFloat(e)||0}function w9(t,e){switch(t.name){case"blur":{const n=parseFloat(t.args)||0,i=xt(e.svgDocument,"feGaussianBlur");return en(i,{stdDeviation:n}),[i]}case"brightness":{const n=vc(t.args);return[wm(e,{slope:n})]}case"contrast":{const n=vc(t.args),i=.5-.5*n;return[wm(e,{slope:n,intercept:i})]}case"drop-shadow":{const n=_9(`drop-shadow(${t.args})`);if(!n)return[];const i=xt(e.svgDocument,"feDropShadow");return en(i,{dx:n.offsetX,dy:n.offsetY,stdDeviation:n.blur/2,"flood-color":n.color,"flood-opacity":1}),[i]}case"grayscale":{const n=vc(t.args),i=Math.max(0,Math.min(1,1-n)),r=xt(e.svgDocument,"feColorMatrix");return en(r,{type:"saturate",values:i}),[r]}case"hue-rotate":{const n=b9(t.args),i=xt(e.svgDocument,"feColorMatrix");return en(i,{type:"hueRotate",values:n}),[i]}case"invert":{const n=vc(t.args),i=n,r=1-n;return[wm(e,{type:"table",tableValues:`${i} ${r}`})]}case"opacity":{const n=vc(t.args),i=xt(e.svgDocument,"feComponentTransfer"),r=xt(e.svgDocument,"feFuncA");return en(r,{type:"linear",slope:n,intercept:0}),i.appendChild(r),[i]}case"saturate":{const n=vc(t.args),i=xt(e.svgDocument,"feColorMatrix");return en(i,{type:"saturate",values:n}),[i]}case"sepia":{const n=Math.max(0,Math.min(1,vc(t.args))),i=n,r=1-n,s=[r+i*.393,i*.769,i*.189,0,0,i*.349,r+i*.686,i*.168,0,0,i*.272,i*.534,r+i*.131,0,0,0,0,0,1,0].map(o=>o.toFixed(4)).join(" "),a=xt(e.svgDocument,"feColorMatrix");return en(a,{type:"matrix",values:s}),[a]}default:return[]}}function wm(t,e){const n=xt(t.svgDocument,"feComponentTransfer");for(const i of["feFuncR","feFuncG","feFuncB"]){const r=xt(t.svgDocument,i);if(e.type==="table"&&e.tableValues)en(r,{type:"table",tableValues:e.tableValues});else{const s={type:"linear",slope:e.slope??1};e.intercept!==void 0&&(s.intercept=e.intercept),en(r,s)}n.appendChild(r)}return n}function x9(t){const e=[],n=/([a-z-]+)\(/gi;let i;for(;(i=n.exec(t))!==null;){const r=i[1],s=i.index+i[0].length;let a=1,o=s;for(;o<t.length&&a>0;o++)t[o]==="("?a++:t[o]===")"&&a--;const l=t.slice(s,o-1).trim();e.push({name:r.toLowerCase(),args:l}),n.lastIndex=o}return e}function _9(t){const e=t.indexOf("drop-shadow(");if(e===-1)return null;const n=e+12;let i=1,r=n;for(let f=n;f<t.length&&i>0;f++)t[f]==="("?i++:t[f]===")"&&i--,i>0&&(r=f+1);const s=t.slice(n,r).trim();if(!s)return null;const a=[];let o="",l=0;for(const f of s)f==="("?l++:f===")"&&l--,f===" "&&l===0&&o?(a.push(o),o=""):o+=f;if(o&&a.push(o),a.length<2)return null;const c=[];let u="rgba(0,0,0,0.3)";for(const f of a){const p=parseFloat(f);!isNaN(p)&&(f.endsWith("px")||f.match(/^-?[\d.]+$/))?c.push(p):u=f}return{offsetX:c[0]??0,offsetY:c[1]??0,blur:c[2]??0,color:u}}function S9(t){if(!t||t==="none")return[];const e=[],n=k9(t);for(const i of n){const r=A9(i.trim());r&&e.push(r)}return e}function k9(t){const e=[];let n=0,i="";for(const r of t)r==="("?n++:r===")"&&n--,r===","&&n===0?(e.push(i),i=""):i+=r;return i&&e.push(i),e}function A9(t){let e=!1,n=t;n.startsWith("inset ")?(e=!0,n=n.slice(6).trim()):n.endsWith(" inset")&&(e=!0,n=n.slice(0,-6).trim());const i=[];let r="",s=0;for(const l of n)l==="("?s++:l===")"&&s--,l===" "&&s===0&&r?(i.push(r),r=""):r+=l;r&&i.push(r);const a=[],o=[];for(const l of i){const c=parseFloat(l);!isNaN(c)&&(l.endsWith("px")||l.match(/^-?[\d.]+$/))?a.push(c):o.push(l)}return a.length<2?null:{inset:e,offsetX:a[0],offsetY:a[1],blur:a[2]??0,spread:a[3]??0,color:o.join(" ")||"rgba(0, 0, 0, 0.3)"}}function N9(t,e,n,i,r){for(let s=t.length-1;s>=0;s--){const a=t[s];a.inset?P9(a,e,n,i,r):C9(a,e,n,i,r)}}function C9(t,e,n,i,r){const s={x:e.x+t.offsetX-t.spread,y:e.y+t.offsetY-t.spread,width:e.width+t.spread*2,height:e.height+t.spread*2},a=j_(n,t.spread),o=xh(s,a,i);if(o.setAttribute("fill",t.color),t.blur>0){const l=i.idGenerator.next("shadow"),c=xt(i.svgDocument,"filter"),u=t.blur*2+Math.abs(t.offsetX)+Math.abs(t.offsetY)+t.spread,f=Math.max(s.width,1),p=Math.max(s.height,1);en(c,{id:l,x:`-${(u/f*100+10).toFixed(0)}%`,y:`-${(u/p*100+10).toFixed(0)}%`,width:`${(200+u/f*200+20).toFixed(0)}%`,height:`${(200+u/p*200+20).toFixed(0)}%`});const d=xt(i.svgDocument,"feGaussianBlur");en(d,{in:"SourceGraphic",stdDeviation:t.blur/2}),c.appendChild(d),i.defs.appendChild(c),o.setAttribute("filter",`url(#${l})`)}r.insertBefore(o,r.firstChild)}function P9(t,e,n,i,r){const s=i.idGenerator.next("inset-clip"),a=xt(i.svgDocument,"clipPath");a.setAttribute("id",s);const o=xh(e,n,i);a.appendChild(o),i.defs.appendChild(a);const l={x:e.x+t.offsetX+t.spread,y:e.y+t.offsetY+t.spread,width:Math.max(0,e.width-t.spread*2),height:Math.max(0,e.height-t.spread*2)},c=j_(n,-t.spread),u=xt(i.svgDocument,"g");u.setAttribute("clip-path",`url(#${s})`);const f=xt(i.svgDocument,"rect"),p=t.blur*3+Math.abs(t.offsetX)+Math.abs(t.offsetY)+100;en(f,{x:e.x-p,y:e.y-p,width:e.width+p*2,height:e.height+p*2,fill:t.color}),xh(l,c,i).setAttribute("fill",t.color);const y=i.idGenerator.next("inset-mask"),m=xt(i.svgDocument,"mask");m.setAttribute("id",y);const w=xt(i.svgDocument,"rect");en(w,{x:e.x-p,y:e.y-p,width:e.width+p*2,height:e.height+p*2,fill:"white"});const b=xh(l,c,i);if(b.setAttribute("fill","black"),m.appendChild(w),m.appendChild(b),i.defs.appendChild(m),f.setAttribute("mask",`url(#${y})`),t.blur>0){const S=i.idGenerator.next("inset-blur"),A=xt(i.svgDocument,"filter");en(A,{id:S,x:"-50%",y:"-50%",width:"200%",height:"200%"});const _=xt(i.svgDocument,"feGaussianBlur");en(_,{in:"SourceGraphic",stdDeviation:t.blur/2}),A.appendChild(_),i.defs.appendChild(A),f.setAttribute("filter",`url(#${S})`)}u.appendChild(f),r.insertBefore(u,r.firstChild)}function xh(t,e,n){if(Zl(e)&&!Vd(e)){const r=xt(n.svgDocument,"path");return r.setAttribute("d",af(t.x,t.y,t.width,t.height,e)),r}const i=xt(n.svgDocument,"rect");return en(i,{x:t.x,y:t.y,width:t.width,height:t.height}),Zl(e)&&Vd(e)&&en(i,{rx:e.topLeft[0],ry:e.topLeft[1]}),i}function j_(t,e){return{topLeft:[Math.max(0,t.topLeft[0]+e),Math.max(0,t.topLeft[1]+e)],topRight:[Math.max(0,t.topRight[0]+e),Math.max(0,t.topRight[1]+e)],bottomRight:[Math.max(0,t.bottomRight[0]+e),Math.max(0,t.bottomRight[1]+e)],bottomLeft:[Math.max(0,t.bottomLeft[0]+e),Math.max(0,t.bottomLeft[1]+e)]}}function np(t){const e=t.trim();return e.endsWith("%")?{value:parseFloat(e)||0,isPct:!0}:{value:parseFloat(e)||0,isPct:!1}}function H_(t){if(!t||t==="none")return null;const e=t.match(/^inset\((.+)\)$/);if(e)return E9(e[1]);const n=t.match(/^circle\((.+)\)$/);if(n)return I9(n[1]);const i=t.match(/^ellipse\((.+)\)$/);if(i)return L9(i[1]);const r=t.match(/^polygon\((.+)\)$/);if(r)return M9(r[1]);const s=t.match(/^path\(["']?(.+?)["']?\)$/);return s?{type:"path",d:s[1]}:null}function E9(t){const e=t.indexOf(" round ");let n=t,i;e>=0&&(n=t.slice(0,e),i=t.slice(e+7).trim());const r=n.trim().split(/\s+/).map(c=>parseFloat(c)||0),s=r[0]??0,a=r[1]??s,o=r[2]??s,l=r[3]??a;return{type:"inset",top:s,right:a,bottom:o,left:l,round:i}}function I9(t){const e=t.indexOf(" at ");let n=0,i=0,r=0,s=!1,a=!1;if(e>=0){n=parseFloat(t.slice(0,e))||0;const o=t.slice(e+4).trim().split(/\s+/),l=np(o[0]),c=np(o[1]);i=l.value,s=l.isPct,r=c.value,a=c.isPct}else n=parseFloat(t)||0,i=50,r=50,s=!0,a=!0;return{type:"circle",radius:n,cx:i,cy:r,cxPct:s,cyPct:a}}function L9(t){const e=t.indexOf(" at ");let n=0,i=0,r=0,s=0,a=!1,o=!1;if(e>=0){const l=t.slice(0,e).trim().split(/\s+/);n=parseFloat(l[0])||0,i=parseFloat(l[1])||0;const c=t.slice(e+4).trim().split(/\s+/),u=np(c[0]),f=np(c[1]);r=u.value,a=u.isPct,s=f.value,o=f.isPct}else{const l=t.trim().split(/\s+/);n=parseFloat(l[0])||0,i=parseFloat(l[1])||0,r=50,s=50,a=!0,o=!0}return{type:"ellipse",rx:n,ry:i,cx:r,cy:s,cxPct:a,cyPct:o}}function M9(t){let e=t.trim();(e.startsWith("nonzero,")||e.startsWith("evenodd,"))&&(e=e.slice(e.indexOf(",")+1).trim());const n=[],i=e.split(",");for(const r of i){const s=r.trim().split(/\s+/);s.length>=2&&n.push([parseFloat(s[0])||0,parseFloat(s[1])||0])}return n.length<3?null:{type:"polygon",points:n}}function U_(t,e,n){const i=n.idGenerator.next("clip"),r=xt(n.svgDocument,"clipPath");r.setAttribute("id",i);const s=D9(t,e,n,n.compat.inlineClipPathTransforms);return s?(r.appendChild(s),n.defs.appendChild(r),i):null}function T9(t,e,n){return t.replace(/([MLHVCSQTAZmlhvcsqtaz])([^MLHVCSQTAZmlhvcsqtaz]*)/g,(i,r,s)=>{const a=s.match(/-?\d*\.?\d+(?:e[+-]?\d+)?/gi)?.map(Number)??[];if(a.length===0)return r+s;switch(r){case"M":case"L":case"T":for(let o=0;o<a.length-1;o+=2)a[o]+=e,a[o+1]+=n;break;case"H":for(let o=0;o<a.length;o++)a[o]+=e;break;case"V":for(let o=0;o<a.length;o++)a[o]+=n;break;case"C":for(let o=0;o<a.length-1;o+=2)a[o]+=e,a[o+1]+=n;break;case"S":case"Q":for(let o=0;o<a.length-1;o+=2)a[o]+=e,a[o+1]+=n;break;case"A":for(let o=0;o<a.length;o+=7)o+5<a.length&&(a[o+5]+=e),o+6<a.length&&(a[o+6]+=n);break;default:return r+s}return r+a.join(" ")})}function D9(t,e,n,i=!1){switch(t.type){case"inset":{const r=e.x+t.left,s=e.y+t.top,a=Math.max(0,e.width-t.left-t.right),o=Math.max(0,e.height-t.top-t.bottom);if(t.round){const c=t.round.split("/").map(y=>y.trim().split(/\s+/).map(m=>parseFloat(m)||0)),u=c[0]??[0],f=c[1]??u,p={topLeft:[u[0]??0,f[0]??0],topRight:[u[1]??u[0]??0,f[1]??f[0]??0],bottomRight:[u[2]??u[0]??0,f[2]??f[0]??0],bottomLeft:[u[3]??u[1]??u[0]??0,f[3]??f[1]??f[0]??0]},d=xt(n.svgDocument,"path");return d.setAttribute("d",af(r,s,a,o,p)),d}const l=xt(n.svgDocument,"rect");return en(l,{x:r,y:s,width:a,height:o}),l}case"circle":{const r=t.cxPct?t.cx/100*e.width:t.cx,s=t.cyPct?t.cy/100*e.height:t.cy,a=xt(n.svgDocument,"circle");return en(a,{cx:e.x+r,cy:e.y+s,r:t.radius}),a}case"ellipse":{const r=t.cxPct?t.cx/100*e.width:t.cx,s=t.cyPct?t.cy/100*e.height:t.cy,a=xt(n.svgDocument,"ellipse");return en(a,{cx:e.x+r,cy:e.y+s,rx:t.rx,ry:t.ry}),a}case"polygon":{const r=xt(n.svgDocument,"polygon"),s=t.points.map(([a,o])=>`${e.x+a},${e.y+o}`).join(" ");return r.setAttribute("points",s),r}case"path":{const r=xt(n.svgDocument,"path");return i&&(e.x!==0||e.y!==0)?r.setAttribute("d",T9(t.d,e.x,e.y)):(r.setAttribute("d",t.d),r.setAttribute("transform",`translate(${e.x}, ${e.y})`)),r}default:return null}}async function O9(t,e,n){const i=xt(n.svgDocument,"g"),r=window.getComputedStyle(t);let s=B_(t,e),a=null;if(n.options.flattenTransforms&&r.transform&&r.transform!=="none"){const u=J9(r.transform);if(Math.abs(u)>.5){const f=t,p=f.offsetWidth,d=f.offsetHeight;if(p>0&&d>0&&(Math.abs(p-s.width)>1||Math.abs(d-s.height)>1)){const y=s.x+s.width/2,m=s.y+s.height/2;s={x:y-p/2,y:m-d/2,width:p,height:d},a=`rotate(${u.toFixed(2)}, ${y.toFixed(2)}, ${m.toFixed(2)})`}}}const o=R_(D_(r),s.width,s.height);if(!n.options.flattenTransforms&&r.transform&&r.transform!=="none"){const u=g9(r.transform,r.transformOrigin,s);u&&i.setAttribute("transform",u)}const l=r.clipPath;if(l&&l!=="none"){const u=H_(l);if(u){const f=U_(u,s,n);f&&i.setAttribute("clip-path",`url(#${f})`)}}if(!GR(r)){if(!n.compat.stripFilters&&r.filter&&r.filter!=="none"){const p=y9(r.filter,n);p&&i.setAttribute("filter",`url(#${p})`)}if(!n.compat.stripBoxShadows){const p=r.boxShadow;if(p&&p!=="none"){const d=S9(p);d.length>0&&N9(d,s,o,n,i)}}const u=tp(r);if(u){const p=Wc(s,o,n);p.setAttribute("fill",u),i.appendChild(p)}F_(r)&&await X9(r,s,o,n,i);const f=XR(r);if(YR(f)&&z9(i,s,f,o,n),V9(r,s,o,n,i),zR(t)&&t.src){const p=await F0(t.src),d=xt(n.svgDocument,"image");en(d,{x:s.x,y:s.y,width:s.width,height:s.height,href:p});const y=r.objectFit||t.style.objectFit;if(y==="fill"||y===""?d.setAttribute("preserveAspectRatio","none"):y==="contain"||y==="scale-down"?d.setAttribute("preserveAspectRatio","xMidYMid meet"):y==="cover"&&d.setAttribute("preserveAspectRatio","xMidYMid slice"),Zl(o)){const m=n.idGenerator.next("clip"),w=xt(n.svgDocument,"clipPath");w.setAttribute("id",m);const b=xt(n.svgDocument,"path");b.setAttribute("d",af(s.x,s.y,s.width,s.height,o)),w.appendChild(b),n.defs.appendChild(w),d.setAttribute("clip-path",`url(#${m})`)}i.appendChild(d)}if(qR(t)){const p=a9(t);if(p){const d=xt(n.svgDocument,"image");en(d,{x:s.x,y:s.y,width:s.width,height:s.height,href:p}),i.appendChild(d)}}if(jR(t)&&W9(t,r,s,n,i),r.display==="list-item"&&U9(t,r,s,n,i),!n.compat.stripMaskImage){const p=r.webkitMaskImage||r.maskImage||r.webkitMask||r.mask;p&&p!=="none"&&await H9(p,r,s,n,i)}await W_(t,"::before",e,n,i)}if(a){const u=xt(n.svgDocument,"g");for(u.setAttribute("transform",a);i.firstChild;)u.appendChild(i.firstChild);i.appendChild(u)}if(O_(r)&&t!==e){const u=n.compat.useClipPathForOverflow?j9(s,o,n):q9(s,o,n);i.appendChild(u),i.__childTarget=u}return i}async function F9(t,e,n,i){await W_(t,"::after",e,n,i)}function R9(t){return t.__childTarget??t}function Wc(t,e,n){if(Zl(e)&&!Vd(e))return B9(t,e,n);const i=xt(n.svgDocument,"rect");return en(i,{x:t.x,y:t.y,width:t.width,height:t.height}),Zl(e)&&Vd(e)&&en(i,{rx:e.topLeft[0],ry:e.topLeft[1]}),i}function B9(t,e,n){const i=xt(n.svgDocument,"path");return i.setAttribute("d",af(t.x,t.y,t.width,t.height,e)),i}function p1(t,e){return t==="dashed"?`${e*3} ${e*2}`:t==="dotted"?`${e} ${e}`:null}function z9(t,e,n,i,r){if(n.top.width===n.right.width&&n.right.width===n.bottom.width&&n.bottom.width===n.left.width&&n.top.color===n.right.color&&n.right.color===n.bottom.color&&n.bottom.color===n.left.color&&n.top.style===n.right.style&&n.right.style===n.bottom.style&&n.bottom.style===n.left.style&&n.top.width>0&&n.top.style!=="none"){const E=n.top.width/2,M={x:e.x+E,y:e.y+E,width:Math.max(0,e.width-n.top.width),height:Math.max(0,e.height-n.top.width)},T={topLeft:[Math.max(0,i.topLeft[0]-E),Math.max(0,i.topLeft[1]-E)],topRight:[Math.max(0,i.topRight[0]-E),Math.max(0,i.topRight[1]-E)],bottomRight:[Math.max(0,i.bottomRight[0]-E),Math.max(0,i.bottomRight[1]-E)],bottomLeft:[Math.max(0,i.bottomLeft[0]-E),Math.max(0,i.bottomLeft[1]-E)]},D=Wc(M,T,r);en(D,{fill:"none",stroke:n.top.color,"stroke-width":n.top.width});const U=p1(n.top.style,n.top.width);U&&D.setAttribute("stroke-dasharray",U),t.appendChild(D);return}const{x:s,y:a,width:o,height:l}=e,c=n.top.width,u=n.right.width,f=n.bottom.width,p=n.left.width,d=s,y=a,m=s+o,w=a+l,b=s+p,S=a+c,A=s+o-u,_=a+l-f,I=[{w:c,side:n.top,trapD:`M ${d} ${y} L ${m} ${y} L ${A} ${S} L ${b} ${S} Z`,lineD:`M ${b} ${y+c/2} L ${A} ${y+c/2}`},{w:u,side:n.right,trapD:`M ${m} ${y} L ${m} ${w} L ${A} ${_} L ${A} ${S} Z`,lineD:`M ${m-u/2} ${S} L ${m-u/2} ${_}`},{w:f,side:n.bottom,trapD:`M ${m} ${w} L ${d} ${w} L ${b} ${_} L ${A} ${_} Z`,lineD:`M ${A} ${w-f/2} L ${b} ${w-f/2}`},{w:p,side:n.left,trapD:`M ${d} ${w} L ${d} ${y} L ${b} ${S} L ${b} ${_} Z`,lineD:`M ${d+p/2} ${_} L ${d+p/2} ${S}`}];for(const{w:E,side:M,trapD:T,lineD:D}of I){if(E<=0||M.style==="none")continue;const U=p1(M.style,E);if(U){const C=xt(r.svgDocument,"path");en(C,{d:D,fill:"none",stroke:M.color,"stroke-width":E}),C.setAttribute("stroke-dasharray",U),t.appendChild(C)}else{const C=xt(r.svgDocument,"path");C.setAttribute("d",T),C.setAttribute("fill",M.color),t.appendChild(C)}}}function q9(t,e,n){const i=n.idGenerator.next("mask"),r=xt(n.svgDocument,"mask");r.setAttribute("id",i);const s=Wc(t,e,n);s.setAttribute("fill","white"),r.appendChild(s),n.defs.appendChild(r);const a=xt(n.svgDocument,"g");return a.setAttribute("mask",`url(#${i})`),a}function j9(t,e,n){const i=n.idGenerator.next("clip"),r=xt(n.svgDocument,"clipPath");r.setAttribute("id",i);const s=Wc(t,e,n);r.appendChild(s),n.defs.appendChild(r);const a=xt(n.svgDocument,"g");return a.setAttribute("clip-path",`url(#${i})`),a}function db(t,e,n,i,r){const s=i.idGenerator.next("mask"),a=xt(i.svgDocument,"mask");a.setAttribute("id",s);const o=Wc(e,n,i);o.setAttribute("fill","white"),a.appendChild(o),i.defs.appendChild(a);const l=xt(i.svgDocument,"g");l.setAttribute("mask",`url(#${s})`),l.appendChild(t),r.appendChild(l)}async function H9(t,e,n,i,r){const s=q_(t);if(!s)return;let a=s;if(!s.startsWith("data:"))try{a=await F0(s)}catch{return}const o=e.webkitMaskSize||e.maskSize||"auto";let l=n.width,c=n.height;if(o!=="auto"&&o!=="contain"&&o!=="cover"){const d=o.split(/\s+/),y=parseFloat(d[0]),m=parseFloat(d[1]||d[0]);isNaN(y)||(l=y),isNaN(m)||(c=m)}const u=i.idGenerator.next("mask"),f=xt(i.svgDocument,"mask");f.setAttribute("id",u),i.compat.avoidStyleAttributes||f.setAttribute("style","mask-type: alpha");const p=xt(i.svgDocument,"image");en(p,{x:n.x,y:n.y,width:l,height:c,href:a}),f.appendChild(p),i.defs.appendChild(f),r.setAttribute("mask",`url(#${u})`)}function U9(t,e,n,i,r){let s="";try{const y=window.getComputedStyle(t,"::marker").content;y&&y!=="none"&&y!=="normal"&&(s=y.replace(/^["']|["']$/g,""))}catch{}if(!s){const d=e.listStyleType;if(d==="none")return;if(d==="disc")s="â¢";else if(d==="circle")s="â";else if(d==="square")s="â ";else if(d==="decimal"||d===""||!d){let y=1,m=t.previousElementSibling;for(;m;)window.getComputedStyle(m).display==="list-item"&&y++,m=m.previousElementSibling;s=`${y}.`}else s="â¢"}if(!s)return;const a=parseFloat(e.fontSize)||16,o=parseFloat(e.paddingLeft)||0,l=parseFloat(e.paddingTop)||0,c=parseFloat(e.lineHeight)||a*1.2,u=n.x+o-6,f=n.y+l+(c-a)/2+a*.8,p=xt(i.svgDocument,"text");en(p,{x:u.toFixed(2),y:f.toFixed(2),"font-family":e.fontFamily,"font-size":e.fontSize,fill:e.color,"text-anchor":"end"}),p.textContent=s,r.appendChild(p)}function W9(t,e,n,i,r){let s="",a=!1;if(t instanceof HTMLSelectElement?s=t.selectedOptions[0]?.text??"":(s=t.value,!s&&t.placeholder&&(s=t.placeholder,a=!0)),!s)return;const o=parseFloat(e.fontSize)||16,l=parseFloat(e.paddingLeft)||0,c=parseFloat(e.paddingTop)||0,u=parseFloat(e.borderTopWidth)||0,f=parseFloat(e.lineHeight)||o*1.2,p=a?"gray":e.color,d=n.x+l;if(t instanceof HTMLTextAreaElement){const S=s.split(`
`);for(let A=0;A<S.length;A++){const _=S[A];if(!_)continue;const I=(f-o)/2,E=n.y+u+c+A*f+I+o*.8,M=xt(i.svgDocument,"text");en(M,{x:d.toFixed(2),y:E.toFixed(2),"font-family":e.fontFamily,"font-size":e.fontSize,"font-weight":e.fontWeight,"font-style":e.fontStyle,fill:p}),a&&M.setAttribute("opacity","0.54"),M.textContent=_,r.appendChild(M)}return}const y=parseFloat(e.borderBottomWidth)||0,m=n.height-u-y,w=n.y+u+m/2+o*.35,b=xt(i.svgDocument,"text");en(b,{x:d.toFixed(2),y:w.toFixed(2),"font-family":e.fontFamily,"font-size":e.fontSize,"font-weight":e.fontWeight,"font-style":e.fontStyle,fill:p}),a&&b.setAttribute("opacity","0.54"),b.textContent=s,r.appendChild(b)}function V9(t,e,n,i,r){const s=t.outlineStyle;if(!s||s==="none")return;const a=parseFloat(t.outlineWidth)||0;if(a<=0)return;const o=t.outlineColor||t.color,c=(parseFloat(t.outlineOffset)||0)+a/2,u={x:e.x-c,y:e.y-c,width:e.width+c*2,height:e.height+c*2},f={topLeft:[Math.max(0,n.topLeft[0]+c),Math.max(0,n.topLeft[1]+c)],topRight:[Math.max(0,n.topRight[0]+c),Math.max(0,n.topRight[1]+c)],bottomRight:[Math.max(0,n.bottomRight[0]+c),Math.max(0,n.bottomRight[1]+c)],bottomLeft:[Math.max(0,n.bottomLeft[0]+c),Math.max(0,n.bottomLeft[1]+c)]},p=Wc(u,f,i);en(p,{fill:"none",stroke:o,"stroke-width":a});const d=p1(s,a);d&&p.setAttribute("stroke-dasharray",d),r.appendChild(p)}function xm(t){const e=[];let n=0,i="";for(const r of t)r==="("?n++:r===")"&&n--,r===","&&n===0?(e.push(i.trim()),i=""):i+=r;return i.trim()&&e.push(i.trim()),e}function G9(t,e,n){let i=n.width,r=n.height,s="none";if(t==="contain")s="xMidYMid meet";else if(t==="cover")s="xMidYMid slice";else if(t&&t!=="auto"){const l=t.split(/\s+/),c=fb(l[0],n.width),u=fb(l[1]??"auto",n.height);c!==null&&(i=c),u!==null&&(r=u)}let a=n.x,o=n.y;if(e&&e!=="0% 0%"){const l=e.split(/\s+/);a=n.x+hb(l[0]??"0px",n.width,i),o=n.y+hb(l[1]??"0px",n.height,r)}return{x:a,y:o,width:i,height:r,preserveAspectRatio:s}}function fb(t,e){return t==="auto"?null:t.endsWith("%")?parseFloat(t)/100*e:parseFloat(t)||null}function hb(t,e,n){return t.endsWith("%")?parseFloat(t)/100*(e-n):parseFloat(t)||0}async function X9(t,e,n,i,r){const s=xm(t.backgroundImage),a=xm(t.backgroundSize),o=xm(t.backgroundPosition);for(let l=s.length-1;l>=0;l--){const c=s[l];if(c==="none")continue;const u=a[l]??a[a.length-1]??"auto",f=o[l]??o[o.length-1]??"0% 0%",p=G9(u,f,e);await Y9(c,p,e,n,i,r)}}async function Y9(t,e,n,i,r,s){const a=e9(t);if(a){const c=t9(a,n,r),u=Wc(n,i,r);u.setAttribute("fill",`url(#${c.getAttribute("id")})`),s.appendChild(u);return}const o=n9(t,e.width,e.height);if(o){const c=xt(r.svgDocument,"image");en(c,{x:e.x,y:e.y,width:e.width,height:e.height,href:o,preserveAspectRatio:e.preserveAspectRatio}),Zl(i)?db(c,n,i,r,s):s.appendChild(c);return}const l=q_(t);if(l){const c=await F0(l),u=xt(r.svgDocument,"image");en(u,{x:e.x,y:e.y,width:e.width,height:e.height,href:c,preserveAspectRatio:e.preserveAspectRatio}),Zl(i)?db(u,n,i,r,s):s.appendChild(u)}}function K9(t){if(tp(t)||F_(t))return!0;const e=t.clipPath||t.webkitClipPath;return!!(e&&e!=="none")}function Z9(t,e,n,i){const r=document.createElement("span");r.style.cssText=`
    position: ${n.position};
    display: ${n.display==="none"?"none":n.display};
    top: ${n.top}; right: ${n.right};
    bottom: ${n.bottom}; left: ${n.left};
    width: ${n.width}; height: ${n.height};
    margin: ${n.margin}; padding: ${n.padding};
    box-sizing: ${n.boxSizing};
    visibility: hidden;
    pointer-events: none;
  `,e==="::before"?t.insertBefore(r,t.firstChild):t.appendChild(r);const s=r.getBoundingClientRect();if(t.removeChild(r),s.width===0&&s.height===0)return null;const a=i.getBoundingClientRect();return{x:s.left-a.left,y:s.top-a.top,width:s.width,height:s.height}}async function W_(t,e,n,i,r){const s=HR(t,e),a=s.content;if(!a||a==="none"||a==="normal")return;const o=a.replace(/^["']|["']$/g,""),l=K9(s);if(!o&&!l)return;if(l){const A=Z9(t,e,s,n);if(A){const _=tp(s);if(_){const I=xt(i.svgDocument,"rect");en(I,{x:A.x,y:A.y,width:A.width,height:A.height,fill:_});const E=s.clipPath||s.webkitClipPath;if(E&&E!=="none"){const M=H_(E);if(M){const T=U_(M,A,i);T&&I.setAttribute("clip-path",`url(#${T})`)}}r.appendChild(I)}}}if(!o)return;const c=n.getBoundingClientRect(),u=parseFloat(s.fontSize)||16,f=document.createElement("span");f.style.cssText=`
    font-family: ${s.fontFamily};
    font-size: ${s.fontSize};
    font-weight: ${s.fontWeight};
    font-style: ${s.fontStyle};
    letter-spacing: ${s.letterSpacing};
    visibility: hidden;
    pointer-events: none;
  `,f.textContent=o,e==="::before"?t.insertBefore(f,t.firstChild):t.appendChild(f);const p=f.getBoundingClientRect(),d=p.left-c.left,y=p.width,m=p.height,w=(m-u)/2,b=p.top-c.top+w+u*.8;if(t.removeChild(f),!l){const A=tp(s);if(A){const _=xt(i.svgDocument,"rect");en(_,{x:d,y:p.top-c.top,width:y,height:m,fill:A}),r.appendChild(_)}}const S=xt(i.svgDocument,"text");en(S,{"font-family":s.fontFamily,"font-size":s.fontSize,"font-weight":s.fontWeight,"font-style":s.fontStyle,fill:s.color,x:d.toFixed(2),y:b.toFixed(2)}),s.letterSpacing&&s.letterSpacing!=="normal"&&S.setAttribute("letter-spacing",s.letterSpacing),S.textContent=o,r.appendChild(S)}function J9(t){const e=t.match(/^matrix\(([^,]+),\s*([^,]+)/);if(!e)return 0;const n=parseFloat(e[1]),i=parseFloat(e[2]);return isNaN(n)||isNaN(i)?0:Math.atan2(i,n)*(180/Math.PI)}function Q9(t,e){const n=window.getComputedStyle(t).color||"rgb(0, 0, 0)",i=ip(t,e);return X_(i,n),eB(i,e),i}function ip(t,e,n=0){if(t.localName==="use"&&n<5){const o=$9(t,e,n);if(o)return o}const i=e.compat.flattenNestedSvg&&t.localName==="svg"&&t.ownerSVGElement!==null&&!t.getAttribute("viewBox"),r=e.svgDocument.createElementNS(t.namespaceURI||Oc,i?"g":t.localName),s=e.compat.avoidStyleAttributes,a=new Set(["x","y","width","height","overflow","viewBox"]);for(const o of Array.from(t.attributes))s&&(o.localName==="style"||o.localName==="class")||i&&a.has(o.localName)||(o.namespaceURI===Fc?r.setAttributeNS(Fc,o.localName,o.value):o.namespaceURI?r.setAttributeNS(o.namespaceURI,o.localName,o.value):r.setAttribute(o.localName,o.value));if(i){const o=parseFloat(t.getAttribute("x")||"0")||0,l=parseFloat(t.getAttribute("y")||"0")||0;(o!==0||l!==0)&&r.setAttribute("transform",`translate(${o},${l})`)}V_(t,r,e);for(const o of Array.from(t.childNodes))o.nodeType===Node.ELEMENT_NODE?r.appendChild(ip(o,e,n)):o.nodeType===Node.TEXT_NODE&&r.appendChild(e.svgDocument.createTextNode(o.textContent||""));return r}function $9(t,e,n){const i=t.getAttribute("href")||t.getAttributeNS(Fc,"href");if(!i||!i.startsWith("#"))return null;const r=i.slice(1),s=document.getElementById(r);if(!s)return null;const a=e.svgDocument.createElementNS(Oc,"g"),o=new Set(["href","xlink:href","x","y","width","height"]);for(const u of Array.from(t.attributes))o.has(u.localName)||u.namespaceURI!==Fc&&(u.namespaceURI?a.setAttributeNS(u.namespaceURI,u.localName,u.value):a.setAttribute(u.localName,u.value));const l=parseFloat(t.getAttribute("x")||"0")||0,c=parseFloat(t.getAttribute("y")||"0")||0;if(l!==0||c!==0){const u=a.getAttribute("transform")||"";a.setAttribute("transform",`translate(${l},${c}) ${u}`.trim())}if(V_(t,a,e),s.localName==="symbol"){const u=s.getAttribute("viewBox"),f=t.getAttribute("width")||s.getAttribute("width"),p=t.getAttribute("height")||s.getAttribute("height"),d=e.svgDocument.createElementNS(Oc,"svg");u&&d.setAttribute("viewBox",u),f&&d.setAttribute("width",f),p&&d.setAttribute("height",p),d.setAttribute("overflow","hidden");for(const y of Array.from(s.childNodes))y.nodeType===Node.ELEMENT_NODE&&d.appendChild(ip(y,e,n+1));a.appendChild(d)}else a.appendChild(ip(s,e,n+1));return a}function V_(t,e,n){const i=window.getComputedStyle(t);if(!e.hasAttribute("fill")){const r=i.fill;r&&r!=="rgb(0, 0, 0)"&&e.setAttribute("fill",r)}if(!e.hasAttribute("stroke")){const r=i.stroke;r&&r!=="none"&&e.setAttribute("stroke",r)}if(!e.hasAttribute("opacity")){const r=i.opacity;r==="0"?e.setAttribute("opacity","0"):!n.compat.stripGroupOpacity&&r&&r!=="1"&&e.setAttribute("opacity",r)}}function eB(t,e){const n=new Map,i=t.querySelectorAll("[id]");for(const r of Array.from(i)){const s=r.getAttribute("id"),a=e.idGenerator.next("svg");n.set(s,a),r.setAttribute("id",a)}if(t.hasAttribute("id")){const r=t.getAttribute("id");if(!n.has(r)){const s=e.idGenerator.next("svg");n.set(r,s),t.setAttribute("id",s)}}n.size!==0&&G_(t,n)}function G_(t,e){for(const n of Array.from(t.attributes)){if(n.value.includes("url(#")){let i=n.value;for(const[r,s]of e)i=i.replace(new RegExp(`url\\(#${tB(r)}\\)`,"g"),`url(#${s})`);i!==n.value&&t.setAttribute(n.localName,i)}if((n.localName==="href"||n.localName==="xlink:href")&&n.value.startsWith("#")){const i=n.value.slice(1);e.has(i)&&(n.namespaceURI===Fc?t.setAttributeNS(Fc,"href",`#${e.get(i)}`):t.setAttribute(n.localName,`#${e.get(i)}`))}}for(const n of Array.from(t.children))n instanceof SVGElement&&G_(n,e)}function X_(t,e){for(const n of Array.from(t.attributes))n.value==="currentColor"&&t.setAttribute(n.localName,e);for(const n of Array.from(t.children))n instanceof SVGElement&&X_(n,e)}function tB(t){return t.replace(/[.*+?^${}()|[\]\\]/g,"\\$&")}var nB=1e4;function iB(t){const e=new Map;let n=null;async function i(){return n||(n=await hs(()=>import("./BSMA75Qi.js"),[],import.meta.url),n)}function r(l,c,u){return`${l}|${c??"normal"}|${u??"normal"}`}function s(l){return l===void 0||l==="normal"?400:l==="bold"?700:typeof l=="string"?parseInt(l,10)||400:l}function a(l){return l==="italic"||l==="oblique"?"italic":"normal"}function o(l,c,u){const f=t[l];if(!f)return null;if(typeof f=="string")return{url:f};if(!Array.isArray(f))return f;const p=s(c),d=a(u);let y=null,m=-1;for(const w of f){let b=0;a(w.style)===d&&(b+=2),s(w.weight)===p&&(b+=1),b>m&&(m=b,y=w)}return y??f[0]??null}return{async getFont(l,c,u){const f=r(l,c,u);if(e.has(f))return e.get(f);const p=o(l,c,u);if(!p)return null;const d=await i();try{const y=new AbortController,m=setTimeout(()=>y.abort(),nB),w=await fetch(p.url,{signal:y.signal});clearTimeout(m);const b=await w.arrayBuffer(),S=d.parse(b);return e.set(f,S),S}catch(y){return console.warn(`dom2svg: Failed to load font "${l}" from ${p.url}:`,y),null}},has(l){return l in t}}}function rB(t,e,n,i,r){try{return t.getPath(e,n,i,r).toPathData(2)}catch{return null}}function sB(t){return(t.split(",")[0]?.trim()??t).replace(/^["']|["']$/g,"")}function aB(t){if(!t||t==="none")return[];const e=[],n=oB(t);for(const i of n){const r=lB(i.trim());r&&e.push(r)}return e}function oB(t){const e=[];let n=0,i="";for(const r of t)r==="("?n++:r===")"&&n--,r===","&&n===0?(e.push(i),i=""):i+=r;return i&&e.push(i),e}function lB(t){const e=[];let n="",i=0;for(const a of t)a==="("?i++:a===")"&&i--,a===" "&&i===0&&n?(e.push(n),n=""):n+=a;n&&e.push(n);const r=[],s=[];for(const a of e){const o=parseFloat(a);!isNaN(o)&&(a.endsWith("px")||a.match(/^-?[\d.]+$/))?r.push(o):s.push(a)}return r.length<2?null:{offsetX:r[0],offsetY:r[1],blur:r[2]??0,color:s.join(" ")||"rgba(0, 0, 0, 0.5)"}}function cB(t,e){if(t.length===0)return null;const n=e.idGenerator.next("tshadow"),i=xt(e.svgDocument,"filter");if(en(i,{id:n,x:"-50%",y:"-50%",width:"200%",height:"200%"}),t.length===1){const r=t[0],s=xt(e.svgDocument,"feDropShadow");en(s,{dx:r.offsetX,dy:r.offsetY,stdDeviation:r.blur/2,"flood-color":r.color,"flood-opacity":1}),i.appendChild(s)}else{const r=[];for(let o=0;o<t.length;o++){const l=t[o],c=String(o),u=xt(e.svgDocument,"feOffset");en(u,{in:"SourceAlpha",dx:l.offsetX,dy:l.offsetY,result:`off${c}`}),i.appendChild(u);const f=xt(e.svgDocument,"feGaussianBlur");en(f,{in:`off${c}`,stdDeviation:l.blur/2,result:`blur${c}`}),i.appendChild(f);const p=xt(e.svgDocument,"feFlood");en(p,{"flood-color":l.color,"flood-opacity":1,result:`color${c}`}),i.appendChild(p);const d=xt(e.svgDocument,"feComposite");en(d,{in:`color${c}`,in2:`blur${c}`,operator:"in",result:`shadow${c}`}),i.appendChild(d),r.push(`shadow${c}`)}const s=xt(e.svgDocument,"feMerge");for(const o of r){const l=xt(e.svgDocument,"feMergeNode");l.setAttribute("in",o),s.appendChild(l)}const a=xt(e.svgDocument,"feMergeNode");a.setAttribute("in","SourceGraphic"),s.appendChild(a),i.appendChild(s)}return e.defs.appendChild(i),n}async function uB(t,e,n){const i=t.textContent;if(!i||!i.trim())return null;const r=t.parentElement;if(!r)return null;const s=window.getComputedStyle(r);if(s.visibility==="hidden")return null;const a=s.whiteSpace,o=e.getBoundingClientRect();let l;try{const _=document.createRange();_.selectNodeContents(t),l=_.getClientRects()}catch{return null}if(l.length===0)return null;const c=xt(n.svgDocument,"g"),u=n.options.textToPath&&n.fontCache,f=sB(s.fontFamily),p=parseFloat(s.fontSize)||16,d=s.fontWeight,y=s.fontStyle;let m=null;u&&n.fontCache?.has(f)&&(m=await n.fontCache.getFont(f,d,y));let w=.8;m&&m.ascender&&m.unitsPerEm&&(w=m.ascender/m.unitsPerEm);const b=dB(t,o,w,a),S=s.textTransform,A=s.textOverflow==="ellipsis"&&s.overflow!=="visible"&&s.whiteSpace==="nowrap"&&r.scrollWidth>r.clientWidth;for(const _ of b){let I=gB(_.text,S);if(A&&_===b[b.length-1]&&(I=I.trimEnd()+"â¦"),m){const E=rB(m,I,_.x,_.y,p);if(E){const M=xt(n.svgDocument,"path");en(M,{d:E,fill:s.color}),c.appendChild(M)}}else{const E=xt(n.svgDocument,"text");en(E,{x:_.x.toFixed(2),y:_.y.toFixed(2)}),mB(E,s,n),E.textContent=I,c.appendChild(E)}}if(c.childNodes.length===0)return null;if(!n.compat.stripTextShadows){const _=s.textShadow;if(_&&_!=="none"){const I=aB(_),E=cB(I,n);E&&c.setAttribute("filter",`url(#${E})`)}}return c}function pb(t,e,n,i,r=.8,s){let a=t,o=e;s&&e>n*2&&s.height<e*.8&&(a=s.top,o=s.height);const l=(o-n)/2;return a-i+l+n*r}function dB(t,e,n=.8,i="normal"){const r=[],s=t.textContent||"";if(!s)return r;const a=t.parentElement;if(!a)return r;const o=window.getComputedStyle(a),l=parseFloat(o.fontSize)||16,c=a.getBoundingClientRect(),u={top:c.top,height:c.height},f=document.createRange();f.selectNodeContents(t);const p=f.getClientRects();if(p.length===0)return r;let d;if(p.length===1){const m=p[0];if(s.length>1&&hB(t,f,s.length,l))d=pB(t,f,s.length,l);else return r.push({text:gb(s,i),x:m.left-e.left,y:pb(m.top,m.height,l,e.top,n,u)}),r}else d=Array.from(p);let y=0;for(let m=0;m<d.length;m++){const w=d[m],b=m===d.length-1;let S;if(b)S=s.length;else{const _=w.top;S=fB(t,f,y,s.length,_,l)}const A=gb(s.slice(y,S),i);A&&r.push({text:A,x:w.left-e.left,y:pb(w.top,w.height,l,e.top,n,u)}),y=S}return r}function fB(t,e,n,i,r,s){for(;n<i;){const a=Math.floor((n+i)/2);try{e.setStart(t,a),e.setEnd(t,a+1)}catch{n=a+1;continue}const o=e.getClientRects();if(o.length===0){n=a+1;continue}Math.abs(o[0].top-r)>s*.5?i=a:n=a+1}return n}function hB(t,e,n,i){if(n<=1)return!1;try{e.setStart(t,0),e.setEnd(t,1);const r=e.getClientRects();e.setStart(t,n-1),e.setEnd(t,n);const s=e.getClientRects();if(r.length>0&&s.length>0)return Math.abs(s[0].top-r[0].top)>i*.5}catch{}return!1}function pB(t,e,n,i){const r=[];let s=-1/0;for(let a=0;a<n;a++)try{e.setStart(t,a),e.setEnd(t,a+1);const o=e.getClientRects();if(o.length===0)continue;const l=o[0];Math.abs(l.top-s)>i*.5&&(r.push(l),s=l.top)}catch{continue}return r}function gb(t,e){return e==="pre"||e==="pre-wrap"||e==="break-spaces"?t:e==="pre-line"?t.replace(/[^\S\n]+/g," "):t.replace(/\s+/g," ")}function gB(t,e){switch(e){case"uppercase":return t.toUpperCase();case"lowercase":return t.toLowerCase();case"capitalize":return t.replace(/\b\w/g,n=>n.toUpperCase());default:return t}}function mB(t,e,n){if(en(t,{"font-family":e.fontFamily,"font-size":e.fontSize,"font-weight":e.fontWeight,"font-style":e.fontStyle,fill:e.color}),n.compat.stripXmlSpace||t.setAttribute("xml:space","preserve"),e.letterSpacing&&e.letterSpacing!=="normal"&&t.setAttribute("letter-spacing",e.letterSpacing),e.wordSpacing&&e.wordSpacing!=="normal"&&t.setAttribute("word-spacing",e.wordSpacing),e.textDecoration&&e.textDecoration!=="none"){const i=[];e.textDecoration.includes("underline")&&i.push("underline"),e.textDecoration.includes("line-through")&&i.push("line-through"),i.length>0&&t.setAttribute("text-decoration",i.join(" "))}}async function Y_(t,e,n){const i=window.getComputedStyle(t);if(VR(i)||yB(t,n))return null;if(n.options.handler)try{const o=n.options.handler(t,n);if(o!==null)return o}catch(o){console.warn("dom2svg: Custom handler threw for element:",t,o)}if(BR(t)&&t!==e){const o=B_(t,e),l=Q9(t,n);return t.tagName.toLowerCase()==="svg"&&(l.setAttribute("x",String(o.x)),l.setAttribute("y",String(o.y)),l.setAttribute("width",String(o.width)),l.setAttribute("height",String(o.height)),i.overflow==="visible"&&l.setAttribute("overflow","visible")),l}const r=await O9(t,e,n),s=R9(r);{const o=parseFloat(i.opacity);o===0?r.setAttribute("opacity","0"):!n.compat.stripGroupOpacity&&o<1&&r.setAttribute("opacity",String(o))}const a=vB(t);for(const o of a)if(T_(o)){const l=await uB(o,e,n);l&&s.appendChild(l)}else if(f1(o)){const l=await Y_(o,e,n);l&&s.appendChild(l)}return await F9(t,e,n,r),r}function vB(t){const e=Array.from(t.childNodes);if(!e.some(c=>f1(c)))return e;const n=[],i=[],r=[],s=[],a=[],o=[];for(const c of e){if(T_(c)){s.push(c);continue}if(!f1(c))continue;const u=window.getComputedStyle(c),f=ZR(u),p=KR(u),d=JR(u);p&&f<0?n.push({node:c,z:f}):p&&f>0?o.push({node:c,z:f}):d||p?a.push(c):QR(u)?r.push(c):$R(u)?s.push(c):i.push(c)}n.sort((c,u)=>c.z-u.z),o.sort((c,u)=>c.z-u.z);const l=[];for(const{node:c}of n)l.push(c);for(const c of i)l.push(c);for(const c of r)l.push(c);for(const c of s)l.push(c);for(const c of a)l.push(c);for(const{node:c}of o)l.push(c);return l}function yB(t,e){const n=e.options.exclude;return n?typeof n=="string"?t.matches(n):n(t):!1}var bB={useClipPathForOverflow:!1,stripFilters:!1,stripBoxShadows:!1,stripMaskImage:!1,stripTextShadows:!1,avoidStyleAttributes:!1,stripXmlSpace:!1,stripGroupOpacity:!1,inlineClipPathTransforms:!1,flattenNestedSvg:!1},wB={useClipPathForOverflow:!0,stripFilters:!0,stripBoxShadows:!0,stripMaskImage:!0,stripTextShadows:!0,avoidStyleAttributes:!0,stripXmlSpace:!0,stripGroupOpacity:!0,inlineClipPathTransforms:!0,flattenNestedSvg:!0};function xB(t){return!t||t==="full"?bB:t==="inkscape"?wB:t}async function _B(t,e={}){const n=e.padding??0,i=t.getBoundingClientRect(),r=i.width+n*2,s=i.height+n*2,a=document.implementation.createDocument(Oc,"svg",null),o=a.documentElement;o.setAttribute("xmlns",Oc),o.setAttributeNS(RR,"xmlns:xlink","http://www.w3.org/1999/xlink"),en(o,{width:r,height:s,viewBox:`${-n} ${-n} ${r} ${s}`});const l=xt(a,"defs");if(o.appendChild(l),e.background){const f=xt(a,"rect");en(f,{x:-n,y:-n,width:r,height:s,fill:e.background}),o.appendChild(f)}const c={svgDocument:a,defs:l,idGenerator:WR(),options:e,compat:xB(e.compat),opacity:1};e.textToPath&&e.fonts&&(c.fontCache=iB(e.fonts));const u=await Y_(t,t,c);if(u){const f=window.getComputedStyle(t),p=R_(D_(f),i.width,i.height);if(O_(f)&&Zl(p)){const d=c.idGenerator.next("clip"),y=xt(a,"clipPath");y.setAttribute("id",d);const m=SB(a,i.width,i.height,p);y.appendChild(m),l.appendChild(y),u.setAttribute("clip-path",`url(#${d})`)}o.appendChild(u)}return l.childNodes.length===0&&o.removeChild(l),kB(o)}function SB(t,e,n,i){if(Vd(i)){const s=xt(t,"rect");return en(s,{x:0,y:0,width:e,height:n,rx:i.topLeft[0],ry:i.topLeft[1]}),s}const r=xt(t,"path");return r.setAttribute("d",af(0,0,e,n,i)),r}function kB(t){return{svg:t,toString(){return`<?xml version="1.0" encoding="UTF-8"?>
${new XMLSerializer().serializeToString(t)}`},toBlob(){const e=this.toString();return new Blob([e],{type:"image/svg+xml;charset=utf-8"})},download(e="export.svg"){const n=this.toBlob(),i=URL.createObjectURL(n),r=document.createElement("a");r.href=i,r.download=e,r.click(),setTimeout(()=>URL.revokeObjectURL(i),6e4)}}}const AB={background:"transparent",padding:EE,compat:"inkscape"},NB=[".svelte-flow__background",".svelte-flow__controls",".svelte-flow__minimap",".svelte-flow__panel",".svelte-flow__edge-interaction",".svelte-flow__attribution",".drop-zone-overlay"].join(", "),Gi="https://cdn.jsdelivr.net/npm/katex@0.16.9/dist/fonts",CB={Inter:{url:"/fonts/InterVariable.ttf"},"JetBrains Mono":[{url:"/fonts/JetBrainsMono-Regular.ttf",weight:400,style:"normal"},{url:"/fonts/JetBrainsMono-Medium.ttf",weight:500,style:"normal"}],KaTeX_Main:[{url:`${Gi}/KaTeX_Main-Regular.woff2`,weight:"normal",style:"normal"},{url:`${Gi}/KaTeX_Main-Bold.woff2`,weight:"bold",style:"normal"},{url:`${Gi}/KaTeX_Main-Italic.woff2`,weight:"normal",style:"italic"},{url:`${Gi}/KaTeX_Main-BoldItalic.woff2`,weight:"bold",style:"italic"}],KaTeX_Math:[{url:`${Gi}/KaTeX_Math-Italic.woff2`,weight:"normal",style:"italic"},{url:`${Gi}/KaTeX_Math-BoldItalic.woff2`,weight:"bold",style:"italic"}],KaTeX_Size1:[{url:`${Gi}/KaTeX_Size1-Regular.woff2`,weight:"normal",style:"normal"}],KaTeX_Size2:[{url:`${Gi}/KaTeX_Size2-Regular.woff2`,weight:"normal",style:"normal"}],KaTeX_Size3:[{url:`${Gi}/KaTeX_Size3-Regular.woff2`,weight:"normal",style:"normal"}],KaTeX_Size4:[{url:`${Gi}/KaTeX_Size4-Regular.woff2`,weight:"normal",style:"normal"}],KaTeX_AMS:[{url:`${Gi}/KaTeX_AMS-Regular.woff2`,weight:"normal",style:"normal"}],KaTeX_Caligraphic:[{url:`${Gi}/KaTeX_Caligraphic-Regular.woff2`,weight:"normal",style:"normal"},{url:`${Gi}/KaTeX_Caligraphic-Bold.woff2`,weight:"bold",style:"normal"}],KaTeX_Fraktur:[{url:`${Gi}/KaTeX_Fraktur-Regular.woff2`,weight:"normal",style:"normal"},{url:`${Gi}/KaTeX_Fraktur-Bold.woff2`,weight:"bold",style:"normal"}],KaTeX_SansSerif:[{url:`${Gi}/KaTeX_SansSerif-Regular.woff2`,weight:"normal",style:"normal"},{url:`${Gi}/KaTeX_SansSerif-Bold.woff2`,weight:"bold",style:"normal"},{url:`${Gi}/KaTeX_SansSerif-Italic.woff2`,weight:"normal",style:"italic"}],KaTeX_Script:[{url:`${Gi}/KaTeX_Script-Regular.woff2`,weight:"normal",style:"normal"}],KaTeX_Typewriter:[{url:`${Gi}/KaTeX_Typewriter-Regular.woff2`,weight:"normal",style:"normal"}]};function PB(t){const e=t.style.transform,n=e.match(/translate\(([^,]+)px,\s*([^)]+)px\)/),i=e.match(/scale\(([^)]+)\)/);return{panX:n?parseFloat(n[1]):0,panY:n?parseFloat(n[2]):0,zoom:i?parseFloat(i[1]):1}}function EB(t,e){const{panX:n,panY:i,zoom:r}=PB(e),s=t.getBoundingClientRect(),a={minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0};function o(l){if(l.width===0&&l.height===0)return;const c=(l.left-s.left-n)/r,u=(l.top-s.top-i)/r,f=l.width/r,p=l.height/r;a.minX=Math.min(a.minX,c),a.minY=Math.min(a.minY,u),a.maxX=Math.max(a.maxX,c+f),a.maxY=Math.max(a.maxY,u+p)}for(const l of t.querySelectorAll(".svelte-flow__node"))o(l.getBoundingClientRect());for(const l of t.querySelectorAll(".svelte-flow__edge"))o(l.getBoundingClientRect());return isFinite(a.minX)?a:{minX:0,minY:0,maxX:200,maxY:200}}function IB(t){let e=t;for(;;){const s=Array.from(e.children).filter(a=>a.tagName==="g");if(s.length===1){e=s[0];continue}break}const n=Array.from(e.children),i=[],r=[];for(const s of n)s.querySelector('[aria-label^="Edge from"]')?i.push(s):r.push(s);if(i.length!==0)for(const s of[...i,...r])e.appendChild(s)}async function K_(t={}){const e={...AB,...t},n=e.padding,i=document.querySelector(".svelte-flow");if(!i)throw new Error("SvelteFlow element not found");const r=i.querySelector(".svelte-flow__viewport");if(!r)throw new Error("SvelteFlow viewport not found");const s=getComputedStyle(i).getPropertyValue("--surface").trim(),a=EB(i,r),o=a.maxX-a.minX,l=a.maxY-a.minY,c=o+2*n,u=l+2*n,f=i.style.backgroundColor,p=i.style.width,d=i.style.height,y=i.style.minWidth,m=i.style.minHeight,w=i.style.overflow,b=document.createElement("style");b.textContent=`.svelte-flow__viewport { transform: translate(${-a.minX+n}px, ${-a.minY+n}px) scale(1) !important; }`,document.head.appendChild(b),i.style.backgroundColor="transparent",i.style.width=`${c}px`,i.style.height=`${u}px`,i.style.minWidth=`${c}px`,i.style.minHeight=`${u}px`,i.style.overflow="visible",await new Promise(S=>requestAnimationFrame(()=>requestAnimationFrame(S)));try{const S=await _B(i,{background:e.background==="solid"?s:void 0,padding:0,exclude:NB,flattenTransforms:!0,textToPath:!0,fonts:CB,compat:e.compat});return S.svg.setAttribute("width",String(c)),S.svg.setAttribute("height",String(u)),S.svg.setAttribute("viewBox",`0 0 ${c} ${u}`),IB(S.svg),S.toString()}finally{b.remove(),i.style.backgroundColor=f,i.style.width=p,i.style.height=d,i.style.minWidth=y,i.style.minHeight=m,i.style.overflow=w}}async function LB(t={}){const e=await K_(t),r=new DOMParser().parseFromString(e,"image/svg+xml").documentElement,s=parseFloat(r.getAttribute("width")||"800"),a=parseFloat(r.getAttribute("height")||"600"),o=new Ut({orientation:s>a?"landscape":"portrait",unit:"pt",format:[s,a]});await o.svg(r,{x:0,y:0,width:s,height:a}),o.save("pathview-graph.pdf")}const Yi={label:"",action:()=>{},divider:!0};function _m(t,e){const n=Je(r0),{inputs:i,outputs:r}=TE(e,n),s=e.inputs&&e.inputs.length>0,a=e.outputs&&e.outputs.length>0;if(!s&&!a)return[];const o=[Yi];return s&&o.push({label:i?"Hide Input Labels":"Show Input Labels",icon:"tag",action:()=>It.mutate(()=>Fe.updateNodeParams(t,{_showInputLabels:!i}))}),a&&o.push({label:r?"Hide Output Labels":"Show Output Labels",icon:"tag",action:()=>It.mutate(()=>Fe.updateNodeParams(t,{_showOutputLabels:!r}))}),o}function Sm(t){const e=Fe.getNode(t);if(!e)return;const n=Fe.getAllNodes(),i=Fe.getAllConnections().map(o=>o.connection),r=Os.getCode(),s=gx(e,r),a=b0(e,n,i);Kh.open(s+a,"Block Python Code")}function MB(t){const e=vn.getEvent(t);if(!e)return;const n=Os.getCode(),i=mx(e,n),r=ux(e);Kh.open(i+r,"Event Python Code")}function TB(t){const e=Fe.getNode(t);if(!e)return[];const n=e.type===_n.SUBSYSTEM;if(e.type===_n.INTERFACE){const o=[{label:"Properties",icon:"settings",shortcut:"Dbl-click",action:()=>ch(t)},{label:"Exit Subsystem",icon:"exit",action:()=>Fe.drillUp()}];return o.push(..._m(t,e)),o.push(Yi,{label:"View Code",icon:"braces",action:()=>Sm(t)}),o}if(n){const o=[{label:"Properties",icon:"settings",action:()=>ch(t)},{label:"Enter Subsystem",icon:"enter",shortcut:"Dbl-click",action:()=>Fe.drillDown(t)}];return o.push(..._m(t,e)),o.push(Yi,{label:"View Code",icon:"braces",action:()=>Sm(t)},{label:"Export",icon:"upload",action:()=>Jm("subsystem",t)},Yi,{label:"Duplicate",icon:"copy",shortcut:"Ctrl+D",action:()=>{Fe.selectNode(t,!1),Fe.duplicateSelected()}},{label:"Copy",icon:"clipboard",shortcut:"Ctrl+C",action:()=>{Fe.selectNode(t,!1),fo.copy()}},Yi,{label:"Delete",icon:"trash",shortcut:"Del",action:()=>It.mutate(()=>Fe.removeNode(t))}),o}const r=e.type==="Scope"||e.type==="Spectrum",s=e.type==="Scope"?"scope":"spectrum",a=[{label:"Properties",icon:"settings",shortcut:"Dbl-click",action:()=>ch(t)}];if(a.push(..._m(t,e)),a.push(Yi,{label:"View Code",icon:"braces",action:()=>Sm(t)}),r){const o=bx(t,s);a.push({label:"Export CSV",icon:"table",action:()=>x0(t,e.name,e.type),disabled:!o})}return a.push({label:"Export",icon:"upload",action:()=>Jm("block",t)},Yi,{label:"Duplicate",icon:"copy",shortcut:"Ctrl+D",action:()=>{Fe.selectNode(t,!1),It.mutate(()=>Fe.duplicateSelected())}},{label:"Copy",icon:"clipboard",shortcut:"Ctrl+C",action:()=>{Fe.selectNode(t,!1),fo.copy()}},Yi,{label:"Delete",icon:"trash",shortcut:"Del",action:()=>It.mutate(()=>Fe.removeNode(t))}),a}function DB(t,e){const n=t.length;return[{label:`Duplicate ${n} nodes`,icon:"copy",shortcut:"Ctrl+D",action:()=>It.mutate(()=>Fe.duplicateSelected())},{label:`Copy ${n} nodes`,icon:"clipboard",shortcut:"Ctrl+C",action:()=>fo.copy()},Yi,{label:`Delete ${n} nodes`,icon:"trash",shortcut:"Del",action:()=>e(t)}]}function OB(t){return[{label:"Properties",icon:"settings",shortcut:"Dbl-click",action:()=>zw(t)},Yi,{label:"View Code",icon:"braces",action:()=>MB(t)},Yi,{label:"Duplicate",icon:"copy",shortcut:"Ctrl+D",action:()=>{vn.selectEvent(t,!1),It.mutate(()=>vn.duplicateSelected())}},{label:"Copy",icon:"clipboard",shortcut:"Ctrl+C",action:()=>{vn.selectEvent(t,!1),fo.copy()}},Yi,{label:"Delete",icon:"trash",shortcut:"Del",action:()=>It.mutate(()=>vn.removeEvent(t))}]}function FB(t){return[{label:"Reset Route",icon:"rotate",action:()=>Ci.resetRoute(t)},Yi,{label:"Delete",icon:"trash",shortcut:"Del",action:()=>It.mutate(()=>Fe.removeConnection(t))}]}function RB(t,e){const n=fo.hasContent(),i=[{label:"Add Block",icon:"grid",shortcut:"B",action:()=>e.toggleNodeLibrary()},{label:"Add Event",icon:"zap",shortcut:"N",action:()=>e.toggleEventsPanel()},{label:"Add Annotation",icon:"type",action:()=>{const r=uo(t);It.mutate(()=>Fe.addAnnotation(r))}},Yi,{label:"Open/Import",icon:"download",action:()=>{const r=uo(t);ax(r)}},{label:"Export SVG",icon:"image",action:async()=>{try{const r=await K_({compat:"inkscape"});A7(r,"pathview-graph.svg")}catch(r){console.error("SVG export failed:",r)}}},{label:"Export PDF",icon:"image",action:async()=>{try{await LB()}catch(r){console.error("PDF export failed:",r)}}}];return n&&i.push(Yi,{label:"Paste",icon:"clipboard",shortcut:"Ctrl+V",action:()=>{const r=uo(t);fo.paste(r)}}),i.push(Yi,{label:"Fit View",icon:"maximize",shortcut:"F",action:()=>sl()}),i}function BB(t){const n=Fe.getAnnotation(t)?.fontSize||Rr.DEFAULT;return[{label:"Edit",icon:"type",shortcut:"Dbl-click",action:()=>m8(t)},Yi,{label:"Increase Font Size",icon:"font-size-increase",action:()=>{n<Rr.MAX&&It.mutate(()=>Fe.updateAnnotation(t,{fontSize:n+Rr.STEP}))},disabled:n>=Rr.MAX},{label:"Decrease Font Size",icon:"font-size-decrease",action:()=>{n>Rr.MIN&&It.mutate(()=>Fe.updateAnnotation(t,{fontSize:n-Rr.STEP}))},disabled:n<=Rr.MIN},Yi,{label:"Duplicate",icon:"copy",shortcut:"Ctrl+D",action:()=>{Fe.selectNode(t,!1),It.mutate(()=>Fe.duplicateSelected())}},{label:"Copy",icon:"clipboard",shortcut:"Ctrl+C",action:()=>{Fe.selectNode(t,!1),fo.copy()}},Yi,{label:"Delete",icon:"trash",shortcut:"Del",action:()=>It.mutate(()=>Fe.removeAnnotation(t))}]}function zB(t,e){const n=Fe.getNode(t),i=n?.name||"Plot",r=n?.type||"Scope",a=bx(t,r==="Spectrum"?"spectrum":"scope"),c=(Je(kr).blocks[t]??Wh).showLegend;return[{label:"Export CSV",icon:"table",action:()=>x0(t,i,r),disabled:!a},Yi,{label:c?"Hide Legend":"Show Legend",icon:"list",action:()=>kr.setBlockShowLegend(t,!c)},{label:"Reset View",icon:"maximize",shortcut:"Dbl-click",action:async()=>{(await hs(()=>import("./bCZ0t4tq.js").then(f=>f.p),[],import.meta.url)).relayout(e,{"xaxis.autorange":!0,"yaxis.autorange":!0})}}]}function qB(t,e,n){if(!t)return[];switch(t.type){case"node":return TB(t.nodeId);case"selection":return DB([...t.nodeIds],n.deleteNodes);case"event":return OB(t.eventId);case"edge":return FB(t.edgeId);case"canvas":return RB(e,n);case"annotation":return BB(t.annotationId);case"plot":return zB(t.nodeId,t.plotEl);default:return[]}}var jB=Me('<div class="loading svelte-u0xts8">Loading syntax highlighting...</div>'),HB=Me('<div class="dialog-backdrop" role="presentation"><div class="dialog glass-panel svelte-u0xts8" role="dialog" tabindex="-1" aria-labelledby="dialog-title"><div class="dialog-header"><span id="dialog-title">Export Python Code</span> <div class="header-actions svelte-u0xts8"><button aria-label="Copy to Clipboard"><!></button> <button class="icon-btn" aria-label="Download Python file"><!></button> <button class="icon-btn" aria-label="Close"><!></button></div></div> <div class="dialog-body svelte-u0xts8"><div class="code-preview svelte-u0xts8"><!></div></div></div></div>');function UB(t,e){Tt(e,!0);let n=ct(e,"open",3,!1),i=Oe(void 0),r=null,s=null,a=Oe(!0),o=Oe("dark");const l=ol.subscribe(M=>{J(o,M,!0),r&&s&&h(i)&&d()});let c=Oe(""),u=Oe(!1);mn(()=>{n()?(J(c,m(),!0),J(u,!1),J(a,!0),setTimeout(()=>y(),0)):p()});function f(){return s?$d(s,h(o)==="dark",{readOnly:!0}):[]}function p(){r&&(r.destroy(),r=null)}function d(){if(!r||!h(i)||!s)return;const M=r.state.doc.toString();r.destroy(),r=new s.EditorView({doc:M,extensions:f(),parent:h(i)})}async function y(){h(i)&&(p(),s=await Pp(),r=new s.EditorView({doc:h(c),extensions:f(),parent:h(i)}),J(a,!1))}function m(){const{nodes:M,connections:T}=Fe.toJSON(),D=is.get(),U=Os.getCode(),C=vn.toJSON();return mM(M,T,D,U,C)}function w(){navigator.clipboard.writeText(h(c)),J(u,!0),setTimeout(()=>J(u,!1),2e3)}function b(){N7(h(c),"pathview_simulation.py")}function S(M){M.target===M.currentTarget&&e.onClose()}function A(M){M.key==="Escape"&&e.onClose()}Ei(()=>{l(),p()});var _=$e();yn("keydown",ii,A);var I=Ue(_);{var E=M=>{var T=HB();T.__click=S;var D=se(T),U=se(D),C=be(se(U),2),N=se(C);let B;N.__click=w;var P=se(N);{var F=re=>{qt(re,{name:"check",size:16})},q=re=>{qt(re,{name:"copy",size:16})};ke(P,re=>{h(u)?re(F):re(q,!1)})}Q(N),wt(N,(re,ae)=>$t?.(re,ae),()=>h(u)?"Copied!":"Copy to Clipboard");var Z=be(N,2);Z.__click=b;var W=se(Z);qt(W,{name:"download",size:16}),Q(Z),wt(Z,(re,ae)=>$t?.(re,ae),()=>"Download .py");var Y=be(Z,2);Y.__click=function(...re){e.onClose?.apply(this,re)};var ue=se(Y);qt(ue,{name:"x",size:16}),Q(Y),wt(Y,(re,ae)=>$t?.(re,ae),()=>({text:"Close",shortcut:"Esc"})),Q(C),Q(U);var le=be(U,2),O=se(le),V=se(O);{var G=re=>{var ae=jB();j(re,ae)};ke(V,re=>{h(a)&&re(G)})}Q(O),ji(O,re=>J(i,re),()=>h(i)),Q(le),Q(D),Q(T),_e(()=>B=Xt(N,1,"icon-btn",null,B,{success:h(u)})),Si(3,D,()=>po,()=>({start:.95,duration:150,easing:Da})),Si(3,T,()=>dl,()=>({duration:150})),j(M,T)};ke(I,M=>{n()&&M(E)})}j(t,_),Dt()}Kn(["click"]);var WB=Me('<span class="separator svelte-idx2ha">+</span>'),VB=Me('<kbd class="svelte-idx2ha"> </kbd><!>',1),GB=Me('<div class="shortcut-row svelte-idx2ha"><span class="keys svelte-idx2ha"></span> <span class="label svelte-idx2ha"> </span></div>'),XB=Me('<div class="section svelte-idx2ha"><div class="section-header svelte-idx2ha"> </div> <div class="section-items svelte-idx2ha"></div></div>'),YB=Me('<div class="dialog-backdrop" role="presentation"><div class="dialog glass-panel svelte-idx2ha" role="dialog" tabindex="-1" aria-modal="true" aria-labelledby="shortcuts-title"><div class="dialog-header"><span id="shortcuts-title">Keyboard Shortcuts</span> <button class="icon-btn ghost" aria-label="Close"><!></button></div> <div class="dialog-body svelte-idx2ha"></div> <div class="dialog-footer svelte-idx2ha">Press <kbd class="svelte-idx2ha">?</kbd> to toggle</div></div></div>');function KB(t,e){Tt(e,!0);function n(o){o.key==="Escape"&&e.onClose()}const i=[{category:"File",items:[{keys:["Ctrl","O"],description:"Open"},{keys:["Ctrl","S"],description:"Save"},{keys:["Ctrl","Shift","S"],description:"Save as"},{keys:["Ctrl","E"],description:"Export Python"}]},{category:"Edit",items:[{keys:["Ctrl","Z"],description:"Undo"},{keys:["Ctrl","Y"],description:"Redo"},{keys:["Ctrl","A"],description:"Select all"},{keys:["Ctrl","X"],description:"Cut"},{keys:["Ctrl","C"],description:"Copy"},{keys:["Ctrl","V"],description:"Paste"},{keys:["Ctrl","D"],description:"Duplicate"},{keys:["Del"],description:"Delete"},{keys:["Ctrl","F"],description:"Find"},{keys:["Esc"],description:"Deselect"}]},{category:"Transform",items:[{keys:["R"],description:"Rotate 90Â°"},{keys:["X"],description:"Flip H"},{keys:["Y"],description:"Flip V"},{keys:["Arrows"],description:"Nudge"},{keys:["Shift","Arrows"],description:"Nudge 10px"}]},{category:"View",items:[{keys:["F"],description:"Fit view"},{keys:["H"],description:"Go to root"},{keys:["+"],description:"Zoom in"},{keys:["-"],description:"Zoom out"},{keys:["L"],description:"Port labels"},{keys:["T"],description:"Theme"}]},{category:"Panels",items:[{keys:["S"],description:"Simulation"},{keys:["B"],description:"Blocks"},{keys:["N"],description:"Events"},{keys:["E"],description:"Editor"},{keys:["V"],description:"Results"},{keys:["C"],description:"Console"},{keys:["P"],description:"Pin plots"}]},{category:"Run",items:[{keys:["Ctrl","Enter"],description:"Simulate"},{keys:["Shift","Enter"],description:"Continue"},{keys:["?"],description:"Shortcuts"}]}];var r=$e();yn("keydown",ii,n);var s=Ue(r);{var a=o=>{var l=YB();l.__click=function(...y){e.onClose?.apply(this,y)};var c=se(l);c.__click=y=>y.stopPropagation();var u=se(c),f=be(se(u),2);f.__click=function(...y){e.onClose?.apply(this,y)};var p=se(f);qt(p,{name:"x",size:16}),Q(f),Q(u);var d=be(u,2);fn(d,21,()=>i,Nn,(y,m)=>{var w=XB(),b=se(w),S=se(b,!0);Q(b);var A=be(b,2);fn(A,21,()=>h(m).items,Nn,(_,I)=>{var E=GB(),M=se(E);fn(M,21,()=>h(I).keys,Nn,(U,C,N)=>{var B=VB(),P=Ue(B),F=se(P,!0);Q(P);var q=be(P);{var Z=W=>{var Y=WB();j(W,Y)};ke(q,W=>{N<h(I).keys.length-1&&W(Z)})}_e(()=>Wt(F,h(C))),j(U,B)}),Q(M);var T=be(M,2),D=se(T,!0);Q(T),Q(E),_e(()=>Wt(D,h(I).description)),j(_,E)}),Q(A),Q(w),_e(()=>Wt(S,h(m).category)),j(y,w)}),Q(d),Ri(2),Q(c),Q(l),Si(3,c,()=>po,()=>({start:.95,duration:150,easing:Da})),Si(3,l,()=>dl,()=>({duration:150})),j(o,l)};ke(s,o=>{e.open&&o(a)})}j(t,r),Dt()}Kn(["click"]);var ZB=Me('<div class="empty-state svelte-1ijrao5"><p>Run simulation to see trace options</p></div>'),JB=rt('<line x1="2" y1="8" x2="30" y2="8" stroke-width="2"></line>'),QB=rt('<circle cx="16" cy="8" r="3"></circle>'),$B=rt('<rect x="13" y="5" width="6" height="6"></rect>'),ez=rt('<polygon points="16,3 20,11 12,11"></polygon>'),tz=rt('<line x1="2" y1="8" x2="30" y2="8" stroke="var(--text-disabled)" stroke-width="1" stroke-dasharray="2,2"></line>'),nz=Me('<button><svg width="20" height="10" viewBox="0 0 20 10"><line x1="2" y1="5" x2="18" y2="5" stroke="currentColor" stroke-width="2"></line></svg></button>'),iz=rt('<circle cx="7" cy="7" r="4" fill="currentColor"></circle>'),rz=rt('<rect x="3" y="3" width="8" height="8" fill="currentColor"></rect>'),sz=rt('<polygon points="7,2 12,11 2,11" fill="currentColor"></polygon>'),az=Me('<button><svg width="10" height="10" viewBox="0 0 14 14"><!></svg></button>'),oz=Me('<div class="trace-row svelte-1ijrao5"><div class="col-preview svelte-1ijrao5"><svg width="32" height="16" viewBox="0 0 32 16"><!><!><!></svg></div> <div class="col-name svelte-1ijrao5"><span class="signal-label svelte-1ijrao5"> </span></div> <div class="col-line svelte-1ijrao5"></div> <div></div> <div class="col-marker svelte-1ijrao5"></div></div>'),lz=Me('<div class="block-card svelte-1ijrao5"><div class="block-header svelte-1ijrao5"><div class="block-title svelte-1ijrao5"><!> <span> </span></div> <div class="block-controls svelte-1ijrao5"><button title="Show legend">Legend</button> <button> </button> <button> </button></div></div> <div class="traces-table svelte-1ijrao5"><div class="table-header svelte-1ijrao5"><div class="col-preview svelte-1ijrao5">Preview</div> <div class="col-name svelte-1ijrao5"></div> <div class="col-line svelte-1ijrao5">Line</div> <div></div> <div class="col-marker svelte-1ijrao5">Marker</div></div> <!></div></div>'),cz=Me('<div class="dialog-backdrop" role="presentation"><div class="dialog glass-panel svelte-1ijrao5" role="dialog" tabindex="-1" aria-modal="true" aria-labelledby="plot-options-title"><div class="dialog-header"><span id="plot-options-title">Plot Options</span> <button class="icon-btn ghost" aria-label="Close"><!></button></div> <div class="dialog-body svelte-1ijrao5"><!></div></div></div>');function uz(t,e){Tt(e,!0);let n=ct(e,"traces",19,()=>[]),i=Oe(Rn({traces:{},blocks:{}}));const r=kr.subscribe(_=>{J(i,_,!0)});Ei(()=>{r()});function s(_){_.key==="Escape"&&e.onClose()}function a(_){return h(i).traces[_]??{...Vm}}function o(_){return h(i).blocks[_]??{...Wh}}const l=[{value:"solid",label:"Solid"},{value:"dash",label:"Dash"},{value:"dot",label:"Dot"}],c=[{value:"circle",label:"Circle"},{value:"square",label:"Square"},{value:"triangle-up",label:"Triangle"}];function u(_,I){a(_).lineStyle===I?kr.setTraceLineStyle(_,null):kr.setTraceLineStyle(_,I)}function f(_,I){a(_).markerStyle===I?kr.setTraceMarkerStyle(_,null):kr.setTraceMarkerStyle(_,I)}function p(_){const I=o(_);kr.setBlockXAxisScale(_,I.xAxisScale==="linear"?"log":"linear")}function d(_){const I=o(_);kr.setBlockYAxisScale(_,I.yAxisScale==="linear"?"log":"linear")}function y(_){const I=o(_);kr.setBlockShowLegend(_,!I.showLegend)}const m=ne(()=>()=>{const _=new Map;for(const I of n()){const E=I.nodeId;_.has(E)||_.set(E,[]),_.get(E).push(I)}return _});function w(_){return _?Dw[_]:""}var b=$e();yn("keydown",ii,s);var S=Ue(b);{var A=_=>{var I=cz();I.__click=function(...P){e.onClose?.apply(this,P)};var E=se(I);E.__click=P=>P.stopPropagation();var M=se(E),T=be(se(M),2);T.__click=function(...P){e.onClose?.apply(this,P)};var D=se(T);qt(D,{name:"x",size:16}),Q(T),Q(M);var U=be(M,2),C=se(U);{var N=P=>{var F=ZB();j(P,F)},B=P=>{var F=$e(),q=Ue(F);fn(q,17,()=>[...h(m)()],Nn,(Z,W)=>{var Y=ne(()=>Rc(h(W),2));let ue=()=>h(Y)[0],le=()=>h(Y)[1];const O=ne(()=>le()[0]),V=ne(()=>o(ue()));var G=lz(),re=se(G),ae=se(re),ee=se(ae);{let We=ne(()=>h(O).nodeType==="scope"?"activity":"bar-chart-2");qt(ee,{get name(){return h(We)},size:14})}var de=be(ee,2),he=se(de,!0);Q(de),Q(ae);var pe=be(ae,2),ge=se(pe);let Ee;ge.__click=()=>y(ue());var Ae=be(ge,2);let Ye;Ae.__click=()=>p(ue());var K=se(Ae);Q(Ae);var Re=be(Ae,2);let Qe;Re.__click=()=>d(ue());var Be=se(Re);Q(Re),Q(pe),Q(re);var Ie=be(re,2),lt=be(se(Ie),2);fn(lt,17,le,Nn,(We,Ke,ht,Rt)=>{const ye=ne(()=>Gm(h(Ke).nodeId,h(Ke).signalIndex)),qe=ne(()=>a(h(ye))),ve=ne(()=>Mw(h(Ke).signalIndex,Tw()));var Pe=oz(),Le=se(Pe),it=se(Le),nt=se(it);{var _t=kt=>{var gt=JB();_e(Gt=>{fe(gt,"stroke",h(ve)),fe(gt,"stroke-dasharray",Gt)},[()=>w(h(qe).lineStyle)]),j(kt,gt)};ke(nt,kt=>{h(qe).lineStyle&&kt(_t)})}var At=be(nt);{var St=kt=>{var gt=$e(),Gt=Ue(gt);{var oi=Cn=>{var li=QB();_e(()=>fe(li,"fill",h(ve))),j(Cn,li)},bn=Cn=>{var li=$e(),Bt=Ue(li);{var Jn=Pn=>{var jn=$B();_e(()=>fe(jn,"fill",h(ve))),j(Pn,jn)},qn=Pn=>{var jn=$e(),wn=Ue(jn);{var je=tt=>{var Ft=ez();_e(()=>fe(Ft,"fill",h(ve))),j(tt,Ft)};ke(wn,tt=>{h(qe).markerStyle==="triangle-up"&&tt(je)},!0)}j(Pn,jn)};ke(Bt,Pn=>{h(qe).markerStyle==="square"?Pn(Jn):Pn(qn,!1)},!0)}j(Cn,li)};ke(Gt,Cn=>{h(qe).markerStyle==="circle"?Cn(oi):Cn(bn,!1)})}j(kt,gt)};ke(At,kt=>{h(qe).markerStyle&&kt(St)})}var st=be(At);{var Ot=kt=>{var gt=tz();j(kt,gt)};ke(st,kt=>{!h(qe).lineStyle&&!h(qe).markerStyle&&kt(Ot)})}Q(it),Q(Le);var dt=be(Le,2),bt=se(dt),ot=se(bt,!0);Q(bt),Q(dt);var vt=be(dt,2);fn(vt,21,()=>l,Nn,(kt,gt)=>{var Gt=nz();let oi;Gt.__click=()=>u(h(ye),h(gt).value);var bn=se(Gt),Cn=se(bn);Q(bn),Q(Gt),_e(li=>{oi=Xt(Gt,1,"style-pill svelte-1ijrao5",null,oi,{active:h(qe).lineStyle===h(gt).value}),fe(Gt,"title",h(gt).label),fe(Cn,"stroke-dasharray",li)},[()=>w(h(gt).value)]),j(kt,Gt)}),Q(vt);var jt=be(vt,4);fn(jt,21,()=>c,Nn,(kt,gt)=>{var Gt=az();let oi;Gt.__click=()=>f(h(ye),h(gt).value);var bn=se(Gt),Cn=se(bn);{var li=Jn=>{var qn=iz();j(Jn,qn)},Bt=Jn=>{var qn=$e(),Pn=Ue(qn);{var jn=je=>{var tt=rz();j(je,tt)},wn=je=>{var tt=$e(),Ft=Ue(tt);{var nn=Yt=>{var Vt=sz();j(Yt,Vt)};ke(Ft,Yt=>{h(gt).value==="triangle-up"&&Yt(nn)},!0)}j(je,tt)};ke(Pn,je=>{h(gt).value==="square"?je(jn):je(wn,!1)},!0)}j(Jn,qn)};ke(Cn,Jn=>{h(gt).value==="circle"?Jn(li):Jn(Bt,!1)})}Q(bn),Q(Gt),_e(()=>{oi=Xt(Gt,1,"style-pill marker-pill svelte-1ijrao5",null,oi,{active:h(qe).markerStyle===h(gt).value}),fe(Gt,"title",h(gt).label)}),j(kt,Gt)}),Q(jt),Q(Pe),_e(()=>Wt(ot,h(Ke).signalLabel)),j(We,Pe)}),Q(Ie),Q(G),_e(()=>{Wt(he,h(O).nodeName),Ee=Xt(ge,1,"scale-btn svelte-1ijrao5",null,Ee,{active:h(V).showLegend}),Ye=Xt(Ae,1,"scale-btn svelte-1ijrao5",null,Ye,{log:h(V).xAxisScale==="log"}),fe(Ae,"title",`X-Axis: ${h(V).xAxisScale??""}`),Wt(K,`X:${h(V).xAxisScale==="log"?"log":"lin"}`),Qe=Xt(Re,1,"scale-btn svelte-1ijrao5",null,Qe,{log:h(V).yAxisScale==="log"}),fe(Re,"title",`Y-Axis: ${h(V).yAxisScale??""}`),Wt(Be,`Y:${h(V).yAxisScale==="log"?"log":"lin"}`)}),j(Z,G)}),j(P,F)};ke(C,P=>{n().length===0?P(N):P(B,!1)})}Q(U),Q(E),Q(I),Si(3,E,()=>po,()=>({start:.95,duration:150,easing:Da})),Si(3,I,()=>dl,()=>({duration:150})),j(_,I)};ke(S,_=>{e.open&&_(A)})}j(t,b),Dt()}Kn(["click"]);var dz=Me('<button class="clear-btn svelte-g23ysy"><!></button>'),fz=Me('<button><div class="result-main svelte-g23ysy"><span class="node-name svelte-g23ysy"> </span> <span class="node-type svelte-g23ysy"> </span></div> <div class="result-path svelte-g23ysy"> </div></button>'),hz=Me('<div class="results svelte-g23ysy"></div>'),pz=Me('<div class="no-results svelte-g23ysy">No blocks found</div>'),gz=Me('<div class="dialog-backdrop" role="presentation"><div class="search-dialog glass-panel svelte-g23ysy" role="dialog" tabindex="-1" aria-modal="true"><div class="search-container svelte-g23ysy"><span class="search-icon svelte-g23ysy"><!></span> <input type="text" placeholder="Find block..." class="search-input svelte-g23ysy"/> <!></div> <!> <div class="footer svelte-g23ysy"><span><kbd class="svelte-g23ysy">â</kbd><kbd class="svelte-g23ysy">â</kbd> navigate</span> <span><kbd class="svelte-g23ysy">âµ</kbd> select</span> <span><kbd class="svelte-g23ysy">esc</kbd> close</span></div></div></div>');function mz(t,e){Tt(e,!0);let n=Oe(""),i=Oe(void 0),r=Oe(0),s=Oe(Rn([])),a=Oe(Rn([]));const o=Fe.currentPath.subscribe(w=>{J(a,w,!0)});Ei(()=>{o()}),mn(()=>{e.open&&J(s,Fe.getAllNodesWithPaths(),!0)});function l(w){return w.path.length!==h(a).length?!1:w.path.every((b,S)=>b===h(a)[S])}const c=ne(()=>()=>{let w=h(s);if(h(n).trim()){const b=h(n).toLowerCase();w=w.filter(S=>S.node.name.toLowerCase().includes(b)||S.node.type.toLowerCase().includes(b))}return[...w].sort((b,S)=>{const A=l(b),_=l(S);return A&&!_?-1:!A&&_?1:b.depth-S.depth})});mn(()=>{e.open&&(J(n,""),J(r,0),setTimeout(()=>h(i)?.focus(),50))}),mn(()=>{const w=h(c)();h(r)>=w.length&&J(r,Math.max(0,w.length-1),!0)});function u(w){if(!e.open)return;const b=h(c)();if(w.key==="Escape")e.onClose();else if(w.key==="ArrowDown")w.preventDefault(),J(r,Math.min(h(r)+1,b.length-1),!0);else if(w.key==="ArrowUp")w.preventDefault(),J(r,Math.max(h(r)-1,0),!0);else if(w.key==="Enter"){w.preventDefault();const S=b[h(r)];S&&f(S)}}function f(w){const b=w.path,S=Fe.getCurrentPath();b.length===S.length&&b.every((_,I)=>_===S[I])||Fe.navigateToPath(b),Fe.selectNode(w.node.id,!1),p8(w.node.id),e.onClose()}function p(w){return w.join(" > ")}var d=$e();yn("keydown",ii,u);var y=Ue(d);{var m=w=>{var b=gz();b.__click=function(...N){e.onClose?.apply(this,N)},b.__keydown=N=>N.key==="Escape"&&e.onClose();var S=se(b);S.__click=N=>N.stopPropagation();var A=se(S),_=se(A),I=se(_);qt(I,{name:"search",size:14}),Q(_);var E=be(_,2);Br(E),ji(E,N=>J(i,N),()=>h(i));var M=be(E,2);{var T=N=>{var B=dz();B.__click=()=>J(n,"");var P=se(B);qt(P,{name:"x",size:12}),Q(B),j(N,B)};ke(M,N=>{h(n)&&N(T)})}Q(A);var D=be(A,2);{var U=N=>{var B=hz();fn(B,21,()=>h(c)(),Nn,(P,F,q)=>{var Z=fz();let W;Z.__click=()=>f(h(F));var Y=se(Z),ue=se(Y),le=se(ue,!0);Q(ue);var O=be(ue,2),V=se(O,!0);Q(O),Q(Y);var G=be(Y,2),re=se(G,!0);Q(G),Q(Z),_e(ae=>{W=Xt(Z,1,"result-item svelte-g23ysy",null,W,{selected:q===h(r)}),Wt(le,h(F).node.name),Wt(V,h(F).node.type),Wt(re,ae)},[()=>p(h(F).pathNames)]),yn("mouseenter",Z,()=>J(r,q,!0)),j(P,Z)}),Q(B),j(N,B)},C=N=>{var B=$e(),P=Ue(B);{var F=q=>{var Z=pz();j(q,Z)};ke(P,q=>{h(n)&&q(F)},!0)}j(N,B)};ke(D,N=>{h(c)().length>0?N(U):N(C,!1)})}Ri(2),Q(S),Q(b),Rb(E,()=>h(n),N=>J(n,N)),Si(3,S,()=>po,()=>({start:.95,duration:150,easing:Da})),Si(3,b,()=>dl,()=>({duration:100})),j(w,b)};ke(y,w=>{e.open&&w(m)})}j(t,d),Dt()}Kn(["click","keydown"]);const zl=12,mb=52,Go=300,Z_=68;var vz=Me('<div class="resize-handle handle-left svelte-1xkowuz"></div>'),yz=Me('<div class="resize-handle handle-right svelte-1xkowuz"></div>'),bz=Me('<div class="resize-handle handle-top svelte-1xkowuz"></div>'),wz=Me('<div class="resize-handle handle-bottom svelte-1xkowuz"></div>'),xz=Me("<span> </span>"),_z=Me('<div class="panel-toolbar svelte-1xkowuz"><!></div>'),Sz=Me('<div class="panel-footer svelte-1xkowuz"><!></div>'),kz=Me('<aside><!> <!> <!> <!> <div class="panel-header svelte-1xkowuz"><!> <div class="header-actions svelte-1xkowuz"><!> <button class="icon-btn ghost" aria-label="Close"><!></button></div></div> <!> <div class="panel-content svelte-1xkowuz"><!></div> <!></aside>');function au(t,e){Tt(e,!0);let n=ct(e,"initialWidth",3,320),i=ct(e,"initialHeight",3,280),r=ct(e,"minWidth",3,200),s=ct(e,"minHeight",3,150),a=ct(e,"maxWidth",3,800),o=ct(e,"bottomOffset",3,0),l=ct(e,"currentHeight",15,280);function c(){return e.maxHeight!==void 0?e.maxHeight:e.position.includes("bottom")?window.innerHeight-Z_-zl*2:600}let u=Oe(Rn(ia(()=>n()))),f=Oe(Rn(ia(()=>i())));function p(){return e.width??h(u)}function d(pe){e.onWidthChange?e.onWidthChange(pe):J(u,pe,!0)}mn(()=>{l(h(f))});let y=Oe(!1),m=Oe(null);const w=ne(()=>e.position==="left"||e.position==="right"?`max-height: calc(100vh - 80px${o()>0?` - ${o()}px`:""});`:""),b=ne(()=>()=>{switch(e.position){case"left":return{right:!0,bottom:!0};case"right":return{left:!0,bottom:!0};case"bottom":return{top:!0};case"bottom-left":return{top:!0,right:!0};case"bottom-right":return{top:!0,left:!0};default:return{}}}),S=ne(()=>()=>{switch(e.position){case"left":return{x:-20};case"right":return{x:20};case"bottom":case"bottom-left":case"bottom-right":return{y:20};default:return{x:0}}});let A=null;function _(pe){return ge=>{ge.preventDefault(),J(y,!0),J(m,pe,!0);const Ee=ge.clientX,Ae=ge.clientY,Ye=p(),K=h(f);function Re(Ie){if(!h(y))return;const lt=Ie.clientX-Ee,We=Ie.clientY-Ae;if(h(m)==="right"){const Ke=Math.max(r(),Ye+lt);d(e.onWidthChange?Ke:Math.min(a(),Ke))}else if(h(m)==="left"){const Ke=Math.max(r(),Ye-lt);d(e.onWidthChange?Ke:Math.min(a(),Ke))}else h(m)==="bottom"?J(f,Math.min(c(),Math.max(s(),K+We)),!0):h(m)==="top"&&J(f,Math.min(c(),Math.max(s(),K-We)),!0)}function Qe(){document.removeEventListener("mousemove",Re),document.removeEventListener("mouseup",Be),document.body.classList.remove("resizing-ew","resizing-ns"),A=null}function Be(){J(y,!1),J(m,null),Qe()}A=Qe,document.addEventListener("mousemove",Re),document.addEventListener("mouseup",Be),document.body.classList.add(pe==="left"||pe==="right"?"resizing-ew":"resizing-ns")}}Ei(()=>{A?.()});var I=kz();let E;I.__mousedown=()=>Fe.clearSelection();var M=se(I);{var T=pe=>{var ge=vz(),Ee=ne(()=>_("left"));ge.__mousedown=function(...Ae){h(Ee)?.apply(this,Ae)},j(pe,ge)};ke(M,pe=>{h(b)().left&&pe(T)})}var D=be(M,2);{var U=pe=>{var ge=yz(),Ee=ne(()=>_("right"));ge.__mousedown=function(...Ae){h(Ee)?.apply(this,Ae)},j(pe,ge)};ke(D,pe=>{h(b)().right&&pe(U)})}var C=be(D,2);{var N=pe=>{var ge=bz(),Ee=ne(()=>_("top"));ge.__mousedown=function(...Ae){h(Ee)?.apply(this,Ae)},j(pe,ge)};ke(C,pe=>{h(b)().top&&pe(N)})}var B=be(C,2);{var P=pe=>{var ge=wz(),Ee=ne(()=>_("bottom"));ge.__mousedown=function(...Ae){h(Ee)?.apply(this,Ae)},j(pe,ge)};ke(B,pe=>{h(b)().bottom&&pe(P)})}var F=be(B,2),q=se(F);{var Z=pe=>{var ge=$e(),Ee=Ue(ge);gs(Ee,()=>e.header),j(pe,ge)},W=pe=>{var ge=xz(),Ee=se(ge,!0);Q(ge),_e(()=>Wt(Ee,e.title)),j(pe,ge)};ke(q,pe=>{e.header?pe(Z):pe(W,!1)})}var Y=be(q,2),ue=se(Y);{var le=pe=>{var ge=$e(),Ee=Ue(ge);gs(Ee,()=>e.actions),j(pe,ge)};ke(ue,pe=>{e.actions&&pe(le)})}var O=be(ue,2);O.__click=function(...pe){e.onClose?.apply(this,pe)};var V=se(O);qt(V,{name:"x",size:16}),Q(O),Q(Y),Q(F);var G=be(F,2);{var re=pe=>{var ge=_z(),Ee=se(ge);gs(Ee,()=>e.toolbar),Q(ge),j(pe,ge)};ke(G,pe=>{e.toolbar&&pe(re)})}var ae=be(G,2),ee=se(ae);gs(ee,()=>e.children??ta),Q(ae);var de=be(ae,2);{var he=pe=>{var ge=Sz(),Ee=se(ge);gs(Ee,()=>e.footer),Q(ge),j(pe,ge)};ke(de,pe=>{e.footer&&pe(he)})}Q(I),_e((pe,ge,Ee)=>{E=Xt(I,1,`resizable-panel glass-panel ${e.position??""}`,"svelte-1xkowuz",E,{resizing:h(y)}),An(I,`
		${pe??""}
		${ge??""}
		${Ee??""}
		${h(w)??""}
	`)},[()=>e.position==="left"||e.position==="right"?`width: ${p()}px;`:"",()=>(e.position==="bottom-left"||e.position==="bottom-right")&&e.width!==void 0?`width: ${p()}px;`:"",()=>e.position.includes("bottom")?`height: ${h(f)}px;`:""]),Si(3,I,()=>N1,()=>({...h(S)(),duration:200,easing:Da})),j(t,I),Dt()}Kn(["mousedown","click"]);var Az=Me('<a class="example-card svelte-1tjvg83"><div class="example-info svelte-1tjvg83"><div class="example-name svelte-1tjvg83"> </div> <div class="example-description svelte-1tjvg83"> </div></div> <div class="example-preview svelte-1tjvg83"><img class="svelte-1tjvg83"/></div></a>'),Nz=Me('<div class="dialog-backdrop" role="presentation"><div class="modal glass-panel svelte-1tjvg83" role="dialog" tabindex="-1"><div class="version-info svelte-1tjvg83"> </div> <div class="header svelte-1tjvg83"><img alt="PathView" class="logo svelte-1tjvg83"/></div> <div class="actions svelte-1tjvg83"><button class="action-card svelte-1tjvg83"><!> <span class="action-label svelte-1tjvg83">New</span></button> <a href="https://pathsim.org" target="_blank" class="action-card svelte-1tjvg83"><!> <span class="action-label svelte-1tjvg83">Home</span></a> <a href="https://docs.pathsim.org" target="_blank" class="action-card svelte-1tjvg83"><!> <span class="action-label svelte-1tjvg83">Docs</span></a> <a href="https://github.com/pathsim/pathview" target="_blank" class="action-card svelte-1tjvg83"><!> <span class="action-label svelte-1tjvg83">GitHub</span></a> <a href="https://github.com/pathsim/pathview/issues/new/choose" target="_blank" class="action-card svelte-1tjvg83"><!> <span class="action-label svelte-1tjvg83">Issue</span></a> <a href="https://milanrother.com/#services" target="_blank" class="action-card svelte-1tjvg83"><!> <span class="action-label svelte-1tjvg83">Consulting</span></a></div> <div class="separator svelte-1tjvg83"></div> <div class="examples-section svelte-1tjvg83"><div class="examples-grid svelte-1tjvg83"></div></div></div></div>');function Cz(t,e){Tt(e,!0);const n=[{filename:"feedback-system.json",basename:"feedback-system",name:"Feedback System",description:"Linear feedback system with delayed step excitation"},{filename:"harmonic-oscillator.json",basename:"harmonic-oscillator",name:"Harmonic Oscillator",description:"Linear spring-mass-damper system"},{filename:"squarewave-lpf.json",basename:"squarewave-lpf",name:"Squarewave LPF",description:"Low pass filtering of a square wave"},{filename:"pid-subsystem.json",basename:"pid-subsystem",name:"PID Loop",description:"Classic PID control loop as subsystem"},{filename:"thermostat.json",basename:"thermostat",name:"Thermostat",description:"Relay based thermostat heating system"},{filename:"cascade-subsystem.json",basename:"cascade-subsystem",name:"Cascade PI",description:"Cascade PI controller with subsystems"},{filename:"bouncing-ball.json",basename:"bouncing-ball",name:"Bouncing Ball",description:"Bouncing ball with event-based collision"},{filename:"fmcw-radar.json",basename:"fmcw-radar",name:"FMCW Radar",description:"Frequency-modulated continuous wave radar"},{filename:"vanderpol.json",basename:"vanderpol",name:"Van der Pol",description:"Van der Pol oscillator system"}];let i=Oe(!0);ju(()=>{const C=()=>{J(i,document.documentElement.getAttribute("data-theme")!=="light")};C();const N=new MutationObserver(C);return N.observe(document.documentElement,{attributes:!0,attributeFilter:["data-theme"]}),()=>N.disconnect()});function r(){e.onNew(),e.onClose()}function s(C){C.key==="Escape"&&e.onClose()}var a=Nz();yn("keydown",ii,s),a.__click=function(...C){e.onClose?.apply(this,C)},a.__keydown=C=>C.key==="Escape"&&e.onClose();var o=se(a);o.__click=C=>C.stopPropagation();var l=se(o),c=se(l);Q(l);var u=be(l,2),f=se(u);Q(u);var p=be(u,2),d=se(p);d.__click=r;var y=se(d);qt(y,{name:"new-canvas",size:20}),Ri(2),Q(d);var m=be(d,2),w=se(m);qt(w,{name:"home",size:20}),Ri(2),Q(m);var b=be(m,2),S=se(b);qt(S,{name:"book",size:20}),Ri(2),Q(b);var A=be(b,2),_=se(A);qt(_,{name:"github",size:20}),Ri(2),Q(A);var I=be(A,2),E=se(I);qt(E,{name:"alert-triangle",size:20}),Ri(2),Q(I);var M=be(I,2),T=se(M);qt(T,{name:"activity",size:20}),Ri(2),Q(M),Q(p);var D=be(p,4),U=se(D);fn(U,21,()=>n,Nn,(C,N)=>{var B=Az(),P=se(B),F=se(P),q=se(F,!0);Q(F);var Z=be(F,2),W=se(Z,!0);Q(Z),Q(P);var Y=be(P,2),ue=se(Y);Q(Y),Q(B),_e(()=>{fe(B,"href",`?model=${_d??""}/examples/${h(N).filename??""}`),Wt(q,h(N).name),Wt(W,h(N).description),fe(ue,"src",`${_d??""}/examples/screenshots/${h(N).basename??""}-${h(i)?"dark":"light"}.png`),fe(ue,"alt",`${h(N).name??""} preview`)}),yn("error",ue,le=>{le.currentTarget.style.display="none"}),Q3(ue),j(C,B)}),Q(U),Q(D),Q(o),Q(a),_e(C=>{Wt(c,`PathView ${WP} Â· ${C??""}`),fe(f,"src",`${_d??""}/pathview_logo.png`)},[()=>Object.entries(VP).map(([C,N])=>`${C.replace("_","-")} ${N}`).join(" Â· ")]),Si(3,o,()=>po,()=>({start:.95,duration:200,easing:Da})),Si(3,a,()=>dl,()=>({duration:150})),j(t,a),Dt()}Kn(["click","keydown"]);var Pz=Me("<button><!></button>"),Ez=Me('<nav class="breadcrumb glass-panel svelte-terbma"></nav>');function Iz(t,e){Tt(e,!0);let n=Oe(Rn([])),i=Oe(!0);const r=Fe.breadcrumbs.subscribe(u=>{J(n,u,!0),J(i,u.length<=1)});Ei(r);function s(u){Fe.navigateTo(u)}function a(u,f){(u.key==="Enter"||u.key===" ")&&(u.preventDefault(),s(f))}var o=$e(),l=Ue(o);{var c=u=>{var f=Ez();fn(f,21,()=>h(n),Nn,(p,d,y)=>{var m=Pz();let w;m.__click=()=>s(y),m.__keydown=_=>a(_,y);var b=se(m);{var S=_=>{qt(_,{name:"home",size:14})},A=_=>{var I=vb();_e(()=>Wt(I,h(d).name)),j(_,I)};ke(b,_=>{y===0?_(S):_(A,!1)})}Q(m),_e(()=>{w=Xt(m,1,"crumb-pill svelte-terbma",null,w,{current:y===h(n).length-1}),m.disabled=y===h(n).length-1}),j(p,m)}),Q(f),Si(3,f,()=>N1,()=>({y:-10,duration:150})),j(u,f)};ke(l,u=>{h(i)||u(c)})}j(t,o),Dt()}Kn(["click","keydown"]);var Lz=Me('<div class="dialog-backdrop" role="presentation"><div class="confirmation-dialog glass-panel svelte-nz2mwq" role="alertdialog" aria-modal="true" aria-labelledby="confirmation-title" aria-describedby="confirmation-message"><div class="dialog-header"><span id="confirmation-title"> </span> <button class="icon-btn" aria-label="Close"><!></button></div> <div class="dialog-body svelte-nz2mwq"><p id="confirmation-message" class="svelte-nz2mwq"> </p></div> <div class="dialog-actions svelte-nz2mwq"><button class="ghost svelte-nz2mwq"> </button> <button class="svelte-nz2mwq"> </button></div></div></div>');function Mz(t,e){Tt(e,!0);let n=Oe(Rn({open:!1,options:null}));Pd.subscribe(u=>{J(n,{open:u.open,options:u.options},!0)});function i(){Pd.confirm()}function r(){Pd.cancel()}function s(u){u.target===u.currentTarget&&r()}function a(u){h(n).open&&(u.key==="Escape"?r():u.key==="Enter"&&i())}var o=$e();yn("keydown",ii,a);var l=Ue(o);{var c=u=>{var f=Lz();f.__click=s;var p=se(f),d=se(p),y=se(d),m=se(y,!0);Q(y);var w=be(y,2);w.__click=r;var b=se(w);qt(b,{name:"x",size:16}),Q(w),Q(d);var S=be(d,2),A=se(S),_=se(A,!0);Q(A),Q(S);var I=be(S,2),E=se(I);E.__click=r;var M=se(E,!0);Q(E);var T=be(E,2);T.__click=i;var D=se(T,!0);Q(T),Q(I),Q(p),Q(f),_e(()=>{Wt(m,h(n).options.title),Wt(_,h(n).options.message),Wt(M,h(n).options.cancelText),Wt(D,h(n).options.confirmText)}),Si(3,p,()=>po,()=>({start:.95,duration:150,easing:Da})),Si(3,f,()=>dl,()=>({duration:150})),j(u,f)};ke(l,u=>{h(n).open&&h(n).options&&u(c)})}j(t,o),Dt()}Kn(["click"]);var Tz=Me('<link rel="icon" type="image/png"/>'),Dz=Me('<button class="toolbar-btn stop svelte-1uha8ag" aria-label="Stop"><!></button>'),Oz=Me('<span class="loading-status svelte-1uha8ag"> </span> <span class="spinner svelte-1uha8ag"><!></span>',1),Fz=Me('<div><button aria-label="Run"><!></button></div>'),Rz=Me('<button class="toolbar-btn stage-btn active svelte-1uha8ag" aria-label="Stage Changes"><!> <span class="mutation-badge svelte-1uha8ag"> </span></button>'),Bz=Me('<div class="panel-padding svelte-1uha8ag"><!></div>'),zz=Me('<button><!> <span class="header-tab-title svelte-1uha8ag"> </span></button>'),qz=Me('<div class="header-tabs svelte-1uha8ag"></div>'),jz=Me("<span>Results</span> <!>",1),Hz=Me('<button class="icon-btn ghost"><!></button>'),Uz=Me('<!> <button class="icon-btn ghost" aria-label="Plot options"><!></button>',1),Wz=Me("<span>Console</span>"),Vz=Me('<button class="icon-btn ghost" aria-label="Clear console"><!></button>'),Gz=Me('<div class="app svelte-1uha8ag"><button class="logo-overlay svelte-1uha8ag" aria-label="Welcome"><img alt="PathView" class="svelte-1uha8ag"/></button> <div class="canvas-layer svelte-1uha8ag"><!></div> <div class="subsystem-breadcrumb svelte-1uha8ag"><!></div>  <div class="toolbar-container svelte-1uha8ag"><div class="toolbar-group svelte-1uha8ag"><!> <button aria-label="Continue"><!></button> <!></div> <div class="toolbar-group svelte-1uha8ag"><button class="toolbar-btn svelte-1uha8ag" aria-label="New"><!></button> <button class="toolbar-btn svelte-1uha8ag" aria-label="Open/Import"><!></button> <button class="toolbar-btn svelte-1uha8ag" aria-label="Save"><!></button> <button class="toolbar-btn svelte-1uha8ag" aria-label="Save As"><!></button> <button class="toolbar-btn svelte-1uha8ag" aria-label="View Python Code"><!></button></div> <div class="toolbar-group svelte-1uha8ag"><button class="toolbar-btn svelte-1uha8ag" aria-label="Keyboard shortcuts"><!></button></div></div>  <div class="panel-toggles svelte-1uha8ag"><div class="toggle-group svelte-1uha8ag"><button aria-label="Blocks"><!></button> <button aria-label="Events"><!></button> <button aria-label="Editor"><!></button></div> <div class="toggle-group svelte-1uha8ag"><button aria-label="Results"><!></button> <button aria-label="Console"><!></button></div> <div class="toggle-group svelte-1uha8ag"><button aria-label="Simulation"><!></button></div> <div class="toggle-group svelte-1uha8ag"><button aria-label="Pin Previews"><!></button> <button class="toggle-btn svelte-1uha8ag" aria-label="Toggle theme"><!></button></div></div> <!> <!> <!> <!> <!> <!> <!> <!> <!> <!> <!> <!> <!> <!> <!> <!> <!></div>');function iq(t,e){Tt(e,!0);const n=()=>ug(cw,"$pendingMutationCount",s),i=()=>ug(L7,"$currentFileName",s),r=()=>ug(Kh,"$codePreviewStore",s),[s,a]=$3();let o=Oe(Rn({x:0,y:0})),l=Oe(null),c;function u(xe){clearTimeout(c),J(l,xe,!0),c=setTimeout(()=>{J(l,null)},1500)}async function f(){await F7()&&u("save")}async function p(){await ix()&&u("save-as")}let d=Oe(!1),y=Oe(!1),m=Oe(!1),w=Oe(!1),b=Oe(!1),S=Oe(!1),A=Oe(280),_=Oe(280),I=Oe(.5),E=Oe(!1),M=Oe(!1),T=Oe(!1);function D(){if(typeof window>"u")return null;const xe=new URLSearchParams(window.location.search),Ve=xe.get("model"),Ct=xe.get("modelgh");return Ve?{url:Ve,isGitHub:!1}:Ct?{url:Ct,isGitHub:!0}:null}const U=D();let C=Oe(!U),N=Oe(void 0),B=Oe(void 0),P=Oe(320),F=Oe(280),q=Oe(400);const Z=310;let W=Oe(Rn(typeof window<"u"?window.innerWidth:1920)),Y=Oe(Rn(typeof window<"u"?window.innerHeight:1080));function ue(){return typeof window>"u"?800:window.innerWidth-mb-zl*3}const le=ne(()=>h(b)&&h(S)?ue()-Go:void 0);mn(()=>{if(h(b)&&h(S)){if(h(N)===void 0||h(B)===void 0){const xe=ue(),Ve=Math.floor(xe*h(I));J(N,Ve,!0),J(B,xe-Ve)}}else J(N,void 0),J(B,void 0)});function O(xe){if(!h(b)||!h(S))return;const Ve=ue(),Ct=Math.max(Go,Math.min(Ve-Go,xe));J(N,Ct,!0),J(B,Ve-Ct),J(I,Ct/Ve)}function V(xe){if(!h(b)||!h(S))return;const Ve=ue(),Ct=Math.max(Go,Math.min(Ve-Go,xe));J(B,Ct,!0),J(N,Ve-Ct),J(I,(Ve-Ct)/Ve)}function G(){if(J(W,window.innerWidth,!0),J(Y,window.innerHeight,!0),h(b)&&h(S)&&h(N)!==void 0&&h(B)!==void 0){const xe=ue(),Ve=Math.max(Go,Math.min(xe-Go,Math.floor(xe*h(I))));J(N,Ve,!0),J(B,xe-Ve)}}const re=12,ae=5,ee=40,de=50,he=ne(()=>()=>!h(b)&&!h(S)?0:h(b)&&h(S)?h(_)+re:(h(b)?h(A):h(_))+re);function pe(){h(y)?J(y,!1):(J(m,!1),J(y,!0),setTimeout(()=>h(K)?.focus(),50))}function ge(){h(m)?J(m,!1):(J(y,!1),J(m,!0))}function Ee(){h(d)?J(d,!1):(J(w,!1),J(d,!0))}function Ae(){h(w)?J(w,!1):(J(d,!1),J(w,!0),setTimeout(()=>h(Re)?.focus(),50))}const Ye=ne(()=>()=>!h(b)&&!h(S)?0:h(b)&&h(S)?h(A)+re:(h(b)?h(A):h(_))+re);mn(()=>{if(typeof window>"u")return;h(W),h(Y),h(P),h(F),h(q);const xe=h(y)?h(P):h(m)?h(F):0,Ve=mb+zl+(xe>0?xe+zl:0),Ct=h(w)?h(q):h(d)?Z:0,x=(Ct>0?Ct+zl:0)+20;let R=20;h(b)&&h(S)?R=Math.max(h(A),h(_))+zl+20:h(b)?R=h(A)+zl+20:h(S)&&(R=h(_)+zl+20);const te=Z_+20;u8({top:te,right:x,bottom:R,left:Ve})});let K=Oe(void 0),Re=Oe(void 0),Qe=Oe(!1),Be=Oe(!1),Ie=Oe(!1),lt=Oe(!1),We=Oe(!1),Ke=Oe(Rn({x:0,y:0})),ht=Oe(null);const Rt={toggleNodeLibrary:pe,toggleEventsPanel:ge,deleteNodes:qe};function ye(){return qB(h(ht),h(Ke),Rt)}function qe(xe){xe.length!==0&&It.mutate(()=>{for(const Ve of xe)Fe.removeNode(Ve)})}let ve=Oe(0),Pe=Oe(!1),Le=Oe(!1),it=Oe(!1),nt=!1,_t=!1,At=Oe(!1),St=Oe("Ready"),st=Oe("dark"),Ot=Oe(0),dt=Oe(0),bt=Oe("tabs"),ot=Oe(Rn([])),vt=Oe(Rn([]));const jt={text:"Continue",shortcut:"Shift+Enter"};ju(()=>{JP().then(()=>ZP());const xe=dh.subscribe(ft=>{J(E,ft,!0)}),Ve=so.subscribe(ft=>{J(We,ft.open,!0),J(Ke,ft.position,!0),J(ht,ft.target,!0)}),Ct=ol.subscribe(ft=>{J(st,ft,!0)}),x=Fe.nodesArray.subscribe(ft=>{J(ve,ft.length,!0)}),R=Gu.subscribe(ft=>{J(Pe,ft.initialized,!0),J(Le,ft.loading,!0),ft.loading?J(St,ft.progress||"Loading...",!0):ft.error?J(St,`Error: ${ft.error}`):ft.initialized&&J(St,"Ready")}),te=Zi.subscribe(ft=>{J(it,ft.phase==="running"),J(At,ft.result!==null),ft.phase==="running"?J(St,ft.progress||"Simulating...",!0):ft.error?J(St,`Error: ${ft.error}`):h(Pe)&&J(St,"Ready");const zt=[],sn=[];ft.result?.scopeData&&Object.entries(ft.result.scopeData).forEach(([tn,In],Sn)=>{const zn=ft.result?.nodeNames?.[tn]||`Scope ${Sn+1}`;zt.push({id:tn,type:"scope",title:zn});for(let pn=0;pn<In.signals.length;pn++)sn.push({nodeId:tn,nodeType:"scope",nodeName:zn,signalIndex:pn,signalLabel:In.labels?.[pn]||`port ${pn}`})}),ft.result?.spectrumData&&Object.entries(ft.result.spectrumData).forEach(([tn,In],Sn)=>{const zn=ft.result?.nodeNames?.[tn]||`Spectrum ${Sn+1}`;zt.push({id:tn,type:"spectrum",title:zn});for(let pn=0;pn<In.magnitude.length;pn++)sn.push({nodeId:tn,nodeType:"spectrum",nodeName:zn,signalIndex:pn,signalLabel:In.labels?.[pn]||`port ${pn}`})}),J(ot,zt,!0),J(vt,sn,!0),h(dt)>=zt.length&&zt.length>0&&J(dt,0)}),me=ri.subscribe(ft=>{J(Ot,ft.length,!0)});nx();const Ne=z7(3e4),ze=Fe.nodesArray.subscribe(()=>{N2()}),Ge=Fe.connections.subscribe(()=>{N2()}),mt=()=>Gt(),yt=()=>{h(At)&&h(Pe)&&!h(it)&&!_t&&oi()};return window.addEventListener("run-simulation",mt),window.addEventListener("continue-simulation",yt),Bt(),()=>{xe(),Ve(),Ct(),x(),R(),te(),me(),Ne(),ze(),Ge(),window.removeEventListener("run-simulation",mt),window.removeEventListener("continue-simulation",yt)}});function kt(xe){const Ve=V5(xe);if(xe.shiftKey&&xe.key==="Enter"){xe.preventDefault(),h(At)&&h(Pe)&&!h(it)&&!_t&&oi();return}if(xe.metaKey||xe.ctrlKey)switch(xe.key.toLowerCase()){case"s":xe.preventDefault(),xe.shiftKey?p():f();return;case"o":xe.preventDefault(),Cn();return;case"e":xe.preventDefault(),J(Qe,!0);return;case"f":xe.preventDefault(),J(Ie,!0);return;case"d":xe.preventDefault(),It.mutate(()=>Fe.duplicateSelected());return;case"c":Ve||(xe.preventDefault(),fo.copy());return;case"x":Ve||(xe.preventDefault(),fo.cut());return;case"v":if(!Ve){xe.preventDefault();const Ct=uo(h(o));fo.paste(Ct)}return;case"a":Ve||(xe.preventDefault(),Fe.selectAll());return;case"z":xe.preventDefault(),xe.shiftKey?It.redo():It.undo();return;case"y":xe.preventDefault(),It.redo();return;case"enter":xe.preventDefault(),Gt();return}if(!Ve)switch(xe.key){case"Escape":h(We)?so.close():h(Qe)?J(Qe,!1):h(Be)?J(Be,!1):Kv()?Ad():h(it)?r2():h(S)?J(S,!1):h(b)?J(b,!1):h(w)?J(w,!1):h(y)?J(y,!1):h(m)?J(m,!1):h(d)&&J(d,!1);return;case"f":xe.preventDefault(),sl();return;case"s":xe.preventDefault(),Ee();return;case"e":xe.preventDefault(),Ae();return;case"v":xe.preventDefault(),J(b,!h(b));return;case"c":xe.preventDefault(),J(S,!h(S));return;case"p":xe.preventDefault(),dh.toggle();return;case"l":xe.preventDefault(),r0.toggle();return;case"b":xe.preventDefault(),pe();return;case"n":xe.preventDefault(),ge();return;case"h":xe.preventDefault(),Fe.isAtRoot()||Fe.navigateTo(0);return;case"t":xe.preventDefault(),ol.toggle();return;case"+":case"=":!xe.ctrlKey&&!xe.metaKey&&(xe.preventDefault(),d8());return;case"-":!xe.ctrlKey&&!xe.metaKey&&(xe.preventDefault(),f8());return;case"?":xe.preventDefault(),J(Be,!h(Be));return;case"ArrowUp":case"ArrowDown":case"ArrowLeft":case"ArrowRight":xe.preventDefault(),gt(xe.key,xe.shiftKey);return}}function gt(xe,Ve){const Ct=Kv(),x=Ve?Fn*5:Fn*2,R=Ve?Fn*2:Fn,te={x:0,y:0};switch(xe){case"ArrowUp":te.y=Ct?-R:x;break;case"ArrowDown":te.y=Ct?R:-x;break;case"ArrowLeft":te.x=Ct?-R:x;break;case"ArrowRight":te.x=Ct?R:-x;break}Ct?g8(te):h8(te)}async function Gt(){if(!(h(it)||nt||h(Le))){if(nt=!0,!h(Pe))try{await Cw()}catch(xe){console.error("Failed to initialize Pyodide:",xe),nt=!1;return}try{const{nodes:xe,connections:Ve}=Fe.toJSON();if(xe.length===0){J(St,"Add nodes first");return}h(T)||(J(S,!0),J(T,!0));const Ct=Os.getCode();try{J(St,"Validating...");const x=await yM(xe,Ct);if(!x.valid){J(S,!0),ri.error("Validation failed:");for(const R of x.errors)if(R.nodeId==="__code_context__")ri.error(`  Code context: ${R.error}`);else{const me=xe.find(Ne=>Ne.id===R.nodeId)?.name||R.nodeId;ri.error(`  ${me}.${R.param}: ${R.error}`)}J(St,"Validation failed");return}}catch(x){J(S,!0),ri.error(`Validation error: ${x}`),J(St,"Validation error");return}try{const x=vn.toJSON();await gM(xe,Ve,is.get(),Ct,x),h(M)||(J(b,!0),J(M,!0))}catch(x){J(S,!0),console.error("Simulation failed:",x)}}finally{nt=!1}}}async function oi(){if(!(!h(Pe)||!h(At)||h(it)||_t)){_t=!0;try{const xe=is.get().duration,Ve=xe?.trim()?String(xe):String(Xo.duration);await dE(Ve)}catch(xe){J(S,!0),console.error("Continue simulation failed:",xe)}finally{_t=!1}}}async function bn(){h(ve)>0&&!await Pd.show({title:"Unsaved Changes",message:"Creating a new file will discard your current work. Continue?",confirmText:"Discard & Create New",cancelText:"Cancel"})||(B7(),window.location.search&&window.history.replaceState({},"",window.location.pathname))}async function Cn(){const xe=await ax();xe.success&&xe.type==="model"&&setTimeout(()=>sl(),100)}function li(xe){const Ve=xe.split("/");if(Ve.length<3)throw new Error("Invalid GitHub shorthand. Use: owner/repo/path/to/file.pvm");const Ct=Ve[0],x=Ve[1],R=Ve.slice(2),te="main",me=R.join("/");return`https://raw.githubusercontent.com/${Ct}/${x}/${te}/${me}`}async function Bt(){if(!U)return;let xe;try{xe=U.isGitHub?li(U.url):U.url}catch{ri.error(`Invalid GitHub shorthand: ${U.url}`),ri.error("Expected format: owner/repo/path/to/file.pvm"),J(S,!0);return}const Ve=await U7(xe);Ve.success?setTimeout(()=>sl(),100):Ve.error&&(ri.error(`Failed to load model from URL: ${xe}`),ri.error(Ve.error),J(S,!0))}let Jn=0,qn=0;function Pn(xe){let Ve=w8();const Ct=Date.now();Ct-qn>2e3&&(Jn=0);const x=Jn%ae*ee,R=Math.floor(Jn/ae)*de;Ve={x:Ve.x+x-ee*2,y:Ve.y+R-de},Jn++,qn=Ct;const te=It.mutate(()=>Fe.addNode(xe,Ve));te&&v8(te.id,Ve,h(o))}var jn=Gz();yn("keydown",ii,kt),yn("resize",ii,G),yn("mousemove",ii,xe=>J(o,{x:xe.clientX,y:xe.clientY},!0)),rp("1uha8ag",xe=>{var Ve=Tz();_e(()=>fe(Ve,"href",`${_d??""}/favicon.png`)),Hu(()=>{V3.title="PathView"}),j(xe,Ve)});var wn=se(jn);wn.__click=()=>J(C,!0);var je=se(wn);Q(wn),wt(wn,(xe,Ve)=>$t?.(xe,Ve),()=>"Welcome");var tt=be(wn,2),Ft=se(tt);rM(Ft,{}),Q(tt);var nn=be(tt,2),Yt=se(nn);Iz(Yt,{}),Q(nn);var Vt=be(nn,2);Vt.__mousedown=()=>Ad();var Lt=se(Vt),Qt=se(Lt);{var rn=xe=>{var Ve=Dz();Ve.__click=function(...x){r2?.apply(this,x)};var Ct=se(Ve);qt(Ct,{name:"stop-filled",size:16}),Q(Ve),wt(Ve,(x,R)=>$t?.(x,R),()=>({text:"Stop",shortcut:"Esc"})),j(xe,Ve)},Mn=xe=>{var Ve=Fz();let Ct;var x=se(Ve);let R;x.__click=Gt;var te=se(x);{var me=ze=>{var Ge=Oz(),mt=Ue(Ge),yt=se(mt,!0);Q(mt);var ft=be(mt,2),zt=se(ft);qt(zt,{name:"loader",size:16}),Q(ft),_e(()=>Wt(yt,h(St))),j(ze,Ge)},Ne=ze=>{qt(ze,{name:"play-filled",size:16})};ke(te,ze=>{h(Le)?ze(me):ze(Ne,!1)})}Q(x),wt(x,(ze,Ge)=>$t?.(ze,Ge),()=>({text:h(Pe)?"Run":"Initialize & Run",shortcut:"Ctrl+Enter"})),Q(Ve),_e(()=>{Ct=Xt(Ve,1,"run-btn-wrapper svelte-1uha8ag",null,Ct,{loading:h(Le)}),R=Xt(x,1,"toolbar-btn run-btn svelte-1uha8ag",null,R,{active:!h(Le),loading:h(Le)}),x.disabled=h(Le)}),j(xe,Ve)};ke(Qt,xe=>{h(it)?xe(rn):xe(Mn,!1)})}var Zt=be(Qt,2);let Qn;Zt.__click=oi;var En=se(Zt);qt(En,{name:"skip-forward-filled",size:16}),Q(Zt),wt(Zt,(xe,Ve)=>$t?.(xe,Ve),()=>jt);var Wn=be(Zt,2);{var Bs=xe=>{var Ve=Rz();Ve.__click=()=>fE();var Ct=se(Ve);qt(Ct,{name:"stage",size:16});var x=be(Ct,2),R=se(x,!0);Q(x),Q(Ve),wt(Ve,(te,me)=>$t?.(te,me),()=>"Stage Changes"),_e(()=>Wt(R,n())),j(xe,Ve)};ke(Wn,xe=>{h(At)&&n()>0&&xe(Bs)})}Q(Lt);var vo=be(Lt,2),or=se(vo);or.__click=bn;var bs=se(or);qt(bs,{name:"new-canvas",size:16}),Q(or),wt(or,(xe,Ve)=>$t?.(xe,Ve),()=>"New");var zs=be(or,2);zs.__click=Cn;var Pr=se(zs);qt(Pr,{name:"download",size:16}),Q(zs),wt(zs,(xe,Ve)=>$t?.(xe,Ve),()=>({text:"Open/Import",shortcut:"Ctrl+O"}));var ws=be(zs,2);ws.__click=()=>f();var xs=se(ws);{let xe=ne(()=>h(l)==="save"?"check":"upload");qt(xs,{get name(){return h(xe)},size:16})}Q(ws),wt(ws,(xe,Ve)=>$t?.(xe,Ve),()=>({text:i()?`Save '${i()}'`:"Save",shortcut:"Ctrl+S"}));var lr=be(ws,2);lr.__click=()=>p();var pl=se(lr);{let xe=ne(()=>h(l)==="save-as"?"check":"upload-plus");qt(pl,{get name(){return h(xe)},size:16})}Q(lr),wt(lr,(xe,Ve)=>$t?.(xe,Ve),()=>({text:"Save As",shortcut:"Ctrl+Shift+S"}));var ua=be(lr,2);ua.__click=()=>J(Qe,!0);var gl=se(ua);qt(gl,{name:"braces",size:16}),Q(ua),wt(ua,(xe,Ve)=>$t?.(xe,Ve),()=>({text:"Python Code",shortcut:"Ctrl+E"})),Q(vo);var Hi=be(vo,2),cr=se(Hi);cr.__click=()=>J(Be,!0);var nc=se(cr);qt(nc,{name:"keyboard",size:16}),Q(cr),wt(cr,(xe,Ve)=>$t?.(xe,Ve),()=>({text:"Shortcuts",shortcut:"?"})),Q(Hi),Q(Vt);var $n=be(Vt,2);$n.__mousedown=()=>Ad();var Ba=se($n),fi=se(Ba);let Er;fi.__click=pe;var ml=se(fi);qt(ml,{name:"grid",size:18}),Q(fi),wt(fi,(xe,Ve)=>$t?.(xe,Ve),()=>({text:"Blocks",shortcut:"B",position:"right"}));var Ii=be(fi,2);let hi;Ii.__click=ge;var ur=se(Ii);qt(ur,{name:"zap",size:18}),Q(Ii),wt(Ii,(xe,Ve)=>$t?.(xe,Ve),()=>({text:"Events",shortcut:"N",position:"right"}));var yr=be(Ii,2);let vl;yr.__click=Ae;var ic=se(yr);qt(ic,{name:"code",size:18}),Q(yr),wt(yr,(xe,Ve)=>$t?.(xe,Ve),()=>({text:"Editor",shortcut:"E",position:"right"})),Q(Ba);var Ir=be(Ba,2),dr=se(Ir);let rs;dr.__click=()=>J(b,!h(b));var za=se(dr);qt(za,{name:"bar-chart",size:18}),Q(dr),wt(dr,(xe,Ve)=>$t?.(xe,Ve),()=>({text:"Results",shortcut:"V",position:"right"}));var qr=be(dr,2);let yl;qr.__click=()=>J(S,!h(S));var qs=se(qr);qt(qs,{name:"terminal",size:18}),Q(qr),wt(qr,(xe,Ve)=>$t?.(xe,Ve),()=>({text:"Console",shortcut:"C",position:"right"})),Q(Ir);var ss=be(Ir,2),_s=se(ss);let yo;_s.__click=Ee;var jr=se(_s);qt(jr,{name:"settings",size:18}),Q(_s),wt(_s,(xe,Ve)=>$t?.(xe,Ve),()=>({text:"Simulation",shortcut:"S",position:"right"})),Q(ss);var Ss=be(ss,2),Li=se(Ss);let qa;Li.__click=()=>dh.toggle();var rc=se(Li);{let xe=ne(()=>h(E)?"pin-filled":"pin");qt(rc,{get name(){return h(xe)},size:18})}Q(Li),wt(Li,(xe,Ve)=>$t?.(xe,Ve),()=>({text:"Pin Previews",shortcut:"P",position:"right"}));var Jt=be(Li,2);Jt.__click=()=>ol.toggle();var js=se(Jt);{let xe=ne(()=>h(st)==="dark"?"sun":"moon");qt(js,{get name(){return h(xe)},size:18})}Q(Jt),wt(Jt,(xe,Ve)=>$t?.(xe,Ve),()=>({text:h(st)==="dark"?"Light mode":"Dark mode",shortcut:"T",position:"right"})),Q(Ss),Q($n);var ks=be($n,2);{var sc=xe=>{{let Ve=ne(()=>h(Ye)());au(xe,{position:"right",title:"Simulation",initialWidth:310,minWidth:310,maxWidth:310,get bottomOffset(){return h(Ve)},onClose:()=>J(d,!1),children:(Ct,x)=>{var R=Bz(),te=se(R);dM(te,{}),Q(R),j(Ct,R)},$$slots:{default:!0}})}};ke(ks,xe=>{h(d)&&xe(sc)})}var as=be(ks,2);{var As=xe=>{{let Ve=ne(()=>h(he)());au(xe,{position:"left",get width(){return h(P)},minWidth:280,maxWidth:500,get bottomOffset(){return h(Ve)},title:"Blocks",onClose:()=>J(y,!1),onWidthChange:Ct=>J(P,Math.min(500,Math.max(280,Ct)),!0),children:(Ct,x)=>{ji(qT(Ct,{onAddNode:Pn,focusSearch:!0}),R=>J(K,R,!0),()=>h(K))},$$slots:{default:!0}})}};ke(as,xe=>{h(y)&&xe(As)})}var Ns=be(as,2);{var Hs=xe=>{{let Ve=ne(()=>h(he)());au(xe,{position:"left",get width(){return h(F)},minWidth:200,maxWidth:400,get bottomOffset(){return h(Ve)},title:"Events",onClose:()=>J(m,!1),onWidthChange:Ct=>J(F,Math.min(400,Math.max(200,Ct)),!0),children:(Ct,x)=>{VT(Ct,{})},$$slots:{default:!0}})}};ke(Ns,xe=>{h(m)&&xe(Hs)})}var da=be(Ns,2);{var bo=xe=>{{let Ve=ne(()=>h(Ye)());au(xe,{position:"right",get width(){return h(q)},minWidth:300,maxWidth:700,get bottomOffset(){return h(Ve)},title:"Editor",onClose:()=>J(w,!1),onWidthChange:Ct=>J(q,Math.min(700,Math.max(300,Ct)),!0),children:(Ct,x)=>{ji(LT(Ct,{}),R=>J(Re,R,!0),()=>h(Re))},$$slots:{default:!0}})}};ke(da,xe=>{h(w)&&xe(bo)})}var Us=be(da,2);{var Ws=xe=>{{const Ve=R=>{var te=jz(),me=be(Ue(te),2);{var Ne=ze=>{var Ge=qz();fn(Ge,21,()=>h(ot),Nn,(mt,yt,ft)=>{var zt=zz();let sn;zt.__click=()=>J(dt,ft,!0);var tn=se(zt);{var In=Tn=>{qt(Tn,{name:"activity",size:12})},Sn=Tn=>{qt(Tn,{name:"bar-chart-2",size:12})};ke(tn,Tn=>{h(yt).type==="scope"?Tn(In):Tn(Sn,!1)})}var zn=be(tn,2),pn=se(zn,!0);Q(zn),Q(zt),_e(()=>{sn=Xt(zt,1,"header-tab svelte-1uha8ag",null,sn,{active:h(dt)===ft}),fe(zt,"title",h(yt).title),Wt(pn,h(yt).title)}),j(mt,zt)}),Q(Ge),j(ze,Ge)};ke(me,ze=>{h(ot).length>0&&h(bt)==="tabs"&&ze(Ne)})}j(R,te)},Ct=R=>{var te=Uz(),me=Ue(te);{var Ne=mt=>{var yt=Hz();yt.__click=()=>J(bt,h(bt)==="tabs"?"tiles":"tabs",!0);var ft=se(yt);{var zt=tn=>{qt(tn,{name:"grid",size:16})},sn=tn=>{qt(tn,{name:"square",size:16})};ke(ft,tn=>{h(bt)==="tabs"?tn(zt):tn(sn,!1)})}Q(yt),wt(yt,(tn,In)=>$t?.(tn,In),()=>({text:h(bt)==="tabs"?"Show all plots":"Show single plot",position:"bottom"})),_e(()=>fe(yt,"aria-label",h(bt)==="tabs"?"Show all plots":"Show single plot")),j(mt,yt)};ke(me,mt=>{h(ot).length>1&&mt(Ne)})}var ze=be(me,2);ze.__click=()=>J(lt,!0);var Ge=se(ze);qt(Ge,{name:"settings",size:16}),Q(ze),wt(ze,(mt,yt)=>$t?.(mt,yt),()=>({text:"Plot options",position:"bottom"})),j(R,te)};let x=ne(()=>h(S)?"bottom-right":"bottom");au(xe,{get position(){return h(x)},initialHeight:280,minHeight:150,get minWidth(){return Go},get maxWidth(){return h(le)},get width(){return h(B)},onWidthChange:V,onClose:()=>J(b,!1),get currentHeight(){return h(A)},set currentHeight(R){J(A,R,!0)},header:Ve,actions:Ct,children:(R,te)=>{_T(R,{collapsed:!1,get viewMode(){return h(bt)},get activeTab(){return h(dt)},set activeTab(me){J(dt,me,!0)}})},$$slots:{header:!0,actions:!0,default:!0}})}};ke(Us,xe=>{h(b)&&xe(Ws)})}var Qi=be(Us,2);{var ac=xe=>{{const Ve=R=>{var te=Wz();j(R,te)},Ct=R=>{var te=Vz();te.__click=()=>ri.clear();var me=se(te);qt(me,{name:"trash",size:16}),Q(te),wt(te,(Ne,ze)=>$t?.(Ne,ze),()=>({text:"Clear console",position:"bottom"})),j(R,te)};let x=ne(()=>h(b)?"bottom-left":"bottom");au(xe,{get position(){return h(x)},initialHeight:280,minHeight:150,get minWidth(){return Go},get maxWidth(){return h(le)},get width(){return h(N)},onWidthChange:O,onClose:()=>J(S,!1),get currentHeight(){return h(_)},set currentHeight(R){J(_,R,!0)},header:Ve,actions:Ct,children:(R,te)=>{CT(R,{})},$$slots:{header:!0,actions:!0,default:!0}})}};ke(Qi,xe=>{h(S)&&xe(ac)})}var ja=be(Qi,2);{var wo=xe=>{{let Ve=ne(ye);JT(xe,{get x(){return h(Ke).x},get y(){return h(Ke).y},get items(){return h(Ve)},onClose:()=>so.close()})}};ke(ja,xe=>{h(We)&&xe(wo)})}var os=be(ja,2);UB(os,{get open(){return h(Qe)},onClose:()=>J(Qe,!1)});var $i=be(os,2);KB($i,{get open(){return h(Be)},onClose:()=>J(Be,!1)});var Ha=be($i,2);mz(Ha,{get open(){return h(Ie)},onClose:()=>J(Ie,!1)});var fa=be(Ha,2);uz(fa,{get open(){return h(lt)},onClose:()=>J(lt,!1),get traces(){return h(vt)}});var Ua=be(fa,2);nT(Ua,{});var br=be(Ua,2);dT(br,{});var Hr=be(br,2);{let xe=ne(()=>r()!==null),Ve=ne(()=>r()?.code??""),Ct=ne(()=>r()?.title??"");w0(Hr,{get open(){return h(xe)},get code(){return h(Ve)},get title(){return h(Ct)},onClose:()=>Kh.close()})}var xo=be(Hr,2);BP(xo,{});var _o=be(xo,2);Mz(_o,{});var Cs=be(_o,2);{var fr=xe=>{Cz(xe,{onNew:bn,onClose:()=>J(C,!1)})};ke(Cs,xe=>{h(C)&&xe(fr)})}Q(jn),_e(()=>{fe(je,"src",`${_d??""}/pathview_logo.png`),Qn=Xt(Zt,1,"toolbar-btn svelte-1uha8ag",null,Qn,{active:h(At)&&h(Pe)&&!h(it)}),Zt.disabled=!h(At)||!h(Pe)||h(it),Er=Xt(fi,1,"toggle-btn svelte-1uha8ag",null,Er,{active:h(y)}),hi=Xt(Ii,1,"toggle-btn svelte-1uha8ag",null,hi,{active:h(m)}),vl=Xt(yr,1,"toggle-btn svelte-1uha8ag",null,vl,{active:h(w)}),rs=Xt(dr,1,"toggle-btn svelte-1uha8ag",null,rs,{active:h(b)}),yl=Xt(qr,1,"toggle-btn svelte-1uha8ag",null,yl,{active:h(S)}),yo=Xt(_s,1,"toggle-btn svelte-1uha8ag",null,yo,{active:h(d)}),qa=Xt(Li,1,"toggle-btn svelte-1uha8ag",null,qa,{active:h(E)})}),Si(3,Vt,()=>N1,()=>({y:-20,duration:200})),j(t,jn),Dt(),a()}Kn(["click","mousedown"]);export{Un as _,iq as a,nq as c,C0 as g};
