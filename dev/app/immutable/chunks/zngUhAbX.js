import{E as b,D as un,V as lt,c as _,a as k,d as we,e as p,r as dn,h as mn,W as pn,f as gn,i as yn,j as st,m as ct,n as xn,o as kn,p as Sn,q as bn,k as at}from"./BaLj8HaF.js";import{StateField as de,Facet as Z,EditorSelection as u,countColumn as Pe,Text as ht,Annotation as ft,Transaction as ke,combineConfig as me,findClusterBreak as W,StateEffect as R,ChangeSet as An,ChangeDesc as Cn,Prec as Mn,codePointAt as Ln,fromCodePoint as vn,codePointSize as Dn,CharCategory as v,EditorState as ut,RangeSetBuilder as dt}from"./BJrbMhgq.js";import{IndentContext as mt,getIndentation as pt,indentString as le,syntaxTree as Ie,matchBrackets as V,getIndentUnit as Ce,indentUnit as Bn,foldGutter as Rn,indentOnInput as En,syntaxHighlighting as gt,bracketMatching as wn,foldKeymap as Pn,defaultHighlightStyle as yt}from"./bH9uCY5d.js";import{N as Me}from"./DSDy7V6L.js";import{a as In,b as Tn,d as On,e as Fn}from"./D6bpRoeh.js";const Wn=t=>{let{state:e}=t,r=e.doc.lineAt(e.selection.main.from),n=Oe(t.state,r.from);return n.line?qn(t):n.block?Vn(t):!1};function Te(t,e){return({state:r,dispatch:n})=>{if(r.readOnly)return!1;let o=t(e,r);return o?(n(r.update(o)),!0):!1}}const qn=Te(zn,0),Nn=Te(xt,0),Vn=Te((t,e)=>xt(t,e,Un(e)),0);function Oe(t,e){let r=t.languageDataAt("commentTokens",e,1);return r.length?r[0]:{}}const J=50;function $n(t,{open:e,close:r},n,o){let i=t.sliceDoc(n-J,n),l=t.sliceDoc(o,o+J),s=/\s*$/.exec(i)[0].length,c=/^\s*/.exec(l)[0].length,a=i.length-s;if(i.slice(a-e.length,a)==e&&l.slice(c,c+r.length)==r)return{open:{pos:n-s,margin:s&&1},close:{pos:o+c,margin:c&&1}};let h,f;o-n<=2*J?h=f=t.sliceDoc(n,o):(h=t.sliceDoc(n,n+J),f=t.sliceDoc(o-J,o));let d=/^\s*/.exec(h)[0].length,m=/\s*$/.exec(f)[0].length,g=f.length-m-r.length;return h.slice(d,d+e.length)==e&&f.slice(g,g+r.length)==r?{open:{pos:n+d+e.length,margin:/\s/.test(h.charAt(d+e.length))?1:0},close:{pos:o-m-r.length,margin:/\s/.test(f.charAt(g-1))?1:0}}:null}function Un(t){let e=[];for(let r of t.selection.ranges){let n=t.doc.lineAt(r.from),o=r.to<=n.to?n:t.doc.lineAt(r.to);o.from>n.from&&o.from==r.to&&(o=r.to==n.to+1?n:t.doc.lineAt(r.to-1));let i=e.length-1;i>=0&&e[i].to>n.from?e[i].to=o.to:e.push({from:n.from+/^\s*/.exec(n.text)[0].length,to:o.to})}return e}function xt(t,e,r=e.selection.ranges){let n=r.map(i=>Oe(e,i.from).block);if(!n.every(i=>i))return null;let o=r.map((i,l)=>$n(e,n[l],i.from,i.to));if(t!=2&&!o.every(i=>i))return{changes:e.changes(r.map((i,l)=>o[l]?[]:[{from:i.from,insert:n[l].open+" "},{from:i.to,insert:" "+n[l].close}]))};if(t!=1&&o.some(i=>i)){let i=[];for(let l=0,s;l<o.length;l++)if(s=o[l]){let c=n[l],{open:a,close:h}=s;i.push({from:a.pos-c.open.length,to:a.pos+a.margin},{from:h.pos-h.margin,to:h.pos+c.close.length})}return{changes:i}}return null}function zn(t,e,r=e.selection.ranges){let n=[],o=-1;for(let{from:i,to:l}of r){let s=n.length,c=1e9,a=Oe(e,i).line;if(a){for(let h=i;h<=l;){let f=e.doc.lineAt(h);if(f.from>o&&(i==l||l>f.from)){o=f.from;let d=/^\s*/.exec(f.text)[0].length,m=d==f.length,g=f.text.slice(d,d+a.length)==a?d:-1;d<f.text.length&&d<c&&(c=d),n.push({line:f,comment:g,token:a,indent:d,empty:m,single:!1})}h=f.to+1}if(c<1e9)for(let h=s;h<n.length;h++)n[h].indent<n[h].line.text.length&&(n[h].indent=c);n.length==s+1&&(n[s].single=!0)}}if(t!=2&&n.some(i=>i.comment<0&&(!i.empty||i.single))){let i=[];for(let{line:s,token:c,indent:a,empty:h,single:f}of n)(f||!h)&&i.push({from:s.from+a,insert:c+" "});let l=e.changes(i);return{changes:l,selection:e.selection.map(l,1)}}else if(t!=1&&n.some(i=>i.comment>=0)){let i=[];for(let{line:l,comment:s,token:c}of n)if(s>=0){let a=l.from+s,h=a+c.length;l.text[h-l.from]==" "&&h++,i.push({from:a,to:h})}return{changes:i}}return null}const Le=ft.define(),Gn=ft.define(),Hn=Z.define(),kt=Z.define({combine(t){return me(t,{minDepth:100,newGroupDelay:500,joinToEvent:(e,r)=>r},{minDepth:Math.max,newGroupDelay:Math.min,joinToEvent:(e,r)=>(n,o)=>e(n,o)||r(n,o)})}}),St=de.define({create(){return I.empty},update(t,e){let r=e.state.facet(kt),n=e.annotation(Le);if(n){let c=C.fromTransaction(e,n.selection),a=n.side,h=a==0?t.undone:t.done;return c?h=se(h,h.length,r.minDepth,c):h=Mt(h,e.startState.selection),new I(a==0?n.rest:h,a==0?h:n.rest)}let o=e.annotation(Gn);if((o=="full"||o=="before")&&(t=t.isolate()),e.annotation(ke.addToHistory)===!1)return e.changes.empty?t:t.addMapping(e.changes.desc);let i=C.fromTransaction(e),l=e.annotation(ke.time),s=e.annotation(ke.userEvent);return i?t=t.addChanges(i,l,s,r,e):e.selection&&(t=t.addSelection(e.startState.selection,l,s,r.newGroupDelay)),(o=="full"||o=="after")&&(t=t.isolate()),t},toJSON(t){return{done:t.done.map(e=>e.toJSON()),undone:t.undone.map(e=>e.toJSON())}},fromJSON(t){return new I(t.done.map(C.fromJSON),t.undone.map(C.fromJSON))}});function bt(t={}){return[St,kt.of(t),b.domEventHandlers({beforeinput(e,r){let n=e.inputType=="historyUndo"?At:e.inputType=="historyRedo"?ve:null;return n?(e.preventDefault(),n(r)):!1}})]}function pe(t,e){return function({state:r,dispatch:n}){if(!e&&r.readOnly)return!1;let o=r.field(St,!1);if(!o)return!1;let i=o.pop(t,r,e);return i?(n(i),!0):!1}}const At=pe(0,!1),ve=pe(1,!1),Jn=pe(0,!0),Kn=pe(1,!0);class C{constructor(e,r,n,o,i){this.changes=e,this.effects=r,this.mapped=n,this.startSelection=o,this.selectionsAfter=i}setSelAfter(e){return new C(this.changes,this.effects,this.mapped,this.startSelection,e)}toJSON(){var e,r,n;return{changes:(e=this.changes)===null||e===void 0?void 0:e.toJSON(),mapped:(r=this.mapped)===null||r===void 0?void 0:r.toJSON(),startSelection:(n=this.startSelection)===null||n===void 0?void 0:n.toJSON(),selectionsAfter:this.selectionsAfter.map(o=>o.toJSON())}}static fromJSON(e){return new C(e.changes&&An.fromJSON(e.changes),[],e.mapped&&Cn.fromJSON(e.mapped),e.startSelection&&u.fromJSON(e.startSelection),e.selectionsAfter.map(u.fromJSON))}static fromTransaction(e,r){let n=D;for(let o of e.startState.facet(Hn)){let i=o(e);i.length&&(n=n.concat(i))}return!n.length&&e.changes.empty?null:new C(e.changes.invert(e.startState.doc),n,void 0,r||e.startState.selection,D)}static selection(e){return new C(void 0,D,void 0,void 0,e)}}function se(t,e,r,n){let o=e+1>r+20?e-r-1:0,i=t.slice(o,e);return i.push(n),i}function _n(t,e){let r=[],n=!1;return t.iterChangedRanges((o,i)=>r.push(o,i)),e.iterChangedRanges((o,i,l,s)=>{for(let c=0;c<r.length;){let a=r[c++],h=r[c++];s>=a&&l<=h&&(n=!0)}}),n}function Qn(t,e){return t.ranges.length==e.ranges.length&&t.ranges.filter((r,n)=>r.empty!=e.ranges[n].empty).length===0}function Ct(t,e){return t.length?e.length?t.concat(e):t:e}const D=[],Yn=200;function Mt(t,e){if(t.length){let r=t[t.length-1],n=r.selectionsAfter.slice(Math.max(0,r.selectionsAfter.length-Yn));return n.length&&n[n.length-1].eq(e)?t:(n.push(e),se(t,t.length-1,1e9,r.setSelAfter(n)))}else return[C.selection([e])]}function jn(t){let e=t[t.length-1],r=t.slice();return r[t.length-1]=e.setSelAfter(e.selectionsAfter.slice(0,e.selectionsAfter.length-1)),r}function Se(t,e){if(!t.length)return t;let r=t.length,n=D;for(;r;){let o=Zn(t[r-1],e,n);if(o.changes&&!o.changes.empty||o.effects.length){let i=t.slice(0,r);return i[r-1]=o,i}else e=o.mapped,r--,n=o.selectionsAfter}return n.length?[C.selection(n)]:D}function Zn(t,e,r){let n=Ct(t.selectionsAfter.length?t.selectionsAfter.map(s=>s.map(e)):D,r);if(!t.changes)return C.selection(n);let o=t.changes.map(e),i=e.mapDesc(t.changes,!0),l=t.mapped?t.mapped.composeDesc(i):i;return new C(o,R.mapEffects(t.effects,e),l,t.startSelection.map(i),n)}const Xn=/^(input\.type|delete)($|\.)/;class I{constructor(e,r,n=0,o=void 0){this.done=e,this.undone=r,this.prevTime=n,this.prevUserEvent=o}isolate(){return this.prevTime?new I(this.done,this.undone):this}addChanges(e,r,n,o,i){let l=this.done,s=l[l.length-1];return s&&s.changes&&!s.changes.empty&&e.changes&&(!n||Xn.test(n))&&(!s.selectionsAfter.length&&r-this.prevTime<o.newGroupDelay&&o.joinToEvent(i,_n(s.changes,e.changes))||n=="input.type.compose")?l=se(l,l.length-1,o.minDepth,new C(e.changes.compose(s.changes),Ct(R.mapEffects(e.effects,s.changes),s.effects),s.mapped,s.startSelection,D)):l=se(l,l.length,o.minDepth,e),new I(l,D,r,n)}addSelection(e,r,n,o){let i=this.done.length?this.done[this.done.length-1].selectionsAfter:D;return i.length>0&&r-this.prevTime<o&&n==this.prevUserEvent&&n&&/^select($|\.)/.test(n)&&Qn(i[i.length-1],e)?this:new I(Mt(this.done,e),this.undone,r,n)}addMapping(e){return new I(Se(this.done,e),Se(this.undone,e),this.prevTime,this.prevUserEvent)}pop(e,r,n){let o=e==0?this.done:this.undone;if(o.length==0)return null;let i=o[o.length-1],l=i.selectionsAfter[0]||r.selection;if(n&&i.selectionsAfter.length)return r.update({selection:i.selectionsAfter[i.selectionsAfter.length-1],annotations:Le.of({side:e,rest:jn(o),selection:l}),userEvent:e==0?"select.undo":"select.redo",scrollIntoView:!0});if(i.changes){let s=o.length==1?D:o.slice(0,o.length-1);return i.mapped&&(s=Se(s,i.mapped)),r.update({changes:i.changes,selection:i.startSelection,effects:i.effects,annotations:Le.of({side:e,rest:s,selection:l}),filter:!1,userEvent:e==0?"undo":"redo",scrollIntoView:!0})}else return null}}I.empty=new I(D,D);const Lt=[{key:"Mod-z",run:At,preventDefault:!0},{key:"Mod-y",mac:"Mod-Shift-z",run:ve,preventDefault:!0},{linux:"Ctrl-Shift-z",run:ve,preventDefault:!0},{key:"Mod-u",run:Jn,preventDefault:!0},{key:"Alt-u",mac:"Mod-Shift-u",run:Kn,preventDefault:!0}];function G(t,e){return u.create(t.ranges.map(e),t.mainIndex)}function E(t,e){return t.update({selection:e,scrollIntoView:!0,userEvent:"select"})}function w({state:t,dispatch:e},r){let n=G(t.selection,r);return n.eq(t.selection,!0)?!1:(e(E(t,n)),!0)}function ge(t,e){return u.cursor(e?t.to:t.from)}function vt(t,e){return w(t,r=>r.empty?t.moveByChar(r,e):ge(r,e))}function A(t){return t.textDirectionAt(t.state.selection.main.head)==un.LTR}const Dt=t=>vt(t,!A(t)),Bt=t=>vt(t,A(t));function Rt(t,e){return w(t,r=>r.empty?t.moveByGroup(r,e):ge(r,e))}const er=t=>Rt(t,!A(t)),tr=t=>Rt(t,A(t));function nr(t,e,r){if(e.type.prop(r))return!0;let n=e.to-e.from;return n&&(n>2||/[^\s,.;:]/.test(t.sliceDoc(e.from,e.to)))||e.firstChild}function ye(t,e,r){let n=Ie(t).resolveInner(e.head),o=r?Me.closedBy:Me.openedBy;for(let c=e.head;;){let a=r?n.childAfter(c):n.childBefore(c);if(!a)break;nr(t,a,o)?n=a:c=r?a.to:a.from}let i=n.type.prop(o),l,s;return i&&(l=r?V(t,n.from,1):V(t,n.to,-1))&&l.matched?s=r?l.end.to:l.end.from:s=r?n.to:n.from,u.cursor(s,r?-1:1)}const rr=t=>w(t,e=>ye(t.state,e,!A(t))),or=t=>w(t,e=>ye(t.state,e,A(t)));function Et(t,e){return w(t,r=>{if(!r.empty)return ge(r,e);let n=t.moveVertically(r,e);return n.head!=r.head?n:t.moveToLineBoundary(r,e)})}const wt=t=>Et(t,!1),Pt=t=>Et(t,!0);function It(t){let e=t.scrollDOM.clientHeight<t.scrollDOM.scrollHeight-2,r=0,n=0,o;if(e){for(let i of t.state.facet(b.scrollMargins)){let l=i(t);l?.top&&(r=Math.max(l?.top,r)),l?.bottom&&(n=Math.max(l?.bottom,n))}o=t.scrollDOM.clientHeight-r-n}else o=(t.dom.ownerDocument.defaultView||window).innerHeight;return{marginTop:r,marginBottom:n,selfScroll:e,height:Math.max(t.defaultLineHeight,o-5)}}function Tt(t,e){let r=It(t),{state:n}=t,o=G(n.selection,l=>l.empty?t.moveVertically(l,e,r.height):ge(l,e));if(o.eq(n.selection))return!1;let i;if(r.selfScroll){let l=t.coordsAtPos(n.selection.main.head),s=t.scrollDOM.getBoundingClientRect(),c=s.top+r.marginTop,a=s.bottom-r.marginBottom;l&&l.top>c&&l.bottom<a&&(i=b.scrollIntoView(o.main.head,{y:"start",yMargin:l.top-c}))}return t.dispatch(E(n,o),{effects:i}),!0}const Ge=t=>Tt(t,!1),De=t=>Tt(t,!0);function O(t,e,r){let n=t.lineBlockAt(e.head),o=t.moveToLineBoundary(e,r);if(o.head==e.head&&o.head!=(r?n.to:n.from)&&(o=t.moveToLineBoundary(e,r,!1)),!r&&o.head==n.from&&n.length){let i=/^\s*/.exec(t.state.sliceDoc(n.from,Math.min(n.from+100,n.to)))[0].length;i&&e.head!=n.from+i&&(o=u.cursor(n.from+i))}return o}const ir=t=>w(t,e=>O(t,e,!0)),lr=t=>w(t,e=>O(t,e,!1)),sr=t=>w(t,e=>O(t,e,!A(t))),cr=t=>w(t,e=>O(t,e,A(t))),ar=t=>w(t,e=>u.cursor(t.lineBlockAt(e.head).from,1)),hr=t=>w(t,e=>u.cursor(t.lineBlockAt(e.head).to,-1));function fr(t,e,r){let n=!1,o=G(t.selection,i=>{let l=V(t,i.head,-1)||V(t,i.head,1)||i.head>0&&V(t,i.head-1,1)||i.head<t.doc.length&&V(t,i.head+1,-1);if(!l||!l.end)return i;n=!0;let s=l.start.from==i.head?l.end.to:l.end.from;return u.cursor(s)});return n?(e(E(t,o)),!0):!1}const ur=({state:t,dispatch:e})=>fr(t,e);function B(t,e){let r=G(t.state.selection,n=>{let o=e(n);return u.range(n.anchor,o.head,o.goalColumn,o.bidiLevel||void 0)});return r.eq(t.state.selection)?!1:(t.dispatch(E(t.state,r)),!0)}function Ot(t,e){return B(t,r=>t.moveByChar(r,e))}const Ft=t=>Ot(t,!A(t)),Wt=t=>Ot(t,A(t));function qt(t,e){return B(t,r=>t.moveByGroup(r,e))}const dr=t=>qt(t,!A(t)),mr=t=>qt(t,A(t)),pr=t=>B(t,e=>ye(t.state,e,!A(t))),gr=t=>B(t,e=>ye(t.state,e,A(t)));function Nt(t,e){return B(t,r=>t.moveVertically(r,e))}const Vt=t=>Nt(t,!1),$t=t=>Nt(t,!0);function Ut(t,e){return B(t,r=>t.moveVertically(r,e,It(t).height))}const He=t=>Ut(t,!1),Je=t=>Ut(t,!0),yr=t=>B(t,e=>O(t,e,!0)),xr=t=>B(t,e=>O(t,e,!1)),kr=t=>B(t,e=>O(t,e,!A(t))),Sr=t=>B(t,e=>O(t,e,A(t))),br=t=>B(t,e=>u.cursor(t.lineBlockAt(e.head).from)),Ar=t=>B(t,e=>u.cursor(t.lineBlockAt(e.head).to)),Ke=({state:t,dispatch:e})=>(e(E(t,{anchor:0})),!0),_e=({state:t,dispatch:e})=>(e(E(t,{anchor:t.doc.length})),!0),Qe=({state:t,dispatch:e})=>(e(E(t,{anchor:t.selection.main.anchor,head:0})),!0),Ye=({state:t,dispatch:e})=>(e(E(t,{anchor:t.selection.main.anchor,head:t.doc.length})),!0),Cr=({state:t,dispatch:e})=>(e(t.update({selection:{anchor:0,head:t.doc.length},userEvent:"select"})),!0),Mr=({state:t,dispatch:e})=>{let r=xe(t).map(({from:n,to:o})=>u.range(n,Math.min(o+1,t.doc.length)));return e(t.update({selection:u.create(r),userEvent:"select"})),!0},Lr=({state:t,dispatch:e})=>{let r=G(t.selection,n=>{let o=Ie(t),i=o.resolveStack(n.from,1);if(n.empty){let l=o.resolveStack(n.from,-1);l.node.from>=i.node.from&&l.node.to<=i.node.to&&(i=l)}for(let l=i;l;l=l.next){let{node:s}=l;if((s.from<n.from&&s.to>=n.to||s.to>n.to&&s.from<=n.from)&&l.next)return u.range(s.to,s.from)}return n});return r.eq(t.selection)?!1:(e(E(t,r)),!0)};function zt(t,e){let{state:r}=t,n=r.selection,o=r.selection.ranges.slice();for(let i of r.selection.ranges){let l=r.doc.lineAt(i.head);if(e?l.to<t.state.doc.length:l.from>0)for(let s=i;;){let c=t.moveVertically(s,e);if(c.head<l.from||c.head>l.to){o.some(a=>a.head==c.head)||o.push(c);break}else{if(c.head==s.head)break;s=c}}}return o.length==n.ranges.length?!1:(t.dispatch(E(r,u.create(o,o.length-1))),!0)}const vr=t=>zt(t,!1),Dr=t=>zt(t,!0),Br=({state:t,dispatch:e})=>{let r=t.selection,n=null;return r.ranges.length>1?n=u.create([r.main]):r.main.empty||(n=u.create([u.cursor(r.main.head)])),n?(e(E(t,n)),!0):!1};function X(t,e){if(t.state.readOnly)return!1;let r="delete.selection",{state:n}=t,o=n.changeByRange(i=>{let{from:l,to:s}=i;if(l==s){let c=e(i);c<l?(r="delete.backward",c=ne(t,c,!1)):c>l&&(r="delete.forward",c=ne(t,c,!0)),l=Math.min(l,c),s=Math.max(s,c)}else l=ne(t,l,!1),s=ne(t,s,!0);return l==s?{range:i}:{changes:{from:l,to:s},range:u.cursor(l,l<i.head?-1:1)}});return o.changes.empty?!1:(t.dispatch(n.update(o,{scrollIntoView:!0,userEvent:r,effects:r=="delete.selection"?b.announce.of(n.phrase("Selection deleted")):void 0})),!0)}function ne(t,e,r){if(t instanceof b)for(let n of t.state.facet(b.atomicRanges).map(o=>o(t)))n.between(e,e,(o,i)=>{o<e&&i>e&&(e=r?i:o)});return e}const Gt=(t,e,r)=>X(t,n=>{let o=n.from,{state:i}=t,l=i.doc.lineAt(o),s,c;if(r&&!e&&o>l.from&&o<l.from+200&&!/[^ \t]/.test(s=l.text.slice(0,o-l.from))){if(s[s.length-1]=="	")return o-1;let a=Pe(s,i.tabSize),h=a%Ce(i)||Ce(i);for(let f=0;f<h&&s[s.length-1-f]==" ";f++)o--;c=o}else c=W(l.text,o-l.from,e,e)+l.from,c==o&&l.number!=(e?i.doc.lines:1)?c+=e?1:-1:!e&&/[\ufe00-\ufe0f]/.test(l.text.slice(c-l.from,o-l.from))&&(c=W(l.text,c-l.from,!1,!1)+l.from);return c}),Be=t=>Gt(t,!1,!0),Ht=t=>Gt(t,!0,!1),Jt=(t,e)=>X(t,r=>{let n=r.head,{state:o}=t,i=o.doc.lineAt(n),l=o.charCategorizer(n);for(let s=null;;){if(n==(e?i.to:i.from)){n==r.head&&i.number!=(e?o.doc.lines:1)&&(n+=e?1:-1);break}let c=W(i.text,n-i.from,e)+i.from,a=i.text.slice(Math.min(n,c)-i.from,Math.max(n,c)-i.from),h=l(a);if(s!=null&&h!=s)break;(a!=" "||n!=r.head)&&(s=h),n=c}return n}),Kt=t=>Jt(t,!1),Rr=t=>Jt(t,!0),Er=t=>X(t,e=>{let r=t.lineBlockAt(e.head).to;return e.head<r?r:Math.min(t.state.doc.length,e.head+1)}),wr=t=>X(t,e=>{let r=t.moveToLineBoundary(e,!1).head;return e.head>r?r:Math.max(0,e.head-1)}),Pr=t=>X(t,e=>{let r=t.moveToLineBoundary(e,!0).head;return e.head<r?r:Math.min(t.state.doc.length,e.head+1)}),Ir=({state:t,dispatch:e})=>{if(t.readOnly)return!1;let r=t.changeByRange(n=>({changes:{from:n.from,to:n.to,insert:ht.of(["",""])},range:u.cursor(n.from)}));return e(t.update(r,{scrollIntoView:!0,userEvent:"input"})),!0},Tr=({state:t,dispatch:e})=>{if(t.readOnly)return!1;let r=t.changeByRange(n=>{if(!n.empty||n.from==0||n.from==t.doc.length)return{range:n};let o=n.from,i=t.doc.lineAt(o),l=o==i.from?o-1:W(i.text,o-i.from,!1)+i.from,s=o==i.to?o+1:W(i.text,o-i.from,!0)+i.from;return{changes:{from:l,to:s,insert:t.doc.slice(o,s).append(t.doc.slice(l,o))},range:u.cursor(s)}});return r.changes.empty?!1:(e(t.update(r,{scrollIntoView:!0,userEvent:"move.character"})),!0)};function xe(t){let e=[],r=-1;for(let n of t.selection.ranges){let o=t.doc.lineAt(n.from),i=t.doc.lineAt(n.to);if(!n.empty&&n.to==i.from&&(i=t.doc.lineAt(n.to-1)),r>=o.number){let l=e[e.length-1];l.to=i.to,l.ranges.push(n)}else e.push({from:o.from,to:i.to,ranges:[n]});r=i.number+1}return e}function _t(t,e,r){if(t.readOnly)return!1;let n=[],o=[];for(let i of xe(t)){if(r?i.to==t.doc.length:i.from==0)continue;let l=t.doc.lineAt(r?i.to+1:i.from-1),s=l.length+1;if(r){n.push({from:i.to,to:l.to},{from:i.from,insert:l.text+t.lineBreak});for(let c of i.ranges)o.push(u.range(Math.min(t.doc.length,c.anchor+s),Math.min(t.doc.length,c.head+s)))}else{n.push({from:l.from,to:i.from},{from:i.to,insert:t.lineBreak+l.text});for(let c of i.ranges)o.push(u.range(c.anchor-s,c.head-s))}}return n.length?(e(t.update({changes:n,scrollIntoView:!0,selection:u.create(o,t.selection.mainIndex),userEvent:"move.line"})),!0):!1}const Or=({state:t,dispatch:e})=>_t(t,e,!1),Fr=({state:t,dispatch:e})=>_t(t,e,!0);function Qt(t,e,r){if(t.readOnly)return!1;let n=[];for(let i of xe(t))r?n.push({from:i.from,insert:t.doc.slice(i.from,i.to)+t.lineBreak}):n.push({from:i.to,insert:t.lineBreak+t.doc.slice(i.from,i.to)});let o=t.changes(n);return e(t.update({changes:o,selection:t.selection.map(o,r?1:-1),scrollIntoView:!0,userEvent:"input.copyline"})),!0}const Wr=({state:t,dispatch:e})=>Qt(t,e,!1),qr=({state:t,dispatch:e})=>Qt(t,e,!0),Nr=t=>{if(t.state.readOnly)return!1;let{state:e}=t,r=e.changes(xe(e).map(({from:o,to:i})=>(o>0?o--:i<e.doc.length&&i++,{from:o,to:i}))),n=G(e.selection,o=>{let i;if(t.lineWrapping){let l=t.lineBlockAt(o.head),s=t.coordsAtPos(o.head,o.assoc||1);s&&(i=l.bottom+t.documentTop-s.bottom+t.defaultLineHeight/2)}return t.moveVertically(o,!0,i)}).map(r);return t.dispatch({changes:r,selection:n,scrollIntoView:!0,userEvent:"delete.line"}),!0};function Vr(t,e){if(/\(\)|\[\]|\{\}/.test(t.sliceDoc(e-1,e+1)))return{from:e,to:e};let r=Ie(t).resolveInner(e),n=r.childBefore(e),o=r.childAfter(e),i;return n&&o&&n.to<=e&&o.from>=e&&(i=n.type.prop(Me.closedBy))&&i.indexOf(o.name)>-1&&t.doc.lineAt(n.to).from==t.doc.lineAt(o.from).from&&!/\S/.test(t.sliceDoc(n.to,o.from))?{from:n.to,to:o.from}:null}const je=Yt(!1),$r=Yt(!0);function Yt(t){return({state:e,dispatch:r})=>{if(e.readOnly)return!1;let n=e.changeByRange(o=>{let{from:i,to:l}=o,s=e.doc.lineAt(i),c=!t&&i==l&&Vr(e,i);t&&(i=l=(l<=s.to?s:e.doc.lineAt(l)).to);let a=new mt(e,{simulateBreak:i,simulateDoubleBreak:!!c}),h=pt(a,i);for(h==null&&(h=Pe(/^\s*/.exec(e.doc.lineAt(i).text)[0],e.tabSize));l<s.to&&/\s/.test(s.text[l-s.from]);)l++;c?{from:i,to:l}=c:i>s.from&&i<s.from+100&&!/\S/.test(s.text.slice(0,i))&&(i=s.from);let f=["",le(e,h)];return c&&f.push(le(e,a.lineIndent(s.from,-1))),{changes:{from:i,to:l,insert:ht.of(f)},range:u.cursor(i+1+f[1].length)}});return r(e.update(n,{scrollIntoView:!0,userEvent:"input"})),!0}}function Fe(t,e){let r=-1;return t.changeByRange(n=>{let o=[];for(let l=n.from;l<=n.to;){let s=t.doc.lineAt(l);s.number>r&&(n.empty||n.to>s.from)&&(e(s,o,n),r=s.number),l=s.to+1}let i=t.changes(o);return{changes:o,range:u.range(i.mapPos(n.anchor,1),i.mapPos(n.head,1))}})}const Ur=({state:t,dispatch:e})=>{if(t.readOnly)return!1;let r=Object.create(null),n=new mt(t,{overrideIndentation:i=>{let l=r[i];return l??-1}}),o=Fe(t,(i,l,s)=>{let c=pt(n,i.from);if(c==null)return;/\S/.test(i.text)||(c=0);let a=/^\s*/.exec(i.text)[0],h=le(t,c);(a!=h||s.from<i.from+a.length)&&(r[i.from]=c,l.push({from:i.from,to:i.from+a.length,insert:h}))});return o.changes.empty||e(t.update(o,{userEvent:"indent"})),!0},zr=({state:t,dispatch:e})=>t.readOnly?!1:(e(t.update(Fe(t,(r,n)=>{n.push({from:r.from,insert:t.facet(Bn)})}),{userEvent:"input.indent"})),!0),Gr=({state:t,dispatch:e})=>t.readOnly?!1:(e(t.update(Fe(t,(r,n)=>{let o=/^\s*/.exec(r.text)[0];if(!o)return;let i=Pe(o,t.tabSize),l=0,s=le(t,Math.max(0,i-Ce(t)));for(;l<o.length&&l<s.length&&o.charCodeAt(l)==s.charCodeAt(l);)l++;n.push({from:r.from+l,to:r.from+o.length,insert:s.slice(l)})}),{userEvent:"delete.dedent"})),!0),Hr=t=>(t.setTabFocusMode(),!0),Jr=[{key:"Ctrl-b",run:Dt,shift:Ft,preventDefault:!0},{key:"Ctrl-f",run:Bt,shift:Wt},{key:"Ctrl-p",run:wt,shift:Vt},{key:"Ctrl-n",run:Pt,shift:$t},{key:"Ctrl-a",run:ar,shift:br},{key:"Ctrl-e",run:hr,shift:Ar},{key:"Ctrl-d",run:Ht},{key:"Ctrl-h",run:Be},{key:"Ctrl-k",run:Er},{key:"Ctrl-Alt-h",run:Kt},{key:"Ctrl-o",run:Ir},{key:"Ctrl-t",run:Tr},{key:"Ctrl-v",run:De}],Kr=[{key:"ArrowLeft",run:Dt,shift:Ft,preventDefault:!0},{key:"Mod-ArrowLeft",mac:"Alt-ArrowLeft",run:er,shift:dr,preventDefault:!0},{mac:"Cmd-ArrowLeft",run:sr,shift:kr,preventDefault:!0},{key:"ArrowRight",run:Bt,shift:Wt,preventDefault:!0},{key:"Mod-ArrowRight",mac:"Alt-ArrowRight",run:tr,shift:mr,preventDefault:!0},{mac:"Cmd-ArrowRight",run:cr,shift:Sr,preventDefault:!0},{key:"ArrowUp",run:wt,shift:Vt,preventDefault:!0},{mac:"Cmd-ArrowUp",run:Ke,shift:Qe},{mac:"Ctrl-ArrowUp",run:Ge,shift:He},{key:"ArrowDown",run:Pt,shift:$t,preventDefault:!0},{mac:"Cmd-ArrowDown",run:_e,shift:Ye},{mac:"Ctrl-ArrowDown",run:De,shift:Je},{key:"PageUp",run:Ge,shift:He},{key:"PageDown",run:De,shift:Je},{key:"Home",run:lr,shift:xr,preventDefault:!0},{key:"Mod-Home",run:Ke,shift:Qe},{key:"End",run:ir,shift:yr,preventDefault:!0},{key:"Mod-End",run:_e,shift:Ye},{key:"Enter",run:je,shift:je},{key:"Mod-a",run:Cr},{key:"Backspace",run:Be,shift:Be,preventDefault:!0},{key:"Delete",run:Ht,preventDefault:!0},{key:"Mod-Backspace",mac:"Alt-Backspace",run:Kt,preventDefault:!0},{key:"Mod-Delete",mac:"Alt-Delete",run:Rr,preventDefault:!0},{mac:"Mod-Backspace",run:wr,preventDefault:!0},{mac:"Mod-Delete",run:Pr,preventDefault:!0}].concat(Jr.map(t=>({mac:t.key,run:t.run,shift:t.shift}))),jt=[{key:"Alt-ArrowLeft",mac:"Ctrl-ArrowLeft",run:rr,shift:pr},{key:"Alt-ArrowRight",mac:"Ctrl-ArrowRight",run:or,shift:gr},{key:"Alt-ArrowUp",run:Or},{key:"Shift-Alt-ArrowUp",run:Wr},{key:"Alt-ArrowDown",run:Fr},{key:"Shift-Alt-ArrowDown",run:qr},{key:"Mod-Alt-ArrowUp",run:vr},{key:"Mod-Alt-ArrowDown",run:Dr},{key:"Escape",run:Br},{key:"Mod-Enter",run:$r},{key:"Alt-l",mac:"Ctrl-l",run:Mr},{key:"Mod-i",run:Lr,preventDefault:!0},{key:"Mod-[",run:Gr},{key:"Mod-]",run:zr},{key:"Mod-Alt-\\",run:Ur},{key:"Shift-Mod-k",run:Nr},{key:"Shift-Mod-\\",run:ur},{key:"Mod-/",run:Wn},{key:"Alt-A",run:Nn},{key:"Ctrl-m",mac:"Shift-Alt-m",run:Hr}].concat(Kr),Ze=typeof String.prototype.normalize=="function"?t=>t.normalize("NFKD"):t=>t;class U{constructor(e,r,n=0,o=e.length,i,l){this.test=l,this.value={from:0,to:0},this.done=!1,this.matches=[],this.buffer="",this.bufferPos=0,this.iter=e.iterRange(n,o),this.bufferStart=n,this.normalize=i?s=>i(Ze(s)):Ze,this.query=this.normalize(r)}peek(){if(this.bufferPos==this.buffer.length){if(this.bufferStart+=this.buffer.length,this.iter.next(),this.iter.done)return-1;this.bufferPos=0,this.buffer=this.iter.value}return Ln(this.buffer,this.bufferPos)}next(){for(;this.matches.length;)this.matches.pop();return this.nextOverlapping()}nextOverlapping(){for(;;){let e=this.peek();if(e<0)return this.done=!0,this;let r=vn(e),n=this.bufferStart+this.bufferPos;this.bufferPos+=Dn(e);let o=this.normalize(r);if(o.length)for(let i=0,l=n;;i++){let s=o.charCodeAt(i),c=this.match(s,l,this.bufferPos+this.bufferStart);if(i==o.length-1){if(c)return this.value=c,this;break}l==n&&i<r.length&&r.charCodeAt(i)==s&&l++}}}match(e,r,n){let o=null;for(let i=0;i<this.matches.length;i+=2){let l=this.matches[i],s=!1;this.query.charCodeAt(l)==e&&(l==this.query.length-1?o={from:this.matches[i+1],to:n}:(this.matches[i]++,s=!0)),s||(this.matches.splice(i,2),i-=2)}return this.query.charCodeAt(0)==e&&(this.query.length==1?o={from:r,to:n}:this.matches.push(1,r)),o&&this.test&&!this.test(o.from,o.to,this.buffer,this.bufferStart)&&(o=null),o}}typeof Symbol<"u"&&(U.prototype[Symbol.iterator]=function(){return this});const Zt={from:-1,to:-1,match:/.*/.exec("")},We="gm"+(/x/.unicode==null?"":"u");class Xt{constructor(e,r,n,o=0,i=e.length){if(this.text=e,this.to=i,this.curLine="",this.done=!1,this.value=Zt,/\\[sWDnr]|\n|\r|\[\^/.test(r))return new en(e,r,n,o,i);this.re=new RegExp(r,We+(n?.ignoreCase?"i":"")),this.test=n?.test,this.iter=e.iter();let l=e.lineAt(o);this.curLineStart=l.from,this.matchPos=ce(e,o),this.getLine(this.curLineStart)}getLine(e){this.iter.next(e),this.iter.lineBreak?this.curLine="":(this.curLine=this.iter.value,this.curLineStart+this.curLine.length>this.to&&(this.curLine=this.curLine.slice(0,this.to-this.curLineStart)),this.iter.next())}nextLine(){this.curLineStart=this.curLineStart+this.curLine.length+1,this.curLineStart>this.to?this.curLine="":this.getLine(0)}next(){for(let e=this.matchPos-this.curLineStart;;){this.re.lastIndex=e;let r=this.matchPos<=this.to&&this.re.exec(this.curLine);if(r){let n=this.curLineStart+r.index,o=n+r[0].length;if(this.matchPos=ce(this.text,o+(n==o?1:0)),n==this.curLineStart+this.curLine.length&&this.nextLine(),(n<o||n>this.value.to)&&(!this.test||this.test(n,o,r)))return this.value={from:n,to:o,match:r},this;e=this.matchPos-this.curLineStart}else if(this.curLineStart+this.curLine.length<this.to)this.nextLine(),e=0;else return this.done=!0,this}}}const be=new WeakMap;class ${constructor(e,r){this.from=e,this.text=r}get to(){return this.from+this.text.length}static get(e,r,n){let o=be.get(e);if(!o||o.from>=n||o.to<=r){let s=new $(r,e.sliceString(r,n));return be.set(e,s),s}if(o.from==r&&o.to==n)return o;let{text:i,from:l}=o;return l>r&&(i=e.sliceString(r,l)+i,l=r),o.to<n&&(i+=e.sliceString(o.to,n)),be.set(e,new $(l,i)),new $(r,i.slice(r-l,n-l))}}class en{constructor(e,r,n,o,i){this.text=e,this.to=i,this.done=!1,this.value=Zt,this.matchPos=ce(e,o),this.re=new RegExp(r,We+(n?.ignoreCase?"i":"")),this.test=n?.test,this.flat=$.get(e,o,this.chunkEnd(o+5e3))}chunkEnd(e){return e>=this.to?this.to:this.text.lineAt(e).to}next(){for(;;){let e=this.re.lastIndex=this.matchPos-this.flat.from,r=this.re.exec(this.flat.text);if(r&&!r[0]&&r.index==e&&(this.re.lastIndex=e+1,r=this.re.exec(this.flat.text)),r){let n=this.flat.from+r.index,o=n+r[0].length;if((this.flat.to>=this.to||r.index+r[0].length<=this.flat.text.length-10)&&(!this.test||this.test(n,o,r)))return this.value={from:n,to:o,match:r},this.matchPos=ce(this.text,o+(n==o?1:0)),this}if(this.flat.to==this.to)return this.done=!0,this;this.flat=$.get(this.text,this.flat.from,this.chunkEnd(this.flat.from+this.flat.text.length*2))}}}typeof Symbol<"u"&&(Xt.prototype[Symbol.iterator]=en.prototype[Symbol.iterator]=function(){return this});function _r(t){try{return new RegExp(t,We),!0}catch{return!1}}function ce(t,e){if(e>=t.length)return e;let r=t.lineAt(e),n;for(;e<r.to&&(n=r.text.charCodeAt(e-r.from))>=56320&&n<57344;)e++;return e}function Re(t){let e=String(t.state.doc.lineAt(t.state.selection.main.head).number),r=p("input",{class:"cm-textfield",name:"line",value:e}),n=p("form",{class:"cm-gotoLine",onkeydown:i=>{i.keyCode==27?(i.preventDefault(),t.dispatch({effects:K.of(!1)}),t.focus()):i.keyCode==13&&(i.preventDefault(),o())},onsubmit:i=>{i.preventDefault(),o()}},p("label",t.state.phrase("Go to line"),": ",r)," ",p("button",{class:"cm-button",type:"submit"},t.state.phrase("go")),p("button",{name:"close",onclick:()=>{t.dispatch({effects:K.of(!1)}),t.focus()},"aria-label":t.state.phrase("close"),type:"button"},["×"]));function o(){let i=/^([+-])?(\d+)?(:\d+)?(%)?$/.exec(r.value);if(!i)return;let{state:l}=t,s=l.doc.lineAt(l.selection.main.head),[,c,a,h,f]=i,d=h?+h.slice(1):0,m=a?+a:s.number;if(a&&f){let x=m/100;c&&(x=x*(c=="-"?-1:1)+s.number/l.doc.lines),m=Math.round(l.doc.lines*x)}else a&&c&&(m=m*(c=="-"?-1:1)+s.number);let g=l.doc.line(Math.max(1,Math.min(l.doc.lines,m))),S=u.cursor(g.from+Math.max(0,Math.min(d,g.length)));t.dispatch({effects:[K.of(!1),b.scrollIntoView(S.from,{y:"center"})],selection:S}),t.focus()}return{dom:n}}const K=R.define(),Xe=de.define({create(){return!0},update(t,e){for(let r of e.effects)r.is(K)&&(t=r.value);return t},provide:t=>we.from(t,e=>e?Re:null)}),Qr=t=>{let e=_(t,Re);if(!e){let r=[K.of(!0)];t.state.field(Xe,!1)==null&&r.push(R.appendConfig.of([Xe,Yr])),t.dispatch({effects:r}),e=_(t,Re)}return e&&e.dom.querySelector("input").select(),!0},Yr=b.baseTheme({".cm-panel.cm-gotoLine":{padding:"2px 6px 4px",position:"relative","& label":{fontSize:"80%"},"& [name=close]":{position:"absolute",top:"0",bottom:"0",right:"4px",backgroundColor:"inherit",border:"none",font:"inherit",padding:"0"}}}),jr={highlightWordAroundCursor:!1,minSelectionLength:1,maxMatches:100,wholeWords:!1},Zr=Z.define({combine(t){return me(t,jr,{highlightWordAroundCursor:(e,r)=>e||r,minSelectionLength:Math.min,maxMatches:Math.min})}});function Xr(t){return[oo,ro]}const eo=k.mark({class:"cm-selectionMatch"}),to=k.mark({class:"cm-selectionMatch cm-selectionMatch-main"});function et(t,e,r,n){return(r==0||t(e.sliceDoc(r-1,r))!=v.Word)&&(n==e.doc.length||t(e.sliceDoc(n,n+1))!=v.Word)}function no(t,e,r,n){return t(e.sliceDoc(r,r+1))==v.Word&&t(e.sliceDoc(n-1,n))==v.Word}const ro=lt.fromClass(class{constructor(t){this.decorations=this.getDeco(t)}update(t){(t.selectionSet||t.docChanged||t.viewportChanged)&&(this.decorations=this.getDeco(t.view))}getDeco(t){let e=t.state.facet(Zr),{state:r}=t,n=r.selection;if(n.ranges.length>1)return k.none;let o=n.main,i,l=null;if(o.empty){if(!e.highlightWordAroundCursor)return k.none;let c=r.wordAt(o.head);if(!c)return k.none;l=r.charCategorizer(o.head),i=r.sliceDoc(c.from,c.to)}else{let c=o.to-o.from;if(c<e.minSelectionLength||c>200)return k.none;if(e.wholeWords){if(i=r.sliceDoc(o.from,o.to),l=r.charCategorizer(o.head),!(et(l,r,o.from,o.to)&&no(l,r,o.from,o.to)))return k.none}else if(i=r.sliceDoc(o.from,o.to),!i)return k.none}let s=[];for(let c of t.visibleRanges){let a=new U(r.doc,i,c.from,c.to);for(;!a.next().done;){let{from:h,to:f}=a.value;if((!l||et(l,r,h,f))&&(o.empty&&h<=o.from&&f>=o.to?s.push(to.range(h,f)):(h>=o.to||f<=o.from)&&s.push(eo.range(h,f)),s.length>e.maxMatches))return k.none}}return k.set(s)}},{decorations:t=>t.decorations}),oo=b.baseTheme({".cm-selectionMatch":{backgroundColor:"#99ff7780"},".cm-searchMatch .cm-selectionMatch":{backgroundColor:"transparent"}}),io=({state:t,dispatch:e})=>{let{selection:r}=t,n=u.create(r.ranges.map(o=>t.wordAt(o.head)||u.cursor(o.head)),r.mainIndex);return n.eq(r)?!1:(e(t.update({selection:n})),!0)};function lo(t,e){let{main:r,ranges:n}=t.selection,o=t.wordAt(r.head),i=o&&o.from==r.from&&o.to==r.to;for(let l=!1,s=new U(t.doc,e,n[n.length-1].to);;)if(s.next(),s.done){if(l)return null;s=new U(t.doc,e,0,Math.max(0,n[n.length-1].from-1)),l=!0}else{if(l&&n.some(c=>c.from==s.value.from))continue;if(i){let c=t.wordAt(s.value.from);if(!c||c.from!=s.value.from||c.to!=s.value.to)continue}return s.value}}const so=({state:t,dispatch:e})=>{let{ranges:r}=t.selection;if(r.some(i=>i.from===i.to))return io({state:t,dispatch:e});let n=t.sliceDoc(r[0].from,r[0].to);if(t.selection.ranges.some(i=>t.sliceDoc(i.from,i.to)!=n))return!1;let o=lo(t,n);return o?(e(t.update({selection:t.selection.addRange(u.range(o.from,o.to),!1),effects:b.scrollIntoView(o.to)})),!0):!1},H=Z.define({combine(t){return me(t,{top:!1,caseSensitive:!1,literal:!1,regexp:!1,wholeWord:!1,createPanel:e=>new So(e),scrollToMatch:e=>b.scrollIntoView(e)})}});class tn{constructor(e){this.search=e.search,this.caseSensitive=!!e.caseSensitive,this.literal=!!e.literal,this.regexp=!!e.regexp,this.replace=e.replace||"",this.valid=!!this.search&&(!this.regexp||_r(this.search)),this.unquoted=this.unquote(this.search),this.wholeWord=!!e.wholeWord}unquote(e){return this.literal?e:e.replace(/\\([nrt\\])/g,(r,n)=>n=="n"?`
`:n=="r"?"\r":n=="t"?"	":"\\")}eq(e){return this.search==e.search&&this.replace==e.replace&&this.caseSensitive==e.caseSensitive&&this.regexp==e.regexp&&this.wholeWord==e.wholeWord}create(){return this.regexp?new fo(this):new ao(this)}getCursor(e,r=0,n){let o=e.doc?e:ut.create({doc:e});return n==null&&(n=o.doc.length),this.regexp?N(this,o,r,n):q(this,o,r,n)}}class nn{constructor(e){this.spec=e}}function q(t,e,r,n){return new U(e.doc,t.unquoted,r,n,t.caseSensitive?void 0:o=>o.toLowerCase(),t.wholeWord?co(e.doc,e.charCategorizer(e.selection.main.head)):void 0)}function co(t,e){return(r,n,o,i)=>((i>r||i+o.length<n)&&(i=Math.max(0,r-2),o=t.sliceString(i,Math.min(t.length,n+2))),(e(ae(o,r-i))!=v.Word||e(he(o,r-i))!=v.Word)&&(e(he(o,n-i))!=v.Word||e(ae(o,n-i))!=v.Word))}class ao extends nn{constructor(e){super(e)}nextMatch(e,r,n){let o=q(this.spec,e,n,e.doc.length).nextOverlapping();if(o.done){let i=Math.min(e.doc.length,r+this.spec.unquoted.length);o=q(this.spec,e,0,i).nextOverlapping()}return o.done||o.value.from==r&&o.value.to==n?null:o.value}prevMatchInRange(e,r,n){for(let o=n;;){let i=Math.max(r,o-1e4-this.spec.unquoted.length),l=q(this.spec,e,i,o),s=null;for(;!l.nextOverlapping().done;)s=l.value;if(s)return s;if(i==r)return null;o-=1e4}}prevMatch(e,r,n){let o=this.prevMatchInRange(e,0,r);return o||(o=this.prevMatchInRange(e,Math.max(0,n-this.spec.unquoted.length),e.doc.length)),o&&(o.from!=r||o.to!=n)?o:null}getReplacement(e){return this.spec.unquote(this.spec.replace)}matchAll(e,r){let n=q(this.spec,e,0,e.doc.length),o=[];for(;!n.next().done;){if(o.length>=r)return null;o.push(n.value)}return o}highlight(e,r,n,o){let i=q(this.spec,e,Math.max(0,r-this.spec.unquoted.length),Math.min(n+this.spec.unquoted.length,e.doc.length));for(;!i.next().done;)o(i.value.from,i.value.to)}}function N(t,e,r,n){return new Xt(e.doc,t.search,{ignoreCase:!t.caseSensitive,test:t.wholeWord?ho(e.charCategorizer(e.selection.main.head)):void 0},r,n)}function ae(t,e){return t.slice(W(t,e,!1),e)}function he(t,e){return t.slice(e,W(t,e))}function ho(t){return(e,r,n)=>!n[0].length||(t(ae(n.input,n.index))!=v.Word||t(he(n.input,n.index))!=v.Word)&&(t(he(n.input,n.index+n[0].length))!=v.Word||t(ae(n.input,n.index+n[0].length))!=v.Word)}class fo extends nn{nextMatch(e,r,n){let o=N(this.spec,e,n,e.doc.length).next();return o.done&&(o=N(this.spec,e,0,r).next()),o.done?null:o.value}prevMatchInRange(e,r,n){for(let o=1;;o++){let i=Math.max(r,n-o*1e4),l=N(this.spec,e,i,n),s=null;for(;!l.next().done;)s=l.value;if(s&&(i==r||s.from>i+10))return s;if(i==r)return null}}prevMatch(e,r,n){return this.prevMatchInRange(e,0,r)||this.prevMatchInRange(e,n,e.doc.length)}getReplacement(e){return this.spec.unquote(this.spec.replace).replace(/\$([$&]|\d+)/g,(r,n)=>{if(n=="&")return e.match[0];if(n=="$")return"$";for(let o=n.length;o>0;o--){let i=+n.slice(0,o);if(i>0&&i<e.match.length)return e.match[i]+n.slice(o)}return r})}matchAll(e,r){let n=N(this.spec,e,0,e.doc.length),o=[];for(;!n.next().done;){if(o.length>=r)return null;o.push(n.value)}return o}highlight(e,r,n,o){let i=N(this.spec,e,Math.max(0,r-250),Math.min(n+250,e.doc.length));for(;!i.next().done;)o(i.value.from,i.value.to)}}const Q=R.define(),qe=R.define(),T=de.define({create(t){return new Ae(Ee(t).create(),null)},update(t,e){for(let r of e.effects)r.is(Q)?t=new Ae(r.value.create(),t.panel):r.is(qe)&&(t=new Ae(t.query,r.value?Ne:null));return t},provide:t=>we.from(t,e=>e.panel)});class Ae{constructor(e,r){this.query=e,this.panel=r}}const uo=k.mark({class:"cm-searchMatch"}),mo=k.mark({class:"cm-searchMatch cm-searchMatch-selected"}),po=lt.fromClass(class{constructor(t){this.view=t,this.decorations=this.highlight(t.state.field(T))}update(t){let e=t.state.field(T);(e!=t.startState.field(T)||t.docChanged||t.selectionSet||t.viewportChanged)&&(this.decorations=this.highlight(e))}highlight({query:t,panel:e}){if(!e||!t.spec.valid)return k.none;let{view:r}=this,n=new dt;for(let o=0,i=r.visibleRanges,l=i.length;o<l;o++){let{from:s,to:c}=i[o];for(;o<l-1&&c>i[o+1].from-500;)c=i[++o].to;t.highlight(r.state,s,c,(a,h)=>{let f=r.state.selection.ranges.some(d=>d.from==a&&d.to==h);n.add(a,h,f?mo:uo)})}return n.finish()}},{decorations:t=>t.decorations});function ee(t){return e=>{let r=e.state.field(T,!1);return r&&r.query.spec.valid?t(e,r):ln(e)}}const fe=ee((t,{query:e})=>{let{to:r}=t.state.selection.main,n=e.nextMatch(t.state,r,r);if(!n)return!1;let o=u.single(n.from,n.to),i=t.state.facet(H);return t.dispatch({selection:o,effects:[Ve(t,n),i.scrollToMatch(o.main,t)],userEvent:"select.search"}),on(t),!0}),ue=ee((t,{query:e})=>{let{state:r}=t,{from:n}=r.selection.main,o=e.prevMatch(r,n,n);if(!o)return!1;let i=u.single(o.from,o.to),l=t.state.facet(H);return t.dispatch({selection:i,effects:[Ve(t,o),l.scrollToMatch(i.main,t)],userEvent:"select.search"}),on(t),!0}),go=ee((t,{query:e})=>{let r=e.matchAll(t.state,1e3);return!r||!r.length?!1:(t.dispatch({selection:u.create(r.map(n=>u.range(n.from,n.to))),userEvent:"select.search.matches"}),!0)}),yo=({state:t,dispatch:e})=>{let r=t.selection;if(r.ranges.length>1||r.main.empty)return!1;let{from:n,to:o}=r.main,i=[],l=0;for(let s=new U(t.doc,t.sliceDoc(n,o));!s.next().done;){if(i.length>1e3)return!1;s.value.from==n&&(l=i.length),i.push(u.range(s.value.from,s.value.to))}return e(t.update({selection:u.create(i,l),userEvent:"select.search.matches"})),!0},tt=ee((t,{query:e})=>{let{state:r}=t,{from:n,to:o}=r.selection.main;if(r.readOnly)return!1;let i=e.nextMatch(r,n,n);if(!i)return!1;let l=i,s=[],c,a,h=[];l.from==n&&l.to==o&&(a=r.toText(e.getReplacement(l)),s.push({from:l.from,to:l.to,insert:a}),l=e.nextMatch(r,l.from,l.to),h.push(b.announce.of(r.phrase("replaced match on line $",r.doc.lineAt(n).number)+".")));let f=t.state.changes(s);return l&&(c=u.single(l.from,l.to).map(f),h.push(Ve(t,l)),h.push(r.facet(H).scrollToMatch(c.main,t))),t.dispatch({changes:f,selection:c,effects:h,userEvent:"input.replace"}),!0}),xo=ee((t,{query:e})=>{if(t.state.readOnly)return!1;let r=e.matchAll(t.state,1e9).map(o=>{let{from:i,to:l}=o;return{from:i,to:l,insert:e.getReplacement(o)}});if(!r.length)return!1;let n=t.state.phrase("replaced $ matches",r.length)+".";return t.dispatch({changes:r,effects:b.announce.of(n),userEvent:"input.replace.all"}),!0});function Ne(t){return t.state.facet(H).createPanel(t)}function Ee(t,e){var r,n,o,i,l;let s=t.selection.main,c=s.empty||s.to>s.from+100?"":t.sliceDoc(s.from,s.to);if(e&&!c)return e;let a=t.facet(H);return new tn({search:((r=e?.literal)!==null&&r!==void 0?r:a.literal)?c:c.replace(/\n/g,"\\n"),caseSensitive:(n=e?.caseSensitive)!==null&&n!==void 0?n:a.caseSensitive,literal:(o=e?.literal)!==null&&o!==void 0?o:a.literal,regexp:(i=e?.regexp)!==null&&i!==void 0?i:a.regexp,wholeWord:(l=e?.wholeWord)!==null&&l!==void 0?l:a.wholeWord})}function rn(t){let e=_(t,Ne);return e&&e.dom.querySelector("[main-field]")}function on(t){let e=rn(t);e&&e==t.root.activeElement&&e.select()}const ln=t=>{let e=t.state.field(T,!1);if(e&&e.panel){let r=rn(t);if(r&&r!=t.root.activeElement){let n=Ee(t.state,e.query.spec);n.valid&&t.dispatch({effects:Q.of(n)}),r.focus(),r.select()}}else t.dispatch({effects:[qe.of(!0),e?Q.of(Ee(t.state,e.query.spec)):R.appendConfig.of(Ao)]});return!0},sn=t=>{let e=t.state.field(T,!1);if(!e||!e.panel)return!1;let r=_(t,Ne);return r&&r.dom.contains(t.root.activeElement)&&t.focus(),t.dispatch({effects:qe.of(!1)}),!0},ko=[{key:"Mod-f",run:ln,scope:"editor search-panel"},{key:"F3",run:fe,shift:ue,scope:"editor search-panel",preventDefault:!0},{key:"Mod-g",run:fe,shift:ue,scope:"editor search-panel",preventDefault:!0},{key:"Escape",run:sn,scope:"editor search-panel"},{key:"Mod-Shift-l",run:yo},{key:"Mod-Alt-g",run:Qr},{key:"Mod-d",run:so,preventDefault:!0}];class So{constructor(e){this.view=e;let r=this.query=e.state.field(T).query.spec;this.commit=this.commit.bind(this),this.searchField=p("input",{value:r.search,placeholder:M(e,"Find"),"aria-label":M(e,"Find"),class:"cm-textfield",name:"search",form:"","main-field":"true",onchange:this.commit,onkeyup:this.commit}),this.replaceField=p("input",{value:r.replace,placeholder:M(e,"Replace"),"aria-label":M(e,"Replace"),class:"cm-textfield",name:"replace",form:"",onchange:this.commit,onkeyup:this.commit}),this.caseField=p("input",{type:"checkbox",name:"case",form:"",checked:r.caseSensitive,onchange:this.commit}),this.reField=p("input",{type:"checkbox",name:"re",form:"",checked:r.regexp,onchange:this.commit}),this.wordField=p("input",{type:"checkbox",name:"word",form:"",checked:r.wholeWord,onchange:this.commit});function n(o,i,l){return p("button",{class:"cm-button",name:o,onclick:i,type:"button"},l)}this.dom=p("div",{onkeydown:o=>this.keydown(o),class:"cm-search"},[this.searchField,n("next",()=>fe(e),[M(e,"next")]),n("prev",()=>ue(e),[M(e,"previous")]),n("select",()=>go(e),[M(e,"all")]),p("label",null,[this.caseField,M(e,"match case")]),p("label",null,[this.reField,M(e,"regexp")]),p("label",null,[this.wordField,M(e,"by word")]),...e.state.readOnly?[]:[p("br"),this.replaceField,n("replace",()=>tt(e),[M(e,"replace")]),n("replaceAll",()=>xo(e),[M(e,"replace all")])],p("button",{name:"close",onclick:()=>sn(e),"aria-label":M(e,"close"),type:"button"},["×"])])}commit(){let e=new tn({search:this.searchField.value,caseSensitive:this.caseField.checked,regexp:this.reField.checked,wholeWord:this.wordField.checked,replace:this.replaceField.value});e.eq(this.query)||(this.query=e,this.view.dispatch({effects:Q.of(e)}))}keydown(e){dn(this.view,e,"search-panel")?e.preventDefault():e.keyCode==13&&e.target==this.searchField?(e.preventDefault(),(e.shiftKey?ue:fe)(this.view)):e.keyCode==13&&e.target==this.replaceField&&(e.preventDefault(),tt(this.view))}update(e){for(let r of e.transactions)for(let n of r.effects)n.is(Q)&&!n.value.eq(this.query)&&this.setQuery(n.value)}setQuery(e){this.query=e,this.searchField.value=e.search,this.replaceField.value=e.replace,this.caseField.checked=e.caseSensitive,this.reField.checked=e.regexp,this.wordField.checked=e.wholeWord}mount(){this.searchField.select()}get pos(){return 80}get top(){return this.view.state.facet(H).top}}function M(t,e){return t.state.phrase(e)}const re=30,oe=/[\s\.,:;?!]/;function Ve(t,{from:e,to:r}){let n=t.state.doc.lineAt(e),o=t.state.doc.lineAt(r).to,i=Math.max(n.from,e-re),l=Math.min(o,r+re),s=t.state.sliceDoc(i,l);if(i!=n.from){for(let c=0;c<re;c++)if(!oe.test(s[c+1])&&oe.test(s[c])){s=s.slice(c);break}}if(l!=o){for(let c=s.length-1;c>s.length-re;c--)if(!oe.test(s[c-1])&&oe.test(s[c])){s=s.slice(0,c);break}}return b.announce.of(`${t.state.phrase("current match")}. ${s} ${t.state.phrase("on line")} ${n.number}.`)}const bo=b.baseTheme({".cm-panel.cm-search":{padding:"2px 6px 4px",position:"relative","& [name=close]":{position:"absolute",top:"0",right:"4px",backgroundColor:"inherit",border:"none",font:"inherit",padding:0,margin:0},"& input, & button, & label":{margin:".2em .6em .2em 0"},"& input[type=checkbox]":{marginRight:".2em"},"& label":{fontSize:"80%",whiteSpace:"pre"}},"&light .cm-searchMatch":{backgroundColor:"#ffff0054"},"&dark .cm-searchMatch":{backgroundColor:"#00ffff8a"},"&light .cm-searchMatch-selected":{backgroundColor:"#ff6a0054"},"&dark .cm-searchMatch-selected":{backgroundColor:"#ff00ff8a"}}),Ao=[T,Mn.low(po),bo];class nt{constructor(e,r,n){this.from=e,this.to=r,this.diagnostic=n}}class F{constructor(e,r,n){this.diagnostics=e,this.panel=r,this.selected=n}static init(e,r,n){let o=n.facet(Y).markerFilter;o&&(e=o(e,n));let i=e.slice().sort((m,g)=>m.from-g.from||m.to-g.to),l=new dt,s=[],c=0,a=n.doc.iter(),h=0,f=n.doc.length;for(let m=0;;){let g=m==i.length?null:i[m];if(!g&&!s.length)break;let S,x;if(s.length)S=c,x=s.reduce((y,P)=>Math.min(y,P.to),g&&g.from>S?g.from:1e8);else{if(S=g.from,S>f)break;x=g.to,s.push(g),m++}for(;m<i.length;){let y=i[m];if(y.from==S&&(y.to>y.from||y.to==S))s.push(y),m++,x=Math.min(y.to,x);else{x=Math.min(y.from,x);break}}x=Math.min(x,f);let te=!1;if(s.some(y=>y.from==S&&(y.to==x||x==f))&&(te=S==x,!te&&x-S<10)){let y=S-(h+a.value.length);y>0&&(a.next(y),h=S);for(let P=S;;){if(P>=x){te=!0;break}if(!a.lineBreak&&h+a.value.length>P)break;P=h+a.value.length,h+=a.value.length,a.next()}}let Ue=Oo(s);if(te)l.add(S,S,k.widget({widget:new wo(Ue),diagnostics:s.slice()}));else{let y=s.reduce((P,ze)=>ze.markClass?P+" "+ze.markClass:P,"");l.add(S,x,k.mark({class:"cm-lintRange cm-lintRange-"+Ue+y,diagnostics:s.slice(),inclusiveEnd:s.some(P=>P.to>x)}))}if(c=x,c==f)break;for(let y=0;y<s.length;y++)s[y].to<=c&&s.splice(y--,1)}let d=l.finish();return new F(d,r,z(d))}}function z(t,e=null,r=0){let n=null;return t.between(r,1e9,(o,i,{spec:l})=>{if(!(e&&l.diagnostics.indexOf(e)<0))if(!n)n=new nt(o,i,e||l.diagnostics[0]);else{if(l.diagnostics.indexOf(n.diagnostic)<0)return!1;n=new nt(n.from,i,n.diagnostic)}}),n}function Co(t,e){let r=e.pos,n=e.end||r,o=t.state.facet(Y).hideOn(t,r,n);if(o!=null)return o;let i=t.startState.doc.lineAt(e.pos);return!!(t.effects.some(l=>l.is(cn))||t.changes.touchesRange(i.from,Math.max(i.to,n)))}function Mo(t,e){return t.field(L,!1)?e:e.concat(R.appendConfig.of(Fo))}const cn=R.define(),$e=R.define(),an=R.define(),L=de.define({create(){return new F(k.none,null,null)},update(t,e){if(e.docChanged&&t.diagnostics.size){let r=t.diagnostics.map(e.changes),n=null,o=t.panel;if(t.selected){let i=e.changes.mapPos(t.selected.from,1);n=z(r,t.selected.diagnostic,i)||z(r,null,i)}!r.size&&o&&e.state.facet(Y).autoPanel&&(o=null),t=new F(r,o,n)}for(let r of e.effects)if(r.is(cn)){let n=e.state.facet(Y).autoPanel?r.value.length?j.open:null:t.panel;t=F.init(r.value,n,e.state)}else r.is($e)?t=new F(t.diagnostics,r.value?j.open:null,t.selected):r.is(an)&&(t=new F(t.diagnostics,t.panel,r.value));return t},provide:t=>[we.from(t,e=>e.panel),b.decorations.from(t,e=>e.diagnostics)]}),Lo=k.mark({class:"cm-lintRange cm-lintRange-active"});function vo(t,e,r){let{diagnostics:n}=t.state.field(L),o,i=-1,l=-1;n.between(e-(r<0?1:0),e+(r>0?1:0),(c,a,{spec:h})=>{if(e>=c&&e<=a&&(c==a||(e>c||r>0)&&(e<a||r<0)))return o=h.diagnostics,i=c,l=a,!1});let s=t.state.facet(Y).tooltipFilter;return o&&s&&(o=s(o,t.state)),o?{pos:i,end:l,above:t.state.doc.lineAt(i).to<l,create(){return{dom:Do(t,o)}}}:null}function Do(t,e){return p("ul",{class:"cm-tooltip-lint"},e.map(r=>fn(t,r,!1)))}const Bo=t=>{let e=t.state.field(L,!1);(!e||!e.panel)&&t.dispatch({effects:Mo(t.state,[$e.of(!0)])});let r=_(t,j.open);return r&&r.dom.querySelector(".cm-panel-lint ul").focus(),!0},rt=t=>{let e=t.state.field(L,!1);return!e||!e.panel?!1:(t.dispatch({effects:$e.of(!1)}),!0)},Ro=t=>{let e=t.state.field(L,!1);if(!e)return!1;let r=t.state.selection.main,n=e.diagnostics.iter(r.to+1);return!n.value&&(n=e.diagnostics.iter(0),!n.value||n.from==r.from&&n.to==r.to)?!1:(t.dispatch({selection:{anchor:n.from,head:n.to},scrollIntoView:!0}),!0)},Eo=[{key:"Mod-Shift-m",run:Bo,preventDefault:!0},{key:"F8",run:Ro}],Y=Z.define({combine(t){return{sources:t.map(e=>e.source).filter(e=>e!=null),...me(t.map(e=>e.config),{delay:750,markerFilter:null,tooltipFilter:null,needsRefresh:null,hideOn:()=>null},{delay:Math.max,markerFilter:ot,tooltipFilter:ot,needsRefresh:(e,r)=>e?r?n=>e(n)||r(n):e:r,hideOn:(e,r)=>e?r?(n,o,i)=>e(n,o,i)||r(n,o,i):e:r,autoPanel:(e,r)=>e||r})}}});function ot(t,e){return t?e?(r,n)=>e(t(r,n),n):t:e}function hn(t){let e=[];if(t)e:for(let{name:r}of t){for(let n=0;n<r.length;n++){let o=r[n];if(/[a-zA-Z]/.test(o)&&!e.some(i=>i.toLowerCase()==o.toLowerCase())){e.push(o);continue e}}e.push("")}return e}function fn(t,e,r){var n;let o=r?hn(e.actions):[];return p("li",{class:"cm-diagnostic cm-diagnostic-"+e.severity},p("span",{class:"cm-diagnosticText"},e.renderMessage?e.renderMessage(t):e.message),(n=e.actions)===null||n===void 0?void 0:n.map((i,l)=>{let s=!1,c=m=>{if(m.preventDefault(),s)return;s=!0;let g=z(t.state.field(L).diagnostics,e);g&&i.apply(t,g.from,g.to)},{name:a}=i,h=o[l]?a.indexOf(o[l]):-1,f=h<0?a:[a.slice(0,h),p("u",a.slice(h,h+1)),a.slice(h+1)],d=i.markClass?" "+i.markClass:"";return p("button",{type:"button",class:"cm-diagnosticAction"+d,onclick:c,onmousedown:c,"aria-label":` Action: ${a}${h<0?"":` (access key "${o[l]})"`}.`},f)}),e.source&&p("div",{class:"cm-diagnosticSource"},e.source))}class wo extends pn{constructor(e){super(),this.sev=e}eq(e){return e.sev==this.sev}toDOM(){return p("span",{class:"cm-lintPoint cm-lintPoint-"+this.sev})}}class it{constructor(e,r){this.diagnostic=r,this.id="item_"+Math.floor(Math.random()*4294967295).toString(16),this.dom=fn(e,r,!0),this.dom.id=this.id,this.dom.setAttribute("role","option")}}class j{constructor(e){this.view=e,this.items=[];let r=o=>{if(o.keyCode==27)rt(this.view),this.view.focus();else if(o.keyCode==38||o.keyCode==33)this.moveSelection((this.selectedIndex-1+this.items.length)%this.items.length);else if(o.keyCode==40||o.keyCode==34)this.moveSelection((this.selectedIndex+1)%this.items.length);else if(o.keyCode==36)this.moveSelection(0);else if(o.keyCode==35)this.moveSelection(this.items.length-1);else if(o.keyCode==13)this.view.focus();else if(o.keyCode>=65&&o.keyCode<=90&&this.selectedIndex>=0){let{diagnostic:i}=this.items[this.selectedIndex],l=hn(i.actions);for(let s=0;s<l.length;s++)if(l[s].toUpperCase().charCodeAt(0)==o.keyCode){let c=z(this.view.state.field(L).diagnostics,i);c&&i.actions[s].apply(e,c.from,c.to)}}else return;o.preventDefault()},n=o=>{for(let i=0;i<this.items.length;i++)this.items[i].dom.contains(o.target)&&this.moveSelection(i)};this.list=p("ul",{tabIndex:0,role:"listbox","aria-label":this.view.state.phrase("Diagnostics"),onkeydown:r,onclick:n}),this.dom=p("div",{class:"cm-panel-lint"},this.list,p("button",{type:"button",name:"close","aria-label":this.view.state.phrase("close"),onclick:()=>rt(this.view)},"×")),this.update()}get selectedIndex(){let e=this.view.state.field(L).selected;if(!e)return-1;for(let r=0;r<this.items.length;r++)if(this.items[r].diagnostic==e.diagnostic)return r;return-1}update(){let{diagnostics:e,selected:r}=this.view.state.field(L),n=0,o=!1,i=null,l=new Set;for(e.between(0,this.view.state.doc.length,(s,c,{spec:a})=>{for(let h of a.diagnostics){if(l.has(h))continue;l.add(h);let f=-1,d;for(let m=n;m<this.items.length;m++)if(this.items[m].diagnostic==h){f=m;break}f<0?(d=new it(this.view,h),this.items.splice(n,0,d),o=!0):(d=this.items[f],f>n&&(this.items.splice(n,f-n),o=!0)),r&&d.diagnostic==r.diagnostic?d.dom.hasAttribute("aria-selected")||(d.dom.setAttribute("aria-selected","true"),i=d):d.dom.hasAttribute("aria-selected")&&d.dom.removeAttribute("aria-selected"),n++}});n<this.items.length&&!(this.items.length==1&&this.items[0].diagnostic.from<0);)o=!0,this.items.pop();this.items.length==0&&(this.items.push(new it(this.view,{from:-1,to:-1,severity:"info",message:this.view.state.phrase("No diagnostics")})),o=!0),i?(this.list.setAttribute("aria-activedescendant",i.id),this.view.requestMeasure({key:this,read:()=>({sel:i.dom.getBoundingClientRect(),panel:this.list.getBoundingClientRect()}),write:({sel:s,panel:c})=>{let a=c.height/this.list.offsetHeight;s.top<c.top?this.list.scrollTop-=(c.top-s.top)/a:s.bottom>c.bottom&&(this.list.scrollTop+=(s.bottom-c.bottom)/a)}})):this.selectedIndex<0&&this.list.removeAttribute("aria-activedescendant"),o&&this.sync()}sync(){let e=this.list.firstChild;function r(){let n=e;e=n.nextSibling,n.remove()}for(let n of this.items)if(n.dom.parentNode==this.list){for(;e!=n.dom;)r();e=n.dom.nextSibling}else this.list.insertBefore(n.dom,e);for(;e;)r()}moveSelection(e){if(this.selectedIndex<0)return;let r=this.view.state.field(L),n=z(r.diagnostics,this.items[e].diagnostic);n&&this.view.dispatch({selection:{anchor:n.from,head:n.to},scrollIntoView:!0,effects:an.of(n)})}static open(e){return new j(e)}}function Po(t,e='viewBox="0 0 40 40"'){return`url('data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" ${e}>${encodeURIComponent(t)}</svg>')`}function ie(t){return Po(`<path d="m0 2.5 l2 -1.5 l1 0 l2 1.5 l1 0" stroke="${t}" fill="none" stroke-width=".7"/>`,'width="6" height="3"')}const Io=b.baseTheme({".cm-diagnostic":{padding:"3px 6px 3px 8px",marginLeft:"-1px",display:"block",whiteSpace:"pre-wrap"},".cm-diagnostic-error":{borderLeft:"5px solid #d11"},".cm-diagnostic-warning":{borderLeft:"5px solid orange"},".cm-diagnostic-info":{borderLeft:"5px solid #999"},".cm-diagnostic-hint":{borderLeft:"5px solid #66d"},".cm-diagnosticAction":{font:"inherit",border:"none",padding:"2px 4px",backgroundColor:"#444",color:"white",borderRadius:"3px",marginLeft:"8px",cursor:"pointer"},".cm-diagnosticSource":{fontSize:"70%",opacity:.7},".cm-lintRange":{backgroundPosition:"left bottom",backgroundRepeat:"repeat-x",paddingBottom:"0.7px"},".cm-lintRange-error":{backgroundImage:ie("#d11")},".cm-lintRange-warning":{backgroundImage:ie("orange")},".cm-lintRange-info":{backgroundImage:ie("#999")},".cm-lintRange-hint":{backgroundImage:ie("#66d")},".cm-lintRange-active":{backgroundColor:"#ffdd9980"},".cm-tooltip-lint":{padding:0,margin:0},".cm-lintPoint":{position:"relative","&:after":{content:'""',position:"absolute",bottom:0,left:"-2px",borderLeft:"3px solid transparent",borderRight:"3px solid transparent",borderBottom:"4px solid #d11"}},".cm-lintPoint-warning":{"&:after":{borderBottomColor:"orange"}},".cm-lintPoint-info":{"&:after":{borderBottomColor:"#999"}},".cm-lintPoint-hint":{"&:after":{borderBottomColor:"#66d"}},".cm-panel.cm-panel-lint":{position:"relative","& ul":{maxHeight:"100px",overflowY:"auto","& [aria-selected]":{backgroundColor:"#ddd","& u":{textDecoration:"underline"}},"&:focus [aria-selected]":{background_fallback:"#bdf",backgroundColor:"Highlight",color_fallback:"white",color:"HighlightText"},"& u":{textDecoration:"none"},padding:0,margin:0},"& [name=close]":{position:"absolute",top:"0",right:"2px",background:"inherit",border:"none",font:"inherit",padding:0,margin:0}}});function To(t){return t=="error"?4:t=="warning"?3:t=="info"?2:1}function Oo(t){let e="hint",r=1;for(let n of t){let o=To(n.severity);o>r&&(r=o,e=n.severity)}return e}const Fo=[L,b.decorations.compute([L],t=>{let{selected:e,panel:r}=t.field(L);return!e||!r||e.from==e.to?k.none:k.set([Lo.range(e.from,e.to)])}),mn(vo,{hideOn:Co}),Io],Uo=[gn(),yn(),st(),bt(),Rn(),ct(),xn(),ut.allowMultipleSelections.of(!0),En(),gt(yt,{fallback:!0}),wn(),In(),Tn(),kn(),Sn(),bn(),Xr(),at.of([...On,...jt,...ko,...Lt,...Pn,...Fn,...Eo])],zo=[st(),bt(),ct(),gt(yt,{fallback:!0}),at.of([...jt,...Lt])];export{b as EditorView,Uo as basicSetup,zo as minimalSetup};
