const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["./BaLj8HaF.js","./BJrbMhgq.js","./zngUhAbX.js","./bH9uCY5d.js","./DSDy7V6L.js","./D6bpRoeh.js","./AwXmWqiV.js","./-suHlTGB.js"])))=>i.map(i=>d[i]);
import{b as L0,d as H_,f as Le,a as j,e as nt,t as tb,c as Je}from"./cbbg3mAR.js";import{a as Ai,o as Du,w as an,g as Ze,d as Pa}from"./DKo6twJq.js";import{aJ as n1,aK as nb,aL as U_,h as Li,M as ph,aM as W_,b as i1,O as uu,H as ou,a as Yf,n as p,aA as V_,au as G_,a2 as X_,ab as M0,an as yc,f as pc,a1 as r1,as as Y_,a9 as T0,c as nu,e as _d,s as K_,aN as ib,aq as s1,Z as D0,U as Z_,aO as J_,aP as Q_,aQ as $_,aR as Jo,r as rb,p as sb,aS as $p,a0 as a1,al as gh,aT as e3,ap as t3,d as mh,x as Ae,K as ab,aU as n3,at as i3,am as r3,E as s3,aV as a3,L as o3,av as Ou,aW as l3,ai as ob,aG as c3,C as Qs,j as ea,aX as u3,aY as d3,aZ as f3,_ as lb,o as h3,D as p3,a_ as cb,a$ as g3,b0 as m3,ah as v3,b1 as y3,b2 as b3,b3 as w3,b4 as x3,b5 as _3,b6 as S3,b7 as k3,b8 as A3,b9 as N3,W as ub,ba as C3,bb as db,bc as P3,bd as o1,v as Mt,u as fb,y as Tt,z as ne,A as Q,X as re,be as Mc,w as He,B as we,aa as Mi,bf as hb,i as pn,V as Fe,P as $,bg as is,bh as $n,bi as E3,aB as Rn,bj as I3,bk as L3}from"./WhGNZ2BR.js";import{a as M3,i as T3,c as D3,d as Xn,n as O3,b as F3,s as Ht,e as R3,o as dm,f as yn,r as B3}from"./BaO-Nwd6.js";import{p as ot,r as Tc,i as Se,b as Fi,c as l1,s as vh,_ as gs,a as z3,d as O0}from"./DavcfYcS.js";import{b as hd}from"./Djc7INc8.js";import{B as q3}from"./jHqPq_a7.js";import{s as vs}from"./CW9PBbOt.js";import{i as j3}from"./DOnNWnzK.js";const H3=[];function pb(t,e=!1,n=!1){return Kf(t,new Map,"",H3,null,n)}function Kf(t,e,n,i,r=null,s=!1){if(typeof t=="object"&&t!==null){var a=e.get(t);if(a!==void 0)return a;if(t instanceof Map)return new Map(t);if(t instanceof Set)return new Set(t);if(n1(t)){var o=Array(t.length);e.set(t,o),r!==null&&e.set(r,o);for(var l=0;l<t.length;l+=1){var c=t[l];l in t&&(o[l]=Kf(c,e,n,i,null,s))}return o}if(nb(t)===U_){o={},e.set(t,o),r!==null&&e.set(r,o);for(var u in t)o[u]=Kf(t[u],e,n,i,null,s);return o}if(t instanceof Date)return structuredClone(t);if(typeof t.toJSON=="function"&&!s)return Kf(t.toJSON(),e,n,i,t)}if(t instanceof EventTarget)return t;try{return structuredClone(t)}catch{return t}}function F0(t,e,n){Li&&ph();var i=new q3(t),r=!W_();i1(()=>{var s=e();r&&s!==null&&typeof s=="object"&&(s={}),i.ensure(s,n)})}function Cn(t,e){return e}function U3(t,e,n){for(var i=[],r=e.length,s,a=e.length,o=0;o<r;o++){let f=e[o];sb(f,()=>{if(s){if(s.pending.delete(f),s.done.add(f),s.pending.size===0){var h=t.outrogroups;fm(s1(s.done)),h.delete(s),h.size===0&&(t.outrogroups=null)}}else a-=1},!1)}if(a===0){var l=i.length===0&&n!==null;if(l){var c=n,u=c.parentNode;t3(u),u.append(c),t.items.clear()}fm(e,!l)}else s={pending:new Set(e),done:new Set},(t.outrogroups??=new Set).add(s)}function fm(t,e=!0){for(var n=0;n<t.length;n++)mh(t[n],e)}var R0;function cn(t,e,n,i,r,s=null){var a=t,o=new Map,l=(e&ib)!==0;if(l){var c=t;a=Li?uu(ou(c)):c.appendChild(Yf())}Li&&ph();var u=null,f=V_(()=>{var w=n();return n1(w)?w:w==null?[]:s1(w)}),h,d=!0;function y(){x.fallback=u,W3(x,h,a,e,i),u!==null&&(h.length===0?(u.f&Jo)===0?rb(u):(u.f^=Jo,id(u,null,a)):sb(u,()=>{u=null}))}var m=i1(()=>{h=p(f);var w=h.length;let S=!1;if(Li){var A=G_(a)===X_;A!==(w===0)&&(a=M0(),uu(a),yc(!1),S=!0)}for(var _=new Set,M=nu,I=K_(),T=0;T<w;T+=1){Li&&pc.nodeType===r1&&pc.data===Y_&&(a=pc,S=!0,yc(!1));var D=h[T],O=i(D,T),W=d?null:o.get(O);W?(W.v&&T0(W.v,D),W.i&&T0(W.i,T),I&&M.skipped_effects.delete(W.e)):(W=V3(o,d?a:R0??=Yf(),D,O,T,r,e,n),d||(W.e.f|=Jo),o.set(O,W)),_.add(O)}if(w===0&&s&&!u&&(d?u=_d(()=>s(a)):(u=_d(()=>s(R0??=Yf())),u.f|=Jo)),Li&&w>0&&uu(M0()),!d)if(I){for(const[C,N]of o)_.has(C)||M.skipped_effects.add(N.e);M.oncommit(y),M.ondiscard(()=>{})}else y();S&&yc(!0),p(f)}),x={effect:m,items:o,outrogroups:null,fallback:u};d=!1,Li&&(a=pc)}function W3(t,e,n,i,r){var s=(i&e3)!==0,a=e.length,o=t.items,l=t.effect.first,c,u=null,f,h=[],d=[],y,m,x,w;if(s)for(w=0;w<a;w+=1)y=e[w],m=r(y,w),x=o.get(m).e,(x.f&Jo)===0&&(x.nodes?.a?.measure(),(f??=new Set).add(x));for(w=0;w<a;w+=1){if(y=e[w],m=r(y,w),x=o.get(m).e,t.outrogroups!==null)for(const W of t.outrogroups)W.pending.delete(x),W.done.delete(x);if((x.f&Jo)!==0)if(x.f^=Jo,x===l)id(x,null,n);else{var S=u?u.next:l;x===t.effect.last&&(t.effect.last=x.prev),x.prev&&(x.prev.next=x.next),x.next&&(x.next.prev=x.prev),El(t,u,x),El(t,x,S),id(x,S,n),u=x,h=[],d=[],l=u.next;continue}if((x.f&$p)!==0&&(rb(x),s&&(x.nodes?.a?.unfix(),(f??=new Set).delete(x))),x!==l){if(c!==void 0&&c.has(x)){if(h.length<d.length){var A=d[0],_;u=A.prev;var M=h[0],I=h[h.length-1];for(_=0;_<h.length;_+=1)id(h[_],A,n);for(_=0;_<d.length;_+=1)c.delete(d[_]);El(t,M.prev,I.next),El(t,u,M),El(t,I,A),l=A,u=I,w-=1,h=[],d=[]}else c.delete(x),id(x,l,n),El(t,x.prev,x.next),El(t,x,u===null?t.effect.first:u.next),El(t,u,x),u=x;continue}for(h=[],d=[];l!==null&&l!==x;)(c??=new Set).add(l),d.push(l),l=l.next;if(l===null)continue}(x.f&Jo)===0&&h.push(x),u=x,l=x.next}if(t.outrogroups!==null){for(const W of t.outrogroups)W.pending.size===0&&(fm(s1(W.done)),t.outrogroups?.delete(W));t.outrogroups.size===0&&(t.outrogroups=null)}if(l!==null||c!==void 0){var T=[];if(c!==void 0)for(x of c)(x.f&$p)===0&&T.push(x);for(;l!==null;)(l.f&$p)===0&&l!==t.fallback&&T.push(l),l=l.next;var D=T.length;if(D>0){var O=(i&ib)!==0&&a===0?n:null;if(s){for(w=0;w<D;w+=1)T[w].nodes?.a?.measure();for(w=0;w<D;w+=1)T[w].nodes?.a?.fix()}U3(t,T,O)}}s&&a1(()=>{if(f!==void 0)for(x of f)x.nodes?.a?.apply()})}function V3(t,e,n,i,r,s,a,o){var l=(a&Q_)!==0?(a&$_)===0?Z_(n,!1,!1):D0(n):null,c=(a&J_)!==0?D0(r):null;return{v:l,i:c,e:_d(()=>(s(e,l??n,c??r,o),()=>{t.delete(i)}))}}function id(t,e,n){if(t.nodes)for(var i=t.nodes.start,r=t.nodes.end,s=e&&(e.f&Jo)===0?e.nodes.start:n;i!==null;){var a=gh(i);if(s.before(i),i===r)return;i=a}}function El(t,e,n){e===null?t.effect.first=n:e.next=n,n===null?t.effect.last=e:n.prev=e}function c1(t,e,n=!1,i=!1,r=!1){var s=t,a="";Ae(()=>{var o=ab;if(a===(a=e()??"")){Li&&ph();return}if(o.nodes!==null&&(n3(o.nodes.start,o.nodes.end),o.nodes=null),a!==""){if(Li){pc.data;for(var l=ph(),c=l;l!==null&&(l.nodeType!==r1||l.data!=="");)c=l,l=gh(l);if(l===null)throw i3(),r3;L0(pc,c),s=uu(l);return}var u=a+"";n?u=`<svg>${u}</svg>`:i&&(u=`<math>${u}</math>`);var f=H_(u);if((n||i)&&(f=ou(f)),L0(ou(f),f.lastChild),n||i)for(;ou(f);)s.before(ou(f));else s.before(f)}})}const G3=()=>performance.now(),Ko={tick:t=>requestAnimationFrame(t),now:()=>G3(),tasks:new Set};function gb(){const t=Ko.now();Ko.tasks.forEach(e=>{e.c(t)||(Ko.tasks.delete(e),e.f())}),Ko.tasks.size!==0&&Ko.tick(gb)}function X3(t){let e;return Ko.tasks.size===0&&Ko.tick(gb),{promise:new Promise(n=>{Ko.tasks.add(e={c:t,f:n})}),abort(){Ko.tasks.delete(e)}}}function bf(t,e){ob(()=>{t.dispatchEvent(new CustomEvent(e))})}function Y3(t){if(t==="float")return"cssFloat";if(t==="offset")return"cssOffset";if(t.startsWith("--"))return t;const e=t.split("-");return e.length===1?e[0]:e[0]+e.slice(1).map(n=>n[0].toUpperCase()+n.slice(1)).join("")}function B0(t){const e={},n=t.split(";");for(const i of n){const[r,s]=i.split(":");if(!r||s===void 0)break;const a=Y3(r.trim());e[a]=s.trim()}return e}const K3=t=>t;function On(t,e,n,i){var r=(t&u3)!==0,s=(t&d3)!==0,a=r&&s,o=(t&l3)!==0,l=a?"both":r?"in":"out",c,u=e.inert,f=e.style.overflow,h,d;function y(){return ob(()=>c??=n()(e,i?.()??{},{direction:l}))}var m={is_global:o,in(){if(e.inert=u,!r){d?.abort(),d?.reset?.();return}s||h?.abort(),bf(e,"introstart"),h=hm(e,y(),d,1,()=>{bf(e,"introend"),h?.abort(),h=c=void 0,e.style.overflow=f})},out(A){if(!s){A?.(),c=void 0;return}e.inert=!0,bf(e,"outrostart"),d=hm(e,y(),h,0,()=>{bf(e,"outroend"),A?.()})},stop:()=>{h?.abort(),d?.abort()}},x=ab;if((x.nodes.t??=[]).push(m),r&&M3){var w=o;if(!w){for(var S=x.parent;S&&(S.f&s3)!==0;)for(;(S=S.parent)&&(S.f&a3)===0;);w=!S||(S.f&o3)!==0}w&&Ou(()=>{ea(()=>m.in())})}}function hm(t,e,n,i,r){var s=i===1;if(c3(e)){var a,o=!1;return a1(()=>{if(!o){var x=e({direction:s?"in":"out"});a=hm(t,x,n,i,r)}}),{abort:()=>{o=!0,a?.abort()},deactivate:()=>a.deactivate(),reset:()=>a.reset(),t:()=>a.t()}}if(n?.deactivate(),!e?.duration)return r(),{abort:Qs,deactivate:Qs,reset:Qs,t:()=>i};const{delay:l=0,css:c,tick:u,easing:f=K3}=e;var h=[];if(s&&n===void 0&&(u&&u(0,1),c)){var d=B0(c(0,1));h.push(d,d)}var y=()=>1-i,m=t.animate(h,{duration:l,fill:"forwards"});return m.onfinish=()=>{m.cancel();var x=n?.t()??1-i;n?.abort();var w=i-x,S=e.duration*Math.abs(w),A=[];if(S>0){var _=!1;if(c)for(var M=Math.ceil(S/16.666666666666668),I=0;I<=M;I+=1){var T=x+w*f(I/M),D=B0(c(T,1-T));A.push(D),_||=D.overflow==="hidden"}_&&(t.style.overflow="hidden"),y=()=>{var O=m.currentTime;return x+w*f(O/S)},u&&X3(()=>{if(m.playState!=="running")return!1;var O=y();return u(O,1-O),!0})}m=t.animate(A,{duration:S,fill:"forwards"}),m.onfinish=()=>{y=()=>i,u?.(i,1-i),r()}},{abort:()=>{m&&(m.cancel(),m.effect=null,m.onfinish=Qs)},deactivate:()=>{r=Qs},reset:()=>{i===0&&u?.(1,0)},t:()=>y()}}function Zh(t,e){let n=null,i=Li;var r;if(Li){n=pc;for(var s=ou(document.head);s!==null&&(s.nodeType!==r1||s.data!==t);)s=gh(s);if(s===null)yc(!1);else{var a=gh(s);s.remove(),uu(a)}}Li||(r=document.head.appendChild(Yf()));try{i1(()=>e(r),f3)}finally{i&&(yc(!0),uu(n))}}function mt(t,e,n){Ou(()=>{var i=ea(()=>e(t,n?.())||{});if(n&&i?.update){var r=!1,s={};lb(()=>{var a=n();h3(a),r&&p3(s,a)&&(s=a,i.update(a))}),r=!0}if(i?.destroy)return()=>i.destroy()})}function Z3(t,e){var n=void 0,i;cb(()=>{n!==(n=e())&&(i&&(mh(i),i=null),n&&(i=_d(()=>{Ou(()=>n(t))})))})}function mb(t){var e,n,i="";if(typeof t=="string"||typeof t=="number")i+=t;else if(typeof t=="object")if(Array.isArray(t)){var r=t.length;for(e=0;e<r;e++)t[e]&&(n=mb(t[e]))&&(i&&(i+=" "),i+=n)}else for(n in t)t[n]&&(i&&(i+=" "),i+=n);return i}function J3(){for(var t,e,n=0,i="",r=arguments.length;n<r;n++)(t=arguments[n])&&(e=mb(t))&&(i&&(i+=" "),i+=e);return i}function Dc(t){return typeof t=="object"?J3(t):t??""}const z0=[...` 	
\r\fÂ \v\uFEFF`];function Q3(t,e,n){var i=t==null?"":""+t;if(e&&(i=i?i+" "+e:e),n){for(var r in n)if(n[r])i=i?i+" "+r:r;else if(i.length)for(var s=r.length,a=0;(a=i.indexOf(r,a))>=0;){var o=a+s;(a===0||z0.includes(i[a-1]))&&(o===i.length||z0.includes(i[o]))?i=(a===0?"":i.substring(0,a))+i.substring(o+1):a=o}}return i===""?null:i}function q0(t,e=!1){var n=e?" !important;":";",i="";for(var r in t){var s=t[r];s!=null&&s!==""&&(i+=" "+r+": "+s+n)}return i}function eg(t){return t[0]!=="-"||t[1]!=="-"?t.toLowerCase():t}function $3(t,e){if(e){var n="",i,r;if(Array.isArray(e)?(i=e[0],r=e[1]):i=e,t){t=String(t).replaceAll(/\s*\/\*.*?\*\/\s*/g,"").trim();var s=!1,a=0,o=!1,l=[];i&&l.push(...Object.keys(i).map(eg)),r&&l.push(...Object.keys(r).map(eg));var c=0,u=-1;const m=t.length;for(var f=0;f<m;f++){var h=t[f];if(o?h==="/"&&t[f-1]==="*"&&(o=!1):s?s===h&&(s=!1):h==="/"&&t[f+1]==="*"?o=!0:h==='"'||h==="'"?s=h:h==="("?a++:h===")"&&a--,!o&&s===!1&&a===0){if(h===":"&&u===-1)u=f;else if(h===";"||f===m-1){if(u!==-1){var d=eg(t.substring(c,u).trim());if(!l.includes(d)){h!==";"&&f++;var y=t.substring(c,f).trim();n+=" "+y+";"}}c=f+1,u=-1}}}}return i&&(n+=q0(i)),r&&(n+=q0(r,!0)),n=n.trim(),n===""?null:n}return t==null?null:String(t)}function Xt(t,e,n,i,r,s){var a=t.__className;if(Li||a!==n||a===void 0){var o=Q3(n,i,s);(!Li||o!==t.getAttribute("class"))&&(o==null?t.removeAttribute("class"):e?t.className=o:t.setAttribute("class",o)),t.__className=n}else if(s&&r!==s)for(var l in s){var c=!!s[l];(r==null||c!==!!r[l])&&t.classList.toggle(l,c)}return s}function tg(t,e={},n,i){for(var r in n){var s=n[r];e[r]!==s&&(n[r]==null?t.style.removeProperty(r):t.style.setProperty(r,s,i))}}function Nn(t,e,n,i){var r=t.__style;if(Li||r!==e){var s=$3(e,i);(!Li||s!==t.getAttribute("style"))&&(s==null?t.removeAttribute("style"):t.style.cssText=s),t.__style=e}else i&&(Array.isArray(i)?(tg(t,n?.[0],i[0]),tg(t,n?.[1],i[1],"important")):tg(t,n,i));return i}function yh(t,e,n=!1){if(t.multiple){if(e==null)return;if(!n1(e))return g3();for(var i of t.options)i.selected=e.includes(j0(i));return}for(i of t.options){var r=j0(i);if(m3(r,e)){i.selected=!0;return}}(!n||e!==void 0)&&(t.selectedIndex=-1)}function vb(t){var e=new MutationObserver(()=>{yh(t,t.__value)});e.observe(t,{childList:!0,subtree:!0,attributes:!0,attributeFilter:["value"]}),v3(()=>{e.disconnect()})}function j0(t){return"__value"in t?t.__value:t.value}const zl=Symbol("class"),Zo=Symbol("style"),yb=Symbol("is custom element"),bb=Symbol("is html");function jr(t){if(Li){var e=!1,n=()=>{if(!e){if(e=!0,t.hasAttribute("value")){var i=t.value;he(t,"value",null),t.value=i}if(t.hasAttribute("checked")){var r=t.checked;he(t,"checked",null),t.checked=r}}};t.__on_r=n,a1(n),_3()}}function ms(t,e){var n=u1(t);n.value===(n.value=e??void 0)||t.value===e&&(e!==0||t.nodeName!=="PROGRESS")||(t.value=e??"")}function eS(t,e){e?t.hasAttribute("selected")||t.setAttribute("selected",""):t.removeAttribute("selected")}function he(t,e,n,i){var r=u1(t);Li&&(r[e]=t.getAttribute(e),e==="src"||e==="srcset"||e==="href"&&t.nodeName==="LINK")||r[e]!==(r[e]=n)&&(e==="loading"&&(t[k3]=n),n==null?t.removeAttribute(e):typeof n!="string"&&wb(t).includes(e)?t[e]=n:t.setAttribute(e,n))}function tS(t,e,n,i,r=!1,s=!1){if(Li&&r&&t.tagName==="INPUT"){var a=t,o=a.type==="checkbox"?"defaultChecked":"defaultValue";o in n||jr(a)}var l=u1(t),c=l[yb],u=!l[bb];let f=Li&&c;f&&yc(!1);var h=e||{},d=t.tagName==="OPTION";for(var y in e)y in n||(n[y]=null);n.class?n.class=Dc(n.class):(i||n[zl])&&(n.class=null),n[Zo]&&(n.style??=null);var m=wb(t);for(const I in n){let T=n[I];if(d&&I==="value"&&T==null){t.value=t.__value="",h[I]=T;continue}if(I==="class"){var x=t.namespaceURI==="http://www.w3.org/1999/xhtml";Xt(t,x,T,i,e?.[zl],n[zl]),h[I]=T,h[zl]=n[zl];continue}if(I==="style"){Nn(t,T,e?.[Zo],n[Zo]),h[I]=T,h[Zo]=n[Zo];continue}var w=h[I];if(!(T===w&&!(T===void 0&&t.hasAttribute(I)))){h[I]=T;var S=I[0]+I[1];if(S!=="$$")if(S==="on"){const D={},O="$$"+I;let W=I.slice(2);var A=F3(W);if(T3(W)&&(W=W.slice(0,-7),D.capture=!0),!A&&w){if(T!=null)continue;t.removeEventListener(W,h[O],D),h[O]=null}if(T!=null)if(A)t[`__${W}`]=T,Xn([W]);else{let C=function(N){h[I].call(this,N)};h[O]=D3(W,t,C,D)}else A&&(t[`__${W}`]=void 0)}else if(I==="style")he(t,I,T);else if(I==="autofocus")w3(t,!!T);else if(!c&&(I==="__value"||I==="value"&&T!=null))t.value=t.__value=T;else if(I==="selected"&&d)eS(t,T);else{var _=I;u||(_=O3(_));var M=_==="defaultValue"||_==="defaultChecked";if(T==null&&!c&&!M)if(l[I]=null,_==="value"||_==="checked"){let D=t;const O=e===void 0;if(_==="value"){let W=D.defaultValue;D.removeAttribute(_),D.defaultValue=W,D.value=D.__value=O?W:null}else{let W=D.defaultChecked;D.removeAttribute(_),D.defaultChecked=W,D.checked=O?W:!1}}else t.removeAttribute(I);else M||m.includes(_)&&(c||typeof T!="string")?(t[_]=T,_ in l&&(l[_]=x3)):typeof T!="function"&&he(t,_,T)}}}return f&&yc(!0),h}function Kl(t,e,n=[],i=[],r=[],s,a=!1,o=!1){y3(r,n,i,l=>{var c=void 0,u={},f=t.nodeName==="SELECT",h=!1;if(cb(()=>{var y=e(...l.map(p)),m=tS(t,c,y,s,a,o);h&&f&&"value"in y&&yh(t,y.value);for(let w of Object.getOwnPropertySymbols(u))y[w]||mh(u[w]);for(let w of Object.getOwnPropertySymbols(y)){var x=y[w];w.description===b3&&(!c||x!==c[w])&&(u[w]&&mh(u[w]),u[w]=_d(()=>Z3(t,()=>x))),m[w]=x}c=m}),f){var d=t;Ou(()=>{yh(d,c.value,!0),vb(d)})}h=!0})}function u1(t){return t.__attributes??={[yb]:t.nodeName.includes("-"),[bb]:t.namespaceURI===S3}}var H0=new Map;function wb(t){var e=t.getAttribute("is")||t.nodeName,n=H0.get(e);if(n)return n;H0.set(e,n=[]);for(var i,r=t,s=Element.prototype;s!==r;){i=A3(r);for(var a in i)i[a].set&&n.push(a);r=nb(r)}return n}function xb(t,e,n=e){var i=new WeakSet;N3(t,"input",async r=>{var s=r?t.defaultValue:t.value;if(s=ng(t)?ig(s):s,n(s),nu!==null&&i.add(nu),await ub(),s!==(s=e())){var a=t.selectionStart,o=t.selectionEnd,l=t.value.length;if(t.value=s??"",o!==null){var c=t.value.length;a===o&&o===l&&c>l?(t.selectionStart=c,t.selectionEnd=c):(t.selectionStart=a,t.selectionEnd=Math.min(o,c))}}}),(Li&&t.defaultValue!==t.value||ea(e)==null&&t.value)&&(n(ng(t)?ig(t.value):t.value),nu!==null&&i.add(nu)),lb(()=>{var r=e();if(t===document.activeElement){var s=C3??nu;if(i.has(s))return}ng(t)&&r===ig(t.value)||t.type==="date"&&!r&&!t.value||r!==t.value&&(t.value=r??"")})}function ng(t){var e=t.type;return e==="number"||e==="range"}function ig(t){return t===""?null:+t}class d1{#e=new WeakMap;#t;#n;static entries=new WeakMap;constructor(e){this.#n=e}observe(e,n){var i=this.#e.get(e)||new Set;return i.add(n),this.#e.set(e,i),this.#i().observe(e,this.#n),()=>{var r=this.#e.get(e);r.delete(n),r.size===0&&(this.#e.delete(e),this.#t.unobserve(e))}}#i(){return this.#t??(this.#t=new ResizeObserver(e=>{for(var n of e){d1.entries.set(n.target,n);for(var i of this.#e.get(n.target)||[])i(n)}}))}}var nS=new d1({box:"border-box"});function U0(t,e,n){var i=nS.observe(t,()=>n(t[e]));Ou(()=>(ea(()=>n(t[e])),i))}const iS=t=>t;function f1(t){const e=t-1;return e*e*e+1}function W0(t){const e=typeof t=="string"&&t.match(/^\s*(-?[\d.]+)([^\s]*)\s*$/);return e?[parseFloat(e[1]),e[2]||"px"]:[t,"px"]}function Nr(t,{delay:e=0,duration:n=400,easing:i=iS}={}){const r=+getComputedStyle(t).opacity;return{delay:e,duration:n,easing:i,css:s=>`opacity: ${s*r}`}}function h1(t,{delay:e=0,duration:n=400,easing:i=f1,x:r=0,y:s=0,opacity:a=0}={}){const o=getComputedStyle(t),l=+o.opacity,c=o.transform==="none"?"":o.transform,u=l*(1-a),[f,h]=W0(r),[d,y]=W0(s);return{delay:e,duration:n,easing:i,css:(m,x)=>`
			transform: ${c} translate(${(1-m)*f}${h}, ${(1-m)*d}${y});
			opacity: ${l-u*x}`}}function rS(t,{delay:e=0,duration:n=400,easing:i=f1,axis:r="y"}={}){const s=getComputedStyle(t),a=+s.opacity,o=r==="y"?"height":"width",l=parseFloat(s[o]),c=r==="y"?["top","bottom"]:["left","right"],u=c.map(w=>`${w[0].toUpperCase()}${w.slice(1)}`),f=parseFloat(s[`padding${u[0]}`]),h=parseFloat(s[`padding${u[1]}`]),d=parseFloat(s[`margin${u[0]}`]),y=parseFloat(s[`margin${u[1]}`]),m=parseFloat(s[`border${u[0]}Width`]),x=parseFloat(s[`border${u[1]}Width`]);return{delay:e,duration:n,easing:i,css:w=>`overflow: hidden;opacity: ${Math.min(w*20,1)*a};${o}: ${w*l}px;padding-${c[0]}: ${w*f}px;padding-${c[1]}: ${w*h}px;margin-${c[0]}: ${w*d}px;margin-${c[1]}: ${w*y}px;border-${c[0]}-width: ${w*m}px;border-${c[1]}-width: ${w*x}px;min-${o}: 0`}}function fo(t,{delay:e=0,duration:n=400,easing:i=f1,start:r=0,opacity:s=0}={}){const a=getComputedStyle(t),o=+a.opacity,l=a.transform==="none"?"":a.transform,c=1-r,u=o*(1-s);return{delay:e,duration:n,easing:i,css:(f,h)=>`
			transform: ${l} scale(${1-c*h});
			opacity: ${o-u*h}
		`}}function Ea(t){const e=t-1;return e*e*e+1}var sS={value:()=>{}};function Jh(){for(var t=0,e=arguments.length,n={},i;t<e;++t){if(!(i=arguments[t]+"")||i in n||/[\s.]/.test(i))throw new Error("illegal type: "+i);n[i]=[]}return new Zf(n)}function Zf(t){this._=t}function aS(t,e){return t.trim().split(/^|\s+/).map(function(n){var i="",r=n.indexOf(".");if(r>=0&&(i=n.slice(r+1),n=n.slice(0,r)),n&&!e.hasOwnProperty(n))throw new Error("unknown type: "+n);return{type:n,name:i}})}Zf.prototype=Jh.prototype={constructor:Zf,on:function(t,e){var n=this._,i=aS(t+"",n),r,s=-1,a=i.length;if(arguments.length<2){for(;++s<a;)if((r=(t=i[s]).type)&&(r=oS(n[r],t.name)))return r;return}if(e!=null&&typeof e!="function")throw new Error("invalid callback: "+e);for(;++s<a;)if(r=(t=i[s]).type)n[r]=V0(n[r],t.name,e);else if(e==null)for(r in n)n[r]=V0(n[r],t.name,null);return this},copy:function(){var t={},e=this._;for(var n in e)t[n]=e[n].slice();return new Zf(t)},call:function(t,e){if((r=arguments.length-2)>0)for(var n=new Array(r),i=0,r,s;i<r;++i)n[i]=arguments[i+2];if(!this._.hasOwnProperty(t))throw new Error("unknown type: "+t);for(s=this._[t],i=0,r=s.length;i<r;++i)s[i].value.apply(e,n)},apply:function(t,e,n){if(!this._.hasOwnProperty(t))throw new Error("unknown type: "+t);for(var i=this._[t],r=0,s=i.length;r<s;++r)i[r].value.apply(e,n)}};function oS(t,e){for(var n=0,i=t.length,r;n<i;++n)if((r=t[n]).name===e)return r.value}function V0(t,e,n){for(var i=0,r=t.length;i<r;++i)if(t[i].name===e){t[i]=sS,t=t.slice(0,i).concat(t.slice(i+1));break}return n!=null&&t.push({name:e,value:n}),t}var pm="http://www.w3.org/1999/xhtml";const G0={svg:"http://www.w3.org/2000/svg",xhtml:pm,xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/"};function Qh(t){var e=t+="",n=e.indexOf(":");return n>=0&&(e=t.slice(0,n))!=="xmlns"&&(t=t.slice(n+1)),G0.hasOwnProperty(e)?{space:G0[e],local:t}:t}function lS(t){return function(){var e=this.ownerDocument,n=this.namespaceURI;return n===pm&&e.documentElement.namespaceURI===pm?e.createElement(t):e.createElementNS(n,t)}}function cS(t){return function(){return this.ownerDocument.createElementNS(t.space,t.local)}}function _b(t){var e=Qh(t);return(e.local?cS:lS)(e)}function uS(){}function p1(t){return t==null?uS:function(){return this.querySelector(t)}}function dS(t){typeof t!="function"&&(t=p1(t));for(var e=this._groups,n=e.length,i=new Array(n),r=0;r<n;++r)for(var s=e[r],a=s.length,o=i[r]=new Array(a),l,c,u=0;u<a;++u)(l=s[u])&&(c=t.call(l,l.__data__,u,s))&&("__data__"in l&&(c.__data__=l.__data__),o[u]=c);return new Fs(i,this._parents)}function fS(t){return t==null?[]:Array.isArray(t)?t:Array.from(t)}function hS(){return[]}function Sb(t){return t==null?hS:function(){return this.querySelectorAll(t)}}function pS(t){return function(){return fS(t.apply(this,arguments))}}function gS(t){typeof t=="function"?t=pS(t):t=Sb(t);for(var e=this._groups,n=e.length,i=[],r=[],s=0;s<n;++s)for(var a=e[s],o=a.length,l,c=0;c<o;++c)(l=a[c])&&(i.push(t.call(l,l.__data__,c,a)),r.push(l));return new Fs(i,r)}function kb(t){return function(){return this.matches(t)}}function Ab(t){return function(e){return e.matches(t)}}var mS=Array.prototype.find;function vS(t){return function(){return mS.call(this.children,t)}}function yS(){return this.firstElementChild}function bS(t){return this.select(t==null?yS:vS(typeof t=="function"?t:Ab(t)))}var wS=Array.prototype.filter;function xS(){return Array.from(this.children)}function _S(t){return function(){return wS.call(this.children,t)}}function SS(t){return this.selectAll(t==null?xS:_S(typeof t=="function"?t:Ab(t)))}function kS(t){typeof t!="function"&&(t=kb(t));for(var e=this._groups,n=e.length,i=new Array(n),r=0;r<n;++r)for(var s=e[r],a=s.length,o=i[r]=[],l,c=0;c<a;++c)(l=s[c])&&t.call(l,l.__data__,c,s)&&o.push(l);return new Fs(i,this._parents)}function Nb(t){return new Array(t.length)}function AS(){return new Fs(this._enter||this._groups.map(Nb),this._parents)}function bh(t,e){this.ownerDocument=t.ownerDocument,this.namespaceURI=t.namespaceURI,this._next=null,this._parent=t,this.__data__=e}bh.prototype={constructor:bh,appendChild:function(t){return this._parent.insertBefore(t,this._next)},insertBefore:function(t,e){return this._parent.insertBefore(t,e)},querySelector:function(t){return this._parent.querySelector(t)},querySelectorAll:function(t){return this._parent.querySelectorAll(t)}};function NS(t){return function(){return t}}function CS(t,e,n,i,r,s){for(var a=0,o,l=e.length,c=s.length;a<c;++a)(o=e[a])?(o.__data__=s[a],i[a]=o):n[a]=new bh(t,s[a]);for(;a<l;++a)(o=e[a])&&(r[a]=o)}function PS(t,e,n,i,r,s,a){var o,l,c=new Map,u=e.length,f=s.length,h=new Array(u),d;for(o=0;o<u;++o)(l=e[o])&&(h[o]=d=a.call(l,l.__data__,o,e)+"",c.has(d)?r[o]=l:c.set(d,l));for(o=0;o<f;++o)d=a.call(t,s[o],o,s)+"",(l=c.get(d))?(i[o]=l,l.__data__=s[o],c.delete(d)):n[o]=new bh(t,s[o]);for(o=0;o<u;++o)(l=e[o])&&c.get(h[o])===l&&(r[o]=l)}function ES(t){return t.__data__}function IS(t,e){if(!arguments.length)return Array.from(this,ES);var n=e?PS:CS,i=this._parents,r=this._groups;typeof t!="function"&&(t=NS(t));for(var s=r.length,a=new Array(s),o=new Array(s),l=new Array(s),c=0;c<s;++c){var u=i[c],f=r[c],h=f.length,d=LS(t.call(u,u&&u.__data__,c,i)),y=d.length,m=o[c]=new Array(y),x=a[c]=new Array(y),w=l[c]=new Array(h);n(u,f,m,x,w,d,e);for(var S=0,A=0,_,M;S<y;++S)if(_=m[S]){for(S>=A&&(A=S+1);!(M=x[A])&&++A<y;);_._next=M||null}}return a=new Fs(a,i),a._enter=o,a._exit=l,a}function LS(t){return typeof t=="object"&&"length"in t?t:Array.from(t)}function MS(){return new Fs(this._exit||this._groups.map(Nb),this._parents)}function TS(t,e,n){var i=this.enter(),r=this,s=this.exit();return typeof t=="function"?(i=t(i),i&&(i=i.selection())):i=i.append(t+""),e!=null&&(r=e(r),r&&(r=r.selection())),n==null?s.remove():n(s),i&&r?i.merge(r).order():r}function DS(t){for(var e=t.selection?t.selection():t,n=this._groups,i=e._groups,r=n.length,s=i.length,a=Math.min(r,s),o=new Array(r),l=0;l<a;++l)for(var c=n[l],u=i[l],f=c.length,h=o[l]=new Array(f),d,y=0;y<f;++y)(d=c[y]||u[y])&&(h[y]=d);for(;l<r;++l)o[l]=n[l];return new Fs(o,this._parents)}function OS(){for(var t=this._groups,e=-1,n=t.length;++e<n;)for(var i=t[e],r=i.length-1,s=i[r],a;--r>=0;)(a=i[r])&&(s&&a.compareDocumentPosition(s)^4&&s.parentNode.insertBefore(a,s),s=a);return this}function FS(t){t||(t=RS);function e(f,h){return f&&h?t(f.__data__,h.__data__):!f-!h}for(var n=this._groups,i=n.length,r=new Array(i),s=0;s<i;++s){for(var a=n[s],o=a.length,l=r[s]=new Array(o),c,u=0;u<o;++u)(c=a[u])&&(l[u]=c);l.sort(e)}return new Fs(r,this._parents).order()}function RS(t,e){return t<e?-1:t>e?1:t>=e?0:NaN}function BS(){var t=arguments[0];return arguments[0]=this,t.apply(null,arguments),this}function zS(){return Array.from(this)}function qS(){for(var t=this._groups,e=0,n=t.length;e<n;++e)for(var i=t[e],r=0,s=i.length;r<s;++r){var a=i[r];if(a)return a}return null}function jS(){let t=0;for(const e of this)++t;return t}function HS(){return!this.node()}function US(t){for(var e=this._groups,n=0,i=e.length;n<i;++n)for(var r=e[n],s=0,a=r.length,o;s<a;++s)(o=r[s])&&t.call(o,o.__data__,s,r);return this}function WS(t){return function(){this.removeAttribute(t)}}function VS(t){return function(){this.removeAttributeNS(t.space,t.local)}}function GS(t,e){return function(){this.setAttribute(t,e)}}function XS(t,e){return function(){this.setAttributeNS(t.space,t.local,e)}}function YS(t,e){return function(){var n=e.apply(this,arguments);n==null?this.removeAttribute(t):this.setAttribute(t,n)}}function KS(t,e){return function(){var n=e.apply(this,arguments);n==null?this.removeAttributeNS(t.space,t.local):this.setAttributeNS(t.space,t.local,n)}}function ZS(t,e){var n=Qh(t);if(arguments.length<2){var i=this.node();return n.local?i.getAttributeNS(n.space,n.local):i.getAttribute(n)}return this.each((e==null?n.local?VS:WS:typeof e=="function"?n.local?KS:YS:n.local?XS:GS)(n,e))}function Cb(t){return t.ownerDocument&&t.ownerDocument.defaultView||t.document&&t||t.defaultView}function JS(t){return function(){this.style.removeProperty(t)}}function QS(t,e,n){return function(){this.style.setProperty(t,e,n)}}function $S(t,e,n){return function(){var i=e.apply(this,arguments);i==null?this.style.removeProperty(t):this.style.setProperty(t,i,n)}}function ek(t,e,n){return arguments.length>1?this.each((e==null?JS:typeof e=="function"?$S:QS)(t,e,n??"")):_u(this.node(),t)}function _u(t,e){return t.style.getPropertyValue(e)||Cb(t).getComputedStyle(t,null).getPropertyValue(e)}function tk(t){return function(){delete this[t]}}function nk(t,e){return function(){this[t]=e}}function ik(t,e){return function(){var n=e.apply(this,arguments);n==null?delete this[t]:this[t]=n}}function rk(t,e){return arguments.length>1?this.each((e==null?tk:typeof e=="function"?ik:nk)(t,e)):this.node()[t]}function Pb(t){return t.trim().split(/^|\s+/)}function g1(t){return t.classList||new Eb(t)}function Eb(t){this._node=t,this._names=Pb(t.getAttribute("class")||"")}Eb.prototype={add:function(t){var e=this._names.indexOf(t);e<0&&(this._names.push(t),this._node.setAttribute("class",this._names.join(" ")))},remove:function(t){var e=this._names.indexOf(t);e>=0&&(this._names.splice(e,1),this._node.setAttribute("class",this._names.join(" ")))},contains:function(t){return this._names.indexOf(t)>=0}};function Ib(t,e){for(var n=g1(t),i=-1,r=e.length;++i<r;)n.add(e[i])}function Lb(t,e){for(var n=g1(t),i=-1,r=e.length;++i<r;)n.remove(e[i])}function sk(t){return function(){Ib(this,t)}}function ak(t){return function(){Lb(this,t)}}function ok(t,e){return function(){(e.apply(this,arguments)?Ib:Lb)(this,t)}}function lk(t,e){var n=Pb(t+"");if(arguments.length<2){for(var i=g1(this.node()),r=-1,s=n.length;++r<s;)if(!i.contains(n[r]))return!1;return!0}return this.each((typeof e=="function"?ok:e?sk:ak)(n,e))}function ck(){this.textContent=""}function uk(t){return function(){this.textContent=t}}function dk(t){return function(){var e=t.apply(this,arguments);this.textContent=e??""}}function fk(t){return arguments.length?this.each(t==null?ck:(typeof t=="function"?dk:uk)(t)):this.node().textContent}function hk(){this.innerHTML=""}function pk(t){return function(){this.innerHTML=t}}function gk(t){return function(){var e=t.apply(this,arguments);this.innerHTML=e??""}}function mk(t){return arguments.length?this.each(t==null?hk:(typeof t=="function"?gk:pk)(t)):this.node().innerHTML}function vk(){this.nextSibling&&this.parentNode.appendChild(this)}function yk(){return this.each(vk)}function bk(){this.previousSibling&&this.parentNode.insertBefore(this,this.parentNode.firstChild)}function wk(){return this.each(bk)}function xk(t){var e=typeof t=="function"?t:_b(t);return this.select(function(){return this.appendChild(e.apply(this,arguments))})}function _k(){return null}function Sk(t,e){var n=typeof t=="function"?t:_b(t),i=e==null?_k:typeof e=="function"?e:p1(e);return this.select(function(){return this.insertBefore(n.apply(this,arguments),i.apply(this,arguments)||null)})}function kk(){var t=this.parentNode;t&&t.removeChild(this)}function Ak(){return this.each(kk)}function Nk(){var t=this.cloneNode(!1),e=this.parentNode;return e?e.insertBefore(t,this.nextSibling):t}function Ck(){var t=this.cloneNode(!0),e=this.parentNode;return e?e.insertBefore(t,this.nextSibling):t}function Pk(t){return this.select(t?Ck:Nk)}function Ek(t){return arguments.length?this.property("__data__",t):this.node().__data__}function Ik(t){return function(e){t.call(this,e,this.__data__)}}function Lk(t){return t.trim().split(/^|\s+/).map(function(e){var n="",i=e.indexOf(".");return i>=0&&(n=e.slice(i+1),e=e.slice(0,i)),{type:e,name:n}})}function Mk(t){return function(){var e=this.__on;if(e){for(var n=0,i=-1,r=e.length,s;n<r;++n)s=e[n],(!t.type||s.type===t.type)&&s.name===t.name?this.removeEventListener(s.type,s.listener,s.options):e[++i]=s;++i?e.length=i:delete this.__on}}}function Tk(t,e,n){return function(){var i=this.__on,r,s=Ik(e);if(i){for(var a=0,o=i.length;a<o;++a)if((r=i[a]).type===t.type&&r.name===t.name){this.removeEventListener(r.type,r.listener,r.options),this.addEventListener(r.type,r.listener=s,r.options=n),r.value=e;return}}this.addEventListener(t.type,s,n),r={type:t.type,name:t.name,value:e,listener:s,options:n},i?i.push(r):this.__on=[r]}}function Dk(t,e,n){var i=Lk(t+""),r,s=i.length,a;if(arguments.length<2){var o=this.node().__on;if(o){for(var l=0,c=o.length,u;l<c;++l)for(r=0,u=o[l];r<s;++r)if((a=i[r]).type===u.type&&a.name===u.name)return u.value}return}for(o=e?Tk:Mk,r=0;r<s;++r)this.each(o(i[r],e,n));return this}function Mb(t,e,n){var i=Cb(t),r=i.CustomEvent;typeof r=="function"?r=new r(e,n):(r=i.document.createEvent("Event"),n?(r.initEvent(e,n.bubbles,n.cancelable),r.detail=n.detail):r.initEvent(e,!1,!1)),t.dispatchEvent(r)}function Ok(t,e){return function(){return Mb(this,t,e)}}function Fk(t,e){return function(){return Mb(this,t,e.apply(this,arguments))}}function Rk(t,e){return this.each((typeof e=="function"?Fk:Ok)(t,e))}function*Bk(){for(var t=this._groups,e=0,n=t.length;e<n;++e)for(var i=t[e],r=0,s=i.length,a;r<s;++r)(a=i[r])&&(yield a)}var Tb=[null];function Fs(t,e){this._groups=t,this._parents=e}function Rd(){return new Fs([[document.documentElement]],Tb)}function zk(){return this}Fs.prototype=Rd.prototype={constructor:Fs,select:dS,selectAll:gS,selectChild:bS,selectChildren:SS,filter:kS,data:IS,enter:AS,exit:MS,join:TS,merge:DS,selection:zk,order:OS,sort:FS,call:BS,nodes:zS,node:qS,size:jS,empty:HS,each:US,attr:ZS,style:ek,property:rk,classed:lk,text:fk,html:mk,raise:yk,lower:wk,append:xk,insert:Sk,remove:Ak,clone:Pk,datum:Ek,on:Dk,dispatch:Rk,[Symbol.iterator]:Bk};function $s(t){return typeof t=="string"?new Fs([[document.querySelector(t)]],[document.documentElement]):new Fs([[t]],Tb)}function qk(t){let e;for(;e=t.sourceEvent;)t=e;return t}function $a(t,e){if(t=qk(t),e===void 0&&(e=t.currentTarget),e){var n=e.ownerSVGElement||e;if(n.createSVGPoint){var i=n.createSVGPoint();return i.x=t.clientX,i.y=t.clientY,i=i.matrixTransform(e.getScreenCTM().inverse()),[i.x,i.y]}if(e.getBoundingClientRect){var r=e.getBoundingClientRect();return[t.clientX-r.left-e.clientLeft,t.clientY-r.top-e.clientTop]}}return[t.pageX,t.pageY]}const jk={passive:!1},Sd={capture:!0,passive:!1};function rg(t){t.stopImmediatePropagation()}function du(t){t.preventDefault(),t.stopImmediatePropagation()}function Db(t){var e=t.document.documentElement,n=$s(t).on("dragstart.drag",du,Sd);"onselectstart"in e?n.on("selectstart.drag",du,Sd):(e.__noselect=e.style.MozUserSelect,e.style.MozUserSelect="none")}function Ob(t,e){var n=t.document.documentElement,i=$s(t).on("dragstart.drag",null);e&&(i.on("click.drag",du,Sd),setTimeout(function(){i.on("click.drag",null)},0)),"onselectstart"in n?i.on("selectstart.drag",null):(n.style.MozUserSelect=n.__noselect,delete n.__noselect)}const wf=t=>()=>t;function gm(t,{sourceEvent:e,subject:n,target:i,identifier:r,active:s,x:a,y:o,dx:l,dy:c,dispatch:u}){Object.defineProperties(this,{type:{value:t,enumerable:!0,configurable:!0},sourceEvent:{value:e,enumerable:!0,configurable:!0},subject:{value:n,enumerable:!0,configurable:!0},target:{value:i,enumerable:!0,configurable:!0},identifier:{value:r,enumerable:!0,configurable:!0},active:{value:s,enumerable:!0,configurable:!0},x:{value:a,enumerable:!0,configurable:!0},y:{value:o,enumerable:!0,configurable:!0},dx:{value:l,enumerable:!0,configurable:!0},dy:{value:c,enumerable:!0,configurable:!0},_:{value:u}})}gm.prototype.on=function(){var t=this._.on.apply(this._,arguments);return t===this._?this:t};function Hk(t){return!t.ctrlKey&&!t.button}function Uk(){return this.parentNode}function Wk(t,e){return e??{x:t.x,y:t.y}}function Vk(){return navigator.maxTouchPoints||"ontouchstart"in this}function Fb(){var t=Hk,e=Uk,n=Wk,i=Vk,r={},s=Jh("start","drag","end"),a=0,o,l,c,u,f=0;function h(_){_.on("mousedown.drag",d).filter(i).on("touchstart.drag",x).on("touchmove.drag",w,jk).on("touchend.drag touchcancel.drag",S).style("touch-action","none").style("-webkit-tap-highlight-color","rgba(0,0,0,0)")}function d(_,M){if(!(u||!t.call(this,_,M))){var I=A(this,e.call(this,_,M),_,M,"mouse");I&&($s(_.view).on("mousemove.drag",y,Sd).on("mouseup.drag",m,Sd),Db(_.view),rg(_),c=!1,o=_.clientX,l=_.clientY,I("start",_))}}function y(_){if(du(_),!c){var M=_.clientX-o,I=_.clientY-l;c=M*M+I*I>f}r.mouse("drag",_)}function m(_){$s(_.view).on("mousemove.drag mouseup.drag",null),Ob(_.view,c),du(_),r.mouse("end",_)}function x(_,M){if(t.call(this,_,M)){var I=_.changedTouches,T=e.call(this,_,M),D=I.length,O,W;for(O=0;O<D;++O)(W=A(this,T,_,M,I[O].identifier,I[O]))&&(rg(_),W("start",_,I[O]))}}function w(_){var M=_.changedTouches,I=M.length,T,D;for(T=0;T<I;++T)(D=r[M[T].identifier])&&(du(_),D("drag",_,M[T]))}function S(_){var M=_.changedTouches,I=M.length,T,D;for(u&&clearTimeout(u),u=setTimeout(function(){u=null},500),T=0;T<I;++T)(D=r[M[T].identifier])&&(rg(_),D("end",_,M[T]))}function A(_,M,I,T,D,O){var W=s.copy(),C=$a(O||I,M),N,B,E;if((E=n.call(_,new gm("beforestart",{sourceEvent:I,target:h,identifier:D,active:a,x:C[0],y:C[1],dx:0,dy:0,dispatch:W}),T))!=null)return N=E.x-C[0]||0,B=E.y-C[1]||0,function R(q,Z,U){var X=C,de;switch(q){case"start":r[D]=R,de=a++;break;case"end":delete r[D],--a;case"drag":C=$a(U||Z,M),de=a;break}W.call(q,_,new gm(q,{sourceEvent:Z,subject:E,target:h,identifier:D,active:de,x:C[0]+N,y:C[1]+B,dx:C[0]-X[0],dy:C[1]-X[1],dispatch:W}),T)}}return h.filter=function(_){return arguments.length?(t=typeof _=="function"?_:wf(!!_),h):t},h.container=function(_){return arguments.length?(e=typeof _=="function"?_:wf(_),h):e},h.subject=function(_){return arguments.length?(n=typeof _=="function"?_:wf(_),h):n},h.touchable=function(_){return arguments.length?(i=typeof _=="function"?_:wf(!!_),h):i},h.on=function(){var _=s.on.apply(s,arguments);return _===s?h:_},h.clickDistance=function(_){return arguments.length?(f=(_=+_)*_,h):Math.sqrt(f)},h}function m1(t,e,n){t.prototype=e.prototype=n,n.constructor=t}function Rb(t,e){var n=Object.create(t.prototype);for(var i in e)n[i]=e[i];return n}function Bd(){}var kd=.7,wh=1/kd,fu="\\s*([+-]?\\d+)\\s*",Ad="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)\\s*",so="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)%\\s*",Gk=/^#([0-9a-f]{3,8})$/,Xk=new RegExp(`^rgb\\(${fu},${fu},${fu}\\)$`),Yk=new RegExp(`^rgb\\(${so},${so},${so}\\)$`),Kk=new RegExp(`^rgba\\(${fu},${fu},${fu},${Ad}\\)$`),Zk=new RegExp(`^rgba\\(${so},${so},${so},${Ad}\\)$`),Jk=new RegExp(`^hsl\\(${Ad},${so},${so}\\)$`),Qk=new RegExp(`^hsla\\(${Ad},${so},${so},${Ad}\\)$`),X0={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};m1(Bd,xc,{copy(t){return Object.assign(new this.constructor,this,t)},displayable(){return this.rgb().displayable()},hex:Y0,formatHex:Y0,formatHex8:$k,formatHsl:e4,formatRgb:K0,toString:K0});function Y0(){return this.rgb().formatHex()}function $k(){return this.rgb().formatHex8()}function e4(){return Bb(this).formatHsl()}function K0(){return this.rgb().formatRgb()}function xc(t){var e,n;return t=(t+"").trim().toLowerCase(),(e=Gk.exec(t))?(n=e[1].length,e=parseInt(e[1],16),n===6?Z0(e):n===3?new ys(e>>8&15|e>>4&240,e>>4&15|e&240,(e&15)<<4|e&15,1):n===8?xf(e>>24&255,e>>16&255,e>>8&255,(e&255)/255):n===4?xf(e>>12&15|e>>8&240,e>>8&15|e>>4&240,e>>4&15|e&240,((e&15)<<4|e&15)/255):null):(e=Xk.exec(t))?new ys(e[1],e[2],e[3],1):(e=Yk.exec(t))?new ys(e[1]*255/100,e[2]*255/100,e[3]*255/100,1):(e=Kk.exec(t))?xf(e[1],e[2],e[3],e[4]):(e=Zk.exec(t))?xf(e[1]*255/100,e[2]*255/100,e[3]*255/100,e[4]):(e=Jk.exec(t))?$0(e[1],e[2]/100,e[3]/100,1):(e=Qk.exec(t))?$0(e[1],e[2]/100,e[3]/100,e[4]):X0.hasOwnProperty(t)?Z0(X0[t]):t==="transparent"?new ys(NaN,NaN,NaN,0):null}function Z0(t){return new ys(t>>16&255,t>>8&255,t&255,1)}function xf(t,e,n,i){return i<=0&&(t=e=n=NaN),new ys(t,e,n,i)}function t4(t){return t instanceof Bd||(t=xc(t)),t?(t=t.rgb(),new ys(t.r,t.g,t.b,t.opacity)):new ys}function mm(t,e,n,i){return arguments.length===1?t4(t):new ys(t,e,n,i??1)}function ys(t,e,n,i){this.r=+t,this.g=+e,this.b=+n,this.opacity=+i}m1(ys,mm,Rb(Bd,{brighter(t){return t=t==null?wh:Math.pow(wh,t),new ys(this.r*t,this.g*t,this.b*t,this.opacity)},darker(t){return t=t==null?kd:Math.pow(kd,t),new ys(this.r*t,this.g*t,this.b*t,this.opacity)},rgb(){return this},clamp(){return new ys(bc(this.r),bc(this.g),bc(this.b),xh(this.opacity))},displayable(){return-.5<=this.r&&this.r<255.5&&-.5<=this.g&&this.g<255.5&&-.5<=this.b&&this.b<255.5&&0<=this.opacity&&this.opacity<=1},hex:J0,formatHex:J0,formatHex8:n4,formatRgb:Q0,toString:Q0}));function J0(){return`#${gc(this.r)}${gc(this.g)}${gc(this.b)}`}function n4(){return`#${gc(this.r)}${gc(this.g)}${gc(this.b)}${gc((isNaN(this.opacity)?1:this.opacity)*255)}`}function Q0(){const t=xh(this.opacity);return`${t===1?"rgb(":"rgba("}${bc(this.r)}, ${bc(this.g)}, ${bc(this.b)}${t===1?")":`, ${t})`}`}function xh(t){return isNaN(t)?1:Math.max(0,Math.min(1,t))}function bc(t){return Math.max(0,Math.min(255,Math.round(t)||0))}function gc(t){return t=bc(t),(t<16?"0":"")+t.toString(16)}function $0(t,e,n,i){return i<=0?t=e=n=NaN:n<=0||n>=1?t=e=NaN:e<=0&&(t=NaN),new Aa(t,e,n,i)}function Bb(t){if(t instanceof Aa)return new Aa(t.h,t.s,t.l,t.opacity);if(t instanceof Bd||(t=xc(t)),!t)return new Aa;if(t instanceof Aa)return t;t=t.rgb();var e=t.r/255,n=t.g/255,i=t.b/255,r=Math.min(e,n,i),s=Math.max(e,n,i),a=NaN,o=s-r,l=(s+r)/2;return o?(e===s?a=(n-i)/o+(n<i)*6:n===s?a=(i-e)/o+2:a=(e-n)/o+4,o/=l<.5?s+r:2-s-r,a*=60):o=l>0&&l<1?0:a,new Aa(a,o,l,t.opacity)}function i4(t,e,n,i){return arguments.length===1?Bb(t):new Aa(t,e,n,i??1)}function Aa(t,e,n,i){this.h=+t,this.s=+e,this.l=+n,this.opacity=+i}m1(Aa,i4,Rb(Bd,{brighter(t){return t=t==null?wh:Math.pow(wh,t),new Aa(this.h,this.s,this.l*t,this.opacity)},darker(t){return t=t==null?kd:Math.pow(kd,t),new Aa(this.h,this.s,this.l*t,this.opacity)},rgb(){var t=this.h%360+(this.h<0)*360,e=isNaN(t)||isNaN(this.s)?0:this.s,n=this.l,i=n+(n<.5?n:1-n)*e,r=2*n-i;return new ys(sg(t>=240?t-240:t+120,r,i),sg(t,r,i),sg(t<120?t+240:t-120,r,i),this.opacity)},clamp(){return new Aa(ev(this.h),_f(this.s),_f(this.l),xh(this.opacity))},displayable(){return(0<=this.s&&this.s<=1||isNaN(this.s))&&0<=this.l&&this.l<=1&&0<=this.opacity&&this.opacity<=1},formatHsl(){const t=xh(this.opacity);return`${t===1?"hsl(":"hsla("}${ev(this.h)}, ${_f(this.s)*100}%, ${_f(this.l)*100}%${t===1?")":`, ${t})`}`}}));function ev(t){return t=(t||0)%360,t<0?t+360:t}function _f(t){return Math.max(0,Math.min(1,t||0))}function sg(t,e,n){return(t<60?e+(n-e)*t/60:t<180?n:t<240?e+(n-e)*(240-t)/60:e)*255}const v1=t=>()=>t;function r4(t,e){return function(n){return t+n*e}}function s4(t,e,n){return t=Math.pow(t,n),e=Math.pow(e,n)-t,n=1/n,function(i){return Math.pow(t+i*e,n)}}function a4(t){return(t=+t)==1?zb:function(e,n){return n-e?s4(e,n,t):v1(isNaN(e)?n:e)}}function zb(t,e){var n=e-t;return n?r4(t,n):v1(isNaN(t)?e:t)}const _h=(function t(e){var n=a4(e);function i(r,s){var a=n((r=mm(r)).r,(s=mm(s)).r),o=n(r.g,s.g),l=n(r.b,s.b),c=zb(r.opacity,s.opacity);return function(u){return r.r=a(u),r.g=o(u),r.b=l(u),r.opacity=c(u),r+""}}return i.gamma=t,i})(1);function o4(t,e){e||(e=[]);var n=t?Math.min(e.length,t.length):0,i=e.slice(),r;return function(s){for(r=0;r<n;++r)i[r]=t[r]*(1-s)+e[r]*s;return i}}function l4(t){return ArrayBuffer.isView(t)&&!(t instanceof DataView)}function c4(t,e){var n=e?e.length:0,i=t?Math.min(n,t.length):0,r=new Array(i),s=new Array(n),a;for(a=0;a<i;++a)r[a]=pd(t[a],e[a]);for(;a<n;++a)s[a]=e[a];return function(o){for(a=0;a<i;++a)s[a]=r[a](o);return s}}function u4(t,e){var n=new Date;return t=+t,e=+e,function(i){return n.setTime(t*(1-i)+e*i),n}}function eo(t,e){return t=+t,e=+e,function(n){return t*(1-n)+e*n}}function d4(t,e){var n={},i={},r;(t===null||typeof t!="object")&&(t={}),(e===null||typeof e!="object")&&(e={});for(r in e)r in t?n[r]=pd(t[r],e[r]):i[r]=e[r];return function(s){for(r in n)i[r]=n[r](s);return i}}var vm=/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g,ag=new RegExp(vm.source,"g");function f4(t){return function(){return t}}function h4(t){return function(e){return t(e)+""}}function qb(t,e){var n=vm.lastIndex=ag.lastIndex=0,i,r,s,a=-1,o=[],l=[];for(t=t+"",e=e+"";(i=vm.exec(t))&&(r=ag.exec(e));)(s=r.index)>n&&(s=e.slice(n,s),o[a]?o[a]+=s:o[++a]=s),(i=i[0])===(r=r[0])?o[a]?o[a]+=r:o[++a]=r:(o[++a]=null,l.push({i:a,x:eo(i,r)})),n=ag.lastIndex;return n<e.length&&(s=e.slice(n),o[a]?o[a]+=s:o[++a]=s),o.length<2?l[0]?h4(l[0].x):f4(e):(e=l.length,function(c){for(var u=0,f;u<e;++u)o[(f=l[u]).i]=f.x(c);return o.join("")})}function pd(t,e){var n=typeof e,i;return e==null||n==="boolean"?v1(e):(n==="number"?eo:n==="string"?(i=xc(e))?(e=i,_h):qb:e instanceof xc?_h:e instanceof Date?u4:l4(e)?o4:Array.isArray(e)?c4:typeof e.valueOf!="function"&&typeof e.toString!="function"||isNaN(e)?d4:eo)(t,e)}var tv=180/Math.PI,ym={translateX:0,translateY:0,rotate:0,skewX:0,scaleX:1,scaleY:1};function jb(t,e,n,i,r,s){var a,o,l;return(a=Math.sqrt(t*t+e*e))&&(t/=a,e/=a),(l=t*n+e*i)&&(n-=t*l,i-=e*l),(o=Math.sqrt(n*n+i*i))&&(n/=o,i/=o,l/=o),t*i<e*n&&(t=-t,e=-e,l=-l,a=-a),{translateX:r,translateY:s,rotate:Math.atan2(e,t)*tv,skewX:Math.atan(l)*tv,scaleX:a,scaleY:o}}var Sf;function p4(t){const e=new(typeof DOMMatrix=="function"?DOMMatrix:WebKitCSSMatrix)(t+"");return e.isIdentity?ym:jb(e.a,e.b,e.c,e.d,e.e,e.f)}function g4(t){return t==null||(Sf||(Sf=document.createElementNS("http://www.w3.org/2000/svg","g")),Sf.setAttribute("transform",t),!(t=Sf.transform.baseVal.consolidate()))?ym:(t=t.matrix,jb(t.a,t.b,t.c,t.d,t.e,t.f))}function Hb(t,e,n,i){function r(c){return c.length?c.pop()+" ":""}function s(c,u,f,h,d,y){if(c!==f||u!==h){var m=d.push("translate(",null,e,null,n);y.push({i:m-4,x:eo(c,f)},{i:m-2,x:eo(u,h)})}else(f||h)&&d.push("translate("+f+e+h+n)}function a(c,u,f,h){c!==u?(c-u>180?u+=360:u-c>180&&(c+=360),h.push({i:f.push(r(f)+"rotate(",null,i)-2,x:eo(c,u)})):u&&f.push(r(f)+"rotate("+u+i)}function o(c,u,f,h){c!==u?h.push({i:f.push(r(f)+"skewX(",null,i)-2,x:eo(c,u)}):u&&f.push(r(f)+"skewX("+u+i)}function l(c,u,f,h,d,y){if(c!==f||u!==h){var m=d.push(r(d)+"scale(",null,",",null,")");y.push({i:m-4,x:eo(c,f)},{i:m-2,x:eo(u,h)})}else(f!==1||h!==1)&&d.push(r(d)+"scale("+f+","+h+")")}return function(c,u){var f=[],h=[];return c=t(c),u=t(u),s(c.translateX,c.translateY,u.translateX,u.translateY,f,h),a(c.rotate,u.rotate,f,h),o(c.skewX,u.skewX,f,h),l(c.scaleX,c.scaleY,u.scaleX,u.scaleY,f,h),c=u=null,function(d){for(var y=-1,m=h.length,x;++y<m;)f[(x=h[y]).i]=x.x(d);return f.join("")}}}var m4=Hb(p4,"px, ","px)","deg)"),v4=Hb(g4,", ",")",")"),y4=1e-12;function nv(t){return((t=Math.exp(t))+1/t)/2}function b4(t){return((t=Math.exp(t))-1/t)/2}function w4(t){return((t=Math.exp(2*t))-1)/(t+1)}const Jf=(function t(e,n,i){function r(s,a){var o=s[0],l=s[1],c=s[2],u=a[0],f=a[1],h=a[2],d=u-o,y=f-l,m=d*d+y*y,x,w;if(m<y4)w=Math.log(h/c)/e,x=function(T){return[o+T*d,l+T*y,c*Math.exp(e*T*w)]};else{var S=Math.sqrt(m),A=(h*h-c*c+i*m)/(2*c*n*S),_=(h*h-c*c-i*m)/(2*h*n*S),M=Math.log(Math.sqrt(A*A+1)-A),I=Math.log(Math.sqrt(_*_+1)-_);w=(I-M)/e,x=function(T){var D=T*w,O=nv(M),W=c/(n*S)*(O*w4(e*D+M)-b4(M));return[o+W*d,l+W*y,c*O/nv(e*D+M)]}}return x.duration=w*1e3*e/Math.SQRT2,x}return r.rho=function(s){var a=Math.max(.001,+s),o=a*a,l=o*o;return t(a,o,l)},r})(Math.SQRT2,2,4);var Su=0,rd=0,Ku=0,Ub=1e3,Sh,sd,kh=0,_c=0,$h=0,Nd=typeof performance=="object"&&performance.now?performance:Date,Wb=typeof window=="object"&&window.requestAnimationFrame?window.requestAnimationFrame.bind(window):function(t){setTimeout(t,17)};function y1(){return _c||(Wb(x4),_c=Nd.now()+$h)}function x4(){_c=0}function Ah(){this._call=this._time=this._next=null}Ah.prototype=Vb.prototype={constructor:Ah,restart:function(t,e,n){if(typeof t!="function")throw new TypeError("callback is not a function");n=(n==null?y1():+n)+(e==null?0:+e),!this._next&&sd!==this&&(sd?sd._next=this:Sh=this,sd=this),this._call=t,this._time=n,bm()},stop:function(){this._call&&(this._call=null,this._time=1/0,bm())}};function Vb(t,e,n){var i=new Ah;return i.restart(t,e,n),i}function _4(){y1(),++Su;for(var t=Sh,e;t;)(e=_c-t._time)>=0&&t._call.call(void 0,e),t=t._next;--Su}function iv(){_c=(kh=Nd.now())+$h,Su=rd=0;try{_4()}finally{Su=0,k4(),_c=0}}function S4(){var t=Nd.now(),e=t-kh;e>Ub&&($h-=e,kh=t)}function k4(){for(var t,e=Sh,n,i=1/0;e;)e._call?(i>e._time&&(i=e._time),t=e,e=e._next):(n=e._next,e._next=null,e=t?t._next=n:Sh=n);sd=t,bm(i)}function bm(t){if(!Su){rd&&(rd=clearTimeout(rd));var e=t-_c;e>24?(t<1/0&&(rd=setTimeout(iv,t-Nd.now()-$h)),Ku&&(Ku=clearInterval(Ku))):(Ku||(kh=Nd.now(),Ku=setInterval(S4,Ub)),Su=1,Wb(iv))}}function rv(t,e,n){var i=new Ah;return e=e==null?0:+e,i.restart(r=>{i.stop(),t(r+e)},e,n),i}var A4=Jh("start","end","cancel","interrupt"),N4=[],Gb=0,sv=1,wm=2,Qf=3,av=4,xm=5,$f=6;function ep(t,e,n,i,r,s){var a=t.__transition;if(!a)t.__transition={};else if(n in a)return;C4(t,n,{name:e,index:i,group:r,on:A4,tween:N4,time:s.time,delay:s.delay,duration:s.duration,ease:s.ease,timer:null,state:Gb})}function b1(t,e){var n=Ia(t,e);if(n.state>Gb)throw new Error("too late; already scheduled");return n}function ho(t,e){var n=Ia(t,e);if(n.state>Qf)throw new Error("too late; already running");return n}function Ia(t,e){var n=t.__transition;if(!n||!(n=n[e]))throw new Error("transition not found");return n}function C4(t,e,n){var i=t.__transition,r;i[e]=n,n.timer=Vb(s,0,n.time);function s(c){n.state=sv,n.timer.restart(a,n.delay,n.time),n.delay<=c&&a(c-n.delay)}function a(c){var u,f,h,d;if(n.state!==sv)return l();for(u in i)if(d=i[u],d.name===n.name){if(d.state===Qf)return rv(a);d.state===av?(d.state=$f,d.timer.stop(),d.on.call("interrupt",t,t.__data__,d.index,d.group),delete i[u]):+u<e&&(d.state=$f,d.timer.stop(),d.on.call("cancel",t,t.__data__,d.index,d.group),delete i[u])}if(rv(function(){n.state===Qf&&(n.state=av,n.timer.restart(o,n.delay,n.time),o(c))}),n.state=wm,n.on.call("start",t,t.__data__,n.index,n.group),n.state===wm){for(n.state=Qf,r=new Array(h=n.tween.length),u=0,f=-1;u<h;++u)(d=n.tween[u].value.call(t,t.__data__,n.index,n.group))&&(r[++f]=d);r.length=f+1}}function o(c){for(var u=c<n.duration?n.ease.call(null,c/n.duration):(n.timer.restart(l),n.state=xm,1),f=-1,h=r.length;++f<h;)r[f].call(t,u);n.state===xm&&(n.on.call("end",t,t.__data__,n.index,n.group),l())}function l(){n.state=$f,n.timer.stop(),delete i[e];for(var c in i)return;delete t.__transition}}function eh(t,e){var n=t.__transition,i,r,s=!0,a;if(n){e=e==null?null:e+"";for(a in n){if((i=n[a]).name!==e){s=!1;continue}r=i.state>wm&&i.state<xm,i.state=$f,i.timer.stop(),i.on.call(r?"interrupt":"cancel",t,t.__data__,i.index,i.group),delete n[a]}s&&delete t.__transition}}function P4(t){return this.each(function(){eh(this,t)})}function E4(t,e){var n,i;return function(){var r=ho(this,t),s=r.tween;if(s!==n){i=n=s;for(var a=0,o=i.length;a<o;++a)if(i[a].name===e){i=i.slice(),i.splice(a,1);break}}r.tween=i}}function I4(t,e,n){var i,r;if(typeof n!="function")throw new Error;return function(){var s=ho(this,t),a=s.tween;if(a!==i){r=(i=a).slice();for(var o={name:e,value:n},l=0,c=r.length;l<c;++l)if(r[l].name===e){r[l]=o;break}l===c&&r.push(o)}s.tween=r}}function L4(t,e){var n=this._id;if(t+="",arguments.length<2){for(var i=Ia(this.node(),n).tween,r=0,s=i.length,a;r<s;++r)if((a=i[r]).name===t)return a.value;return null}return this.each((e==null?E4:I4)(n,t,e))}function w1(t,e,n){var i=t._id;return t.each(function(){var r=ho(this,i);(r.value||(r.value={}))[e]=n.apply(this,arguments)}),function(r){return Ia(r,i).value[e]}}function Xb(t,e){var n;return(typeof e=="number"?eo:e instanceof xc?_h:(n=xc(e))?(e=n,_h):qb)(t,e)}function M4(t){return function(){this.removeAttribute(t)}}function T4(t){return function(){this.removeAttributeNS(t.space,t.local)}}function D4(t,e,n){var i,r=n+"",s;return function(){var a=this.getAttribute(t);return a===r?null:a===i?s:s=e(i=a,n)}}function O4(t,e,n){var i,r=n+"",s;return function(){var a=this.getAttributeNS(t.space,t.local);return a===r?null:a===i?s:s=e(i=a,n)}}function F4(t,e,n){var i,r,s;return function(){var a,o=n(this),l;return o==null?void this.removeAttribute(t):(a=this.getAttribute(t),l=o+"",a===l?null:a===i&&l===r?s:(r=l,s=e(i=a,o)))}}function R4(t,e,n){var i,r,s;return function(){var a,o=n(this),l;return o==null?void this.removeAttributeNS(t.space,t.local):(a=this.getAttributeNS(t.space,t.local),l=o+"",a===l?null:a===i&&l===r?s:(r=l,s=e(i=a,o)))}}function B4(t,e){var n=Qh(t),i=n==="transform"?v4:Xb;return this.attrTween(t,typeof e=="function"?(n.local?R4:F4)(n,i,w1(this,"attr."+t,e)):e==null?(n.local?T4:M4)(n):(n.local?O4:D4)(n,i,e))}function z4(t,e){return function(n){this.setAttribute(t,e.call(this,n))}}function q4(t,e){return function(n){this.setAttributeNS(t.space,t.local,e.call(this,n))}}function j4(t,e){var n,i;function r(){var s=e.apply(this,arguments);return s!==i&&(n=(i=s)&&q4(t,s)),n}return r._value=e,r}function H4(t,e){var n,i;function r(){var s=e.apply(this,arguments);return s!==i&&(n=(i=s)&&z4(t,s)),n}return r._value=e,r}function U4(t,e){var n="attr."+t;if(arguments.length<2)return(n=this.tween(n))&&n._value;if(e==null)return this.tween(n,null);if(typeof e!="function")throw new Error;var i=Qh(t);return this.tween(n,(i.local?j4:H4)(i,e))}function W4(t,e){return function(){b1(this,t).delay=+e.apply(this,arguments)}}function V4(t,e){return e=+e,function(){b1(this,t).delay=e}}function G4(t){var e=this._id;return arguments.length?this.each((typeof t=="function"?W4:V4)(e,t)):Ia(this.node(),e).delay}function X4(t,e){return function(){ho(this,t).duration=+e.apply(this,arguments)}}function Y4(t,e){return e=+e,function(){ho(this,t).duration=e}}function K4(t){var e=this._id;return arguments.length?this.each((typeof t=="function"?X4:Y4)(e,t)):Ia(this.node(),e).duration}function Z4(t,e){if(typeof e!="function")throw new Error;return function(){ho(this,t).ease=e}}function J4(t){var e=this._id;return arguments.length?this.each(Z4(e,t)):Ia(this.node(),e).ease}function Q4(t,e){return function(){var n=e.apply(this,arguments);if(typeof n!="function")throw new Error;ho(this,t).ease=n}}function $4(t){if(typeof t!="function")throw new Error;return this.each(Q4(this._id,t))}function e6(t){typeof t!="function"&&(t=kb(t));for(var e=this._groups,n=e.length,i=new Array(n),r=0;r<n;++r)for(var s=e[r],a=s.length,o=i[r]=[],l,c=0;c<a;++c)(l=s[c])&&t.call(l,l.__data__,c,s)&&o.push(l);return new ol(i,this._parents,this._name,this._id)}function t6(t){if(t._id!==this._id)throw new Error;for(var e=this._groups,n=t._groups,i=e.length,r=n.length,s=Math.min(i,r),a=new Array(i),o=0;o<s;++o)for(var l=e[o],c=n[o],u=l.length,f=a[o]=new Array(u),h,d=0;d<u;++d)(h=l[d]||c[d])&&(f[d]=h);for(;o<i;++o)a[o]=e[o];return new ol(a,this._parents,this._name,this._id)}function n6(t){return(t+"").trim().split(/^|\s+/).every(function(e){var n=e.indexOf(".");return n>=0&&(e=e.slice(0,n)),!e||e==="start"})}function i6(t,e,n){var i,r,s=n6(e)?b1:ho;return function(){var a=s(this,t),o=a.on;o!==i&&(r=(i=o).copy()).on(e,n),a.on=r}}function r6(t,e){var n=this._id;return arguments.length<2?Ia(this.node(),n).on.on(t):this.each(i6(n,t,e))}function s6(t){return function(){var e=this.parentNode;for(var n in this.__transition)if(+n!==t)return;e&&e.removeChild(this)}}function a6(){return this.on("end.remove",s6(this._id))}function o6(t){var e=this._name,n=this._id;typeof t!="function"&&(t=p1(t));for(var i=this._groups,r=i.length,s=new Array(r),a=0;a<r;++a)for(var o=i[a],l=o.length,c=s[a]=new Array(l),u,f,h=0;h<l;++h)(u=o[h])&&(f=t.call(u,u.__data__,h,o))&&("__data__"in u&&(f.__data__=u.__data__),c[h]=f,ep(c[h],e,n,h,c,Ia(u,n)));return new ol(s,this._parents,e,n)}function l6(t){var e=this._name,n=this._id;typeof t!="function"&&(t=Sb(t));for(var i=this._groups,r=i.length,s=[],a=[],o=0;o<r;++o)for(var l=i[o],c=l.length,u,f=0;f<c;++f)if(u=l[f]){for(var h=t.call(u,u.__data__,f,l),d,y=Ia(u,n),m=0,x=h.length;m<x;++m)(d=h[m])&&ep(d,e,n,m,h,y);s.push(h),a.push(u)}return new ol(s,a,e,n)}var c6=Rd.prototype.constructor;function u6(){return new c6(this._groups,this._parents)}function d6(t,e){var n,i,r;return function(){var s=_u(this,t),a=(this.style.removeProperty(t),_u(this,t));return s===a?null:s===n&&a===i?r:r=e(n=s,i=a)}}function Yb(t){return function(){this.style.removeProperty(t)}}function f6(t,e,n){var i,r=n+"",s;return function(){var a=_u(this,t);return a===r?null:a===i?s:s=e(i=a,n)}}function h6(t,e,n){var i,r,s;return function(){var a=_u(this,t),o=n(this),l=o+"";return o==null&&(l=o=(this.style.removeProperty(t),_u(this,t))),a===l?null:a===i&&l===r?s:(r=l,s=e(i=a,o))}}function p6(t,e){var n,i,r,s="style."+e,a="end."+s,o;return function(){var l=ho(this,t),c=l.on,u=l.value[s]==null?o||(o=Yb(e)):void 0;(c!==n||r!==u)&&(i=(n=c).copy()).on(a,r=u),l.on=i}}function g6(t,e,n){var i=(t+="")=="transform"?m4:Xb;return e==null?this.styleTween(t,d6(t,i)).on("end.style."+t,Yb(t)):typeof e=="function"?this.styleTween(t,h6(t,i,w1(this,"style."+t,e))).each(p6(this._id,t)):this.styleTween(t,f6(t,i,e),n).on("end.style."+t,null)}function m6(t,e,n){return function(i){this.style.setProperty(t,e.call(this,i),n)}}function v6(t,e,n){var i,r;function s(){var a=e.apply(this,arguments);return a!==r&&(i=(r=a)&&m6(t,a,n)),i}return s._value=e,s}function y6(t,e,n){var i="style."+(t+="");if(arguments.length<2)return(i=this.tween(i))&&i._value;if(e==null)return this.tween(i,null);if(typeof e!="function")throw new Error;return this.tween(i,v6(t,e,n??""))}function b6(t){return function(){this.textContent=t}}function w6(t){return function(){var e=t(this);this.textContent=e??""}}function x6(t){return this.tween("text",typeof t=="function"?w6(w1(this,"text",t)):b6(t==null?"":t+""))}function _6(t){return function(e){this.textContent=t.call(this,e)}}function S6(t){var e,n;function i(){var r=t.apply(this,arguments);return r!==n&&(e=(n=r)&&_6(r)),e}return i._value=t,i}function k6(t){var e="text";if(arguments.length<1)return(e=this.tween(e))&&e._value;if(t==null)return this.tween(e,null);if(typeof t!="function")throw new Error;return this.tween(e,S6(t))}function A6(){for(var t=this._name,e=this._id,n=Kb(),i=this._groups,r=i.length,s=0;s<r;++s)for(var a=i[s],o=a.length,l,c=0;c<o;++c)if(l=a[c]){var u=Ia(l,e);ep(l,t,n,c,a,{time:u.time+u.delay+u.duration,delay:0,duration:u.duration,ease:u.ease})}return new ol(i,this._parents,t,n)}function N6(){var t,e,n=this,i=n._id,r=n.size();return new Promise(function(s,a){var o={value:a},l={value:function(){--r===0&&s()}};n.each(function(){var c=ho(this,i),u=c.on;u!==t&&(e=(t=u).copy(),e._.cancel.push(o),e._.interrupt.push(o),e._.end.push(l)),c.on=e}),r===0&&s()})}var C6=0;function ol(t,e,n,i){this._groups=t,this._parents=e,this._name=n,this._id=i}function Kb(){return++C6}var qo=Rd.prototype;ol.prototype={constructor:ol,select:o6,selectAll:l6,selectChild:qo.selectChild,selectChildren:qo.selectChildren,filter:e6,merge:t6,selection:u6,transition:A6,call:qo.call,nodes:qo.nodes,node:qo.node,size:qo.size,empty:qo.empty,each:qo.each,on:r6,attr:B4,attrTween:U4,style:g6,styleTween:y6,text:x6,textTween:k6,remove:a6,tween:L4,delay:G4,duration:K4,ease:J4,easeVarying:$4,end:N6,[Symbol.iterator]:qo[Symbol.iterator]};function P6(t){return((t*=2)<=1?t*t*t:(t-=2)*t*t+2)/2}var E6={time:null,delay:0,duration:250,ease:P6};function I6(t,e){for(var n;!(n=t.__transition)||!(n=n[e]);)if(!(t=t.parentNode))throw new Error(`transition ${e} not found`);return n}function L6(t){var e,n;t instanceof ol?(e=t._id,t=t._name):(e=Kb(),(n=E6).time=y1(),t=t==null?null:t+"");for(var i=this._groups,r=i.length,s=0;s<r;++s)for(var a=i[s],o=a.length,l,c=0;c<o;++c)(l=a[c])&&ep(l,t,e,c,a,n||I6(l,e));return new ol(i,this._parents,t,e)}Rd.prototype.interrupt=P4;Rd.prototype.transition=L6;const kf=t=>()=>t;function M6(t,{sourceEvent:e,target:n,transform:i,dispatch:r}){Object.defineProperties(this,{type:{value:t,enumerable:!0,configurable:!0},sourceEvent:{value:e,enumerable:!0,configurable:!0},target:{value:n,enumerable:!0,configurable:!0},transform:{value:i,enumerable:!0,configurable:!0},_:{value:r}})}function Qo(t,e,n){this.k=t,this.x=e,this.y=n}Qo.prototype={constructor:Qo,scale:function(t){return t===1?this:new Qo(this.k*t,this.x,this.y)},translate:function(t,e){return t===0&e===0?this:new Qo(this.k,this.x+this.k*t,this.y+this.k*e)},apply:function(t){return[t[0]*this.k+this.x,t[1]*this.k+this.y]},applyX:function(t){return t*this.k+this.x},applyY:function(t){return t*this.k+this.y},invert:function(t){return[(t[0]-this.x)/this.k,(t[1]-this.y)/this.k]},invertX:function(t){return(t-this.x)/this.k},invertY:function(t){return(t-this.y)/this.k},rescaleX:function(t){return t.copy().domain(t.range().map(this.invertX,this).map(t.invert,t))},rescaleY:function(t){return t.copy().domain(t.range().map(this.invertY,this).map(t.invert,t))},toString:function(){return"translate("+this.x+","+this.y+") scale("+this.k+")"}};var tp=new Qo(1,0,0);Zb.prototype=Qo.prototype;function Zb(t){for(;!t.__zoom;)if(!(t=t.parentNode))return tp;return t.__zoom}function og(t){t.stopImmediatePropagation()}function Zu(t){t.preventDefault(),t.stopImmediatePropagation()}function T6(t){return(!t.ctrlKey||t.type==="wheel")&&!t.button}function D6(){var t=this;return t instanceof SVGElement?(t=t.ownerSVGElement||t,t.hasAttribute("viewBox")?(t=t.viewBox.baseVal,[[t.x,t.y],[t.x+t.width,t.y+t.height]]):[[0,0],[t.width.baseVal.value,t.height.baseVal.value]]):[[0,0],[t.clientWidth,t.clientHeight]]}function ov(){return this.__zoom||tp}function O6(t){return-t.deltaY*(t.deltaMode===1?.05:t.deltaMode?1:.002)*(t.ctrlKey?10:1)}function F6(){return navigator.maxTouchPoints||"ontouchstart"in this}function R6(t,e,n){var i=t.invertX(e[0][0])-n[0][0],r=t.invertX(e[1][0])-n[1][0],s=t.invertY(e[0][1])-n[0][1],a=t.invertY(e[1][1])-n[1][1];return t.translate(r>i?(i+r)/2:Math.min(0,i)||Math.max(0,r),a>s?(s+a)/2:Math.min(0,s)||Math.max(0,a))}function B6(){var t=T6,e=D6,n=R6,i=O6,r=F6,s=[0,1/0],a=[[-1/0,-1/0],[1/0,1/0]],o=250,l=Jf,c=Jh("start","zoom","end"),u,f,h,d=500,y=150,m=0,x=10;function w(E){E.property("__zoom",ov).on("wheel.zoom",D,{passive:!1}).on("mousedown.zoom",O).on("dblclick.zoom",W).filter(r).on("touchstart.zoom",C).on("touchmove.zoom",N).on("touchend.zoom touchcancel.zoom",B).style("-webkit-tap-highlight-color","rgba(0,0,0,0)")}w.transform=function(E,R,q,Z){var U=E.selection?E.selection():E;U.property("__zoom",ov),E!==U?M(E,R,q,Z):U.interrupt().each(function(){I(this,arguments).event(Z).start().zoom(null,typeof R=="function"?R.apply(this,arguments):R).end()})},w.scaleBy=function(E,R,q,Z){w.scaleTo(E,function(){var U=this.__zoom.k,X=typeof R=="function"?R.apply(this,arguments):R;return U*X},q,Z)},w.scaleTo=function(E,R,q,Z){w.transform(E,function(){var U=e.apply(this,arguments),X=this.__zoom,de=q==null?_(U):typeof q=="function"?q.apply(this,arguments):q,le=X.invert(de),F=typeof R=="function"?R.apply(this,arguments):R;return n(A(S(X,F),de,le),U,a)},q,Z)},w.translateBy=function(E,R,q,Z){w.transform(E,function(){return n(this.__zoom.translate(typeof R=="function"?R.apply(this,arguments):R,typeof q=="function"?q.apply(this,arguments):q),e.apply(this,arguments),a)},null,Z)},w.translateTo=function(E,R,q,Z,U){w.transform(E,function(){var X=e.apply(this,arguments),de=this.__zoom,le=Z==null?_(X):typeof Z=="function"?Z.apply(this,arguments):Z;return n(tp.translate(le[0],le[1]).scale(de.k).translate(typeof R=="function"?-R.apply(this,arguments):-R,typeof q=="function"?-q.apply(this,arguments):-q),X,a)},Z,U)};function S(E,R){return R=Math.max(s[0],Math.min(s[1],R)),R===E.k?E:new Qo(R,E.x,E.y)}function A(E,R,q){var Z=R[0]-q[0]*E.k,U=R[1]-q[1]*E.k;return Z===E.x&&U===E.y?E:new Qo(E.k,Z,U)}function _(E){return[(+E[0][0]+ +E[1][0])/2,(+E[0][1]+ +E[1][1])/2]}function M(E,R,q,Z){E.on("start.zoom",function(){I(this,arguments).event(Z).start()}).on("interrupt.zoom end.zoom",function(){I(this,arguments).event(Z).end()}).tween("zoom",function(){var U=this,X=arguments,de=I(U,X).event(Z),le=e.apply(U,X),F=q==null?_(le):typeof q=="function"?q.apply(U,X):q,V=Math.max(le[1][0]-le[0][0],le[1][1]-le[0][1]),G=U.__zoom,se=typeof R=="function"?R.apply(U,X):R,ae=l(G.invert(F).concat(V/G.k),se.invert(F).concat(V/se.k));return function(te){if(te===1)te=se;else{var ue=ae(te),pe=V/ue[2];te=new Qo(pe,F[0]-ue[0]*pe,F[1]-ue[1]*pe)}de.zoom(null,te)}})}function I(E,R,q){return!q&&E.__zooming||new T(E,R)}function T(E,R){this.that=E,this.args=R,this.active=0,this.sourceEvent=null,this.extent=e.apply(E,R),this.taps=0}T.prototype={event:function(E){return E&&(this.sourceEvent=E),this},start:function(){return++this.active===1&&(this.that.__zooming=this,this.emit("start")),this},zoom:function(E,R){return this.mouse&&E!=="mouse"&&(this.mouse[1]=R.invert(this.mouse[0])),this.touch0&&E!=="touch"&&(this.touch0[1]=R.invert(this.touch0[0])),this.touch1&&E!=="touch"&&(this.touch1[1]=R.invert(this.touch1[0])),this.that.__zoom=R,this.emit("zoom"),this},end:function(){return--this.active===0&&(delete this.that.__zooming,this.emit("end")),this},emit:function(E){var R=$s(this.that).datum();c.call(E,this.that,new M6(E,{sourceEvent:this.sourceEvent,target:w,transform:this.that.__zoom,dispatch:c}),R)}};function D(E,...R){if(!t.apply(this,arguments))return;var q=I(this,R).event(E),Z=this.__zoom,U=Math.max(s[0],Math.min(s[1],Z.k*Math.pow(2,i.apply(this,arguments)))),X=$a(E);if(q.wheel)(q.mouse[0][0]!==X[0]||q.mouse[0][1]!==X[1])&&(q.mouse[1]=Z.invert(q.mouse[0]=X)),clearTimeout(q.wheel);else{if(Z.k===U)return;q.mouse=[X,Z.invert(X)],eh(this),q.start()}Zu(E),q.wheel=setTimeout(de,y),q.zoom("mouse",n(A(S(Z,U),q.mouse[0],q.mouse[1]),q.extent,a));function de(){q.wheel=null,q.end()}}function O(E,...R){if(h||!t.apply(this,arguments))return;var q=E.currentTarget,Z=I(this,R,!0).event(E),U=$s(E.view).on("mousemove.zoom",F,!0).on("mouseup.zoom",V,!0),X=$a(E,q),de=E.clientX,le=E.clientY;Db(E.view),og(E),Z.mouse=[X,this.__zoom.invert(X)],eh(this),Z.start();function F(G){if(Zu(G),!Z.moved){var se=G.clientX-de,ae=G.clientY-le;Z.moved=se*se+ae*ae>m}Z.event(G).zoom("mouse",n(A(Z.that.__zoom,Z.mouse[0]=$a(G,q),Z.mouse[1]),Z.extent,a))}function V(G){U.on("mousemove.zoom mouseup.zoom",null),Ob(G.view,Z.moved),Zu(G),Z.event(G).end()}}function W(E,...R){if(t.apply(this,arguments)){var q=this.__zoom,Z=$a(E.changedTouches?E.changedTouches[0]:E,this),U=q.invert(Z),X=q.k*(E.shiftKey?.5:2),de=n(A(S(q,X),Z,U),e.apply(this,R),a);Zu(E),o>0?$s(this).transition().duration(o).call(M,de,Z,E):$s(this).call(w.transform,de,Z,E)}}function C(E,...R){if(t.apply(this,arguments)){var q=E.touches,Z=q.length,U=I(this,R,E.changedTouches.length===Z).event(E),X,de,le,F;for(og(E),de=0;de<Z;++de)le=q[de],F=$a(le,this),F=[F,this.__zoom.invert(F),le.identifier],U.touch0?!U.touch1&&U.touch0[2]!==F[2]&&(U.touch1=F,U.taps=0):(U.touch0=F,X=!0,U.taps=1+!!u);u&&(u=clearTimeout(u)),X&&(U.taps<2&&(f=F[0],u=setTimeout(function(){u=null},d)),eh(this),U.start())}}function N(E,...R){if(this.__zooming){var q=I(this,R).event(E),Z=E.changedTouches,U=Z.length,X,de,le,F;for(Zu(E),X=0;X<U;++X)de=Z[X],le=$a(de,this),q.touch0&&q.touch0[2]===de.identifier?q.touch0[0]=le:q.touch1&&q.touch1[2]===de.identifier&&(q.touch1[0]=le);if(de=q.that.__zoom,q.touch1){var V=q.touch0[0],G=q.touch0[1],se=q.touch1[0],ae=q.touch1[1],te=(te=se[0]-V[0])*te+(te=se[1]-V[1])*te,ue=(ue=ae[0]-G[0])*ue+(ue=ae[1]-G[1])*ue;de=S(de,Math.sqrt(te/ue)),le=[(V[0]+se[0])/2,(V[1]+se[1])/2],F=[(G[0]+ae[0])/2,(G[1]+ae[1])/2]}else if(q.touch0)le=q.touch0[0],F=q.touch0[1];else return;q.zoom("touch",n(A(de,le,F),q.extent,a))}}function B(E,...R){if(this.__zooming){var q=I(this,R).event(E),Z=E.changedTouches,U=Z.length,X,de;for(og(E),h&&clearTimeout(h),h=setTimeout(function(){h=null},d),X=0;X<U;++X)de=Z[X],q.touch0&&q.touch0[2]===de.identifier?delete q.touch0:q.touch1&&q.touch1[2]===de.identifier&&delete q.touch1;if(q.touch1&&!q.touch0&&(q.touch0=q.touch1,delete q.touch1),q.touch0)q.touch0[1]=this.__zoom.invert(q.touch0[0]);else if(q.end(),q.taps===2&&(de=$a(de,this),Math.hypot(f[0]-de[0],f[1]-de[1])<x)){var le=$s(this).on("dblclick.zoom");le&&le.apply(this,arguments)}}}return w.wheelDelta=function(E){return arguments.length?(i=typeof E=="function"?E:kf(+E),w):i},w.filter=function(E){return arguments.length?(t=typeof E=="function"?E:kf(!!E),w):t},w.touchable=function(E){return arguments.length?(r=typeof E=="function"?E:kf(!!E),w):r},w.extent=function(E){return arguments.length?(e=typeof E=="function"?E:kf([[+E[0][0],+E[0][1]],[+E[1][0],+E[1][1]]]),w):e},w.scaleExtent=function(E){return arguments.length?(s[0]=+E[0],s[1]=+E[1],w):[s[0],s[1]]},w.translateExtent=function(E){return arguments.length?(a[0][0]=+E[0][0],a[1][0]=+E[1][0],a[0][1]=+E[0][1],a[1][1]=+E[1][1],w):[[a[0][0],a[0][1]],[a[1][0],a[1][1]]]},w.constrain=function(E){return arguments.length?(n=E,w):n},w.duration=function(E){return arguments.length?(o=+E,w):o},w.interpolate=function(E){return arguments.length?(l=E,w):l},w.on=function(){var E=c.on.apply(c,arguments);return E===c?w:E},w.clickDistance=function(E){return arguments.length?(m=(E=+E)*E,w):Math.sqrt(m)},w.tapDistance=function(E){return arguments.length?(x=+E,w):x},w}const Cd={error001:()=>"[React Flow]: Seems like you have not used zustand provider as an ancestor. Help: https://reactflow.dev/error#001",error002:()=>"It looks like you've created a new nodeTypes or edgeTypes object. If this wasn't on purpose please define the nodeTypes/edgeTypes outside of the component or memoize them.",error003:t=>`Node type "${t}" not found. Using fallback type "default".`,error004:()=>"The React Flow parent container needs a width and a height to render the graph.",error005:()=>"Only child nodes can use a parent extent.",error006:()=>"Can't create edge. An edge needs a source and a target.",error007:t=>`The old edge with id=${t} does not exist.`,error009:t=>`Marker type "${t}" doesn't exist.`,error008:(t,{id:e,sourceHandle:n,targetHandle:i})=>`Couldn't create edge for ${t} handle id: "${t==="source"?n:i}", edge id: ${e}.`,error010:()=>"Handle: No node id found. Make sure to only use a Handle inside a custom Node.",error011:t=>`Edge type "${t}" not found. Using fallback type "default".`,error012:t=>`Node with id "${t}" does not exist, it may have been removed. This can happen when a node is deleted before the "onNodeClick" handler is called.`,error013:(t="react")=>`It seems that you haven't loaded the styles. Please import '@xyflow/${t}/dist/style.css' or base.css to make sure everything is working properly.`,error014:()=>"useNodeConnections: No node ID found. Call useNodeConnections inside a custom Node or provide a node ID.",error015:()=>"It seems that you are trying to drag a node that is not initialized. Please use onNodesChange as explained in the docs."},_m=[[Number.NEGATIVE_INFINITY,Number.NEGATIVE_INFINITY],[Number.POSITIVE_INFINITY,Number.POSITIVE_INFINITY]],Jb=["Enter"," ","Escape"],z6={"node.a11yDescription.default":"Press enter or space to select a node. Press delete to remove it and escape to cancel.","node.a11yDescription.keyboardDisabled":"Press enter or space to select a node. You can then use the arrow keys to move the node around. Press delete to remove it and escape to cancel.","node.a11yDescription.ariaLiveMessage":({direction:t,x:e,y:n})=>`Moved selected node ${t}. New position, x: ${e}, y: ${n}`,"edge.a11yDescription.default":"Press enter or space to select an edge. You can then press delete to remove it or escape to cancel.","controls.ariaLabel":"Control Panel","controls.zoomIn.ariaLabel":"Zoom In","controls.zoomOut.ariaLabel":"Zoom Out","controls.fitView.ariaLabel":"Fit View","controls.interactive.ariaLabel":"Toggle Interactivity","minimap.ariaLabel":"Mini Map","handle.ariaLabel":"Handle"};var ku;(function(t){t.Strict="strict",t.Loose="loose"})(ku||(ku={}));var hu;(function(t){t.Free="free",t.Vertical="vertical",t.Horizontal="horizontal"})(hu||(hu={}));var Nh;(function(t){t.Partial="partial",t.Full="full"})(Nh||(Nh={}));const Sm={inProgress:!1,isValid:null,from:null,fromHandle:null,fromPosition:null,fromNode:null,to:null,toHandle:null,toPosition:null,toNode:null,pointer:null};var ql;(function(t){t.Bezier="default",t.Straight="straight",t.Step="step",t.SmoothStep="smoothstep",t.SimpleBezier="simplebezier"})(ql||(ql={}));var Ch;(function(t){t.Arrow="arrow",t.ArrowClosed="arrowclosed"})(Ch||(Ch={}));var Kt;(function(t){t.Left="left",t.Top="top",t.Right="right",t.Bottom="bottom"})(Kt||(Kt={}));const lv={[Kt.Left]:Kt.Right,[Kt.Right]:Kt.Left,[Kt.Top]:Kt.Bottom,[Kt.Bottom]:Kt.Top};function q6(t,e){if(!t&&!e)return!0;if(!t||!e||t.size!==e.size)return!1;if(!t.size&&!e.size)return!0;for(const n of t.keys())if(!e.has(n))return!1;return!0}function cv(t,e,n){if(!n)return;const i=[];t.forEach((r,s)=>{e?.has(s)||i.push(r)}),i.length&&n(i)}function j6(t){return t===null?null:t?"valid":"invalid"}const Qb=t=>"id"in t&&"source"in t&&"target"in t,H6=t=>"id"in t&&"position"in t&&!("source"in t)&&!("target"in t),x1=t=>"id"in t&&"internals"in t&&!("source"in t)&&!("target"in t),zd=(t,e=[0,0])=>{const{width:n,height:i}=Oc(t),r=t.origin??e,s=n*r[0],a=i*r[1];return{x:t.position.x-s,y:t.position.y-a}},U6=(t,e={nodeOrigin:[0,0]})=>{if(t.length===0)return{x:0,y:0,width:0,height:0};const n=t.reduce((i,r)=>{const s=typeof r=="string";let a=!e.nodeLookup&&!s?r:void 0;e.nodeLookup&&(a=s?e.nodeLookup.get(r):x1(r)?r:e.nodeLookup.get(r.id));const o=a?Ph(a,e.nodeOrigin):{x:0,y:0,x2:0,y2:0};return ip(i,o)},{x:1/0,y:1/0,x2:-1/0,y2:-1/0});return rp(n)},np=(t,e={})=>{let n={x:1/0,y:1/0,x2:-1/0,y2:-1/0},i=!1;return t.forEach(r=>{(e.filter===void 0||e.filter(r))&&(n=ip(n,Ph(r)),i=!0)}),i?rp(n):{x:0,y:0,width:0,height:0}},_1=(t,e,[n,i,r]=[0,0,1],s=!1,a=!1)=>{const o={...jd(e,[n,i,r]),width:e.width/r,height:e.height/r},l=[];for(const c of t.values()){const{measured:u,selectable:f=!0,hidden:h=!1}=c;if(a&&!f||h)continue;const d=u.width??c.width??c.initialWidth??null,y=u.height??c.height??c.initialHeight??null,m=Pd(o,Nu(c)),x=(d??0)*(y??0),w=s&&m>0;(!c.internals.handleBounds||w||m>=x||c.dragging)&&l.push(c)}return l},W6=(t,e)=>{const n=new Set;return t.forEach(i=>{n.add(i.id)}),e.filter(i=>n.has(i.source)||n.has(i.target))};function V6(t,e){const n=new Map,i=e?.nodes?new Set(e.nodes.map(r=>r.id)):null;return t.forEach(r=>{r.measured.width&&r.measured.height&&(e?.includeHiddenNodes||!r.hidden)&&(!i||i.has(r.id))&&n.set(r.id,r)}),n}async function G6({nodes:t,width:e,height:n,panZoom:i,minZoom:r,maxZoom:s},a){if(t.size===0)return Promise.resolve(!0);const o=V6(t,a),l=np(o),c=S1(l,e,n,a?.minZoom??r,a?.maxZoom??s,a?.padding??.1);return await i.setViewport(c,{duration:a?.duration,ease:a?.ease,interpolate:a?.interpolate}),Promise.resolve(!0)}function $b({nodeId:t,nextPosition:e,nodeLookup:n,nodeOrigin:i=[0,0],nodeExtent:r,onError:s}){const a=n.get(t),o=a.parentId?n.get(a.parentId):void 0,{x:l,y:c}=o?o.internals.positionAbsolute:{x:0,y:0},u=a.origin??i;let f=a.extent||r;if(a.extent==="parent"&&!a.expandParent)if(!o)s?.("005",Cd.error005());else{const d=o.measured.width,y=o.measured.height;d&&y&&(f=[[l,c],[l+d,c+y]])}else o&&Cu(a.extent)&&(f=[[a.extent[0][0]+l,a.extent[0][1]+c],[a.extent[1][0]+l,a.extent[1][1]+c]]);const h=Cu(f)?Sc(e,f,a.measured):e;return(a.measured.width===void 0||a.measured.height===void 0)&&s?.("015",Cd.error015()),{position:{x:h.x-l+(a.measured.width??0)*u[0],y:h.y-c+(a.measured.height??0)*u[1]},positionAbsolute:h}}async function X6({nodesToRemove:t=[],edgesToRemove:e=[],nodes:n,edges:i,onBeforeDelete:r}){const s=new Set(t.map(h=>h.id)),a=[];for(const h of n){if(h.deletable===!1)continue;const d=s.has(h.id),y=!d&&h.parentId&&a.find(m=>m.id===h.parentId);(d||y)&&a.push(h)}const o=new Set(e.map(h=>h.id)),l=i.filter(h=>h.deletable!==!1),u=W6(a,l);for(const h of l)o.has(h.id)&&!u.find(y=>y.id===h.id)&&u.push(h);if(!r)return{edges:u,nodes:a};const f=await r({nodes:a,edges:u});return typeof f=="boolean"?f?{edges:u,nodes:a}:{edges:[],nodes:[]}:f}const Au=(t,e=0,n=1)=>Math.min(Math.max(t,e),n),Sc=(t={x:0,y:0},e,n)=>({x:Au(t.x,e[0][0],e[1][0]-(n?.width??0)),y:Au(t.y,e[0][1],e[1][1]-(n?.height??0))});function e5(t,e,n){const{width:i,height:r}=Oc(n),{x:s,y:a}=n.internals.positionAbsolute;return Sc(t,[[s,a],[s+i,a+r]],e)}const uv=(t,e,n)=>t<e?Au(Math.abs(t-e),1,e)/e:t>n?-Au(Math.abs(t-n),1,e)/e:0,t5=(t,e,n=15,i=40)=>{const r=uv(t.x,i,e.width-i)*n,s=uv(t.y,i,e.height-i)*n;return[r,s]},ip=(t,e)=>({x:Math.min(t.x,e.x),y:Math.min(t.y,e.y),x2:Math.max(t.x2,e.x2),y2:Math.max(t.y2,e.y2)}),km=({x:t,y:e,width:n,height:i})=>({x:t,y:e,x2:t+n,y2:e+i}),rp=({x:t,y:e,x2:n,y2:i})=>({x:t,y:e,width:n-t,height:i-e}),Nu=(t,e=[0,0])=>{const{x:n,y:i}=x1(t)?t.internals.positionAbsolute:zd(t,e);return{x:n,y:i,width:t.measured?.width??t.width??t.initialWidth??0,height:t.measured?.height??t.height??t.initialHeight??0}},Ph=(t,e=[0,0])=>{const{x:n,y:i}=x1(t)?t.internals.positionAbsolute:zd(t,e);return{x:n,y:i,x2:n+(t.measured?.width??t.width??t.initialWidth??0),y2:i+(t.measured?.height??t.height??t.initialHeight??0)}},Y6=(t,e)=>rp(ip(km(t),km(e))),Pd=(t,e)=>{const n=Math.max(0,Math.min(t.x+t.width,e.x+e.width)-Math.max(t.x,e.x)),i=Math.max(0,Math.min(t.y+t.height,e.y+e.height)-Math.max(t.y,e.y));return Math.ceil(n*i)},dv=t=>$o(t.width)&&$o(t.height)&&$o(t.x)&&$o(t.y),$o=t=>!isNaN(t)&&isFinite(t),K6=(t,e)=>{},qd=(t,e=[1,1])=>({x:e[0]*Math.round(t.x/e[0]),y:e[1]*Math.round(t.y/e[1])}),jd=({x:t,y:e},[n,i,r],s=!1,a=[1,1])=>{const o={x:(t-n)/r,y:(e-i)/r};return s?qd(o,a):o},Eh=({x:t,y:e},[n,i,r])=>({x:t*r+n,y:e*r+i});function Kc(t,e){if(typeof t=="number")return Math.floor((e-e/(1+t))*.5);if(typeof t=="string"&&t.endsWith("px")){const n=parseFloat(t);if(!Number.isNaN(n))return Math.floor(n)}if(typeof t=="string"&&t.endsWith("%")){const n=parseFloat(t);if(!Number.isNaN(n))return Math.floor(e*n*.01)}return console.error(`[React Flow] The padding value "${t}" is invalid. Please provide a number or a string with a valid unit (px or %).`),0}function Z6(t,e,n){if(typeof t=="string"||typeof t=="number"){const i=Kc(t,n),r=Kc(t,e);return{top:i,right:r,bottom:i,left:r,x:r*2,y:i*2}}if(typeof t=="object"){const i=Kc(t.top??t.y??0,n),r=Kc(t.bottom??t.y??0,n),s=Kc(t.left??t.x??0,e),a=Kc(t.right??t.x??0,e);return{top:i,right:a,bottom:r,left:s,x:s+a,y:i+r}}return{top:0,right:0,bottom:0,left:0,x:0,y:0}}function J6(t,e,n,i,r,s){const{x:a,y:o}=Eh(t,[e,n,i]),{x:l,y:c}=Eh({x:t.x+t.width,y:t.y+t.height},[e,n,i]),u=r-l,f=s-c;return{left:Math.floor(a),top:Math.floor(o),right:Math.floor(u),bottom:Math.floor(f)}}const S1=(t,e,n,i,r,s)=>{const a=Z6(s,e,n),o=(e-a.x)/t.width,l=(n-a.y)/t.height,c=Math.min(o,l),u=Au(c,i,r),f=t.x+t.width/2,h=t.y+t.height/2,d=e/2-f*u,y=n/2-h*u,m=J6(t,d,y,u,e,n),x={left:Math.min(m.left-a.left,0),top:Math.min(m.top-a.top,0),right:Math.min(m.right-a.right,0),bottom:Math.min(m.bottom-a.bottom,0)};return{x:d-x.left+x.right,y:y-x.top+x.bottom,zoom:u}},Ih=()=>typeof navigator<"u"&&navigator?.userAgent?.indexOf("Mac")>=0;function Cu(t){return t!=null&&t!=="parent"}function Oc(t){return{width:t.measured?.width??t.width??t.initialWidth??0,height:t.measured?.height??t.height??t.initialHeight??0}}function Q6(t){return(t.measured?.width??t.width??t.initialWidth)!==void 0&&(t.measured?.height??t.height??t.initialHeight)!==void 0}function $6(t,e={width:0,height:0},n,i,r){const s={...t},a=i.get(n);if(a){const o=a.origin||r;s.x+=a.internals.positionAbsolute.x-(e.width??0)*o[0],s.y+=a.internals.positionAbsolute.y-(e.height??0)*o[1]}return s}function eA(t){return{...z6,...t||{}}}function gd(t,{snapGrid:e=[0,0],snapToGrid:n=!1,transform:i,containerBounds:r}){const{x:s,y:a}=Na(t),o=jd({x:s-(r?.left??0),y:a-(r?.top??0)},i),{x:l,y:c}=n?qd(o,e):o;return{xSnapped:l,ySnapped:c,...o}}const n5=t=>({width:t.offsetWidth,height:t.offsetHeight}),i5=t=>t?.getRootNode?.()||window?.document,tA=["INPUT","SELECT","TEXTAREA"];function r5(t){const e=t.composedPath?.()?.[0]||t.target;return e?.nodeType!==1?!1:tA.includes(e.nodeName)||e.hasAttribute("contenteditable")||!!e.closest(".nokey")}const s5=t=>"clientX"in t,Na=(t,e)=>{const n=s5(t),i=n?t.clientX:t.touches?.[0].clientX,r=n?t.clientY:t.touches?.[0].clientY;return{x:i-(e?.left??0),y:r-(e?.top??0)}},fv=(t,e,n,i,r)=>{const s=e.querySelectorAll(`.${t}`);return!s||!s.length?null:Array.from(s).map(a=>{const o=a.getBoundingClientRect();return{id:a.getAttribute("data-handleid"),type:t,nodeId:r,position:a.getAttribute("data-handlepos"),x:(o.left-n.left)/i,y:(o.top-n.top)/i,...n5(a)}})};function nA({sourceX:t,sourceY:e,targetX:n,targetY:i,sourceControlX:r,sourceControlY:s,targetControlX:a,targetControlY:o}){const l=t*.125+r*.375+a*.375+n*.125,c=e*.125+s*.375+o*.375+i*.125,u=Math.abs(l-t),f=Math.abs(c-e);return[l,c,u,f]}function Af(t,e){return t>=0?.5*t:e*25*Math.sqrt(-t)}function hv({pos:t,x1:e,y1:n,x2:i,y2:r,c:s}){switch(t){case Kt.Left:return[e-Af(e-i,s),n];case Kt.Right:return[e+Af(i-e,s),n];case Kt.Top:return[e,n-Af(n-r,s)];case Kt.Bottom:return[e,n+Af(r-n,s)]}}function a5({sourceX:t,sourceY:e,sourcePosition:n=Kt.Bottom,targetX:i,targetY:r,targetPosition:s=Kt.Top,curvature:a=.25}){const[o,l]=hv({pos:n,x1:t,y1:e,x2:i,y2:r,c:a}),[c,u]=hv({pos:s,x1:i,y1:r,x2:t,y2:e,c:a}),[f,h,d,y]=nA({sourceX:t,sourceY:e,targetX:i,targetY:r,sourceControlX:o,sourceControlY:l,targetControlX:c,targetControlY:u});return[`M${t},${e} C${o},${l} ${c},${u} ${i},${r}`,f,h,d,y]}function o5({sourceX:t,sourceY:e,targetX:n,targetY:i}){const r=Math.abs(n-t)/2,s=n<t?n+r:n-r,a=Math.abs(i-e)/2,o=i<e?i+a:i-a;return[s,o,r,a]}function iA({sourceNode:t,targetNode:e,selected:n=!1,zIndex:i=0,elevateOnSelect:r=!1,zIndexMode:s="basic"}){if(s==="manual")return i;const a=r&&n?i+1e3:i,o=Math.max(t.parentId||r&&t.selected?t.internals.z:0,e.parentId||r&&e.selected?e.internals.z:0);return a+o}function rA({sourceNode:t,targetNode:e,width:n,height:i,transform:r}){const s=ip(Ph(t),Ph(e));s.x===s.x2&&(s.x2+=1),s.y===s.y2&&(s.y2+=1);const a={x:-r[0]/r[2],y:-r[1]/r[2],width:n/r[2],height:i/r[2]};return Pd(a,rp(s))>0}const sA=({source:t,sourceHandle:e,target:n,targetHandle:i})=>`xy-edge__${t}${e||""}-${n}${i||""}`,aA=(t,e)=>e.some(n=>n.source===t.source&&n.target===t.target&&(n.sourceHandle===t.sourceHandle||!n.sourceHandle&&!t.sourceHandle)&&(n.targetHandle===t.targetHandle||!n.targetHandle&&!t.targetHandle)),oA=(t,e,n={})=>{if(!t.source||!t.target)return e;const i=n.getEdgeId||sA;let r;return Qb(t)?r={...t}:r={...t,id:i(t)},aA(r,e)?e:(r.sourceHandle===null&&delete r.sourceHandle,r.targetHandle===null&&delete r.targetHandle,e.concat(r))};function l5({sourceX:t,sourceY:e,targetX:n,targetY:i}){const[r,s,a,o]=o5({sourceX:t,sourceY:e,targetX:n,targetY:i});return[`M ${t},${e}L ${n},${i}`,r,s,a,o]}const pv={[Kt.Left]:{x:-1,y:0},[Kt.Right]:{x:1,y:0},[Kt.Top]:{x:0,y:-1},[Kt.Bottom]:{x:0,y:1}},lA=({source:t,sourcePosition:e=Kt.Bottom,target:n})=>e===Kt.Left||e===Kt.Right?t.x<n.x?{x:1,y:0}:{x:-1,y:0}:t.y<n.y?{x:0,y:1}:{x:0,y:-1},gv=(t,e)=>Math.sqrt(Math.pow(e.x-t.x,2)+Math.pow(e.y-t.y,2));function cA({source:t,sourcePosition:e=Kt.Bottom,target:n,targetPosition:i=Kt.Top,center:r,offset:s,stepPosition:a}){const o=pv[e],l=pv[i],c={x:t.x+o.x*s,y:t.y+o.y*s},u={x:n.x+l.x*s,y:n.y+l.y*s},f=lA({source:c,sourcePosition:e,target:u}),h=f.x!==0?"x":"y",d=f[h];let y=[],m,x;const w={x:0,y:0},S={x:0,y:0},[,,A,_]=o5({sourceX:t.x,sourceY:t.y,targetX:n.x,targetY:n.y});if(o[h]*l[h]===-1){h==="x"?(m=r.x??c.x+(u.x-c.x)*a,x=r.y??(c.y+u.y)/2):(m=r.x??(c.x+u.x)/2,x=r.y??c.y+(u.y-c.y)*a);const I=[{x:m,y:c.y},{x:m,y:u.y}],T=[{x:c.x,y:x},{x:u.x,y:x}];o[h]===d?y=h==="x"?I:T:y=h==="x"?T:I}else{const I=[{x:c.x,y:u.y}],T=[{x:u.x,y:c.y}];if(h==="x"?y=o.x===d?T:I:y=o.y===d?I:T,e===i){const N=Math.abs(t[h]-n[h]);if(N<=s){const B=Math.min(s-1,s-N);o[h]===d?w[h]=(c[h]>t[h]?-1:1)*B:S[h]=(u[h]>n[h]?-1:1)*B}}if(e!==i){const N=h==="x"?"y":"x",B=o[h]===l[N],E=c[N]>u[N],R=c[N]<u[N];(o[h]===1&&(!B&&E||B&&R)||o[h]!==1&&(!B&&R||B&&E))&&(y=h==="x"?I:T)}const D={x:c.x+w.x,y:c.y+w.y},O={x:u.x+S.x,y:u.y+S.y},W=Math.max(Math.abs(D.x-y[0].x),Math.abs(O.x-y[0].x)),C=Math.max(Math.abs(D.y-y[0].y),Math.abs(O.y-y[0].y));W>=C?(m=(D.x+O.x)/2,x=y[0].y):(m=y[0].x,x=(D.y+O.y)/2)}return[[t,{x:c.x+w.x,y:c.y+w.y},...y,{x:u.x+S.x,y:u.y+S.y},n],m,x,A,_]}function uA(t,e,n,i){const r=Math.min(gv(t,e)/2,gv(e,n)/2,i),{x:s,y:a}=e;if(t.x===s&&s===n.x||t.y===a&&a===n.y)return`L${s} ${a}`;if(t.y===a){const c=t.x<n.x?-1:1,u=t.y<n.y?1:-1;return`L ${s+r*c},${a}Q ${s},${a} ${s},${a+r*u}`}const o=t.x<n.x?1:-1,l=t.y<n.y?-1:1;return`L ${s},${a+r*l}Q ${s},${a} ${s+r*o},${a}`}function sp({sourceX:t,sourceY:e,sourcePosition:n=Kt.Bottom,targetX:i,targetY:r,targetPosition:s=Kt.Top,borderRadius:a=5,centerX:o,centerY:l,offset:c=20,stepPosition:u=.5}){const[f,h,d,y,m]=cA({source:{x:t,y:e},sourcePosition:n,target:{x:i,y:r},targetPosition:s,center:{x:o,y:l},offset:c,stepPosition:u});return[f.reduce((w,S,A)=>{let _="";return A>0&&A<f.length-1?_=uA(f[A-1],S,f[A+1],a):_=`${A===0?"M":"L"}${S.x} ${S.y}`,w+=_,w},""),h,d,y,m]}function mv(t){return t&&!!(t.internals.handleBounds||t.handles?.length)&&!!(t.measured.width||t.width||t.initialWidth)}function dA(t){const{sourceNode:e,targetNode:n}=t;if(!mv(e)||!mv(n))return null;const i=e.internals.handleBounds||vv(e.handles),r=n.internals.handleBounds||vv(n.handles),s=yv(i?.source??[],t.sourceHandle),a=yv(t.connectionMode===ku.Strict?r?.target??[]:(r?.target??[]).concat(r?.source??[]),t.targetHandle);if(!s||!a)return t.onError?.("008",Cd.error008(s?"target":"source",{id:t.id,sourceHandle:t.sourceHandle,targetHandle:t.targetHandle})),null;const o=s?.position||Kt.Bottom,l=a?.position||Kt.Top,c=kc(e,s,o),u=kc(n,a,l);return{sourceX:c.x,sourceY:c.y,targetX:u.x,targetY:u.y,sourcePosition:o,targetPosition:l}}function vv(t){if(!t)return null;const e=[],n=[];for(const i of t)i.width=i.width??1,i.height=i.height??1,i.type==="source"?e.push(i):i.type==="target"&&n.push(i);return{source:e,target:n}}function kc(t,e,n=Kt.Left,i=!1){const r=(e?.x??0)+t.internals.positionAbsolute.x,s=(e?.y??0)+t.internals.positionAbsolute.y,{width:a,height:o}=e??Oc(t);if(i)return{x:r+a/2,y:s+o/2};switch(e?.position??n){case Kt.Top:return{x:r+a/2,y:s};case Kt.Right:return{x:r+a,y:s+o/2};case Kt.Bottom:return{x:r+a/2,y:s+o};case Kt.Left:return{x:r,y:s+o/2}}}function yv(t,e){return t&&(e?t.find(n=>n.id===e):t[0])||null}function Am(t,e){return t?typeof t=="string"?t:`${e?`${e}__`:""}${Object.keys(t).sort().map(i=>`${i}=${t[i]}`).join("&")}`:""}function fA(t,{id:e,defaultColor:n,defaultMarkerStart:i,defaultMarkerEnd:r}){const s=new Set;return t.reduce((a,o)=>([o.markerStart||i,o.markerEnd||r].forEach(l=>{if(l&&typeof l=="object"){const c=Am(l,e);s.has(c)||(a.push({id:c,color:l.color||n,...l}),s.add(c))}}),a),[]).sort((a,o)=>a.id.localeCompare(o.id))}const c5=1e3,hA=10,k1={nodeOrigin:[0,0],nodeExtent:_m,elevateNodesOnSelect:!0,zIndexMode:"basic",defaults:{}},pA={...k1,checkEquality:!0};function A1(t,e){const n={...t};for(const i in e)e[i]!==void 0&&(n[i]=e[i]);return n}function gA(t,e,n){const i=A1(k1,n);for(const r of t.values())if(r.parentId)C1(r,t,e,i);else{const s=zd(r,i.nodeOrigin),a=Cu(r.extent)?r.extent:i.nodeExtent,o=Sc(s,a,Oc(r));r.internals.positionAbsolute=o}}function mA(t,e){if(!t.handles)return t.measured?e?.internals.handleBounds:void 0;const n=[],i=[];for(const r of t.handles){const s={id:r.id,width:r.width??1,height:r.height??1,nodeId:t.id,x:r.x,y:r.y,position:r.position,type:r.type};r.type==="source"?n.push(s):r.type==="target"&&i.push(s)}return{source:n,target:i}}function N1(t){return t==="manual"}function vA(t,e,n,i={}){const r=A1(pA,i),s={i:0},a=new Map(e),o=r?.elevateNodesOnSelect&&!N1(r.zIndexMode)?c5:0;let l=t.length>0;e.clear(),n.clear();for(const c of t){let u=a.get(c.id);if(r.checkEquality&&c===u?.internals.userNode)e.set(c.id,u);else{const f=zd(c,r.nodeOrigin),h=Cu(c.extent)?c.extent:r.nodeExtent,d=Sc(f,h,Oc(c));u={...r.defaults,...c,measured:{width:c.measured?.width,height:c.measured?.height},internals:{positionAbsolute:d,handleBounds:mA(c,u),z:u5(c,o,r.zIndexMode),userNode:c}},e.set(c.id,u)}(u.measured===void 0||u.measured.width===void 0||u.measured.height===void 0)&&!u.hidden&&(l=!1),c.parentId&&C1(u,e,n,i,s)}return l}function yA(t,e){if(!t.parentId)return;const n=e.get(t.parentId);n?n.set(t.id,t):e.set(t.parentId,new Map([[t.id,t]]))}function C1(t,e,n,i,r){const{elevateNodesOnSelect:s,nodeOrigin:a,nodeExtent:o,zIndexMode:l}=A1(k1,i),c=t.parentId,u=e.get(c);if(!u){console.warn(`Parent node ${c} not found. Please make sure that parent nodes are in front of their child nodes in the nodes array.`);return}yA(t,n),r&&!u.parentId&&u.internals.rootParentIndex===void 0&&l==="auto"&&(u.internals.rootParentIndex=++r.i,u.internals.z=u.internals.z+r.i*hA),r&&u.internals.rootParentIndex!==void 0&&(r.i=u.internals.rootParentIndex);const f=s&&!N1(l)?c5:0,{x:h,y:d,z:y}=bA(t,u,a,o,f,l),{positionAbsolute:m}=t.internals,x=h!==m.x||d!==m.y;(x||y!==t.internals.z)&&e.set(t.id,{...t,internals:{...t.internals,positionAbsolute:x?{x:h,y:d}:m,z:y}})}function u5(t,e,n){const i=$o(t.zIndex)?t.zIndex:0;return N1(n)?i:i+(t.selected?e:0)}function bA(t,e,n,i,r,s){const{x:a,y:o}=e.internals.positionAbsolute,l=Oc(t),c=zd(t,n),u=Cu(t.extent)?Sc(c,t.extent,l):c;let f=Sc({x:a+u.x,y:o+u.y},i,l);t.extent==="parent"&&(f=e5(f,l,e));const h=u5(t,r,s),d=e.internals.z??0;return{x:f.x,y:f.y,z:d>=h?d+1:h}}function wA(t,e,n,i=[0,0]){const r=[],s=new Map;for(const a of t){const o=e.get(a.parentId);if(!o)continue;const l=s.get(a.parentId)?.expandedRect??Nu(o),c=Y6(l,a.rect);s.set(a.parentId,{expandedRect:c,parent:o})}return s.size>0&&s.forEach(({expandedRect:a,parent:o},l)=>{const c=o.internals.positionAbsolute,u=Oc(o),f=o.origin??i,h=a.x<c.x?Math.round(Math.abs(c.x-a.x)):0,d=a.y<c.y?Math.round(Math.abs(c.y-a.y)):0,y=Math.max(u.width,Math.round(a.width)),m=Math.max(u.height,Math.round(a.height)),x=(y-u.width)*f[0],w=(m-u.height)*f[1];(h>0||d>0||x||w)&&(r.push({id:l,type:"position",position:{x:o.position.x-h+x,y:o.position.y-d+w}}),n.get(l)?.forEach(S=>{t.some(A=>A.id===S.id)||r.push({id:S.id,type:"position",position:{x:S.position.x+h,y:S.position.y+d}})})),(u.width<a.width||u.height<a.height||h||d)&&r.push({id:l,type:"dimensions",setAttributes:!0,dimensions:{width:y+(h?f[0]*h-x:0),height:m+(d?f[1]*d-w:0)}})}),r}function xA(t,e,n,i,r,s,a){const o=i?.querySelector(".xyflow__viewport");let l=!1;if(!o)return{changes:[],updatedInternals:l};const c=[],u=window.getComputedStyle(o),{m22:f}=new window.DOMMatrixReadOnly(u.transform),h=[];for(const d of t.values()){const y=e.get(d.id);if(!y)continue;if(y.hidden){e.set(y.id,{...y,internals:{...y.internals,handleBounds:void 0}}),l=!0;continue}const m=n5(d.nodeElement),x=y.measured.width!==m.width||y.measured.height!==m.height;if(!!(m.width&&m.height&&(x||!y.internals.handleBounds||d.force))){const S=d.nodeElement.getBoundingClientRect(),A=Cu(y.extent)?y.extent:s;let{positionAbsolute:_}=y.internals;y.parentId&&y.extent==="parent"?_=e5(_,m,e.get(y.parentId)):A&&(_=Sc(_,A,m));const M={...y,measured:m,internals:{...y.internals,positionAbsolute:_,handleBounds:{source:fv("source",d.nodeElement,S,f,y.id),target:fv("target",d.nodeElement,S,f,y.id)}}};e.set(y.id,M),y.parentId&&C1(M,e,n,{nodeOrigin:r,zIndexMode:a}),l=!0,x&&(c.push({id:y.id,type:"dimensions",dimensions:m}),y.expandParent&&y.parentId&&h.push({id:y.id,parentId:y.parentId,rect:Nu(M,r)}))}}if(h.length>0){const d=wA(h,e,n,r);c.push(...d)}return{changes:c,updatedInternals:l}}async function _A({delta:t,panZoom:e,transform:n,translateExtent:i,width:r,height:s}){if(!e||!t.x&&!t.y)return Promise.resolve(!1);const a=await e.setViewportConstrained({x:n[0]+t.x,y:n[1]+t.y,zoom:n[2]},[[0,0],[r,s]],i),o=!!a&&(a.x!==n[0]||a.y!==n[1]||a.k!==n[2]);return Promise.resolve(o)}function bv(t,e,n,i,r,s){let a=r;const o=i.get(a)||new Map;i.set(a,o.set(n,e)),a=`${r}-${t}`;const l=i.get(a)||new Map;if(i.set(a,l.set(n,e)),s){a=`${r}-${t}-${s}`;const c=i.get(a)||new Map;i.set(a,c.set(n,e))}}function SA(t,e,n){t.clear(),e.clear();for(const i of n){const{source:r,target:s,sourceHandle:a=null,targetHandle:o=null}=i,l={edgeId:i.id,source:r,target:s,sourceHandle:a,targetHandle:o},c=`${r}-${a}--${s}-${o}`,u=`${s}-${o}--${r}-${a}`;bv("source",l,u,t,r,a),bv("target",l,c,t,s,o),e.set(i.id,i)}}function d5(t,e){if(!t.parentId)return!1;const n=e.get(t.parentId);return n?n.selected?!0:d5(n,e):!1}function wv(t,e,n){let i=t;do{if(i?.matches?.(e))return!0;if(i===n)return!1;i=i?.parentElement}while(i);return!1}function kA(t,e,n,i){const r=new Map;for(const[s,a]of t)if((a.selected||a.id===i)&&(!a.parentId||!d5(a,t))&&(a.draggable||e&&typeof a.draggable>"u")){const o=t.get(s);o&&r.set(s,{id:s,position:o.position||{x:0,y:0},distance:{x:n.x-o.internals.positionAbsolute.x,y:n.y-o.internals.positionAbsolute.y},extent:o.extent,parentId:o.parentId,origin:o.origin,expandParent:o.expandParent,internals:{positionAbsolute:o.internals.positionAbsolute||{x:0,y:0}},measured:{width:o.measured.width??0,height:o.measured.height??0}})}return r}function lg({nodeId:t,dragItems:e,nodeLookup:n,dragging:i=!0}){const r=[];for(const[a,o]of e){const l=n.get(a)?.internals.userNode;l&&r.push({...l,position:o.position,dragging:i})}if(!t)return[r[0],r];const s=n.get(t)?.internals.userNode;return[s?{...s,position:e.get(t)?.position||s.position,dragging:i}:r[0],r]}function AA({dragItems:t,snapGrid:e,x:n,y:i}){const r=t.values().next().value;if(!r)return null;const s={x:n-r.distance.x,y:i-r.distance.y},a=qd(s,e);return{x:a.x-s.x,y:a.y-s.y}}function NA({onNodeMouseDown:t,getStoreItems:e,onDragStart:n,onDrag:i,onDragStop:r}){let s={x:null,y:null},a=0,o=new Map,l=!1,c={x:0,y:0},u=null,f=!1,h=null,d=!1,y=!1,m=null;function x({noDragClassName:S,handleSelector:A,domNode:_,isSelectable:M,nodeId:I,nodeClickDistance:T=0}){h=$s(_);function D({x:N,y:B}){const{nodeLookup:E,nodeExtent:R,snapGrid:q,snapToGrid:Z,nodeOrigin:U,onNodeDrag:X,onSelectionDrag:de,onError:le,updateNodePositions:F}=e();s={x:N,y:B};let V=!1;const G=o.size>1,se=G&&R?km(np(o)):null,ae=G&&Z?AA({dragItems:o,snapGrid:q,x:N,y:B}):null;for(const[te,ue]of o){if(!E.has(te))continue;let pe={x:N-ue.distance.x,y:B-ue.distance.y};Z&&(pe=ae?{x:Math.round(pe.x+ae.x),y:Math.round(pe.y+ae.y)}:qd(pe,q));let ge=null;if(G&&R&&!ue.extent&&se){const{positionAbsolute:ke}=ue.internals,Ge=ke.x-se.x+R[0][0],K=ke.x+ue.measured.width-se.x2+R[1][0],Oe=ke.y-se.y+R[0][1],Ke=ke.y+ue.measured.height-se.y2+R[1][1];ge=[[Ge,Oe],[K,Ke]]}const{position:me,positionAbsolute:Pe}=$b({nodeId:te,nextPosition:pe,nodeLookup:E,nodeExtent:ge||R,nodeOrigin:U,onError:le});V=V||ue.position.x!==me.x||ue.position.y!==me.y,ue.position=me,ue.internals.positionAbsolute=Pe}if(y=y||V,!!V&&(F(o,!0),m&&(i||X||!I&&de))){const[te,ue]=lg({nodeId:I,dragItems:o,nodeLookup:E});i?.(m,o,te,ue),X?.(m,te,ue),I||de?.(m,ue)}}async function O(){if(!u)return;const{transform:N,panBy:B,autoPanSpeed:E,autoPanOnNodeDrag:R}=e();if(!R){l=!1,cancelAnimationFrame(a);return}const[q,Z]=t5(c,u,E);(q!==0||Z!==0)&&(s.x=(s.x??0)-q/N[2],s.y=(s.y??0)-Z/N[2],await B({x:q,y:Z})&&D(s)),a=requestAnimationFrame(O)}function W(N){const{nodeLookup:B,multiSelectionActive:E,nodesDraggable:R,transform:q,snapGrid:Z,snapToGrid:U,selectNodesOnDrag:X,onNodeDragStart:de,onSelectionDragStart:le,unselectNodesAndEdges:F}=e();f=!0,(!X||!M)&&!E&&I&&(B.get(I)?.selected||F()),M&&X&&I&&t?.(I);const V=gd(N.sourceEvent,{transform:q,snapGrid:Z,snapToGrid:U,containerBounds:u});if(s=V,o=kA(B,R,V,I),o.size>0&&(n||de||!I&&le)){const[G,se]=lg({nodeId:I,dragItems:o,nodeLookup:B});n?.(N.sourceEvent,o,G,se),de?.(N.sourceEvent,G,se),I||le?.(N.sourceEvent,se)}}const C=Fb().clickDistance(T).on("start",N=>{const{domNode:B,nodeDragThreshold:E,transform:R,snapGrid:q,snapToGrid:Z}=e();u=B?.getBoundingClientRect()||null,d=!1,y=!1,m=N.sourceEvent,E===0&&W(N),s=gd(N.sourceEvent,{transform:R,snapGrid:q,snapToGrid:Z,containerBounds:u}),c=Na(N.sourceEvent,u)}).on("drag",N=>{const{autoPanOnNodeDrag:B,transform:E,snapGrid:R,snapToGrid:q,nodeDragThreshold:Z,nodeLookup:U}=e(),X=gd(N.sourceEvent,{transform:E,snapGrid:R,snapToGrid:q,containerBounds:u});if(m=N.sourceEvent,(N.sourceEvent.type==="touchmove"&&N.sourceEvent.touches.length>1||I&&!U.has(I))&&(d=!0),!d){if(!l&&B&&f&&(l=!0,O()),!f){const de=Na(N.sourceEvent,u),le=de.x-c.x,F=de.y-c.y;Math.sqrt(le*le+F*F)>Z&&W(N)}(s.x!==X.xSnapped||s.y!==X.ySnapped)&&o&&f&&(c=Na(N.sourceEvent,u),D(X))}}).on("end",N=>{if(!(!f||d)&&(l=!1,f=!1,cancelAnimationFrame(a),o.size>0)){const{nodeLookup:B,updateNodePositions:E,onNodeDragStop:R,onSelectionDragStop:q}=e();if(y&&(E(o,!1),y=!1),r||R||!I&&q){const[Z,U]=lg({nodeId:I,dragItems:o,nodeLookup:B,dragging:!1});r?.(N.sourceEvent,o,Z,U),R?.(N.sourceEvent,Z,U),I||q?.(N.sourceEvent,U)}}}).filter(N=>{const B=N.target;return!N.button&&(!S||!wv(B,`.${S}`,_))&&(!A||wv(B,A,_))});h.call(C)}function w(){h?.on(".drag",null)}return{update:x,destroy:w}}function CA(t,e,n){const i=[],r={x:t.x-n,y:t.y-n,width:n*2,height:n*2};for(const s of e.values())Pd(r,Nu(s))>0&&i.push(s);return i}const PA=250;function EA(t,e,n,i){let r=[],s=1/0;const a=CA(t,n,e+PA);for(const o of a){const l=[...o.internals.handleBounds?.source??[],...o.internals.handleBounds?.target??[]];for(const c of l){if(i.nodeId===c.nodeId&&i.type===c.type&&i.id===c.id)continue;const{x:u,y:f}=kc(o,c,c.position,!0),h=Math.sqrt(Math.pow(u-t.x,2)+Math.pow(f-t.y,2));h>e||(h<s?(r=[{...c,x:u,y:f}],s=h):h===s&&r.push({...c,x:u,y:f}))}}if(!r.length)return null;if(r.length>1){const o=i.type==="source"?"target":"source";return r.find(l=>l.type===o)??r[0]}return r[0]}function f5(t,e,n,i,r,s=!1){const a=i.get(t);if(!a)return null;const o=r==="strict"?a.internals.handleBounds?.[e]:[...a.internals.handleBounds?.source??[],...a.internals.handleBounds?.target??[]],l=(n?o?.find(c=>c.id===n):o?.[0])??null;return l&&s?{...l,...kc(a,l,l.position,!0)}:l}function h5(t,e){return t||(e?.classList.contains("target")?"target":e?.classList.contains("source")?"source":null)}function IA(t,e){let n=null;return e?n=!0:t&&!e&&(n=!1),n}const p5=()=>!0;function LA(t,{connectionMode:e,connectionRadius:n,handleId:i,nodeId:r,edgeUpdaterType:s,isTarget:a,domNode:o,nodeLookup:l,lib:c,autoPanOnConnect:u,flowId:f,panBy:h,cancelConnection:d,onConnectStart:y,onConnect:m,onConnectEnd:x,isValidConnection:w=p5,onReconnectEnd:S,updateConnection:A,getTransform:_,getFromHandle:M,autoPanSpeed:I,dragThreshold:T=1,handleDomNode:D}){const O=i5(t.target);let W=0,C;const{x:N,y:B}=Na(t),E=h5(s,D),R=o?.getBoundingClientRect();let q=!1;if(!R||!E)return;const Z=f5(r,E,i,l,e);if(!Z)return;let U=Na(t,R),X=!1,de=null,le=!1,F=null;function V(){if(!u||!R)return;const[me,Pe]=t5(U,R,I);h({x:me,y:Pe}),W=requestAnimationFrame(V)}const G={...Z,nodeId:r,type:E,position:Z.position},se=l.get(r);let te={inProgress:!0,isValid:null,from:kc(se,G,Kt.Left,!0),fromHandle:G,fromPosition:G.position,fromNode:se,to:U,toHandle:null,toPosition:lv[G.position],toNode:null,pointer:U};function ue(){q=!0,A(te),y?.(t,{nodeId:r,handleId:i,handleType:E})}T===0&&ue();function pe(me){if(!q){const{x:Ke,y:Be}=Na(me),Ee=Ke-N,at=Be-B;if(!(Ee*Ee+at*at>T*T))return;ue()}if(!M()||!G){ge(me);return}const Pe=_();U=Na(me,R),C=EA(jd(U,Pe,!1,[1,1]),n,l,G),X||(V(),X=!0);const ke=g5(me,{handle:C,connectionMode:e,fromNodeId:r,fromHandleId:i,fromType:a?"target":"source",isValidConnection:w,doc:O,lib:c,flowId:f,nodeLookup:l});F=ke.handleDomNode,de=ke.connection,le=IA(!!C,ke.isValid);const Ge=l.get(r),K=Ge?kc(Ge,G,Kt.Left,!0):te.from,Oe={...te,from:K,isValid:le,to:ke.toHandle&&le?Eh({x:ke.toHandle.x,y:ke.toHandle.y},Pe):U,toHandle:ke.toHandle,toPosition:le&&ke.toHandle?ke.toHandle.position:lv[G.position],toNode:ke.toHandle?l.get(ke.toHandle.nodeId):null,pointer:U};A(Oe),te=Oe}function ge(me){if(!("touches"in me&&me.touches.length>0)){if(q){(C||F)&&de&&le&&m?.(de);const{inProgress:Pe,...ke}=te,Ge={...ke,toPosition:te.toHandle?te.toPosition:null};x?.(me,Ge),s&&S?.(me,Ge)}d(),cancelAnimationFrame(W),X=!1,le=!1,de=null,F=null,O.removeEventListener("mousemove",pe),O.removeEventListener("mouseup",ge),O.removeEventListener("touchmove",pe),O.removeEventListener("touchend",ge)}}O.addEventListener("mousemove",pe),O.addEventListener("mouseup",ge),O.addEventListener("touchmove",pe),O.addEventListener("touchend",ge)}function g5(t,{handle:e,connectionMode:n,fromNodeId:i,fromHandleId:r,fromType:s,doc:a,lib:o,flowId:l,isValidConnection:c=p5,nodeLookup:u}){const f=s==="target",h=e?a.querySelector(`.${o}-flow__handle[data-id="${l}-${e?.nodeId}-${e?.id}-${e?.type}"]`):null,{x:d,y}=Na(t),m=a.elementFromPoint(d,y),x=m?.classList.contains(`${o}-flow__handle`)?m:h,w={handleDomNode:x,isValid:!1,connection:null,toHandle:null};if(x){const S=h5(void 0,x),A=x.getAttribute("data-nodeid"),_=x.getAttribute("data-handleid"),M=x.classList.contains("connectable"),I=x.classList.contains("connectableend");if(!A||!S)return w;const T={source:f?A:i,sourceHandle:f?_:r,target:f?i:A,targetHandle:f?r:_};w.connection=T;const O=M&&I&&(n===ku.Strict?f&&S==="source"||!f&&S==="target":A!==i||_!==r);w.isValid=O&&c(T),w.toHandle=f5(A,S,_,u,n,!0)}return w}const xv={onPointerDown:LA,isValid:g5},ap=t=>({x:t.x,y:t.y,zoom:t.k}),cg=({x:t,y:e,zoom:n})=>tp.translate(t,e).scale(n),lu=(t,e)=>t.target.closest(`.${e}`),m5=(t,e)=>e===2&&Array.isArray(t)&&t.includes(2),MA=t=>((t*=2)<=1?t*t*t:(t-=2)*t*t+2)/2,ug=(t,e=0,n=MA,i=()=>{})=>{const r=typeof e=="number"&&e>0;return r||i(),r?t.transition().duration(e).ease(n).on("end",i):t},v5=t=>{const e=t.ctrlKey&&Ih()?10:1;return-t.deltaY*(t.deltaMode===1?.05:t.deltaMode?1:.002)*e};function TA({zoomPanValues:t,noWheelClassName:e,d3Selection:n,d3Zoom:i,panOnScrollMode:r,panOnScrollSpeed:s,zoomOnPinch:a,onPanZoomStart:o,onPanZoom:l,onPanZoomEnd:c}){return u=>{if(lu(u,e))return u.ctrlKey&&u.preventDefault(),!1;u.preventDefault(),u.stopImmediatePropagation();const f=n.property("__zoom").k||1;if(u.ctrlKey&&a){const x=$a(u),w=v5(u),S=f*Math.pow(2,w);i.scaleTo(n,S,x,u);return}const h=u.deltaMode===1?20:1;let d=r===hu.Vertical?0:u.deltaX*h,y=r===hu.Horizontal?0:u.deltaY*h;!Ih()&&u.shiftKey&&r!==hu.Vertical&&(d=u.deltaY*h,y=0),i.translateBy(n,-(d/f)*s,-(y/f)*s,{internal:!0});const m=ap(n.property("__zoom"));clearTimeout(t.panScrollTimeout),t.isPanScrolling?(l?.(u,m),t.panScrollTimeout=setTimeout(()=>{c?.(u,m),t.isPanScrolling=!1},150)):(t.isPanScrolling=!0,o?.(u,m))}}function DA({noWheelClassName:t,preventScrolling:e,d3ZoomHandler:n}){return function(i,r){const s=i.type==="wheel",a=!e&&s&&!i.ctrlKey,o=lu(i,t);if(i.ctrlKey&&s&&o&&i.preventDefault(),a||o)return null;i.preventDefault(),n.call(this,i,r)}}function OA({zoomPanValues:t,onDraggingChange:e,onPanZoomStart:n}){return i=>{if(i.sourceEvent?.internal)return;const r=ap(i.transform);t.mouseButton=i.sourceEvent?.button||0,t.isZoomingOrPanning=!0,t.prevViewport=r,i.sourceEvent?.type==="mousedown"&&e(!0),n&&n?.(i.sourceEvent,r)}}function FA({zoomPanValues:t,panOnDrag:e,onPaneContextMenu:n,onTransformChange:i,onPanZoom:r}){return s=>{t.usedRightMouseButton=!!(n&&m5(e,t.mouseButton??0)),s.sourceEvent?.sync||i([s.transform.x,s.transform.y,s.transform.k]),r&&!s.sourceEvent?.internal&&r?.(s.sourceEvent,ap(s.transform))}}function RA({zoomPanValues:t,panOnDrag:e,panOnScroll:n,onDraggingChange:i,onPanZoomEnd:r,onPaneContextMenu:s}){return a=>{if(!a.sourceEvent?.internal&&(t.isZoomingOrPanning=!1,s&&m5(e,t.mouseButton??0)&&!t.usedRightMouseButton&&a.sourceEvent&&s(a.sourceEvent),t.usedRightMouseButton=!1,i(!1),r)){const o=ap(a.transform);t.prevViewport=o,clearTimeout(t.timerId),t.timerId=setTimeout(()=>{r?.(a.sourceEvent,o)},n?150:0)}}}function BA({zoomActivationKeyPressed:t,zoomOnScroll:e,zoomOnPinch:n,panOnDrag:i,panOnScroll:r,zoomOnDoubleClick:s,userSelectionActive:a,noWheelClassName:o,noPanClassName:l,lib:c,connectionInProgress:u}){return f=>{const h=t||e,d=n&&f.ctrlKey,y=f.type==="wheel";if(f.button===1&&f.type==="mousedown"&&(lu(f,`${c}-flow__node`)||lu(f,`${c}-flow__edge`)))return!0;if(!i&&!h&&!r&&!s&&!n||a||u&&!y||lu(f,o)&&y||lu(f,l)&&(!y||r&&y&&!t)||!n&&f.ctrlKey&&y)return!1;if(!n&&f.type==="touchstart"&&f.touches?.length>1)return f.preventDefault(),!1;if(!h&&!r&&!d&&y||!i&&(f.type==="mousedown"||f.type==="touchstart")||Array.isArray(i)&&!i.includes(f.button)&&f.type==="mousedown")return!1;const m=Array.isArray(i)&&i.includes(f.button)||!f.button||f.button<=1;return(!f.ctrlKey||y)&&m}}function zA({domNode:t,minZoom:e,maxZoom:n,translateExtent:i,viewport:r,onPanZoom:s,onPanZoomStart:a,onPanZoomEnd:o,onDraggingChange:l}){const c={isZoomingOrPanning:!1,usedRightMouseButton:!1,prevViewport:{},mouseButton:0,timerId:void 0,panScrollTimeout:void 0,isPanScrolling:!1},u=t.getBoundingClientRect(),f=B6().scaleExtent([e,n]).translateExtent(i),h=$s(t).call(f);S({x:r.x,y:r.y,zoom:Au(r.zoom,e,n)},[[0,0],[u.width,u.height]],i);const d=h.on("wheel.zoom"),y=h.on("dblclick.zoom");f.wheelDelta(v5);function m(C,N){return h?new Promise(B=>{f?.interpolate(N?.interpolate==="linear"?pd:Jf).transform(ug(h,N?.duration,N?.ease,()=>B(!0)),C)}):Promise.resolve(!1)}function x({noWheelClassName:C,noPanClassName:N,onPaneContextMenu:B,userSelectionActive:E,panOnScroll:R,panOnDrag:q,panOnScrollMode:Z,panOnScrollSpeed:U,preventScrolling:X,zoomOnPinch:de,zoomOnScroll:le,zoomOnDoubleClick:F,zoomActivationKeyPressed:V,lib:G,onTransformChange:se,connectionInProgress:ae,paneClickDistance:te,selectionOnDrag:ue}){E&&!c.isZoomingOrPanning&&w();const pe=R&&!V&&!E;f.clickDistance(ue?1/0:!$o(te)||te<0?0:te);const ge=pe?TA({zoomPanValues:c,noWheelClassName:C,d3Selection:h,d3Zoom:f,panOnScrollMode:Z,panOnScrollSpeed:U,zoomOnPinch:de,onPanZoomStart:a,onPanZoom:s,onPanZoomEnd:o}):DA({noWheelClassName:C,preventScrolling:X,d3ZoomHandler:d});if(h.on("wheel.zoom",ge,{passive:!1}),!E){const Pe=OA({zoomPanValues:c,onDraggingChange:l,onPanZoomStart:a});f.on("start",Pe);const ke=FA({zoomPanValues:c,panOnDrag:q,onPaneContextMenu:!!B,onPanZoom:s,onTransformChange:se});f.on("zoom",ke);const Ge=RA({zoomPanValues:c,panOnDrag:q,panOnScroll:R,onPaneContextMenu:B,onPanZoomEnd:o,onDraggingChange:l});f.on("end",Ge)}const me=BA({zoomActivationKeyPressed:V,panOnDrag:q,zoomOnScroll:le,panOnScroll:R,zoomOnDoubleClick:F,zoomOnPinch:de,userSelectionActive:E,noPanClassName:N,noWheelClassName:C,lib:G,connectionInProgress:ae});f.filter(me),F?h.on("dblclick.zoom",y):h.on("dblclick.zoom",null)}function w(){f.on("zoom",null)}async function S(C,N,B){const E=cg(C),R=f?.constrain()(E,N,B);return R&&await m(R),new Promise(q=>q(R))}async function A(C,N){const B=cg(C);return await m(B,N),new Promise(E=>E(B))}function _(C){if(h){const N=cg(C),B=h.property("__zoom");(B.k!==C.zoom||B.x!==C.x||B.y!==C.y)&&f?.transform(h,N,null,{sync:!0})}}function M(){const C=h?Zb(h.node()):{x:0,y:0,k:1};return{x:C.x,y:C.y,zoom:C.k}}function I(C,N){return h?new Promise(B=>{f?.interpolate(N?.interpolate==="linear"?pd:Jf).scaleTo(ug(h,N?.duration,N?.ease,()=>B(!0)),C)}):Promise.resolve(!1)}function T(C,N){return h?new Promise(B=>{f?.interpolate(N?.interpolate==="linear"?pd:Jf).scaleBy(ug(h,N?.duration,N?.ease,()=>B(!0)),C)}):Promise.resolve(!1)}function D(C){f?.scaleExtent(C)}function O(C){f?.translateExtent(C)}function W(C){const N=!$o(C)||C<0?0:C;f?.clickDistance(N)}return{update:x,destroy:w,setViewport:A,setViewportConstrained:S,getViewport:M,scaleTo:I,scaleBy:T,setScaleExtent:D,setTranslateExtent:O,syncViewport:_,setClickDistance:W}}var Ed;(function(t){t.Line="line",t.Handle="handle"})(Ed||(Ed={}));const qA=["top-left","top-right","bottom-left","bottom-right"],jA=["top","right","bottom","left"];function HA({width:t,prevWidth:e,height:n,prevHeight:i,affectsX:r,affectsY:s}){const a=t-e,o=n-i,l=[a>0?1:a<0?-1:0,o>0?1:o<0?-1:0];return a&&r&&(l[0]=l[0]*-1),o&&s&&(l[1]=l[1]*-1),l}function _v(t){const e=t.includes("right")||t.includes("left"),n=t.includes("bottom")||t.includes("top"),i=t.includes("left"),r=t.includes("top");return{isHorizontal:e,isVertical:n,affectsX:i,affectsY:r}}function Il(t,e){return Math.max(0,e-t)}function Ll(t,e){return Math.max(0,t-e)}function Nf(t,e,n){return Math.max(0,e-t,t-n)}function Sv(t,e){return t?!e:e}function UA(t,e,n,i,r,s,a,o){let{affectsX:l,affectsY:c}=e;const{isHorizontal:u,isVertical:f}=e,h=u&&f,{xSnapped:d,ySnapped:y}=n,{minWidth:m,maxWidth:x,minHeight:w,maxHeight:S}=i,{x:A,y:_,width:M,height:I,aspectRatio:T}=t;let D=Math.floor(u?d-t.pointerX:0),O=Math.floor(f?y-t.pointerY:0);const W=M+(l?-D:D),C=I+(c?-O:O),N=-s[0]*M,B=-s[1]*I;let E=Nf(W,m,x),R=Nf(C,w,S);if(a){let U=0,X=0;l&&D<0?U=Il(A+D+N,a[0][0]):!l&&D>0&&(U=Ll(A+W+N,a[1][0])),c&&O<0?X=Il(_+O+B,a[0][1]):!c&&O>0&&(X=Ll(_+C+B,a[1][1])),E=Math.max(E,U),R=Math.max(R,X)}if(o){let U=0,X=0;l&&D>0?U=Ll(A+D,o[0][0]):!l&&D<0&&(U=Il(A+W,o[1][0])),c&&O>0?X=Ll(_+O,o[0][1]):!c&&O<0&&(X=Il(_+C,o[1][1])),E=Math.max(E,U),R=Math.max(R,X)}if(r){if(u){const U=Nf(W/T,w,S)*T;if(E=Math.max(E,U),a){let X=0;!l&&!c||l&&!c&&h?X=Ll(_+B+W/T,a[1][1])*T:X=Il(_+B+(l?D:-D)/T,a[0][1])*T,E=Math.max(E,X)}if(o){let X=0;!l&&!c||l&&!c&&h?X=Il(_+W/T,o[1][1])*T:X=Ll(_+(l?D:-D)/T,o[0][1])*T,E=Math.max(E,X)}}if(f){const U=Nf(C*T,m,x)/T;if(R=Math.max(R,U),a){let X=0;!l&&!c||c&&!l&&h?X=Ll(A+C*T+N,a[1][0])/T:X=Il(A+(c?O:-O)*T+N,a[0][0])/T,R=Math.max(R,X)}if(o){let X=0;!l&&!c||c&&!l&&h?X=Il(A+C*T,o[1][0])/T:X=Ll(A+(c?O:-O)*T,o[0][0])/T,R=Math.max(R,X)}}}O=O+(O<0?R:-R),D=D+(D<0?E:-E),r&&(h?W>C*T?O=(Sv(l,c)?-D:D)/T:D=(Sv(l,c)?-O:O)*T:u?(O=D/T,c=l):(D=O*T,l=c));const q=l?A+D:A,Z=c?_+O:_;return{width:M+(l?-D:D),height:I+(c?-O:O),x:s[0]*D*(l?-1:1)+q,y:s[1]*O*(c?-1:1)+Z}}const y5={width:0,height:0,x:0,y:0},WA={...y5,pointerX:0,pointerY:0,aspectRatio:1};function VA(t){return[[0,0],[t.measured.width,t.measured.height]]}function GA(t,e,n){const i=e.position.x+t.position.x,r=e.position.y+t.position.y,s=t.measured.width??0,a=t.measured.height??0,o=n[0]*s,l=n[1]*a;return[[i-o,r-l],[i+s-o,r+a-l]]}function XA({domNode:t,nodeId:e,getStoreItems:n,onChange:i,onEnd:r}){const s=$s(t);let a={controlDirection:_v("bottom-right"),boundaries:{minWidth:0,minHeight:0,maxWidth:Number.MAX_VALUE,maxHeight:Number.MAX_VALUE},resizeDirection:void 0,keepAspectRatio:!1};function o({controlPosition:c,boundaries:u,keepAspectRatio:f,resizeDirection:h,onResizeStart:d,onResize:y,onResizeEnd:m,shouldResize:x}){let w={...y5},S={...WA};a={boundaries:u,resizeDirection:h,keepAspectRatio:f,controlDirection:_v(c)};let A,_=null,M=[],I,T,D,O=!1;const W=Fb().on("start",C=>{const{nodeLookup:N,transform:B,snapGrid:E,snapToGrid:R,nodeOrigin:q,paneDomNode:Z}=n();if(A=N.get(e),!A)return;_=Z?.getBoundingClientRect()??null;const{xSnapped:U,ySnapped:X}=gd(C.sourceEvent,{transform:B,snapGrid:E,snapToGrid:R,containerBounds:_});w={width:A.measured.width??0,height:A.measured.height??0,x:A.position.x??0,y:A.position.y??0},S={...w,pointerX:U,pointerY:X,aspectRatio:w.width/w.height},I=void 0,A.parentId&&(A.extent==="parent"||A.expandParent)&&(I=N.get(A.parentId),T=I&&A.extent==="parent"?VA(I):void 0),M=[],D=void 0;for(const[de,le]of N)if(le.parentId===e&&(M.push({id:de,position:{...le.position},extent:le.extent}),le.extent==="parent"||le.expandParent)){const F=GA(le,A,le.origin??q);D?D=[[Math.min(F[0][0],D[0][0]),Math.min(F[0][1],D[0][1])],[Math.max(F[1][0],D[1][0]),Math.max(F[1][1],D[1][1])]]:D=F}d?.(C,{...w})}).on("drag",C=>{const{transform:N,snapGrid:B,snapToGrid:E,nodeOrigin:R}=n(),q=gd(C.sourceEvent,{transform:N,snapGrid:B,snapToGrid:E,containerBounds:_}),Z=[];if(!A)return;const{x:U,y:X,width:de,height:le}=w,F={},V=A.origin??R,{width:G,height:se,x:ae,y:te}=UA(S,a.controlDirection,q,a.boundaries,a.keepAspectRatio,V,T,D),ue=G!==de,pe=se!==le,ge=ae!==U&&ue,me=te!==X&&pe;if(!ge&&!me&&!ue&&!pe)return;if((ge||me||V[0]===1||V[1]===1)&&(F.x=ge?ae:w.x,F.y=me?te:w.y,w.x=F.x,w.y=F.y,M.length>0)){const K=ae-U,Oe=te-X;for(const Ke of M)Ke.position={x:Ke.position.x-K+V[0]*(G-de),y:Ke.position.y-Oe+V[1]*(se-le)},Z.push(Ke)}if((ue||pe)&&(F.width=ue&&(!a.resizeDirection||a.resizeDirection==="horizontal")?G:w.width,F.height=pe&&(!a.resizeDirection||a.resizeDirection==="vertical")?se:w.height,w.width=F.width,w.height=F.height),I&&A.expandParent){const K=V[0]*(F.width??0);F.x&&F.x<K&&(w.x=K,S.x=S.x-(F.x-K));const Oe=V[1]*(F.height??0);F.y&&F.y<Oe&&(w.y=Oe,S.y=S.y-(F.y-Oe))}const Pe=HA({width:w.width,prevWidth:de,height:w.height,prevHeight:le,affectsX:a.controlDirection.affectsX,affectsY:a.controlDirection.affectsY}),ke={...w,direction:Pe};x?.(C,ke)!==!1&&(O=!0,y?.(C,ke),i(F,Z))}).on("end",C=>{O&&(m?.(C,{...w}),r?.({...w}),O=!1)});s.call(W)}function l(){s.on(".drag",null)}return{update:o,destroy:l}}function P1(){const t={};return[e=>{if(e&&!P3(t))throw new Error(e);return o1(t)},e=>db(t,e)]}const[E1,YA]=P1(),[KA,ZA]=P1(),[JA,QA]=P1();var $A=Le("<div><!></div>");function Pu(t,e){Mt(e,!0);let n=ot(e,"id",3,null),i=ot(e,"type",3,"source"),r=ot(e,"position",19,()=>Kt.Top),s=ot(e,"isConnectableStart",3,!0),a=ot(e,"isConnectableEnd",3,!0),o=Tc(e,["$$slots","$$events","$$legacy","id","type","position","style","class","isConnectable","isConnectableStart","isConnectableEnd","isValidConnection","onconnect","ondisconnect","children"]);const l=E1("Handle must be used within a Custom Node component"),c=KA("Handle must be used within a Custom Node component");let u=re(()=>i()==="target"),f=re(()=>e.isConnectable!==void 0?e.isConnectable:c.value),h=Zl(),d=re(()=>h.ariaLabelConfig),y=null;fb(()=>{if(e.onconnect||e.ondisconnect){h.edges;let N=h.connectionLookup.get(`${l}-${i()}${n()?`-${n()}`:""}`);if(y&&!q6(N,y)){const B=N??new Map;cv(y,B,e.ondisconnect),cv(B,y,e.onconnect)}y=new Map(N)}});let m=re(()=>{if(!h.connection.inProgress)return[!1,!1,!1,!1,null];const{fromHandle:N,toHandle:B,isValid:E}=h.connection,R=N&&N.nodeId===l&&N.type===i()&&N.id===n(),q=B&&B.nodeId===l&&B.type===i()&&B.id===n(),Z=h.connectionMode===ku.Strict?N?.type!==i():l!==N?.nodeId||n()!==N?.id;return[!0,R,q,Z,q&&E]}),x=re(()=>Mc(p(m),5)),w=re(()=>p(x)[0]),S=re(()=>p(x)[1]),A=re(()=>p(x)[2]),_=re(()=>p(x)[3]),M=re(()=>p(x)[4]);function I(N){const B=h.onbeforeconnect?h.onbeforeconnect(N):N;B&&(h.addEdge(B),h.onconnect?.(N))}function T(N){const B=s5(N);N.currentTarget&&(B&&N.button===0||!B)&&xv.onPointerDown(N,{handleId:n(),nodeId:l,isTarget:p(u),connectionRadius:h.connectionRadius,domNode:h.domNode,nodeLookup:h.nodeLookup,connectionMode:h.connectionMode,lib:"svelte",autoPanOnConnect:h.autoPanOnConnect,autoPanSpeed:h.autoPanSpeed,flowId:h.flowId,isValidConnection:e.isValidConnection??h.isValidConnection,updateConnection:h.updateConnection,cancelConnection:h.cancelConnection,panBy:h.panBy,onConnect:I,onConnectStart:(E,R)=>{h.onconnectstart?.(E,{nodeId:R.nodeId,handleId:R.handleId,handleType:R.handleType})},onConnectEnd:(E,R)=>{h.onconnectend?.(E,R)},getTransform:()=>[h.viewport.x,h.viewport.y,h.viewport.zoom],getFromHandle:()=>h.connection.fromHandle,dragThreshold:h.connectionDragThreshold,handleDomNode:N.currentTarget})}function D(N){if(!l||!h.clickConnectStartHandle&&!s())return;if(!h.clickConnectStartHandle){h.onclickconnectstart?.(N,{nodeId:l,handleId:n(),handleType:i()}),h.clickConnectStartHandle={nodeId:l,type:i(),id:n()};return}const B=i5(N.target),E=e.isValidConnection??h.isValidConnection,{connectionMode:R,clickConnectStartHandle:q,flowId:Z,nodeLookup:U}=h,{connection:X,isValid:de}=xv.isValid(N,{handle:{nodeId:l,id:n(),type:i()},connectionMode:R,fromNodeId:q.nodeId,fromHandleId:q.id??null,fromType:q.type,isValidConnection:E,flowId:Z,doc:B,lib:"svelte",nodeLookup:U});de&&X&&I(X);const le=structuredClone(pb(h.connection));delete le.inProgress,le.toPosition=le.toHandle?le.toHandle.position:null,h.onclickconnectend?.(N,le),h.clickConnectStartHandle=null}var O=$A(),W=()=>{};Kl(O,()=>({"data-handleid":n(),"data-nodeid":l,"data-handlepos":r(),"data-id":`${h.flowId??""}-${l??""}-${n()??"null"??""}-${i()??""}`,class:["svelte-flow__handle",`svelte-flow__handle-${r()}`,h.noDragClass,h.noPanClass,r(),e.class],onmousedown:T,ontouchstart:T,onclick:h.clickConnect?D:void 0,onkeypress:W,style:e.style,role:"button","aria-label":p(d)["handle.ariaLabel"],tabindex:"-1",...o,[zl]:{valid:p(M),connectingto:p(A),connectingfrom:p(S),source:!p(u),target:p(u),connectablestart:s(),connectableend:a(),connectable:p(f),connectionindicator:p(f)&&(!p(w)||p(_))&&(p(w)||h.clickConnectStartHandle?a():s())}}));var C=ne(O);vs(C,()=>e.children??Qs),Q(O),j(t,O),Tt()}var eN=Le("<!> <!>",1);function b5(t,e){Mt(e,!0);let n=ot(e,"targetPosition",19,()=>Kt.Top),i=ot(e,"sourcePosition",19,()=>Kt.Bottom);var r=eN(),s=He(r);Pu(s,{type:"target",get position(){return n()}});var a=we(s),o=we(a);Pu(o,{type:"source",get position(){return i()}}),Ae(()=>Ht(a,` ${e.data?.label??""} `)),j(t,r),Tt()}var tN=Le(" <!>",1);function nN(t,e){Mt(e,!0);let n=ot(e,"data",19,()=>({label:"Node"})),i=ot(e,"sourcePosition",19,()=>Kt.Bottom);Mi();var r=tN(),s=He(r),a=we(s);Pu(a,{type:"source",get position(){return i()}}),Ae(()=>Ht(s,`${n()?.label??""} `)),j(t,r),Tt()}var iN=Le(" <!>",1);function rN(t,e){Mt(e,!0);let n=ot(e,"data",19,()=>({label:"Node"})),i=ot(e,"targetPosition",19,()=>Kt.Top);Mi();var r=iN(),s=He(r),a=we(s);Pu(a,{type:"target",get position(){return i()}}),Ae(()=>Ht(s,`${n()?.label??""} `)),j(t,r),Tt()}function sN(t,e){}function dg(t,e,n){if(!n||!e)return;const i=n==="root"?e:e.querySelector(`.svelte-flow__${n}`);i&&i.appendChild(t)}function aN(t,e){const n=re(Zl),i=re(()=>p(n).domNode);let r;return p(i)?dg(t,p(i),e):r=hb(()=>{pn(()=>{dg(t,p(i),e),r?.()})}),{async update(s){dg(t,p(i),s)},destroy(){t.parentNode&&t.parentNode.removeChild(t),r?.()}}}function oN(){let t=Fe(typeof window>"u");if(p(t)){const e=hb(()=>{pn(()=>{$(t,!1),e?.()})})}return{get value(){return p(t)}}}const kv=t=>H6(t),lN=t=>Qb(t);function uo(t){return t===void 0?void 0:`${t}px`}const Lh={ArrowUp:{x:0,y:-1},ArrowDown:{x:0,y:1},ArrowLeft:{x:-1,y:0},ArrowRight:{x:1,y:0}};var cN=Le("<div><!></div>");function uN(t,e){Mt(e,!0);let n=ot(e,"x",3,0),i=ot(e,"y",3,0),r=ot(e,"selectEdgeOnClick",3,!1),s=ot(e,"transparent",3,!1),a=Tc(e,["$$slots","$$events","$$legacy","x","y","width","height","selectEdgeOnClick","transparent","class","children"]);const o=Zl(),l=JA("EdgeLabel must be used within a Custom Edge component");let c=re(()=>o.visible.edges.get(l)?.zIndex);var u=cN(),f=()=>{r()&&l&&o.handleEdgeSelection(l)};Kl(u,d=>({class:["svelte-flow__edge-label",{transparent:s()},e.class],tabindex:"-1",onclick:f,...a,[Zo]:d}),[()=>({display:oN().value?"none":void 0,cursor:r()?"pointer":void 0,transform:`translate(-50%, -50%) translate(${n()??""}px,${i()??""}px)`,"pointer-events":"all",width:uo(e.width),height:uo(e.height),"z-index":p(c)})],void 0,void 0,"svelte-1wg91mu");var h=ne(u);vs(h,()=>e.children??Qs),Q(u),mt(u,(d,y)=>aN?.(d,y),()=>"edge-labels"),j(t,u),Tt()}var dN=nt("<path></path>"),fN=nt('<path fill="none"></path><!><!>',1);function Hd(t,e){let n=ot(e,"interactionWidth",3,20),i=Tc(e,["$$slots","$$events","$$legacy","id","path","label","labelX","labelY","labelStyle","markerStart","markerEnd","style","interactionWidth","class"]);var r=fN(),s=He(r),a=we(s);{var o=u=>{var f=dN();Kl(f,()=>({d:e.path,"stroke-opacity":0,"stroke-width":n(),fill:"none",class:"svelte-flow__edge-interaction",...i})),j(u,f)};Se(a,u=>{n()>0&&u(o)})}var l=we(a);{var c=u=>{uN(u,{get x(){return e.labelX},get y(){return e.labelY},get style(){return e.labelStyle},selectEdgeOnClick:!0,children:(f,h)=>{Mi();var d=tb();Ae(()=>Ht(d,e.label)),j(f,d)},$$slots:{default:!0}})};Se(l,u=>{e.label&&u(c)})}Ae(()=>{he(s,"id",e.id),he(s,"d",e.path),Xt(s,0,Dc(["svelte-flow__edge-path",e.class])),he(s,"marker-start",e.markerStart),he(s,"marker-end",e.markerEnd),Nn(s,e.style)}),j(t,r)}function w5(t,e){Mt(e,!0);let n=re(()=>a5({sourceX:e.sourceX,sourceY:e.sourceY,targetX:e.targetX,targetY:e.targetY,sourcePosition:e.sourcePosition,targetPosition:e.targetPosition,curvature:e.pathOptions?.curvature})),i=re(()=>Mc(p(n),3)),r=re(()=>p(i)[0]),s=re(()=>p(i)[1]),a=re(()=>p(i)[2]);Hd(t,{get id(){return e.id},get path(){return p(r)},get labelX(){return p(s)},get labelY(){return p(a)},get label(){return e.label},get labelStyle(){return e.labelStyle},get markerStart(){return e.markerStart},get markerEnd(){return e.markerEnd},get interactionWidth(){return e.interactionWidth},get style(){return e.style}}),Tt()}function hN(t,e){Mt(e,!0);let n=re(()=>sp({sourceX:e.sourceX,sourceY:e.sourceY,targetX:e.targetX,targetY:e.targetY,sourcePosition:e.sourcePosition,targetPosition:e.targetPosition})),i=re(()=>Mc(p(n),3)),r=re(()=>p(i)[0]),s=re(()=>p(i)[1]),a=re(()=>p(i)[2]);Hd(t,{get path(){return p(r)},get labelX(){return p(s)},get labelY(){return p(a)},get label(){return e.label},get labelStyle(){return e.labelStyle},get markerStart(){return e.markerStart},get markerEnd(){return e.markerEnd},get interactionWidth(){return e.interactionWidth},get style(){return e.style}}),Tt()}function pN(t,e){Mt(e,!0);let n=re(()=>l5({sourceX:e.sourceX,sourceY:e.sourceY,targetX:e.targetX,targetY:e.targetY})),i=re(()=>Mc(p(n),3)),r=re(()=>p(i)[0]),s=re(()=>p(i)[1]),a=re(()=>p(i)[2]);Hd(t,{get path(){return p(r)},get labelX(){return p(s)},get labelY(){return p(a)},get label(){return e.label},get labelStyle(){return e.labelStyle},get markerStart(){return e.markerStart},get markerEnd(){return e.markerEnd},get interactionWidth(){return e.interactionWidth},get style(){return e.style}}),Tt()}function gN(t,e){Mt(e,!0);let n=re(()=>sp({sourceX:e.sourceX,sourceY:e.sourceY,targetX:e.targetX,targetY:e.targetY,sourcePosition:e.sourcePosition,targetPosition:e.targetPosition,borderRadius:0})),i=re(()=>Mc(p(n),3)),r=re(()=>p(i)[0]),s=re(()=>p(i)[1]),a=re(()=>p(i)[2]);Hd(t,{get path(){return p(r)},get labelX(){return p(s)},get labelY(){return p(a)},get label(){return e.label},get labelStyle(){return e.labelStyle},get markerStart(){return e.markerStart},get markerEnd(){return e.markerEnd},get interactionWidth(){return e.interactionWidth},get style(){return e.style}}),Tt()}class mN{#e;#t;constructor(e,n){this.#e=e,this.#t=R3(n)}get current(){return this.#t(),this.#e()}}const vN=/\(.+\)/,yN=new Set(["all","print","screen","and","or","not","only"]);class bN extends mN{constructor(e,n){let i=vN.test(e)||e.split(/[\s,]+/).some(s=>yN.has(s.trim()))?e:`(${e})`;const r=window.matchMedia(i);super(()=>r.matches,s=>dm(r,"change",s))}}function wN(t,e,n,i){const r=new Map;return _1(t,{x:0,y:0,width:n,height:i},e,!0).forEach(s=>{r.set(s.id,s)}),r}function Av(t){const{edges:e,defaultEdgeOptions:n,nodeLookup:i,previousEdges:r,connectionMode:s,onerror:a,onlyRenderVisible:o,elevateEdgesOnSelect:l,zIndexMode:c}=t,u=new Map;for(const f of e){const h=i.get(f.source),d=i.get(f.target);if(!h||!d)continue;if(o){const{visibleNodes:x,transform:w,width:S,height:A}=t;if(rA({sourceNode:h,targetNode:d,width:S,height:A,transform:w}))x.set(h.id,h),x.set(d.id,d);else continue}const y=r.get(f.id);if(y&&f===y.edge&&h==y.sourceNode&&d==y.targetNode){u.set(f.id,y);continue}const m=dA({id:f.id,sourceNode:h,targetNode:d,sourceHandle:f.sourceHandle||null,targetHandle:f.targetHandle||null,connectionMode:s,onError:a});m&&u.set(f.id,{...n,...f,...m,zIndex:iA({selected:f.selected,zIndex:f.zIndex??n.zIndex,sourceNode:h,targetNode:d,elevateOnSelect:l,zIndexMode:c}),sourceNode:h,targetNode:d,edge:f})}return u}const x5={input:nN,output:rN,default:b5,group:sN},_5={straight:pN,smoothstep:hN,default:w5,step:gN};function xN(t,e,n,i,r,s){if(e&&!n&&i&&r){const a=np(s,{filter:o=>!!((o.width||o.initialWidth)&&(o.height||o.initialHeight))});return S1(a,i,r,.5,2,.1)}else return n??{x:0,y:0,zoom:1}}function _N(t){class e{#e=re(()=>t.props.id??"1");get flowId(){return p(this.#e)}set flowId(i){$(this.#e,i)}#t=Fe(null);get domNode(){return p(this.#t)}set domNode(i){$(this.#t,i)}#n=Fe(null);get panZoom(){return p(this.#n)}set panZoom(i){$(this.#n,i)}#i=Fe(t.width??0);get width(){return p(this.#i)}set width(i){$(this.#i,i)}#r=Fe(t.height??0);get height(){return p(this.#r)}set height(i){$(this.#r,i)}#s=Fe(t.props.zIndexMode??"basic");get zIndexMode(){return p(this.#s)}set zIndexMode(i){$(this.#s,i)}#a=re(()=>{const i=vA(t.nodes,this.nodeLookup,this.parentLookup,{nodeExtent:this.nodeExtent,nodeOrigin:this.nodeOrigin,elevateNodesOnSelect:t.props.elevateNodesOnSelect??!0,checkEquality:!0,zIndexMode:this.zIndexMode});return this.fitViewQueued&&i&&(this.fitViewOptions?.duration?this.resolveFitView():queueMicrotask(()=>{this.resolveFitView()})),i});get nodesInitialized(){return p(this.#a)}set nodesInitialized(i){$(this.#a,i)}#o=re(()=>this.panZoom!==null);get viewportInitialized(){return p(this.#o)}set viewportInitialized(i){$(this.#o,i)}#l=re(()=>(SA(this.connectionLookup,this.edgeLookup,t.edges),t.edges));get _edges(){return p(this.#l)}set _edges(i){$(this.#l,i)}get nodes(){return this.nodesInitialized,t.nodes}set nodes(i){t.nodes=i}get edges(){return this._edges}set edges(i){t.edges=i}_prevSelectedNodes=[];_prevSelectedNodeIds=new Set;#c=re(()=>{const i=this._prevSelectedNodeIds.size,r=new Set,s=this.nodes.filter(a=>(a.selected&&(r.add(a.id),this._prevSelectedNodeIds.delete(a.id)),a.selected));return(i!==r.size||this._prevSelectedNodeIds.size>0)&&(this._prevSelectedNodes=s),this._prevSelectedNodeIds=r,this._prevSelectedNodes});get selectedNodes(){return p(this.#c)}set selectedNodes(i){$(this.#c,i)}_prevSelectedEdges=[];_prevSelectedEdgeIds=new Set;#u=re(()=>{const i=this._prevSelectedEdgeIds.size,r=new Set,s=this.edges.filter(a=>(a.selected&&(r.add(a.id),this._prevSelectedEdgeIds.delete(a.id)),a.selected));return(i!==r.size||this._prevSelectedEdgeIds.size>0)&&(this._prevSelectedEdges=s),this._prevSelectedEdgeIds=r,this._prevSelectedEdges});get selectedEdges(){return p(this.#u)}set selectedEdges(i){$(this.#u,i)}selectionChangeHandlers=new Map;nodeLookup=new Map;parentLookup=new Map;connectionLookup=new Map;edgeLookup=new Map;_prevVisibleEdges=new Map;#d=re(()=>{const{nodes:i,_edges:r,_prevVisibleEdges:s,nodeLookup:a,connectionMode:o,onerror:l,onlyRenderVisibleElements:c,defaultEdgeOptions:u,zIndexMode:f}=this;let h,d;const y={edges:r,defaultEdgeOptions:u,previousEdges:s,nodeLookup:a,connectionMode:o,elevateEdgesOnSelect:t.props.elevateEdgesOnSelect??!0,zIndexMode:f,onerror:l};if(c){const{viewport:m,width:x,height:w}=this,S=[m.x,m.y,m.zoom];h=wN(a,S,x,w),d=Av({...y,onlyRenderVisible:!0,visibleNodes:h,transform:S,width:x,height:w})}else h=this.nodeLookup,d=Av(y);return{nodes:h,edges:d}});get visible(){return p(this.#d)}set visible(i){$(this.#d,i)}#f=re(()=>t.props.nodesDraggable??!0);get nodesDraggable(){return p(this.#f)}set nodesDraggable(i){$(this.#f,i)}#h=re(()=>t.props.nodesConnectable??!0);get nodesConnectable(){return p(this.#h)}set nodesConnectable(i){$(this.#h,i)}#p=re(()=>t.props.elementsSelectable??!0);get elementsSelectable(){return p(this.#p)}set elementsSelectable(i){$(this.#p,i)}#g=re(()=>t.props.nodesFocusable??!0);get nodesFocusable(){return p(this.#g)}set nodesFocusable(i){$(this.#g,i)}#m=re(()=>t.props.edgesFocusable??!0);get edgesFocusable(){return p(this.#m)}set edgesFocusable(i){$(this.#m,i)}#v=re(()=>t.props.disableKeyboardA11y??!1);get disableKeyboardA11y(){return p(this.#v)}set disableKeyboardA11y(i){$(this.#v,i)}#y=re(()=>t.props.minZoom??.5);get minZoom(){return p(this.#y)}set minZoom(i){$(this.#y,i)}#b=re(()=>t.props.maxZoom??2);get maxZoom(){return p(this.#b)}set maxZoom(i){$(this.#b,i)}#w=re(()=>t.props.nodeOrigin??[0,0]);get nodeOrigin(){return p(this.#w)}set nodeOrigin(i){$(this.#w,i)}#x=re(()=>t.props.nodeExtent??_m);get nodeExtent(){return p(this.#x)}set nodeExtent(i){$(this.#x,i)}#_=re(()=>t.props.translateExtent??_m);get translateExtent(){return p(this.#_)}set translateExtent(i){$(this.#_,i)}#S=re(()=>t.props.defaultEdgeOptions??{});get defaultEdgeOptions(){return p(this.#S)}set defaultEdgeOptions(i){$(this.#S,i)}#k=re(()=>t.props.nodeDragThreshold??1);get nodeDragThreshold(){return p(this.#k)}set nodeDragThreshold(i){$(this.#k,i)}#A=re(()=>t.props.autoPanOnNodeDrag??!0);get autoPanOnNodeDrag(){return p(this.#A)}set autoPanOnNodeDrag(i){$(this.#A,i)}#N=re(()=>t.props.autoPanOnConnect??!0);get autoPanOnConnect(){return p(this.#N)}set autoPanOnConnect(i){$(this.#N,i)}#C=re(()=>t.props.autoPanOnNodeFocus??!0);get autoPanOnNodeFocus(){return p(this.#C)}set autoPanOnNodeFocus(i){$(this.#C,i)}#P=re(()=>t.props.autoPanSpeed??15);get autoPanSpeed(){return p(this.#P)}set autoPanSpeed(i){$(this.#P,i)}#E=re(()=>t.props.connectionDragThreshold??1);get connectionDragThreshold(){return p(this.#E)}set connectionDragThreshold(i){$(this.#E,i)}fitViewQueued=t.props.fitView??!1;fitViewOptions=t.props.fitViewOptions;fitViewResolver=null;#I=re(()=>t.props.snapGrid??null);get snapGrid(){return p(this.#I)}set snapGrid(i){$(this.#I,i)}#L=Fe(!1);get dragging(){return p(this.#L)}set dragging(i){$(this.#L,i)}#M=Fe(null);get selectionRect(){return p(this.#M)}set selectionRect(i){$(this.#M,i)}#T=Fe(!1);get selectionKeyPressed(){return p(this.#T)}set selectionKeyPressed(i){$(this.#T,i)}#D=Fe(!1);get multiselectionKeyPressed(){return p(this.#D)}set multiselectionKeyPressed(i){$(this.#D,i)}#O=Fe(!1);get deleteKeyPressed(){return p(this.#O)}set deleteKeyPressed(i){$(this.#O,i)}#F=Fe(!1);get panActivationKeyPressed(){return p(this.#F)}set panActivationKeyPressed(i){$(this.#F,i)}#R=Fe(!1);get zoomActivationKeyPressed(){return p(this.#R)}set zoomActivationKeyPressed(i){$(this.#R,i)}#B=Fe(null);get selectionRectMode(){return p(this.#B)}set selectionRectMode(i){$(this.#B,i)}#z=Fe("");get ariaLiveMessage(){return p(this.#z)}set ariaLiveMessage(i){$(this.#z,i)}#q=re(()=>t.props.selectionMode??Nh.Partial);get selectionMode(){return p(this.#q)}set selectionMode(i){$(this.#q,i)}#j=re(()=>({...x5,...t.props.nodeTypes}));get nodeTypes(){return p(this.#j)}set nodeTypes(i){$(this.#j,i)}#H=re(()=>({..._5,...t.props.edgeTypes}));get edgeTypes(){return p(this.#H)}set edgeTypes(i){$(this.#H,i)}#U=re(()=>t.props.noPanClass??"nopan");get noPanClass(){return p(this.#U)}set noPanClass(i){$(this.#U,i)}#W=re(()=>t.props.noDragClass??"nodrag");get noDragClass(){return p(this.#W)}set noDragClass(i){$(this.#W,i)}#V=re(()=>t.props.noWheelClass??"nowheel");get noWheelClass(){return p(this.#V)}set noWheelClass(i){$(this.#V,i)}#G=re(()=>eA(t.props.ariaLabelConfig));get ariaLabelConfig(){return p(this.#G)}set ariaLabelConfig(i){$(this.#G,i)}#X=Fe(xN(this.nodesInitialized,t.props.fitView,t.props.initialViewport,this.width,this.height,this.nodeLookup));get _viewport(){return p(this.#X)}set _viewport(i){$(this.#X,i)}get viewport(){return t.viewport??this._viewport}set viewport(i){t.viewport&&(t.viewport=i),this._viewport=i}#Y=Fe(Sm);get _connection(){return p(this.#Y)}set _connection(i){$(this.#Y,i)}#K=re(()=>this._connection.inProgress?{...this._connection,to:jd(this._connection.to,[this.viewport.x,this.viewport.y,this.viewport.zoom])}:this._connection);get connection(){return p(this.#K)}set connection(i){$(this.#K,i)}#Z=re(()=>t.props.connectionMode??ku.Strict);get connectionMode(){return p(this.#Z)}set connectionMode(i){$(this.#Z,i)}#J=re(()=>t.props.connectionRadius??20);get connectionRadius(){return p(this.#J)}set connectionRadius(i){$(this.#J,i)}#Q=re(()=>t.props.isValidConnection??(()=>!0));get isValidConnection(){return p(this.#Q)}set isValidConnection(i){$(this.#Q,i)}#$=re(()=>t.props.selectNodesOnDrag??!0);get selectNodesOnDrag(){return p(this.#$)}set selectNodesOnDrag(i){$(this.#$,i)}#ee=re(()=>t.props.defaultMarkerColor===void 0?"#b1b1b7":t.props.defaultMarkerColor);get defaultMarkerColor(){return p(this.#ee)}set defaultMarkerColor(i){$(this.#ee,i)}#te=re(()=>fA(t.edges,{defaultColor:this.defaultMarkerColor,id:this.flowId,defaultMarkerStart:this.defaultEdgeOptions.markerStart,defaultMarkerEnd:this.defaultEdgeOptions.markerEnd}));get markers(){return p(this.#te)}set markers(i){$(this.#te,i)}#ne=re(()=>t.props.onlyRenderVisibleElements??!1);get onlyRenderVisibleElements(){return p(this.#ne)}set onlyRenderVisibleElements(i){$(this.#ne,i)}#ie=re(()=>t.props.onflowerror??K6);get onerror(){return p(this.#ie)}set onerror(i){$(this.#ie,i)}#re=re(()=>t.props.ondelete);get ondelete(){return p(this.#re)}set ondelete(i){$(this.#re,i)}#se=re(()=>t.props.onbeforedelete);get onbeforedelete(){return p(this.#se)}set onbeforedelete(i){$(this.#se,i)}#ae=re(()=>t.props.onbeforeconnect);get onbeforeconnect(){return p(this.#ae)}set onbeforeconnect(i){$(this.#ae,i)}#oe=re(()=>t.props.onconnect);get onconnect(){return p(this.#oe)}set onconnect(i){$(this.#oe,i)}#le=re(()=>t.props.onconnectstart);get onconnectstart(){return p(this.#le)}set onconnectstart(i){$(this.#le,i)}#ce=re(()=>t.props.onconnectend);get onconnectend(){return p(this.#ce)}set onconnectend(i){$(this.#ce,i)}#ue=re(()=>t.props.onbeforereconnect);get onbeforereconnect(){return p(this.#ue)}set onbeforereconnect(i){$(this.#ue,i)}#de=re(()=>t.props.onreconnect);get onreconnect(){return p(this.#de)}set onreconnect(i){$(this.#de,i)}#fe=re(()=>t.props.onreconnectstart);get onreconnectstart(){return p(this.#fe)}set onreconnectstart(i){$(this.#fe,i)}#he=re(()=>t.props.onreconnectend);get onreconnectend(){return p(this.#he)}set onreconnectend(i){$(this.#he,i)}#pe=re(()=>t.props.clickConnect??!0);get clickConnect(){return p(this.#pe)}set clickConnect(i){$(this.#pe,i)}#ge=re(()=>t.props.onclickconnectstart);get onclickconnectstart(){return p(this.#ge)}set onclickconnectstart(i){$(this.#ge,i)}#me=re(()=>t.props.onclickconnectend);get onclickconnectend(){return p(this.#me)}set onclickconnectend(i){$(this.#me,i)}#ve=Fe(null);get clickConnectStartHandle(){return p(this.#ve)}set clickConnectStartHandle(i){$(this.#ve,i)}#ye=re(()=>t.props.onselectiondrag);get onselectiondrag(){return p(this.#ye)}set onselectiondrag(i){$(this.#ye,i)}#be=re(()=>t.props.onselectiondragstart);get onselectiondragstart(){return p(this.#be)}set onselectiondragstart(i){$(this.#be,i)}#we=re(()=>t.props.onselectiondragstop);get onselectiondragstop(){return p(this.#we)}set onselectiondragstop(i){$(this.#we,i)}resolveFitView=async()=>{this.panZoom&&(await G6({nodes:this.nodeLookup,width:this.width,height:this.height,panZoom:this.panZoom,minZoom:this.minZoom,maxZoom:this.maxZoom},this.fitViewOptions),this.fitViewResolver?.resolve(!0),this.fitViewQueued=!1,this.fitViewOptions=void 0,this.fitViewResolver=null)};_prefersDark=new bN("(prefers-color-scheme: dark)",t.props.colorModeSSR==="dark");#xe=re(()=>t.props.colorMode==="system"?this._prefersDark.current?"dark":"light":t.props.colorMode??"light");get colorMode(){return p(this.#xe)}set colorMode(i){$(this.#xe,i)}constructor(){}resetStoreValues(){this.dragging=!1,this.selectionRect=null,this.selectionRectMode=null,this.selectionKeyPressed=!1,this.multiselectionKeyPressed=!1,this.deleteKeyPressed=!1,this.panActivationKeyPressed=!1,this.zoomActivationKeyPressed=!1,this._connection=Sm,this.clickConnectStartHandle=null,this.viewport=t.props.initialViewport??{x:0,y:0,zoom:1},this.ariaLiveMessage=""}}return new e}function Zl(){const t=o1(Nm);if(!t)throw new Error("To call useStore outside of <SvelteFlow /> you need to wrap your component in a <SvelteFlowProvider />");return t.getStore()}const Nm=Symbol();function SN(t){const e=_N(t);function n(C){e.nodeTypes={...x5,...C}}function i(C){e.edgeTypes={..._5,...C}}function r(C){e.edges=oA(C,e.edges)}const s=(C,N=!1)=>{e.nodes=e.nodes.map(B=>{if(e.connection.inProgress&&e.connection.fromNode.id===B.id){const R=e.nodeLookup.get(B.id);R&&(e.connection={...e.connection,from:kc(R,e.connection.fromHandle,Kt.Left,!0)})}const E=C.get(B.id);return E?{...B,position:E.position,dragging:N}:B})};function a(C){const{changes:N,updatedInternals:B}=xA(C,e.nodeLookup,e.parentLookup,e.domNode,e.nodeOrigin,e.nodeExtent,e.zIndexMode);if(!B)return;gA(e.nodeLookup,e.parentLookup,{nodeOrigin:e.nodeOrigin,nodeExtent:e.nodeExtent,zIndexMode:e.zIndexMode}),e.fitViewQueued&&e.resolveFitView();const E=new Map;for(const R of N){const q=e.nodeLookup.get(R.id)?.internals.userNode;if(!q)continue;const Z={...q};switch(R.type){case"dimensions":{const U={...Z.measured,...R.dimensions};R.setAttributes&&(Z.width=R.dimensions?.width??Z.width,Z.height=R.dimensions?.height??Z.height),Z.measured=U;break}case"position":Z.position=R.position??Z.position;break}E.set(R.id,Z)}e.nodes=e.nodes.map(R=>E.get(R.id)??R)}function o(C){const N=e.fitViewResolver??Promise.withResolvers();return e.fitViewQueued=!0,e.fitViewOptions=C,e.fitViewResolver=N,e.nodes=[...e.nodes],N.promise}async function l(C,N,B){const E=typeof B?.zoom<"u"?B.zoom:e.maxZoom,R=e.panZoom;return R?(await R.setViewport({x:e.width/2-C*E,y:e.height/2-N*E,zoom:E},{duration:B?.duration,ease:B?.ease,interpolate:B?.interpolate}),Promise.resolve(!0)):Promise.resolve(!1)}function c(C,N){const B=e.panZoom;return B?B.scaleBy(C,N):Promise.resolve(!1)}function u(C){return c(1.2,C)}function f(C){return c(1/1.2,C)}function h(C){const N=e.panZoom;N&&(N.setScaleExtent([C,e.maxZoom]),e.minZoom=C)}function d(C){const N=e.panZoom;N&&(N.setScaleExtent([e.minZoom,C]),e.maxZoom=C)}function y(C){const N=e.panZoom;N&&(N.setTranslateExtent(C),e.translateExtent=C)}function m(C,N=null){let B=!1;const E=C.map(R=>(N?N.has(R.id):!0)&&R.selected?(B=!0,{...R,selected:!1}):R);return[B,E]}function x(C){const N=C?.nodes?new Set(C.nodes.map(U=>U.id)):null,[B,E]=m(e.nodes,N);B&&(e.nodes=E);const R=C?.edges?new Set(C.edges.map(U=>U.id)):null,[q,Z]=m(e.edges,R);q&&(e.edges=Z)}function w(C){const N=e.multiselectionKeyPressed;e.nodes=e.nodes.map(B=>{const E=C.includes(B.id),R=N&&B.selected||E;return!!B.selected!==R?{...B,selected:R}:B}),N||x({nodes:[]})}function S(C){const N=e.multiselectionKeyPressed;e.edges=e.edges.map(B=>{const E=C.includes(B.id),R=N&&B.selected||E;return!!B.selected!==R?{...B,selected:R}:B}),N||x({edges:[]})}function A(C,N,B){const E=e.nodeLookup.get(C);if(!E){console.warn("012",Cd.error012(C));return}e.selectionRect=null,e.selectionRectMode=null,E.selected?(N||E.selected&&e.multiselectionKeyPressed)&&(x({nodes:[E],edges:[]}),requestAnimationFrame(()=>B?.blur())):w([C])}function _(C){const N=e.edgeLookup.get(C);if(!N){console.warn("012",Cd.error012(C));return}(N.selectable||e.elementsSelectable&&typeof N.selectable>"u")&&(e.selectionRect=null,e.selectionRectMode=null,N.selected?N.selected&&e.multiselectionKeyPressed&&x({nodes:[],edges:[N]}):S([C]))}function M(C,N){const{nodeExtent:B,snapGrid:E,nodeOrigin:R,nodeLookup:q,nodesDraggable:Z,onerror:U}=e,X=new Map,de=E?.[0]??5,le=E?.[1]??5,F=C.x*de*N,V=C.y*le*N;for(const G of q.values()){if(!(G.selected&&(G.draggable||Z&&typeof G.draggable>"u")))continue;let ae={x:G.internals.positionAbsolute.x+F,y:G.internals.positionAbsolute.y+V};E&&(ae=qd(ae,E));const{position:te,positionAbsolute:ue}=$b({nodeId:G.id,nextPosition:ae,nodeLookup:q,nodeExtent:B,nodeOrigin:R,onError:U});G.position=te,G.internals.positionAbsolute=ue,X.set(G.id,G)}s(X)}function I(C){return _A({delta:C,panZoom:e.panZoom,transform:[e.viewport.x,e.viewport.y,e.viewport.zoom],translateExtent:e.translateExtent,width:e.width,height:e.height})}const T=C=>{e._connection={...C}};function D(){e._connection=Sm}function O(){e.resetStoreValues(),x()}return Object.assign(e,{setNodeTypes:n,setEdgeTypes:i,addEdge:r,updateNodePositions:s,updateNodeInternals:a,zoomIn:u,zoomOut:f,fitView:o,setCenter:l,setMinZoom:h,setMaxZoom:d,setTranslateExtent:y,unselectNodesAndEdges:x,addSelectedNodes:w,addSelectedEdges:S,handleNodeSelection:A,handleEdgeSelection:_,moveSelectedNodes:M,panBy:I,updateConnection:T,cancelConnection:D,reset:O})}function kN(t,e){const{minZoom:n,maxZoom:i,initialViewport:r,onPanZoomStart:s,onPanZoom:a,onPanZoomEnd:o,translateExtent:l,setPanZoomInstance:c,onDraggingChange:u,onTransformChange:f}=e,h=zA({domNode:t,minZoom:n,maxZoom:i,translateExtent:l,viewport:r,onPanZoom:a,onPanZoomStart:s,onPanZoomEnd:o,onDraggingChange:u}),d=h.getViewport();return(r.x!==d.x||r.y!==d.y||r.zoom!==d.zoom)&&f([d.x,d.y,d.zoom]),c(h),h.update(e),{update(y){h.update(y)}}}var AN=Le('<div class="svelte-flow__zoom svelte-flow__container"><!></div>');function NN(t,e){Mt(e,!0);let n=ot(e,"store",15),i=re(()=>n().panActivationKeyPressed||e.panOnDrag),r=re(()=>n().panActivationKeyPressed||e.panOnScroll);const{viewport:s}=n();let a=!1;pn(()=>{!a&&n().viewportInitialized&&(e.oninit?.(),a=!0)});var o=AN(),l=ne(o);vs(l,()=>e.children),Q(o),mt(o,(c,u)=>kN?.(c,u),()=>({viewport:n().viewport,minZoom:n().minZoom,maxZoom:n().maxZoom,initialViewport:s,onDraggingChange:c=>{n(n().dragging=c,!0)},setPanZoomInstance:c=>{n(n().panZoom=c,!0)},onPanZoomStart:e.onmovestart,onPanZoom:e.onmove,onPanZoomEnd:e.onmoveend,zoomOnScroll:e.zoomOnScroll,zoomOnDoubleClick:e.zoomOnDoubleClick,zoomOnPinch:e.zoomOnPinch,panOnScroll:p(r),panOnDrag:p(i),panOnScrollSpeed:e.panOnScrollSpeed,panOnScrollMode:e.panOnScrollMode,zoomActivationKeyPressed:n().zoomActivationKeyPressed,preventScrolling:typeof e.preventScrolling=="boolean"?e.preventScrolling:!0,noPanClassName:n().noPanClass,noWheelClassName:n().noWheelClass,userSelectionActive:!!n().selectionRect,translateExtent:n().translateExtent,lib:"svelte",paneClickDistance:e.paneClickDistance,selectionOnDrag:e.selectionOnDrag,onTransformChange:c=>{n(n().viewport={x:c[0],y:c[1],zoom:c[2]},!0)},connectionInProgress:n().connection.inProgress})),j(t,o),Tt()}function Nv(t,e){return n=>{n.target===e&&t?.(n)}}function Cv(t){return e=>{const n=t.has(e.id);return!!e.selected!==n?{...e,selected:n}:e}}function Pv(t,e){if(t.size!==e.size)return!1;for(const n of t)if(!e.has(n))return!1;return!0}var CN=Le("<div><!></div>");function PN(t,e){Mt(e,!0);let n=ot(e,"store",15),i=ot(e,"panOnDrag",3,!0),r=ot(e,"paneClickDistance",3,1),s,a=null,o=new Set,l=new Set,c=re(()=>n().panActivationKeyPressed||i()),u=re(()=>n().selectionKeyPressed||!!n().selectionRect||e.selectionOnDrag&&p(c)!==!0),f=re(()=>n().elementsSelectable&&(p(u)||n().selectionRectMode==="user")),h=!1;function d(D){if(a=s?.getBoundingClientRect(),!a)return;const O=D.target===s,W=!O&&!!D.target.closest(".nokey"),C=e.selectionOnDrag&&O||n().selectionKeyPressed;if(W||!p(u)||!C||D.button!==0||!D.isPrimary)return;D.target?.setPointerCapture?.(D.pointerId),h=!1;const{x:N,y:B}=Na(D,a);n(n().selectionRect={width:0,height:0,startX:N,startY:B,x:N,y:B},!0),O||(D.stopPropagation(),D.preventDefault())}function y(D){if(!p(u)||!a||!n().selectionRect)return;const O=Na(D,a),{startX:W=0,startY:C=0}=n().selectionRect;if(!h){const q=n().selectionKeyPressed?0:r();if(Math.hypot(O.x-W,O.y-C)<=q)return;n().unselectNodesAndEdges(),e.onselectionstart?.(D)}h=!0;const N={...n().selectionRect,x:O.x<W?O.x:W,y:O.y<C?O.y:C,width:Math.abs(O.x-W),height:Math.abs(O.y-C)},B=o,E=l;o=new Set(_1(n().nodeLookup,N,[n().viewport.x,n().viewport.y,n().viewport.zoom],n().selectionMode===Nh.Partial,!0).map(q=>q.id));const R=n().defaultEdgeOptions.selectable??!0;l=new Set;for(const q of o){const Z=n().connectionLookup.get(q);if(Z)for(const{edgeId:U}of Z.values()){const X=n().edgeLookup.get(U);X&&(X.selectable??R)&&l.add(U)}}Pv(B,o)||n(n().nodes=n().nodes.map(Cv(o)),!0),Pv(E,l)||n(n().edges=n().edges.map(Cv(l)),!0),n(n().selectionRectMode="user",!0),n(n().selectionRect=N,!0)}function m(D){D.button===0&&(D.target?.releasePointerCapture?.(D.pointerId),!h&&D.target===s&&S?.(D),n(n().selectionRect=null,!0),h&&n(n().selectionRectMode=o.size>0?"nodes":null,!0),h&&e.onselectionend?.(D))}const x=D=>{if(Array.isArray(p(c))&&p(c).includes(2)){D.preventDefault();return}e.onpanecontextmenu?.({event:D})},w=D=>{h&&(D.stopPropagation(),h=!1)};function S(D){if(h||n().connection.inProgress){h=!1;return}e.onpaneclick?.({event:D}),n().unselectNodesAndEdges(),n(n().selectionRectMode=null,!0),n(n().selectionRect=null,!0)}var A=CN();let _;var M=re(()=>p(f)?void 0:Nv(S,s));A.__click=function(...D){p(M)?.apply(this,D)},A.__pointermove=function(...D){(p(f)?y:void 0)?.apply(this,D)},A.__pointerup=function(...D){(p(f)?m:void 0)?.apply(this,D)};var I=re(()=>Nv(x,s));A.__contextmenu=function(...D){p(I)?.apply(this,D)};var T=ne(A);vs(T,()=>e.children),Q(A),Fi(A,D=>s=D,()=>s),Ae(D=>_=Xt(A,1,"svelte-flow__pane svelte-flow__container",null,_,D),[()=>({draggable:i()===!0||Array.isArray(i())&&i().includes(0),dragging:n().dragging,selection:p(u)})]),yn("pointerdown",A,function(...D){(p(f)?d:void 0)?.apply(this,D)},!0),yn("click",A,function(...D){(p(f)?w:void 0)?.apply(this,D)},!0),j(t,A),Tt()}Xn(["click","pointermove","pointerup","contextmenu"]);var EN=Le('<div class="svelte-flow__viewport xyflow__viewport svelte-flow__container"><!></div>');function IN(t,e){Mt(e,!0);var n=EN();let i;var r=ne(n);vs(r,()=>e.children),Q(n),Ae(()=>i=Nn(n,"",i,{transform:`translate(${e.store.viewport.x??""}px, ${e.store.viewport.y??""}px) scale(${e.store.viewport.zoom??""})`})),j(t,n),Tt()}function S5(t,e){const{store:n,onDrag:i,onDragStart:r,onDragStop:s,onNodeMouseDown:a}=e,o=NA({onDrag:i,onDragStart:r,onDragStop:s,onNodeMouseDown:a,getStoreItems:()=>{const{snapGrid:c,viewport:u}=n;return{nodes:n.nodes,nodeLookup:n.nodeLookup,edges:n.edges,nodeExtent:n.nodeExtent,snapGrid:c||[0,0],snapToGrid:!!c,nodeOrigin:n.nodeOrigin,multiSelectionActive:n.multiselectionKeyPressed,domNode:n.domNode,transform:[u.x,u.y,u.zoom],autoPanOnNodeDrag:n.autoPanOnNodeDrag,nodesDraggable:n.nodesDraggable,selectNodesOnDrag:n.selectNodesOnDrag,nodeDragThreshold:n.nodeDragThreshold,unselectNodesAndEdges:n.unselectNodesAndEdges,updateNodePositions:n.updateNodePositions,onSelectionDrag:n.onselectiondrag,onSelectionDragStart:n.onselectiondragstart,onSelectionDragStop:n.onselectiondragstop,panBy:n.panBy}}});function l(c,u){if(u.disabled){o.destroy();return}o.update({domNode:c,noDragClassName:u.noDragClass,handleSelector:u.handleSelector,nodeId:u.nodeId,isSelectable:u.isSelectable,nodeClickDistance:u.nodeClickDistance})}return l(t,e),{update(c){l(t,c)},destroy(){o.destroy()}}}var LN=Le('<div aria-live="assertive" aria-atomic="true" class="a11y-live-msg svelte-13pq11u"> </div>'),MN=Le('<div class="a11y-hidden svelte-13pq11u"> </div> <div class="a11y-hidden svelte-13pq11u"> </div> <!>',1);function TN(t,e){Mt(e,!0);var n=MN(),i=He(n),r=ne(i,!0);Q(i);var s=we(i,2),a=ne(s,!0);Q(s);var o=we(s,2);{var l=c=>{var u=LN(),f=ne(u,!0);Q(u),Ae(()=>{he(u,"id",`${DN}-${e.store.flowId}`),Ht(f,e.store.ariaLiveMessage)}),j(c,u)};Se(o,c=>{e.store.disableKeyboardA11y||c(l)})}Ae(()=>{he(i,"id",`${k5}-${e.store.flowId}`),Ht(r,e.store.disableKeyboardA11y?e.store.ariaLabelConfig["node.a11yDescription.default"]:e.store.ariaLabelConfig["node.a11yDescription.keyboardDisabled"]),he(s,"id",`${A5}-${e.store.flowId}`),Ht(a,e.store.ariaLabelConfig["edge.a11yDescription.default"])}),j(t,n),Tt()}const k5="svelte-flow__node-desc",A5="svelte-flow__edge-desc",DN="svelte-flow__aria-live";var ON=Le("<div><!></div>");function FN(t,e){Mt(e,!0);let n=ot(e,"store",15),i=re(()=>is(e.node.data,()=>({}),!0)),r=re(()=>is(e.node.selected,!1)),s=re(()=>e.node.draggable),a=re(()=>e.node.selectable),o=re(()=>is(e.node.deletable,!0)),l=re(()=>e.node.connectable),c=re(()=>e.node.focusable),u=re(()=>is(e.node.hidden,!1)),f=re(()=>is(e.node.dragging,!1)),h=re(()=>is(e.node.style,"")),d=re(()=>e.node.class),y=re(()=>is(e.node.type,"default")),m=re(()=>e.node.parentId),x=re(()=>e.node.sourcePosition),w=re(()=>e.node.targetPosition),S=re(()=>is(e.node.measured,()=>({width:0,height:0}),!0).width),A=re(()=>is(e.node.measured,()=>({width:0,height:0}),!0).height),_=re(()=>e.node.initialWidth),M=re(()=>e.node.initialHeight),I=re(()=>e.node.width),T=re(()=>e.node.height),D=re(()=>e.node.dragHandle),O=re(()=>is(e.node.internals.z,0)),W=re(()=>e.node.internals.positionAbsolute.x),C=re(()=>e.node.internals.positionAbsolute.y),N=re(()=>e.node.internals.userNode),{id:B}=e.node,E=re(()=>p(s)??n().nodesDraggable),R=re(()=>p(a)??n().elementsSelectable),q=re(()=>p(l)??n().nodesConnectable),Z=re(()=>Q6(e.node)),U=re(()=>!!e.node.internals.handleBounds),X=re(()=>p(Z)&&p(U)),de=re(()=>p(c)??n().nodesFocusable);function le(Be){return n().parentLookup.has(Be)}let F=re(()=>le(B)),V=Fe(null),G=null,se=p(y),ae=p(x),te=p(w),ue=re(()=>n().nodeTypes[p(y)]??b5),pe=re(()=>n().ariaLabelConfig),ge={get value(){return p(q)}};YA(B),ZA(ge);let me=re(()=>{const Be=p(S)===void 0?p(I)??p(_):p(I),Ee=p(A)===void 0?p(T)??p(M):p(T);if(!(Be===void 0&&Ee===void 0&&p(h)===void 0))return`${p(h)};${Be?`width:${uo(Be)};`:""}${Ee?`height:${uo(Ee)};`:""}`});pn(()=>{(p(y)!==se||p(x)!==ae||p(w)!==te)&&p(V)!==null&&requestAnimationFrame(()=>{p(V)!==null&&n().updateNodeInternals(new Map([[B,{id:B,nodeElement:p(V),force:!0}]]))}),se=p(y),ae=p(x),te=p(w)}),pn(()=>{e.resizeObserver&&(!p(X)||p(V)!==G)&&(G&&e.resizeObserver.unobserve(G),p(V)&&e.resizeObserver.observe(p(V)),G=p(V))}),Ai(()=>{G&&e.resizeObserver?.unobserve(G)});function Pe(Be){p(R)&&(!n().selectNodesOnDrag||!p(E)||n().nodeDragThreshold>0)&&n().handleNodeSelection(B),e.onnodeclick?.({node:p(N),event:Be})}function ke(Be){if(!(r5(Be)||n().disableKeyboardA11y))if(Jb.includes(Be.key)&&p(R)){const Ee=Be.key==="Escape";n().handleNodeSelection(B,Ee,p(V))}else p(E)&&e.node.selected&&Object.prototype.hasOwnProperty.call(Lh,Be.key)&&(Be.preventDefault(),n(n().ariaLiveMessage=p(pe)["node.a11yDescription.ariaLiveMessage"]({direction:Be.key.replace("Arrow","").toLowerCase(),x:~~e.node.internals.positionAbsolute.x,y:~~e.node.internals.positionAbsolute.y}),!0),n().moveSelectedNodes(Lh[Be.key],Be.shiftKey?4:1))}const Ge=()=>{if(n().disableKeyboardA11y||!n().autoPanOnNodeFocus||!p(V)?.matches(":focus-visible"))return;const{width:Be,height:Ee,viewport:at}=n();_1(new Map([[B,e.node]]),{x:0,y:0,width:Be,height:Ee},[at.x,at.y,at.zoom],!0).length>0||n().setCenter(e.node.position.x+(e.node.measured.width??0)/2,e.node.position.y+(e.node.measured.height??0)/2,{zoom:at.zoom})};var K=Je(),Oe=He(K);{var Ke=Be=>{var Ee=ON();Kl(Ee,()=>({"data-id":B,class:["svelte-flow__node",`svelte-flow__node-${p(y)}`,p(d)],style:p(me),onclick:Pe,onpointerenter:e.onnodepointerenter?Ue=>e.onnodepointerenter({node:p(N),event:Ue}):void 0,onpointerleave:e.onnodepointerleave?Ue=>e.onnodepointerleave({node:p(N),event:Ue}):void 0,onpointermove:e.onnodepointermove?Ue=>e.onnodepointermove({node:p(N),event:Ue}):void 0,oncontextmenu:e.onnodecontextmenu?Ue=>e.onnodecontextmenu({node:p(N),event:Ue}):void 0,onkeydown:p(de)?ke:void 0,onfocus:p(de)?Ge:void 0,tabIndex:p(de)?0:void 0,role:e.node.ariaRole??(p(de)?"group":void 0),"aria-roledescription":"node","aria-describedby":n().disableKeyboardA11y?void 0:`${k5}-${n().flowId}`,...e.node.domAttributes,[zl]:{dragging:p(f),selected:p(r),draggable:p(E),connectable:p(q),selectable:p(R),nopan:p(E),parent:p(F)},[Zo]:{"z-index":p(O),transform:`translate(${p(W)??""}px, ${p(C)??""}px)`,visibility:p(Z)?"visible":"hidden"}}));var at=ne(Ee);l1(at,()=>p(ue),(Ue,Ye)=>{Ye(Ue,{get data(){return p(i)},get id(){return B},get selected(){return p(r)},get selectable(){return p(R)},get deletable(){return p(o)},get sourcePosition(){return p(x)},get targetPosition(){return p(w)},get zIndex(){return p(O)},get dragging(){return p(f)},get draggable(){return p(E)},get dragHandle(){return p(D)},get parentId(){return p(m)},get type(){return p(y)},get isConnectable(){return p(q)},get positionAbsoluteX(){return p(W)},get positionAbsoluteY(){return p(C)},get width(){return p(I)},get height(){return p(T)}})}),Q(Ee),mt(Ee,(Ue,Ye)=>S5?.(Ue,Ye),()=>({nodeId:B,isSelectable:p(R),disabled:!p(E),handleSelector:p(D),noDragClass:n().noDragClass,nodeClickDistance:e.nodeClickDistance,onNodeMouseDown:n().handleNodeSelection,onDrag:(Ue,Ye,ut,Ft)=>{e.onnodedrag?.({event:Ue,targetNode:ut,nodes:Ft})},onDragStart:(Ue,Ye,ut,Ft)=>{e.onnodedragstart?.({event:Ue,targetNode:ut,nodes:Ft})},onDragStop:(Ue,Ye,ut,Ft)=>{e.onnodedragstop?.({event:Ue,targetNode:ut,nodes:Ft})},store:n()})),Fi(Ee,Ue=>$(V,Ue),()=>p(V)),j(Be,Ee)};Se(Oe,Be=>{p(u)||Be(Ke)})}j(t,K),Tt()}var RN=Le('<div class="svelte-flow__nodes"></div>');function BN(t,e){Mt(e,!0);let n=ot(e,"store",15);const i=typeof ResizeObserver>"u"?null:new ResizeObserver(s=>{const a=new Map;s.forEach(o=>{const l=o.target.getAttribute("data-id");a.set(l,{id:l,nodeElement:o.target,force:!0})}),n().updateNodeInternals(a)});Ai(()=>{i?.disconnect()});var r=RN();cn(r,21,()=>n().visible.nodes.values(),s=>s.id,(s,a)=>{FN(s,{get node(){return p(a)},get resizeObserver(){return i},get nodeClickDistance(){return e.nodeClickDistance},get onnodeclick(){return e.onnodeclick},get onnodepointerenter(){return e.onnodepointerenter},get onnodepointermove(){return e.onnodepointermove},get onnodepointerleave(){return e.onnodepointerleave},get onnodedrag(){return e.onnodedrag},get onnodedragstart(){return e.onnodedragstart},get onnodedragstop(){return e.onnodedragstop},get onnodecontextmenu(){return e.onnodecontextmenu},get store(){return n()},set store(o){n(o)}})}),Q(r),j(t,r),Tt()}var zN=nt('<svg class="svelte-flow__edge-wrapper"><g><!></g></svg>');function qN(t,e){Mt(e,!0);let n=re(()=>e.edge.id),i=re(()=>e.edge.source),r=re(()=>e.edge.target),s=re(()=>e.edge.sourceX),a=re(()=>e.edge.sourceY),o=re(()=>e.edge.targetX),l=re(()=>e.edge.targetY),c=re(()=>e.edge.sourcePosition),u=re(()=>e.edge.targetPosition),f=re(()=>is(e.edge.animated,!1)),h=re(()=>is(e.edge.selected,!1)),d=re(()=>e.edge.label),y=re(()=>e.edge.labelStyle),m=re(()=>is(e.edge.data,()=>({}),!0)),x=re(()=>e.edge.style),w=re(()=>e.edge.interactionWidth),S=re(()=>is(e.edge.type,"default")),A=re(()=>e.edge.sourceHandle),_=re(()=>e.edge.targetHandle),M=re(()=>e.edge.markerStart),I=re(()=>e.edge.markerEnd),T=re(()=>e.edge.selectable),D=re(()=>e.edge.focusable),O=re(()=>is(e.edge.deletable,!0)),W=re(()=>e.edge.hidden),C=re(()=>e.edge.zIndex),N=re(()=>e.edge.class),B=re(()=>e.edge.ariaLabel);QA(p(n));let E=null,R=re(()=>p(T)??e.store.elementsSelectable),q=re(()=>p(D)??e.store.edgesFocusable),Z=re(()=>e.store.edgeTypes[p(S)]??w5),U=re(()=>p(M)?`url('#${Am(p(M),e.store.flowId)}')`:void 0),X=re(()=>p(I)?`url('#${Am(p(I),e.store.flowId)}')`:void 0);function de(ae){const te=e.store.edgeLookup.get(p(n));te&&(p(R)&&e.store.handleEdgeSelection(p(n)),e.onedgeclick?.({event:ae,edge:te}))}function le(ae,te){const ue=e.store.edgeLookup.get(p(n));ue&&te({event:ae,edge:ue})}function F(ae){if(!e.store.disableKeyboardA11y&&Jb.includes(ae.key)&&p(R)){const{unselectNodesAndEdges:te,addSelectedEdges:ue}=e.store;ae.key==="Escape"?(E?.blur(),te({edges:[e.edge]})):ue([p(n)])}}var V=Je(),G=He(V);{var se=ae=>{var te=zN();let ue;var pe=ne(te);Kl(pe,()=>({class:["svelte-flow__edge",p(N)],"data-id":p(n),onclick:de,oncontextmenu:e.onedgecontextmenu?me=>{le(me,e.onedgecontextmenu)}:void 0,onpointerenter:e.onedgepointerenter?me=>{le(me,e.onedgepointerenter)}:void 0,onpointerleave:e.onedgepointerleave?me=>{le(me,e.onedgepointerleave)}:void 0,"aria-label":p(B)===null?void 0:p(B)?p(B):`Edge from ${p(i)} to ${p(r)}`,"aria-describedby":p(q)?`${A5}-${e.store.flowId}`:void 0,role:e.edge.ariaRole??(p(q)?"group":"img"),"aria-roledescription":"edge",onkeydown:p(q)?F:void 0,tabindex:p(q)?0:void 0,...e.edge.domAttributes,[zl]:{animated:p(f),selected:p(h),selectable:p(R)}}));var ge=ne(pe);l1(ge,()=>p(Z),(me,Pe)=>{Pe(me,{get id(){return p(n)},get source(){return p(i)},get target(){return p(r)},get sourceX(){return p(s)},get sourceY(){return p(a)},get targetX(){return p(o)},get targetY(){return p(l)},get sourcePosition(){return p(c)},get targetPosition(){return p(u)},get animated(){return p(f)},get selected(){return p(h)},get label(){return p(d)},get labelStyle(){return p(y)},get data(){return p(m)},get style(){return p(x)},get interactionWidth(){return p(w)},get selectable(){return p(R)},get deletable(){return p(O)},get type(){return p(S)},get sourceHandleId(){return p(A)},get targetHandleId(){return p(_)},get markerStart(){return p(U)},get markerEnd(){return p(X)}})}),Q(pe),Fi(pe,me=>E=me,()=>E),Q(te),Ae(()=>ue=Nn(te,"",ue,{"z-index":p(C)})),j(ae,te)};Se(G,ae=>{p(W)||ae(se)})}j(t,V),Tt()}var jN=nt("<defs></defs>");function HN(t,e){Mt(e,!1);const n=Zl();j3();var i=jN();cn(i,5,()=>n.markers,r=>r.id,(r,s)=>{GN(r,vh(()=>p(s)))}),Q(i),j(t,i),Tt()}var UN=nt('<polyline class="arrow" fill="none" stroke-linecap="round" stroke-linejoin="round" points="-5,-4 0,0 -5,4"></polyline>'),WN=nt('<polyline class="arrowclosed" stroke-linecap="round" stroke-linejoin="round" points="-5,-4 0,0 -5,4 -5,-4"></polyline>'),VN=nt('<marker class="svelte-flow__arrowhead" viewBox="-10 -10 20 20" refX="0" refY="0"><!></marker>');function GN(t,e){Mt(e,!0);let n=ot(e,"width",3,12.5),i=ot(e,"height",3,12.5),r=ot(e,"markerUnits",3,"strokeWidth"),s=ot(e,"orient",3,"auto-start-reverse"),a=ot(e,"color",3,"none");var o=VN(),l=ne(o);{var c=f=>{var h=UN();let d;Ae(()=>{he(h,"stroke-width",e.strokeWidth),d=Nn(h,"",d,{stroke:a()})}),j(f,h)},u=f=>{var h=Je(),d=He(h);{var y=m=>{var x=WN();let w;Ae(()=>{he(x,"stroke-width",e.strokeWidth),w=Nn(x,"",w,{stroke:a(),fill:a()})}),j(m,x)};Se(d,m=>{e.type===Ch.ArrowClosed&&m(y)},!0)}j(f,h)};Se(l,f=>{e.type===Ch.Arrow?f(c):f(u,!1)})}Q(o),Ae(()=>{he(o,"id",e.id),he(o,"markerWidth",`${n()}`),he(o,"markerHeight",`${i()}`),he(o,"markerUnits",r()),he(o,"orient",s())}),j(t,o),Tt()}var XN=Le('<div class="svelte-flow__edges"><svg class="svelte-flow__marker"><!></svg> <!></div>');function YN(t,e){Mt(e,!0);let n=ot(e,"store",15);var i=XN(),r=ne(i),s=ne(r);HN(s,{}),Q(r);var a=we(r,2);cn(a,17,()=>n().visible.edges.values(),o=>o.id,(o,l)=>{qN(o,{get edge(){return p(l)},get onedgeclick(){return e.onedgeclick},get onedgecontextmenu(){return e.onedgecontextmenu},get onedgepointerenter(){return e.onedgepointerenter},get onedgepointerleave(){return e.onedgepointerleave},get store(){return n()},set store(c){n(c)}})}),Q(i),j(t,i),Tt()}var KN=Le('<div class="svelte-flow__selection svelte-1vr3gfi"></div>');function N5(t,e){Mt(e,!0);let n=ot(e,"x",3,0),i=ot(e,"y",3,0),r=ot(e,"width",3,0),s=ot(e,"height",3,0),a=ot(e,"isVisible",3,!0);var o=Je(),l=He(o);{var c=u=>{var f=KN();let h;Ae(d=>h=Nn(f,"",h,d),[()=>({width:typeof r()=="string"?r():uo(r()),height:typeof s()=="string"?s():uo(s()),transform:`translate(${n()}px, ${i()}px)`})]),j(u,f)};Se(l,u=>{a()&&u(c)})}j(t,o),Tt()}var ZN=Le("<div><!></div>");function JN(t,e){Mt(e,!0);let n=Fe(void 0);pn(()=>{e.store.disableKeyboardA11y||p(n)?.focus({preventScroll:!0})});let i=re(()=>{if(e.store.selectionRectMode==="nodes"){e.store.nodes;const u=np(e.store.nodeLookup,{filter:f=>!!f.selected});if(u.width>0&&u.height>0)return u}return null});function r(u){const f=e.store.nodes.filter(h=>h.selected);e.onselectioncontextmenu?.({nodes:f,event:u})}function s(u){const f=e.store.nodes.filter(h=>h.selected);e.onselectionclick?.({nodes:f,event:u})}function a(u){Object.prototype.hasOwnProperty.call(Lh,u.key)&&(u.preventDefault(),e.store.moveSelectedNodes(Lh[u.key],u.shiftKey?4:1))}var o=Je(),l=He(o);{var c=u=>{var f=ZN();f.__contextmenu=r,f.__click=s,f.__keydown=function(...y){(e.store.disableKeyboardA11y?void 0:a)?.apply(this,y)};let h;var d=ne(f);N5(d,{width:"100%",height:"100%",x:0,y:0}),Q(f),mt(f,(y,m)=>S5?.(y,m),()=>({disabled:!1,store:e.store,onDrag:(y,m,x,w)=>{e.onnodedrag?.({event:y,targetNode:null,nodes:w})},onDragStart:(y,m,x,w)=>{e.onnodedragstart?.({event:y,targetNode:null,nodes:w})},onDragStop:(y,m,x,w)=>{e.onnodedragstop?.({event:y,targetNode:null,nodes:w})}})),Fi(f,y=>$(n,y),()=>p(n)),Ae(y=>{Xt(f,1,Dc(["svelte-flow__selection-wrapper",e.store.noPanClass]),"svelte-sf2y5e"),he(f,"role",e.store.disableKeyboardA11y?void 0:"button"),he(f,"tabindex",e.store.disableKeyboardA11y?void 0:-1),h=Nn(f,"",h,y)},[()=>({width:uo(p(i).width),height:uo(p(i).height),transform:`translate(${p(i).x??""}px, ${p(i).y??""}px)`})]),j(u,f)};Se(l,u=>{e.store.selectionRectMode==="nodes"&&p(i)&&$o(p(i).x)&&$o(p(i).y)&&u(c)})}j(t,o),Tt()}Xn(["contextmenu","click","keydown"]);function QN(t){switch(t){case"ctrl":return 8;case"shift":return 4;case"alt":return 2;case"meta":return 1}}function Ka(t,e){let{enabled:n=!0,trigger:i,type:r="keydown"}=e;function s(o){const l=Array.isArray(i)?i:[i],c=[o.metaKey,o.altKey,o.shiftKey,o.ctrlKey].reduce((u,f,h)=>f?u|1<<h:u,0);for(const u of l){const f={preventDefault:!1,enabled:!0,...u},{modifier:h,key:d,callback:y,preventDefault:m,enabled:x}=f;if(x){if(o.key!==d)continue;if(h===null||h===!1){if(c!==0)continue}else if(h!==void 0&&h?.[0]?.length>0){const S=Array.isArray(h)?h:[h];let A=!1;for(const _ of S)if((Array.isArray(_)?_:[_]).reduce((I,T)=>I|QN(T),0)===c){A=!0;break}if(!A)continue}m&&o.preventDefault();const w={node:t,trigger:f,originalEvent:o};t.dispatchEvent(new CustomEvent("shortcut",{detail:w})),y?.(w)}}}let a;return n&&(a=dm(t,r,s)),{update:o=>{const{enabled:l=!0,type:c="keydown"}=o;n&&(!l||r!==c)?a?.():!n&&l&&(a=dm(t,c,s)),n=l,r=c,i=o.trigger},destroy:()=>{a?.()}}}function C5(){const t=re(Zl),e=s=>{const a=kv(s)?s:p(t).nodeLookup.get(s.id),o=a.parentId?$6(a.position,a.measured,a.parentId,p(t).nodeLookup,p(t).nodeOrigin):a.position,l={...a,position:o,width:a.measured?.width??a.width,height:a.measured?.height??a.height};return Nu(l)};function n(s,a,o={replace:!1}){p(t).nodes=ea(()=>p(t).nodes).map(l=>{if(l.id===s){const c=typeof a=="function"?a(l):a;return o?.replace&&kv(c)?c:{...l,...c}}return l})}function i(s,a,o={replace:!1}){p(t).edges=ea(()=>p(t).edges).map(l=>{if(l.id===s){const c=typeof a=="function"?a(l):a;return o.replace&&lN(c)?c:{...l,...c}}return l})}const r=s=>p(t).nodeLookup.get(s);return{zoomIn:p(t).zoomIn,zoomOut:p(t).zoomOut,getInternalNode:r,getNode:s=>r(s)?.internals.userNode,getNodes:s=>s===void 0?p(t).nodes:Ev(p(t).nodeLookup,s),getEdge:s=>p(t).edgeLookup.get(s),getEdges:s=>s===void 0?p(t).edges:Ev(p(t).edgeLookup,s),setZoom:(s,a)=>{const o=p(t).panZoom;return o?o.scaleTo(s,{duration:a?.duration}):Promise.resolve(!1)},getZoom:()=>p(t).viewport.zoom,setViewport:async(s,a)=>{const o=p(t).viewport;return p(t).panZoom?(await p(t).panZoom.setViewport({x:s.x??o.x,y:s.y??o.y,zoom:s.zoom??o.zoom},a),Promise.resolve(!0)):Promise.resolve(!1)},getViewport:()=>pb(p(t).viewport),setCenter:async(s,a,o)=>p(t).setCenter(s,a,o),fitView:s=>p(t).fitView(s),fitBounds:async(s,a)=>{if(!p(t).panZoom)return Promise.resolve(!1);const o=S1(s,p(t).width,p(t).height,p(t).minZoom,p(t).maxZoom,a?.padding??.1);return await p(t).panZoom.setViewport(o,{duration:a?.duration,ease:a?.ease,interpolate:a?.interpolate}),Promise.resolve(!0)},getIntersectingNodes:(s,a=!0,o)=>{const l=dv(s),c=l?s:e(s);return c?(o||p(t).nodes).filter(u=>{const f=p(t).nodeLookup.get(u.id);if(!f||!l&&u.id===s.id)return!1;const h=Nu(f),d=Pd(h,c);return a&&d>0||d>=h.width*h.height||d>=c.width*c.height}):[]},isNodeIntersecting:(s,a,o=!0)=>{const c=dv(s)?s:e(s);if(!c)return!1;const u=Pd(c,a);return o&&u>0||u>=a.width*a.height||u>=c.width*c.height},deleteElements:async({nodes:s=[],edges:a=[]})=>{const{nodes:o,edges:l}=await X6({nodesToRemove:s,edgesToRemove:a,nodes:p(t).nodes,edges:p(t).edges,onBeforeDelete:p(t).onbeforedelete});return o&&(p(t).nodes=ea(()=>p(t).nodes).filter(c=>!o.some(({id:u})=>u===c.id))),l&&(p(t).edges=ea(()=>p(t).edges).filter(c=>!l.some(({id:u})=>u===c.id))),(o.length>0||l.length>0)&&p(t).ondelete?.({nodes:o,edges:l}),{deletedNodes:o,deletedEdges:l}},screenToFlowPosition:(s,a={snapToGrid:!0})=>{if(!p(t).domNode)return s;const o=a.snapToGrid?p(t).snapGrid:!1,{x:l,y:c,zoom:u}=p(t).viewport,{x:f,y:h}=p(t).domNode.getBoundingClientRect(),d={x:s.x-f,y:s.y-h};return jd(d,[l,c,u],o!==null,o||[1,1])},flowToScreenPosition:s=>{if(!p(t).domNode)return s;const{x:a,y:o,zoom:l}=p(t).viewport,{x:c,y:u}=p(t).domNode.getBoundingClientRect(),f=Eh(s,[a,o,l]);return{x:f.x+c,y:f.y+u}},toObject:()=>structuredClone({nodes:[...p(t).nodes],edges:[...p(t).edges],viewport:{...p(t).viewport}}),updateNode:n,updateNodeData:(s,a,o)=>{const l=p(t).nodeLookup.get(s)?.internals.userNode;if(!l)return;const c=typeof a=="function"?a(l):a;n(s,u=>({...u,data:o?.replace?c:{...u.data,...c}}))},updateEdge:i,getNodesBounds:s=>U6(s,{nodeLookup:p(t).nodeLookup,nodeOrigin:p(t).nodeOrigin}),getHandleConnections:({type:s,id:a,nodeId:o})=>Array.from(p(t).connectionLookup.get(`${o}-${s}-${a??null}`)?.values()??[])}}function Ev(t,e){const n=[];for(const i of e){const r=t.get(i);if(r){const s="internals"in r?r.internals?.userNode:r;n.push(s)}}return n}function $N(t,e){Mt(e,!0);let n=ot(e,"store",15),i=ot(e,"selectionKey",3,"Shift"),r=ot(e,"multiSelectionKey",19,()=>Ih()?"Meta":"Control"),s=ot(e,"deleteKey",3,"Backspace"),a=ot(e,"panActivationKey",3," "),o=ot(e,"zoomActivationKey",19,()=>Ih()?"Meta":"Control"),{deleteElements:l}=C5();function c(m){return m!==null&&typeof m=="object"}function u(m){return c(m)?m.modifier||[]:[]}function f(m){return m==null?"":c(m)?m.key:m}function h(m,x){return(Array.isArray(m)?m:[m]).map(S=>{const A=f(S);return{key:A,modifier:u(S),enabled:A!==null,callback:x}})}function d(){n(n().selectionRect=null,!0),n(n().selectionKeyPressed=!1,!0),n(n().multiselectionKeyPressed=!1,!0),n(n().deleteKeyPressed=!1,!0),n(n().panActivationKeyPressed=!1,!0),n(n().zoomActivationKeyPressed=!1,!0)}function y(){const m=n().nodes.filter(w=>w.selected),x=n().edges.filter(w=>w.selected);l({nodes:m,edges:x})}yn("blur",$n,d),yn("contextmenu",$n,d),mt($n,(m,x)=>Ka?.(m,x),()=>({trigger:h(i(),()=>n(n().selectionKeyPressed=!0,!0)),type:"keydown"})),mt($n,(m,x)=>Ka?.(m,x),()=>({trigger:h(i(),()=>n(n().selectionKeyPressed=!1,!0)),type:"keyup"})),mt($n,(m,x)=>Ka?.(m,x),()=>({trigger:h(r(),()=>{n(n().multiselectionKeyPressed=!0,!0)}),type:"keydown"})),mt($n,(m,x)=>Ka?.(m,x),()=>({trigger:h(r(),()=>n(n().multiselectionKeyPressed=!1,!0)),type:"keyup"})),mt($n,(m,x)=>Ka?.(m,x),()=>({trigger:h(s(),m=>{!(m.originalEvent.ctrlKey||m.originalEvent.metaKey||m.originalEvent.shiftKey)&&!r5(m.originalEvent)&&(n(n().deleteKeyPressed=!0,!0),y())}),type:"keydown"})),mt($n,(m,x)=>Ka?.(m,x),()=>({trigger:h(s(),()=>n(n().deleteKeyPressed=!1,!0)),type:"keyup"})),mt($n,(m,x)=>Ka?.(m,x),()=>({trigger:h(a(),()=>n(n().panActivationKeyPressed=!0,!0)),type:"keydown"})),mt($n,(m,x)=>Ka?.(m,x),()=>({trigger:h(a(),()=>n(n().panActivationKeyPressed=!1,!0)),type:"keyup"})),mt($n,(m,x)=>Ka?.(m,x),()=>({trigger:h(o(),()=>n(n().zoomActivationKeyPressed=!0,!0)),type:"keydown"})),mt($n,(m,x)=>Ka?.(m,x),()=>({trigger:h(o(),()=>n(n().zoomActivationKeyPressed=!1,!0)),type:"keyup"})),Tt()}var eC=nt('<path fill="none" class="svelte-flow__connection-path"></path>'),tC=nt('<svg class="svelte-flow__connectionline"><g><!></g></svg>');function nC(t,e){Mt(e,!0);let n=re(()=>{if(!e.store.connection.inProgress)return"";const a={sourceX:e.store.connection.from.x,sourceY:e.store.connection.from.y,sourcePosition:e.store.connection.fromPosition,targetX:e.store.connection.to.x,targetY:e.store.connection.to.y,targetPosition:e.store.connection.toPosition};switch(e.type){case ql.Bezier:{const[o]=a5(a);return o}case ql.Straight:{const[o]=l5(a);return o}case ql.Step:case ql.SmoothStep:{const[o]=sp({...a,borderRadius:e.type===ql.Step?0:void 0});return o}}});var i=Je(),r=He(i);{var s=a=>{var o=tC(),l=ne(o),c=ne(l);{var u=h=>{var d=Je(),y=He(d);l1(y,()=>e.LineComponent,(m,x)=>{x(m,{})}),j(h,d)},f=h=>{var d=eC();Ae(()=>{he(d,"d",p(n)),Nn(d,e.style)}),j(h,d)};Se(c,h=>{e.LineComponent?h(u):h(f,!1)})}Q(l),Q(o),Ae(h=>{he(o,"width",e.store.width),he(o,"height",e.store.height),Nn(o,e.containerStyle),Xt(l,0,h)},[()=>Dc(["svelte-flow__connection",j6(e.store.connection.isValid)])]),j(a,o)};Se(r,a=>{e.store.connection.inProgress&&a(s)})}j(t,i),Tt()}var iC=Le("<div><!></div>");function rC(t,e){Mt(e,!0);let n=ot(e,"position",3,"top-right"),i=Tc(e,["$$slots","$$events","$$legacy","position","style","class","children"]),r=re(()=>`${n()}`.split("-"));var s=iC();Kl(s,o=>({class:o,style:e.style,...i}),[()=>["svelte-flow__panel",e.class,...p(r)]]);var a=ne(s);vs(a,()=>e.children??Qs),Q(s),j(t,s),Tt()}var sC=Le('<a href="https://svelteflow.dev" target="_blank" rel="noopener noreferrer" aria-label="Svelte Flow attribution">Svelte Flow</a>');function aC(t,e){Mt(e,!0);let n=ot(e,"position",3,"bottom-right");var i=Je(),r=He(i);{var s=a=>{rC(a,{get position(){return n()},class:"svelte-flow__attribution","data-message":"Feel free to remove the attribution or check out how you could support us: https://svelteflow.dev/support-us",children:(o,l)=>{var c=sC();j(o,c)},$$slots:{default:!0}})};Se(r,a=>{e.proOptions?.hideAttribution||a(s)})}j(t,i),Tt()}var oC=Le("<div><!></div>");function lC(t,e){Mt(e,!0);let n=ot(e,"domNode",15),i=ot(e,"clientWidth",15),r=ot(e,"clientHeight",15),s=re(()=>e.rest.class),a=re(()=>E3(e.rest,["id","class","nodeTypes","edgeTypes","colorMode","isValidConnection","onmove","onmovestart","onmoveend","onflowerror","ondelete","onbeforedelete","onbeforeconnect","onconnect","onconnectstart","onconnectend","onbeforereconnect","onreconnect","onreconnectstart","onreconnectend","onclickconnectstart","onclickconnectend","oninit","onselectionchange","onselectiondragstart","onselectiondrag","onselectiondragstop","onselectionstart","onselectionend","clickConnect","fitView","fitViewOptions","nodeOrigin","nodeDragThreshold","connectionDragThreshold","minZoom","maxZoom","initialViewport","connectionRadius","connectionMode","selectionMode","selectNodesOnDrag","snapGrid","defaultMarkerColor","translateExtent","nodeExtent","onlyRenderVisibleElements","autoPanOnConnect","autoPanOnNodeDrag","colorModeSSR","defaultEdgeOptions","elevateNodesOnSelect","elevateEdgesOnSelect","nodesDraggable","autoPanOnNodeFocus","nodesConnectable","elementsSelectable","nodesFocusable","edgesFocusable","disableKeyboardA11y","noDragClass","noPanClass","noWheelClass","ariaLabelConfig","autoPanSpeed","panOnScrollSpeed","zIndexMode"]));function o(u){u.currentTarget.scrollTo({top:0,left:0,behavior:"auto"}),e.rest.onscroll&&e.rest.onscroll(u)}var l=oC();Kl(l,u=>({class:["svelte-flow","svelte-flow__container",p(s),e.colorMode],"data-testid":"svelte-flow__wrapper",role:"application",onscroll:o,...p(a),[Zo]:u}),[()=>({width:uo(e.width),height:uo(e.height)})],void 0,void 0,"svelte-mkap6j");var c=ne(l);vs(c,()=>e.children??Qs),Q(l),Fi(l,u=>n(u),()=>n()),U0(l,"clientHeight",r),U0(l,"clientWidth",i),j(t,l),Tt()}var cC=Le('<div class="svelte-flow__viewport-back svelte-flow__container"></div> <!> <div class="svelte-flow__edge-labels svelte-flow__container"></div> <!> <!> <!> <div class="svelte-flow__viewport-front svelte-flow__container"></div>',1),uC=Le("<!> <!>",1),dC=Le("<!> <!> <!> <!> <!>",1);function fC(t,e){Mt(e,!0);let n=ot(e,"paneClickDistance",3,1),i=ot(e,"nodeClickDistance",3,1),r=ot(e,"panOnScrollMode",19,()=>hu.Free),s=ot(e,"preventScrolling",3,!0),a=ot(e,"zoomOnScroll",3,!0),o=ot(e,"zoomOnDoubleClick",3,!0),l=ot(e,"zoomOnPinch",3,!0),c=ot(e,"panOnScroll",3,!1),u=ot(e,"panOnScrollSpeed",3,.5),f=ot(e,"panOnDrag",3,!0),h=ot(e,"selectionOnDrag",3,!1),d=ot(e,"connectionLineType",19,()=>ql.Bezier),y=ot(e,"nodes",31,()=>Rn([])),m=ot(e,"edges",31,()=>Rn([])),x=ot(e,"viewport",15,void 0),w=Tc(e,["$$slots","$$events","$$legacy","width","height","proOptions","selectionKey","deleteKey","panActivationKey","multiSelectionKey","zoomActivationKey","paneClickDistance","nodeClickDistance","onmovestart","onmoveend","onmove","oninit","onnodeclick","onnodecontextmenu","onnodedrag","onnodedragstart","onnodedragstop","onnodepointerenter","onnodepointermove","onnodepointerleave","onselectionclick","onselectioncontextmenu","onselectionstart","onselectionend","onedgeclick","onedgecontextmenu","onedgepointerenter","onedgepointerleave","onpaneclick","onpanecontextmenu","panOnScrollMode","preventScrolling","zoomOnScroll","zoomOnDoubleClick","zoomOnPinch","panOnScroll","panOnScrollSpeed","panOnDrag","selectionOnDrag","connectionLineComponent","connectionLineStyle","connectionLineContainerStyle","connectionLineType","attributionPosition","children","nodes","edges","viewport"]),S=SN({props:w,width:e.width,height:e.height,get nodes(){return y()},set nodes(_){y(_)},get edges(){return m()},set edges(_){m(_)},get viewport(){return x()},set viewport(_){x(_)}});const A=o1(Nm);A&&A.setStore&&A.setStore(S),db(Nm,{provider:!1,getStore(){return S}}),pn(()=>{const _={nodes:S.selectedNodes,edges:S.selectedEdges};ea(()=>e.onselectionchange)?.(_);for(const M of S.selectionChangeHandlers.values())M(_)}),Ai(()=>{S.reset()}),lC(t,{get colorMode(){return S.colorMode},get width(){return e.width},get height(){return e.height},get rest(){return w},get domNode(){return S.domNode},set domNode(_){S.domNode=_},get clientWidth(){return S.width},set clientWidth(_){S.width=_},get clientHeight(){return S.height},set clientHeight(_){S.height=_},children:(_,M)=>{var I=dC(),T=He(I);$N(T,{get selectionKey(){return e.selectionKey},get deleteKey(){return e.deleteKey},get panActivationKey(){return e.panActivationKey},get multiSelectionKey(){return e.multiSelectionKey},get zoomActivationKey(){return e.zoomActivationKey},get store(){return S},set store(N){S=N}});var D=we(T,2);NN(D,{get panOnScrollMode(){return r()},get preventScrolling(){return s()},get zoomOnScroll(){return a()},get zoomOnDoubleClick(){return o()},get zoomOnPinch(){return l()},get panOnScroll(){return c()},get panOnScrollSpeed(){return u()},get panOnDrag(){return f()},get paneClickDistance(){return n()},get selectionOnDrag(){return h()},get onmovestart(){return e.onmovestart},get onmove(){return e.onmove},get onmoveend(){return e.onmoveend},get oninit(){return e.oninit},get store(){return S},set store(N){S=N},children:(N,B)=>{PN(N,{get onpaneclick(){return e.onpaneclick},get onpanecontextmenu(){return e.onpanecontextmenu},get onselectionstart(){return e.onselectionstart},get onselectionend(){return e.onselectionend},get panOnDrag(){return f()},get paneClickDistance(){return n()},get selectionOnDrag(){return h()},get store(){return S},set store(E){S=E},children:(E,R)=>{var q=uC(),Z=He(q);IN(Z,{get store(){return S},set store(X){S=X},children:(X,de)=>{var le=cC(),F=we(He(le),2);YN(F,{get onedgeclick(){return e.onedgeclick},get onedgecontextmenu(){return e.onedgecontextmenu},get onedgepointerenter(){return e.onedgepointerenter},get onedgepointerleave(){return e.onedgepointerleave},get store(){return S},set store(ae){S=ae}});var V=we(F,4);nC(V,{get type(){return d()},get LineComponent(){return e.connectionLineComponent},get containerStyle(){return e.connectionLineContainerStyle},get style(){return e.connectionLineStyle},get store(){return S},set store(ae){S=ae}});var G=we(V,2);BN(G,{get nodeClickDistance(){return i()},get onnodeclick(){return e.onnodeclick},get onnodecontextmenu(){return e.onnodecontextmenu},get onnodepointerenter(){return e.onnodepointerenter},get onnodepointermove(){return e.onnodepointermove},get onnodepointerleave(){return e.onnodepointerleave},get onnodedrag(){return e.onnodedrag},get onnodedragstart(){return e.onnodedragstart},get onnodedragstop(){return e.onnodedragstop},get store(){return S},set store(ae){S=ae}});var se=we(G,2);JN(se,{get onselectionclick(){return e.onselectionclick},get onselectioncontextmenu(){return e.onselectioncontextmenu},get onnodedrag(){return e.onnodedrag},get onnodedragstart(){return e.onnodedragstart},get onnodedragstop(){return e.onnodedragstop},get store(){return S},set store(ae){S=ae}}),Mi(2),j(X,le)},$$slots:{default:!0}});var U=we(Z,2);{let X=re(()=>!!(S.selectionRect&&S.selectionRectMode==="user")),de=re(()=>S.selectionRect?.width),le=re(()=>S.selectionRect?.height),F=re(()=>S.selectionRect?.x),V=re(()=>S.selectionRect?.y);N5(U,{get isVisible(){return p(X)},get width(){return p(de)},get height(){return p(le)},get x(){return p(F)},get y(){return p(V)}})}j(E,q)},$$slots:{default:!0}})},$$slots:{default:!0}});var O=we(D,2);aC(O,{get proOptions(){return e.proOptions},get position(){return e.attributionPosition}});var W=we(O,2);TN(W,{get store(){return S}});var C=we(W,2);vs(C,()=>e.children??Qs),j(_,I)},$$slots:{default:!0}}),Tt()}var nl;(function(t){t.Lines="lines",t.Dots="dots",t.Cross="cross"})(nl||(nl={}));var hC=nt("<circle></circle>");function pC(t,e){var n=hC();Ae(()=>{he(n,"cx",e.radius),he(n,"cy",e.radius),he(n,"r",e.radius),Xt(n,0,Dc(["svelte-flow__background-pattern","dots",e.class]))}),j(t,n)}var gC=nt("<path></path>");function mC(t,e){Mt(e,!0);var n=gC();Ae(()=>{he(n,"stroke-width",e.lineWidth),he(n,"d",`M${e.dimensions[0]/2} 0 V${e.dimensions[1]} M0 ${e.dimensions[1]/2} H${e.dimensions[0]}`),Xt(n,0,Dc(["svelte-flow__background-pattern",e.variant,e.class]))}),j(t,n),Tt()}const vC={[nl.Dots]:1,[nl.Lines]:1,[nl.Cross]:6};var yC=nt('<svg data-testid="svelte-flow__background"><pattern patternUnits="userSpaceOnUse"><!></pattern><rect x="0" y="0" width="100%" height="100%"></rect></svg>');function bC(t,e){Mt(e,!0);let n=ot(e,"variant",19,()=>nl.Dots),i=ot(e,"gap",3,20),r=ot(e,"lineWidth",3,1),s=re(Zl),a=re(()=>n()===nl.Dots),o=re(()=>n()===nl.Cross),l=re(()=>Array.isArray(i())?i():[i(),i()]),c=re(()=>`background-pattern-${p(s).flowId}-${e.id??""}`),u=re(()=>[p(l)[0]*p(s).viewport.zoom||1,p(l)[1]*p(s).viewport.zoom||1]),f=re(()=>(e.size??vC[n()])*p(s).viewport.zoom),h=re(()=>p(o)?[p(f),p(f)]:p(u)),d=re(()=>p(a)?[p(f)/2,p(f)/2]:[p(h)[0]/2,p(h)[1]/2]);var y=yC();let m;var x=ne(y),w=ne(x);{var S=M=>{{let I=re(()=>p(f)/2);pC(M,{get radius(){return p(I)},get class(){return e.patternClass}})}},A=M=>{mC(M,{get dimensions(){return p(h)},get variant(){return n()},get lineWidth(){return r()},get class(){return e.patternClass}})};Se(w,M=>{p(a)?M(S):M(A,!1)})}Q(x);var _=we(x);Q(y),Ae(()=>{Xt(y,0,Dc(["svelte-flow__background","svelte-flow__container",e.class])),m=Nn(y,"",m,{"--xy-background-color-props":e.bgColor,"--xy-background-pattern-color-props":e.patternColor}),he(x,"id",p(c)),he(x,"x",p(s).viewport.x%p(u)[0]),he(x,"y",p(s).viewport.y%p(u)[1]),he(x,"width",p(u)[0]),he(x,"height",p(u)[1]),he(x,"patternTransform",`translate(-${p(d)[0]},-${p(d)[1]})`),he(_,"fill",`url(#${p(c)})`)}),j(t,y),Tt()}var wC=Le("<div><!></div>");function Iv(t,e){Mt(e,!0);let n=ot(e,"variant",19,()=>Ed.Handle),i=ot(e,"minWidth",3,10),r=ot(e,"minHeight",3,10),s=ot(e,"maxWidth",19,()=>Number.MAX_VALUE),a=ot(e,"maxHeight",19,()=>Number.MAX_VALUE),o=ot(e,"keepAspectRatio",3,!1),l=ot(e,"autoScale",3,!0),c=Tc(e,["$$slots","$$events","$$legacy","nodeId","position","variant","color","minWidth","minHeight","maxWidth","maxHeight","keepAspectRatio","resizeDirection","autoScale","shouldResize","onResizeStart","onResize","onResizeEnd","class","children"]);const u=Zl(),f=E1();let h=re(()=>typeof e.nodeId=="string"?e.nodeId:f);if(!p(h))throw new Error("Either pass a nodeId or use within a Custom Node component");let d,y=Fe(null),m=re(()=>n()===Ed.Line),x=re(()=>{let _=p(m)?"right":"bottom-right";return e.position??_}),w=re(()=>p(x).split("-"));Du(()=>(d&&$(y,XA({domNode:d,nodeId:p(h),getStoreItems:()=>({nodeLookup:u.nodeLookup,transform:[u.viewport.x,u.viewport.y,u.viewport.zoom],snapGrid:u.snapGrid??void 0,snapToGrid:!!u.snapGrid,nodeOrigin:u.nodeOrigin,paneDomNode:u.domNode}),onChange:(_,M)=>{const I=new Map;I.set(p(h),_);for(const T of M)I.set(T.id,{x:T.position.x,y:T.position.y});u.nodes=u.nodes.map(T=>{const D=I.get(T.id),O=!e.resizeDirection||e.resizeDirection==="horizontal",W=!e.resizeDirection||e.resizeDirection==="vertical";return D?{...T,position:{x:O?D.x??T.position.x:T.position.x,y:W?D.y??T.position.y:T.position.y},width:O?D.width??T.width:T.width,height:W?D.height??T.height:T.height}:T})}}),!0),()=>{p(y)?.destroy()})),fb(()=>{p(y)?.update({controlPosition:p(x),boundaries:{minWidth:i(),minHeight:r(),maxWidth:s(),maxHeight:a()},keepAspectRatio:!!o(),resizeDirection:e.resizeDirection,onResizeStart:e.onResizeStart,onResize:e.onResize,onResizeEnd:e.onResizeEnd,shouldResize:e.shouldResize})});var S=wC();Kl(S,(_,M)=>({class:_,...c,[Zo]:M}),[()=>["svelte-flow__resize-control",u.noDragClass,...p(w),n(),e.class],()=>({"border-color":p(m)?e.color:void 0,"background-color":p(m)?void 0:e.color,scale:p(m)||!l()?void 0:Math.max(1/u.viewport.zoom,1)})]);var A=ne(S);vs(A,()=>e.children??Qs),Q(S),Fi(S,_=>d=_,()=>d),j(t,S),Tt()}var xC=Le("<!> <!>",1);function _C(t,e){Mt(e,!0);let n=ot(e,"isVisible",3,!0),i=ot(e,"autoScale",3,!0),r=Tc(e,["$$slots","$$events","$$legacy","isVisible","nodeId","handleClass","handleStyle","lineClass","lineStyle","autoScale"]);var s=Je(),a=He(s);{var o=l=>{var c=xC(),u=He(c);cn(u,16,()=>jA,h=>h,(h,d)=>{Iv(h,vh({get class(){return e.lineClass},get style(){return e.lineStyle},get nodeId(){return e.nodeId},get position(){return d},get autoScale(){return i()},get variant(){return Ed.Line}},()=>r))});var f=we(u,2);cn(f,16,()=>qA,h=>h,(h,d)=>{Iv(h,vh({get class(){return e.handleClass},get style(){return e.handleStyle},get nodeId(){return e.nodeId},get position(){return d},get autoScale(){return i()}},()=>r))}),j(l,c)};Se(a,l=>{n()&&l(o)})}j(t,s),Tt()}function P5(){const t=re(Zl),e=re(()=>p(t).domNode),n=re(()=>p(t).updateNodeInternals),i=E1();return s=>{if(!s&&!i)throw new Error("When using outside of a node, you must provide an id.");const a=s?Array.isArray(s)?s:[s]:[i],o=new Map;a.forEach(l=>{const c=p(e)?.querySelector(`.svelte-flow__node[data-id="${l}"]`);c&&o.set(l,{id:l,nodeElement:c,force:!0})}),requestAnimationFrame(()=>p(n)(o))}}function E5(t){return t.target instanceof HTMLInputElement||t.target instanceof HTMLTextAreaElement||!!t.target?.closest?.(".cm-editor")}const SC="1.0.0",kC={dt:{pathsim_name:"dt",type:"number",default:"0.01",description:"transient simulation timestep in time units, default see Â´SIM_TIMESTEPÂ´ in Â´_constants.pyÂ´"},dt_min:{pathsim_name:"dt_min",type:"number",default:"1e-16",description:"lower bound for transient simulation timestep, default see Â´SIM_TIMESTEP_MINÂ´ in Â´_constants.pyÂ´"},dt_max:{pathsim_name:"dt_max",type:"any",default:null,description:"upper bound for transient simulation timestep, default see Â´SIM_TIMESTEP_MAXÂ´ in Â´_constants.pyÂ´"},solver:{pathsim_name:"Solver",type:"string",default:'"SSPRK22"',description:"ODE solver class for numerical integration from Â´pathsim.solversÂ´, default is Â´pathsim.solvers.ssprk22.SSPRK22Â´ (2nd order expl. Runge Kutta)"},ftol:{pathsim_name:"tolerance_fpi",type:"number",default:"1e-10",description:"absolute tolerance for convergence of algebraic loops and internal optimizers of implicit ODE solvers, default see Â´SIM_TOLERANCE_FPIÂ´ in Â´_constants.pyÂ´"},iterations_max:{pathsim_name:"iterations_max",type:"integer",default:"200",description:"maximum allowed number of iterations for implicit ODE solver optimizers and algebraic loop solver, default see Â´SIM_ITERATIONS_MAXÂ´ in Â´_constants.pyÂ´"},log:{pathsim_name:"log",type:"boolean",default:"True",description:"flag to enable logging, default see Â´LOG_ENABLEÂ´ in Â´_constants.pyÂ´ (alternatively a path to a log file can be specified)"},rtol:{pathsim_name:"tolerance_lte_rel",type:"number",default:"0.0001",description:"Relative error tolerance for adaptive timestep control"},atol:{pathsim_name:"tolerance_lte_abs",type:"number",default:"1e-08",description:"Absolute error tolerance for adaptive timestep control"},duration:{pathsim_name:"duration",type:"number",default:"10.0",description:"Total simulation time"}},Lv={ghostTraces:{default:"0"},plotResults:{default:"true"}};function Ml(t){return kC[t]?.default??""}const Go={duration:Ml("duration"),dt:Ml("dt"),solver:Ml("solver")||"SSPRK22",adaptive:!0,atol:Ml("atol"),rtol:Ml("rtol"),ftol:Ml("ftol"),dt_min:Ml("dt_min"),dt_max:Ml("dt_max"),ghostTraces:parseInt(Lv.ghostTraces?.default),plotResults:Lv.plotResults?.default==="true"},ns={duration:"",dt:"",solver:"SSPRK22",adaptive:!0,atol:"",rtol:"",ftol:"",dt_min:"",dt_max:"",ghostTraces:0,plotResults:!0},il="#0070C0",Id={default:"#969696"},AC=[il,"#E57373","#FFB74D","#FFF176","#81C784","#4DB6AC","#4DD0E1","#64B5F6","#BA68C8","#F06292","#90A4AE","#FFFFFF"];function I1(t){const{name:e,category:n,description:i=`${e} block`,blockClass:r,inputs:s=["in 0"],outputs:a=["out 0"],minInputs:o=1,minOutputs:l=1,maxInputs:c=null,maxOutputs:u=null,syncPorts:f,shape:h,params:d={}}=t,y=Object.entries(d).map(([m,x])=>({name:m,type:x.type,default:x.default,description:x.description,min:x.min,max:x.max,options:x.options}));return{type:r,name:e,category:n,description:i,blockClass:r,shape:h,ports:{inputs:s.map(m=>({name:m,direction:"input",color:Id.default})),outputs:a.map(m=>({name:m,direction:"output",color:Id.default})),minInputs:o,minOutputs:l,maxInputs:c,maxOutputs:u,syncPorts:f},params:y}}const Mh={Constant:{blockClass:"Constant",description:"Produces a constant output signal (SISO).",docstringHtml:`<p>Produces a constant output signal (SISO).</p>
<div class="math">
\\begin{equation*}
y(t) = const.
\\end{equation*}
</div>
<div class="section" id="parameters">
<h3>Parameters</h3>
<dl class="docutils">
<dt>value <span class="classifier-delimiter">:</span> <span class="classifier">float</span></dt>
<dd>constant defining block output</dd>
</dl>
</div>
`,params:{value:{type:"integer",default:"1",description:"constant defining block output"}},inputs:[],outputs:["out"]},Source:{blockClass:"Source",description:"Source that produces an arbitrary time dependent output defined by `func` (callable).",docstringHtml:`<p>Source that produces an arbitrary time dependent output defined by <cite>func</cite> (callable).</p>
<div class="math">
\\begin{equation*}
y(t) = \\mathrm{func}(t)
\\end{equation*}
</div>
<div class="section" id="note">
<h3>Note</h3>
<p>This block is purely algebraic and its internal function (<cite>func</cite>) will
be called multiple times per timestep, each time when <cite>Simulation._update(t)</cite>
is called in the global simulation loop.</p>
</div>
<div class="section" id="example">
<h3>Example</h3>
<p>For example a ramp:</p>
<pre class="code python literal-block">
from pathsim.blocks import Source

src = Source(lambda t : t)
</pre>
<p>or a simple sinusoid with some frequency:</p>
<pre class="code python literal-block">
import numpy as np
from pathsim.blocks import Source

#some parameter
omega = 100

#the function that gets evaluated
def f(t):
    return np.sin(omega * t)

src = Source(f)
</pre>
<p>Because the <cite>Source</cite> block only has a single argument, it can be
used to decorate a function and make it a <cite>PathSim</cite> block. This might
be handy in some cases to keep definitions concise and localized
in the code:</p>
<pre class="code python literal-block">
import numpy as np
from pathsim.blocks import Source

#does the same as the definition above

&#64;Source
def src(t):
    omega = 100
    return np.sin(omega * t)

#'src' is now a PathSim block
</pre>
</div>
<div class="section" id="parameters">
<h3>Parameters</h3>
<dl class="docutils">
<dt>func <span class="classifier-delimiter">:</span> <span class="classifier">callable</span></dt>
<dd>function defining time dependent block output</dd>
</dl>
</div>
`,params:{func:{type:"callable",default:null,description:"function defining time dependent block output"}},inputs:[],outputs:["out"]},SinusoidalSource:{blockClass:"SinusoidalSource",description:"Source block that generates a sinusoid wave",docstringHtml:`<p>Source block that generates a sinusoid wave</p>
<div class="section" id="parameters">
<h3>Parameters</h3>
<dl class="docutils">
<dt>frequency <span class="classifier-delimiter">:</span> <span class="classifier">float</span></dt>
<dd>frequency of the sinusoid</dd>
<dt>amplitude <span class="classifier-delimiter">:</span> <span class="classifier">float</span></dt>
<dd>amplitude of the sinusoid</dd>
<dt>phase <span class="classifier-delimiter">:</span> <span class="classifier">float</span></dt>
<dd>phase of the sinusoid</dd>
</dl>
</div>
`,params:{frequency:{type:"integer",default:"1",description:"frequency of the sinusoid"},amplitude:{type:"integer",default:"1",description:"amplitude of the sinusoid"},phase:{type:"integer",default:"0",description:"phase of the sinusoid"}},inputs:[],outputs:["out"]},StepSource:{blockClass:"StepSource",description:"Discrete time unit step (or multi step) source block.",docstringHtml:`<p>Discrete time unit step (or multi step) source block.</p>
<p>Utilizes a scheduled event to set the block output
to the specified output levels at the defined event times.</p>
<p>The arguments can be vectorial and in that case, the output is set to the
amplitude that corresponds to the defined delay like a zero-order-hold stage.
This functionality enables adding external or time series measurement data
into the system.</p>
<div class="section" id="examples">
<h3>Examples</h3>
<p>This is how to use the source as a unit step source:</p>
<pre class="code python literal-block">
from pathsim.blocks import StepSource

#default, starts at 0, jumps to 1
stp = StepSource()
</pre>
<p>And this is how to configure it with multiple consecutive steps:</p>
<pre class="code python literal-block">
from pathsim.blocks import StepSource

#starts at 0, jumps to 1 at 1, jumps to -1 at 2 and jumps back to 0 at 3
stp = StepSource(amplitude=[1, -1, 0], tau=[1, 2, 3])
</pre>
<p>Similarly implementing measured time series data via zoh:</p>
<pre class="code python literal-block">
import numpy as np
from pathsim.blocks import StepSource

#some random time series arrays
times, data = np.linspace(0, 100, 1000), np.random.rand(1000)

#pass them to the block
stp = StepSource(amplitude=data, tau=times)
</pre>
</div>
<div class="section" id="parameters">
<h3>Parameters</h3>
<dl class="docutils">
<dt>amplitude <span class="classifier-delimiter">:</span> <span class="classifier">float | list[float]</span></dt>
<dd>amplitude of the step signal, or amplitudes / output
levels of the multiple steps</dd>
<dt>tau <span class="classifier-delimiter">:</span> <span class="classifier">float | list[float]</span></dt>
<dd>delay of the step, or delays of the different steps</dd>
</dl>
</div>
<div class="section" id="attributes">
<h3>Attributes</h3>
<dl class="docutils">
<dt>Evt <span class="classifier-delimiter">:</span> <span class="classifier">ScheduleList</span></dt>
<dd>internal scheduled event directly accessible</dd>
<dt>events <span class="classifier-delimiter">:</span> <span class="classifier">list[ScheduleList]</span></dt>
<dd>list of interna events</dd>
</dl>
</div>
`,params:{amplitude:{type:"integer",default:"1",description:"amplitude of the step signal, or amplitudes / output levels of the multiple steps"},tau:{type:"number",default:"0.0",description:"delay of the step, or delays of the different steps"}},inputs:[],outputs:["out"]},PulseSource:{blockClass:"PulseSource",description:"Generates a periodic pulse waveform with defined rise and fall times.",docstringHtml:`<p>Generates a periodic pulse waveform with defined rise and fall times.</p>
<p>Scheduled events trigger phase changes (low, rising, high, falling),
and the <cite>update</cite> method calculates the output value based on the
current phase, performing linear interpolation during rise and fall.</p>
<div class="section" id="parameters">
<h3>Parameters</h3>
<dl class="docutils">
<dt>amplitude <span class="classifier-delimiter">:</span> <span class="classifier">float, optional</span></dt>
<dd>Peak amplitude of the pulse. Default is 1.0.</dd>
<dt>T <span class="classifier-delimiter">:</span> <span class="classifier">float, optional</span></dt>
<dd>Period of the pulse train. Must be positive. Default is 1.0.</dd>
<dt>t_rise <span class="classifier-delimiter">:</span> <span class="classifier">float, optional</span></dt>
<dd>Duration of the rising edge. Default is 0.0.</dd>
<dt>t_fall <span class="classifier-delimiter">:</span> <span class="classifier">float, optional</span></dt>
<dd>Duration of the falling edge. Default is 0.0.</dd>
<dt>tau <span class="classifier-delimiter">:</span> <span class="classifier">float, optional</span></dt>
<dd>Initial delay before the first pulse cycle begins. Default is 0.0.</dd>
<dt>duty <span class="classifier-delimiter">:</span> <span class="classifier">float, optional</span></dt>
<dd>Duty cycle, ratio of the pulse ON duration (plateau time only)
to the total period T (must be between 0 and 1). Default is 0.5.
The high plateau duration is <cite>T * duty</cite>.</dd>
</dl>
</div>
<div class="section" id="attributes">
<h3>Attributes</h3>
<dl class="docutils">
<dt>events <span class="classifier-delimiter">:</span> <span class="classifier">list[Schedule]</span></dt>
<dd>Internal scheduled events triggering phase transitions.</dd>
<dt>_phase <span class="classifier-delimiter">:</span> <span class="classifier">str</span></dt>
<dd>Current phase of the pulse ('low', 'rising', 'high', 'falling').</dd>
<dt>_phase_start_time <span class="classifier-delimiter">:</span> <span class="classifier">float</span></dt>
<dd>Simulation time when the current phase began.</dd>
</dl>
</div>
`,params:{amplitude:{type:"number",default:"1.0",description:"Peak amplitude of the pulse. Default is 1.0."},T:{type:"number",default:"1.0",description:"Period of the pulse train. Must be positive. Default is 1.0."},t_rise:{type:"number",default:"0.0",description:"Duration of the rising edge. Default is 0.0."},t_fall:{type:"number",default:"0.0",description:"Duration of the falling edge. Default is 0.0."},tau:{type:"number",default:"0.0",description:"Initial delay before the first pulse cycle begins. Default is 0.0."},duty:{type:"number",default:"0.5",description:"Duty cycle, ratio of the pulse ON duration (plateau time only) to the total period T (must be between 0 and 1). Default is 0.5. The high plateau duration is `T * duty`."}},inputs:[],outputs:["out"]},TriangleWaveSource:{blockClass:"TriangleWaveSource",description:"Source block that generates an analog triangle wave",docstringHtml:`<p>Source block that generates an analog triangle wave</p>
<div class="section" id="parameters">
<h3>Parameters</h3>
<dl class="docutils">
<dt>frequency <span class="classifier-delimiter">:</span> <span class="classifier">float</span></dt>
<dd>frequency of the triangle wave</dd>
<dt>amplitude <span class="classifier-delimiter">:</span> <span class="classifier">float</span></dt>
<dd>amplitude of the triangle wave</dd>
<dt>phase <span class="classifier-delimiter">:</span> <span class="classifier">float</span></dt>
<dd>phase of the triangle wave</dd>
</dl>
</div>
`,params:{frequency:{type:"integer",default:"1",description:"frequency of the triangle wave"},amplitude:{type:"integer",default:"1",description:"amplitude of the triangle wave"},phase:{type:"integer",default:"0",description:"phase of the triangle wave"}},inputs:[],outputs:["out"]},SquareWaveSource:{blockClass:"SquareWaveSource",description:"Discrete time square wave source.",docstringHtml:`<p>Discrete time square wave source.</p>
<p>Utilizes scheduled events to periodically set
the block output at discrete times.</p>
<div class="section" id="parameters">
<h3>Parameters</h3>
<dl class="docutils">
<dt>amplitude <span class="classifier-delimiter">:</span> <span class="classifier">float</span></dt>
<dd>amplitude of the square wave signal</dd>
<dt>frequency <span class="classifier-delimiter">:</span> <span class="classifier">float</span></dt>
<dd>frequency of the square wave signal</dd>
<dt>phase <span class="classifier-delimiter">:</span> <span class="classifier">float</span></dt>
<dd>phase of the square wave signal</dd>
</dl>
</div>
<div class="section" id="attributes">
<h3>Attributes</h3>
<dl class="docutils">
<dt>events <span class="classifier-delimiter">:</span> <span class="classifier">list[Schedule]</span></dt>
<dd>internal scheduled events</dd>
</dl>
</div>
`,params:{amplitude:{type:"integer",default:"1",description:"amplitude of the square wave signal"},frequency:{type:"integer",default:"1",description:"frequency of the square wave signal"},phase:{type:"integer",default:"0",description:"phase of the square wave signal"}},inputs:[],outputs:["out"]},GaussianPulseSource:{blockClass:"GaussianPulseSource",description:"Source block that generates a gaussian pulse",docstringHtml:`<p>Source block that generates a gaussian pulse</p>
<div class="section" id="parameters">
<h3>Parameters</h3>
<dl class="docutils">
<dt>amplitude <span class="classifier-delimiter">:</span> <span class="classifier">float</span></dt>
<dd>amplitude of the gaussian pulse</dd>
<dt>f_max <span class="classifier-delimiter">:</span> <span class="classifier">float</span></dt>
<dd>maximum frequency component of the gaussian pulse (steepness)</dd>
<dt>tau <span class="classifier-delimiter">:</span> <span class="classifier">float</span></dt>
<dd>time delay of the gaussian pulse</dd>
</dl>
</div>
`,params:{amplitude:{type:"integer",default:"1",description:"amplitude of the gaussian pulse"},f_max:{type:"number",default:"1000.0",description:"maximum frequency component of the gaussian pulse (steepness)"},tau:{type:"number",default:"0.0",description:"time delay of the gaussian pulse"}},inputs:[],outputs:["out"]},ChirpPhaseNoiseSource:{blockClass:"ChirpPhaseNoiseSource",description:"Chirp source, sinusoid with frequency ramp up and ramp down, plus phase noise.",docstringHtml:`<p>Chirp source, sinusoid with frequency ramp up and ramp down, plus phase noise.</p>
<p>This works by using a time dependent triangle wave for the frequency
and integrating it with a numerical integration engine to get a
continuous phase. This phase is then used to evaluate a sinusoid.</p>
<p>Additionally the chirp source can have white and cumulative phase noise.
Mathematically it looks like this for the contributions to the phase from
the triangular wave:</p>
<div class="math">
\\begin{equation*}
\\varphi_t(t) = \\int_0^t \\mathrm{tri}_{f_0, B, T}(\\tau) \\, d\\tau
\\end{equation*}
</div>
<p>And from the white (w) and cumulative (c) noise:</p>
<div class="math">
\\begin{equation*}
\\varphi_n(t) = \\sigma_w \\, n_w(t) + \\sigma_c \\int_0^t n_c(\\tau) \\, d\\tau
\\end{equation*}
</div>
<p>The phase contributions are then used to evaluate a sinusoid to get the final chirp signal:</p>
<div class="math">
\\begin{equation*}
y(t) = A \\sin(\\varphi_t(t) + \\varphi_n(t) + \\varphi_0)
\\end{equation*}
</div>
<div class="section" id="parameters">
<h3>Parameters</h3>
<dl class="docutils">
<dt>amplitude <span class="classifier-delimiter">:</span> <span class="classifier">float</span></dt>
<dd>amplitude of the chirp signal</dd>
<dt>f0 <span class="classifier-delimiter">:</span> <span class="classifier">float</span></dt>
<dd>start frequency of the chirp signal</dd>
<dt>BW <span class="classifier-delimiter">:</span> <span class="classifier">float</span></dt>
<dd>bandwidth of the frequency ramp of the chirp signal</dd>
<dt>T <span class="classifier-delimiter">:</span> <span class="classifier">float</span></dt>
<dd>period of the frequency ramp of the chirp signal</dd>
<dt>phase <span class="classifier-delimiter">:</span> <span class="classifier">float</span></dt>
<dd>phase of sinusoid (initial, radians)</dd>
<dt>sig_cum <span class="classifier-delimiter">:</span> <span class="classifier">float</span></dt>
<dd>weight for cumulative phase noise contribution</dd>
<dt>sig_white <span class="classifier-delimiter">:</span> <span class="classifier">float</span></dt>
<dd>weight for white phase noise contribution</dd>
<dt>sampling_period <span class="classifier-delimiter">:</span> <span class="classifier">float, None</span></dt>
<dd>time between phase noise samples. If None,
noise is sampled every timestep (default is 0.1)</dd>
</dl>
</div>
<div class="section" id="attributes">
<h3>Attributes</h3>
<dl class="docutils">
<dt>noise_1 <span class="classifier-delimiter">:</span> <span class="classifier">float</span></dt>
<dd>internal noise value for white phase noise</dd>
<dt>noise_2 <span class="classifier-delimiter">:</span> <span class="classifier">float</span></dt>
<dd>internal noise value for cumulative phase noise</dd>
<dt>events <span class="classifier-delimiter">:</span> <span class="classifier">list[Schedule]</span></dt>
<dd>scheduled event for periodic sampling (only if sampling_period is set)</dd>
</dl>
</div>
`,params:{amplitude:{type:"integer",default:"1",description:"amplitude of the chirp signal"},f0:{type:"integer",default:"1",description:"start frequency of the chirp signal"},BW:{type:"integer",default:"1",description:"bandwidth of the frequency ramp of the chirp signal"},T:{type:"integer",default:"1",description:"period of the frequency ramp of the chirp signal"},phase:{type:"integer",default:"0",description:"phase of sinusoid (initial, radians)"},sig_cum:{type:"integer",default:"0",description:"weight for cumulative phase noise contribution"},sig_white:{type:"integer",default:"0",description:"weight for white phase noise contribution"},sampling_period:{type:"number",default:"0.1",description:"time between phase noise samples. If None, noise is sampled every timestep (default is 0.1)"}},inputs:[],outputs:["out"]},ClockSource:{blockClass:"ClockSource",description:"Discrete time clock source block.",docstringHtml:`<p>Discrete time clock source block.</p>
<p>Utilizes scheduled events to periodically set
the block output to 0 or 1 at discrete times.</p>
<div class="section" id="parameters">
<h3>Parameters</h3>
<dl class="docutils">
<dt>T <span class="classifier-delimiter">:</span> <span class="classifier">float</span></dt>
<dd>period of the clock</dd>
<dt>tau <span class="classifier-delimiter">:</span> <span class="classifier">float</span></dt>
<dd>clock delay</dd>
</dl>
</div>
<div class="section" id="attributes">
<h3>Attributes</h3>
<dl class="docutils">
<dt>events <span class="classifier-delimiter">:</span> <span class="classifier">list[Schedule]</span></dt>
<dd>internal scheduled event list</dd>
</dl>
</div>
`,params:{T:{type:"integer",default:"1",description:"period of the clock"},tau:{type:"integer",default:"0",description:"clock delay"}},inputs:[],outputs:["out"]},WhiteNoise:{blockClass:"WhiteNoise",description:"White noise source with Gaussian distribution.",docstringHtml:`<p>White noise source with Gaussian distribution.</p>
<p>Generates uncorrelated random samples with either constant amplitude
(<tt class="docutils literal">standard_deviation</tt> mode) or timestep-scaled amplitude for stochastic
integration (<tt class="docutils literal">spectral_density</tt> mode).</p>
<p>In spectral density mode, output is scaled as â(Sâ/dt) so that integrating
the noise yields correct statistical properties (Wiener process).</p>
<div class="section" id="note">
<h3>Note</h3>
<p>If <tt class="docutils literal">spectral_density</tt> is provided, it takes precedence over <tt class="docutils literal">standard_deviation</tt>.
If <tt class="docutils literal">sampling_period</tt> is set, noise is sampled at fixed intervals (zero-order hold).</p>
</div>
<div class="section" id="parameters">
<h3>Parameters</h3>
<dl class="docutils">
<dt>standard_deviation <span class="classifier-delimiter">:</span> <span class="classifier">float</span></dt>
<dd>output standard deviation for constant-amplitude mode (default: 1.0)</dd>
<dt>spectral_density <span class="classifier-delimiter">:</span> <span class="classifier">float, optional</span></dt>
<dd>power spectral density Sâ in [signalÂ²/Hz]</dd>
<dt>sampling_period <span class="classifier-delimiter">:</span> <span class="classifier">float, optional</span></dt>
<dd>time between samples, if None samples every timestep</dd>
<dt>seed <span class="classifier-delimiter">:</span> <span class="classifier">int, optional</span></dt>
<dd>random seed for reproducibility</dd>
</dl>
</div>
`,params:{standard_deviation:{type:"number",default:"1.0",description:"output standard deviation for constant-amplitude mode (default: 1.0)"},spectral_density:{type:"any",default:null,description:"power spectral density Sâ in [signalÂ²/Hz]"},sampling_period:{type:"any",default:null,description:"time between samples, if None samples every timestep"},seed:{type:"any",default:null,description:"random seed for reproducibility"}},inputs:[],outputs:["out"]},PinkNoise:{blockClass:"PinkNoise",description:"Pink noise (1/f noise) source using the Voss-McCartney algorithm.",docstringHtml:`<p>Pink noise (1/f noise) source using the Voss-McCartney algorithm.</p>
<p>Generates noise with power spectral density proportional to 1/f, where
lower frequencies have more power than higher frequencies.</p>
<p>The algorithm maintains <tt class="docutils literal">num_octaves</tt> independent random values representing
different frequency bands. At each sample, one octave is updated based on the
binary representation of the sample counter, creating the characteristic 1/f
spectrum through the superposition of different update rates.</p>
<div class="section" id="note">
<h3>Note</h3>
<p>If <tt class="docutils literal">spectral_density</tt> is provided, it takes precedence over <tt class="docutils literal">standard_deviation</tt>.
If <tt class="docutils literal">sampling_period</tt> is set, noise is sampled at fixed intervals (zero-order hold).</p>
</div>
<div class="section" id="parameters">
<h3>Parameters</h3>
<dl class="docutils">
<dt>standard_deviation <span class="classifier-delimiter">:</span> <span class="classifier">float</span></dt>
<dd>approximate output standard deviation (default: 1.0)</dd>
<dt>spectral_density <span class="classifier-delimiter">:</span> <span class="classifier">float, optional</span></dt>
<dd>power spectral density, output scaled as â(Sâ/(NÂ·dt))</dd>
<dt>num_octaves <span class="classifier-delimiter">:</span> <span class="classifier">int</span></dt>
<dd>number of frequency bands in algorithm (default: 16)</dd>
<dt>sampling_period <span class="classifier-delimiter">:</span> <span class="classifier">float, optional</span></dt>
<dd>time between samples, if None samples every timestep</dd>
<dt>seed <span class="classifier-delimiter">:</span> <span class="classifier">int, optional</span></dt>
<dd>random seed for reproducibility</dd>
</dl>
</div>
`,params:{standard_deviation:{type:"number",default:"1.0",description:"approximate output standard deviation (default: 1.0)"},spectral_density:{type:"any",default:null,description:"power spectral density, output scaled as â(Sâ/(NÂ·dt))"},num_octaves:{type:"integer",default:"16",description:"number of frequency bands in algorithm (default: 16)"},sampling_period:{type:"any",default:null,description:"time between samples, if None samples every timestep"},seed:{type:"any",default:null,description:"random seed for reproducibility"}},inputs:[],outputs:["out"]},RandomNumberGenerator:{blockClass:"RandomNumberGenerator",description:"Generates a random output value using `numpy.random.rand`.",docstringHtml:`<p>Generates a random output value using <cite>numpy.random.rand</cite>.</p>
<p>If no <cite>sampling_period</cite> (None) is specified, every simulation timestep gets
a random value. Otherwise an internal <cite>Schedule</cite> event is used to periodically
sample a random value and set the output like a zero-order-hold stage.</p>
<div class="section" id="parameters">
<h3>Parameters</h3>
<dl class="docutils">
<dt>sampling_period <span class="classifier-delimiter">:</span> <span class="classifier">float, None</span></dt>
<dd>time between random samples</dd>
</dl>
</div>
<div class="section" id="attributes">
<h3>Attributes</h3>
<dl class="docutils">
<dt>_sample <span class="classifier-delimiter">:</span> <span class="classifier">float</span></dt>
<dd>internal random number state in case that
no <cite>sampling_period</cite> is provided</dd>
<dt>Evt <span class="classifier-delimiter">:</span> <span class="classifier">Schedule</span></dt>
<dd>internal event that periodically samples a random
value in case <cite>sampling_period</cite> is provided</dd>
</dl>
</div>
`,params:{sampling_period:{type:"any",default:null,description:"time between random samples"}},inputs:[],outputs:["out"]},Integrator:{blockClass:"Integrator",description:"Integrates the input signal.",docstringHtml:`<p>Integrates the input signal.</p>
<p>Uses a numerical integration engine like this:</p>
<div class="math">
\\begin{equation*}
y(t) = \\int_0^t u(\\tau) \\ d \\tau
\\end{equation*}
</div>
<p>or in differential form like this:</p>
<div class="math">
\\begin{equation*}
\\begin{align}
    \\dot{x}(t) &amp;= u(t) \\\\
           y(t) &amp;= x(t)
\\end{align}
\\end{equation*}
</div>
<p>The Integrator block is inherently MIMO capable, so <cite>u</cite>
and <cite>y</cite> can be vectors.</p>
<div class="section" id="example">
<h3>Example</h3>
<p>This is how to initialize the integrator:</p>
<pre class="code python literal-block">
#initial value 0.0
i1 = Integrator()

#initial value 2.5
i2 = Integrator(2.5)
</pre>
</div>
<div class="section" id="parameters">
<h3>Parameters</h3>
<dl class="docutils">
<dt>initial_value <span class="classifier-delimiter">:</span> <span class="classifier">float, array</span></dt>
<dd>initial value of integrator</dd>
</dl>
</div>
`,params:{initial_value:{type:"number",default:"0.0",description:"initial value of integrator"}},inputs:null,outputs:null},Differentiator:{blockClass:"Differentiator",description:"Differentiates the input signal.",docstringHtml:`<p>Differentiates the input signal.</p>
<p>Uses a first order transfer function with a pole at the origin which implements
a high pass filter. Supports vector input.</p>
<div class="math">
\\begin{equation*}
H_\\mathrm{diff}(s) = \\frac{s}{1 + s / f_\\mathrm{max}}
\\end{equation*}
</div>
<p>The approximation holds for signals up to a frequency of approximately f_max.</p>
<div class="section" id="note">
<h3>Note</h3>
<p>Depending on <cite>f_max</cite>, the resulting system might become stiff or ill conditioned!
As a practical choice set <cite>f_max</cite> to 3x the highest expected signal frequency.</p>
</div>
<div class="section" id="note-1">
<h3>Note</h3>
<p>Since this is an approximation of real differentiation, the approximation will not hold
if there are high frequency components present in the signal. For example if you have
discontinuities such as steps or squere waves.</p>
</div>
<div class="section" id="example">
<h3>Example</h3>
<p>The block is initialized like this:</p>
<pre class="code python literal-block">
#cutoff at 1kHz
D = Differentiator(f_max=1e3)
</pre>
</div>
<div class="section" id="parameters">
<h3>Parameters</h3>
<dl class="docutils">
<dt>f_max <span class="classifier-delimiter">:</span> <span class="classifier">float</span></dt>
<dd>highest expected signal frequency</dd>
</dl>
</div>
<div class="section" id="attributes">
<h3>Attributes</h3>
<dl class="docutils">
<dt>op_dyn <span class="classifier-delimiter">:</span> <span class="classifier">DynamicOperator</span></dt>
<dd>internal dynamic operator for ODE component</dd>
<dt>op_alg <span class="classifier-delimiter">:</span> <span class="classifier">DynamicOperator</span></dt>
<dd>internal algebraic operator</dd>
</dl>
</div>
`,params:{f_max:{type:"number",default:"100.0",description:"highest expected signal frequency"}},inputs:null,outputs:null},Delay:{blockClass:"Delay",description:"Delays the input signal by a time constant 'tau' in seconds.",docstringHtml:`<p>Delays the input signal by a time constant 'tau' in seconds.</p>
<p>Mathematically this block creates a time delay of the input signal like this:</p>
<div class="math">
\\begin{equation*}
y(t) =
\\begin{cases}
x(t - \\tau) &amp; , t \\geq \\tau \\\\
0            &amp; , t &lt; \\tau
\\end{cases}
\\end{equation*}
</div>
<div class="section" id="note">
<h3>Note</h3>
<p>The internal adaptive buffer uses interpolation for the evaluation. This is
required to be compatible with variable step solvers. It has a drawback however.
The order of the ode solver used will degrade when this block is used, due to
the interpolation.</p>
</div>
<div class="section" id="note-1">
<h3>Note</h3>
<p>This block supports vector input, meaning we can have multiple parallel
delay paths through this block.</p>
</div>
<div class="section" id="example">
<h3>Example</h3>
<p>The block is initialized like this:</p>
<pre class="code python literal-block">
#5 time units delay
D = Delay(tau=5)
</pre>
</div>
<div class="section" id="parameters">
<h3>Parameters</h3>
<dl class="docutils">
<dt>tau <span class="classifier-delimiter">:</span> <span class="classifier">float</span></dt>
<dd>delay time constant</dd>
</dl>
</div>
<div class="section" id="attributes">
<h3>Attributes</h3>
<dl class="docutils">
<dt>_buffer <span class="classifier-delimiter">:</span> <span class="classifier">AdaptiveBuffer</span></dt>
<dd>internal interpolatable adaptive rolling buffer</dd>
</dl>
</div>
`,params:{tau:{type:"number",default:"0.001",description:"delay time constant"}},inputs:null,outputs:null},ODE:{blockClass:"ODE",description:"Ordinary differential equation (ODE) defined by its right hand side function.",docstringHtml:`<p>Ordinary differential equation (ODE) defined by its right hand side function.</p>
<div class="math">
\\begin{equation*}
\\begin{align}
    \\dot{x}(t) &amp;= \\mathrm{func}(x(t), u(t), t) \\\\
           y(t) &amp;= x(t)
\\end{align}
\\end{equation*}
</div>
<p>with inhomogenity (input) <cite>u</cite> and state vector <cite>x</cite>. The function can be nonlinear
and the ODE can be of arbitrary order. The block utilizes the integration engine
to solve the ODE by integrating the <cite>func</cite>, which is the right hand side function.</p>
<div class="section" id="example">
<h3>Example</h3>
<p>For example a linear 1st order ODE:</p>
<pre class="code python literal-block">
ode = ODE(lambda x, u, t: -x)
</pre>
<p>Or something more complex like the <cite>Van der Pol</cite> system, where it makes sense to
also specify the jacobian, which improves convergence for implicit solvers but is
not needed in most cases:</p>
<pre class="code python literal-block">
import numpy as np

#initial condition
x0 = np.array([2, 0])

#van der Pol parameter
mu = 1000

def func(x, u, t):
    return np.array([x[1], mu*(1 - x[0]**2)*x[1] - x[0]])

#analytical jacobian (optional)
def jac(x, u, t):
    return np.array(
        [[0                , 1               ],
         [-mu*2*x[0]*x[1]-1, mu*(1 - x[0]**2)]]
         )

#finally the block
vdp = ODE(func, x0, jac)
</pre>
</div>
<div class="section" id="parameters">
<h3>Parameters</h3>
<dl class="docutils">
<dt>func <span class="classifier-delimiter">:</span> <span class="classifier">callable</span></dt>
<dd>right hand side function of ODE</dd>
<dt>initial_value <span class="classifier-delimiter">:</span> <span class="classifier">array[float]</span></dt>
<dd>initial state / initial condition</dd>
<dt>jac <span class="classifier-delimiter">:</span> <span class="classifier">callable, None</span></dt>
<dd>jacobian of 'func' or 'None'</dd>
</dl>
</div>
<div class="section" id="attributes">
<h3>Attributes</h3>
<dl class="docutils">
<dt>op_dyn <span class="classifier-delimiter">:</span> <span class="classifier">DynamicOperator</span></dt>
<dd>internal dynamic operator for ODE right hand side 'func'</dd>
</dl>
</div>
`,params:{func:{type:"callable",default:null,description:"right hand side function of ODE"},initial_value:{type:"number",default:"0.0",description:"initial state / initial condition"},jac:{type:"any",default:null,description:"jacobian of 'func' or 'None'"}},inputs:null,outputs:null},DynamicalSystem:{blockClass:"DynamicalSystem",description:"This block implements a nonlinear dynamical system / nonlinear state space model.",docstringHtml:`<p>This block implements a nonlinear dynamical system / nonlinear state space model.</p>
<p>Its basically the same as the <cite>ODE</cite> block with the addition of an output equation
that takes the state, input and time as arguments:</p>
<div class="math">
\\begin{equation*}
\\begin{align}
    \\dot{x}(t) &amp;= \\mathrm{func}_\\mathrm{dyn}(x(t), u(t), t) \\\\
           y(t) &amp;= \\mathrm{func}_\\mathrm{alg}(x(t), u(t), t)
\\end{align}
\\end{equation*}
</div>
<div class="section" id="parameters">
<h3>Parameters</h3>
<dl class="docutils">
<dt>func_dyn <span class="classifier-delimiter">:</span> <span class="classifier">callable</span></dt>
<dd>right hand side function of ode-part of the system</dd>
<dt>func_alg <span class="classifier-delimiter">:</span> <span class="classifier">callable</span></dt>
<dd>output function of the system</dd>
<dt>initial_value <span class="classifier-delimiter">:</span> <span class="classifier">array[float]</span></dt>
<dd>initial state / initial condition</dd>
<dt>jac_dyn <span class="classifier-delimiter">:</span> <span class="classifier">callable | None</span></dt>
<dd>optional jacobian of <cite>func_dyn</cite> to improve convergence
for implicit ode solvers</dd>
</dl>
</div>
<div class="section" id="attributes">
<h3>Attributes</h3>
<dl class="docutils">
<dt>op_dyn <span class="classifier-delimiter">:</span> <span class="classifier">DynamicOperator</span></dt>
<dd>internal dynamic operator for <cite>func_dyn</cite></dd>
<dt>op_alg <span class="classifier-delimiter">:</span> <span class="classifier">DynamicOperator</span></dt>
<dd>internal dynamic operator for <cite>func_alg</cite></dd>
</dl>
</div>
`,params:{func_dyn:{type:"callable",default:null,description:"right hand side function of ode-part of the system"},func_alg:{type:"callable",default:null,description:"output function of the system"},initial_value:{type:"number",default:"0.0",description:"initial state / initial condition"},jac_dyn:{type:"any",default:null,description:"optional jacobian of `func_dyn` to improve convergence for implicit ode solvers"}},inputs:null,outputs:null},StateSpace:{blockClass:"StateSpace",description:"Linear time invariant (LTI) multi input multi output (MIMO) state space model.",docstringHtml:`<p>Linear time invariant (LTI) multi input multi output (MIMO) state space model.</p>
<div class="math">
\\begin{equation*}
\\begin{align}
    \\dot{x} &amp;= \\mathbf{A} x + \\mathbf{B} u \\\\
           y &amp;= \\mathbf{C} x + \\mathbf{D} u
\\end{align}
\\end{equation*}
</div>
<p>where <cite>A</cite>, <cite>B</cite>, <cite>C</cite> and <cite>D</cite> are the state space matrices, <cite>x</cite> is the state,
<cite>u</cite> the input and <cite>y</cite> the output vector.</p>
<div class="section" id="example">
<h3>Example</h3>
<p>A SISO state space block with two internal states can be initialized
like this:</p>
<pre class="code python literal-block">
S = StateSpace(
    A=-np.eye(2),
    B=np.ones((2, 1)),
    C=np.ones((1, 2)),
    D=1.0
    )
</pre>
<p>and a MIMO (2 in, 2 out) state space block with three internal states
can be initialized like this:</p>
<pre class="code python literal-block">
S = StateSpace(
    A=-np.eye(3),
    B=np.ones((3, 2)),
    C=np.ones((2, 3)),
    D=np.ones((2, 2))
    )
</pre>
</div>
<div class="section" id="parameters">
<h3>Parameters</h3>
<dl class="docutils">
<dt>A, B, C, D <span class="classifier-delimiter">:</span> <span class="classifier">array_like</span></dt>
<dd>real valued state space matrices</dd>
<dt>initial_value <span class="classifier-delimiter">:</span> <span class="classifier">array_like, None</span></dt>
<dd>initial state / initial condition</dd>
</dl>
</div>
<div class="section" id="attributes">
<h3>Attributes</h3>
<dl class="docutils">
<dt>op_dyn <span class="classifier-delimiter">:</span> <span class="classifier">DynamicOperator</span></dt>
<dd>internal dynamic operator for state equation</dd>
<dt>op_alg <span class="classifier-delimiter">:</span> <span class="classifier">DynamicOperator</span></dt>
<dd>internal algebraic operator for mapping to outputs</dd>
</dl>
</div>
`,params:{A:{type:"number",default:"-1.0",description:""},B:{type:"number",default:"1.0",description:""},C:{type:"number",default:"-1.0",description:""},D:{type:"number",default:"1.0",description:"real valued state space matrices"},initial_value:{type:"any",default:null,description:"initial state / initial condition"}},inputs:null,outputs:null},PT1:{blockClass:"PT1",description:"First-order lag element (PT1).",docstringHtml:`<p>First-order lag element (PT1).</p>
<p>The transfer function is defined as</p>
<div class="math">
\\begin{equation*}
H(s) = \\frac{K}{1 + T s}
\\end{equation*}
</div>
<p>where <cite>K</cite> is the static gain and <cite>T</cite> is the time constant.</p>
<div class="section" id="example">
<h3>Example</h3>
<p>The block is initialized like this:</p>
<pre class="code python literal-block">
pt1 = PT1(K=2.0, T=0.5)
</pre>
</div>
<div class="section" id="parameters">
<h3>Parameters</h3>
<dl class="docutils">
<dt>K <span class="classifier-delimiter">:</span> <span class="classifier">float</span></dt>
<dd>static gain</dd>
<dt>T <span class="classifier-delimiter">:</span> <span class="classifier">float</span></dt>
<dd>time constant in seconds (must be &gt; 0)</dd>
</dl>
</div>
`,params:{K:{type:"number",default:"1.0",description:"static gain"},T:{type:"number",default:"1.0",description:"time constant in seconds (must be > 0)"}},inputs:["in"],outputs:["out"]},PT2:{blockClass:"PT2",description:"Second-order lag element (PT2).",docstringHtml:`<p>Second-order lag element (PT2).</p>
<p>The transfer function is defined as</p>
<div class="math">
\\begin{equation*}
H(s) = \\frac{K}{1 + 2 d T s + T^2 s^2}
\\end{equation*}
</div>
<p>where <cite>K</cite> is the static gain, <cite>T</cite> is the time constant
(related to the natural frequency by <span class="math">\\(\\omega_n = 1/T\\)</span>)
and <cite>d</cite> is the damping ratio.</p>
<p>The damping ratio <cite>d</cite> controls the transient behavior:</p>
<ul class="simple">
<li><span class="math">\\(d &lt; 1\\)</span>: underdamped (oscillatory)</li>
<li><span class="math">\\(d = 1\\)</span>: critically damped</li>
<li><span class="math">\\(d &gt; 1\\)</span>: overdamped</li>
</ul>
<div class="section" id="example">
<h3>Example</h3>
<p>The block is initialized like this:</p>
<pre class="code python literal-block">
#underdamped second-order system
pt2 = PT2(K=1.0, T=0.1, d=0.3)
</pre>
</div>
<div class="section" id="parameters">
<h3>Parameters</h3>
<dl class="docutils">
<dt>K <span class="classifier-delimiter">:</span> <span class="classifier">float</span></dt>
<dd>static gain</dd>
<dt>T <span class="classifier-delimiter">:</span> <span class="classifier">float</span></dt>
<dd>time constant in seconds (must be &gt; 0)</dd>
<dt>d <span class="classifier-delimiter">:</span> <span class="classifier">float</span></dt>
<dd>damping ratio (must be &gt;= 0)</dd>
</dl>
</div>
`,params:{K:{type:"number",default:"1.0",description:"static gain"},T:{type:"number",default:"1.0",description:"time constant in seconds (must be > 0)"},d:{type:"number",default:"1.0",description:"damping ratio (must be >= 0)"}},inputs:["in"],outputs:["out"]},LeadLag:{blockClass:"LeadLag",description:"Lead-Lag compensator.",docstringHtml:`<p>Lead-Lag compensator.</p>
<p>The transfer function is defined as</p>
<div class="math">
\\begin{equation*}
H(s) = K \\frac{T_1 s + 1}{T_2 s + 1}
\\end{equation*}
</div>
<p>where <cite>K</cite> is the static gain, <cite>T1</cite> is the lead time constant
and <cite>T2</cite> is the lag time constant.</p>
<ul class="simple">
<li><span class="math">\\(T_1 &gt; T_2\\)</span>: lead compensator (phase advance)</li>
<li><span class="math">\\(T_1 &lt; T_2\\)</span>: lag compensator (phase lag)</li>
<li><span class="math">\\(T_1 = T_2\\)</span>: pure gain</li>
</ul>
<div class="section" id="example">
<h3>Example</h3>
<p>The block is initialized like this:</p>
<pre class="code python literal-block">
#lead compensator
ll = LeadLag(K=1.0, T1=0.5, T2=0.1)
</pre>
</div>
<div class="section" id="parameters">
<h3>Parameters</h3>
<dl class="docutils">
<dt>K <span class="classifier-delimiter">:</span> <span class="classifier">float</span></dt>
<dd>static gain</dd>
<dt>T1 <span class="classifier-delimiter">:</span> <span class="classifier">float</span></dt>
<dd>lead (numerator) time constant in seconds</dd>
<dt>T2 <span class="classifier-delimiter">:</span> <span class="classifier">float</span></dt>
<dd>lag (denominator) time constant in seconds (must be &gt; 0)</dd>
</dl>
</div>
`,params:{K:{type:"number",default:"1.0",description:"static gain"},T1:{type:"number",default:"1.0",description:"lead (numerator) time constant in seconds"},T2:{type:"number",default:"1.0",description:"lag (denominator) time constant in seconds (must be > 0)"}},inputs:["in"],outputs:["out"]},PID:{blockClass:"PID",description:"Proportional-Integral-Differentiation (PID) controller.",docstringHtml:`<p>Proportional-Integral-Differentiation (PID) controller.</p>
<p>The transfer function is defined as</p>
<div class="math">
\\begin{equation*}
H(s) = K_p + K_i \\frac{1}{s} + K_d \\frac{s}{1 + s / f_\\mathrm{max}}
\\end{equation*}
</div>
<p>where the differentiation is approximated by a high pass filter that holds
for signals up to a frequency of approximately <cite>f_max</cite>.</p>
<p>Internally realized as a linear state space model with two states
(differentiator filter state and integrator state).</p>
<div class="section" id="note">
<h3>Note</h3>
<p>Depending on <cite>f_max</cite>, the resulting system might become stiff or ill conditioned!
As a practical choice set <cite>f_max</cite> to 3x the highest expected signal frequency.
Since this block uses an approximation of real differentiation, the approximation will
not hold if there are high frequency components present in the signal. For example if
you have discontinuities such as steps or square waves.</p>
</div>
<div class="section" id="example">
<h3>Example</h3>
<p>The block is initialized like this:</p>
<pre class="code python literal-block">
#cutoff at 1kHz
pid = PID(Kp=2, Ki=0.5, Kd=0.1, f_max=1e3)
</pre>
</div>
<div class="section" id="parameters">
<h3>Parameters</h3>
<dl class="docutils">
<dt>Kp <span class="classifier-delimiter">:</span> <span class="classifier">float</span></dt>
<dd>proportional controller coefficient</dd>
<dt>Ki <span class="classifier-delimiter">:</span> <span class="classifier">float</span></dt>
<dd>integral controller coefficient</dd>
<dt>Kd <span class="classifier-delimiter">:</span> <span class="classifier">float</span></dt>
<dd>differentiator controller coefficient</dd>
<dt>f_max <span class="classifier-delimiter">:</span> <span class="classifier">float</span></dt>
<dd>highest expected signal frequency</dd>
</dl>
</div>
`,params:{Kp:{type:"integer",default:"0",description:"proportional controller coefficient"},Ki:{type:"integer",default:"0",description:"integral controller coefficient"},Kd:{type:"integer",default:"0",description:"differentiator controller coefficient"},f_max:{type:"integer",default:"100",description:"highest expected signal frequency"}},inputs:["in"],outputs:["out"]},AntiWindupPID:{blockClass:"AntiWindupPID",description:"Proportional-Integral-Differentiation (PID) controller with anti-windup mechanism (back-calculation).",docstringHtml:`<p>Proportional-Integral-Differentiation (PID) controller with anti-windup mechanism (back-calculation).</p>
<p>Anti-windup mechanisms are needed when the magnitude of the control signal
from the PID controller is limited by some real world saturation. In these cases,
the integrator will continue to accumulate the control error and &quot;wind itself up&quot;.
Once the setpoint is reached, this can result in significant overshoots. This
implementation adds a conditional feedback term to the internal integrator that
&quot;unwinds&quot; it when the PID output crosses some limits. This is pretty much a
deadzone feedback element for the integrator.</p>
<p>Mathematically, this block implements the following set of ODEs</p>
<div class="math">
\\begin{equation*}
\\begin{align}
\\dot{x}_1 &amp;= f_\\mathrm{max} (u - x_1) \\\\
\\dot{x}_2 &amp;= u - w
\\end{align}
\\end{equation*}
</div>
<p>with the anti-windup feedback (depending on the pid output)</p>
<div class="math">
\\begin{equation*}
w = K_s (y - \\min(\\max(y, y_\\mathrm{min}), y_\\mathrm{max}))
\\end{equation*}
</div>
<p>and the output itself</p>
<div class="math">
\\begin{equation*}
y = K_p u + K_d f_\\mathrm{max} (u - x_1) + K_i x_2
\\end{equation*}
</div>
<div class="section" id="note">
<h3>Note</h3>
<p>Depending on <cite>f_max</cite>, the resulting system might become stiff or ill conditioned!
As a practical choice set <cite>f_max</cite> to 3x the highest expected signal frequency.
Since this block uses an approximation of real differentiation, the approximation will
not hold if there are high frequency components present in the signal. For example if
you have discontinuities such as steps or square waves.</p>
</div>
<div class="section" id="example">
<h3>Example</h3>
<p>The block is initialized like this:</p>
<pre class="code python literal-block">
#cutoff at 1kHz, windup limits at [-5, 5]
pid = AntiWindupPID(Kp=2, Ki=0.5, Kd=0.1, f_max=1e3, limits=[-5, 5])
</pre>
</div>
<div class="section" id="parameters">
<h3>Parameters</h3>
<dl class="docutils">
<dt>Kp <span class="classifier-delimiter">:</span> <span class="classifier">float</span></dt>
<dd>proportional controller coefficient</dd>
<dt>Ki <span class="classifier-delimiter">:</span> <span class="classifier">float</span></dt>
<dd>integral controller coefficient</dd>
<dt>Kd <span class="classifier-delimiter">:</span> <span class="classifier">float</span></dt>
<dd>differentiator controller coefficient</dd>
<dt>f_max <span class="classifier-delimiter">:</span> <span class="classifier">float</span></dt>
<dd>highest expected signal frequency</dd>
<dt>Ks <span class="classifier-delimiter">:</span> <span class="classifier">float</span></dt>
<dd>feedback term for back calculation for anti-windup control of integrator</dd>
<dt>limits <span class="classifier-delimiter">:</span> <span class="classifier">array_like[float]</span></dt>
<dd>lower and upper limit for PID output that triggers anti-windup of integrator</dd>
</dl>
</div>
`,params:{Kp:{type:"integer",default:"0",description:"proportional controller coefficient"},Ki:{type:"integer",default:"0",description:"integral controller coefficient"},Kd:{type:"integer",default:"0",description:"differentiator controller coefficient"},f_max:{type:"integer",default:"100",description:"highest expected signal frequency"},Ks:{type:"integer",default:"10",description:"feedback term for back calculation for anti-windup control of integrator"},limits:{type:"array",default:"[-10, 10]",description:"lower and upper limit for PID output that triggers anti-windup of integrator"}},inputs:["in"],outputs:["out"]},RateLimiter:{blockClass:"RateLimiter",description:"Rate limiter block that limits the rate of change of a signal.",docstringHtml:`<p>Rate limiter block that limits the rate of change of a signal.</p>
<p>Implements a continuous-time rate limiter as a first-order tracking system
with clipped rate of change:</p>
<div class="math">
\\begin{equation*}
\\dot{x} = \\mathrm{clip}\\left(f_\\mathrm{max} (u - x),\\; -r,\\; r\\right)
\\end{equation*}
</div>
<p>where <cite>r</cite> is the maximum allowed rate and <cite>f_max</cite> controls the tracking
bandwidth when the signal is not rate-limited. The output is the state
<span class="math">\\(y = x\\)</span>.</p>
<div class="section" id="note">
<h3>Note</h3>
<p>The parameter <cite>f_max</cite> should be set high enough that the output tracks
the input without lag when the rate is within limits.</p>
</div>
<div class="section" id="example">
<h3>Example</h3>
<p>The block is initialized like this:</p>
<pre class="code python literal-block">
#max rate of 10 units/s
rl = RateLimiter(rate=10.0, f_max=1e3)
</pre>
</div>
<div class="section" id="parameters">
<h3>Parameters</h3>
<dl class="docutils">
<dt>rate <span class="classifier-delimiter">:</span> <span class="classifier">float</span></dt>
<dd>maximum rate of change (positive value)</dd>
<dt>f_max <span class="classifier-delimiter">:</span> <span class="classifier">float</span></dt>
<dd>tracking bandwidth parameter</dd>
</dl>
</div>
`,params:{rate:{type:"number",default:"1.0",description:"maximum rate of change (positive value)"},f_max:{type:"integer",default:"100",description:"tracking bandwidth parameter"}},inputs:["in"],outputs:["out"]},Backlash:{blockClass:"Backlash",description:"Backlash (mechanical play) element.",docstringHtml:`<p>Backlash (mechanical play) element.</p>
<p>Models the hysteresis-like behavior of mechanical backlash in gears,
couplings and other systems with play. The output only tracks the input
after the input has moved through the full backlash width.</p>
<div class="math">
\\begin{equation*}
\\dot{x} = f_\\mathrm{max} \\left((u - x) - \\mathrm{clip}(u - x,\\; -w/2,\\; w/2)\\right)
\\end{equation*}
</div>
<p>where <cite>w</cite> is the total backlash width. Inside the dead zone <span class="math">\\(|u - x| \\leq w/2\\)</span>
the output does not move. Once the input pushes past the edge, the output
tracks with bandwidth <cite>f_max</cite>.</p>
<div class="section" id="example">
<h3>Example</h3>
<p>The block is initialized like this:</p>
<pre class="code python literal-block">
#backlash with 0.5 units of total play
bl = Backlash(width=0.5, f_max=1e3)
</pre>
</div>
<div class="section" id="parameters">
<h3>Parameters</h3>
<dl class="docutils">
<dt>width <span class="classifier-delimiter">:</span> <span class="classifier">float</span></dt>
<dd>total backlash width (play)</dd>
<dt>f_max <span class="classifier-delimiter">:</span> <span class="classifier">float</span></dt>
<dd>tracking bandwidth parameter when engaged</dd>
</dl>
</div>
`,params:{width:{type:"number",default:"1.0",description:"total backlash width (play)"},f_max:{type:"integer",default:"100",description:"tracking bandwidth parameter when engaged"}},inputs:["in"],outputs:["out"]},Deadband:{blockClass:"Deadband",description:"Deadband (dead zone) element.",docstringHtml:`<p>Deadband (dead zone) element.</p>
<p>Outputs zero when the input is within the dead zone, and passes
the signal shifted by the zone boundary otherwise:</p>
<div class="math">
\\begin{equation*}
y = \\begin{cases}
    u - u_\\mathrm{upper} &amp; \\text{if } u &gt; u_\\mathrm{upper} \\\\
    0 &amp; \\text{if } u_\\mathrm{lower} \\leq u \\leq u_\\mathrm{upper} \\\\
    u - u_\\mathrm{lower} &amp; \\text{if } u &lt; u_\\mathrm{lower}
\\end{cases}
\\end{equation*}
</div>
<p>or equivalently <span class="math">\\(y = u - \\mathrm{clip}(u,\\; u_\\mathrm{lower},\\; u_\\mathrm{upper})\\)</span>.</p>
<div class="section" id="example">
<h3>Example</h3>
<p>The block is initialized like this:</p>
<pre class="code python literal-block">
#symmetric dead zone of width 0.2
db = Deadband(lower=-0.1, upper=0.1)
</pre>
</div>
<div class="section" id="parameters">
<h3>Parameters</h3>
<dl class="docutils">
<dt>lower <span class="classifier-delimiter">:</span> <span class="classifier">float</span></dt>
<dd>lower bound of the dead zone</dd>
<dt>upper <span class="classifier-delimiter">:</span> <span class="classifier">float</span></dt>
<dd>upper bound of the dead zone</dd>
</dl>
</div>
`,params:{lower:{type:"number",default:"-1.0",description:"lower bound of the dead zone"},upper:{type:"number",default:"1.0",description:"upper bound of the dead zone"}},inputs:["in"],outputs:["out"]},TransferFunctionNumDen:{blockClass:"TransferFunctionNumDen",description:"This block defines a LTI (SISO) transfer function.",docstringHtml:`<p>This block defines a LTI (SISO) transfer function.</p>
<p>The transfer function is defined in polynomial (numerator-denominator) form</p>
<div class="math">
\\begin{equation*}
\\mathbf{H}(s) = \\frac{b_n + b_{n-1} s + \\dots + b_{0} s^n}{a_m + a_{m-1} s + \\dots + a_{0} s^m}
\\end{equation*}
</div>
<p>where <cite>Num</cite> is the list of numerator polynomial coefficients and <cite>Den</cite> the
list of denominator coefficients.</p>
<p>Upon initialization, the state space realization of the transfer function is
computed using <cite>scipy.signal.TransferFunction(Num, Den).to_ss()</cite>.</p>
<p>The resulting state space model of the form</p>
<div class="math">
\\begin{equation*}
\\begin{align}
    \\dot{x} &amp;= \\mathbf{A} x + \\mathbf{B} u \\\\
           y &amp;= \\mathbf{C} x + \\mathbf{D} u
\\end{align}
\\end{equation*}
</div>
<p>is handled the same as the 'StateSpace' block, where <cite>A</cite>, <cite>B</cite>, <cite>C</cite> and <cite>D</cite>
are the state space matrices, <cite>x</cite> is the internal state, <cite>u</cite> the input and
<cite>y</cite> the output vector.</p>
<div class="section" id="parameters">
<h3>Parameters</h3>
<dl class="docutils">
<dt>Num <span class="classifier-delimiter">:</span> <span class="classifier">array_like</span></dt>
<dd>numerator polynomial coefficients</dd>
<dt>Den <span class="classifier-delimiter">:</span> <span class="classifier">array_like</span></dt>
<dd>denominator polynomial coefficients</dd>
</dl>
</div>
`,params:{Num:{type:"array",default:"[1]",description:"numerator polynomial coefficients"},Den:{type:"array",default:"[1, 1]",description:"denominator polynomial coefficients"}},inputs:["in"],outputs:["out"]},TransferFunctionZPG:{blockClass:"TransferFunctionZPG",description:"This block defines a LTI (SISO) transfer function.",docstringHtml:`<p>This block defines a LTI (SISO) transfer function.</p>
<p>The transfer function is defined in zeros-poles-gain (ZPG) form</p>
<div class="math">
\\begin{equation*}
\\mathbf{H}(s) = k \\frac{(s - z_1)(s - z_2)\\cdots(s - z_m)}{(s - p_1)(s - p_2)\\cdots(s - p_n)}
\\end{equation*}
</div>
<p>where <cite>Zeros</cite> are the scalar (possibly complex conjugate) zeros of the
transfer function, and <cite>Poles</cite> are the poles (denominator zeros) of the
transfer function. <cite>Gain</cite> is the scalar factor <cite>k</cite>.</p>
<p>Upon initialization, the state space realization of the transfer function is
computed using <cite>scipy.signal.ZerosPolesGain(Zeros, Poles, Gain).to_ss()</cite>.</p>
<p>The resulting state space model of the form</p>
<div class="math">
\\begin{equation*}
\\begin{align}
    \\dot{x} &amp;= \\mathbf{A} x + \\mathbf{B} u \\\\
           y &amp;= \\mathbf{C} x + \\mathbf{D} u
\\end{align}
\\end{equation*}
</div>
<p>is handled the same as the 'StateSpace' block, where <cite>A</cite>, <cite>B</cite>, <cite>C</cite> and <cite>D</cite>
are the state space matrices, <cite>x</cite> is the internal state, <cite>u</cite> the input and
<cite>y</cite> the output vector.</p>
<div class="section" id="parameters">
<h3>Parameters</h3>
<dl class="docutils">
<dt>Poles <span class="classifier-delimiter">:</span> <span class="classifier">array_like</span></dt>
<dd>transfer function poles</dd>
<dt>Zeros <span class="classifier-delimiter">:</span> <span class="classifier">array_like</span></dt>
<dd>transfer function zeros</dd>
<dt>Gain <span class="classifier-delimiter">:</span> <span class="classifier">float</span></dt>
<dd>gain term of transfer function</dd>
</dl>
</div>
`,params:{Zeros:{type:"array",default:"[]",description:"transfer function zeros"},Poles:{type:"array",default:"[-1]",description:"transfer function poles"},Gain:{type:"number",default:"1.0",description:"gain term of transfer function"}},inputs:["in"],outputs:["out"]},ButterworthLowpassFilter:{blockClass:"ButterworthLowpassFilter",description:"Direct implementation of a low pass butterworth filter block.",docstringHtml:`<p>Direct implementation of a low pass butterworth filter block.</p>
<p>Follows the same structure as the 'StateSpace' block in the
'pathsim.blocks' module. The numerator and denominator of the
filter transfer function are generated and then the transfer
function is realized as a state space model.</p>
<div class="section" id="parameters">
<h3>Parameters</h3>
<dl class="docutils">
<dt>Fc <span class="classifier-delimiter">:</span> <span class="classifier">float</span></dt>
<dd>corner frequency of the filter in [Hz]</dd>
<dt>n <span class="classifier-delimiter">:</span> <span class="classifier">int</span></dt>
<dd>filter order</dd>
</dl>
</div>
`,params:{Fc:{type:"integer",default:"100",description:"corner frequency of the filter in [Hz]"},n:{type:"integer",default:"2",description:"filter order"}},inputs:["in"],outputs:["out"]},ButterworthHighpassFilter:{blockClass:"ButterworthHighpassFilter",description:"Direct implementation of a high pass butterworth filter block.",docstringHtml:`<p>Direct implementation of a high pass butterworth filter block.</p>
<p>Follows the same structure as the 'StateSpace' block in the
'pathsim.blocks' module. The numerator and denominator of the
filter transfer function are generated and then the transfer
function is realized as a state space model.</p>
<div class="section" id="parameters">
<h3>Parameters</h3>
<dl class="docutils">
<dt>Fc <span class="classifier-delimiter">:</span> <span class="classifier">float</span></dt>
<dd>corner frequency of the filter in [Hz]</dd>
<dt>n <span class="classifier-delimiter">:</span> <span class="classifier">int</span></dt>
<dd>filter order</dd>
</dl>
</div>
`,params:{Fc:{type:"integer",default:"100",description:"corner frequency of the filter in [Hz]"},n:{type:"integer",default:"2",description:"filter order"}},inputs:["in"],outputs:["out"]},ButterworthBandpassFilter:{blockClass:"ButterworthBandpassFilter",description:"Direct implementation of a bandpass butterworth filter block.",docstringHtml:`<p>Direct implementation of a bandpass butterworth filter block.</p>
<p>Follows the same structure as the 'StateSpace' block in the
'pathsim.blocks' module. The numerator and denominator of the
filter transfer function are generated and then the transfer
function is realized as a state space model.</p>
<div class="section" id="parameters">
<h3>Parameters</h3>
<dl class="docutils">
<dt>Fc <span class="classifier-delimiter">:</span> <span class="classifier">list[float]</span></dt>
<dd>corner frequencies (left, right) of the filter in [Hz]</dd>
<dt>n <span class="classifier-delimiter">:</span> <span class="classifier">int</span></dt>
<dd>filter order</dd>
</dl>
</div>
`,params:{Fc:{type:"array",default:"[50, 100]",description:"corner frequencies (left, right) of the filter in [Hz]"},n:{type:"integer",default:"2",description:"filter order"}},inputs:["in"],outputs:["out"]},ButterworthBandstopFilter:{blockClass:"ButterworthBandstopFilter",description:"Direct implementation of a bandstop butterworth filter block.",docstringHtml:`<p>Direct implementation of a bandstop butterworth filter block.</p>
<p>Follows the same structure as the 'StateSpace' block in the
'pathsim.blocks' module. The numerator and denominator of the
filter transfer function are generated and then the transfer
function is realized as a state space model.</p>
<div class="section" id="parameters">
<h3>Parameters</h3>
<dl class="docutils">
<dt>Fc <span class="classifier-delimiter">:</span> <span class="classifier">tuple[float], list[float]</span></dt>
<dd>corner frequencies (left, right) of the filter in [Hz]</dd>
<dt>n <span class="classifier-delimiter">:</span> <span class="classifier">int</span></dt>
<dd>filter order</dd>
</dl>
</div>
`,params:{Fc:{type:"array",default:"[50, 100]",description:"corner frequencies (left, right) of the filter in [Hz]"},n:{type:"integer",default:"2",description:"filter order"}},inputs:["in"],outputs:["out"]},Adder:{blockClass:"Adder",description:"Summs / adds up all input signals to a single output signal (MISO)",docstringHtml:`<p>Summs / adds up all input signals to a single output signal (MISO)</p>
<p>This is how it works in the default case</p>
<div class="math">
\\begin{equation*}
y(t) = \\sum_i u_i(t)
\\end{equation*}
</div>
<p>and like this when additional operations are defined</p>
<div class="math">
\\begin{equation*}
y(t) = \\sum_i \\mathrm{op}_i \\cdot u_i(t)
\\end{equation*}
</div>
<div class="section" id="example">
<h3>Example</h3>
<p>This is the default initialization that just adds up all the inputs:</p>
<pre class="code python literal-block">
A = Adder()
</pre>
<p>and this is the initialization with specific operations that subtracts
the second from first input and neglects all others:</p>
<pre class="code python literal-block">
A = Adder('+-')
</pre>
</div>
<div class="section" id="note">
<h3>Note</h3>
<p>This block is purely algebraic and its operation (<cite>op_alg</cite>) will be called
multiple times per timestep, each time when <cite>Simulation._update(t)</cite> is
called in the global simulation loop.</p>
</div>
<div class="section" id="parameters">
<h3>Parameters</h3>
<dl class="docutils">
<dt>operations <span class="classifier-delimiter">:</span> <span class="classifier">str, optional</span></dt>
<dd>optional string of operations to be applied before
summation, i.e. '+-' will compute the difference,
'None' will just perform regular sum</dd>
</dl>
</div>
<div class="section" id="attributes">
<h3>Attributes</h3>
<dl class="docutils">
<dt>_ops <span class="classifier-delimiter">:</span> <span class="classifier">dict</span></dt>
<dd>dict that maps string operations to numerical</dd>
<dt>_ops_array <span class="classifier-delimiter">:</span> <span class="classifier">array_like</span></dt>
<dd>operations converted to array</dd>
<dt>op_alg <span class="classifier-delimiter">:</span> <span class="classifier">Operator</span></dt>
<dd>internal algebraic operator</dd>
</dl>
</div>
`,params:{operations:{type:"any",default:null,description:"optional string of operations to be applied before summation, i.e. '+-' will compute the difference, 'None' will just perform regular sum"}},inputs:null,outputs:["out"]},Multiplier:{blockClass:"Multiplier",description:"Multiplies all signals from all input ports (MISO).",docstringHtml:`<p>Multiplies all signals from all input ports (MISO).</p>
<div class="math">
\\begin{equation*}
y(t) = \\prod_i u_i(t)
\\end{equation*}
</div>
<div class="section" id="note">
<h3>Note</h3>
<p>This block is purely algebraic and its operation (<cite>op_alg</cite>) will be called
multiple times per timestep, each time when <cite>Simulation._update(t)</cite> is
called in the global simulation loop.</p>
</div>
<div class="section" id="attributes">
<h3>Attributes</h3>
<dl class="docutils">
<dt>op_alg <span class="classifier-delimiter">:</span> <span class="classifier">Operator</span></dt>
<dd>internal algebraic operator that wraps 'prod'</dd>
</dl>
</div>
`,params:{},inputs:null,outputs:["out"]},Amplifier:{blockClass:"Amplifier",description:"Amplifies the input signal by multiplication with a constant gain term.",docstringHtml:`<p>Amplifies the input signal by multiplication with a constant gain term.</p>
<p>Like this:</p>
<div class="math">
\\begin{equation*}
y(t) = \\mathrm{gain} \\cdot u(t)
\\end{equation*}
</div>
<div class="section" id="note">
<h3>Note</h3>
<p>This block is purely algebraic and its operation (<cite>op_alg</cite>) will be called
multiple times per timestep, each time when <cite>Simulation._update(t)</cite> is
called in the global simulation loop.</p>
</div>
<div class="section" id="example">
<h3>Example</h3>
<p>The block is initialized like this:</p>
<pre class="code python literal-block">
#amplification by factor 5
A = Amplifier(gain=5)
</pre>
</div>
<div class="section" id="parameters">
<h3>Parameters</h3>
<dl class="docutils">
<dt>gain <span class="classifier-delimiter">:</span> <span class="classifier">float</span></dt>
<dd>amplifier gain</dd>
</dl>
</div>
<div class="section" id="attributes">
<h3>Attributes</h3>
<dl class="docutils">
<dt>op_alg <span class="classifier-delimiter">:</span> <span class="classifier">Operator</span></dt>
<dd>internal algebraic operator</dd>
</dl>
</div>
`,params:{gain:{type:"number",default:"1.0",description:"amplifier gain"}},inputs:null,outputs:null},Function:{blockClass:"Function",description:"Arbitrary MIMO function block, defined by a function or `lambda` expression.",docstringHtml:`<p>Arbitrary MIMO function block, defined by a function or <cite>lambda</cite> expression.</p>
<p>The function can have multiple arguments that are then provided
by the input channels of the function block.</p>
<p>Form multi input, the function has to specify multiple arguments
and for multi output, the aoutputs have to be provided as a
tuple or list.</p>
<p>In the context of the global system, this block implements algebraic
components of the global system ODE/DAE.</p>
<div class="math">
\\begin{equation*}
\\vec{y} = \\mathrm{func}(\\vec{u})
\\end{equation*}
</div>
<div class="section" id="note">
<h3>Note</h3>
<p>This block is purely algebraic and its operation (<cite>op_alg</cite>) will be called
multiple times per timestep, each time when <cite>Simulation._update(t)</cite> is
called in the global simulation loop.
Therefore <cite>func</cite> must be purely algebraic and not introduce states,
delay, etc. For interfacing with external stateful APIs, use the
<cite>Wrapper</cite> block.</p>
</div>
<div class="section" id="note-1">
<h3>Note</h3>
<p>If the outputs are provided as a single numpy array, they are
considered a single output. For MIMO, output has to be tuple.</p>
</div>
<div class="section" id="example">
<h3>Example</h3>
<p>consider the function:</p>
<pre class="code python literal-block">
from pathsim.blocks import Function

def f(a, b, c):
    return a**2, a*b, b/c

fn = Function(f)
</pre>
<p>then, when the block is updated, the input channels of the block are
assigned to the function arguments following this scheme:</p>
<pre class="code literal-block">
inputs[0] -&gt; a
inputs[1] -&gt; b
inputs[2] -&gt; c
</pre>
<p>and the function outputs are assigned to the
output channels of the block in the same way:</p>
<pre class="code literal-block">
a**2 -&gt; outputs[0]
a*b  -&gt; outputs[1]
b/c  -&gt; outputs[2]
</pre>
<p>Because the <cite>Function</cite> block only has a single argument, it can be
used to decorate a function and make it a <cite>PathSim</cite> block. This might
be handy in some cases to keep definitions concise and localized
in the code:</p>
<pre class="code python literal-block">
from pathsim.blocks import Function

#does the same as the definition above

&#64;Function
def fn(a, b, c):
    return a**2, a*b, b/c

#'fn' is now a PathSim block
</pre>
</div>
<div class="section" id="parameters">
<h3>Parameters</h3>
<dl class="docutils">
<dt>func <span class="classifier-delimiter">:</span> <span class="classifier">callable</span></dt>
<dd>MIMO function that defines algebraic block IO behaviour, signature <cite>func(*tuple)</cite></dd>
</dl>
</div>
<div class="section" id="attributes">
<h3>Attributes</h3>
<dl class="docutils">
<dt>op_alg <span class="classifier-delimiter">:</span> <span class="classifier">Operator</span></dt>
<dd>internal algebraic operator that wraps <cite>func</cite></dd>
</dl>
</div>
`,params:{func:{type:"callable",default:null,description:"MIMO function that defines algebraic block IO behaviour, signature `func(*tuple)`"}},inputs:null,outputs:null},Sin:{blockClass:"Sin",description:"Sine operator block.",docstringHtml:`<p>Sine operator block.</p>
<p>This block supports vector inputs. This is the operation it does:</p>
<div class="math">
\\begin{equation*}
\\vec{y} = \\sin(\\vec{u})
\\end{equation*}
</div>
<div class="section" id="attributes">
<h3>Attributes</h3>
<dl class="docutils">
<dt>op_alg <span class="classifier-delimiter">:</span> <span class="classifier">Operator</span></dt>
<dd>internal algebraic operator</dd>
</dl>
</div>
`,params:{},inputs:null,outputs:null},Cos:{blockClass:"Cos",description:"Cosine operator block.",docstringHtml:`<p>Cosine operator block.</p>
<p>This block supports vector inputs. This is the operation it does:</p>
<div class="math">
\\begin{equation*}
\\vec{y} = \\cos(\\vec{u})
\\end{equation*}
</div>
<div class="section" id="attributes">
<h3>Attributes</h3>
<dl class="docutils">
<dt>op_alg <span class="classifier-delimiter">:</span> <span class="classifier">Operator</span></dt>
<dd>internal algebraic operator</dd>
</dl>
</div>
`,params:{},inputs:null,outputs:null},Tan:{blockClass:"Tan",description:"Tangent operator block.",docstringHtml:`<p>Tangent operator block.</p>
<p>This block supports vector inputs. This is the operation it does:</p>
<div class="math">
\\begin{equation*}
\\vec{y} = \\tan(\\vec{u})
\\end{equation*}
</div>
<div class="section" id="attributes">
<h3>Attributes</h3>
<dl class="docutils">
<dt>op_alg <span class="classifier-delimiter">:</span> <span class="classifier">Operator</span></dt>
<dd>internal algebraic operator</dd>
</dl>
</div>
`,params:{},inputs:null,outputs:null},Tanh:{blockClass:"Tanh",description:"Hyperbolic tangent operator block.",docstringHtml:`<p>Hyperbolic tangent operator block.</p>
<p>This block supports vector inputs. This is the operation it does:</p>
<div class="math">
\\begin{equation*}
\\vec{y} = \\tanh(\\vec{u})
\\end{equation*}
</div>
<div class="section" id="attributes">
<h3>Attributes</h3>
<dl class="docutils">
<dt>op_alg <span class="classifier-delimiter">:</span> <span class="classifier">Operator</span></dt>
<dd>internal algebraic operator</dd>
</dl>
</div>
`,params:{},inputs:null,outputs:null},Abs:{blockClass:"Abs",description:"Absolute value operator block.",docstringHtml:`<p>Absolute value operator block.</p>
<p>This block supports vector inputs. This is the operation it does:</p>
<div class="math">
\\begin{equation*}
\\vec{y} = \\vert| \\vec{u} \\vert|
\\end{equation*}
</div>
<div class="section" id="attributes">
<h3>Attributes</h3>
<dl class="docutils">
<dt>op_alg <span class="classifier-delimiter">:</span> <span class="classifier">Operator</span></dt>
<dd>internal algebraic operator</dd>
</dl>
</div>
`,params:{},inputs:null,outputs:null},Sqrt:{blockClass:"Sqrt",description:"Square root operator block.",docstringHtml:`<p>Square root operator block.</p>
<p>This block supports vector inputs. This is the operation it does:</p>
<div class="math">
\\begin{equation*}
\\vec{y} = \\sqrt{|\\vec{u}|}
\\end{equation*}
</div>
<div class="section" id="attributes">
<h3>Attributes</h3>
<dl class="docutils">
<dt>op_alg <span class="classifier-delimiter">:</span> <span class="classifier">Operator</span></dt>
<dd>internal algebraic operator</dd>
</dl>
</div>
`,params:{},inputs:null,outputs:null},Exp:{blockClass:"Exp",description:"Exponential operator block.",docstringHtml:`<p>Exponential operator block.</p>
<p>This block supports vector inputs. This is the operation it does:</p>
<div class="math">
\\begin{equation*}
\\vec{y} = e^{\\vec{u}}
\\end{equation*}
</div>
<div class="section" id="attributes">
<h3>Attributes</h3>
<dl class="docutils">
<dt>op_alg <span class="classifier-delimiter">:</span> <span class="classifier">Operator</span></dt>
<dd>internal algebraic operator</dd>
</dl>
</div>
`,params:{},inputs:null,outputs:null},Log:{blockClass:"Log",description:"Natural logarithm operator block.",docstringHtml:`<p>Natural logarithm operator block.</p>
<p>This block supports vector inputs. This is the operation it does:</p>
<div class="math">
\\begin{equation*}
\\vec{y} = \\ln(\\vec{u})
\\end{equation*}
</div>
<div class="section" id="attributes">
<h3>Attributes</h3>
<dl class="docutils">
<dt>op_alg <span class="classifier-delimiter">:</span> <span class="classifier">Operator</span></dt>
<dd>internal algebraic operator</dd>
</dl>
</div>
`,params:{},inputs:null,outputs:null},Log10:{blockClass:"Log10",description:"Base-10 logarithm operator block.",docstringHtml:`<p>Base-10 logarithm operator block.</p>
<p>This block supports vector inputs. This is the operation it does:</p>
<div class="math">
\\begin{equation*}
\\vec{y} = \\log_{10}(\\vec{u})
\\end{equation*}
</div>
<div class="section" id="attributes">
<h3>Attributes</h3>
<dl class="docutils">
<dt>op_alg <span class="classifier-delimiter">:</span> <span class="classifier">Operator</span></dt>
<dd>internal algebraic operator</dd>
</dl>
</div>
`,params:{},inputs:null,outputs:null},Mod:{blockClass:"Mod",description:"Modulo operator block.",docstringHtml:`<p>Modulo operator block.</p>
<p>This block supports vector inputs. This is the operation it does:</p>
<div class="math">
\\begin{equation*}
\\vec{y} = \\vec{u} \\bmod m
\\end{equation*}
</div>
<div class="section" id="note">
<h3>Note</h3>
<p>modulo is not differentiable at discontinuities</p>
</div>
<div class="section" id="parameters">
<h3>Parameters</h3>
<dl class="docutils">
<dt>modulus <span class="classifier-delimiter">:</span> <span class="classifier">float</span></dt>
<dd>modulus value</dd>
</dl>
</div>
<div class="section" id="attributes">
<h3>Attributes</h3>
<dl class="docutils">
<dt>op_alg <span class="classifier-delimiter">:</span> <span class="classifier">Operator</span></dt>
<dd>internal algebraic operator</dd>
</dl>
</div>
`,params:{modulus:{type:"number",default:"1.0",description:"modulus value Attributes ----------"}},inputs:null,outputs:null},Clip:{blockClass:"Clip",description:"Clipping/saturation operator block.",docstringHtml:`<p>Clipping/saturation operator block.</p>
<p>This block supports vector inputs. This is the operation it does:</p>
<div class="math">
\\begin{equation*}
\\vec{y} = \\text{clip}(\\vec{u}, u_{min}, u_{max})
\\end{equation*}
</div>
<div class="section" id="parameters">
<h3>Parameters</h3>
<dl class="docutils">
<dt>min_val <span class="classifier-delimiter">:</span> <span class="classifier">float, array_like</span></dt>
<dd>minimum clipping value</dd>
<dt>max_val <span class="classifier-delimiter">:</span> <span class="classifier">float, array_like</span></dt>
<dd>maximum clipping value</dd>
</dl>
</div>
<div class="section" id="attributes">
<h3>Attributes</h3>
<dl class="docutils">
<dt>op_alg <span class="classifier-delimiter">:</span> <span class="classifier">Operator</span></dt>
<dd>internal algebraic operator</dd>
</dl>
</div>
`,params:{min_val:{type:"number",default:"-1.0",description:"minimum clipping value"},max_val:{type:"number",default:"1.0",description:"maximum clipping value Attributes ----------"}},inputs:null,outputs:null},Pow:{blockClass:"Pow",description:"Raise to power operator block.",docstringHtml:`<p>Raise to power operator block.</p>
<p>This block supports vector inputs. This is the operation it does:</p>
<div class="math">
\\begin{equation*}
\\vec{y} = \\vec{u}^{p}
\\end{equation*}
</div>
<div class="section" id="parameters">
<h3>Parameters</h3>
<dl class="docutils">
<dt>exponent <span class="classifier-delimiter">:</span> <span class="classifier">float, array_like</span></dt>
<dd>exponent to raise the input to the power of</dd>
</dl>
</div>
<div class="section" id="attributes">
<h3>Attributes</h3>
<dl class="docutils">
<dt>op_alg <span class="classifier-delimiter">:</span> <span class="classifier">Operator</span></dt>
<dd>internal algebraic operator</dd>
</dl>
</div>
`,params:{exponent:{type:"integer",default:"2",description:"exponent to raise the input to the power of Attributes ----------"}},inputs:null,outputs:null},Switch:{blockClass:"Switch",description:"Switch block that selects between its inputs.",docstringHtml:`<p>Switch block that selects between its inputs.</p>
<div class="section" id="example">
<h3>Example</h3>
<p>The block is initialized like this:</p>
<pre class="code python literal-block">
#default None -&gt; no passthrough
s1 = Switch()

#selecting port 2 as passthrough
s2 = Switch(2)

#change the state of the switch to port 3
s2.select(3)
</pre>
<p>Sets block output depending on <cite>self.state</cite> like this:</p>
<pre class="code literal-block">
state == None -&gt; outputs[0] = 0

state == 0 -&gt; outputs[0] = inputs[0]

state == 1 -&gt; outputs[0] = inputs[1]

state == 2 -&gt; outputs[0] = inputs[2]

...
</pre>
</div>
<div class="section" id="parameters">
<h3>Parameters</h3>
<dl class="docutils">
<dt>state <span class="classifier-delimiter">:</span> <span class="classifier">int, None</span></dt>
<dd>state of the switch</dd>
</dl>
</div>
`,params:{state:{type:"any",default:null,description:"state of the switch"}},inputs:null,outputs:["out"]},LUT:{blockClass:"LUT",description:"N-dimensional lookup table with linear interpolation functionality.",docstringHtml:`<p>N-dimensional lookup table with linear interpolation functionality.</p>
<p>This class implements a multi-dimensional lookup table that uses scipy's
LinearNDInterpolator <a class="footnote-reference" href="#scipy" id="footnote-reference-1">[1]</a> for piecewise linear interpolation in N-dimensional
space. The interpolation is based on Delaunay triangulation of the input points,
providing smooth linear interpolation between data points. For points outside
the convex hull of the input data, the interpolator returns NaN values.</p>
<p>The LUT acts as a Function block.</p>
<div class="section" id="references">
<h3>References</h3>
<table class="docutils footnote" frame="void" id="scipy" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label"><a class="fn-backref" href="#footnote-reference-1">[1]</a></td><td><a class="reference external" href="https://docs.scipy.org/doc/scipy-1.16.1/reference/generated/scipy.interpolate.LinearNDInterpolator.html">https://docs.scipy.org/doc/scipy-1.16.1/reference/generated/scipy.interpolate.LinearNDInterpolator.html</a></td></tr>
</tbody>
</table>
</div>
<div class="section" id="parameters">
<h3>Parameters</h3>
<dl class="docutils">
<dt>points <span class="classifier-delimiter">:</span> <span class="classifier">array_like of shape (n, ndim)</span></dt>
<dd>2-D array of data point coordinates where n is the number of points
and ndim is the dimensionality of the space. Each row represents a
single data point in ndim-dimensional space.</dd>
<dt>values <span class="classifier-delimiter">:</span> <span class="classifier">array_like of shape (n,) or (n, m)</span></dt>
<dd>N-D array of data values at the corresponding points. If 1-D, represents
scalar values at each point. If 2-D, each column represents a different
output dimension (m output values per input point).</dd>
</dl>
</div>
<div class="section" id="attributes">
<h3>Attributes</h3>
<dl class="docutils">
<dt>points <span class="classifier-delimiter">:</span> <span class="classifier">ndarray</span></dt>
<dd>Stored array of input point coordinates.</dd>
<dt>values <span class="classifier-delimiter">:</span> <span class="classifier">ndarray</span></dt>
<dd>Stored array of output values at each point.</dd>
<dt>inter <span class="classifier-delimiter">:</span> <span class="classifier">scipy.interpolate.LinearNDInterpolator</span></dt>
<dd>The scipy linear interpolator object used for interpolation.</dd>
</dl>
</div>
`,params:{points:{type:"any",default:null,description:"2-D array of data point coordinates where n is the number of points and ndim is the dimensionality of the space. Each row represents a single data point in ndim-dimensional space."},values:{type:"any",default:null,description:"N-D array of data values at the corresponding points. If 1-D, represents scalar values at each point. If 2-D, each column represents a different output dimension (m output values per input point)."}},inputs:null,outputs:null},LUT1D:{blockClass:"LUT1D",description:"One-dimensional lookup table with linear interpolation functionality.",docstringHtml:`<p>One-dimensional lookup table with linear interpolation functionality.</p>
<p>This class implements a 1-dimensional lookup table that uses scipy's interp1d <a class="footnote-reference" href="#scipy" id="footnote-reference-1">[1]</a>
for piecewise linear interpolation along a single axis. The interpolation
provides linear interpolation between adjacent data points and supports
extrapolation beyond the input data range using the 'extrapolate' fill mode.</p>
<p>The LUT1D acts as a Function block.</p>
<div class="section" id="references">
<h3>References</h3>
<table class="docutils footnote" frame="void" id="scipy" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label"><a class="fn-backref" href="#footnote-reference-1">[1]</a></td><td><a class="reference external" href="https://docs.scipy.org/doc/scipy-1.16.1/reference/generated/scipy.interpolate.interp1d.html">https://docs.scipy.org/doc/scipy-1.16.1/reference/generated/scipy.interpolate.interp1d.html</a></td></tr>
</tbody>
</table>
</div>
<div class="section" id="parameters">
<h3>Parameters</h3>
<dl class="docutils">
<dt>points <span class="classifier-delimiter">:</span> <span class="classifier">array_like of shape (n,)</span></dt>
<dd>1-D array of monotonically increasing data point coordinates where n
is the number of points. These represent the independent variable values
at which the dependent values are known.</dd>
<dt>values <span class="classifier-delimiter">:</span> <span class="classifier">array_like of shape (n,) or (n, m)</span></dt>
<dd>1-D or 2-D array of data values at the corresponding points. If 1-D,
represents scalar values at each point. If 2-D with shape (n, m),
each column represents a different output dimension, allowing the
lookup table to return m-dimensional vectors.</dd>
<dt>fill_value <span class="classifier-delimiter">:</span> <span class="classifier">float or str, optional</span></dt>
<dd>The value to use for points outside the interpolation range. If &quot;extrapolate&quot;,
the interpolator will use linear extrapolation. Default is &quot;extrapolate&quot;.
See <a class="reference external" href="https://docs.scipy.org/doc/scipy-1.16.1/reference/generated/scipy.interpolate.interp1d.html">https://docs.scipy.org/doc/scipy-1.16.1/reference/generated/scipy.interpolate.interp1d.html</a> for more details</dd>
</dl>
</div>
<div class="section" id="attributes">
<h3>Attributes</h3>
<dl class="docutils">
<dt>points <span class="classifier-delimiter">:</span> <span class="classifier">ndarray</span></dt>
<dd>Flattened array of input point coordinates, stored as 1-D array.</dd>
<dt>values <span class="classifier-delimiter">:</span> <span class="classifier">ndarray</span></dt>
<dd>Stored array of output values at each point, preserving original shape.</dd>
<dt>inter <span class="classifier-delimiter">:</span> <span class="classifier">scipy.interpolate.interp1d</span></dt>
<dd>The scipy 1D interpolator object used for linear interpolation with
extrapolation enabled beyond the data range.</dd>
</dl>
</div>
`,params:{points:{type:"any",default:null,description:"1-D array of monotonically increasing data point coordinates where n is the number of points. These represent the independent variable values at which the dependent values are known."},values:{type:"any",default:null,description:"1-D or 2-D array of data values at the corresponding points. If 1-D, represents scalar values at each point. If 2-D with shape (n, m), each column represents a different output dimension, allowing the lookup table to return m-dimensional vectors."},fill_value:{type:"string",default:'"extrapolate"',description:'The value to use for points outside the interpolation range. If "extrapolate", the interpolator will use linear extrapolation. Default is "extrapolate". See https://docs.scipy.org/doc/scipy-1.16.1/reference/generated/scipy.interpolate.interp1d.html for more details'}},inputs:null,outputs:null},SampleHold:{blockClass:"SampleHold",description:"Samples the inputs periodically and produces them at the output.",docstringHtml:`<p>Samples the inputs periodically and produces them at the output.</p>
<div class="section" id="parameters">
<h3>Parameters</h3>
<dl class="docutils">
<dt>T <span class="classifier-delimiter">:</span> <span class="classifier">float</span></dt>
<dd>sampling period</dd>
<dt>tau <span class="classifier-delimiter">:</span> <span class="classifier">float</span></dt>
<dd>delay</dd>
</dl>
</div>
<div class="section" id="attributes">
<h3>Attributes</h3>
<dl class="docutils">
<dt>events <span class="classifier-delimiter">:</span> <span class="classifier">list[Schedule]</span></dt>
<dd>internal scheduled event for periodic sampling</dd>
</dl>
</div>
`,params:{T:{type:"integer",default:"1",description:"sampling period"},tau:{type:"integer",default:"0",description:"delay Attributes ----------"}},inputs:null,outputs:null},FIR:{blockClass:"FIR",description:"Models a discrete-time Finite-Impulse-Response (FIR) filter.",docstringHtml:`<p>Models a discrete-time Finite-Impulse-Response (FIR) filter.</p>
<p>This block applies an FIR filter to an input signal sampled periodically.
The output at each sample time is a weighted sum of the current and a finite number
of past input samples. The operation is triggered by a scheduled event.</p>
<p>Functionality:</p>
<div class="math">
\\begin{equation*}
y[n] = b[0] x[n] + b[1] x[n-1] + \\dots + b[N] x[n-N]
\\end{equation*}
</div>
<p>where <cite>b</cite> are the filter coefficients and <cite>N</cite> is the filter order (number of
coefficients - 1).</p>
<ol class="arabic simple">
<li>Samples the input <cite>inputs[0]</cite> at intervals of <cite>T</cite>, starting after delay <cite>tau</cite>.</li>
<li>Stores the current and past <cite>len(coefficients) - 1</cite> input samples in an internal buffer.</li>
<li>Computes the filter output using the dot product of the coefficients
and the buffered input samples.</li>
<li>Outputs the result on <cite>outputs[0]</cite>.</li>
<li>Holds the output constant between updates.</li>
</ol>
<div class="section" id="parameters">
<h3>Parameters</h3>
<dl class="docutils">
<dt>coeffs <span class="classifier-delimiter">:</span> <span class="classifier">array_like</span></dt>
<dd>List or numpy array of FIR filter coefficients [b0, b1, ..., bN].
The number of coefficients determines the filter's order and memory.</dd>
<dt>T <span class="classifier-delimiter">:</span> <span class="classifier">float, optional</span></dt>
<dd>Sampling period (time between input samples and output updates). Default is 1.</dd>
<dt>tau <span class="classifier-delimiter">:</span> <span class="classifier">float, optional</span></dt>
<dd>Initial delay before the first sample is processed. Default is 0.</dd>
</dl>
</div>
<div class="section" id="input-ports">
<h3>Input Ports</h3>
<dl class="docutils">
<dt>inputs[0] <span class="classifier-delimiter">:</span> <span class="classifier">float</span></dt>
<dd>Input signal sample at the current time step.</dd>
</dl>
</div>
<div class="section" id="output-ports">
<h3>Output Ports</h3>
<dl class="docutils">
<dt>outputs[0] <span class="classifier-delimiter">:</span> <span class="classifier">float</span></dt>
<dd>Filtered output signal sample.</dd>
</dl>
</div>
<div class="section" id="attributes">
<h3>Attributes</h3>
<dl class="docutils">
<dt>buffer <span class="classifier-delimiter">:</span> <span class="classifier">deque</span></dt>
<dd>Internal buffer storing the most recent input samples.</dd>
<dt>events <span class="classifier-delimiter">:</span> <span class="classifier">list[Schedule]</span></dt>
<dd>Internal scheduled event triggering the filter calculation.</dd>
</dl>
</div>
`,params:{coeffs:{type:"array",default:"[1.0]",description:"List or numpy array of FIR filter coefficients [b0, b1, ..., bN]. The number of coefficients determines the filter's order and memory."},T:{type:"integer",default:"1",description:"Sampling period (time between input samples and output updates). Default is 1."},tau:{type:"integer",default:"0",description:"Initial delay before the first sample is processed. Default is 0."}},inputs:["in"],outputs:["out"]},ADC:{blockClass:"ADC",description:"Models an ideal Analog-to-Digital Converter (ADC).",docstringHtml:`<p>Models an ideal Analog-to-Digital Converter (ADC).</p>
<p>This block samples an analog input signal periodically, quantizes it
according to the specified number of bits and input span, and outputs
the resulting digital code on multiple output ports. The sampling
is triggered by a scheduled event.</p>
<p>Functionality:</p>
<ol class="arabic simple">
<li>Samples the analog input <cite>inputs[0]</cite> at intervals of <cite>T</cite>, starting after delay <cite>tau</cite>.</li>
<li>Clips the input voltage to the defined <cite>span</cite> [min_voltage, max_voltage].</li>
<li>Scales the clipped voltage to the range [0, 1].</li>
<li>Quantizes the scaled value to an integer code between 0 and 2^n_bits - 1 using flooring.</li>
<li>Converts the integer code to an n_bits binary representation.</li>
<li>Outputs the binary code on ports 0 (LSB) to n_bits-1 (MSB).</li>
</ol>
<p>Ideal characteristics:</p>
<ul class="simple">
<li>Instantaneous sampling at scheduled times.</li>
<li>Perfect, noise-free quantization.</li>
<li>No aperture jitter or other dynamic errors.</li>
</ul>
<div class="section" id="parameters">
<h3>Parameters</h3>
<dl class="docutils">
<dt>n_bits <span class="classifier-delimiter">:</span> <span class="classifier">int, optional</span></dt>
<dd>Number of bits for the digital output code. Default is 4.</dd>
<dt>span <span class="classifier-delimiter">:</span> <span class="classifier">list[float] or tuple[float], optional</span></dt>
<dd>The valid analog input value range [min_voltage, max_voltage].
Inputs outside this range will be clipped. Default is [-1, 1].</dd>
<dt>T <span class="classifier-delimiter">:</span> <span class="classifier">float, optional</span></dt>
<dd>Sampling period (time between samples). Default is 1 time unit.</dd>
<dt>tau <span class="classifier-delimiter">:</span> <span class="classifier">float, optional</span></dt>
<dd>Initial delay before the first sample is taken. Default is 0.</dd>
</dl>
</div>
<div class="section" id="attributes">
<h3>Attributes</h3>
<dl class="docutils">
<dt>events <span class="classifier-delimiter">:</span> <span class="classifier">list[Schedule]</span></dt>
<dd>Internal scheduled event responsible for periodic sampling and conversion.</dd>
</dl>
</div>
`,params:{n_bits:{type:"integer",default:"4",description:"Number of bits for the digital output code. Default is 4."},span:{type:"array",default:"[-1, 1]",description:"The valid analog input value range [min_voltage, max_voltage]. Inputs outside this range will be clipped. Default is [-1, 1]."},T:{type:"integer",default:"1",description:"Sampling period (time between samples). Default is 1 time unit."},tau:{type:"integer",default:"0",description:"Initial delay before the first sample is taken. Default is 0."}},inputs:["in"],outputs:null},DAC:{blockClass:"DAC",description:"Models an ideal Digital-to-Analog Converter (DAC).",docstringHtml:`<p>Models an ideal Digital-to-Analog Converter (DAC).</p>
<p>This block reads a digital input code periodically from its input ports,
reconstructs the corresponding analog value based on the number of bits
and output span, and holds the output constant between updates. The update
is triggered by a scheduled event.</p>
<p>Functionality:</p>
<ol class="arabic simple">
<li>Reads the digital code from input ports 0 (LSB) to n_bits-1 (MSB) at intervals of <cite>T</cite>, starting after delay <cite>tau</cite>.</li>
<li>Interprets the inputs as an unsigned binary integer code.</li>
<li>Converts the integer code to a fractional value between 0 and (2^n_bits - 1) / 2^n_bits.</li>
<li>Scales this fractional value to the specified analog output <cite>span</cite>.</li>
<li>Outputs the resulting analog value on <cite>outputs[0]</cite>.</li>
<li>Holds the output value constant until the next scheduled update.</li>
</ol>
<p>Ideal characteristics:</p>
<ul class="simple">
<li>Instantaneous update at scheduled times.</li>
<li>Perfect, noise-free reconstruction.</li>
<li>No glitches or settling time.</li>
</ul>
<div class="section" id="parameters">
<h3>Parameters</h3>
<dl class="docutils">
<dt>n_bits <span class="classifier-delimiter">:</span> <span class="classifier">int, optional</span></dt>
<dd>Number of digital input bits expected. Default is 4.</dd>
<dt>span <span class="classifier-delimiter">:</span> <span class="classifier">list[float] or tuple[float], optional</span></dt>
<dd>The analog output value range [min_voltage, max_voltage] corresponding
to the digital codes 0 and 2^n_bits - 1, respectively (approximately).
Default is [-1, 1].</dd>
<dt>T <span class="classifier-delimiter">:</span> <span class="classifier">float, optional</span></dt>
<dd>Update period (time between output updates). Default is 1 time unit.</dd>
<dt>tau <span class="classifier-delimiter">:</span> <span class="classifier">float, optional</span></dt>
<dd>Initial delay before the first output update. Default is 0.</dd>
</dl>
</div>
<div class="section" id="attributes">
<h3>Attributes</h3>
<dl class="docutils">
<dt>events <span class="classifier-delimiter">:</span> <span class="classifier">list[Schedule]</span></dt>
<dd>Internal scheduled event responsible for periodic updates.</dd>
</dl>
</div>
`,params:{n_bits:{type:"integer",default:"4",description:"Number of digital input bits expected. Default is 4."},span:{type:"array",default:"[-1, 1]",description:"The analog output value range [min_voltage, max_voltage] corresponding to the digital codes 0 and 2^n_bits - 1, respectively (approximately). Default is [-1, 1]."},T:{type:"integer",default:"1",description:"Update period (time between output updates). Default is 1 time unit."},tau:{type:"integer",default:"0",description:"Initial delay before the first output update. Default is 0."}},inputs:null,outputs:["out"]},Counter:{blockClass:"Counter",description:"Counts the number of detected bidirectional threshold crossings.",docstringHtml:`<p>Counts the number of detected bidirectional threshold crossings.</p>
<p>Uses zero-crossing events for the detection and sets the output
accordingly.</p>
<div class="section" id="parameters">
<h3>Parameters</h3>
<dl class="docutils">
<dt>start <span class="classifier-delimiter">:</span> <span class="classifier">int</span></dt>
<dd>counter start (initial condition)</dd>
<dt>threshold <span class="classifier-delimiter">:</span> <span class="classifier">float</span></dt>
<dd>threshold for zero crossing</dd>
</dl>
</div>
<div class="section" id="attributes">
<h3>Attributes</h3>
<dl class="docutils">
<dt>E <span class="classifier-delimiter">:</span> <span class="classifier">ZeroCrossing</span></dt>
<dd>internal event manager</dd>
<dt>events <span class="classifier-delimiter">:</span> <span class="classifier">list[ZeroCrossing]</span></dt>
<dd>internal zero crossing event</dd>
</dl>
</div>
`,params:{start:{type:"integer",default:"0",description:"counter start (initial condition)"},threshold:{type:"number",default:"0.0",description:"threshold for zero crossing Attributes ----------"}},inputs:["in"],outputs:["out"]},CounterUp:{blockClass:"CounterUp",description:"Counts the number of detected unidirectional (lo->hi) threshold crossings.",docstringHtml:`<p>Counts the number of detected unidirectional (lo-&gt;hi) threshold crossings.</p>
<div class="section" id="note">
<h3>Note</h3>
<p>This is a modification of 'Counter' which only counts
unidirectional zero-crossings (low -&gt; high)</p>
</div>
<div class="section" id="parameters">
<h3>Parameters</h3>
<dl class="docutils">
<dt>start <span class="classifier-delimiter">:</span> <span class="classifier">int</span></dt>
<dd>counter start (initial condition)</dd>
<dt>threshold <span class="classifier-delimiter">:</span> <span class="classifier">float</span></dt>
<dd>threshold for zero crossing</dd>
</dl>
</div>
<div class="section" id="attributes">
<h3>Attributes</h3>
<dl class="docutils">
<dt>E <span class="classifier-delimiter">:</span> <span class="classifier">ZeroCrossingUp</span></dt>
<dd>internal event manager</dd>
<dt>events <span class="classifier-delimiter">:</span> <span class="classifier">list[ZeroCrossing]</span></dt>
<dd>internal zero crossing event</dd>
</dl>
</div>
`,params:{start:{type:"integer",default:"0",description:"counter start (initial condition)"},threshold:{type:"number",default:"0.0",description:"threshold for zero crossing Attributes ----------"}},inputs:["in"],outputs:["out"]},CounterDown:{blockClass:"CounterDown",description:"Counts the number of detected unidirectional (hi->lo) threshold crossings.",docstringHtml:`<p>Counts the number of detected unidirectional (hi-&gt;lo) threshold crossings.</p>
<div class="section" id="note">
<h3>Note</h3>
<p>This is a modification of 'Counter' which only counts
unidirectional zero-crossings (high -&gt; low)</p>
</div>
<div class="section" id="parameters">
<h3>Parameters</h3>
<dl class="docutils">
<dt>start <span class="classifier-delimiter">:</span> <span class="classifier">int</span></dt>
<dd>counter start (initial condition)</dd>
<dt>threshold <span class="classifier-delimiter">:</span> <span class="classifier">float</span></dt>
<dd>threshold for zero crossing</dd>
</dl>
</div>
<div class="section" id="attributes">
<h3>Attributes</h3>
<dl class="docutils">
<dt>E <span class="classifier-delimiter">:</span> <span class="classifier">ZeroCrossingDown</span></dt>
<dd>internal event manager</dd>
<dt>events <span class="classifier-delimiter">:</span> <span class="classifier">list[ZeroCrossing]</span></dt>
<dd>internal zero crossing event</dd>
</dl>
</div>
`,params:{start:{type:"integer",default:"0",description:"counter start (initial condition)"},threshold:{type:"number",default:"0.0",description:"threshold for zero crossing Attributes ----------"}},inputs:["in"],outputs:["out"]},Relay:{blockClass:"Relay",description:"Relay block with hysteresis (Schmitt trigger).",docstringHtml:`<p>Relay block with hysteresis (Schmitt trigger).</p>
<p>Switches output between two values based on input crossing upper and lower
thresholds. The hysteresis prevents rapid switching when input is noisy.</p>
<p>When input rises above <cite>threshold_up</cite>, output switches to <cite>value_up</cite>.
When input falls below <cite>threshold_down</cite>, output switches to <cite>value_down</cite>.</p>
<div class="section" id="examples">
<h3>Examples</h3>
<p>Basic thermostat that turns heater on below 19Â°C, off above 21Â°C:</p>
<pre class="code python literal-block">
from pathsim.blocks import Relay

thermostat = Relay(
    threshold_up=21.0,
    threshold_down=19.0,
    value_up=0.0,
    value_down=1.0
    )
</pre>
</div>
<div class="section" id="parameters">
<h3>Parameters</h3>
<dl class="docutils">
<dt>threshold_up <span class="classifier-delimiter">:</span> <span class="classifier">float</span></dt>
<dd>threshold for transitioning to upper relay state <cite>value_up</cite> (default: 1.0)</dd>
<dt>threshold_down <span class="classifier-delimiter">:</span> <span class="classifier">float</span></dt>
<dd>threshold for transitioning to lower relay state <cite>value_down</cite> (default: 0.0)</dd>
<dt>value_up <span class="classifier-delimiter">:</span> <span class="classifier">float</span></dt>
<dd>value for upper relay state (default: 1.0)</dd>
<dt>value_down <span class="classifier-delimiter">:</span> <span class="classifier">float</span></dt>
<dd>value for lower relay state (default: 0.0)</dd>
</dl>
</div>
<div class="section" id="attributes">
<h3>Attributes</h3>
<dl class="docutils">
<dt>events <span class="classifier-delimiter">:</span> <span class="classifier">list[ZeroCrossingUp, ZeroCrossingDown]</span></dt>
<dd>internal zero crossing events for relay state transitions</dd>
</dl>
</div>
`,params:{threshold_up:{type:"number",default:"1.0",description:"threshold for transitioning to upper relay state `value_up` (default: 1.0)"},threshold_down:{type:"number",default:"0.0",description:"threshold for transitioning to lower relay state `value_down` (default: 0.0)"},value_up:{type:"number",default:"1.0",description:"value for upper relay state (default: 1.0)"},value_down:{type:"number",default:"0.0",description:"value for lower relay state (default: 0.0)"}},inputs:["in"],outputs:["out"]},Scope:{blockClass:"Scope",description:"Block for recording time domain data with variable sampling period.",docstringHtml:`<p>Block for recording time domain data with variable sampling period.</p>
<p>A time threshold can be set by <cite>t_wait</cite> to start recording data after the simulation
time is larger then the specified waiting time, i.e. <cite>t - t_wait &gt; 0</cite>.
This is useful for recording data only after all the transients have settled.</p>
<p>The block uses an internal <cite>Schedule</cite> event, when <cite>sampling_period</cite> is provided,
otherwise it just samples at every simulation timestep.</p>
<div class="section" id="parameters">
<h3>Parameters</h3>
<dl class="docutils">
<dt>sampling_period <span class="classifier-delimiter">:</span> <span class="classifier">float, None</span></dt>
<dd>time between samples, default is every timestep</dd>
<dt>t_wait <span class="classifier-delimiter">:</span> <span class="classifier">float</span></dt>
<dd>wait time before starting recording, optional</dd>
<dt>labels <span class="classifier-delimiter">:</span> <span class="classifier">list[str]</span></dt>
<dd>labels for the scope traces, and for the csv, optional</dd>
</dl>
</div>
<div class="section" id="attributes">
<h3>Attributes</h3>
<dl class="docutils">
<dt>recording_time <span class="classifier-delimiter">:</span> <span class="classifier">list[float]</span></dt>
<dd>recorded time points</dd>
<dt>recording_data <span class="classifier-delimiter">:</span> <span class="classifier">list[float]</span></dt>
<dd>recorded data points</dd>
<dt>_incremental_idx <span class="classifier-delimiter">:</span> <span class="classifier">int</span></dt>
<dd>index for incremental reading of accumulated data since last
call of incremental read</dd>
<dt>_sample_next_timestep <span class="classifier-delimiter">:</span> <span class="classifier">bool</span></dt>
<dd>flag to indicate this is a timestep to sample, only used for
event based sampling when <cite>sampling_period</cite> is provided as an arg</dd>
<dt>events <span class="classifier-delimiter">:</span> <span class="classifier">list[Schedule]</span></dt>
<dd>internal scheduled event for periodic input sampling when
<cite>sampling_period</cite> is provided</dd>
</dl>
</div>
`,params:{sampling_period:{type:"any",default:null,description:"time between samples, default is every timestep"},t_wait:{type:"number",default:"0.0",description:"wait time before starting recording, optional"},labels:{type:"any",default:null,description:"labels for the scope traces, and for the csv, optional"}},inputs:null,outputs:[]},Spectrum:{blockClass:"Spectrum",description:"Block for fourier spectrum analysis (spectrum analyzer).",docstringHtml:`<p>Block for fourier spectrum analysis (spectrum analyzer).</p>
<p>Computes continuous time running fourier transform (RFT) of the incoming signal.</p>
<p>A time threshold can be set by 't_wait' to start recording data only after the
simulation time is larger then the specified waiting time, i.e. 't - t_wait &gt; dt'.
This is useful for recording the steady state after all the transients have settled.</p>
<p>An exponential forgetting factor 'alpha' can be specified for realtime spectral
analysis. It biases the spectral components exponentially to the most recent signal
values by applying a single sided exponential window like this:</p>
<div class="math">
\\begin{equation*}
\\int_0^t u(\\tau) \\exp(\\alpha (t-\\tau))  \\exp(-j \\omega \\tau)\\ d \\tau
\\end{equation*}
</div>
<p>It is also known as the 'exponentially forgetting transform' (EFT) and a form of
short time fourier transform (STFT). It is implemented as a 1st order statespace model</p>
<div class="math">
\\begin{equation*}
\\dot{x} = - \\alpha  x +  \\exp(-j \\omega t) u
\\end{equation*}
</div>
<p>where 'u' is the input signal and 'x' is the state variable that represents the
complex fourier coefficient to the frequency 'omega'. The ODE is integrated using the
numerical integration engine of the block.</p>
<div class="section" id="example">
<h3>Example</h3>
<p>This is how to initialize it:</p>
<pre class="code python literal-block">
import numpy as np

#linear frequencies (0Hz, DC -&gt; 1kHz)
sp1 = Spectrum(
    freq=np.linspace(0, 1e3, 100),
    labels=['x1', 'x2'] #labels for two inputs
    )

#log frequencies (1Hz -&gt; 1kHz)
sp2 = Spectrum(
    freq=np.logspace(0, 3, 100)
    )

#log frequencies including DC (0Hz, DC + 1Hz -&gt; 1kHz)
sp3 = Spectrum(
    freq=np.hstack([0.0, np.logspace(0, 3, 100)])
    )

#arbitrary frequencies
sp4 = Spectrum(
    freq=np.array([0, 0.5, 20, 1e3])
    )
</pre>
</div>
<div class="section" id="note">
<h3>Note</h3>
<p>This block is relatively slow! But it is valuable for long running simulations
with few evaluation frequencies, where just FFT'ing the time series data
wouldnt be efficient OR if only the evaluation at weirdly spaced frequencies
is required. Otherwise its more efficient to just do an FFT on the time
series recording after the simulation has finished.</p>
</div>
<div class="section" id="parameters">
<h3>Parameters</h3>
<dl class="docutils">
<dt>freq <span class="classifier-delimiter">:</span> <span class="classifier">array[float]</span></dt>
<dd>list of evaluation frequencies for RFT, can be arbitrarily spaced</dd>
<dt>t_wait <span class="classifier-delimiter">:</span> <span class="classifier">float</span></dt>
<dd>wait time before starting RFT</dd>
<dt>alpha <span class="classifier-delimiter">:</span> <span class="classifier">float</span></dt>
<dd>exponential forgetting factor for realtime spectrum</dd>
<dt>labels <span class="classifier-delimiter">:</span> <span class="classifier">list[str]</span></dt>
<dd>labels for the inputs</dd>
</dl>
</div>
`,params:{freq:{type:"array",default:"[]",description:"list of evaluation frequencies for RFT, can be arbitrarily spaced"},t_wait:{type:"number",default:"0.0",description:"wait time before starting RFT"},alpha:{type:"number",default:"0.0",description:"exponential forgetting factor for realtime spectrum"},labels:{type:"array",default:"[]",description:"labels for the inputs"}},inputs:null,outputs:[]},Subsystem:{blockClass:"Subsystem",description:"Subsystem class that holds its own blocks and connecions and",docstringHtml:`<p>Subsystem class that holds its own blocks and connecions and
can natively interface with the main simulation loop.</p>
<p>IO interface is realized by a special 'Interface' block, that has extra
methods for setting and getting inputs and outputs and serves
as the interface of the internal blocks to the outside.</p>
<p>The subsystem doesnt use its 'inputs' and 'outputs' dicts directly.
It exclusively handles data transfer via the 'Interface' block.</p>
<p>This class can be used just like any other block during the simulation,
since it implements the required methods 'update' for the fixed-point
iteration (resolving algebraic loops with instant time blocks),
the 'step' method that performs timestepping (especially for dynamic
blocks with internal states) and the 'solve' method for solving the
implicit update equation for implicit solvers.</p>
<div class="section" id="example">
<h3>Example</h3>
<p>This is how we can wrap up multiple blocks within a subsystem.
In this case vanderpol system built from discrete components
instead of using an ODE block (in practice you should use
a monolithic ODE whenever possible due to performance).</p>
<pre class="code python literal-block">
from pathsim import Subsystem, Interface, Connection
from pathsim.blocks import Integrator, Function

#van der Pol parameter
mu = 1000

#blocks in the subsystem
If = Interface() # this is the interface to the outside
I1 = Integrator(2)
I2 = Integrator(0)
Fn = Function(lambda x1, x2: mu*(1 - x1**2)*x2 - x1)

sub_blocks = [If, I1, I2, Fn]

#connections in the subsystem
sub_connections = [
    Connection(I2, I1, Fn[1], If[1]),
    Connection(I1, Fn, If),
    Connection(Fn, I2)
    ]

#the subsystem acts just like a normal block
vdp = Subsystem(sub_blocks, sub_connections)
</pre>
</div>
<div class="section" id="parameters">
<h3>Parameters</h3>
<dl class="docutils">
<dt>blocks <span class="classifier-delimiter">:</span> <span class="classifier">list[Block] | None</span></dt>
<dd>internal blocks of the subsystem</dd>
<dt>connections <span class="classifier-delimiter">:</span> <span class="classifier">list[Connection] | None</span></dt>
<dd>internal connections of the subsystem</dd>
</dl>
<p>events : list[Event] | None
tolerance_fpi : float</p>
<blockquote>
absolute tolerance for convergence of algebraic loops
default see Â´SIM_TOLERANCE_FPIÂ´ in Â´_constants.pyÂ´</blockquote>
<dl class="docutils">
<dt>iterations_max <span class="classifier-delimiter">:</span> <span class="classifier">int</span></dt>
<dd>maximum allowed number of iterations for algebraic loop
solver, default see Â´SIM_ITERATIONS_MAXÂ´ in Â´_constants.pyÂ´</dd>
</dl>
</div>
<div class="section" id="attributes">
<h3>Attributes</h3>
<dl class="docutils">
<dt>interface <span class="classifier-delimiter">:</span> <span class="classifier">Interface</span></dt>
<dd>internal interface block for data transfer to the outside</dd>
<dt>graph <span class="classifier-delimiter">:</span> <span class="classifier">Graph</span></dt>
<dd>internal graph representation for fast system funcion
evluations using DAG with algebraic depths</dd>
<dt>boosters <span class="classifier-delimiter">:</span> <span class="classifier">None | list[ConnectionBooster]</span></dt>
<dd>list of boosters (fixed point accelerators) that wrap
algebraic loop closing connections assembled from the
system graph</dd>
</dl>
</div>
`,params:{},inputs:[],outputs:[]},Interface:{blockClass:"Interface",description:"Bare-bone block that serves as a data interface for the 'Subsystem' class.",docstringHtml:`<p>Bare-bone block that serves as a data interface for the 'Subsystem' class.</p>
<p>It works like this:</p>
<ul class="simple">
<li>Internal blocks of the subsystem are connected to the inputs and outputs
of this Interface block via the internal connections.</li>
<li>It behaves like a normal block (inherits the main 'Block' class methods).</li>
<li>It implements some special methods to get and set the inputs and outputs
of the blocks, that are used to translate between the internal blocks of the
subsystem and the inputs and outputs of the subsystem.</li>
<li>Handles data transfer to and from the internal subsystem blocks
to and from the inputs and outputs of the subsystem.</li>
</ul>
`,params:{},inputs:[],outputs:[]},Process:{blockClass:"Process",description:"Simplified version of the `ResidenceTime` model block",docstringHtml:`<p>Simplified version of the <cite>ResidenceTime</cite> model block
with all inputs being summed equally and only the state
and the flux being returned to the output</p>
<p>This block implements an internal 1st order linear ode with
multiple inputs, outputs and no direct passthrough.</p>
<p>The internal ODE with inputs <span class="math">\\(u_i\\)</span> :</p>
<div class="math">
\\begin{equation*}
\\dot{x} = - x / \\tau + \\mathrm{src} + \\sum_i u_i
\\end{equation*}
</div>
<p>And the output equations for output <cite>i=0</cite> and <cite>i=1</cite>:</p>
<div class="math">
\\begin{equation*}
y_0 = x
\\end{equation*}
</div>
<div class="math">
\\begin{equation*}
y_1 = x / \\tau
\\end{equation*}
</div>
<div class="section" id="parameters">
<h3>Parameters</h3>
<dl class="docutils">
<dt>tau <span class="classifier-delimiter">:</span> <span class="classifier">float</span></dt>
<dd>residence time, inverse natural frequency (eigenvalue)</dd>
<dt>initial_value <span class="classifier-delimiter">:</span> <span class="classifier">float</span></dt>
<dd>initial value of state / initial quantity of process</dd>
<dt>source_term <span class="classifier-delimiter">:</span> <span class="classifier">float</span></dt>
<dd>constant source term / generation term of the process</dd>
</dl>
</div>
`,params:{tau:{type:"integer",default:"1",description:"residence time, inverse natural frequency (eigenvalue)"},initial_value:{type:"integer",default:"0",description:"initial value of state / initial quantity of process"},source_term:{type:"integer",default:"0",description:"constant source term / generation term of the process"}},inputs:null,outputs:["x","x/tau"]},Bubbler4:{blockClass:"Bubbler4",description:"Tritium bubbling system with sequential vial collection stages.",docstringHtml:`<p>Tritium bubbling system with sequential vial collection stages.</p>
<p>This block models a tritium collection system used in fusion reactor blanket
purge gas processing. The system bubbles tritium-containing gas through a series
of liquid-filled vials to capture and concentrate tritium for measurement and
inventory tracking.</p>
<div class="section" id="physical-description">
<h3>Physical Description</h3>
<p>The bubbler consists of two parallel processing chains:</p>
<p><strong>Soluble Chain (Vials 1-2):</strong>
Tritium already in soluble forms (HTO, HT) flows sequentially through
vials 1 and 2. Each vial has a collection efficiency <span class="math">\\(\\eta_{vial}\\)</span>,
representing the fraction of tritium that dissolves into the liquid phase
and is retained.</p>
<p><strong>Insoluble Chain (Vials 3-4):</strong>
Tritium in insoluble forms (Tâ, organically bound) first undergoes catalytic
conversion to soluble forms with efficiency <span class="math">\\(\\alpha_{conv}\\)</span>. The
converted tritium, along with uncaptured soluble tritium from the first chain,
then flows through vials 3 and 4 with the same collection efficiency.</p>
</div>
<div class="section" id="mathematical-formulation">
<h3>Mathematical Formulation</h3>
<p>The system is governed by the following differential equations for the
vial inventories <span class="math">\\(x_i\\)</span>:</p>
<div class="math">
\\begin{equation*}
\\frac{dx_1}{dt} &amp;= \\eta_{vial} \\cdot u_{sol}
\\end{equation*}
</div>
<div class="math">
\\begin{equation*}
\\frac{dx_2}{dt} &amp;= \\eta_{vial} \\cdot (1-\\eta_{vial}) \\cdot u_{sol}
\\end{equation*}
</div>
<div class="math">
\\begin{equation*}
\\frac{dx_3}{dt} &amp;= \\eta_{vial} \\cdot [\\alpha_{conv} \\cdot u_{insol} + (1-\\eta_{vial})^2 \\cdot u_{sol}]
\\end{equation*}
</div>
<div class="math">
\\begin{equation*}
\\frac{dx_4}{dt} &amp;= \\eta_{vial} \\cdot (1-\\eta_{vial}) \\cdot [\\alpha_{conv} \\cdot u_{insol} + (1-\\eta_{vial})^2 \\cdot u_{sol}]
\\end{equation*}
</div>
<p>The sample output represents uncaptured tritium exiting the system:</p>
<div class="math">
\\begin{equation*}
y_{sample} = (1-\\alpha_{conv}) \\cdot u_{insol} + (1-\\eta_{vial})^2 \\cdot [\\alpha_{conv} \\cdot u_{insol} + (1-\\eta_{vial})^2 \\cdot u_{sol}]
\\end{equation*}
</div>
<dl class="docutils">
<dt>Where:</dt>
<dd><ul class="first last simple">
<li><span class="math">\\(u_{sol}\\)</span> = soluble tritium input flow rate</li>
<li><span class="math">\\(u_{insol}\\)</span> = insoluble tritium input flow rate</li>
<li><span class="math">\\(\\eta_{vial}\\)</span> = vial collection efficiency</li>
<li><span class="math">\\(\\alpha_{conv}\\)</span> = conversion efficiency from insoluble to soluble</li>
<li><span class="math">\\(x_i\\)</span> = tritium inventory in vial i</li>
</ul>
</dd>
</dl>
</div>
<div class="section" id="parameters">
<h3>Parameters</h3>
<dl class="docutils">
<dt>conversion_efficiency <span class="classifier-delimiter">:</span> <span class="classifier">float</span></dt>
<dd>Conversion efficiency from insoluble to soluble forms (<span class="math">\\(\\alpha_{conv}\\)</span>),
between 0 and 1.</dd>
<dt>vial_efficiency <span class="classifier-delimiter">:</span> <span class="classifier">float</span></dt>
<dd>Collection efficiency of each vial (<span class="math">\\(\\eta_{vial}\\)</span>), between 0 and 1.</dd>
<dt>replacement_times <span class="classifier-delimiter">:</span> <span class="classifier">float | list[float] | list[list[float]]</span></dt>
<dd>Times at which each vial is replaced with a fresh one. If None, no
replacement events are created. If a single value is provided, it is
used for all vials. If a single list of floats is provided, it will be
used for all vials. If a list of lists is provided, each sublist
corresponds to the replacement times for each vial.</dd>
</dl>
</div>
<div class="section" id="notes">
<h3>Notes</h3>
<p>Vial replacement is modeled as instantaneous reset events that set the
corresponding vial inventory to zero, simulating the physical replacement
of a full vial with an empty one.</p>
</div>
`,params:{conversion_efficiency:{type:"number",default:"0.9",description:"Conversion efficiency from insoluble to soluble forms (:math:`\\alpha_{conv}`), between 0 and 1."},vial_efficiency:{type:"number",default:"0.9",description:"Collection efficiency of each vial (:math:`\\eta_{vial}`), between 0 and 1."},replacement_times:{type:"any",default:null,description:"Times at which each vial is replaced with a fresh one. If None, no replacement events are created. If a single value is provided, it is used for all vials. If a single list of floats is provided, it will be used for all vials. If a list of lists is provided, each sublist corresponds to the replacement times for each vial."}},inputs:["sample_in_soluble","sample_in_insoluble"],outputs:["vial1","vial2","vial3","vial4","sample_out"]},Splitter:{blockClass:"Splitter",description:"Splitter block that splits the input signal into multiple",docstringHtml:`<p>Splitter block that splits the input signal into multiple
outputs weighted with the specified fractions.</p>
<div class="section" id="note">
<h3>Note</h3>
<p>The output fractions must sum to one.</p>
</div>
<div class="section" id="parameters">
<h3>Parameters</h3>
<dl class="docutils">
<dt>fractions <span class="classifier-delimiter">:</span> <span class="classifier">np.ndarray | list</span></dt>
<dd>fractions to split the input signal into,
must sum up to one</dd>
</dl>
</div>
`,params:{fractions:{type:"any",default:null,description:"fractions to split the input signal into, must sum up to one"}},inputs:["in"],outputs:null},GLC:{blockClass:"GLC",description:"Gas Liquid Contactor model block.",docstringHtml:`<p>Gas Liquid Contactor model block. Inherits from Function block.</p>
<p>More details about the model can be found in: <a class="reference external" href="https://doi.org/10.13182/FST95-A30485">https://doi.org/10.13182/FST95-A30485</a></p>
<dl class="docutils">
<dt>Args:</dt>
<dd>P_in: Inlet operating pressure [Pa]
L: Column height [m]
D: Column diameter [m]
T: Temperature [K]
g: Gravitational acceleration [m/s^2], default is 9.81
initial_nb_of_elements: Initial number of elements for BVP solver
BCs: Boundary conditions type, &quot;C-C&quot; (Closed-Closed) or &quot;O-C&quot; (Open-Closed), default is &quot;C-C&quot;</dd>
</dl>
`,params:{P_in:{type:"any",default:null,description:"L: Column height [m]"},L:{type:"any",default:null,description:"D: Column diameter [m]"},D:{type:"any",default:null,description:"T: Temperature [K]"},T:{type:"any",default:null,description:"g: Gravitational acceleration [m/s^2], default is 9.81"},BCs:{type:"any",default:null,description:""},g:{type:"number",default:"9.80665",description:"initial_nb_of_elements: Initial number of elements for BVP solver"},initial_nb_of_elements:{type:"integer",default:"20",description:'BCs: Boundary conditions type, "C-C" (Closed-Closed) or "O-C" (Open-Closed), default is "C-C"'}},inputs:["c_T_in","flow_l","y_T2_inlet","flow_g"],outputs:["c_T_out","y_T2_out","eff","P_out","Q_l","Q_g_out","n_T_out_liquid","n_T_out_gas"]}},I5={Sources:["Constant","Source","SinusoidalSource","StepSource","PulseSource","TriangleWaveSource","SquareWaveSource","GaussianPulseSource","ChirpPhaseNoiseSource","ClockSource","WhiteNoise","PinkNoise","RandomNumberGenerator"],Dynamic:["Integrator","Differentiator","Delay","ODE","DynamicalSystem","StateSpace","PT1","PT2","LeadLag","PID","AntiWindupPID","RateLimiter","Backlash","Deadband","TransferFunctionNumDen","TransferFunctionZPG","ButterworthLowpassFilter","ButterworthHighpassFilter","ButterworthBandpassFilter","ButterworthBandstopFilter"],Algebraic:["Adder","Multiplier","Amplifier","Function","Sin","Cos","Tan","Tanh","Abs","Sqrt","Exp","Log","Log10","Mod","Clip","Pow","Switch","LUT","LUT1D"],Mixed:["SampleHold","FIR","ADC","DAC","Counter","CounterUp","CounterDown","Relay"],Recording:["Scope","Spectrum"],Chemical:["Process","Bubbler4","Splitter","GLC"]},NC={ADC:"pathsim.blocks",Abs:"pathsim.blocks",Adder:"pathsim.blocks",Amplifier:"pathsim.blocks",AntiWindupPID:"pathsim.blocks",Backlash:"pathsim.blocks",Bubbler4:"pathsim_chem.tritium",ButterworthBandpassFilter:"pathsim.blocks",ButterworthBandstopFilter:"pathsim.blocks",ButterworthHighpassFilter:"pathsim.blocks",ButterworthLowpassFilter:"pathsim.blocks",ChirpPhaseNoiseSource:"pathsim.blocks",Clip:"pathsim.blocks",ClockSource:"pathsim.blocks",Constant:"pathsim.blocks",Cos:"pathsim.blocks",Counter:"pathsim.blocks",CounterDown:"pathsim.blocks",CounterUp:"pathsim.blocks",DAC:"pathsim.blocks",Deadband:"pathsim.blocks",Delay:"pathsim.blocks",Differentiator:"pathsim.blocks",DynamicalSystem:"pathsim.blocks",Exp:"pathsim.blocks",FIR:"pathsim.blocks",Function:"pathsim.blocks",GLC:"pathsim_chem.tritium",GaussianPulseSource:"pathsim.blocks",Integrator:"pathsim.blocks",LUT:"pathsim.blocks",LUT1D:"pathsim.blocks",LeadLag:"pathsim.blocks",Log:"pathsim.blocks",Log10:"pathsim.blocks",Mod:"pathsim.blocks",Multiplier:"pathsim.blocks",ODE:"pathsim.blocks",PID:"pathsim.blocks",PT1:"pathsim.blocks",PT2:"pathsim.blocks",PinkNoise:"pathsim.blocks",Pow:"pathsim.blocks",Process:"pathsim_chem.tritium",PulseSource:"pathsim.blocks",RandomNumberGenerator:"pathsim.blocks",RateLimiter:"pathsim.blocks",Relay:"pathsim.blocks",SampleHold:"pathsim.blocks",Scope:"pathsim.blocks",Sin:"pathsim.blocks",SinusoidalSource:"pathsim.blocks",Source:"pathsim.blocks",Spectrum:"pathsim.blocks",Splitter:"pathsim_chem.tritium",Sqrt:"pathsim.blocks",SquareWaveSource:"pathsim.blocks",StateSpace:"pathsim.blocks",StepSource:"pathsim.blocks",Switch:"pathsim.blocks",Tan:"pathsim.blocks",Tanh:"pathsim.blocks",TransferFunctionNumDen:"pathsim.blocks",TransferFunctionZPG:"pathsim.blocks",TriangleWaveSource:"pathsim.blocks",WhiteNoise:"pathsim.blocks"};function CC(t){if(t==null||t==="None"||t==="")return null;let e=String(t).trim();return e.length===0||((e.startsWith("'")&&e.endsWith("'")||e.startsWith('"')&&e.endsWith('"'))&&(e=e.slice(1,-1)),e.length===0)?null:[...e]}const PC={Scope:{param:"labels",direction:"input"},Spectrum:{param:"labels",direction:"input"},Adder:{param:"operations",direction:"input",parser:CC}};function EC(t){const e=PC[t];return e?Array.isArray(e)?e:[e]:[]}const IC=new Set(["Integrator","Differentiator","Delay","Amplifier","Sin","Cos","Tan","Tanh","Abs","Sqrt","Exp","Log","Log10","Mod","Clip","Pow","SampleHold"]);class LC{nodes=new Map;byCategory=new Map;register(e){this.nodes.set(e.type,e);const n=this.byCategory.get(e.category)||[];n.push(e),this.byCategory.set(e.category,n)}get(e){return this.nodes.get(e)}getByCategory(e){return this.byCategory.get(e)||[]}getAllCategories(){return Array.from(this.byCategory.keys())}getAll(){return Array.from(this.nodes.values())}has(e){return this.nodes.has(e)}get size(){return this.nodes.size}}const Ri=new LC;function MC(t,e,n){const i={};for(const[c,u]of Object.entries(n.params))i[c]={type:u.type,default:u.default,description:u.description,min:u.min,max:u.max,options:u.options};let r,s;n.inputs===null?(r=void 0,s=null):n.inputs.length>0?(r=n.inputs,s=n.inputs.length):(r=[],s=0);let a,o;n.outputs===null?(a=void 0,o=null):n.outputs.length>0?(a=n.outputs,o=n.outputs.length):(a=[],o=0);const l=I1({name:t,category:e,blockClass:n.blockClass,description:n.description,inputs:r,outputs:a,maxInputs:s,maxOutputs:o,syncPorts:IC.has(t),params:i});n.docstringHtml&&(l.docstring=n.docstringHtml),Ri.register(l)}function TC(){for(const[t,e]of Object.entries(I5))for(const n of e){const i=Mh[n];i?MC(n,t,i):console.warn(`Block "${n}" not found in extracted blocks`)}}TC();const fg=I1({name:"Subsystem",category:"Subsystem",description:"",blockClass:"Subsystem",inputs:[],outputs:[],minInputs:0,minOutputs:0,maxInputs:null,maxOutputs:null,shape:"rect",params:{}}),hg=I1({name:"Interface",category:"Subsystem",description:"",blockClass:"Interface",inputs:[],outputs:[],minInputs:0,minOutputs:0,maxInputs:null,maxOutputs:null,shape:"rect",params:{}});function DC(){const t=Mh.Subsystem,e=Mh.Interface;t&&(fg.description=t.description,fg.docstring=t.docstringHtml),e&&(hg.description=e.description,hg.docstring=e.docstringHtml),Ri.register(fg),Ri.register(hg)}DC();const L5=new Map;function Fu(t){L5.set(t.id,t)}function Mv(t){return L5.get(t)}Fu({id:"pill",name:"Pill",cssClass:"shape-pill",borderRadius:"20px",svgRadius:20});Fu({id:"rect",name:"Rectangle",cssClass:"shape-rect",borderRadius:"4px",svgRadius:4});Fu({id:"circle",name:"Circle",cssClass:"shape-circle",borderRadius:"16px",svgRadius:16});Fu({id:"diamond",name:"Diamond",cssClass:"shape-diamond",borderRadius:"4px",svgRadius:4});Fu({id:"mixed",name:"Mixed",cssClass:"shape-mixed",borderRadius:"12px 4px 12px 4px",svgRadius:[12,4,12,4]});Fu({id:"default",name:"Default",cssClass:"shape-default",borderRadius:"8px",svgRadius:8});const OC={Sources:"pill",Dynamic:"rect",Algebraic:"rect",Mixed:"mixed",Recording:"pill",Subsystem:"rect"};function FC(t){return OC[t]||"default"}const _n={SUBSYSTEM:"Subsystem",INTERFACE:"Interface"};function M5(t){if(t.shape){const i=Mv(t.shape);if(i)return i.cssClass}const e=FC(t.category);return Mv(e)?.cssClass||"shape-default"}function ao(t){return("type"in t,t.type)===_n.SUBSYSTEM}function Ld(t){return("type"in t,t.type)===_n.INTERFACE}const Ju=an(null),L1={subscribe:Ju.subscribe,open(t){Ju.set(t)},close(){Ju.set(null)},isOpen(){return Ze(Ju)!==null},getOpenId(){return Ze(Ju)}},th=t=>L1.open(t),pg=()=>L1.close();function nr(){return crypto.randomUUID()}const Gi=an(new Map),Jl=an([]),Ru=an(new Map),Bn=an([]),Er=an(new Set);function RC(t){if(t.length===0)return null;let e=Ze(Gi),n=null;for(let i=0;i<t.length;i++){const r=e.get(t[i]);if(!r||r.type!==_n.SUBSYSTEM)return null;n=r,i<t.length-1&&r.graph&&(e=new Map(r.graph.nodes.map(s=>[s.id,s])))}return n}function vr(){const t=Ze(Bn);if(t.length===0)return{nodes:Ze(Gi),connections:Ze(Jl),annotations:Ze(Ru),events:new Map};const e=RC(t);if(!e||!e.graph)return{nodes:new Map,connections:[],annotations:new Map,events:new Map};const n=e.graph.nodes.map(i=>i.type===_n.INTERFACE?{...i,name:e.name,color:e.color,outputs:e.inputs.map((r,s)=>({id:`${i.id}-output-${s}`,nodeId:i.id,name:`in ${s}`,direction:"output",index:s,color:r.color})),inputs:e.outputs.map((r,s)=>({id:`${i.id}-input-${s}`,nodeId:i.id,name:`out ${s}`,direction:"input",index:s,color:r.color}))}:i);return{nodes:new Map(n.map(i=>[i.id,i])),connections:e.graph.connections,annotations:new Map((e.graph.annotations||[]).map(i=>[i.id,i])),events:new Map((e.graph.events||[]).map(i=>[i.id,i]))}}function Rs(t,e){t.length!==0&&Gi.update(n=>{const i=new Map(n),r=(s,a)=>{if(a.length===0)return s;const[o,...l]=a,c=s.get(o);if(!c||c.type!==_n.SUBSYSTEM)return s;const u=new Map(s);if(l.length===0){const f=e(c.graph||{nodes:[],connections:[]});u.set(o,{...c,graph:f})}else{const f=new Map((c.graph?.nodes||[]).map(d=>[d.id,d])),h=r(f,l);u.set(o,{...c,graph:{nodes:Array.from(h.values()),connections:c.graph?.connections||[],annotations:c.graph?.annotations,events:c.graph?.events}})}return u};return r(i,t)})}function M1(t,e){const n=Ze(Bn);n.length===0?Gi.update(t):Rs(n,i=>({...i,nodes:e(i.nodes)}))}function Fc(t,e){M1(n=>{const i=n.get(t);if(i){const r=new Map(n);return r.set(t,e(i)),r}return n},n=>n.map(i=>i.id===t?e(i):i))}function BC(t){M1(e=>{const n=new Map(e);return n.set(t.id,t),n},e=>[...e,t])}function T1(t){const e=Ze(Bn);e.length===0?Jl.update(t):Rs(e,n=>({...n,connections:t(n.connections)}))}function op(t,e,n){const i=Ze(Bn);i.length===0?(Gi.update(t),Jl.update(n)):Rs(i,r=>({...r,nodes:e(r.nodes),connections:n(r.connections)}))}function lp(t,e){const n=Ze(Bn);n.length===0?Ru.update(t):Rs(n,i=>({...i,annotations:e(i.annotations||[])}))}function zC(){return Ze(Bn).length===0}const D1=Pa([Gi,Bn],()=>vr().nodes),qC=Pa([Gi,Jl,Bn],()=>vr().connections),jC=Pa([Gi,Ru,Bn],()=>vr().annotations),HC=Pa([Gi,Bn],()=>vr().events),UC=Pa(D1,t=>Array.from(t.values())),WC=Pa([D1,Er],([t,e])=>Array.from(e).map(n=>t.get(n)).filter(n=>n!==void 0)),VC=Pa([Gi,Bn],([t,e])=>{const n=[{id:"",name:"Root"}];let i=t;for(const r of e){const s=i.get(r);s&&s.type===_n.SUBSYSTEM&&(n.push({id:r,name:s.name}),s.graph&&(i=new Map(s.graph.nodes.map(a=>[a.id,a]))))}return n}),qr={DEFAULT:11,MIN:8,MAX:24,STEP:1};function GC(t){const e=nr(),n={id:e,position:t,content:"",width:200,height:100,fontSize:qr.DEFAULT};return lp(i=>{const r=new Map(i);return r.set(e,n),r},i=>[...i,n]),e}function T5(t,e){lp(n=>{const i=n.get(t);if(i){const r=new Map(n);return r.set(t,{...i,...e}),r}return n},n=>n.map(i=>i.id===t?{...i,...e}:i))}function XC(t,e){T5(t,{position:e})}function YC(t){lp(e=>{const n=new Map(e);return n.delete(t),n},e=>e.filter(n=>n.id!==t))}function KC(t){return vr().annotations.get(t)}const nh=an({top:100,right:20,bottom:20,left:70});function ZC(t){nh.set(t)}const D5=an(0);function rl(){D5.update(t=>t+1)}const O5=an(0),F5=an(0);function JC(){O5.update(t=>t+1)}function QC(){F5.update(t=>t+1)}const R5=an({x:0,y:0,id:0});function $C(t){R5.update(e=>({...t,id:e.id+1}))}const B5=an({nodeId:"",id:0});function e8(t){B5.update(e=>({nodeId:t,id:e.id+1}))}const z5=an(0);function md(){z5.update(t=>t+1)}const q5=an({x:0,y:0,id:0});function t8(t){q5.update(e=>({...t,id:e.id+1}))}const j5=an({nodeIds:[],addToSelection:!1,id:0});function io(t,e=!1){j5.update(n=>({nodeIds:t,addToSelection:e,id:n.id+1}))}const H5=an({annotationId:"",id:0});function n8(t){H5.update(e=>({annotationId:t,id:e.id+1}))}const U5=an({nodeId:"",position:{x:0,y:0},cursorScreen:null,id:0});function i8(t,e,n){U5.update(i=>({nodeId:t,position:e,cursorScreen:n??null,id:i.id+1}))}let Cm=null,Pm=null;function r8(t){Cm=t}function oo(t){return Cm?Cm(t):t}function s8(t){Pm=t}function Tv(){return Pm?Pm():!1}function a8(){const t=document.querySelector(".svelte-flow");if(!t)return{x:400,y:300};const e=t.getBoundingClientRect(),n={x:e.left+e.width/2,y:e.top+e.height/2};return oo(n)}function o8(t){Bn.update(e=>[...e,t]),Er.set(new Set),setTimeout(()=>rl(),0)}function l8(){Bn.update(t=>t.slice(0,-1)),Er.set(new Set),setTimeout(()=>rl(),0)}function c8(t){const e=Ze(Bn).length;t!==e&&(Bn.update(n=>n.slice(0,t)),Er.set(new Set),setTimeout(()=>rl(),0))}function u8(t){Bn.set(t),Er.set(new Set),setTimeout(()=>rl(),0)}function d8(){return Ze(Bn).length===0}function f8(){return Ze(Bn)}function Dv(t,e,n){return n.map((i,r)=>({id:`${t}-${e}-${r}`,nodeId:t,name:i.name,direction:e,index:r,color:i.color||Id.default}))}function W5(t,e){for(const n of t)if(n.type===_n.SUBSYSTEM&&n.graph){if(n.graph.nodes.some(s=>s.id===e))return n;const r=W5(n.graph.nodes,e);if(r)return r}return null}function V5(t,e,n){const i=n??nr(),r={...t,id:i,position:{...e},inputs:t.inputs.map((s,a)=>({...s,id:`${i}-input-${a}`,nodeId:i})),outputs:t.outputs.map((s,a)=>({...s,id:`${i}-output-${a}`,nodeId:i}))};return r.graph&&(r.graph=O1(r.graph)),r}function O1(t){const e=new Map,n=t.nodes.map(a=>{const o=nr();e.set(a.id,o);const l={...a,id:o,inputs:a.inputs.map((c,u)=>({...c,id:`${o}-input-${u}`,nodeId:o})),outputs:a.outputs.map((c,u)=>({...c,id:`${o}-output-${u}`,nodeId:o}))};return l.graph&&(l.graph=O1(l.graph)),l}),i=t.connections.map(a=>({...a,id:nr(),sourceNodeId:e.get(a.sourceNodeId)||a.sourceNodeId,targetNodeId:e.get(a.targetNodeId)||a.targetNodeId})),r=t.events?.map(a=>({...a,id:nr()})),s=t.annotations?.map(a=>({...a,id:nr()}));return{nodes:n,connections:i,events:r,annotations:s}}const Ov={input:t=>`in ${t}`,output:t=>`out ${t}`},h8=/-input-(\d+)$/,p8=/-output-(\d+)$/,Eu={input:(t,e)=>`${t}-input-${e}`,output:(t,e)=>`${t}-output-${e}`,parseIndex:(t,e)=>{const n=e==="input"?h8:p8,i=t.match(n);return i?parseInt(i[1],10):null},parseConnection:(t,e)=>({sourceIndex:Eu.parseIndex(t,"output"),targetIndex:Eu.parseIndex(e,"input")})};function F1(t){return{portsKey:t==="input"?"inputs":"outputs",oppositeKey:t==="input"?"outputs":"inputs",minKey:t==="input"?"minInputs":"minOutputs",maxKey:t==="input"?"maxInputs":"maxOutputs",connectionKey:t==="input"?"targetNodeId":"sourceNodeId",connectionIndexKey:t==="input"?"targetPortIndex":"sourcePortIndex",defaultName:t==="input"?"in":"out"}}function G5(t,e,n){const i=r=>{const s=r.get(e);if(!s)return r;const a=new Map(r);return a.set(e,n(s)),a};t.length===0?Gi.update(i):Rs(t,r=>({...r,nodes:Array.from(i(new Map(r.nodes.map(s=>[s.id,s]))).values())}))}function R1(t,e,n=!1){const r=vr().nodes.get(t);if(!r)return!1;const s=F1(e),a=Ze(Bn);if(r.type===_n.INTERFACE&&a.length>0){const d=a[a.length-1],y=a.slice(0,-1),m=s.oppositeKey,x=e==="input"?"output":"input";return G5(y,d,w=>{const S=w[m],A=S.length;return{...w,[m]:[...S,{id:Eu[x](d,A),nodeId:d,name:Ov[x](A),direction:x,index:A,color:Id.default}]}}),!0}const o=Ri.get(r.type),l=o?.ports[s.maxKey],c=r[s.portsKey];if(l!=null&&c.length>=l)return!1;const u=c.length,f=o?.ports[s.portsKey]?.[u],h={id:Eu[e](t,u),nodeId:t,name:f?.name||Ov[e](u),direction:e,index:u,color:f?.color||Id.default};return Fc(t,d=>({...d,[s.portsKey]:[...d[s.portsKey],h]})),!n&&e==="input"&&o?.ports.syncPorts&&R1(t,"output",!0),!0}function B1(t,e,n=!1){const r=vr().nodes.get(t);if(!r)return!1;const s=F1(e),a=Ri.get(r.type),o=a?.ports[s.minKey]??1,l=r[s.portsKey];if(l.length<=o)return!1;const c=Ze(Bn);if(r.type===_n.INTERFACE&&c.length>0){const f=c[c.length-1],h=c.slice(0,-1),d=s.oppositeKey;G5(h,f,y=>{const m=y[d];return m.length===0?y:{...y,[d]:m.slice(0,-1)}})}const u=l.length-1;return op(f=>{const h=f.get(t);if(!h)return f;const d=new Map(f);return d.set(t,{...h,[s.portsKey]:h[s.portsKey].slice(0,-1)}),d},f=>f.map(h=>h.id===t?{...h,[s.portsKey]:h[s.portsKey].slice(0,-1)}:h),f=>f.filter(h=>{const d=h[s.connectionKey],y=h[s.connectionIndexKey];return!(d===t&&y>=u)})),!n&&e==="input"&&a?.ports.syncPorts&&B1(t,"output",!0),!0}function g8(t){return R1(t,"input")}function m8(t){return R1(t,"output")}function v8(t){return B1(t,"input")}function y8(t){return B1(t,"output")}function b8(t){if(t==null||t==="None"||t==="")return null;const e=String(t).trim();if(!e.startsWith("[")||!e.endsWith("]"))return null;try{const n=e.replace(/'/g,'"'),i=JSON.parse(n);if(Array.isArray(i)&&i.every(r=>typeof r=="string"))return i}catch{}return null}function w8(t,e,n,i){const s=vr().nodes.get(t);if(!s)return;const a=i?i(e):b8(e),o=F1(n),l=s[o.portsKey],c=l.map((f,h)=>{const d=a&&h<a.length?a[h]:`${o.defaultName} ${h}`;return f.name===d?f:{...f,name:d}});c.some((f,h)=>f.name!==l[h].name)&&Fc(t,f=>({...f,[o.portsKey]:c}))}function x8(t,e,n){const i=Ri.get(t);if(!i)return console.error(`Unknown node type: ${t}`),null;const r=nr(),s={id:r,type:t,name:n||i.name,position:e,inputs:Dv(r,"input",i.ports.inputs),outputs:Dv(r,"output",i.ports.outputs),params:{}};if(t===_n.SUBSYSTEM){const o={id:nr(),type:_n.INTERFACE,name:s.name,position:{x:100,y:100},inputs:[],outputs:[],params:{}};s.graph={nodes:[o],connections:[]}}return BC(s),s}function _8(t){const n=vr().nodes.get(t);if(n){if(n.type===_n.INTERFACE){console.warn("Interface blocks cannot be deleted");return}op(i=>{const r=new Map(i);return r.delete(t),r},i=>i.filter(r=>r.id!==t),i=>i.filter(r=>r.sourceNodeId!==t&&r.targetNodeId!==t)),Er.update(i=>{const r=new Set(i);return r.delete(t),r})}}function S8(t,e){Fc(t,n=>({...n,position:{...e}}))}function k8(t,e){const i=vr().nodes.get(t);if(!i)return;const r=Ze(Bn);if(i.type===_n.INTERFACE&&r.length>0){const s=r.slice(0,-1),a=r[r.length-1];s.length===0?Gi.update(o=>{const l=o.get(a);if(l){const c=new Map(o);return c.set(a,{...l,name:e}),c}return o}):Rs(s,o=>({...o,nodes:o.nodes.map(l=>l.id===a?{...l,name:e}:l)}));return}Fc(t,s=>({...s,name:e}))}function A8(t,e){const i=vr().nodes.get(t);if(!i)return;const r=Ze(Bn);if(i.type===_n.INTERFACE&&r.length>0){const s=r.slice(0,-1),a=r[r.length-1];s.length===0?Gi.update(o=>{const l=o.get(a);if(l){const c=new Map(o);return c.set(a,{...l,color:e}),c}return o}):Rs(s,o=>({...o,nodes:o.nodes.map(l=>l.id===a?{...l,color:e}:l)}));return}Fc(t,s=>({...s,color:e}))}function N8(t,e){Fc(t,i=>({...i,params:{...i.params,...e}}));const n=vr().nodes.get(t);if(n)for(const i of EC(n.type))i.param in e&&w8(t,e[i.param],i.direction,i.parser)}function C8(t,e){Fc(t,n=>({...n,...e}))}function P8(t){return vr().nodes.get(t)}function E8(){const t=[],e=n=>{for(const i of n)t.push(i),i.graph&&e(i.graph.nodes)};return e(Array.from(Ze(Gi).values())),t}function I8(){const t=Ze(Er);if(t.size===0)return[];const e=vr(),n=[],i=[],r={x:50,y:50},s=new Map,a=[],o=[];t.forEach(f=>{const h=e.annotations.get(f);if(h){const x=nr(),w={...h,id:x,position:{x:h.position.x+r.x,y:h.position.y+r.y}};o.push(w),i.push(x);return}const d=e.nodes.get(f);if(!d||d.type===_n.INTERFACE)return;const y=nr();s.set(f,y);const m={id:y,type:d.type,name:d.name,position:{x:d.position.x+r.x,y:d.position.y+r.y},inputs:d.inputs.map((x,w)=>({...x,id:`${y}-input-${w}`,nodeId:y})),outputs:d.outputs.map((x,w)=>({...x,id:`${y}-output-${w}`,nodeId:y})),params:JSON.parse(JSON.stringify(d.params)),pinnedParams:d.pinnedParams?[...d.pinnedParams]:void 0,color:d.color};if(d.graph){const x=JSON.parse(JSON.stringify(d.graph));m.graph=O1(x)}a.push(m),n.push(y)});const l=e.connections,c=[];for(const f of l){const h=s.get(f.sourceNodeId),d=s.get(f.targetNodeId);h&&d&&c.push({id:nr(),sourceNodeId:h,sourcePortIndex:f.sourcePortIndex,targetNodeId:d,targetPortIndex:f.targetPortIndex})}(a.length>0||c.length>0)&&op(f=>{const h=new Map(f);for(const d of a)h.set(d.id,d);return h},f=>[...f,...a],f=>[...f,...c]),o.length>0&&lp(f=>{const h=new Map(f);for(const d of o)h.set(d.id,d);return h},f=>[...f,...o]);const u=[...n,...i];return u.length>0&&io(u,!1),u}function L8(t){const e=Ze(Er);if(e.size===0)return;const n=i=>({...i,position:{x:i.position.x+t.x,y:i.position.y+t.y}});M1(i=>{const r=new Map(i);return e.forEach(s=>{const a=r.get(s);a&&r.set(s,n(a))}),r},i=>i.map(r=>e.has(r.id)?n(r):r))}function M8(t,e){if(t.length===0)return[];const n=t.map(i=>i.id);return op(i=>{const r=new Map(i);for(const s of t)r.set(s.id,s);return r},i=>[...i,...t],i=>[...i,...e]),io(n,!1),n}function T8(t,e,n,i){const r=vr(),s=r.nodes.get(t),a=r.nodes.get(n);if(!s||!a)return console.error("Invalid node IDs for connection"),null;if(e>=s.outputs.length||i>=a.inputs.length)return console.error("Invalid port indices for connection"),null;if(r.connections.some(u=>u.targetNodeId===n&&u.targetPortIndex===i))return console.warn("Target port already has a connection"),null;const c={id:nr(),sourceNodeId:t,sourcePortIndex:e,targetNodeId:n,targetPortIndex:i};return T1(u=>[...u,c]),c}function D8(t){T1(e=>e.filter(n=>n.id!==t))}function O8(){const t=[];for(const n of Ze(Jl))t.push({connection:n});const e=(n,i)=>{const r=n instanceof Map?Array.from(n.values()):n;for(const s of r)if(s.graph){for(const a of s.graph.connections)t.push({connection:a,subsystemId:s.id});e(s.graph.nodes,s.id)}};return e(Ze(Gi)),t}function F8(t,e){T1(n=>n.map(i=>i.id===t?{...i,waypoints:e}:i))}function R8(t){const e=Ze(Bn);return e.length===0?!1:(Rs(e,n=>({...n,events:[...n.events||[],t]})),!0)}function B8(t){const e=Ze(Bn);e.length!==0&&Rs(e,n=>({...n,events:(n.events||[]).filter(i=>i.id!==t)}))}function z8(t,e){const n=Ze(Bn);n.length!==0&&Rs(n,i=>({...i,events:(i.events||[]).map(r=>r.id===t?{...r,position:{...e}}:r)}))}function q8(t,e){const n=Ze(Bn);n.length!==0&&Rs(n,i=>({...i,events:(i.events||[]).map(r=>r.id===t?{...r,name:e}:r)}))}function j8(t,e){const n=Ze(Bn);n.length!==0&&Rs(n,i=>({...i,events:(i.events||[]).map(r=>r.id===t?{...r,params:{...r.params,...e}}:r)}))}function H8(t,e){const n=Ze(Bn);n.length!==0&&Rs(n,i=>({...i,events:(i.events||[]).map(r=>r.id===t?{...r,color:e}:r)}))}function U8(t){return vr().events.get(t)}function W8(){return Array.from(vr().events.values())}const V8=[{type:"pathsim.events.ZeroCrossing",name:"ZeroCrossing",eventClass:"ZeroCrossing",description:"Subclass of base 'Event' that triggers if the event function crosses zero.",docstringHtml:`<p>Subclass of base 'Event' that triggers if the event function crosses zero.
This is a bidirectional zero-crossing detector.</p>
<p>Monitors system state by evaluating an event function (func_evt) with scalar output and
testing for zero crossings (sign changes).</p>
<pre class="code literal-block">
func_evt(time) -&gt; event?
</pre>
<p>If an event is detected, some action (func_act) is performed on the system state.</p>
<pre class="code literal-block">
func_evt(time) == 0 -&gt; event -&gt; func_act(time)
</pre>
<div class="section" id="example">
<h3>Example</h3>
<p>Initialize a zero-crossing event handler like this:</p>
<pre class="code python literal-block">
# define the event function
def evt(t):
    # here we have a zero-crossing at 't==10'
    return t - 10

# define the action function (callback)
def act(t):
    # do something at event resolution
    pass

# initialize the event manager
E = ZeroCrossing(
    func_evt=evt,  # the event function
    func_act=act   # the action function
    )
</pre>
</div>
<div class="section" id="parameters">
<h3>Parameters</h3>
<dl class="docutils">
<dt>func_evt <span class="classifier-delimiter">:</span> <span class="classifier">callable</span></dt>
<dd>event function, where zeros are events</dd>
<dt>func_act <span class="classifier-delimiter">:</span> <span class="classifier">callable</span></dt>
<dd>action function for event resolution</dd>
<dt>tolerance <span class="classifier-delimiter">:</span> <span class="classifier">float</span></dt>
<dd>tolerance to check if detection is close to actual event</dd>
</dl>
</div>
`,params:[{name:"func_evt",type:"callable",default:"None",description:"event function, where zeros are events"},{name:"func_act",type:"callable",default:"None",description:"action function for event resolution"},{name:"tolerance",type:"number",default:"0.0001",description:"tolerance to check if detection is close to actual event"}]},{type:"pathsim.events.ZeroCrossingUp",name:"ZeroCrossingUp",eventClass:"ZeroCrossingUp",description:"Modification of standard 'ZeroCrossing' event where events are only triggered",docstringHtml:`<p>Modification of standard 'ZeroCrossing' event where events are only triggered
if the event function changes sign from negative to positive (up). Also called
unidirectional zero-crossing.</p>
`,params:[{name:"func_evt",type:"callable",default:"None",description:""},{name:"func_act",type:"callable",default:"None",description:""},{name:"tolerance",type:"number",default:"0.0001",description:""}]},{type:"pathsim.events.ZeroCrossingDown",name:"ZeroCrossingDown",eventClass:"ZeroCrossingDown",description:"Modification of standard 'ZeroCrossing' event where events are only triggered",docstringHtml:`<p>Modification of standard 'ZeroCrossing' event where events are only triggered
if the event function changes sign from positive to negative (down). Also called
unidirectional zero-crossing.</p>
`,params:[{name:"func_evt",type:"callable",default:"None",description:""},{name:"func_act",type:"callable",default:"None",description:""},{name:"tolerance",type:"number",default:"0.0001",description:""}]},{type:"pathsim.events.Schedule",name:"Schedule",eventClass:"Schedule",description:"Subclass of base 'Event' that triggers dependent on the evaluation time.",docstringHtml:`<p>Subclass of base 'Event' that triggers dependent on the evaluation time.</p>
<p>Monitors time in every timestep and triggers periodically (period). This event
does not have an event function as the event condition only depends on time.</p>
<pre class="code literal-block">
time == next_schedule_time -&gt; event
</pre>
<div class="section" id="example">
<h3>Example</h3>
<p>Initialize a scheduled event handler like this:</p>
<pre class="code python literal-block">
#define the action function (callback)
def act(t):
    #do something at event resolution
    pass

#initialize the event manager
E = Schedule(
    t_start=0,    #starting at t=0
    t_end=None,   #never ending
    t_period=3,   #triggering every 3 time units
    func_act=act  #resulting in a callback
    )
</pre>
</div>
<div class="section" id="parameters">
<h3>Parameters</h3>
<dl class="docutils">
<dt>t_start <span class="classifier-delimiter">:</span> <span class="classifier">float</span></dt>
<dd>starting time for schedule</dd>
<dt>t_end <span class="classifier-delimiter">:</span> <span class="classifier">float</span></dt>
<dd>termination time for schedule</dd>
<dt>t_period <span class="classifier-delimiter">:</span> <span class="classifier">float</span></dt>
<dd>time period of schedule, when events are triggered</dd>
<dt>func_act <span class="classifier-delimiter">:</span> <span class="classifier">callable</span></dt>
<dd>action function for event resolution</dd>
<dt>tolerance <span class="classifier-delimiter">:</span> <span class="classifier">float</span></dt>
<dd>tolerance to check if detection is close to actual event</dd>
</dl>
</div>
`,params:[{name:"t_start",type:"number",default:"0",description:"starting time for schedule"},{name:"t_end",type:"number",default:"None",description:"termination time for schedule"},{name:"t_period",type:"number",default:"1",description:"time period of schedule, when events are triggered"},{name:"func_act",type:"callable",default:"None",description:"action function for event resolution"},{name:"tolerance",type:"number",default:"1e-16",description:"tolerance to check if detection is close to actual event"}]},{type:"pathsim.events.ScheduleList",name:"ScheduleList",eventClass:"ScheduleList",description:"Subclass of base 'Schedule' that triggers dependent on the evaluation time.",docstringHtml:`<p>Subclass of base 'Schedule' that triggers dependent on the evaluation time.</p>
<p>Monitors time in every timestep and triggers at the next event time from the
time list. This event does not have an event function as the event condition
only depends on time.</p>
<pre class="code literal-block">
time == next_scheduled_time -&gt; event
</pre>
<div class="section" id="example">
<h3>Example</h3>
<p>Initialize a scheduled event handler like this:</p>
<pre class="code python literal-block">
#define the action function (callback)
def act(t):
    #do something at event resolution
    pass

#initialize the event manager
E = ScheduleList(
    times_evt=[1, 5, 12, 300],  #event times where to trigger
    func_act=act                #resulting in a callback
    )
</pre>
</div>
<div class="section" id="parameters">
<h3>Parameters</h3>
<dl class="docutils">
<dt>times_evt <span class="classifier-delimiter">:</span> <span class="classifier">list[float]</span></dt>
<dd>list of event times in ascending order</dd>
<dt>func_act <span class="classifier-delimiter">:</span> <span class="classifier">callable</span></dt>
<dd>action function for event resolution</dd>
<dt>tolerance <span class="classifier-delimiter">:</span> <span class="classifier">float</span></dt>
<dd>tolerance to check if detection is close to actual event</dd>
</dl>
</div>
`,params:[{name:"times_evt",type:"array",default:"None",description:"list of event times in ascending order"},{name:"func_act",type:"callable",default:"None",description:"action function for event resolution"},{name:"tolerance",type:"number",default:"1e-16",description:"tolerance to check if detection is close to actual event"}]},{type:"pathsim.events.Condition",name:"Condition",eventClass:"Condition",description:"Subclass of base 'Event' that triggers if the event function evaluates to 'True',",docstringHtml:`<p>Subclass of base 'Event' that triggers if the event function evaluates to 'True',
i.e. the condition is satisfied.</p>
<p>Monitors system state by evaluating an event function (func_evt) with boolean output.
The event is considered detected when the event function evaluates to 'True' for the
first time. Subsequent evaluations to 'True' are not considered unless the event is reset.</p>
<pre class="code literal-block">
func_evt(time) -&gt; event?
</pre>
<p>If an event is detected, some action (func_act) is performed on the system state.</p>
<pre class="code literal-block">
func_evt(time) == True -&gt; event -&gt; func_act(time)
</pre>
<div class="section" id="note">
<h3>Note</h3>
<p>Condition event functions evaluate to boolean and are therefore not smooth.
Therefore uses bisection method for event location instead of secant method.</p>
</div>
<div class="section" id="example">
<h3>Example</h3>
<p>Initialize a conditional event handler like this:</p>
<pre class="code python literal-block">
#define the event function
def evt(t):
    return t &gt; 10

#define the action function (callback)
def act(t):
    #do something at event resolution
    pass

#initialize the event manager
E = Condition(
    func_evt=evt,  #the event function
    func_act=act   #the action function
    )
</pre>
</div>
`,params:[{name:"func_evt",type:"callable",default:"None",description:""},{name:"func_act",type:"callable",default:"None",description:""},{name:"tolerance",type:"number",default:"0.0001",description:""}]}],G8=V8;class X8{events=new Map;constructor(){for(const e of G8)this.register(e)}register(e){this.events.set(e.type,e)}get(e){return this.events.get(e)}getAll(){return Array.from(this.events.values())}has(e){return this.events.has(e)}}const ra=new X8,tr=an(new Map),Ks=an(new Set);function gg(t){Ks.set(t)}const Y8=Pa(tr,t=>Array.from(t.values())),K8=Pa([tr,Ks],([t,e])=>Array.from(e).map(n=>t.get(n)).filter(n=>n!==void 0)),vn={events:{subscribe:tr.subscribe},eventsArray:{subscribe:Y8.subscribe},selectedEventIds:{subscribe:Ks.subscribe},selectedEvents:{subscribe:K8.subscribe},addEvent(t,e,n){const i=ra.get(t);if(!i)return console.error(`Unknown event type: ${t}`),null;const r=nr(),s={id:r,type:t,name:n||i.name,position:e,params:{}};return tr.update(a=>{const o=new Map(a);return o.set(r,s),o}),s},removeEvent(t){tr.update(e=>{const n=new Map(e);return n.delete(t),n}),Ks.update(e=>{const n=new Set(e);return n.delete(t),n})},updateEventPosition(t,e){tr.update(n=>{const i=n.get(t);if(i){const r=new Map(n);return r.set(t,{...i,position:{...e}}),r}return n})},updateEventName(t,e){tr.update(n=>{const i=n.get(t);if(i){const r=new Map(n);return r.set(t,{...i,name:e}),r}return n})},updateEventParams(t,e){tr.update(n=>{const i=n.get(t);if(i){const r=new Map(n);return r.set(t,{...i,params:{...i.params,...e}}),r}return n})},updateEventColor(t,e){tr.update(n=>{const i=n.get(t);if(i){const r=new Map(n);return r.set(t,{...i,color:e}),r}return n})},selectEvent(t,e=!1){if(e){const n=Ze(Ks);io([...n,t],!0)}else io([t],!1)},deselectEvent(t){const n=[...Ze(Ks)].filter(i=>i!==t);io(n,!1)},clearSelection(){md()},hasSelection(){return Ze(Ks).size>0},clear(){tr.set(new Map),Ks.set(new Set)},getEvent(t){return Ze(tr).get(t)},getAll(){return Array.from(Ze(tr).values())},selectAll(){const t=Array.from(Ze(tr).keys());Ks.set(new Set(t))},duplicateSelected(){const t=Ze(Ks);if(t.size===0)return[];const e=Ze(tr),n=[],i={x:50,y:50};return t.forEach(r=>{const s=e.get(r);if(!s)return;const a=nr(),o={id:a,type:s.type,name:s.name,position:{x:s.position.x+i.x,y:s.position.y+i.y},params:JSON.parse(JSON.stringify(s.params)),color:s.color};tr.update(l=>{const c=new Map(l);return c.set(a,o),c}),n.push(a)}),n.length>0&&io(n,!1),n},nudgeSelectedEvents(t){const e=Ze(Ks);e.size!==0&&tr.update(n=>{const i=new Map(n);return e.forEach(r=>{const s=i.get(r);s&&i.set(r,{...s,position:{x:s.position.x+t.x,y:s.position.y+t.y}})}),i})},toJSON(){return Array.from(Ze(tr).values())},fromJSON(t){!t||!Array.isArray(t)?tr.set(new Map):tr.set(new Map(t.map(e=>[e.id,e]))),Ks.set(new Set)}};function Z8(t,e=!1){if(e){const n=Ze(Er);io([...n,t],!0)}else io([t],!1)}function J8(t){const n=[...Ze(Er)].filter(i=>i!==t);io(n,!1)}function Q8(){md()}function $8(){return Ze(Er).size>0}function eP(){const t=vr(),e=Array.from(t.nodes.keys()),n=zC()?Array.from(Ze(vn.events).keys()):Array.from(t.events.keys());io([...e,...n],!1)}function tP(){Gi.set(new Map),Jl.set([]),Ru.set(new Map),Bn.set([]),Er.set(new Set)}function nP(){return{nodes:Array.from(Ze(Gi).values()),connections:Ze(Jl),annotations:Array.from(Ze(Ru).values())}}function iP(t,e,n){!t||!Array.isArray(t)?Gi.set(new Map):Gi.set(new Map(t.map(i=>[i.id,i]))),Jl.set(e||[]),Ru.set(new Map((n||[]).map(i=>[i.id,i]))),Bn.set([]),Er.set(new Set)}function rP(){const t=[],e=(n,i,r)=>{for(const s of n)s.type!==_n.INTERFACE&&(t.push({node:s,path:[...i],pathNames:[...r],depth:i.length}),s.graph&&e(s.graph.nodes,[...i,s.id],[...r,s.name]))};return e(Array.from(Ze(Gi).values()),[],["Root"]),t}const Re={nodes:{subscribe:D1.subscribe},connections:{subscribe:qC.subscribe},annotations:{subscribe:jC.subscribe},subsystemEvents:{subscribe:HC.subscribe},selectedNodeIds:{subscribe:Er.subscribe},nodesArray:{subscribe:UC.subscribe},selectedNodes:{subscribe:WC.subscribe},currentPath:{subscribe:Bn.subscribe},breadcrumbs:{subscribe:VC.subscribe},drillDown:o8,drillUp:l8,navigateTo:c8,navigateToPath:u8,isAtRoot:d8,getCurrentPath:f8,addNode:x8,removeNode:_8,updateNodePosition:S8,updateNodeName:k8,updateNodeColor:A8,updateNodeParams:N8,updateNode:C8,getNode:P8,getAllNodes:E8,duplicateSelected:I8,nudgeSelectedNodes:L8,pasteNodes:M8,addConnection:T8,removeConnection:D8,getAllConnections:O8,updateConnectionWaypoints:F8,addInputPort:g8,removeInputPort:v8,addOutputPort:m8,removeOutputPort:y8,addAnnotation:GC,updateAnnotation:T5,updateAnnotationPosition:XC,removeAnnotation:YC,getAnnotation:KC,addSubsystemEvent:R8,removeSubsystemEvent:B8,updateSubsystemEventPosition:z8,updateSubsystemEventName:q8,updateSubsystemEventParams:j8,updateSubsystemEventColor:H8,getSubsystemEvent:U8,getSubsystemEvents:W8,selectNode:Z8,deselectNode:J8,clearSelection:Q8,hasSelection:$8,selectAll:eP,clear:tP,toJSON:nP,fromJSON:iP,getAllNodesWithPaths:rP},sP=50;let sl=[],Ac=[],sa=!1,pu=null,Em=!1,ta=0,el=null;const X5=an({undoStack:[],redoStack:[],canUndo:!1,canRedo:!1});function cp(){X5.set({undoStack:sl,redoStack:Ac,canUndo:sl.length>0,canRedo:Ac.length>0})}function Ud(){return{graph:Re.toJSON(),events:vn.toJSON()}}function z1(t){sl.push(t),sl.length>sP&&sl.shift(),Ac=[],cp()}function Y5(t){Em=!0;try{Re.fromJSON(t.graph.nodes,t.graph.connections,t.graph.annotations),vn.fromJSON(t.events)}finally{queueMicrotask(()=>{Em=!1})}}function aP(){return Em}function oP(t){if(sa)return t();const e=ta===0;e&&(el=Ud()),ta++;try{const n=t();return e&&el&&z1(el),n}catch(n){throw n}finally{ta--,ta===0&&(el=null)}}async function lP(t){if(sa)return t();const e=ta===0;e&&(el=Ud()),ta++;try{const n=await t();return e&&el&&z1(el),n}catch(n){throw n}finally{ta--,ta===0&&(el=null)}}function cP(){return ta>0||sa}function uP(){sa||(sa=!0,pu=Ud())}function dP(){sa&&(sa=!1,pu&&(z1(pu),pu=null))}function fP(){sa=!1,pu=null}function hP(){if(sa||ta>0||sl.length===0)return!1;const t=Ud(),e=sl.pop();return Ac.push(t),Y5(e),cp(),!0}function pP(){if(sa||ta>0||Ac.length===0)return!1;const t=Ud(),e=Ac.pop();return sl.push(t),Y5(e),cp(),!0}function gP(){sl=[],Ac=[],sa=!1,pu=null,ta=0,el=null,cp()}function mP(){return sa}const It={subscribe:X5.subscribe,mutate:oP,mutateAsync:lP,isInMutation:cP,beginDrag:uP,endDrag:dP,cancelDrag:fP,undo:hP,redo:pP,clear:gP,isInDrag:mP,isRestoringState:aP},mg=an(!1),ih={subscribe:mg.subscribe,toggle(){mg.update(t=>!t)},set(t){mg.set(t)}},K5="pathview-portLabels";function vP(){return localStorage.getItem(K5)==="true"}const ad=an(vP());ad.subscribe(t=>{localStorage.setItem(K5,String(t))});const q1={subscribe:ad.subscribe,toggle(){ad.update(t=>!t)},set(t){ad.set(t)},get(){return Ze(ad)}},od=an(null),Im=an(null),j1=an({text:"",x:0,y:0,visible:!1,position:"bottom"});let rh=null,sh=null;function Lm(t,e,n="bottom",i,r){sh&&(clearTimeout(sh),sh=null),rh=setTimeout(()=>{const s=e.getBoundingClientRect(),a=r??240,o=28,l=8,c=8;let u=n,f,h;switch(n==="bottom"&&s.bottom+l+o>window.innerHeight-c?u="top":n==="top"&&s.top-l-o<c?u="bottom":n==="right"&&s.right+l+a>window.innerWidth-c?u="left":n==="left"&&s.left-l-a<c&&(u="right"),u){case"left":f=s.left-l,h=s.top+s.height/2;break;case"right":f=s.right+l,h=s.top+s.height/2;break;case"top":f=s.left+s.width/2,h=s.top-l;break;default:f=s.left+s.width/2,h=s.bottom+l;break}if(u==="bottom"||u==="top"){const d=a/2;f-d<c?f=c+d:f+d>window.innerWidth-c&&(f=window.innerWidth-c-d)}if(u==="left"||u==="right"){const d=o/2;h-d<c?h=c+d:h+d>window.innerHeight-c&&(h=window.innerHeight-c-d)}j1.set({text:t,shortcut:i,maxWidth:r,x:f,y:h,visible:!0,position:u})},50)}function Th(){rh&&(clearTimeout(rh),rh=null),sh=setTimeout(()=>{j1.update(t=>({...t,visible:!1}))},50)}function Qt(t,e){if(typeof window>"u")return{destroy:()=>{}};let n=typeof e=="string"?e:e.text,i=typeof e=="string"?void 0:e.shortcut,r=typeof e=="string"?void 0:e.maxWidth,s=typeof e=="string"?"bottom":e.position??"bottom";function a(){n&&Lm(n,t,s,i,r)}function o(){Th()}return t.addEventListener("mouseenter",a),t.addEventListener("mouseleave",o),{update(l){n=typeof l=="string"?l:l.text,i=typeof l=="string"?void 0:l.shortcut,r=typeof l=="string"?void 0:l.maxWidth,s=typeof l=="string"?"bottom":l.position??"bottom"},destroy(){t.removeEventListener("mouseenter",a),t.removeEventListener("mouseleave",o),Th()}}}var yP=Le('<span class="shortcut svelte-11extwn"> </span>'),bP=Le('<div><span class="text"> </span> <!></div>');function wP(t,e){Mt(e,!0);let n=Fe(Rn({text:"",x:0,y:0,visible:!1,position:"bottom"}));j1.subscribe(a=>{$(n,a,!0)});var i=Je(),r=He(i);{var s=a=>{var o=bP(),l=ne(o),c=ne(l,!0);Q(l);var u=we(l,2);{var f=h=>{var d=yP(),y=ne(d,!0);Q(d),Ae(()=>Ht(y,p(n).shortcut)),j(h,d)};Se(u,h=>{p(n).shortcut&&h(f)})}Q(o),Ae(()=>{Xt(o,1,`tooltip tooltip-${p(n).position??""}`,"svelte-11extwn"),Nn(o,`left: ${p(n).x??""}px; top: ${p(n).y??""}px;${p(n).maxWidth?` max-width: ${p(n).maxWidth}px;`:""}`),Ht(c,p(n).text)}),j(a,o)};Se(r,a=>{p(n).visible&&a(s)})}j(t,i),Tt()}const Fv={blurOnEscape:!0,blurOnEnter:!1};function Zs(t,e={}){const n={...Fv,...e};function i(r){const s=r;s.key==="Escape"&&n.blurOnEscape&&(s.stopPropagation(),t.blur()),s.key==="Enter"&&n.blurOnEnter&&!(t instanceof HTMLTextAreaElement)&&(s.stopPropagation(),t.blur())}return t.addEventListener("keydown",i),t.setAttribute("autocomplete","off"),{update(r){Object.assign(n,Fv,r)},destroy(){t.removeEventListener("keydown",i)}}}let xP=0;const Rv=500;function _P(){const{subscribe:t,set:e,update:n}=an([]);let i=[],r=null;const s=50;function a(){if(i.length===0)return;const l=i;i=[],r=null,n(c=>{const u=[...c,...l];return u.length>Rv?u.slice(-Rv):u})}function o(){r===null&&(r=setTimeout(a,s))}return{subscribe:t,log(l,c="info"){i.push({id:xP++,timestamp:new Date,level:c,message:l}),o()},info(l){this.log(l,"info")},warn(l){this.log(l,"warning")},error(l){this.log(l,"error")},output(l){this.log(l,"output")},clear(){i=[],r&&(clearTimeout(r),r=null),e([])},getAll(){return Ze({subscribe:t})},flush(){r&&clearTimeout(r),a()}}}const yi=_P(),Tl=an({...ns}),rs={subscribe:Tl.subscribe,update(t){Tl.update(e=>({...e,...t}))},setDuration(t){Tl.update(e=>({...e,duration:t}))},setDt(t){Tl.update(e=>({...e,dt:t}))},setSolver(t){Tl.update(e=>({...e,solver:t}))},reset(){Tl.set({...ns})},get(){return Ze(Tl)},set(t){Tl.set(t)}},Bv=["Sources","Dynamic","Algebraic","Mixed","Recording","Subsystem"],Ts={SIMULATION:3e5,INIT:12e4,VALIDATION:3e4},Z5={STARTING_WORKER:"Starting worker...",STARTING_SIMULATION:"Starting simulation..."},Nc={READY:"Ready",COMPLETE:"Complete",STOPPED:"Stopped",RUNNING:"Running"},SP={SIMULATION_COMPLETED:"Simulation completed successfully"},J5={initialized:!1,loading:!1,error:null,progress:""},Qu=an(J5),Ui={subscribe:Qu.subscribe,get:()=>Ze(Qu),set:Qu.set,update:Qu.update,reset:()=>Qu.set(J5)};class kP{worker=null;messageId=0;pendingRequests=new Map;isInitializing=!1;streamState={id:null,onData:null,onDone:null,onError:null};stdoutCallback=null;stderrCallback=null;async init(){const e=this.getState();if(!(this.worker&&(e.initialized||e.loading))){this.worker&&(this.worker.terminate(),this.worker=null),Ui.update(n=>({...n,loading:!0,error:null,progress:Z5.STARTING_WORKER})),this.isInitializing=!0;try{this.worker=new Worker(new URL(""+new URL("../workers/worker-BQo9QMXK.js",import.meta.url).href,import.meta.url),{type:"module"}),this.worker.onmessage=n=>{this.handleResponse(n.data)},this.worker.onerror=n=>{Ui.update(i=>({...i,loading:!1,error:n.message||"Worker error"}))},this.sendRequest({type:"init"}),await new Promise((n,i)=>{const r=setTimeout(()=>i(new Error("Initialization timeout")),Ts.INIT),s=Ui.subscribe(a=>{a.initialized&&(clearTimeout(r),s(),n()),a.error&&(clearTimeout(r),s(),i(new Error(a.error)))})})}catch(n){throw Ui.update(i=>({...i,loading:!1,error:n instanceof Error?n.message:String(n)})),n}}}terminate(){for(const[,e]of this.pendingRequests)clearTimeout(e.timeoutId),e.reject(new Error("Backend terminated"));this.pendingRequests.clear(),this.streamState={id:null,onData:null,onDone:null,onError:null},this.worker&&(this.worker.terminate(),this.worker=null),Ui.reset()}getState(){return Ui.get()}subscribe(e){return Ui.subscribe(e)}isReady(){return this.getState().initialized}isLoading(){return this.getState().loading}getError(){return this.getState().error}async exec(e,n=Ts.SIMULATION){if(this.worker||await this.init(),!this.isReady())throw new Error("Backend not initialized");const i=this.generateId();return new Promise((r,s)=>{const a=setTimeout(()=>{this.pendingRequests.has(i)&&(this.pendingRequests.delete(i),s(new Error("Execution timeout")))},n);this.pendingRequests.set(i,{resolve:()=>r(),reject:s,timeoutId:a}),this.sendRequest({type:"exec",id:i,code:e})})}async evaluate(e,n=Ts.SIMULATION){if(this.worker||await this.init(),!this.isReady())throw new Error("Backend not initialized");const i=this.generateId();return new Promise((r,s)=>{const a=setTimeout(()=>{this.pendingRequests.has(i)&&(this.pendingRequests.delete(i),s(new Error("Evaluation timeout")))},n);this.pendingRequests.set(i,{resolve:o=>{if(o===void 0){s(new Error("No value returned from eval"));return}try{r(JSON.parse(o))}catch{s(new Error(`Failed to parse eval result: ${o}`))}},reject:s,timeoutId:a}),this.sendRequest({type:"eval",id:i,expr:e})})}startStreaming(e,n,i,r){if(!this.worker){r(new Error("Backend not initialized"));return}if(!this.isReady()){r(new Error("Backend not initialized"));return}this.streamState.id&&this.stopStreaming();const s=this.generateId();this.streamState={id:s,onData:n,onDone:i,onError:r},this.sendRequest({type:"stream-start",id:s,expr:e})}stopStreaming(){!this.worker||!this.streamState.id||this.sendRequest({type:"stream-stop"})}isStreaming(){return this.streamState.id!==null}execDuringStreaming(e){if(!this.worker||!this.streamState.id){console.warn("Cannot exec during streaming: no active stream");return}this.sendRequest({type:"stream-exec",code:e})}onStdout(e){this.stdoutCallback=e}onStderr(e){this.stderrCallback=e}generateId(){return`repl_${++this.messageId}`}sendRequest(e){if(!this.worker)throw new Error("Worker not initialized");this.worker.postMessage(e)}handleResponse(e){switch(e.type){case"ready":Ui.update(n=>({...n,initialized:!0,loading:!1,progress:Nc.READY})),this.isInitializing=!1;break;case"progress":Ui.update(n=>({...n,progress:e.value||""}));break;case"ok":if(e.id&&this.pendingRequests.has(e.id)){const n=this.pendingRequests.get(e.id);clearTimeout(n.timeoutId),n.resolve(void 0),this.pendingRequests.delete(e.id)}break;case"value":if(e.id&&this.pendingRequests.has(e.id)){const n=this.pendingRequests.get(e.id);clearTimeout(n.timeoutId),n.resolve(e.value),this.pendingRequests.delete(e.id)}break;case"error":this.handleError(e);break;case"stdout":e.value&&this.stdoutCallback&&this.stdoutCallback(e.value);break;case"stderr":e.value&&this.stderrCallback&&this.stderrCallback(e.value);break;case"stream-data":if(e.id===this.streamState.id&&this.streamState.onData&&e.value)try{this.streamState.onData(JSON.parse(e.value))}catch{}break;case"stream-done":e.id===this.streamState.id&&this.streamState.onDone&&(this.streamState.onDone(),this.streamState={id:null,onData:null,onDone:null,onError:null});break}}handleError(e){const{id:n,error:i,traceback:r}=e,s=r?`${i}
${r}`:i||"Unknown error";if(n&&this.pendingRequests.has(n)){const a=this.pendingRequests.get(n);clearTimeout(a.timeoutId),a.reject(new Error(s)),this.pendingRequests.delete(n)}n===this.streamState.id&&this.streamState.onError&&(this.streamState.onError(new Error(s)),this.streamState={id:null,onData:null,onDone:null,onError:null}),Ui.update(a=>({...a,error:i||"Unknown error"}))}}const AP="0.7.4",NP={pathsim:"0.17.0",pathsim_chem:"0.2rc3"},CP=[{pip:"pathsim==0.17.0",required:!0,pre:!0,import:"pathsim"},{pip:"pathsim-chem==0.2rc3",required:!1,pre:!0,import:"pathsim_chem"}],PP=5,EP="flask-session";class IP{host;sessionId;messageId=0;_isStreaming=!1;streamPollTimer=null;serverInitPromise=null;broadcastChannel=null;streamState={onData:null,onDone:null,onError:null};stdoutCallback=null;stderrCallback=null;constructor(e){this.host=e.replace(/\/$/,"");const n=typeof localStorage<"u"?localStorage.getItem("flask-session-id"):null;n?this.sessionId=n:(this.sessionId=crypto.randomUUID(),typeof localStorage<"u"&&localStorage.setItem("flask-session-id",this.sessionId)),typeof BroadcastChannel<"u"&&(this.broadcastChannel=new BroadcastChannel(EP),this.broadcastChannel.onmessage=i=>{i.data?.type==="session-terminated"&&(this.serverInitPromise=null,Ui.reset())})}async init(){const e=this.getState();if(!(e.initialized||e.loading)){Ui.update(n=>({...n,loading:!0,error:null,progress:"Connecting to Flask server..."}));try{const n=await fetch(`${this.host}/api/health`,{signal:AbortSignal.timeout(Ts.INIT)});if(!n.ok)throw new Error(`Server health check failed: ${n.status}`);Ui.update(i=>({...i,progress:"Initializing Python worker..."})),await this.postInit({updateProgress:!0}),this.serverInitPromise=Promise.resolve(),Ui.update(i=>({...i,initialized:!0,loading:!1,progress:Nc.READY}))}catch(n){const i=n instanceof Error?n.message:String(n);throw Ui.update(r=>({...r,loading:!1,error:`Flask backend error: ${i}`})),n}}}terminate(){this.stopStreaming(),this.streamPollTimer&&(clearTimeout(this.streamPollTimer),this.streamPollTimer=null),this._isStreaming=!1,this.streamState={onData:null,onDone:null,onError:null},fetch(`${this.host}/api/session`,{method:"DELETE",headers:{"X-Session-ID":this.sessionId}}).catch(()=>{}),this.broadcastChannel?.postMessage({type:"session-terminated"}),this.serverInitPromise=null,Ui.reset()}getState(){return Ui.get()}subscribe(e){return Ui.subscribe(e)}isReady(){return this.getState().initialized}isLoading(){return this.getState().loading}getError(){return this.getState().error}ensureServerInit(){return this.serverInitPromise?this.serverInitPromise:(this.serverInitPromise=this.postInit({updateProgress:!1}),this.serverInitPromise.catch(()=>{this.serverInitPromise=null}),this.serverInitPromise)}async exec(e,n=Ts.SIMULATION){await this.ensureServerInit();const i=this.generateId(),s=await(await fetch(`${this.host}/api/exec`,{method:"POST",headers:{"Content-Type":"application/json","X-Session-ID":this.sessionId},body:JSON.stringify({id:i,code:e}),signal:AbortSignal.timeout(n)})).json();if(s.stdout&&this.stdoutCallback&&this.stdoutCallback(s.stdout),s.stderr&&this.stderrCallback&&this.stderrCallback(s.stderr),s.type==="error"){this.handleWorkerError(s);const a=s.traceback?`${s.error}
${s.traceback}`:s.error;throw new Error(a)}}async evaluate(e,n=Ts.SIMULATION){await this.ensureServerInit();const i=this.generateId(),s=await(await fetch(`${this.host}/api/eval`,{method:"POST",headers:{"Content-Type":"application/json","X-Session-ID":this.sessionId},body:JSON.stringify({id:i,expr:e}),signal:AbortSignal.timeout(n)})).json();if(s.stdout&&this.stdoutCallback&&this.stdoutCallback(s.stdout),s.stderr&&this.stderrCallback&&this.stderrCallback(s.stderr),s.type==="error"){this.handleWorkerError(s);const a=s.traceback?`${s.error}
${s.traceback}`:s.error;throw new Error(a)}if(s.value===void 0)throw new Error("No value returned from eval");return JSON.parse(s.value)}startStreaming(e,n,i,r){this._isStreaming&&this.stopStreaming(),this.streamPollTimer&&(clearTimeout(this.streamPollTimer),this.streamPollTimer=null);const s=this.generateId();this._isStreaming=!0,this.streamState={onData:n,onDone:i,onError:r},this.ensureServerInit().then(()=>fetch(`${this.host}/api/stream/start`,{method:"POST",headers:{"Content-Type":"application/json","X-Session-ID":this.sessionId},body:JSON.stringify({id:s,expr:e})})).then(a=>a.json()).then(a=>{if(a.type==="error")throw new Error(a.error);this.pollStreamResults()}).catch(a=>{this._isStreaming=!1,r(a instanceof Error?a:new Error(String(a))),this.streamState={onData:null,onDone:null,onError:null}})}stopStreaming(){this._isStreaming&&fetch(`${this.host}/api/stream/stop`,{method:"POST",headers:{"Content-Type":"application/json","X-Session-ID":this.sessionId}}).catch(()=>{})}isStreaming(){return this._isStreaming}execDuringStreaming(e){if(!this._isStreaming){console.warn("Cannot exec during streaming: no active stream");return}fetch(`${this.host}/api/stream/exec`,{method:"POST",headers:{"Content-Type":"application/json","X-Session-ID":this.sessionId},body:JSON.stringify({code:e})}).catch(()=>{})}onStdout(e){this.stdoutCallback=e}onStderr(e){this.stderrCallback=e}generateId(){return`repl_${++this.messageId}`}async postInit(e){const i=await(await fetch(`${this.host}/api/init`,{method:"POST",headers:{"Content-Type":"application/json","X-Session-ID":this.sessionId},body:JSON.stringify({packages:CP}),signal:AbortSignal.timeout(Ts.INIT)})).json();if(i.type==="error")throw new Error(i.error);if(i.messages)for(const r of i.messages)r.type==="stdout"&&this.stdoutCallback&&this.stdoutCallback(r.value),r.type==="stderr"&&this.stderrCallback&&this.stderrCallback(r.value),r.type==="progress"&&e.updateProgress&&Ui.update(s=>({...s,progress:r.value}))}handleWorkerError(e){const n=e.errorType;(n==="worker-crashed"||n==="timeout")&&(this.serverInitPromise=null,this.stderrCallback&&this.stderrCallback(`Python worker crashed, restarting on next request...
`))}async pollStreamResults(){if(this._isStreaming)try{const n=await(await fetch(`${this.host}/api/stream/poll`,{method:"POST",headers:{"Content-Type":"application/json","X-Session-ID":this.sessionId}})).json();if(!Array.isArray(n?.messages))throw new Error(n?.error||"Invalid poll response");for(const i of n.messages)if(this.handleStreamMessage(i),!this._isStreaming)return;this._isStreaming&&(this.streamPollTimer=setTimeout(()=>this.pollStreamResults(),PP))}catch(e){this._isStreaming=!1,this.streamState.onError&&this.streamState.onError(e instanceof Error?e:new Error(String(e))),this.streamState={onData:null,onDone:null,onError:null}}}handleStreamMessage(e){switch(e.type){case"stream-data":{if(this.streamState.onData&&e.value)try{this.streamState.onData(JSON.parse(e.value))}catch{}break}case"stream-done":{this._isStreaming=!1,this.streamState.onDone&&this.streamState.onDone(),this.streamState={onData:null,onDone:null,onError:null};break}case"stdout":{this.stdoutCallback&&e.value&&this.stdoutCallback(e.value);break}case"stderr":{this.stderrCallback&&e.value&&this.stderrCallback(e.value);break}case"error":{if(this._isStreaming=!1,this.streamState.onError){const i=e.traceback?`${e.error}
${e.traceback}`:e.error||"Unknown error";this.streamState.onError(new Error(i))}this.streamState={onData:null,onDone:null,onError:null};break}}}}let mc=null,Q5="http://localhost:5000";function $5(t){Q5=t}function Wd(){return mc||(mc=ew("pyodide")),mc}function ew(t){switch(t){case"pyodide":return new kP;case"flask":return new IP(Q5);case"remote":throw new Error(`Backend type '${t}' not yet implemented`);default:throw new Error(`Unknown backend type: ${t}`)}}function tw(t){return mc&&mc.terminate(),mc=ew(t),mc}async function LP(){if(typeof window>"u")return;const t=new URLSearchParams(window.location.search),e=t.get("backend"),n=t.get("host");e==="flask"&&(n&&$5(n),tw("flask"),await up())}async function MP(){if(!(typeof window>"u"||new URLSearchParams(window.location.search).has("backend")))try{const e=await fetch("/api/health",{method:"GET",signal:AbortSignal.timeout(2e3)});e.ok&&(await e.json()).status==="ok"&&($5(window.location.origin),tw("flask"),await up())}catch{}}const Bu={subscribe:Ui.subscribe};async function up(){const t=Wd();t.onStdout(n=>yi.output(n)),t.onStderr(n=>yi.error(n));const e=t.subscribe(n=>{n.progress&&n.loading&&yi.info(n.progress)});try{yi.info("Initializing Python REPL..."),await t.init(),yi.info("Python REPL ready")}finally{e()}}async function mr(t,e){return Wd().exec(t,e)}async function TP(t,e){return Wd().evaluate(t,e)}function DP(t,e,n,i){Wd().startStreaming(t,e,n,i)}function nw(){Wd().stopStreaming()}const OP=`
import json
import gc
import numpy as np

def _to_json(obj):
    """Convert Python object to JSON-serializable form."""
    if hasattr(obj, 'tolist'):
        return obj.tolist()
    if isinstance(obj, (set, frozenset)):
        return list(obj)
    if isinstance(obj, bytes):
        return obj.decode('utf-8', errors='replace')
    return obj

def _step_streaming_gen():
    """Step the streaming generator and return result dict."""
    global _sim_streaming, _sim_gen
    if '_sim_gen' not in globals() or not _sim_streaming:
        return {'done': True, 'result': None}
    try:
        result = next(_sim_gen)
        return {'done': False, 'result': result}
    except StopIteration:
        _sim_streaming = False
        return {'done': True, 'result': None}

def _extract_scope_data(blocks, node_id_map, incremental=False):
    """Extract data from Scope blocks recursively.

    If incremental=True, only returns data accumulated since last read.
    """
    scope_data = {}

    def find_scopes(block_list):
        for block in block_list:
            block_name = type(block).__name__
            block_id = node_id_map.get(id(block), str(id(block)))

            if block_name == 'Scope':
                try:
                    data = block.read(incremental=incremental)
                    if data is not None:
                        time_arr, signals = data
                        labels = list(block.labels) if hasattr(block, 'labels') and block.labels else []
                        scope_data[block_id] = {
                            'time': time_arr.tolist() if hasattr(time_arr, 'tolist') else list(time_arr),
                            'signals': [s.tolist() if hasattr(s, 'tolist') else list(s) for s in signals],
                            'labels': labels
                        }
                except Exception as e:
                    print(f"Error reading Scope: {e}")
            elif block_name == 'Subsystem':
                if hasattr(block, 'blocks'):
                    find_scopes(block.blocks)

    find_scopes(blocks)
    return scope_data


def _extract_spectrum_data(blocks, node_id_map):
    """Extract data from Spectrum blocks recursively."""
    spectrum_data = {}

    def find_spectrums(block_list):
        for block in block_list:
            block_name = type(block).__name__
            block_id = node_id_map.get(id(block), str(id(block)))

            if block_name == 'Spectrum':
                try:
                    data = block.read()
                    if data is not None:
                        freq_arr, magnitude = data

                        # Convert complex to magnitude if needed
                        if np.iscomplexobj(magnitude):
                            magnitude = np.abs(magnitude)

                        freq_list = freq_arr.tolist() if hasattr(freq_arr, 'tolist') else list(freq_arr)

                        # Handle both single array and list of arrays
                        if hasattr(magnitude, 'ndim') and magnitude.ndim == 1:
                            mag_list = [magnitude.tolist()]
                        elif hasattr(magnitude, 'ndim') and magnitude.ndim == 2:
                            mag_list = [m.tolist() for m in magnitude]
                        else:
                            mag_list = [m.tolist() if hasattr(m, 'tolist') else list(m) for m in magnitude]

                        labels = list(block.labels) if hasattr(block, 'labels') and block.labels else []
                        spectrum_data[block_id] = {
                            'frequency': freq_list,
                            'magnitude': mag_list,
                            'labels': labels
                        }
                except Exception as e:
                    print(f"Error reading Spectrum: {e}")
            elif block_name == 'Subsystem':
                if hasattr(block, 'blocks'):
                    find_spectrums(block.blocks)

    find_spectrums(blocks)
    return spectrum_data


def _extract_all_data(blocks, node_id_map, node_name_map=None, incremental=False):
    """Extract all recording block data.

    If incremental=True, only returns data accumulated since last read.
    """
    return {
        'scopeData': _extract_scope_data(blocks, node_id_map, incremental=incremental),
        'spectrumData': _extract_spectrum_data(blocks, node_id_map),
        'nodeNames': node_name_map or {}
    }
`;function FP(t){return`
import sys
import traceback

_simulation_error = None

try:
${jP(t,4)}
except Exception as e:
    tb = traceback.format_exc()
    _simulation_error = f"{type(e).__name__}: {e}"
    print("=" * 60, file=sys.stderr)
    print("SIMULATION ERROR", file=sys.stderr)
    print("=" * 60, file=sys.stderr)
    print(tb, file=sys.stderr)
    print("=" * 60, file=sys.stderr)
    raise
`}function RP(t){return`
import base64

_validation_namespace = {'np': np}
_validation_errors = []

# Decode and execute code context
_code_context = base64.b64decode("${t}").decode('utf-8')
try:
    exec(_code_context, _validation_namespace)
except Exception as e:
    _validation_errors.append({
        'nodeId': '__code_context__',
        'param': '',
        'error': f"Code context error: {type(e).__name__}: {e}"
    })
`}function BP(t){return`
import json
import base64

if not _validation_errors:
    _node_params = json.loads(base64.b64decode("${t}").decode('utf-8'))

    for node_id, params in _node_params.items():
        for param_name, expr in params.items():
            if expr is None or expr == '':
                continue
            try:
                eval(str(expr), _validation_namespace)
            except Exception as e:
                _validation_errors.append({
                    'nodeId': node_id,
                    'param': param_name,
                    'error': f"{type(e).__name__}: {e}"
                })
`}const zP="{'valid': len(_validation_errors) == 0, 'errors': _validation_errors}",iw=`
import gc
_cg = globals().get('_clean_globals', None)
if _cg is not None:
    for _var in list(globals().keys()):
        if _var not in _cg and _var != '_cg':
            try:
                del globals()[_var]
            except:
                pass
    del _cg
gc.collect()
`,rw=`
import gc
for _var in ['_simulation_error', '_validation_errors', '_validation_namespace']:
    if _var in globals():
        try:
            del globals()[_var]
        except:
            pass
gc.collect()
`;function sw(t,e=10,n=!0){return`
_sim_gen = sim.run_streaming(
    duration=${t},
    reset=${n?"True":"False"},
    tickrate=${e},
    func_callback=lambda: _extract_all_data(blocks, _node_id_map, _node_name_map if '_node_name_map' in globals() else {}, incremental=True)
)
_sim_streaming = True
`}const qP="_step_streaming_gen()",Iu=`
_sim_streaming = False
if '_sim_gen' in globals():
    try:
        _sim_gen.close()
    except:
        pass
`;function jP(t,e){const n=" ".repeat(e);return t.split(`
`).map(i=>n+i).join(`
`)}function zv(t){return btoa(unescape(encodeURIComponent(t)))}const qv={phase:"idle",progress:"",error:null,result:null,resultHistory:[]},Vi={...an({...qv}),reset(){this.set({...qv,resultHistory:[]})}};function HP(t){return t?{scopeData:Object.fromEntries(Object.entries(t.scopeData).map(([e,n])=>[e,{time:[],signals:n.signals.map(()=>[]),labels:n.labels}])),spectrumData:Object.fromEntries(Object.entries(t.spectrumData).map(([e,n])=>[e,{frequency:[],magnitude:n.magnitude.map(()=>[]),labels:n.labels}])),nodeNames:{...t.nodeNames}}:{scopeData:{},spectrumData:{},nodeNames:{}}}let Dh=!1,Hr=!1;function aw(t,e,n){return n===0?[]:t?[t,...e].slice(0,n):e}function jv(t,e){if(!t)return e;const n={...t.scopeData};for(const[i,r]of Object.entries(e.scopeData))n[i]?n[i]={time:[...n[i].time,...r.time],signals:n[i].signals.map((s,a)=>[...s,...r.signals[a]||[]]),labels:r.labels||n[i].labels}:n[i]=r;return{scopeData:n,spectrumData:e.spectrumData,nodeNames:{...t.nodeNames,...e.nodeNames}}}async function H1(){Dh||(await mr(OP),Dh=!0)}async function ow(){await up(),await H1()}const lw=10,UP=10;async function cw(t,e){let n=t;const i=[];let r=null,s=0,a=t;function o(l){if(i.length>0&&l-s>=1e3/UP){for(;i.length>0;){const c=i.shift();n=jv(n,c)}a=n,s=l,Hr&&Vi.update(c=>({...c,result:n}))}Hr&&(r=requestAnimationFrame(o))}for(r=requestAnimationFrame(o),await new Promise((l,c)=>{DP(qP,u=>{u.result&&i.push(u.result)},()=>l(),u=>c(u))});i.length>0;){const l=i.shift();n=jv(n,l)}return a=n,r!==null&&cancelAnimationFrame(r),a}async function WP(t,e,n){Ze(Bu).initialized||await up(),Hr=!0;const r=rs.get().ghostTraces;Vi.update(s=>({...s,phase:"starting",progress:Z5.STARTING_SIMULATION,error:null,result:r>0?HP(s.result):s.result,resultHistory:aw(s.result,s.resultHistory,r)}));try{await mr(iw),Dh=!1,await H1();const s=FP(t);await mr(s),await mr(sw(e,lw)),Vi.update(o=>({...o,phase:"running"})),yi.info("Streaming simulation started");const a=await cw(null,n);return await mr(Iu),await mr(rw),Vi.update(o=>!Hr&&o.result===null?o:{...o,phase:Hr?"complete":"idle",progress:Hr?Nc.COMPLETE:Nc.STOPPED,result:a}),Hr&&yi.info(SP.SIMULATION_COMPLETED),a}catch(s){const a=s instanceof Error?s.message:String(s);yi.error(`Streaming simulation failed: ${a}`);try{await mr(Iu)}catch{}throw Vi.update(o=>({...o,phase:"error",error:a})),s}finally{Hr=!1}}async function VP(t,e){if(!Ze(Bu).initialized)throw new Error("No simulation to continue. Run a simulation first.");await H1(),Hr=!0,Vi.update(i=>({...i,phase:"starting",progress:"Continuing simulation...",error:null,resultHistory:aw(i.result,i.resultHistory,rs.get().ghostTraces)}));try{await mr(`
if 'sim' not in dir() or sim is None:
    raise RuntimeError("No simulation to continue. Run a simulation first.")
		`),await mr(sw(t,lw,!1)),Vi.update(s=>({...s,phase:"running"})),yi.info("Continuing simulation (streaming)...");const i=Ze(Vi).result,r=await cw(i,e);return await mr(Iu),Vi.update(s=>!Hr&&s.result===null?s:{...s,phase:Hr?"complete":"idle",progress:Hr?Nc.COMPLETE:Nc.STOPPED,result:r}),Hr&&yi.info("Simulation continued successfully"),r}catch(i){const r=i instanceof Error?i.message:String(i);yi.error(`Continue simulation failed: ${r}`);try{await mr(Iu)}catch{}throw Vi.update(s=>({...s,phase:"error",error:r})),i}finally{Hr=!1}}async function uw(){if(nw(),Hr=!1,Vi.reset(),Ze(Bu).initialized)try{await mr(Iu,Ts.VALIDATION),await mr(iw)}catch{}Dh=!1}async function GP(t,e){Ze(Bu).initialized||await ow();try{const i=zv(t);await mr(RP(i),Ts.VALIDATION);const r=zv(JSON.stringify(e));await mr(BP(r),Ts.VALIDATION);const s=await TP(zP,Ts.VALIDATION);return await mr(rw),s}catch(i){return{valid:!1,errors:[{nodeId:"__validation__",param:"",error:i instanceof Error?i.message:String(i)}]}}}async function Hv(){if(nw(),Hr=!1,Vi.update(e=>({...e,phase:"idle",progress:Nc.STOPPED,error:null})),!!Ze(Bu).initialized)try{await mr(Iu,Ts.VALIDATION),await mr(`
if 'sim' in dir() and sim is not None:
    sim.stop()
		`,Ts.VALIDATION)}catch{}}function XP(t){Vi.update(e=>({...e,resultHistory:e.resultHistory.slice(0,t)}))}const Mm={lineStyle:"solid",markerStyle:null},Oh={xAxisScale:"linear",yAxisScale:"linear",showLegend:!1},dw={traces:{},blocks:{}},dc=an({...dw}),Cr={subscribe:dc.subscribe,getTraceSettings(t){return Ze(dc).traces[t]??{...Mm}},getBlockSettings(t){return Ze(dc).blocks[t]??{...Oh}},setTraceSettings(t,e){dc.update(n=>{const i=n.traces[t]??{...Mm};return{...n,traces:{...n.traces,[t]:{...i,...e}}}})},setBlockSettings(t,e){dc.update(n=>{const i=n.blocks[t]??{...Oh};return{...n,blocks:{...n.blocks,[t]:{...i,...e}}}})},setTraceLineStyle(t,e){this.setTraceSettings(t,{lineStyle:e})},setTraceMarkerStyle(t,e){this.setTraceSettings(t,{markerStyle:e})},setBlockXAxisScale(t,e){this.setBlockSettings(t,{xAxisScale:e})},setBlockYAxisScale(t,e){this.setBlockSettings(t,{yAxisScale:e})},setBlockShowLegend(t,e){this.setBlockSettings(t,{showLegend:e})},reset(){dc.set({...dw})},get(){return Ze(dc)}};function Tm(t,e){return`${t}-${e}`}const YP=15,KP=400,vg=.5,ZP=.2;function JP(t,e){if(e<=1)return vg;const n=vg-ZP;return vg-t/(e-1)*n}const Uv=["#E57373","#81C784","#64B5F6","#BA68C8","#4DD0E1","#FFB74D","#F06292","#4DB6AC","#90A4AE"];function fw(t,e){return t===0?e:Uv[(t-1)%Uv.length]}function hw(){return typeof document>"u"?"#0070C0":getComputedStyle(document.documentElement).getPropertyValue("--accent").trim()||"#0070C0"}const QP={solid:"solid",dash:"dash",dot:"dot"},pw={solid:"",dash:"6,3",dot:"2,2"},$P={circle:"circle",square:"square","triangle-up":"triangle-up"},gw=224,mw=96,vw=8;function eE(t,e,n=KP){const i=t.length;if(i===0)return{x:[],y:[],xMin:0,xMax:1,yMin:0,yMax:1};if(i<=n*2){let f=e[0],h=e[0];for(let d=1;d<i;d++)e[d]<f&&(f=e[d]),e[d]>h&&(h=e[d]);return{x:t,y:e,xMin:t[0],xMax:t[i-1],yMin:f,yMax:h}}const r=i/n,s=[],a=[];let o=1/0,l=-1/0;for(let f=0;f<n;f++){const h=Math.floor(f*r),d=Math.floor((f+1)*r);let y=h,m=h,x=e[h],w=e[h];for(let S=h+1;S<d&&S<i;S++)e[S]<x&&(x=e[S],y=S),e[S]>w&&(w=e[S],m=S);y<=m?(s.push(t[y]),a.push(e[y]),m!==y&&(s.push(t[m]),a.push(e[m]))):(s.push(t[m]),a.push(e[m]),s.push(t[y]),a.push(e[y])),x<o&&(o=x),w>l&&(l=w)}const c=t[i-1],u=e[i-1];return s[s.length-1]!==c&&(s.push(c),a.push(u)),{x:s,y:a,xMin:t[0],xMax:t[i-1],yMin:o,yMax:l}}function tE(t){let e=1/0,n=-1/0,i=1/0,r=-1/0;for(const{x:s,y:a}of t)for(let o=0;o<s.length;o++)s[o]<e&&(e=s[o]),s[o]>n&&(n=s[o]),a[o]<i&&(i=a[o]),a[o]>r&&(r=a[o]);return isFinite(e)||(e=0),isFinite(n)||(n=1),isFinite(i)||(i=0),isFinite(r)||(r=1),{xMin:e,xMax:n,yMin:i,yMax:r}}function Wv(t){return t>=1e6?(t/1e6).toFixed(1)+"M":t>=1e3?(t/1e3).toFixed(1)+"k":t>=1?t.toFixed(1):t.toExponential(1)}function iu(t){return typeof document>"u"?"":getComputedStyle(document.documentElement).getPropertyValue(t).trim()}function Vv(t,e){if(e==="scope"){const n=t;return{x:n.time||[],ys:n.signals||[],labels:n.labels}}else{const n=t;return{x:n.frequency?Array.from({length:n.frequency.length},(r,s)=>s):[],ys:n.magnitude||[],labels:n.labels}}}function Gv(t,e,n,i,r,s,a){const o=fw(t,s),l={lineStyle:r.lineStyle,markerStyle:r.markerStyle,color:o,visible:r.lineStyle!==null||r.markerStyle!==null};if(!l.visible)return null;const c=eE(e,n);return{signalIndex:t,label:i,x:e,y:n,xDecimated:c.x,yDecimated:c.y,style:l,ghost:a}}function Xv(t){const{nodeId:e,type:n,title:i,data:r,ghostData:s,getTraceSettings:a,blockSettings:o,accentColor:l}=t,c=[],u=[],f=s.length;for(let y=f-1;y>=0;y--){const m=s[y];if(!m)continue;const{x,ys:w,labels:S}=Vv(m,n);if(x.length===0)continue;const A=JP(y,f);for(let _=0;_<w.length;_++){const M=w[_];if(!M||M.length===0)continue;const I=S?.[_]??`port ${_}`,T=a(_),D=Gv(_,x,M,I,T,l,{index:y,total:f,opacity:A});D&&(c.push(D),u.push({x,y:M}))}}if(r){const{x:y,ys:m,labels:x}=Vv(r,n);if(y.length>0)for(let w=0;w<m.length;w++){const S=m[w];if(!S||S.length===0)continue;const A=x?.[w]??`port ${w}`,_=a(w),M=Gv(w,y,S,A,_,l,null);M&&(c.push(M),u.push({x:y,y:S}))}}const h=tE(u);let d;return n==="spectrum"&&r&&(d=r.frequency),{nodeId:e,type:n,title:i,traces:c,layout:{xAxisScale:o.xAxisScale,yAxisScale:o.yAxisScale,showLegend:o.showLegend},bounds:h,frequencies:d}}function nE(t){const{fps:e,name:n="RenderQueue"}=t,i=1e3/e,r=new Map;let s=null,a=0,o=!0;function l(){o=document.visibilityState==="visible",o&&r.size>0&&s===null&&c()}typeof document<"u"&&document.addEventListener("visibilitychange",l);function c(){s===null&&(s=requestAnimationFrame(u))}function u(f){if(s=null,!o||r.size===0)return;if(f-a<i){c();return}a=f;const h=Array.from(r.values());r.clear();for(const d of h)try{d()}catch(y){console.error(`[${n}] Task error:`,y)}r.size>0&&c()}return{enqueue(f,h){r.set(f,h),o&&c()},cancel(f){r.delete(f)},isVisible(){return o},destroy(){s!==null&&(cancelAnimationFrame(s),s=null),r.clear(),typeof document<"u"&&document.removeEventListener("visibilitychange",l)}}}const iE=nE({fps:YP,name:"PlotRenderQueue"}),ld=an({plots:new Map,isStreaming:!1,lastUpdateTime:0}),rE=Symbol("plotDataStore");function sE(t,e,n){const i=new Map;if(!t)return i;const r=hw(),s=(o,l)=>t.nodeNames?.[o]||l,a=(o,l)=>e.slice(0,n).map(u=>l==="scope"?u.scopeData?.[o]:u.spectrumData?.[o]).filter(u=>u!=null);if(t.scopeData)for(const[o,l]of Object.entries(t.scopeData)){const c=Xv({nodeId:o,type:"scope",title:s(o,"Scope"),data:l,ghostData:a(o,"scope"),getTraceSettings:u=>Cr.getTraceSettings(Tm(o,u)),blockSettings:Cr.getBlockSettings(o),accentColor:r});i.set(o,c)}if(t.spectrumData)for(const[o,l]of Object.entries(t.spectrumData)){Ze(Cr).blocks[o]||Cr.setBlockYAxisScale(o,"log");const u=Xv({nodeId:o,type:"spectrum",title:s(o,"Spectrum"),data:l,ghostData:a(o,"spectrum"),getTraceSettings:f=>Cr.getTraceSettings(Tm(o,f)),blockSettings:Cr.getBlockSettings(o),accentColor:r});i.set(o,u)}return i}let Yv=null,Kv=[],Zv=0;function U1(){iE.enqueue(rE,()=>{const t=Ze(Vi),n=Ze(rs).ghostTraces??0,i=sE(t.result,t.resultHistory,n);ld.set({plots:i,isStreaming:t.phase==="running",lastUpdateTime:Date.now()})})}Vi.subscribe(t=>{(t.result!==Yv||t.resultHistory!==Kv)&&(Yv=t.result,Kv=t.resultHistory,U1())});rs.subscribe(t=>{(t.ghostTraces??0)!==Zv&&(Zv=t.ghostTraces??0,U1())});Cr.subscribe(()=>{U1()});const dp={subscribe:ld.subscribe,getPlot(t){return Ze(ld).plots.get(t)},getAllPlots(){return Array.from(Ze(ld).plots.values())},isStreaming(){return Ze(ld).isStreaming}},Fn=10,bs={unit:Fn,x2:Fn*2,x4:Fn*4,x10:Fn*10,px:t=>t*Fn},aE=[Fn,Fn],oE=bs.x2,vd={baseWidth:bs.px(8),baseHeight:bs.x4,portSpacing:bs.x2},lE=bs.x4,cd={columnWidth:bs.x4,rowHeight:bs.x4};function Cf(t){return Math.ceil(t/bs.x2)*bs.x2}function cE(t,e){return e<=0||e===1?0:-((e-1)*vd.portSpacing)/2+t*vd.portSpacing}function Dl(t,e){const n=cE(t,e);return n===0?"50%":`calc(50% + ${n}px)`}const uE=14;function dE(t,e,n,i,r,s,a,o,l){const c=r===1||r===3,u=Math.max(e,n),f=Math.max(1,u)*vd.portSpacing,h=i>0?7+24*i:0,d=i>0?160:0,y=s?s.length*5+20:0,m=l?Cf(l.width+24):t.length*6+20;let x=Cf(Math.max(vd.baseWidth,m,y,d,c?f:0)),w;l&&l.height>uE*1.2?w=l.height+24+h:w=vd.baseHeight+h;let S=x,A=Cf(c?w:Math.max(w,f));return c?(a&&(A+=cd.rowHeight),o&&(A+=cd.rowHeight)):(a&&(S+=cd.columnWidth),o&&(S+=cd.columnWidth)),{width:S,height:A}}function fE(t,e){const n=t.params?._showInputLabels??e,i=t.params?._showOutputLabels??e;return{inputs:n&&t.inputs.length>0,outputs:i&&t.outputs.length>0}}function Pf(t,e=5){return t.length>e?t.slice(0,e):t}let Ef=null;async function W1(){return Ef||(Ef=await gs(()=>import("./XbL3y5x-.js"),[],import.meta.url),Ef)}function V1(){return"https://cdn.jsdelivr.net/npm/katex@0.16.9/dist/katex.min.css"}const ah=new Map;function yw(t){return/\$[^$\n]+\$/.test(t)}async function hE(t){if(!t?.trim())return{html:"",hasMath:!1};const e=ah.get(t);if(e)return e;if(!yw(t)){const a={html:Qv(t),hasMath:!1};return ah.set(t,a),a}const n=await W1();let i=!1;const s={html:t.replace(/\$([^$\n]+)\$/g,(a,o)=>{i=!0;try{return n.default.renderToString(o.trim(),{displayMode:!1,throwOnError:!1,strict:!1,output:"html"})}catch{return`<code class="math-error">${Qv(o)}</code>`}}),hasMath:i};return ah.set(t,s),s}function pE(t){return ah.get(t)??null}function Jv(t){const e=document.createElement("span");e.style.cssText=`
		position: absolute;
		visibility: hidden;
		white-space: nowrap;
		font-size: 10px;
		font-weight: 600;
		font-family: system-ui, -apple-system, sans-serif;
		letter-spacing: -0.2px;
	`,e.innerHTML=t,document.body.appendChild(e);const n={width:Math.ceil(e.scrollWidth),height:Math.ceil(e.scrollHeight)};return document.body.removeChild(e),n}function Qv(t){return t.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;")}const gE=1e-10;function $v(t,e){return e==="log"?Math.log10(Math.max(t,gE)):t}function e2(t,e,n){if(n==="log"){const r=t>0?t:1,s=Math.max(e,r),a=Math.log10(r),o=Math.log10(s),l=o-a||1;return{scaledMin:a,scaledMax:o,range:l}}const i=e-t||1;return{scaledMin:t,scaledMax:e,range:i}}function mE(t,e=gw,n=mw,i=vw){const{traces:r,bounds:s,layout:a}=t;if(r.length===0)return[];const{xMin:o,xMax:l,yMin:c,yMax:u}=s,f=a.xAxisScale,h=a.yAxisScale,d=e2(o,l,f),y=e2(c,u,h),m=e-i*2,x=n-i*2;return r.map(w=>{const{xDecimated:S,yDecimated:A,style:_,ghost:M}=w,I=[];for(let T=0;T<S.length;T++){const D=S[T],O=A[T];if(f==="log"&&D<=0||h==="log"&&O<=0)continue;const W=$v(D,f),C=$v(O,h),N=i+(W-d.scaledMin)/d.range*m,B=n-i-(C-y.scaledMin)/y.range*x,E=Math.max(i,Math.min(e-i,N)),R=Math.max(i,Math.min(n-i,B)),q=I.length===0?"M":"L";I.push(`${q}${E.toFixed(1)},${R.toFixed(1)}`)}return{d:I.join(" "),color:_.color,opacity:M?.opacity??1,strokeWidth:M?.7:1,dasharray:_.lineStyle?pw[_.lineStyle]:""}})}var vE=nt('<path fill="none" stroke-linecap="round" stroke-linejoin="round"></path>'),yE=nt('<text text-anchor="middle" class="no-data-text svelte-1i5tbyr" font-size="11" font-family="Inter, sans-serif">No data</text>'),bE=Le('<div class="preview-container svelte-1i5tbyr"><svg class="svelte-1i5tbyr"><rect x="0" y="0" rx="4" class="plot-bg svelte-1i5tbyr"></rect><!></svg></div>');function wE(t,e){Mt(e,!0);const n=gw,i=mw,r=vw;let s=Fe(Rn([]));const a=dp.subscribe(y=>{const m=y.plots.get(e.nodeId);m?$(s,mE(m,n,i,r),!0):$(s,[],!0)});Ai(()=>{a()});const o=re(()=>()=>p(s).length>0);var l=bE(),c=ne(l),u=ne(c),f=we(u);{var h=y=>{var m=Je(),x=He(m);cn(x,17,()=>p(s),Cn,(w,S)=>{var A=vE();Ae(()=>{he(A,"d",p(S).d),he(A,"stroke",p(S).color),he(A,"stroke-width",p(S).strokeWidth),he(A,"stroke-dasharray",p(S).dasharray),he(A,"opacity",p(S).opacity)}),j(w,A)}),j(y,m)},d=y=>{var m=yE();Ae(()=>{he(m,"x",n/2),he(m,"y",i/2+4)}),j(y,m)};Se(f,y=>{p(o)()?y(h):y(d,!1)})}Q(c),Q(l),Ae(()=>{he(c,"width",n),he(c,"height",i),he(c,"viewBox",`0 0 ${n} ${i}`),he(u,"width",n),he(u,"height",i)}),j(t,l),Tt()}var xE=Le('<link rel="stylesheet"/>'),_E=Le("<div><!></div>"),SE=Le('<div class="selection-glow svelte-1d5s31p"></div>'),kE=Le('<span class="port-label svelte-1d5s31p"> </span>'),AE=Le('<div class="port-labels port-labels-input port-labels-row svelte-1d5s31p"></div>'),NE=Le('<span class="port-label svelte-1d5s31p"> </span>'),CE=Le('<div class="port-labels port-labels-input svelte-1d5s31p"></div>'),PE=Le('<span class="node-name svelte-1d5s31p"><!></span>'),EE=Le('<span class="node-name svelte-1d5s31p"> </span>'),IE=Le('<span class="node-type svelte-1d5s31p"> </span>'),LE=Le('<div class="pinned-param svelte-1d5s31p"><label class="svelte-1d5s31p"> </label> <input type="text" class="svelte-1d5s31p"/></div>'),ME=Le('<div class="pinned-params svelte-1d5s31p"></div>'),TE=Le('<span class="port-label svelte-1d5s31p"> </span>'),DE=Le('<div class="port-labels port-labels-output port-labels-row svelte-1d5s31p"></div>'),OE=Le('<span class="port-label svelte-1d5s31p"> </span>'),FE=Le('<div class="port-labels port-labels-output svelte-1d5s31p"></div>'),RE=Le('<div><button class="port-btn svelte-1d5s31p" title="Add input">+</button> <button class="port-btn svelte-1d5s31p" title="Remove input">-</button></div>'),BE=Le('<div><button class="port-btn svelte-1d5s31p" title="Add output">+</button> <button class="port-btn svelte-1d5s31p" title="Remove output">-</button></div>'),zE=Le('<div><!> <!> <div class="node-clip svelte-1d5s31p"><!> <div class="node-inner svelte-1d5s31p"><div class="node-content svelte-1d5s31p"><!> <!></div> <!></div> <!></div> <!> <!> <!> <!></div>');function qE(t,e){Mt(e,!0);let n=ot(e,"selected",3,!1);const i=P5(),r=re(()=>Ri.get(e.data.type)),s=re(()=>p(r)?.category||"Algebraic"),a=re(()=>()=>{if(!e.data.pinnedParams?.length||!p(r))return[];const qe=new Set(p(r).params.map($e=>$e.name));return e.data.pinnedParams.filter($e=>qe.has($e))}),o=re(()=>p(s)==="Recording");let l=Fe(!1),c=null,u=Fe(!1),f=Fe(!1),h=Fe(!1),d=Fe(!1);const y=ih.subscribe(qe=>{$(h,qe,!0)}),m=dp.subscribe(qe=>{$(d,qe.plots.has(e.id),!0)});let x=Fe(!1);const w=q1.subscribe(qe=>{$(x,qe,!0)}),S=re(()=>e.data.params?._showInputLabels),A=re(()=>e.data.params?._showOutputLabels),_=re(()=>p(S)??p(x)),M=re(()=>p(A)??p(x)),I=re(()=>p(_)&&e.data.inputs.length>0),T=re(()=>p(M)&&e.data.outputs.length>0),D=re(()=>p(I)||p(T));pn(()=>{(p(_)!==void 0||p(M)!==void 0)&&i(e.id)}),Ai(()=>{y(),m(),w(),c&&clearTimeout(c)}),pn(()=>{p(h)&&p(d)&&$(u,!0)});function O(){p(o)&&($(l,!0),c=setTimeout(()=>{p(l)&&($(u,!0),$(f,!0))},300))}function W(){$(l,!1),$(f,!1),c&&(clearTimeout(c),c=null)}const C=re(()=>yw(e.data.name));let N=Fe(null),B=Fe(null),E=Fe(null);pn(()=>{if(p(C)){const qe=pE(e.data.name);if(qe){$(N,qe.html,!0);const $e=Jv(qe.html);$(B,$e.width,!0),$(E,$e.height,!0),i(e.id)}else hE(e.data.name).then($e=>{$(N,$e.html,!0);const Pt=Jv($e.html);$(B,Pt.width,!0),$(E,Pt.height,!0),i(e.id)})}else $(N,null),$(B,null),$(E,null)});const R=re(()=>p(r)?.ports.maxInputs===null),q=re(()=>p(r)?.ports.maxOutputs===null),Z=re(()=>p(r)?.ports.syncPorts??!1),U=re(()=>e.data.params?._rotation||0),X=re(()=>()=>{switch(p(U)){case 1:return Kt.Top;case 2:return Kt.Right;case 3:return Kt.Bottom;default:return Kt.Left}}),de=re(()=>()=>{switch(p(U)){case 1:return Kt.Bottom;case 2:return Kt.Left;case 3:return Kt.Top;default:return Kt.Right}}),le=re(()=>p(U)===1||p(U)===3),F=re(()=>()=>{switch(p(U)){case 1:return"bottom";case 2:return"left";case 3:return"top";default:return"right"}}),V=re(()=>p(a)().length),G=re(()=>p(C)&&p(B)!==null&&p(E)!==null?{width:p(B),height:p(E)}:null),se=re(()=>dE(e.data.name,e.data.inputs.length,e.data.outputs.length,p(V),p(U),p(r)?.name,p(I),p(T),p(G))),ae=re(()=>()=>{if(!p(D))return{columns:void 0,rows:void 0,inputStyle:"",innerStyle:"",outputStyle:""};const qe=`${cd.columnWidth}px`;let $e,Pt,tn="",Wt="",Gt="";if(p(le)){const Dt=p(U)===1?"border-bottom":"border-top",Jt=p(U)===1?"border-top":"border-bottom",$t="grid-column: 1;";if(p(I)&&p(T))Pt=`${qe} 1fr ${qe}`,p(U)===1?(tn=`${$t} grid-row: 1; ${Dt}: 1px solid var(--border);`,Wt=`${$t} grid-row: 2;`,Gt=`${$t} grid-row: 3; ${Jt}: 1px solid var(--border);`):(Gt=`${$t} grid-row: 1; ${Jt}: 1px solid var(--border);`,Wt=`${$t} grid-row: 2;`,tn=`${$t} grid-row: 3; ${Dt}: 1px solid var(--border);`);else if(p(I)){Pt=p(U)===1?`${qe} 1fr`:`1fr ${qe}`;const wn=p(U)===1?1:2,en=p(U)===1?2:1;tn=`${$t} grid-row: ${wn}; ${Dt}: 1px solid var(--border);`,Wt=`${$t} grid-row: ${en};`}else if(p(T)){Pt=p(U)===1?`1fr ${qe}`:`${qe} 1fr`;const wn=p(U)===1?2:1,en=p(U)===1?1:2;Gt=`${$t} grid-row: ${wn}; ${Jt}: 1px solid var(--border);`,Wt=`${$t} grid-row: ${en};`}}else{const Dt="grid-row: 1;",Jt=p(U)===0?"border-right":"border-left",$t=p(U)===0?"border-left":"border-right";if(p(I)&&p(T))$e=`${qe} 1fr ${qe}`,p(U)===0?(tn=`${Dt} grid-column: 1; ${Jt}: 1px solid var(--border);`,Wt=`${Dt} grid-column: 2;`,Gt=`${Dt} grid-column: 3; ${$t}: 1px solid var(--border);`):(Gt=`${Dt} grid-column: 1; ${$t}: 1px solid var(--border);`,Wt=`${Dt} grid-column: 2;`,tn=`${Dt} grid-column: 3; ${Jt}: 1px solid var(--border);`);else if(p(I)){$e=p(U)===0?`${qe} 1fr`:`1fr ${qe}`;const wn=p(U)===0?1:2,en=p(U)===0?2:1;tn=`${Dt} grid-column: ${wn}; ${Jt}: 1px solid var(--border);`,Wt=`${Dt} grid-column: ${en};`}else if(p(T)){$e=p(U)===0?`1fr ${qe}`:`${qe} 1fr`;const wn=p(U)===0?2:1,en=p(U)===0?1:2;Gt=`${Dt} grid-column: ${wn}; ${$t}: 1px solid var(--border);`,Wt=`${Dt} grid-column: ${en};`}}return{columns:$e,rows:Pt,inputStyle:tn,innerStyle:Wt,outputStyle:Gt}}),te=re(()=>ao(e.data)),ue=re(()=>e.data.type===_n.INTERFACE),pe=re(()=>p(te)||p(ue));function ge(qe){qe.stopPropagation(),p(te)?Re.drillDown(e.id):th(e.id)}function me(qe){qe.stopPropagation(),It.mutate(()=>Re.addInputPort(e.id))}const Pe=re(()=>p(r)?.ports.minInputs??1),ke=re(()=>p(r)?.ports.minOutputs??1);function Ge(qe){qe.stopPropagation(),e.data.inputs.length>p(Pe)&&It.mutate(()=>Re.removeInputPort(e.id))}function K(qe){qe.stopPropagation(),It.mutate(()=>Re.addOutputPort(e.id))}function Oe(qe){qe.stopPropagation(),e.data.outputs.length>p(ke)&&It.mutate(()=>Re.removeOutputPort(e.id))}const Ke=re(()=>()=>p(r)?M5(p(r)):"shape-default"),Be=re(()=>e.data.color||"var(--accent)");function Ee(qe,$e){It.mutate(()=>Re.updateNodeParams(e.id,{[qe]:$e}))}function at(qe){return qe==null?"":typeof qe=="object"?JSON.stringify(qe):String(qe)}function Ue(qe){return qe==null?"None":typeof qe=="object"?JSON.stringify(qe):String(qe)}function Ye(){switch(p(U)){case 1:return"top";case 2:return"right";case 3:return"bottom";default:return"left"}}function ut(){switch(p(U)){case 1:return"bottom";case 2:return"left";case 3:return"top";default:return"right"}}function Ft(qe,$e){od.set({nodeId:e.id,handleId:$e.id,color:p(Be)}),Lm($e.name,qe.currentTarget,Ye())}function be(qe){od.set(null),Th()}function ze(qe,$e){od.set({nodeId:e.id,handleId:$e.id,color:p(Be)}),Lm($e.name,qe.currentTarget,ut())}function ve(qe){od.set(null),Th()}pn(()=>{n()?Im.set({nodeId:e.id,color:p(Be)}):Im.update(qe=>qe?.nodeId===e.id?null:qe)});var Ce=zE();Zh("1d5s31p",qe=>{var $e=xE();Ae(Pt=>he($e,"href",Pt),[V1]),j(qe,$e)});let Ie;Ce.__dblclick=ge;var rt=ne(Ce);{var et=qe=>{var $e=_E();let Pt;var tn=ne($e);wE(tn,{get nodeId(){return e.id}}),Q($e),Ae(Wt=>Pt=Xt($e,1,`plot-preview-popup preview-${Wt??""}`,"svelte-1d5s31p",Pt,{visible:p(f)||p(h)}),[()=>p(F)()]),j(qe,$e)};Se(rt,qe=>{(p(u)||p(h))&&p(d)&&qe(et)})}var vt=we(rt,2);{var wt=qe=>{var $e=SE();j(qe,$e)};Se(vt,qe=>{n()&&qe(wt)})}var Nt=we(vt,2);let it;var kt=ne(Nt);{var ct=qe=>{var $e=Je(),Pt=He($e);{var tn=Gt=>{var Dt=AE();cn(Dt,21,()=>e.data.inputs,Cn,(Jt,$t,wn)=>{var en=kE(),ii=ne(en,!0);Q(en),Ae((kn,En)=>{Nn(en,`left: ${kn??""};`),Ht(ii,En)},[()=>Dl(wn,e.data.inputs.length),()=>Pf(p($t).name)]),j(Jt,en)}),Q(Dt),Ae(Jt=>Nn(Dt,Jt),[()=>p(ae)().inputStyle]),j(Gt,Dt)},Wt=Gt=>{var Dt=CE();cn(Dt,21,()=>e.data.inputs,Cn,(Jt,$t,wn)=>{var en=NE(),ii=ne(en,!0);Q(en),Ae((kn,En)=>{Nn(en,`top: ${kn??""};`),Ht(ii,En)},[()=>Dl(wn,e.data.inputs.length),()=>Pf(p($t).name)]),j(Jt,en)}),Q(Dt),Ae(Jt=>Nn(Dt,Jt),[()=>p(ae)().inputStyle]),j(Gt,Dt)};Se(Pt,Gt=>{p(le)?Gt(tn):Gt(Wt,!1)})}j(qe,$e)};Se(kt,qe=>{p(I)&&qe(ct)})}var yt=we(kt,2),st=ne(yt),gt=ne(st);{var Bt=qe=>{var $e=PE(),Pt=ne($e);c1(Pt,()=>p(N)),Q($e),j(qe,$e)},xt=qe=>{var $e=EE(),Pt=ne($e,!0);Q($e),Ae(()=>Ht(Pt,e.data.name)),j(qe,$e)};Se(gt,qe=>{p(N)?qe(Bt):qe(xt,!1)})}var dt=we(gt,2);{var Ut=qe=>{var $e=IE(),Pt=ne($e,!0);Q($e),Ae(()=>Ht(Pt,p(r).name)),j(qe,$e)};Se(dt,qe=>{p(r)&&qe(Ut)})}Q(st);var ai=we(st,2);{var bn=qe=>{var $e=ME();$e.__click=Pt=>Pt.stopPropagation(),$e.__dblclick=Pt=>Pt.stopPropagation(),cn($e,21,()=>p(a)(),Cn,(Pt,tn)=>{const Wt=re(()=>p(r).params.find($t=>$t.name===p(tn)));var Gt=Je(),Dt=He(Gt);{var Jt=$t=>{var wn=LE(),en=ne(wn),ii=ne(en,!0);Q(en);var kn=we(en,2);jr(kn),kn.__input=En=>Ee(p(tn),En.currentTarget.value),kn.__mousedown=En=>En.stopPropagation(),mt(kn,En=>Zs?.(En)),Q(wn),Ae((En,Bs)=>{he(en,"for",`pinned-${e.id??""}-${p(tn)??""}`),Ht(ii,p(tn)),he(kn,"id",`pinned-${e.id??""}-${p(tn)??""}`),ms(kn,En),he(kn,"placeholder",Bs)},[()=>at(e.data.params[p(tn)]),()=>Ue(p(Wt).default)]),yn("focus",kn,En=>En.stopPropagation()),j($t,wn)};Se(Dt,$t=>{p(Wt)&&$t(Jt)})}j(Pt,Gt)}),Q($e),j(qe,$e)};Se(ai,qe=>{p(a)().length>0&&p(r)&&qe(bn)})}Q(yt);var Ln=we(yt,2);{var ni=qe=>{var $e=Je(),Pt=He($e);{var tn=Gt=>{var Dt=DE();cn(Dt,21,()=>e.data.outputs,Cn,(Jt,$t,wn)=>{var en=TE(),ii=ne(en,!0);Q(en),Ae((kn,En)=>{Nn(en,`left: ${kn??""};`),Ht(ii,En)},[()=>Dl(wn,e.data.outputs.length),()=>Pf(p($t).name)]),j(Jt,en)}),Q(Dt),Ae(Jt=>Nn(Dt,Jt),[()=>p(ae)().outputStyle]),j(Gt,Dt)},Wt=Gt=>{var Dt=FE();cn(Dt,21,()=>e.data.outputs,Cn,(Jt,$t,wn)=>{var en=OE(),ii=ne(en,!0);Q(en),Ae((kn,En)=>{Nn(en,`top: ${kn??""};`),Ht(ii,En)},[()=>Dl(wn,e.data.outputs.length),()=>Pf(p($t).name)]),j(Jt,en)}),Q(Dt),Ae(Jt=>Nn(Dt,Jt),[()=>p(ae)().outputStyle]),j(Gt,Dt)};Se(Pt,Gt=>{p(le)?Gt(tn):Gt(Wt,!1)})}j(qe,$e)};Se(Ln,qe=>{p(T)&&qe(ni)})}Q(Nt);var Ct=we(Nt,2);{var oi=qe=>{var $e=RE();let Pt;var tn=ne($e);tn.__click=me,tn.__dblclick=Gt=>Gt.stopPropagation();var Wt=we(tn,2);Wt.__click=Ge,Wt.__dblclick=Gt=>Gt.stopPropagation(),Q($e),Ae(()=>{Pt=Xt($e,1,"port-controls port-controls-input svelte-1d5s31p",null,Pt,{"port-controls-left":p(U)===0,"port-controls-top":p(U)===1,"port-controls-right":p(U)===2,"port-controls-bottom":p(U)===3}),Wt.disabled=e.data.inputs.length<=p(Pe)}),j(qe,$e)};Se(Ct,qe=>{p(R)&&n()&&qe(oi)})}var Hn=we(Ct,2);{var Sn=qe=>{var $e=BE();let Pt;var tn=ne($e);tn.__click=K,tn.__dblclick=Gt=>Gt.stopPropagation();var Wt=we(tn,2);Wt.__click=Oe,Wt.__dblclick=Gt=>Gt.stopPropagation(),Q($e),Ae(()=>{Pt=Xt($e,1,"port-controls port-controls-output svelte-1d5s31p",null,Pt,{"port-controls-right":p(U)===0,"port-controls-bottom":p(U)===1,"port-controls-left":p(U)===2,"port-controls-top":p(U)===3}),Wt.disabled=e.data.outputs.length<=p(ke)}),j(qe,$e)};Se(Hn,qe=>{p(q)&&n()&&!p(Z)&&qe(Sn)})}var Mn=we(Hn,2);F0(Mn,()=>`${p(U)}-${e.data.inputs.length}`,qe=>{var $e=Je(),Pt=He($e);cn(Pt,17,()=>e.data.inputs,Cn,(tn,Wt,Gt)=>{{let Dt=re(()=>p(X)()),Jt=re(()=>p(le)?`left: ${Dl(Gt,e.data.inputs.length)};`:`top: ${Dl(Gt,e.data.inputs.length)};`);Pu(tn,{type:"target",get position(){return p(Dt)},get id(){return p(Wt).id},get style(){return p(Jt)},class:"handle handle-input",onmouseenter:$t=>Ft($t,p(Wt)),onmouseleave:()=>be(p(Wt))})}}),j(qe,$e)});var Pn=we(Mn,2);F0(Pn,()=>`${p(U)}-${e.data.outputs.length}`,qe=>{var $e=Je(),Pt=He($e);cn(Pt,17,()=>e.data.outputs,Cn,(tn,Wt,Gt)=>{{let Dt=re(()=>p(de)()),Jt=re(()=>p(le)?`left: ${Dl(Gt,e.data.outputs.length)};`:`top: ${Dl(Gt,e.data.outputs.length)};`);Pu(tn,{type:"source",get position(){return p(Dt)},get id(){return p(Wt).id},get style(){return p(Jt)},class:"handle handle-output",onmouseenter:$t=>ze($t,p(Wt)),onmouseleave:()=>ve(p(Wt))})}}),j(qe,$e)}),Q(Ce),Ae((qe,$e,Pt)=>{Ie=Xt(Ce,1,`node ${qe??""}`,"svelte-1d5s31p",Ie,{selected:n(),vertical:p(le),"preview-hovered":p(f),"subsystem-type":p(pe),"show-labels":p(D)}),he(Ce,"data-rotation",p(U)),Nn(Ce,`width: ${p(se).width??""}px; height: ${p(se).height??""}px; --node-color: ${p(Be)??""};`),it=Nn(Nt,"",it,$e),Nn(yt,Pt)},[()=>p(Ke)(),()=>({"grid-template-columns":p(ae)().columns,"grid-template-rows":p(ae)().rows}),()=>p(ae)().innerStyle]),yn("mouseenter",Ce,O),yn("mouseleave",Ce,W),j(t,Ce),Tt()}Xn(["dblclick","click","input","mousedown"]);const $u=an(null),G1={subscribe:$u.subscribe,open(t){$u.set(t)},close(){$u.set(null)},isOpen(){return Ze($u)!==null},getOpenId(){return Ze($u)}},bw=t=>G1.open(t),yg=()=>G1.close();var jE=Le('<span class="event-type svelte-7puem2"> </span>'),HE=Le('<div><div class="diamond svelte-7puem2"><div class="diamond-inner svelte-7puem2"><span class="event-name svelte-7puem2"> </span> <!></div></div></div>');function UE(t,e){Mt(e,!0);let n=ot(e,"selected",3,!1);const i=re(()=>ra.get(e.data.type)),r=re(()=>e.data.color||"var(--accent)");function s(y){y.stopPropagation(),bw(e.id)}var a=HE();let o;a.__dblclick=s;var l=ne(a);l.__dblclick=s;var c=ne(l),u=ne(c),f=ne(u,!0);Q(u);var h=we(u,2);{var d=y=>{var m=jE(),x=ne(m,!0);Q(m),Ae(()=>Ht(x,p(i).name)),j(y,m)};Se(h,y=>{p(i)&&y(d)})}Q(c),Q(l),Q(a),Ae(()=>{o=Xt(a,1,"event-node svelte-7puem2",null,o,{selected:n()}),Nn(a,`--event-color: ${p(r)??""};`),Ht(f,e.data.name)}),j(t,a),Tt()}Xn(["dblclick"]);async function WE(t){if(!t?.trim())return"";const e=await W1(),n=[];let i=t.replace(/\$\$([\s\S]*?)\$\$/g,(r,s)=>{const a=`%%MATH_BLOCK_${n.length}%%`;try{n.push(e.default.renderToString(s.trim(),{displayMode:!0,throwOnError:!1,strict:!1}))}catch{n.push(`<code class="math-error">${t2(s)}</code>`)}return a});return i=i.replace(/\$([^\$\n]+?)\$/g,(r,s)=>{const a=`%%MATH_BLOCK_${n.length}%%`;try{n.push(e.default.renderToString(s.trim(),{displayMode:!1,throwOnError:!1,strict:!1}))}catch{n.push(`<code class="math-error">${t2(s)}</code>`)}return a}),i=VE(i),n.forEach((r,s)=>{i=i.replace(`%%MATH_BLOCK_${s}%%`,r)}),i}function VE(t){let e=t.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;");return e=e.replace(/%%MATH_BLOCK_(\d+)%%/g,"%%MATH_BLOCK_$1%%"),e=e.replace(/```(\w*)\n([\s\S]*?)```/g,(n,i,r)=>`<pre><code>${r.trim()}</code></pre>`),e=e.replace(/^### (.*)$/gm,"<h3>$1</h3>"),e=e.replace(/^## (.*)$/gm,"<h2>$1</h2>"),e=e.replace(/^# (.*)$/gm,"<h1>$1</h1>"),e=e.replace(/^([-*_]){3,}\s*$/gm,"<hr>"),e=e.replace(/^&gt; (.*)$/gm,"<blockquote>$1</blockquote>"),e=e.replace(/<\/blockquote>\n<blockquote>/g,`
`),e=e.replace(/^[-*] (.*)$/gm,"<li>$1</li>"),e=e.replace(/((?:<li>.*<\/li>\n?)+)/g,"<ul>$1</ul>"),e=e.replace(/^\d+\. (.*)$/gm,"<oli>$1</oli>"),e=e.replace(/((?:<oli>.*<\/oli>\n?)+)/g,n=>"<ol>"+n.replace(/<\/?oli>/g,i=>i.replace("oli","li"))+"</ol>"),e=e.replace(/\*\*\*(.+?)\*\*\*/g,"<strong><em>$1</em></strong>"),e=e.replace(/\*\*(.+?)\*\*/g,"<strong>$1</strong>"),e=e.replace(new RegExp("(?<![<])\\*([^*\\n]+?)\\*(?![>])","g"),"<em>$1</em>"),e=e.replace(/`([^`]+)`/g,"<code>$1</code>"),e=e.replace(/\[([^\]]+)\]\(([^)]+)\)/g,'<a href="$2" target="_blank" rel="noopener">$1</a>'),e=e.split(/\n\n+/).map(n=>n.trim()).filter(n=>n.length>0).map(n=>/^<(h[1-6]|ul|ol|blockquote|pre|hr)/.test(n)?n:`<p>${n.replace(/\n/g,"<br>")}</p>`).join(""),e}function t2(t){return t.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;")}var GE=nt('<svg width="8" height="8" viewBox="0 0 24 24" fill="none" stroke-width="4"><polyline points="20 6 9 17 4 12"></polyline></svg>'),XE=Le("<button><!></button>"),YE=Le('<div role="dialog" tabindex="-1"><div class="color-grid svelte-10xj43v"></div> <div class="color-custom svelte-10xj43v"><label for="custom-color" class="svelte-10xj43v">CUSTOM:</label> <input id="custom-color" type="color" class="custom-color-input svelte-10xj43v"/></div></div>'),KE=Le('<div class="color-picker-wrapper svelte-10xj43v"><button aria-label="Change color"><svg viewBox="0 0 24 24" fill="none" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="10"></circle><circle cx="8" cy="10" r="1.5"></circle><circle cx="12" cy="7" r="1.5"></circle><circle cx="16" cy="10" r="1.5"></circle><circle cx="15" cy="15" r="2"></circle></svg></button> <!></div>');function X1(t,e){Mt(e,!0);let n=ot(e,"defaultColor",3,il),i=ot(e,"popupPosition",3,"bottom"),r=ot(e,"tooltipPosition",3,"bottom"),s=ot(e,"iconSize",3,16),a=ot(e,"variant",3,"default"),o=Fe(!1);function l(){$(o,!p(o))}function c(I){I===n()?e.onSelect(void 0):e.onSelect(I),$(o,!1)}function u(I){const T=I.target;e.onSelect(T.value)}function f(I){I.target.closest(".color-picker-wrapper")||$(o,!1)}var h=KE();yn("click",$n,f);var d=ne(h);let y;d.__click=l;var m=ne(d),x=we(ne(m)),w=we(x),S=we(w),A=we(S);Q(m),Q(d),mt(d,(I,T)=>Qt?.(I,T),()=>({text:"Color",position:r()}));var _=we(d,2);{var M=I=>{var T=YE();T.__click=C=>C.stopPropagation();var D=ne(T);cn(D,21,()=>AC,Cn,(C,N)=>{var B=XE();let E;B.__click=()=>c(p(N));var R=ne(B);{var q=Z=>{var U=GE();Ae(()=>he(U,"stroke",p(N)==="#FFFFFF"||p(N)==="#FFF176"?"#333":"#fff")),j(Z,U)};Se(R,Z=>{e.currentColor===p(N)&&Z(q)})}Q(B),Ae(()=>{E=Xt(B,1,"color-option svelte-10xj43v",null,E,{selected:e.currentColor===p(N)}),Nn(B,`background: ${p(N)??""};`),he(B,"title",p(N)===n()?"Default":p(N))}),j(C,B)}),Q(D);var O=we(D,2),W=we(ne(O),2);jr(W),W.__input=u,Q(O),Q(T),Ae(()=>{Xt(T,1,`color-picker-popup popup-${i()??""}`,"svelte-10xj43v"),ms(W,e.currentColor)}),j(I,T)};Se(_,I=>{p(o)&&I(M)})}Q(h),Ae(()=>{y=Xt(d,1,"picker-btn svelte-10xj43v",null,y,{ghost:a()==="ghost"}),he(m,"width",s()),he(m,"height",s()),he(m,"stroke",e.iconColor||"currentColor"),he(x,"fill",e.iconColor||"currentColor"),he(w,"fill",e.iconColor||"currentColor"),he(S,"fill",e.iconColor||"currentColor"),he(A,"fill",e.iconColor||"currentColor")}),j(t,h),Tt()}Xn(["click","input"]);var ZE=nt('<svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svelte-1aaflua"><polyline points="3 6 5 6 21 6"></polyline><path d="M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6m3 0V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2"></path></svg>'),JE=nt('<svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svelte-1aaflua"><circle cx="12" cy="12" r="3"></circle><path d="M19.4 15a1.65 1.65 0 0 0 .33 1.82l.06.06a2 2 0 0 1 0 2.83 2 2 0 0 1-2.83 0l-.06-.06a1.65 1.65 0 0 0-1.82-.33 1.65 1.65 0 0 0-1 1.51V21a2 2 0 0 1-2 2 2 2 0 0 1-2-2v-.09A1.65 1.65 0 0 0 9 19.4a1.65 1.65 0 0 0-1.82.33l-.06.06a2 2 0 0 1-2.83 0 2 2 0 0 1 0-2.83l.06-.06a1.65 1.65 0 0 0 .33-1.82 1.65 1.65 0 0 0-1.51-1H3a2 2 0 0 1-2-2 2 2 0 0 1 2-2h.09A1.65 1.65 0 0 0 4.6 9a1.65 1.65 0 0 0-.33-1.82l-.06-.06a2 2 0 0 1 0-2.83 2 2 0 0 1 2.83 0l.06.06a1.65 1.65 0 0 0 1.82.33H9a1.65 1.65 0 0 0 1-1.51V3a2 2 0 0 1 2-2 2 2 0 0 1 2 2v.09a1.65 1.65 0 0 0 1 1.51 1.65 1.65 0 0 0 1.82-.33l.06-.06a2 2 0 0 1 2.83 0 2 2 0 0 1 0 2.83l-.06.06a1.65 1.65 0 0 0-.33 1.82V9a1.65 1.65 0 0 0 1.51 1H21a2 2 0 0 1 2 2 2 2 0 0 1-2 2h-.09a1.65 1.65 0 0 0-1.51 1z"></path></svg>'),QE=nt('<svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svelte-1aaflua"><rect x="9" y="9" width="13" height="13" rx="2" ry="2"></rect><path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"></path></svg>'),$E=nt('<svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svelte-1aaflua"><path d="M23 4v6h-6"></path><path d="M20.49 15a9 9 0 1 1-2.12-9.36L23 10"></path></svg>'),eI=nt('<svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svelte-1aaflua"><line x1="12" y1="5" x2="12" y2="19"></line><line x1="5" y1="12" x2="19" y2="12"></line></svg>'),tI=nt('<svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svelte-1aaflua"><path d="M8 3H5a2 2 0 0 0-2 2v3m18 0V5a2 2 0 0 0-2-2h-3m0 18h3a2 2 0 0 0 2-2v-3M3 16v3a2 2 0 0 0 2 2h3"></path></svg>'),nI=nt('<svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svelte-1aaflua"><rect x="3" y="3" width="18" height="18" rx="2" ry="2"></rect><path d="M9 12l2 2 4-4"></path></svg>'),iI=nt('<svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svelte-1aaflua"><path d="M3 7v6h6"></path><path d="M21 17a9 9 0 0 0-9-9 9 9 0 0 0-6 2.3L3 13"></path></svg>'),rI=nt('<svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svelte-1aaflua"><path d="M21 7v6h-6"></path><path d="M3 17a9 9 0 0 1 9-9 9 9 0 0 1 6 2.3L21 13"></path></svg>'),sI=nt('<svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svelte-1aaflua"><path d="M15 3h4a2 2 0 0 1 2 2v14a2 2 0 0 1-2 2h-4"></path><polyline points="10 17 15 12 10 7"></polyline><line x1="15" y1="12" x2="3" y2="12"></line></svg>'),aI=nt('<svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svelte-1aaflua"><path d="M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4"></path><polyline points="16 17 21 12 16 7"></polyline><line x1="21" y1="12" x2="9" y2="12"></line></svg>'),oI=nt('<svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svelte-1aaflua"><polygon points="13 2 3 14 12 14 11 22 21 10 12 10 13 2"></polygon></svg>'),lI=nt('<svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svelte-1aaflua"><rect x="3" y="3" width="7" height="7" rx="1"></rect><rect x="14" y="3" width="7" height="7" rx="1"></rect><rect x="3" y="14" width="7" height="7" rx="1"></rect><rect x="14" y="14" width="7" height="7" rx="1"></rect></svg>'),cI=nt('<svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svelte-1aaflua"><polyline points="4 7 4 4 20 4 20 7"></polyline><line x1="9" y1="20" x2="15" y2="20"></line><line x1="12" y1="4" x2="12" y2="20"></line></svg>'),uI=nt('<svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svelte-1aaflua"><line x1="12" y1="17" x2="12" y2="22"></line><path d="M5 17h14v-1.76a2 2 0 0 0-1.11-1.79l-1.78-.9A2 2 0 0 1 15 10.76V6h1a2 2 0 0 0 0-4H8a2 2 0 0 0 0 4h1v4.76a2 2 0 0 1-1.11 1.79l-1.78.9A2 2 0 0 0 5 15.24Z"></path></svg>'),dI=nt('<svg viewBox="0 0 24 24" fill="currentColor" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svelte-1aaflua"><line x1="12" y1="17" x2="12" y2="22"></line><path d="M5 17h14v-1.76a2 2 0 0 0-1.11-1.79l-1.78-.9A2 2 0 0 1 15 10.76V6h1a2 2 0 0 0 0-4H8a2 2 0 0 0 0 4h1v4.76a2 2 0 0 1-1.11 1.79l-1.78.9A2 2 0 0 0 5 15.24Z"></path></svg>'),fI=nt('<svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svelte-1aaflua"><line x1="18" y1="6" x2="6" y2="18"></line><line x1="6" y1="6" x2="18" y2="18"></line></svg>'),hI=nt('<svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svelte-1aaflua"><polyline points="20 6 9 17 4 12"></polyline></svg>'),pI=nt('<svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svelte-1aaflua"><circle cx="11" cy="11" r="8"></circle><line x1="21" y1="21" x2="16.65" y2="16.65"></line></svg>'),gI=nt('<svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svelte-1aaflua"><polyline points="6 9 12 15 18 9"></polyline></svg>'),mI=nt('<svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svelte-1aaflua"><polyline points="18 15 12 9 6 15"></polyline></svg>'),vI=nt('<svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svelte-1aaflua"><polyline points="9 18 15 12 9 6"></polyline></svg>'),yI=nt('<svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svelte-1aaflua"><polyline points="15 18 9 12 15 6"></polyline></svg>'),bI=nt('<svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svelte-1aaflua"><path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"></path><polyline points="7 10 12 15 17 10"></polyline><line x1="12" y1="15" x2="12" y2="3"></line></svg>'),wI=nt('<svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svelte-1aaflua"><path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"></path><polyline points="17 8 12 3 7 8"></polyline><line x1="12" y1="3" x2="12" y2="15"></line></svg>'),xI=nt('<svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svelte-1aaflua"><path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"></path><polyline points="17 8 12 3 7 8"></polyline><line x1="12" y1="3" x2="12" y2="15"></line><circle cx="22" cy="3" r="1.5" fill="currentColor" stroke="none"></circle></svg>'),_I=nt('<svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svelte-1aaflua"><polygon points="5 3 19 12 5 21 5 3"></polygon></svg>'),SI=nt('<svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svelte-1aaflua"><rect x="6" y="4" width="4" height="16"></rect><rect x="14" y="4" width="4" height="16"></rect></svg>'),kI=nt('<svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svelte-1aaflua"><rect x="3" y="3" width="18" height="18" rx="2" ry="2"></rect></svg>'),AI=nt('<svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svelte-1aaflua"><path d="M1 12s4-8 11-8 11 8 11 8-4 8-11 8-11-8-11-8z"></path><circle cx="12" cy="12" r="3"></circle></svg>'),NI=nt('<svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svelte-1aaflua"><path d="M17.94 17.94A10.07 10.07 0 0 1 12 20c-7 0-11-8-11-8a18.45 18.45 0 0 1 5.06-5.94M9.9 4.24A9.12 9.12 0 0 1 12 4c7 0 11 8 11 8a18.5 18.5 0 0 1-2.16 3.19m-6.72-1.07a3 3 0 1 1-4.24-4.24"></path><line x1="1" y1="1" x2="23" y2="23"></line></svg>'),CI=nt('<svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svelte-1aaflua"><polyline points="16 18 22 12 16 6"></polyline><polyline points="8 6 2 12 8 18"></polyline></svg>'),PI=nt('<svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svelte-1aaflua"><polyline points="4 17 10 11 4 5"></polyline><line x1="12" y1="19" x2="20" y2="19"></line></svg>'),EI=nt('<svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svelte-1aaflua"><circle cx="12" cy="12" r="10"></circle><line x1="12" y1="16" x2="12" y2="12"></line><line x1="12" y1="8" x2="12.01" y2="8"></line></svg>'),II=nt('<svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svelte-1aaflua"><path d="M10.29 3.86L1.82 18a2 2 0 0 0 1.71 3h16.94a2 2 0 0 0 1.71-3L13.71 3.86a2 2 0 0 0-3.42 0z"></path><line x1="12" y1="9" x2="12" y2="13"></line><line x1="12" y1="17" x2="12.01" y2="17"></line></svg>'),LI=nt('<svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svelte-1aaflua"><path d="M22 19a2 2 0 0 1-2 2H4a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h5l2 3h9a2 2 0 0 1 2 2z"></path></svg>'),MI=nt('<svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svelte-1aaflua"><path d="M13 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V9z"></path><polyline points="13 2 13 9 20 9"></polyline></svg>'),TI=nt('<svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svelte-1aaflua"><path d="M19 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h11l5 5v11a2 2 0 0 1-2 2z"></path><polyline points="17 21 17 13 7 13 7 21"></polyline><polyline points="7 3 7 8 15 8"></polyline></svg>'),DI=nt('<svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svelte-1aaflua"><rect x="2" y="4" width="20" height="16" rx="2" ry="2"></rect><path d="M6 8h.001"></path><path d="M10 8h.001"></path><path d="M14 8h.001"></path><path d="M18 8h.001"></path><path d="M8 12h.001"></path><path d="M12 12h.001"></path><path d="M16 12h.001"></path><path d="M7 16h10"></path></svg>'),OI=nt('<svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svelte-1aaflua"><path d="M18 13v6a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h6"></path><polyline points="15 3 21 3 21 9"></polyline><line x1="10" y1="14" x2="21" y2="3"></line></svg>'),FI=nt('<svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svelte-1aaflua"><line x1="3" y1="12" x2="21" y2="12"></line><line x1="3" y1="6" x2="21" y2="6"></line><line x1="3" y1="18" x2="21" y2="18"></line></svg>'),RI=nt('<svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svelte-1aaflua"><path d="M3 9l9-7 9 7v11a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z"></path><polyline points="9 22 9 12 15 12 15 22"></polyline></svg>'),BI=nt('<svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svelte-1aaflua"><path d="M4 19.5A2.5 2.5 0 0 1 6.5 17H20"></path><path d="M6.5 2H20v20H6.5A2.5 2.5 0 0 1 4 19.5v-15A2.5 2.5 0 0 1 6.5 2z"></path></svg>'),zI=nt('<svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svelte-1aaflua"><polygon points="12 2 2 7 12 12 22 7 12 2"></polygon><polyline points="2 17 12 22 22 17"></polyline><polyline points="2 12 12 17 22 12"></polyline></svg>'),qI=nt('<svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svelte-1aaflua"><polyline points="22 12 18 12 15 21 9 3 6 12 2 12"></polyline></svg>'),jI=nt('<svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svelte-1aaflua"><path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"></path><polyline points="14 2 14 8 20 8"></polyline><line x1="12" y1="18" x2="12" y2="12"></line><line x1="9" y1="15" x2="15" y2="15"></line></svg>'),HI=nt('<svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svelte-1aaflua"><line x1="2" y1="5" x2="8" y2="5"></line><line x1="5" y1="2" x2="5" y2="8"></line><path d="M13 5h8v16H5V13"></path></svg>'),UI=nt('<svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svelte-1aaflua"><rect x="2" y="8" width="20" height="8" rx="2"></rect></svg>'),WI=nt('<svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svelte-1aaflua"><circle cx="12" cy="12" r="10"></circle><path d="M9.09 9a3 3 0 0 1 5.83 1c0 2-3 3-3 3"></path><line x1="12" y1="17" x2="12.01" y2="17"></line></svg>'),VI=nt('<svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svelte-1aaflua"><path d="M21 12a9 9 0 1 1-6.219-8.56"></path></svg>'),GI=nt('<svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svelte-1aaflua"><circle cx="12" cy="12" r="5"></circle><line x1="12" y1="1" x2="12" y2="3"></line><line x1="12" y1="21" x2="12" y2="23"></line><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line><line x1="1" y1="12" x2="3" y2="12"></line><line x1="21" y1="12" x2="23" y2="12"></line><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line></svg>'),XI=nt('<svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svelte-1aaflua"><path d="M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"></path></svg>'),YI=nt('<svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svelte-1aaflua"><line x1="18" y1="20" x2="18" y2="10"></line><line x1="12" y1="20" x2="12" y2="4"></line><line x1="6" y1="20" x2="6" y2="14"></line></svg>'),KI=nt('<svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svelte-1aaflua"><rect x="3" y="12" width="4" height="9"></rect><rect x="10" y="8" width="4" height="13"></rect><rect x="17" y="4" width="4" height="17"></rect></svg>'),ZI=nt('<svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svelte-1aaflua"><rect x="3" y="3" width="18" height="18" rx="2"></rect><rect x="12" y="12" width="7" height="7" rx="1"></rect></svg>'),JI=nt('<svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svelte-1aaflua"><circle cx="11" cy="11" r="8"></circle><line x1="21" y1="21" x2="16.65" y2="16.65"></line><line x1="11" y1="8" x2="11" y2="14"></line><line x1="8" y1="11" x2="14" y2="11"></line></svg>'),QI=nt('<svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svelte-1aaflua"><circle cx="11" cy="11" r="8"></circle><line x1="21" y1="21" x2="16.65" y2="16.65"></line><line x1="8" y1="11" x2="14" y2="11"></line></svg>'),$I=nt('<svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svelte-1aaflua"><rect x="3" y="3" width="18" height="18" rx="2"></rect></svg>'),eL=nt('<svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svelte-1aaflua"><polygon points="5 4 15 12 5 20 5 4"></polygon><line x1="19" y1="5" x2="19" y2="19"></line></svg>'),tL=nt('<svg viewBox="0 0 24 24" fill="currentColor" stroke="none" class="svelte-1aaflua"><polygon points="5 3 19 12 5 21 5 3"></polygon></svg>'),nL=nt('<svg viewBox="0 0 24 24" fill="currentColor" stroke="none" class="svelte-1aaflua"><rect x="6" y="6" width="12" height="12" rx="1"></rect></svg>'),iL=nt('<svg viewBox="0 0 24 24" fill="currentColor" stroke="none" class="svelte-1aaflua"><path d="M5 4l10 8-10 8V4z"></path><rect x="17" y="5" width="3" height="14" rx="1"></rect></svg>'),rL=nt('<svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svelte-1aaflua"><path d="M12 2v4m0 12v4M4.93 4.93l2.83 2.83m8.48 8.48l2.83 2.83M2 12h4m12 0h4M4.93 19.07l2.83-2.83m8.48-8.48l2.83-2.83"></path></svg>'),sL=nt('<svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svelte-1aaflua"><rect x="8" y="2" width="8" height="4" rx="1" ry="1"></rect><path d="M16 4h2a2 2 0 0 1 2 2v14a2 2 0 0 1-2 2H6a2 2 0 0 1-2-2V6a2 2 0 0 1 2-2h2"></path></svg>'),aL=nt('<svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svelte-1aaflua"><line x1="8" y1="6" x2="21" y2="6"></line><line x1="8" y1="12" x2="21" y2="12"></line><line x1="8" y1="18" x2="21" y2="18"></line><line x1="3" y1="6" x2="3.01" y2="6"></line><line x1="3" y1="12" x2="3.01" y2="12"></line><line x1="3" y1="18" x2="3.01" y2="18"></line></svg>'),oL=nt('<svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svelte-1aaflua"><path d="M8 3H7a2 2 0 0 0-2 2v5a2 2 0 0 1-2 2 2 2 0 0 1 2 2v5a2 2 0 0 0 2 2h1"></path><path d="M16 3h1a2 2 0 0 1 2 2v5a2 2 0 0 0 2 2 2 2 0 0 0-2 2v5a2 2 0 0 1-2 2h-1"></path></svg>'),lL=nt('<svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svelte-1aaflua"><rect x="3" y="3" width="18" height="18" rx="2"></rect><line x1="3" y1="9" x2="21" y2="9"></line><line x1="3" y1="15" x2="21" y2="15"></line><line x1="9" y1="3" x2="9" y2="21"></line></svg>'),cL=nt('<svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svelte-1aaflua"><path d="M20.84 4.61a5.5 5.5 0 0 0-7.78 0L12 5.67l-1.06-1.06a5.5 5.5 0 0 0-7.78 7.78l1.06 1.06L12 21.23l7.78-7.78 1.06-1.06a5.5 5.5 0 0 0 0-7.78z"></path></svg>'),uL=nt('<svg viewBox="0 0 24 24" fill="currentColor" class="svelte-1aaflua"><path d="M12 0c-6.626 0-12 5.373-12 12 0 5.302 3.438 9.8 8.207 11.387.599.111.793-.261.793-.577v-2.234c-3.338.726-4.033-1.416-4.033-1.416-.546-1.387-1.333-1.756-1.333-1.756-1.089-.745.083-.729.083-.729 1.205.084 1.839 1.237 1.839 1.237 1.07 1.834 2.807 1.304 3.492.997.107-.775.418-1.305.762-1.604-2.665-.305-5.467-1.334-5.467-5.931 0-1.311.469-2.381 1.236-3.221-.124-.303-.535-1.524.117-3.176 0 0 1.008-.322 3.301 1.23.957-.266 1.983-.399 3.003-.404 1.02.005 2.047.138 3.006.404 2.291-1.552 3.297-1.23 3.297-1.23.653 1.653.242 2.874.118 3.176.77.84 1.235 1.911 1.235 3.221 0 4.609-2.807 5.624-5.479 5.921.43.372.823 1.102.823 2.222v3.293c0 .319.192.694.801.576 4.765-1.589 8.199-6.086 8.199-11.386 0-6.627-5.373-12-12-12z"></path></svg>'),dL=nt('<svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svelte-1aaflua"><line x1="5" y1="12" x2="19" y2="12"></line><polyline points="12 5 19 12 12 19"></polyline></svg>'),fL=nt('<svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svelte-1aaflua"><line x1="19" y1="12" x2="5" y2="12"></line><polyline points="12 19 5 12 12 5"></polyline></svg>'),hL=nt('<svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svelte-1aaflua"><path d="M21 16V8a2 2 0 0 0-1-1.73l-7-4a2 2 0 0 0-2 0l-7 4A2 2 0 0 0 3 8v8a2 2 0 0 0 1 1.73l7 4a2 2 0 0 0 2 0l7-4A2 2 0 0 0 21 16z"></path><polyline points="3.27 6.96 12 12.01 20.73 6.96"></polyline><line x1="12" y1="22.08" x2="12" y2="12"></line></svg>'),pL=nt('<svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svelte-1aaflua"><path d="M9 3h6"></path><path d="M10 3v6l-5 10h14l-5-10V3"></path></svg>'),gL=nt('<svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svelte-1aaflua"><path d="M19 17h2c.6 0 1-.4 1-1v-3c0-.9-.7-1.7-1.5-1.9C18.7 10.6 16 10 16 10s-1.3-1.4-2.2-2.3c-.5-.4-1.1-.7-1.8-.7H5c-.6 0-1.1.4-1.4.9l-1.5 2.8C1.4 11.3 1 12.1 1 13v3c0 .6.4 1 1 1h2"></path><circle cx="7" cy="17" r="2"></circle><path d="M9 17h6"></path><circle cx="17" cy="17" r="2"></circle></svg>'),mL=nt('<svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svelte-1aaflua"><rect x="3" y="3" width="18" height="18" rx="2" ry="2"></rect><circle cx="8.5" cy="8.5" r="1.5"></circle><polyline points="21 15 16 10 5 21"></polyline></svg>'),vL=nt('<svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svelte-1aaflua"><path d="M20.59 13.41l-7.17 7.17a2 2 0 0 1-2.83 0L2 12V2h10l8.59 8.59a2 2 0 0 1 0 2.82z"></path><line x1="7" y1="7" x2="7.01" y2="7"></line></svg>'),yL=nt('<svg viewBox="0 0 24 24" fill="currentColor" stroke="none" class="svelte-1aaflua"><text x="2" y="18" font-size="16" font-weight="700" font-family="system-ui, sans-serif">A</text><text x="14" y="18" font-size="16" font-weight="700" font-family="system-ui, sans-serif">a</text></svg>'),bL=nt('<svg viewBox="0 0 24 24" fill="currentColor" stroke="none" class="svelte-1aaflua"><text x="2" y="18" font-size="11" font-weight="700" font-family="system-ui, sans-serif">A</text><text x="10" y="18" font-size="11" font-weight="700" font-family="system-ui, sans-serif">a</text></svg>'),wL=Le('<span class="text-icon svelte-1aaflua"> </span>');function Ot(t,e){let n=ot(e,"size",3,14);var i=Je(),r=He(i);{var s=o=>{var l=ZE();Ae(()=>{he(l,"width",n()),he(l,"height",n())}),j(o,l)},a=o=>{var l=Je(),c=He(l);{var u=h=>{var d=JE();Ae(()=>{he(d,"width",n()),he(d,"height",n())}),j(h,d)},f=h=>{var d=Je(),y=He(d);{var m=w=>{var S=QE();Ae(()=>{he(S,"width",n()),he(S,"height",n())}),j(w,S)},x=w=>{var S=Je(),A=He(S);{var _=I=>{var T=$E();Ae(()=>{he(T,"width",n()),he(T,"height",n())}),j(I,T)},M=I=>{var T=Je(),D=He(T);{var O=C=>{var N=eI();Ae(()=>{he(N,"width",n()),he(N,"height",n())}),j(C,N)},W=C=>{var N=Je(),B=He(N);{var E=q=>{var Z=tI();Ae(()=>{he(Z,"width",n()),he(Z,"height",n())}),j(q,Z)},R=q=>{var Z=Je(),U=He(Z);{var X=le=>{var F=nI();Ae(()=>{he(F,"width",n()),he(F,"height",n())}),j(le,F)},de=le=>{var F=Je(),V=He(F);{var G=ae=>{var te=iI();Ae(()=>{he(te,"width",n()),he(te,"height",n())}),j(ae,te)},se=ae=>{var te=Je(),ue=He(te);{var pe=me=>{var Pe=rI();Ae(()=>{he(Pe,"width",n()),he(Pe,"height",n())}),j(me,Pe)},ge=me=>{var Pe=Je(),ke=He(Pe);{var Ge=Oe=>{var Ke=sI();Ae(()=>{he(Ke,"width",n()),he(Ke,"height",n())}),j(Oe,Ke)},K=Oe=>{var Ke=Je(),Be=He(Ke);{var Ee=Ue=>{var Ye=aI();Ae(()=>{he(Ye,"width",n()),he(Ye,"height",n())}),j(Ue,Ye)},at=Ue=>{var Ye=Je(),ut=He(Ye);{var Ft=ze=>{var ve=oI();Ae(()=>{he(ve,"width",n()),he(ve,"height",n())}),j(ze,ve)},be=ze=>{var ve=Je(),Ce=He(ve);{var Ie=et=>{var vt=lI();Ae(()=>{he(vt,"width",n()),he(vt,"height",n())}),j(et,vt)},rt=et=>{var vt=Je(),wt=He(vt);{var Nt=kt=>{var ct=cI();Ae(()=>{he(ct,"width",n()),he(ct,"height",n())}),j(kt,ct)},it=kt=>{var ct=Je(),yt=He(ct);{var st=Bt=>{var xt=uI();Ae(()=>{he(xt,"width",n()),he(xt,"height",n())}),j(Bt,xt)},gt=Bt=>{var xt=Je(),dt=He(xt);{var Ut=bn=>{var Ln=dI();Ae(()=>{he(Ln,"width",n()),he(Ln,"height",n())}),j(bn,Ln)},ai=bn=>{var Ln=Je(),ni=He(Ln);{var Ct=Hn=>{var Sn=fI();Ae(()=>{he(Sn,"width",n()),he(Sn,"height",n())}),j(Hn,Sn)},oi=Hn=>{var Sn=Je(),Mn=He(Sn);{var Pn=$e=>{var Pt=hI();Ae(()=>{he(Pt,"width",n()),he(Pt,"height",n())}),j($e,Pt)},qe=$e=>{var Pt=Je(),tn=He(Pt);{var Wt=Dt=>{var Jt=pI();Ae(()=>{he(Jt,"width",n()),he(Jt,"height",n())}),j(Dt,Jt)},Gt=Dt=>{var Jt=Je(),$t=He(Jt);{var wn=ii=>{var kn=gI();Ae(()=>{he(kn,"width",n()),he(kn,"height",n())}),j(ii,kn)},en=ii=>{var kn=Je(),En=He(kn);{var Bs=ss=>{var yr=mI();Ae(()=>{he(yr,"width",n()),he(yr,"height",n())}),j(ss,yr)},oa=ss=>{var yr=Je(),go=He(yr);{var Ir=xs=>{var ir=vI();Ae(()=>{he(ir,"width",n()),he(ir,"height",n())}),j(xs,ir)},mo=xs=>{var ir=Je(),vo=He(ir);{var cl=Xi=>{var rr=yI();Ae(()=>{he(rr,"width",n()),he(rr,"height",n())}),j(Xi,rr)},ul=Xi=>{var rr=Je(),ec=He(rr);{var li=Yi=>{var sr=bI();Ae(()=>{he(sr,"width",n()),he(sr,"height",n())}),j(Yi,sr)},la=Yi=>{var sr=Je(),Ta=He(sr);{var Ni=ar=>{var or=wI();Ae(()=>{he(or,"width",n()),he(or,"height",n())}),j(ar,or)},ui=ar=>{var or=Je(),dl=He(or);{var tc=as=>{var _s=xI();Ae(()=>{he(_s,"width",n()),he(_s,"height",n())}),j(as,_s)},lr=as=>{var _s=Je(),zs=He(_s);{var Lr=qs=>{var Mr=_I();Ae(()=>{he(Mr,"width",n()),he(Mr,"height",n())}),j(qs,Mr)},fl=qs=>{var Mr=Je(),Da=He(Mr);{var hl=Tr=>{var wr=SI();Ae(()=>{he(wr,"width",n()),he(wr,"height",n())}),j(Tr,wr)},br=Tr=>{var wr=Je(),yo=He(wr);{var pl=Ss=>{var js=kI();Ae(()=>{he(js,"width",n()),he(js,"height",n())}),j(Ss,js)},Yt=Ss=>{var js=Je(),Oa=He(js);{var ks=Hs=>{var As=AI();Ae(()=>{he(As,"width",n()),he(As,"height",n())}),j(Hs,As)},os=Hs=>{var As=Je(),Fa=He(As);{var Ra=Ns=>{var cr=NI();Ae(()=>{he(cr,"width",n()),he(cr,"height",n())}),j(Ns,cr)},ca=Ns=>{var cr=Je(),gl=He(cr);{var bo=Cs=>{var Ki=CI();Ae(()=>{he(Ki,"width",n()),he(Ki,"height",n())}),j(Cs,Ki)},Ba=Cs=>{var Ki=Je(),wo=He(Ki);{var ua=xr=>{var Wr=PI();Ae(()=>{he(Wr,"width",n()),he(Wr,"height",n())}),j(xr,Wr)},za=xr=>{var Wr=Je(),xo=He(Wr);{var _o=Zi=>{var cs=EI();Ae(()=>{he(cs,"width",n()),he(cs,"height",n())}),j(Zi,cs)},ls=Zi=>{var cs=Je(),da=He(cs);{var ml=P=>{var J=II();Ae(()=>{he(J,"width",n()),he(J,"height",n())}),j(P,J)},b=P=>{var J=Je(),fe=He(J);{var ye=We=>{var pt=LI();Ae(()=>{he(pt,"width",n()),he(pt,"height",n())}),j(We,pt)},Te=We=>{var pt=Je(),ht=He(pt);{var Rt=Vt=>{var _t=MI();Ae(()=>{he(_t,"width",n()),he(_t,"height",n())}),j(Vt,_t)},jt=Vt=>{var _t=Je(),hn=He(_t);{var gn=mn=>{var zn=TI();Ae(()=>{he(zn,"width",n()),he(zn,"height",n())}),j(mn,zn)},dn=mn=>{var zn=Je(),Bi=He(zn);{var Kn=Us=>{var Ps=DI();Ae(()=>{he(Ps,"width",n()),he(Ps,"height",n())}),j(Us,Ps)},ur=Us=>{var Ps=Je(),qa=He(Ps);{var So=Vr=>{var di=OI();Ae(()=>{he(di,"width",n()),he(di,"height",n())}),j(Vr,di)},ko=Vr=>{var di=Je(),Ao=He(di);{var No=Ws=>{var xi=FI();Ae(()=>{he(xi,"width",n()),he(xi,"height",n())}),j(Ws,xi)},nc=Ws=>{var xi=Je(),fa=He(xi);{var vl=Ji=>{var us=RI();Ae(()=>{he(us,"width",n()),he(us,"height",n())}),j(Ji,us)},qc=Ji=>{var us=Je(),ic=He(us);{var rc=ds=>{var zi=BI();Ae(()=>{he(zi,"width",n()),he(zi,"height",n())}),j(ds,zi)},ja=ds=>{var zi=Je(),Gr=He(zi);{var Ha=Xr=>{var Vs=zI();Ae(()=>{he(Vs,"width",n()),he(Vs,"height",n())}),j(Xr,Vs)},ha=Xr=>{var Vs=Je(),yl=He(Vs);{var bi=_r=>{var Sr=qI();Ae(()=>{he(Sr,"width",n()),he(Sr,"height",n())}),j(_r,Sr)},jc=_r=>{var Sr=Je(),sc=He(Sr);{var ac=Gs=>{var Yr=jI();Ae(()=>{he(Yr,"width",n()),he(Yr,"height",n())}),j(Gs,Yr)},oc=Gs=>{var Yr=Je(),Ua=He(Yr);{var Wa=Kr=>{var fs=HI();Ae(()=>{he(fs,"width",n()),he(fs,"height",n())}),j(Kr,fs)},Co=Kr=>{var fs=Je(),hs=He(fs);{var Xs=An=>{var Un=UI();Ae(()=>{he(Un,"width",n()),he(Un,"height",n())}),j(An,Un)},In=An=>{var Un=Je(),Ci=He(Un);{var pa=Es=>{var ga=WI();Ae(()=>{he(ga,"width",n()),he(ga,"height",n())}),j(Es,ga)},lc=Es=>{var ga=Je(),Qd=He(ga);{var $d=Po=>{var Eo=VI();Ae(()=>{he(Eo,"width",n()),he(Eo,"height",n())}),j(Po,Eo)},ef=Po=>{var Eo=Je(),tf=He(Eo);{var cc=Io=>{var Lo=GI();Ae(()=>{he(Lo,"width",n()),he(Lo,"height",n())}),j(Io,Lo)},nf=Io=>{var Lo=Je(),rf=He(Lo);{var sf=Mo=>{var To=XI();Ae(()=>{he(To,"width",n()),he(To,"height",n())}),j(Mo,To)},af=Mo=>{var To=Je(),Hu=He(To);{var Hc=Qi=>{var ma=YI();Ae(()=>{he(ma,"width",n()),he(ma,"height",n())}),j(Qi,ma)},Zr=Qi=>{var ma=Je(),Uc=He(ma);{var of=va=>{var Va=KI();Ae(()=>{he(Va,"width",n()),he(Va,"height",n())}),j(va,Va)},Wc=va=>{var Va=Je(),lf=He(Va);{var Uu=ya=>{var Ga=ZI();Ae(()=>{he(Ga,"width",n()),he(Ga,"height",n())}),j(ya,Ga)},Wu=ya=>{var Ga=Je(),Ap=He(Ga);{var Np=bl=>{var wl=JI();Ae(()=>{he(wl,"width",n()),he(wl,"height",n())}),j(bl,wl)},cf=bl=>{var wl=Je(),Cp=He(wl);{var Pp=Xa=>{var Ya=QI();Ae(()=>{he(Ya,"width",n()),he(Ya,"height",n())}),j(Xa,Ya)},Ep=Xa=>{var Ya=Je(),uc=He(Ya);{var Ip=Do=>{var xl=$I();Ae(()=>{he(xl,"width",n()),he(xl,"height",n())}),j(Do,xl)},Lp=Do=>{var xl=Je(),Mp=He(xl);{var Tp=Jr=>{var dr=eL();Ae(()=>{he(dr,"width",n()),he(dr,"height",n())}),j(Jr,dr)},Dp=Jr=>{var dr=Je(),ba=He(dr);{var Op=Qr=>{var $i=tL();Ae(()=>{he($i,"width",n()),he($i,"height",n())}),j(Qr,$i)},uf=Qr=>{var $i=Je(),Fp=He($i);{var Rp=Oo=>{var Fo=nL();Ae(()=>{he(Fo,"width",n()),he(Fo,"height",n())}),j(Oo,Fo)},df=Oo=>{var Fo=Je(),ff=He(Fo);{var Bp=wa=>{var Ys=iL();Ae(()=>{he(Ys,"width",n()),he(Ys,"height",n())}),j(wa,Ys)},Vc=wa=>{var Ys=Je(),Vu=He(Ys);{var zp=_l=>{var Sl=rL();Ae(()=>{he(Sl,"width",n()),he(Sl,"height",n())}),j(_l,Sl)},hf=_l=>{var Sl=Je(),qp=He(Sl);{var jp=kl=>{var Ro=sL();Ae(()=>{he(Ro,"width",n()),he(Ro,"height",n())}),j(kl,Ro)},Hp=kl=>{var Ro=Je(),Gc=He(Ro);{var Up=Bo=>{var g=aL();Ae(()=>{he(g,"width",n()),he(g,"height",n())}),j(Bo,g)},Wp=Bo=>{var g=Je(),v=He(g);{var k=z=>{var H=oL();Ae(()=>{he(H,"width",n()),he(H,"height",n())}),j(z,H)},L=z=>{var H=Je(),Y=He(H);{var ee=oe=>{var xe=lL();Ae(()=>{he(xe,"width",n()),he(xe,"height",n())}),j(oe,xe)},ie=oe=>{var xe=Je(),De=He(xe);{var ce=Ne=>{var je=cL();Ae(()=>{he(je,"width",n()),he(je,"height",n())}),j(Ne,je)},_e=Ne=>{var je=Je(),Me=He(je);{var Ve=tt=>{var Qe=uL();Ae(()=>{he(Qe,"width",n()),he(Qe,"height",n())}),j(tt,Qe)},Xe=tt=>{var Qe=Je(),zt=He(Qe);{var At=St=>{var un=dL();Ae(()=>{he(un,"width",n()),he(un,"height",n())}),j(St,un)},on=St=>{var un=Je(),Pi=He(un);{var ln=ft=>{var Wn=fL();Ae(()=>{he(Wn,"width",n()),he(Wn,"height",n())}),j(ft,Wn)},Lt=ft=>{var Wn=Je(),rn=He(Wn);{var xn=fi=>{var _i=hL();Ae(()=>{he(_i,"width",n()),he(_i,"height",n())}),j(fi,_i)},Zn=fi=>{var _i=Je(),hi=He(_i);{var fr=ri=>{var fn=pL();Ae(()=>{he(fn,"width",n()),he(fn,"height",n())}),j(ri,fn)},kr=ri=>{var fn=Je(),Tn=He(fn);{var pi=gi=>{var hr=gL();Ae(()=>{he(hr,"width",n()),he(hr,"height",n())}),j(gi,hr)},Dn=gi=>{var hr=Je(),wi=He(hr);{var Dr=si=>{var qi=mL();Ae(()=>{he(qi,"width",n()),he(qi,"height",n())}),j(si,qi)},qn=si=>{var qi=Je(),Ar=He(qi);{var $r=Ei=>{var ji=vL();Ae(()=>{he(ji,"width",n()),he(ji,"height",n())}),j(Ei,ji)},es=Ei=>{var ji=Je(),Vn=He(ji);{var ts=ps=>{var Or=yL();Ae(()=>{he(Or,"width",n()),he(Or,"height",n())}),j(ps,Or)},Is=ps=>{var Or=Je(),er=He(Or);{var Xc=xa=>{var Ls=bL();Ae(()=>{he(Ls,"width",n()),he(Ls,"height",n())}),j(xa,Ls)},Gu=xa=>{var Ls=wL(),Vp=ne(Ls,!0);Q(Ls),Ae(()=>Ht(Vp,e.name)),j(xa,Ls)};Se(er,xa=>{e.name==="font-size-decrease"?xa(Xc):xa(Gu,!1)},!0)}j(ps,Or)};Se(Vn,ps=>{e.name==="font-size-increase"?ps(ts):ps(Is,!1)},!0)}j(Ei,ji)};Se(Ar,Ei=>{e.name==="tag"?Ei($r):Ei(es,!1)},!0)}j(si,qi)};Se(wi,si=>{e.name==="image"?si(Dr):si(qn,!1)},!0)}j(gi,hr)};Se(Tn,gi=>{e.name==="car"?gi(pi):gi(Dn,!1)},!0)}j(ri,fn)};Se(hi,ri=>{e.name==="flask"?ri(fr):ri(kr,!1)},!0)}j(fi,_i)};Se(rn,fi=>{e.name==="box"?fi(xn):fi(Zn,!1)},!0)}j(ft,Wn)};Se(Pi,ft=>{e.name==="arrow-left"?ft(ln):ft(Lt,!1)},!0)}j(St,un)};Se(zt,St=>{e.name==="arrow-right"?St(At):St(on,!1)},!0)}j(tt,Qe)};Se(Me,tt=>{e.name==="github"?tt(Ve):tt(Xe,!1)},!0)}j(Ne,je)};Se(De,Ne=>{e.name==="heart"?Ne(ce):Ne(_e,!1)},!0)}j(oe,xe)};Se(Y,oe=>{e.name==="table"?oe(ee):oe(ie,!1)},!0)}j(z,H)};Se(v,z=>{e.name==="braces"?z(k):z(L,!1)},!0)}j(Bo,g)};Se(Gc,Bo=>{e.name==="list"?Bo(Up):Bo(Wp,!1)},!0)}j(kl,Ro)};Se(qp,kl=>{e.name==="clipboard"?kl(jp):kl(Hp,!1)},!0)}j(_l,Sl)};Se(Vu,_l=>{e.name==="crosshair"?_l(zp):_l(hf,!1)},!0)}j(wa,Ys)};Se(ff,wa=>{e.name==="skip-forward-filled"?wa(Bp):wa(Vc,!1)},!0)}j(Oo,Fo)};Se(Fp,Oo=>{e.name==="stop-filled"?Oo(Rp):Oo(df,!1)},!0)}j(Qr,$i)};Se(ba,Qr=>{e.name==="play-filled"?Qr(Op):Qr(uf,!1)},!0)}j(Jr,dr)};Se(Mp,Jr=>{e.name==="skip-forward"?Jr(Tp):Jr(Dp,!1)},!0)}j(Do,xl)};Se(uc,Do=>{e.name==="square"?Do(Ip):Do(Lp,!1)},!0)}j(Xa,Ya)};Se(Cp,Xa=>{e.name==="zoom-out"?Xa(Pp):Xa(Ep,!1)},!0)}j(bl,wl)};Se(Ap,bl=>{e.name==="zoom-in"?bl(Np):bl(cf,!1)},!0)}j(ya,Ga)};Se(lf,ya=>{e.name==="map"?ya(Uu):ya(Wu,!1)},!0)}j(va,Va)};Se(Uc,va=>{e.name==="bar-chart-2"?va(of):va(Wc,!1)},!0)}j(Qi,ma)};Se(Hu,Qi=>{e.name==="bar-chart"?Qi(Hc):Qi(Zr,!1)},!0)}j(Mo,To)};Se(rf,Mo=>{e.name==="moon"?Mo(sf):Mo(af,!1)},!0)}j(Io,Lo)};Se(tf,Io=>{e.name==="sun"?Io(cc):Io(nf,!1)},!0)}j(Po,Eo)};Se(Qd,Po=>{e.name==="loader"?Po($d):Po(ef,!1)},!0)}j(Es,ga)};Se(Ci,Es=>{e.name==="help-circle"?Es(pa):Es(lc,!1)},!0)}j(An,Un)};Se(hs,An=>{e.name==="spacebar"?An(Xs):An(In,!1)},!0)}j(Kr,fs)};Se(Ua,Kr=>{e.name==="new-canvas"?Kr(Wa):Kr(Co,!1)},!0)}j(Gs,Yr)};Se(sc,Gs=>{e.name==="file-plus"?Gs(ac):Gs(oc,!1)},!0)}j(_r,Sr)};Se(yl,_r=>{e.name==="activity"?_r(bi):_r(jc,!1)},!0)}j(Xr,Vs)};Se(Gr,Xr=>{e.name==="layers"?Xr(Ha):Xr(ha,!1)},!0)}j(ds,zi)};Se(ic,ds=>{e.name==="book"?ds(rc):ds(ja,!1)},!0)}j(Ji,us)};Se(fa,Ji=>{e.name==="home"?Ji(vl):Ji(qc,!1)},!0)}j(Ws,xi)};Se(Ao,Ws=>{e.name==="menu"?Ws(No):Ws(nc,!1)},!0)}j(Vr,di)};Se(qa,Vr=>{e.name==="external-link"?Vr(So):Vr(ko,!1)},!0)}j(Us,Ps)};Se(Bi,Us=>{e.name==="keyboard"?Us(Kn):Us(ur,!1)},!0)}j(mn,zn)};Se(hn,mn=>{e.name==="save"?mn(gn):mn(dn,!1)},!0)}j(Vt,_t)};Se(ht,Vt=>{e.name==="file"?Vt(Rt):Vt(jt,!1)},!0)}j(We,pt)};Se(fe,We=>{e.name==="folder"?We(ye):We(Te,!1)},!0)}j(P,J)};Se(da,P=>{e.name==="alert-triangle"?P(ml):P(b,!1)},!0)}j(Zi,cs)};Se(xo,Zi=>{e.name==="info"?Zi(_o):Zi(ls,!1)},!0)}j(xr,Wr)};Se(wo,xr=>{e.name==="terminal"?xr(ua):xr(za,!1)},!0)}j(Cs,Ki)};Se(gl,Cs=>{e.name==="code"?Cs(bo):Cs(Ba,!1)},!0)}j(Ns,cr)};Se(Fa,Ns=>{e.name==="eye-off"?Ns(Ra):Ns(ca,!1)},!0)}j(Hs,As)};Se(Oa,Hs=>{e.name==="eye"?Hs(ks):Hs(os,!1)},!0)}j(Ss,js)};Se(yo,Ss=>{e.name==="stop"?Ss(pl):Ss(Yt,!1)},!0)}j(Tr,wr)};Se(Da,Tr=>{e.name==="pause"?Tr(hl):Tr(br,!1)},!0)}j(qs,Mr)};Se(zs,qs=>{e.name==="play"?qs(Lr):qs(fl,!1)},!0)}j(as,_s)};Se(dl,as=>{e.name==="upload-plus"?as(tc):as(lr,!1)},!0)}j(ar,or)};Se(Ta,ar=>{e.name==="upload"?ar(Ni):ar(ui,!1)},!0)}j(Yi,sr)};Se(ec,Yi=>{e.name==="download"?Yi(li):Yi(la,!1)},!0)}j(Xi,rr)};Se(vo,Xi=>{e.name==="chevron-left"?Xi(cl):Xi(ul,!1)},!0)}j(xs,ir)};Se(go,xs=>{e.name==="chevron-right"?xs(Ir):xs(mo,!1)},!0)}j(ss,yr)};Se(En,ss=>{e.name==="chevron-up"?ss(Bs):ss(oa,!1)},!0)}j(ii,kn)};Se($t,ii=>{e.name==="chevron-down"?ii(wn):ii(en,!1)},!0)}j(Dt,Jt)};Se(tn,Dt=>{e.name==="search"?Dt(Wt):Dt(Gt,!1)},!0)}j($e,Pt)};Se(Mn,$e=>{e.name==="check"?$e(Pn):$e(qe,!1)},!0)}j(Hn,Sn)};Se(ni,Hn=>{e.name==="x"?Hn(Ct):Hn(oi,!1)},!0)}j(bn,Ln)};Se(dt,bn=>{e.name==="pin-filled"?bn(Ut):bn(ai,!1)},!0)}j(Bt,xt)};Se(yt,Bt=>{e.name==="pin"?Bt(st):Bt(gt,!1)},!0)}j(kt,ct)};Se(wt,kt=>{e.name==="type"?kt(Nt):kt(it,!1)},!0)}j(et,vt)};Se(Ce,et=>{e.name==="grid"?et(Ie):et(rt,!1)},!0)}j(ze,ve)};Se(ut,ze=>{e.name==="zap"?ze(Ft):ze(be,!1)},!0)}j(Ue,Ye)};Se(Be,Ue=>{e.name==="exit"?Ue(Ee):Ue(at,!1)},!0)}j(Oe,Ke)};Se(ke,Oe=>{e.name==="enter"?Oe(Ge):Oe(K,!1)},!0)}j(me,Pe)};Se(ue,me=>{e.name==="redo"?me(pe):me(ge,!1)},!0)}j(ae,te)};Se(V,ae=>{e.name==="undo"?ae(G):ae(se,!1)},!0)}j(le,F)};Se(U,le=>{e.name==="select-all"?le(X):le(de,!1)},!0)}j(q,Z)};Se(B,q=>{e.name==="maximize"?q(E):q(R,!1)},!0)}j(C,N)};Se(D,C=>{e.name==="plus"?C(O):C(W,!1)},!0)}j(I,T)};Se(A,I=>{e.name==="rotate"?I(_):I(M,!1)},!0)}j(w,S)};Se(y,w=>{e.name==="copy"?w(m):w(x,!1)},!0)}j(h,d)};Se(c,h=>{e.name==="settings"?h(u):h(f,!1)},!0)}j(o,l)};Se(r,o=>{e.name==="trash"?o(s):o(a,!1)})}j(t,i)}var xL=Le('<link rel="stylesheet"/>'),_L=Le('<div class="toolbar svelte-pxdwwx"><button class="toolbar-btn svelte-pxdwwx"><!></button> <button class="toolbar-btn svelte-pxdwwx"><!></button> <!></div>'),SL=Le('<textarea placeholder="Markdown with $math$..." spellcheck="false" class="svelte-pxdwwx"></textarea>'),kL=Le('<span class="placeholder svelte-pxdwwx">Double-click to add note...</span>'),AL=Le('<div class="rendered svelte-pxdwwx"><!></div>'),NL=Le('<div><!> <div class="annotation svelte-pxdwwx"><!> <!></div></div>');function CL(t,e){Mt(e,!0);let n=ot(e,"selected",3,!1),i=Fe(Rn(e.data.content||"")),r=Fe(Rn(e.data.color||il)),s=Fe(Rn(e.data.fontSize||qr.DEFAULT));const a=Re.annotations.subscribe(R=>{const q=R.get(e.id);q&&($(i,q.content||"",!0),$(r,q.color||il,!0),$(s,q.fontSize||qr.DEFAULT,!0))});let o=0;const l=H5.subscribe(R=>{R.id>o&&R.annotationId===e.id&&(o=R.id,$(f,!0))});Ai(()=>{a(),l()});let c=Fe(""),u=Fe(void 0),f=Fe(!1);pn(()=>{p(i)?WE(p(i)).then(R=>{$(c,R,!0)}):$(c,"")}),pn(()=>{p(f)&&p(u)&&(p(u).focus(),p(u).selectionStart=p(u).value.length)}),pn(()=>{n()||$(f,!1)});function h(){It.beginDrag()}function d(){It.endDrag()}function y(R){const q=R.target.value;Re.updateAnnotation(e.id,{content:q})}function m(R){if(R.key==="Escape"){$(f,!1),R.stopPropagation();return}R.stopPropagation()}function x(R){n()&&(R.target.closest(".color-picker-wrapper")||$(f,!0))}function w(R){It.mutate(()=>Re.updateAnnotation(e.id,{color:R}))}function S(){const R=Math.min(p(s)+qr.STEP,qr.MAX);It.mutate(()=>Re.updateAnnotation(e.id,{fontSize:R}))}function A(){const R=Math.max(p(s)-qr.STEP,qr.MIN);It.mutate(()=>Re.updateAnnotation(e.id,{fontSize:R}))}function _(R){const q=R.currentTarget;q.scrollHeight>q.clientHeight&&R.stopPropagation()}function M(R,q){const Z=Math.round(q.width/Fn)*Fn,U=Math.round(q.height/Fn)*Fn;It.mutate(()=>Re.updateAnnotation(e.id,{width:Math.max(100,Z),height:Math.max(50,U)}))}var I=NL();Zh("pxdwwx",R=>{var q=xL();Ae(Z=>he(q,"href",Z),[V1]),j(R,q)});let T;var D=ne(I);_C(D,{minWidth:100,minHeight:50,get isVisible(){return n()},onResizeEnd:M});var O=we(D,2);O.__dblclick=x;var W=ne(O);{var C=R=>{var q=_L(),Z=ne(q);Z.__click=S;var U=ne(Z);Ot(U,{name:"font-size-increase",size:14}),Q(Z),mt(Z,(F,V)=>Qt?.(F,V),()=>({text:"Increase font size",position:"top"}));var X=we(Z,2);X.__click=A;var de=ne(X);Ot(de,{name:"font-size-decrease",size:14}),Q(X),mt(X,(F,V)=>Qt?.(F,V),()=>({text:"Decrease font size",position:"top"}));var le=we(X,2);X1(le,{get currentColor(){return p(r)},get defaultColor(){return il},onSelect:w,popupPosition:"top",tooltipPosition:"top",get iconColor(){return p(r)},iconSize:14,variant:"ghost"}),Q(q),Ae(()=>{Z.disabled=p(s)>=qr.MAX,X.disabled=p(s)<=qr.MIN}),j(R,q)};Se(W,R=>{n()&&R(C)})}var N=we(W,2);{var B=R=>{var q=SL();I3(q),q.__input=y,q.__keydown=m,Fi(q,Z=>$(u,Z),()=>p(u)),Ae(()=>ms(q,p(i))),yn("focus",q,h),yn("blur",q,d),yn("wheel",q,_),j(R,q)},E=R=>{var q=AL(),Z=ne(q);{var U=de=>{var le=Je(),F=He(le);c1(F,()=>p(c)),j(de,le)},X=de=>{var le=kL();j(de,le)};Se(Z,de=>{p(i)?de(U):de(X,!1)})}Q(q),yn("wheel",q,_),j(R,q)};Se(N,R=>{p(f)?R(B):R(E,!1)})}Q(O),Q(I),Ae(()=>{T=Xt(I,1,"annotation-wrapper svelte-pxdwwx",null,T,{nodrag:p(f)}),Nn(I,`--annotation-color: ${p(r)??""}; --annotation-font-size: ${p(s)??""}px;`)}),j(t,I),Tt()}Xn(["dblclick","click","input","keydown"]);const ww={up:{x:0,y:-1},down:{x:0,y:1},left:{x:-1,y:0},right:{x:1,y:0}},PL={up:"down",down:"up",left:"right",right:"left"},Ul=bs.unit,Y1=0,K1=bs.unit,Gn=bs.unit,n2=bs.unit/2,EL=bs.unit/4,Zc=10;function i2(t,e){return(t+1e4)*20001+(e+1e4)}function Ur(t){return Math.round(t/Gn)}function r2(t){return t*Gn}function s2(t,e,n){const i={x:t.x-Ul,y:t.y-Ul,width:t.width+2*Ul,height:t.height+2*Ul};return{minGx:Ur(i.x-e),minGy:Ur(i.y-n),maxGx:Ur(i.x+i.width-e),maxGy:Ur(i.y+i.height-n)}}class IL{offsetX=0;offsetY=0;nodeObstacles=new Map;portStubObstacles=[];spatialHash=new Map;constructor(e){e&&this.initFromContext(e)}getBucketKey(e,n){const i=Math.floor(e/Zc),r=Math.floor(n/Zc);return i2(i,r)}getObstacleBuckets(e){const n=[],i=Math.floor(e.minGx/Zc),r=Math.floor(e.maxGx/Zc),s=Math.floor(e.minGy/Zc),a=Math.floor(e.maxGy/Zc);for(let o=i;o<=r;o++)for(let l=s;l<=a;l++)n.push(i2(o,l));return n}addToSpatialHash(e,n){for(const i of this.getObstacleBuckets(n))this.spatialHash.has(i)||this.spatialHash.set(i,new Set),this.spatialHash.get(i).add(e)}removeFromSpatialHash(e,n){for(const i of this.getObstacleBuckets(n))this.spatialHash.get(i)?.delete(e)}initFromContext(e){const{canvasBounds:n}=e;this.offsetX=Math.floor(n.x/Gn)*Gn,this.offsetY=Math.floor(n.y/Gn)*Gn,this.nodeObstacles.clear(),this.spatialHash.clear();for(const[i,r]of e.nodeBounds){const s=s2(r,this.offsetX,this.offsetY);this.nodeObstacles.set(i,s),this.addToSpatialHash(i,s)}this.updatePortStubs(e.portStubs)}updateBounds(e){this.offsetX=Math.floor(e.x/Gn)*Gn,this.offsetY=Math.floor(e.y/Gn)*Gn}updateNode(e,n){const i=this.nodeObstacles.get(e);i&&this.removeFromSpatialHash(e,i);const r=s2(n,this.offsetX,this.offsetY);this.nodeObstacles.set(e,r),this.addToSpatialHash(e,r)}removeNode(e){const n=this.nodeObstacles.get(e);n&&this.removeFromSpatialHash(e,n),this.nodeObstacles.delete(e)}updatePortStubs(e){if(this.portStubObstacles=[],e)for(const n of e){const i=ww[n.direction],r=n.position.x+i.x*Gn,s=n.position.y+i.y*Gn,a=Ur(r-this.offsetX),o=Ur(s-this.offsetY);this.portStubObstacles.push({minGx:a,minGy:o,maxGx:a,maxGy:o})}}isWalkableAt(e,n){const i=this.getBucketKey(e,n),r=this.spatialHash.get(i);if(r)for(const s of r){const a=this.nodeObstacles.get(s);if(a&&e>=a.minGx&&e<=a.maxGx&&n>=a.minGy&&n<=a.maxGy)return!1}for(const s of this.portStubObstacles)if(e>=s.minGx&&e<=s.maxGx&&n>=s.minGy&&n<=s.maxGy)return!1;return!0}getOffset(){return{x:this.offsetX,y:this.offsetY}}}const LL=2,ML=20,TL=2,DL=3,OL=1e4,FL={right:0,left:1,down:2,up:3},a2=[{dx:1,dy:0,dir:"right",dirIdx:0},{dx:-1,dy:0,dir:"left",dirIdx:1},{dx:0,dy:1,dir:"down",dirIdx:2},{dx:0,dy:-1,dir:"up",dirIdx:3}];function o2(t,e,n){return((t+1e4)*20001+(e+1e4))*4+n}function If(t,e){return(t+1e4)*20001+(e+1e4)}class RL{heap=[];index=new Map;push(e){e.heapIdx=this.heap.length,this.heap.push(e),this.index.set(e.stateKey,e),this.bubbleUp(e.heapIdx)}pop(){if(this.heap.length===0)return;const e=this.heap[0];this.index.delete(e.stateKey);const n=this.heap.pop();return this.heap.length>0&&(n.heapIdx=0,this.heap[0]=n,this.bubbleDown(0)),e}get length(){return this.heap.length}updateIfBetter(e,n,i,r){const s=this.index.get(e);return s&&n<s.g?(s.g=n,s.f=n+s.h,s.parent=r,this.bubbleUp(s.heapIdx),!0):!1}has(e){return this.index.has(e)}bubbleUp(e){const n=this.heap;for(;e>0;){const i=e-1>>1;if(n[e].f>=n[i].f)break;this.swap(e,i),e=i}}bubbleDown(e){const n=this.heap,i=n.length;for(;;){const r=2*e+1,s=2*e+2;let a=e;if(r<i&&n[r].f<n[a].f&&(a=r),s<i&&n[s].f<n[a].f&&(a=s),a===e)break;this.swap(e,a),e=a}}swap(e,n){const i=this.heap,r=i[e],s=i[n];i[e]=s,i[n]=r,r.heapIdx=n,s.heapIdx=e}}function Dm(t,e,n,i,r,s){const a=Ur(t.x-i.x),o=Ur(t.y-i.y),l=Ur(e.x-i.x),c=Ur(e.y-i.y),u=Ur(i.x),f=Ur(i.y),h=new Set;h.add(If(a,o)),h.add(If(l,c));const d=a2.find(I=>I.dir===r);if(d)for(let I=1;I<=DL;I++)h.add(If(a+d.dx*I,o+d.dy*I));const y=(I,T)=>h.has(If(I,T))?!0:n.isWalkableAt(I,T),m=new RL,x=new Set,w=FL[r],S=o2(a,o,w),A=l2(a,o,l,c),_={x:a,y:o,g:0,h:A,f:A,parent:null,direction:r,dirIdx:w,stateKey:S,heapIdx:0};m.push(_);let M=0;for(;m.length>0&&M<OL;){M++;const I=m.pop();if(I.x===l&&I.y===c)return{path:BL(I,i),isFallback:!1};if(x.has(I.stateKey))continue;x.add(I.stateKey);const T=PL[I.direction],D=I.parent===null;for(const{dx:O,dy:W,dir:C,dirIdx:N}of a2){if(C===T||D&&C!==r)continue;const B=I.x+O,E=I.y+W;if(!y(B,E))continue;const R=o2(B,E,N);if(x.has(R))continue;let q=1;if(I.direction!==C&&(q+=LL),s){const U=B+u,X=E+f,de=s.get(`${U},${X}`);if(de){const F=C==="left"||C==="right"?de.has("up")||de.has("down"):de.has("left")||de.has("right");q+=F?TL:ML}}const Z=I.g+q;if(!m.updateIfBetter(R,Z,0,I)&&!m.has(R)){const U=l2(B,E,l,c);m.push({x:B,y:E,g:Z,h:U,f:Z+U,parent:I,direction:C,dirIdx:N,stateKey:R,heapIdx:0})}}}return r==="right"||r==="left"?{path:[t,{x:e.x,y:t.y},e],isFallback:!0}:{path:[t,{x:t.x,y:e.y},e],isFallback:!0}}function l2(t,e,n,i){return Math.abs(t-n)+Math.abs(e-i)}function BL(t,e){const n=[];let i=t;for(;i!==null;)n.push({x:r2(i.x)+e.x,y:r2(i.y)+e.y}),i=i.parent;return n.reverse(),n}function xw(t){if(t.length<3)return t;const e=[t[0]];for(let n=1;n<t.length-1;n++){const i=e[e.length-1],r=t[n],s=t[n+1],a=Math.sign(r.x-i.x),o=Math.sign(r.y-i.y),l=Math.sign(s.x-r.x),c=Math.sign(s.y-r.y);(a!==l||o!==c)&&e.push(r)}return e.push(t[t.length-1]),e}function Fh(t){return{x:Math.round(t.x/Gn)*Gn,y:Math.round(t.y/Gn)*Gn}}function Lu(t,e,n){const i=ww[e],r={x:t.x+i.x*n,y:t.y+i.y*n};return Fh(r)}function _w(t,e,n,i,r,s){const a=Lu(t,n,Y1),o=Lu(e,i,K1),l=r.getOffset(),c=Dm(a,o,r,l,n,s);return{path:xw(c.path),waypoints:[],isFallback:c.isFallback}}function zL(t,e,n="right",i="left"){const r=Lu(t,n,Y1),s=Lu(e,i,K1),a=[r];return r.x!==s.x&&r.y!==s.y&&(n==="right"||n==="left"?a.push(Fh({x:s.x,y:r.y})):a.push(Fh({x:r.x,y:s.y}))),a.push(s),{path:a,waypoints:[]}}function qL(t,e=2){const n=new Map;let i=0;for(let r=0;r<t.length-1;r++){const s=t[r],a=t[r+1],o=a.x-s.x,l=a.y-s.y;let c;Math.abs(o)>Math.abs(l)?c=o>0?"right":"left":c=l>0?"down":"up";const u=Ur(s.x),f=Ur(s.y),h=Ur(a.x),d=Ur(a.y),y=Math.min(u,h),m=Math.max(u,h),x=Math.min(f,d),w=Math.max(f,d);for(let S=y;S<=m;S++)for(let A=x;A<=w;A++)if(i++,i>e){const _=`${S},${A}`;n.has(_)||n.set(_,new Set),n.get(_).add(c)}}return n}function Sw(t,e){const n=e.x-t.x,i=e.y-t.y;return Math.abs(n)>Math.abs(i)?n>0?"right":"left":i>0?"down":"up"}function jL(t){if(t.length<2)return"right";const e=t[t.length-1],n=t[t.length-2];return Sw(n,e)}function HL(t,e,n,i,r,s,a){if(s.length===0)return _w(t,e,n,i,r,a);const o=r.getOffset(),l=[];let c=Lu(t,n,Y1),u=n,f=!1;for(let m=0;m<s.length;m++){const x=s[m],w=Fh(x.position),S=Dm(c,w,r,o,u,a);if(S.isFallback&&(f=!0),l.length===0?l.push(...S.path):S.path.length>0&&l.push(...S.path.slice(1)),c=w,S.path.length>=2)u=jL(S.path);else{const A=m<s.length-1?s[m+1].position:e;u=Sw(w,A)}}const h=Lu(e,i,K1),d=Dm(c,h,r,o,u,a);return d.isFallback&&(f=!0),l.length===0?l.push(...d.path):d.path.length>0&&l.push(...d.path.slice(1)),{path:xw(l),waypoints:s,isFallback:f}}function jo(t){return(t||[]).filter(e=>e.isUserWaypoint)}function Ho(t,e,n,i,r,s,a){return r?s.length>0?HL(t,e,n,i,r,s,a):_w(t,e,n,i,r,a):zL(t,e,n,i)}function c2(t,e,n,i,r){const s=r.map(a=>`${a.position.x},${a.position.y}`).join(";");return`${t.x},${t.y}|${e.x},${e.y}|${n}|${i}|${s}`}const UL=8,Jn=an({routes:new Map,context:null,grid:null,routeInputHashes:new Map});let Lf=0;const ki={subscribe:Jn.subscribe,setContext(t,e,n){const i={nodeBounds:t,canvasBounds:e,portStubs:n};Jn.update(r=>{let s=r.grid;if(!s)s=new IL(i);else{s.updateBounds(e);const a=new Set(t.keys()),o=new Set;if(r.context)for(const l of r.context.nodeBounds.keys())o.add(l);for(const[l,c]of t)s.updateNode(l,c);for(const l of o)a.has(l)||s.removeNode(l);s.updatePortStubs(n)}return{...r,context:i,grid:s}})},updateNodeBounds(t,e){Jn.update(n=>(n.grid&&n.grid.updateNode(t,e),n.context&&n.context.nodeBounds.set(t,e),n))},recalculateRoutesForNodes(t,e,n){const i=Ze(Jn);if(!i.grid)return;const r=e.filter(c=>t.has(c.sourceNodeId)||t.has(c.targetNodeId));if(r.length===0)return;const s=new Map,a=(c,u,f)=>{const h=`${c}:${u}:${f}`;return s.has(h)||s.set(h,n(c,u,f)),s.get(h)},o=new Map(i.routes),l=new Map(i.routeInputHashes);for(const c of r){const u=a(c.sourceNodeId,c.sourcePortIndex,!0),f=a(c.targetNodeId,c.targetPortIndex,!1);if(!u||!f)continue;const h=jo(c.waypoints),d=c2(u.position,f.position,u.direction,f.direction,h);if(d===i.routeInputHashes.get(c.id)&&o.has(c.id))continue;const y=Ho(u.position,f.position,u.direction,f.direction,i.grid,h);o.set(c.id,y),l.set(c.id,d)}Jn.update(c=>({...c,routes:o,routeInputHashes:l}))},getRoute(t){return Pa(Jn,e=>e.routes.get(t)||null)},getRouteSync(t){return Ze(Jn).routes.get(t)||null},calcRoute(t,e,n,i="right",r="left"){const s=Ze(Jn),a=jo(t.waypoints),o=Ho(e,n,i,r,s.grid,a);return Jn.update(l=>{const c=new Map(l.routes);return c.set(t.id,o),{...l,routes:c}}),o},recalculateAllRoutes(t,e){const n=Ze(Jn),i=++Lf,r=new Map,s=(f,h,d)=>{const y=`${f}:${h}:${d}`;return r.has(y)||r.set(y,e(f,h,d)),r.get(y)},a=new Map(n.routes),o=new Map,l=[...t].sort((f,h)=>{const d=s(f.sourceNodeId,f.sourcePortIndex,!0),y=s(f.targetNodeId,f.targetPortIndex,!1),m=s(h.sourceNodeId,h.sourcePortIndex,!0),x=s(h.targetNodeId,h.targetPortIndex,!1),w=d&&y?Math.abs(y.position.x-d.position.x)+Math.abs(y.position.y-d.position.y):0;return(m&&x?Math.abs(x.position.x-m.position.x)+Math.abs(x.position.y-m.position.y):0)-w}),c=new Map;for(const f of l){const h=`${f.sourceNodeId}:${f.sourcePortIndex}`,d=c.get(h)||[];d.push(f),c.set(h,d)}const u=[];for(const[,f]of c)u.push(...f);for(const f of u){const h=s(f.sourceNodeId,f.sourcePortIndex,!0),d=s(f.targetNodeId,f.targetPortIndex,!1);if(!h||!d)continue;const y=jo(f.waypoints),m=Ho(h.position,d.position,h.direction,d.direction,n.grid,y);a.set(f.id,m),o.set(f.id,c2(h.position,d.position,h.direction,d.direction,y))}Jn.update(f=>({...f,routes:a,routeInputHashes:o})),u.length>1&&this._refineRoutesAsync(i,u,c,s,o)},async _refineRoutesAsync(t,e,n,i,r){const s=new Map,a=new Map;let o=0;for(const[,l]of n){const c=[];for(const u of l){if(t!==Lf)return;const f=Ze(Jn),h=i(u.sourceNodeId,u.sourcePortIndex,!0),d=i(u.targetNodeId,u.targetPortIndex,!1);if(!h||!d)continue;const y=jo(u.waypoints),m=Ho(h.position,d.position,h.direction,d.direction,f.grid,y,s);if(a.set(u.id,m),m.path.length>0&&c.push(qL(m.path,2)),o++,o%UL===0&&(await new Promise(x=>requestAnimationFrame(()=>x())),t!==Lf))return}for(const u of c)for(const[f,h]of u){s.has(f)||s.set(f,new Set);for(const d of h)s.get(f).add(d)}}t===Lf&&Jn.update(l=>{const c=new Map(l.routes);for(const[u,f]of a)c.set(u,f);return{...l,routes:c,routeInputHashes:new Map(r)}})},invalidateRoute(t){Jn.update(e=>{const n=new Map(e.routes),i=new Map(e.routeInputHashes);return n.delete(t),i.delete(t),{...e,routes:n,routeInputHashes:i}})},invalidateRoutesForNodes(t){const n=Ze(Re.connections).filter(i=>t.has(i.sourceNodeId)||t.has(i.targetNodeId));Jn.update(i=>{const r=new Map(i.routes),s=new Map(i.routeInputHashes);for(const a of n)r.delete(a.id),s.delete(a.id);return{...i,routes:r,routeInputHashes:s}})},addUserWaypoint(t,e,n){let i=null;return It.mutate(()=>{const s=Ze(Re.connections).find(c=>c.id===t);if(!s)return;i=nr();const a={id:i,position:e,isUserWaypoint:!0},l=[...jo(s.waypoints),a];if(Re.updateConnectionWaypoints(t,l),n){const c=Ze(Jn),u=n(s.sourceNodeId,s.sourcePortIndex,!0),f=n(s.targetNodeId,s.targetPortIndex,!1);if(u&&f){const h=Ho(u.position,f.position,u.direction,f.direction,c.grid,l);Jn.update(d=>{const y=new Map(d.routes);return y.set(t,h),{...d,routes:y}});return}}ki.invalidateRoute(t)}),i},addUserWaypointAtIndex(t,e,n,i){let r=null;return It.mutate(()=>{const a=Ze(Re.connections).find(u=>u.id===t);if(!a)return;r=nr();const o={id:r,position:e,isUserWaypoint:!0},l=jo(a.waypoints),c=[...l.slice(0,n),o,...l.slice(n)];if(Re.updateConnectionWaypoints(t,c),i){const u=Ze(Jn),f=i(a.sourceNodeId,a.sourcePortIndex,!0),h=i(a.targetNodeId,a.targetPortIndex,!1);if(f&&h){const d=Ho(f.position,h.position,f.direction,h.direction,u.grid,c);Jn.update(y=>{const m=new Map(y.routes);return m.set(t,d),{...y,routes:m}});return}}ki.invalidateRoute(t)}),r},removeUserWaypoint(t,e,n){It.mutate(()=>{const r=Ze(Re.connections).find(a=>a.id===t);if(!r?.waypoints)return;const s=r.waypoints.filter(a=>a.id!==e||!a.isUserWaypoint);if(Re.updateConnectionWaypoints(t,s),n){const a=Ze(Jn),o=n(r.sourceNodeId,r.sourcePortIndex,!0),l=n(r.targetNodeId,r.targetPortIndex,!1);if(o&&l){const c=jo(s),u=Ho(o.position,l.position,o.direction,l.direction,a.grid,c);Jn.update(f=>{const h=new Map(f.routes);return h.set(t,u),{...f,routes:h}});return}}ki.invalidateRoute(t)})},moveWaypoint(t,e,n,i){const s=Ze(Re.connections).find(o=>o.id===t);if(!s?.waypoints)return;const a=s.waypoints.map(o=>o.id===e?{...o,position:n}:o);if(Re.updateConnectionWaypoints(t,a),i){const o=Ze(Jn),l=i(s.sourceNodeId,s.sourcePortIndex,!0),c=i(s.targetNodeId,s.targetPortIndex,!1);if(l&&c){const u=jo(a),f=Ho(l.position,c.position,l.direction,c.direction,o.grid,u);Jn.update(h=>{const d=new Map(h.routes);return d.set(t,f),{...h,routes:d}});return}}ki.invalidateRoute(t)},cleanupWaypoints(t,e){const i=Ze(Re.connections).find(_=>_.id===t);if(!i?.waypoints)return;const r=jo(i.waypoints);if(r.length===0)return;let s=null,a=null;e&&(s=e(i.sourceNodeId,i.sourcePortIndex,!0),a=e(i.targetNodeId,i.targetPortIndex,!1));const o=s?.position||null,l=a?.position||null,c=15,u=5,f=(_,M,I)=>{const T=I.x-_.x,D=I.y-_.y,O=Math.sqrt(T*T+D*D);return O<1?!0:Math.abs((M.x-_.x)*D-(M.y-_.y)*T)/O<u},h=(_,M)=>Math.sqrt((_.x-M.x)**2+(_.y-M.y)**2);let d=[...r],y=!1;for(let _=d.length-1;_>0;_--)h(d[_].position,d[_-1].position)<c&&(d.splice(_,1),y=!0);const m=[];o&&m.push(o),m.push(...d.map(_=>_.position)),l&&m.push(l);const x=o?1:0,w=l?m.length-1:m.length,S=new Set;for(let _=x;_<w;_++){const M=o?_-1:_;if(M<0||M>=d.length)continue;const I=m[_-1],T=m[_],D=m[_+1];I&&D&&f(I,T,D)&&(S.add(M),y=!0)}const A=Array.from(S).sort((_,M)=>M-_);for(const _ of A)d.splice(_,1);if(y){Re.updateConnectionWaypoints(t,d);const _=Ze(Jn);if(s&&a){const M=Ho(s.position,a.position,s.direction,a.direction,_.grid,d);Jn.update(I=>{const T=new Map(I.routes);return T.set(t,M),{...I,routes:T}})}}},resetRoute(t){It.mutate(()=>{Re.updateConnectionWaypoints(t,[]),ki.invalidateRoute(t)})},clearRoutes(){Jn.update(t=>({...t,routes:new Map,routeInputHashes:new Map}))},clearContext(){Jn.update(t=>({...t,routes:new Map,routeInputHashes:new Map,context:null,grid:null}))}};function WL(t,e=100){const n=new Map;let i=1/0,r=1/0,s=-1/0,a=-1/0;for(const l of t){const c=l.measured?.width??l.width??80,u=l.measured?.height??l.height??40,f=l.position.x-c/2,h=l.position.y-u/2;n.set(l.id,{x:f,y:h,width:c,height:u}),i=Math.min(i,f-Ul),r=Math.min(r,h-Ul),s=Math.max(s,f+c+Ul),a=Math.max(a,h+u+Ul)}const o={x:i-e,y:r-e,width:s-i+2*e,height:a-r+2*e};return{nodeBounds:n,canvasBounds:o}}const ru=an(null);let Ii=null;ru.subscribe(t=>Ii=t);var VL=nt('<circle r="4"></circle>'),GL=nt('<circle r="3" class="segment-midpoint svelte-5viyfv"></circle>'),XL=nt('<g><!><g class="waypoint-group svelte-5viyfv"><!><!></g><g><path d="M -5 -2.5 L -1 -0.5 Q 0 0 -1 0.5 L -5 2.5 Q -6 3 -6 2 L -6 -2 Q -6 -3 -5 -2.5 Z"></path></g></g>');function YL(t,e){Mt(e,!0);function n(te){switch(te){case Kt.Left:return"left";case Kt.Right:return"right";case Kt.Top:return"up";case Kt.Bottom:return"down";default:return"right"}}function i(te,ue,pe){return pe&&te===e.source?{position:{x:e.sourceX,y:e.sourceY},direction:n(e.sourcePosition)}:!pe&&te===e.target?{position:{x:e.targetX,y:e.targetY},direction:n(e.targetPosition)}:null}let r=Fe(null);ru.subscribe(te=>$(r,te,!0));const s=re(()=>p(r)?.edgeId===e.id),a=re(()=>p(r)?.edgeId===e.id?p(r).waypointId:null);function o(te,ue){te.stopPropagation(),te.preventDefault();const pe=me=>{if(!Ii||Ii.edgeId!==e.id)return;me.stopPropagation(),me.preventDefault();const Pe=oo({x:me.clientX,y:me.clientY}),ke={x:Math.round(Pe.x/Gn)*Gn,y:Math.round(Pe.y/Gn)*Gn};ke.x===Ii.lastSnappedPos.x&&ke.y===Ii.lastSnappedPos.y||(Ii.lastSnappedPos=ke,ki.moveWaypoint(Ii.edgeId,Ii.waypointId,ke,Ii.getPortInfo))},ge=me=>{if(!Ii)return;me.stopPropagation(),me.preventDefault(),document.removeEventListener("pointermove",pe,{capture:!0}),document.removeEventListener("pointerup",ge,{capture:!0});const Pe=Ii;ru.set(null),It.endDrag(),ki.cleanupWaypoints(Pe.edgeId,Pe.getPortInfo)};ru.set({edgeId:e.id,waypointId:ue.id,lastSnappedPos:{...ue.position},getPortInfo:i,cleanup:()=>{document.removeEventListener("pointermove",pe,{capture:!0}),document.removeEventListener("pointerup",ge,{capture:!0})}}),It.beginDrag(),document.addEventListener("pointermove",pe,{capture:!0}),document.addEventListener("pointerup",ge,{capture:!0})}function l(te,ue){te.stopPropagation(),te.preventDefault(),ki.removeUserWaypoint(e.id,ue.id,i)}let c=Fe(null),u=null;pn(()=>{u&&u(),u=ki.getRoute(e.id).subscribe(te=>$(c,te,!0))});let f=Fe(null);const h=od.subscribe(te=>$(f,te,!0));let d=Fe(null);const y=Im.subscribe(te=>$(d,te,!0));Ai(()=>{u&&u(),h(),y()});const m=re(()=>()=>p(f)?e.source===p(f).nodeId&&e.sourceHandleId===p(f).handleId||e.target===p(f).nodeId&&e.targetHandleId===p(f).handleId:!1),x=re(()=>()=>p(d)?e.source===p(d).nodeId||e.target===p(d).nodeId:!1),w=re(()=>()=>p(m)()||p(x)()),S=re(()=>()=>p(m)()?p(f)?.color||"var(--accent)":p(x)()&&p(d)?.color||"var(--accent)"),A=.5,_=4.5,M=re(()=>()=>{let te=e.sourceX,ue=e.sourceY;return e.sourcePosition==="right"?te-=A:e.sourcePosition==="left"?te+=A:e.sourcePosition==="bottom"?ue-=A:e.sourcePosition==="top"&&(ue+=A),{x:te,y:ue}}),I=re(()=>()=>{let te=e.targetX,ue=e.targetY;return e.targetPosition==="right"?te+=_:e.targetPosition==="left"?te-=_:e.targetPosition==="bottom"?ue+=_:e.targetPosition==="top"&&(ue-=_),{x:te,y:ue}}),T=5;function D(te,ue){if(te.length<2)return"";if(te.length===2)return`M ${te[0].x} ${te[0].y} L ${te[1].x} ${te[1].y}`;let pe=`M ${te[0].x} ${te[0].y}`;for(let me=1;me<te.length-1;me++){const Pe=te[me-1],ke=te[me],Ge=te[me+1],K=Math.hypot(ke.x-Pe.x,ke.y-Pe.y),Oe=Math.hypot(Ge.x-ke.x,Ge.y-ke.y),Ke=Math.min(ue,K/2,Oe/2);if(Ke<.5){pe+=` L ${ke.x} ${ke.y}`;continue}const Be=(Pe.x-ke.x)/K,Ee=(Pe.y-ke.y)/K,at=(Ge.x-ke.x)/Oe,Ue=(Ge.y-ke.y)/Oe,Ye=ke.x+Be*Ke,ut=ke.y+Ee*Ke,Ft=ke.x+at*Ke,be=ke.y+Ue*Ke;pe+=` L ${Ye} ${ut} Q ${ke.x} ${ke.y} ${Ft} ${be}`}const ge=te[te.length-1];return pe+=` L ${ge.x} ${ge.y}`,pe}let O=Fe("");pn(()=>{if(p(c)?.path&&p(c).path.length>=1&&!p(c).isFallback){const te=p(M)(),ue=p(I)(),pe=[te,...p(c).path,ue];$(O,D(pe,T),!0)}});const W=re(()=>()=>{const te=p(M)(),ue=p(I)(),[pe]=sp({sourceX:te.x,sourceY:te.y,sourcePosition:e.sourcePosition,targetX:ue.x,targetY:ue.y,targetPosition:e.targetPosition,borderRadius:8});return pe}),C=re(()=>()=>p(O)?{path:p(O),isFallback:!1}:{path:p(W)(),isFallback:!0}),N=re(()=>()=>p(c)?.waypoints?p(c).waypoints.filter(ue=>ue.isUserWaypoint):e.data?.waypoints?.filter(ue=>ue.isUserWaypoint)||[]),B=re(()=>()=>{if(!p(c)?.path||p(c).path.length<1)return[];const te=p(M)(),ue=p(I)(),pe=[te,...p(c).path,ue],ge=p(N)(),me=20,Pe=(Ge,K)=>{for(const Oe of ge)if(Math.hypot(Oe.position.x-Ge,Oe.position.y-K)<me)return!0;return!1},ke=[];for(let Ge=0;Ge<pe.length-1;Ge++){const K=pe[Ge],Oe=pe[Ge+1];if(Math.hypot(Oe.x-K.x,Oe.y-K.y)>30){const Be=(K.x+Oe.x)/2,Ee=(K.y+Oe.y)/2;Pe(Be,Ee)||ke.push({x:Be,y:Ee,segmentIndex:Ge})}}return ke}),E=re(()=>()=>e.selected||p(s));function R(te,ue){te.stopPropagation(),te.preventDefault();const pe=oo({x:te.clientX,y:te.clientY}),ge={x:Math.round(pe.x/Gn)*Gn,y:Math.round(pe.y/Gn)*Gn},me=p(N)(),Pe=q(ue,me),ke=ki.addUserWaypointAtIndex(e.id,ge,Pe,i);if(ke){const Ge=Oe=>{if(!Ii||Ii.edgeId!==e.id)return;Oe.stopPropagation(),Oe.preventDefault();const Ke=oo({x:Oe.clientX,y:Oe.clientY}),Be={x:Math.round(Ke.x/Gn)*Gn,y:Math.round(Ke.y/Gn)*Gn};Be.x===Ii.lastSnappedPos.x&&Be.y===Ii.lastSnappedPos.y||(Ii.lastSnappedPos=Be,ki.moveWaypoint(Ii.edgeId,Ii.waypointId,Be,Ii.getPortInfo))},K=Oe=>{if(!Ii)return;Oe.stopPropagation(),Oe.preventDefault(),document.removeEventListener("pointermove",Ge,{capture:!0}),document.removeEventListener("pointerup",K,{capture:!0});const Ke=Ii;ru.set(null),It.endDrag(),ki.cleanupWaypoints(Ke.edgeId,Ke.getPortInfo)};ru.set({edgeId:e.id,waypointId:ke,lastSnappedPos:ge,getPortInfo:i,cleanup:()=>{document.removeEventListener("pointermove",Ge,{capture:!0}),document.removeEventListener("pointerup",K,{capture:!0})}}),It.beginDrag(),document.addEventListener("pointermove",Ge,{capture:!0}),document.addEventListener("pointerup",K,{capture:!0})}}function q(te,ue){if(ue.length===0||!p(c)?.path)return 0;const pe=p(M)(),ge=p(I)(),me=[pe,...p(c).path,ge],Pe=[0];for(let K=1;K<me.length;K++){const Oe=me[K-1],Ke=me[K];Pe.push(Pe[K-1]+Math.hypot(Ke.x-Oe.x,Ke.y-Oe.y))}const ke=(Pe[te]+Pe[te+1])/2;let Ge=0;for(const K of ue){let Oe=1/0,Ke=0;for(let Be=0;Be<me.length;Be++){const Ee=me[Be],at=Math.hypot(Ee.x-K.position.x,Ee.y-K.position.y);at<Oe&&(Oe=at,Ke=Pe[Be])}Ke<ke&&Ge++}return Ge}const Z=re(()=>()=>{const te=p(I)(),{isFallback:ue}=p(C)();if(!ue&&p(c)?.path&&p(c).path.length>=1){const ge=p(c).path,me=te,Pe=ge[ge.length-1],ke=me.x-Pe.x,Ge=me.y-Pe.y,K=Math.atan2(Ge,ke)*(180/Math.PI);return{x:me.x,y:me.y,angle:K}}const{path:pe}=p(C)();if(pe){const ge=document.createElementNS("http://www.w3.org/2000/svg","path");ge.setAttribute("d",pe);const me=ge.getTotalLength(),Pe=ge.getPointAtLength(me),ke=ge.getPointAtLength(me-5),Ge=Math.atan2(Pe.y-ke.y,Pe.x-ke.x)*(180/Math.PI);return{x:Pe.x,y:Pe.y,angle:Ge}}return{x:te.x,y:te.y,angle:0}});var U=XL();let X;var de=ne(U);{let te=re(()=>p(C)().path);Hd(de,{get id(){return e.id},get path(){return p(te)},get style(){return e.style}})}var le=we(de),F=ne(le);cn(F,17,()=>p(N)(),te=>te.id,(te,ue)=>{var pe=VL();let ge;pe.__pointerdown=me=>o(me,p(ue)),pe.__dblclick=me=>l(me,p(ue)),Ae(()=>{he(pe,"cx",p(ue).position.x),he(pe,"cy",p(ue).position.y),ge=Xt(pe,0,"waypoint-marker svelte-5viyfv",null,ge,{dragging:p(s)&&p(a)===p(ue).id})}),j(te,pe)});var V=we(F);cn(V,17,()=>p(B)(),te=>te.segmentIndex,(te,ue)=>{var pe=GL();pe.__pointerdown=ge=>R(ge,p(ue).segmentIndex),Ae(()=>{he(pe,"cx",p(ue).x),he(pe,"cy",p(ue).y)}),j(te,pe)}),Q(le);var G=we(le),se=ne(G);let ae;Q(G),Q(U),Ae((te,ue,pe,ge,me,Pe,ke,Ge)=>{Nn(U,`--highlight-color: ${te??""}`),X=Xt(U,0,"svelte-5viyfv",null,X,ue),Nn(le,`opacity: ${pe??""}; pointer-events: ${ge??""};`),he(G,"transform",`translate(${me??""}, ${Pe??""}) rotate(${ke??""}) translate(5, 0)`),ae=Xt(se,0,"edge-arrow svelte-5viyfv",null,ae,Ge)},[()=>p(S)(),()=>({highlighted:p(w)()}),()=>p(E)()?1:0,()=>p(E)()?"all":"none",()=>p(Z)().x,()=>p(Z)().y,()=>p(Z)().angle,()=>({selected:e.selected,highlighted:p(w)()})]),j(t,U),Tt()}Xn(["pointerdown","dblclick"]);let bg=null;const kw={registerDropHandler(t){bg=t},handleDrop(t){bg&&bg(t)}},Sa={nodeDuration:500,nodeStagger:50,flyDistanceMargin:100,edgeDuration:300,arrowDuration:150,initialDelay:100,fitViewDelay:50};function KL(){return typeof window>"u"?!1:new URLSearchParams(window.location.search).get("fancyloading")!=="false"}const Aw=an(0);let cu=new Map,Rh=new Map,yd=new Map,Vl=!1,na=null;function Nw(t){t.code==="Space"&&!t.repeat&&Vl&&(t.preventDefault(),Ew())}function Cw(t){if(!Vl)return;t.target.closest(".svelte-flow__pane")&&Ew()}function ZL(){window.addEventListener("keydown",Nw),document.addEventListener("click",Cw,!0)}function Pw(){window.removeEventListener("keydown",Nw),document.removeEventListener("click",Cw,!0)}function JL(){Aw.update(t=>t+1)}function Ew(){Vl&&(na&&(clearTimeout(na),na=null),Iw())}function QL(t,e,n,i){KL()&&((Vl||na)&&(na&&(clearTimeout(na),na=null),document.querySelectorAll(".assembling").forEach(r=>{r.classList.remove("assembling")}),Vl=!1,Pw()),document.body.classList.add("assembly-pending"),setTimeout(()=>{n(),setTimeout(()=>{const r=t(),s=e(),a=i();if(r.length===0){document.body.classList.remove("assembly-pending");return}$L(r,s,a),document.body.classList.remove("assembly-pending"),e7()},Sa.fitViewDelay)},Sa.initialDelay))}function $L(t,e,n){const i=[...t].sort(()=>Math.random()-.5),r=-n.x/n.zoom,s=-n.y/n.zoom,a=Sa.flyDistanceMargin,o=r-a,l=s-a;cu=new Map,Rh=new Map,i.forEach((h,d)=>{cu.set(h.id,d*Sa.nodeStagger),Rh.set(h.id,{x:o-h.x,y:l-h.y})}),yd=new Map,e.forEach(h=>{const d=cu.get(h.source)??0,y=cu.get(h.target)??0,m=Math.max(d,y)+Sa.nodeDuration*.7;yd.set(h.id,m)}),na&&(clearTimeout(na),na=null),Vl=!0,ZL();const c=i.length*Sa.nodeStagger,u=Math.max(...Array.from(yd.values()),0),f=Math.max(c,u)+Sa.nodeDuration+Sa.edgeDuration+Sa.arrowDuration+200;na=setTimeout(Iw,f)}function e7(){if(!Vl)return;const t=document.querySelectorAll(".svelte-flow__node"),e=document.querySelectorAll(".svelte-flow__edge");t.forEach(n=>{const i=n.getAttribute("data-id");if(!i)return;const r=cu.get(i)??0,s=Rh.get(i)??{x:0,y:-100},a=n;a.style.setProperty("--assembly-delay",`${r}ms`),a.style.setProperty("--assembly-duration",`${Sa.nodeDuration}ms`),a.style.setProperty("--fly-from-x",`${s.x}px`),a.style.setProperty("--fly-from-y",`${s.y}px`),n.classList.add("assembling")}),e.forEach(n=>{const i=n.getAttribute("data-id");if(!i)return;const r=yd.get(i)??0,s=n,a=n.querySelector("path.svelte-flow__edge-path");if(a){const o=a.getTotalLength();s.style.setProperty("--edge-length",`${o}`)}s.style.setProperty("--assembly-delay",`${r}ms`),s.style.setProperty("--assembly-duration",`${Sa.edgeDuration}ms`),n.classList.add("assembling")})}function Iw(){document.querySelectorAll(".assembling").forEach(t=>{t.classList.remove("assembling");const e=t;e.style.removeProperty("--assembly-delay"),e.style.removeProperty("--assembly-duration"),e.style.removeProperty("--fly-from-x"),e.style.removeProperty("--fly-from-y"),e.style.removeProperty("--edge-length")}),document.body.classList.remove("assembly-pending"),cu=new Map,Rh=new Map,yd=new Map,Vl=!1,na=null,Pw()}const wg={duration:300,flyDistanceMargin:100};function t7(t,e,n,i,r){let s,a;if(i&&r){const u=r(i);s=u.x-e.x,a=u.y-e.y}else{const u=n();s=-u.x/u.zoom-wg.flyDistanceMargin-e.x,a=0}let o=0;const l=20;function c(){const u=document.querySelector(`[data-id="${t}"]`);if(!u){o++,o<l&&requestAnimationFrame(c);return}u.style.translate=`${s}px ${a}px`,u.style.scale="0.8",u.style.opacity="0",u.style.setProperty("--fly-from-x",`${s}px`),u.style.setProperty("--fly-from-y",`${a}px`),u.style.setProperty("--assembly-duration",`${wg.duration}ms`),u.style.setProperty("--assembly-delay","0ms"),requestAnimationFrame(()=>{u.style.removeProperty("translate"),u.style.removeProperty("scale"),u.style.removeProperty("opacity"),u.classList.add("assembling"),setTimeout(()=>{u.classList.remove("assembling"),u.style.removeProperty("--fly-from-x"),u.style.removeProperty("--fly-from-y"),u.style.removeProperty("--assembly-duration"),u.style.removeProperty("--assembly-delay")},wg.duration+50)})}requestAnimationFrame(c)}const Om=[".blk",".sub",".pvm",".json"],Z1="1.0";function n7(t){const e=Ri.get(t.type),n=new Set(e?.params.map(r=>r.name)||[]),i={};for(const[r,s]of Object.entries(t.params))if(!(s==null||s==="")){if(r.startsWith("_")){i[r]=s;continue}n.has(r)&&(i[r]=s)}return i}function fp(t){const e={...t,params:n7(t)};return e.graph?.nodes&&(e.graph={...e.graph,nodes:e.graph.nodes.map(n=>fp(n))}),e}const ud=an(""),ed=an(null),xg=Pa(ud,t=>{const e=[],n=t.matchAll(/def\s+(\w+)\s*\(/g);for(const r of n)e.push(r[1]);const i=t.matchAll(/^(\w+)\s*=/gm);for(const r of i)e.push(r[1]);return[...new Set(e)]}),Os={code:{subscribe:ud.subscribe},lastError:{subscribe:ed.subscribe},definedNames:{subscribe:xg.subscribe},setCode(t){ud.set(t),ed.set(null)},getCode(){return Ze(ud)},setError(t){ed.set(t)},clearError(){ed.set(null)},hasName(t){return Ze(xg).includes(t)},getDefinedNames(){return Ze(xg)},clear(){ud.set(""),ed.set(null)}},hp={JSON:"application/json",CSV:"text/csv;charset=utf-8;",SVG:"image/svg+xml",PYTHON:"text/x-python"};function pp(t,e,n){const i=new Blob([t],{type:n}),r=URL.createObjectURL(i),s=document.createElement("a");s.href=r,s.download=e,document.body.appendChild(s),s.click(),document.body.removeChild(s),URL.revokeObjectURL(r)}function Lw(t,e){const n=typeof t=="string"?t:JSON.stringify(t,null,"	");pp(n,e,hp.JSON)}function Mw(t,e){pp(t,e,hp.CSV)}function i7(t,e){pp(t,e,hp.SVG)}function r7(t,e){pp(t,e,hp.PYTHON)}const J1={open:!1,options:null,resolve:null},gp=an(J1);function s7(t){return new Promise(e=>{gp.set({open:!0,options:{confirmText:"Confirm",cancelText:"Cancel",...t},resolve:e})})}function a7(){gp.update(t=>(t.resolve&&t.resolve(!0),J1))}function o7(){gp.update(t=>(t.resolve&&t.resolve(!1),J1))}const bd={subscribe:gp.subscribe,show:s7,confirm:a7,cancel:o7},Tw="pathview_autosave",l7=".pvm";let Mf=null,Md=null;const zu=an(null);function mp(){return"showSaveFilePicker"in window&&"showOpenFilePicker"in window}const c7={subscribe:zu.subscribe};function Dw(){let t=null;return zu.subscribe(e=>t=e)(),t}function u7(){Md=null,zu.set(null)}function vp(t){const{nodes:e,connections:n,annotations:i}=Re.toJSON(),r=vn.toJSON(),s=rs.get(),a=Os.getCode(),o=e.map(c=>fp(c)),l=Object.fromEntries(Object.entries(s).map(([c,u])=>[c,u===""?null:u]));return{version:SC,metadata:{created:new Date().toISOString(),modified:new Date().toISOString(),name:t||"Untitled"},graph:{nodes:o,connections:n,annotations:i},events:r,codeContext:{code:a},simulationSettings:l}}function d7(t){if(t.startsWith("pathsim.")){const e=t.split(".");return e[e.length-1]}return t}function f7(t){const e=n=>n.map(i=>{const r={...i,type:d7(i.type)};return r.graph&&(r.graph={nodes:e(r.graph.nodes||[]),connections:r.graph.connections||[],annotations:r.graph.annotations,events:r.graph.events}),r});return{...t,graph:t.graph?{...t.graph,nodes:e(t.graph.nodes||[])}:t.graph}}async function h7(t){if(t=f7(t),!t.version)throw new Error("Invalid file: missing version");if(uw(),Re.clear(),vn.clear(),yi.clear(),await ub(),Re.fromJSON(t.graph?.nodes||[],t.graph?.connections||[],t.graph?.annotations||[]),t.events&&t.events.length>0&&vn.fromJSON(t.events),t.codeContext?.code?Os.setCode(t.codeContext.code):Os.clear(),t.simulationSettings){const e=t.simulationSettings,n={...ns,solver:e.solver??ns.solver,ghostTraces:e.ghostTraces??ns.ghostTraces,plotResults:e.plotResults??ns.plotResults,adaptive:e.adaptive??ns.adaptive,duration:e.duration!=null?String(e.duration):ns.duration,dt:e.dt!=null?String(e.dt):ns.dt,rtol:e.rtol!=null?String(e.rtol):ns.rtol,atol:e.atol!=null?String(e.atol):ns.atol,ftol:e.ftol!=null?String(e.ftol):ns.ftol,dt_min:e.dt_min!=null?String(e.dt_min):ns.dt_min,dt_max:e.dt_max!=null?String(e.dt_max):ns.dt_max};rs.set(n)}else rs.reset();It.clear(),JL()}function Ow(){try{const t=vp("Autosave");localStorage.setItem(Tw,JSON.stringify(t))}catch(t){console.warn("Autosave failed:",t)}}function u2(t=500){Mf&&clearTimeout(Mf),Mf=setTimeout(()=>{Ow(),Mf=null},t)}function Fw(){localStorage.removeItem(Tw)}async function p7(){if(Md&&mp())try{const t=vp(Dw()||void 0),e=JSON.stringify(t,null,2),n=await Md.createWritable();return await n.write(e),await n.close(),!0}catch(t){console.warn("Failed to save to current file:",t)}return Rw()}async function Rw(){const t=(Dw()||"pathview_graph")+l7;if(mp())try{const e=await window.showSaveFilePicker({suggestedName:t,types:[{description:"PathView Model",accept:{"application/json":[".pvm",".json"]}}]}),n=e.name.replace(/\.(pvm|json)$/,""),i=vp(n),r=JSON.stringify(i,null,2),s=await e.createWritable();return await s.write(r),await s.close(),Md=e,zu.set(n),!0}catch(e){if(e.name==="AbortError")return!1;console.error("Failed to save file:",e)}return g7(t),!0}function g7(t){const e=t.replace(/\.(pvm|json)$/,""),n=vp(e);Lw(n,t),zu.set(e)}function m7(){uw(),Re.clear(),vn.clear(),Os.clear(),yi.clear(),rs.reset(),It.clear(),Fw(),u7()}function v7(t=3e4){const e=setInterval(Ow,t);return()=>clearInterval(e)}function y7(t){if(typeof t!="object"||t===null)return"unknown";const e=t;return"type"in e&&["block","subsystem","model"].includes(e.type)?"component":"graph"in e&&"version"in e?"legacy-model":"unknown"}function Bw(t,e){const n=JSON.parse(t),i=y7(n);if(i==="unknown")throw new Error("Invalid file format");return i==="legacy-model"?{version:Z1,type:"model",metadata:{name:n.metadata?.name||e.replace(/\.(json|pvm)$/,""),created:n.metadata?.created||new Date().toISOString(),modified:n.metadata?.modified||new Date().toISOString()},content:{graph:n.graph,events:n.events,codeContext:n.codeContext,simulationSettings:n.simulationSettings}}:n}function Bh(t){const e=[];for(const n of t){if(n.type===_n.SUBSYSTEM||n.type===_n.INTERFACE){n.graph?.nodes&&e.push(...Bh(n.graph.nodes));continue}Ri.has(n.type)||e.push(n.type),n.graph?.nodes&&e.push(...Bh(n.graph.nodes))}return[...new Set(e)]}function b7(t,e){const n=t.node,i=Bh([n]);if(i.length>0)throw new Error(`Unknown block type(s): ${i.join(", ")}`);const r=V5(n,e);return It.mutate(()=>{Re.clearSelection(),vn.clearSelection(),Re.pasteNodes([r],[])}),[r.id]}async function w7(t,e){if(Ze(Re.nodesArray).length>0&&!await bd.show({title:"Unsaved Changes",message:"Opening this file will discard your current work. Continue?",confirmText:"Discard & Open",cancelText:"Cancel"}))return{success:!1,type:"model",cancelled:!0};const i=t.content,r={version:t.version,metadata:t.metadata,graph:i.graph||{nodes:[],connections:[]},events:i.events,codeContext:i.codeContext||{code:""},simulationSettings:i.simulationSettings||ns};return await h7(r),Md=e.fileHandle||null,zu.set(e.fileName?.replace(/\.(pvm|json)$/,"")||t.metadata.name||null),{success:!0,type:"model"}}async function zw(t,e){switch(t.type){case"block":case"subsystem":{const n=e.position||{x:100,y:100},i=b7(t.content,n);return{success:!0,type:t.type,nodeIds:i}}case"model":return w7(t,e);default:return{success:!1,type:t.type,error:`Unknown component type: ${t.type}`}}}async function Fm(t,e={}){try{const n=await t.text(),i=Bw(n,t.name);return zw(i,{...e,fileName:e.fileName||t.name})}catch(n){return{success:!1,type:"model",error:n instanceof Error?n.message:"Unknown error"}}}async function x7(t,e={}){try{const n=await fetch(t);if(!n.ok)throw new Error(`Failed to fetch file: ${n.status} ${n.statusText}`);const i=await n.text(),r=e.fileName||t.split("/").pop()||"model.pvm",s=Bw(i,r);return zw(s,{...e,fileName:r})}catch(n){return{success:!1,type:"model",error:n instanceof Error?n.message:"Unknown error"}}}async function qw(t){if(mp())try{const[e]=await window.showOpenFilePicker({types:[{description:"PathView Files",accept:{"application/json":Om}}],multiple:!1}),n=await e.getFile();return Fm(n,{position:t,fileHandle:e,fileName:e.name})}catch(e){return e.name==="AbortError"?{success:!1,type:"model",cancelled:!0}:(console.error("Failed to open file:",e),{success:!1,type:"model",error:"Failed to open file. Make sure it is a valid PathView file."})}return new Promise(e=>{const n=document.createElement("input");n.type="file",n.accept=Om.join(","),n.onchange=async()=>{const i=n.files?.[0];if(!i){e({success:!1,type:"model",cancelled:!0});return}const r=await Fm(i,{position:t,fileName:i.name});e(r)},n.oncancel=()=>e({success:!1,type:"model",cancelled:!0}),n.click()})}function _7(t,e){Mt(e,!0),ot(e,"edges",19,()=>[]);const{getNodes:n,getEdges:i,fitView:r,zoomIn:s,zoomOut:a,getViewport:o,setViewport:l,screenToFlowPosition:c}=C5(),u=P5();function f(A,_=300){const M=n();if(M.length===0)return;let I=1/0,T=1/0,D=-1/0,O=-1/0;for(const ae of M){const te=ae.measured?.width??ae.width??160,ue=ae.measured?.height??ae.height??60,pe=ae.origin??[.5,.5],ge=ae.position.x-te*pe[0],me=ae.position.y-ue*pe[1];I=Math.min(I,ge),T=Math.min(T,me),D=Math.max(D,ge+te),O=Math.max(O,me+ue)}const W=20;I-=W,T-=W,D+=W,O+=W;const C=D-I,N=O-T,B=window.innerWidth,E=window.innerHeight,R=B-A.left-A.right,q=E-A.top-A.bottom;if(R<=0||q<=0){r({padding:.1,duration:_});return}const Z=R/C,U=q/N,X=Math.min(Z,U,1.5),de=(I+D)/2,le=(T+O)/2,F=A.left+R/2,V=A.top+q/2,G=F-de*X,se=V-le*X;l({x:G,y:se,zoom:X},{duration:_})}Du(()=>{setTimeout(()=>{const A=Ze(nh);f(A,300)},200),r8(c),kw.registerDropHandler(async A=>{const _=c({x:A.clientX,y:A.clientY}),M=A.dataTransfer?.files;if(M&&M.length>0){const D=M[0],O="."+D.name.split(".").pop()?.toLowerCase();if(Om.includes(O)){const W=await Fm(D,{position:{x:_.x-80,y:_.y-30},fileName:D.name});!W.success&&!W.cancelled&&W.error&&alert(`Failed to import: ${W.error}`);return}}const I=A.dataTransfer?.getData("application/pathview-node");if(I){const D=Math.round(_.x/Fn)*Fn,O=Math.round(_.y/Fn)*Fn;It.mutate(()=>{Re.addNode(I,{x:D,y:O})});return}const T=A.dataTransfer?.getData("application/pathview-event");if(T){const D={x:_.x-40,y:_.y-40};It.mutate(()=>{if(Re.isAtRoot())vn.addEvent(T,D);else{const O=ra.get(T);if(O){const W={id:crypto.randomUUID(),type:T,name:O.name,position:D,params:{}};Re.addSubsystemEvent(W)}}});return}})});let h=0;D5.subscribe(A=>{if(A>h){const _=Ze(nh);f(_,300),h=A}});let d=0;O5.subscribe(A=>{A>d&&(s({duration:200}),d=A)});let y=0;F5.subscribe(A=>{A>y&&(a({duration:200}),y=A)});let m=0;R5.subscribe(A=>{if(A.id>m){const _=o();l({x:_.x+A.x,y:_.y+A.y,zoom:_.zoom}),m=A.id}});let x=0;B5.subscribe(A=>{A.id>x&&A.nodeId&&(r({nodes:[{id:A.nodeId}],padding:.5,duration:300,maxZoom:1.5}),x=A.id)}),pn(()=>{e.pendingUpdates.length>0&&setTimeout(()=>{e.pendingUpdates.forEach(A=>{typeof u=="function"&&u(A)}),e.onUpdatesProcessed()},10)}),pn(()=>{const A=setInterval(()=>{n().forEach(M=>{if(M.position){const I=Re.getNode(M.id);I&&(Math.abs(I.position.x-M.position.x)>1||Math.abs(I.position.y-M.position.y)>1)&&Re.updateNodePosition(M.id,M.position)}})},2e3);return()=>clearInterval(A)});let w=0;Aw.subscribe(A=>{if(A>w){w=A;const _=Ze(nh);QL(()=>n().map(M=>({id:M.id,x:M.position.x,y:M.position.y})),()=>i().map(M=>({id:M.id,source:M.source,target:M.target})),()=>f(_,0),()=>{const M=o(),I=document.querySelector(".svelte-flow");return{zoom:M.zoom,x:M.x,y:M.y,width:I?.clientWidth??window.innerWidth,height:I?.clientHeight??window.innerHeight}})}});let S=0;U5.subscribe(A=>{A.id>S&&A.nodeId&&(S=A.id,t7(A.nodeId,A.position,()=>{const _=o(),M=document.querySelector(".svelte-flow");return{zoom:_.zoom,x:_.x,y:_.y,width:M?.clientWidth??window.innerWidth,height:M?.clientHeight??window.innerHeight}},A.cursorScreen,c))}),Tt()}function S7(){const t=new URL(window.location.href).searchParams.get("theme");if(t==="dark"||t==="light")return localStorage.setItem("pathview-theme",t),document.documentElement.setAttribute("data-theme",t),t;const e=localStorage.getItem("pathview-theme");return e==="light"||e==="dark"?e:window.matchMedia("(prefers-color-scheme: light)").matches?"light":"dark"}const dd=an(S7());dd.subscribe(t=>{document.documentElement.setAttribute("data-theme",t),localStorage.setItem("pathview-theme",t)});const al={subscribe:dd.subscribe,toggle(){dd.update(t=>t==="dark"?"light":"dark")},set(t){dd.set(t)},get(){let t="dark";return dd.subscribe(e=>t=e)(),t}},Za=an({open:!1,position:{x:0,y:0},target:null}),to={subscribe:Za.subscribe,openForNode(t,e){Za.set({open:!0,position:e,target:{type:"node",nodeId:t}})},openForEvent(t,e){Za.set({open:!0,position:e,target:{type:"event",eventId:t}})},openForSelection(t,e){Za.set({open:!0,position:e,target:{type:"selection",nodeIds:t}})},openForEdge(t,e){Za.set({open:!0,position:e,target:{type:"edge",edgeId:t}})},openForCanvas(t){Za.set({open:!0,position:t,target:{type:"canvas"}})},openForAnnotation(t,e){Za.set({open:!0,position:e,target:{type:"annotation",annotationId:t}})},openForPlot(t,e,n){Za.set({open:!0,position:n,target:{type:"plot",nodeId:t,plotEl:e}})},close(){Za.set({open:!1,position:{x:0,y:0},target:null})},getState(){return Ze(Za)}},Tf=an([]),d2={subscribe:Tf.subscribe,queueUpdate(t){Tf.update(e=>[...e,...t])},clear(){Tf.set([])},get(){return Ze(Tf)}};function k7(t){return{id:t.id,type:"eventNode",position:{...t.position},data:t,origin:[.5,.5],selectable:!0,draggable:!0,connectable:!1,deletable:!0}}function A7(t){return{id:t.id,type:"annotation",position:{...t.position},data:t,width:t.width,height:t.height,origin:[0,0],selectable:!0,draggable:!0,connectable:!1,deletable:!0}}function f2(t){return{id:t.id,source:t.sourceNodeId,sourceHandle:Eu.output(t.sourceNodeId,t.sourcePortIndex),target:t.targetNodeId,targetHandle:Eu.input(t.targetNodeId,t.targetPortIndex),type:"orthogonal",data:{waypoints:t.waypoints},selectable:!0,deletable:!0,animated:!1}}function Q1(t){return Re.getNode(t)?.params?._rotation||0}function N7(t){return(t+1)%4}function C7(t){return t===0?2:t===2?0:t}function P7(t){return t===1?3:t===3?1:t}function E7(t){const e=t.filter(n=>n.selected);return e.length===0?[]:It.mutate(()=>{const n=[];for(const i of e){const r=Q1(i.id),s=N7(r);Re.updateNodeParams(i.id,{_rotation:s}),n.push(i.id)}return n})}function I7(t){const e=t.filter(n=>n.selected);return e.length===0?[]:It.mutate(()=>{const n=[];for(const i of e){const r=Q1(i.id),s=C7(r);s!==r&&(Re.updateNodeParams(i.id,{_rotation:s}),n.push(i.id))}return n})}function L7(t){const e=t.filter(n=>n.selected);return e.length===0?[]:It.mutate(()=>{const n=[];for(const i of e){const r=Q1(i.id),s=P7(r);s!==r&&(Re.updateNodeParams(i.id,{_rotation:s}),n.push(i.id))}return n})}function M7(t){const n=Ze(Re.nodesArray).find(s=>s.id===t);if(!n)return null;const i=Ze(Re.connections),r=new Set(i.filter(s=>s.targetNodeId===t).map(s=>s.targetPortIndex));for(let s=0;s<n.inputs.length;s++)if(!r.has(s))return s;return null}var T7=Le('<div class="drop-zone-overlay svelte-5kezjk"><svg width="32" height="32" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"></path><polyline points="7 10 12 15 17 10"></polyline><line x1="12" y1="15" x2="12" y2="3"></line></svg></div>'),D7=Le("<!> <!>",1),O7=Le('<div class="flow-canvas svelte-5kezjk" role="application" aria-label="Flow canvas"><!> <!></div>');function F7(t,e){Mt(e,!0);let n=Fe("dark");const i=al.subscribe(be=>{$(n,be,!0)});let r=null;function s(){r!==null&&clearTimeout(r),r=setTimeout(()=>{r=null,I()},0)}let a={x:0,y:0};function o(be){a={x:be.clientX,y:be.clientY}}function l(be){if(E5(be))return;if(be.key==="Delete"){const Ce=p(N).filter(rt=>rt.selected),Ie=p(B).filter(rt=>rt.selected);(Ce.length>0||Ie.length>0)&&(be.preventDefault(),ae({nodes:Ce,edges:Ie}));return}if(be.key==="\\"){const Ce=p(B).find(Ie=>Ie.selected);if(Ce){be.preventDefault();const Ie=oo(a),rt=10,et=Math.round(Ie.x/rt)*rt,vt=Math.round(Ie.y/rt)*rt;ki.addUserWaypoint(Ce.id,{x:et,y:vt},M)}return}if(!p(N).some(Ce=>Ce.selected))return;let ve=[];be.key==="r"||be.key==="R"?(be.preventDefault(),ve=E7(p(N))):be.key==="x"||be.key==="X"?(be.preventDefault(),ve=I7(p(N))):(be.key==="y"||be.key==="Y")&&(be.preventDefault(),ve=L7(p(N))),ve.length>0&&($(u,[...ve],!0),setTimeout(()=>{const Ce=Ze(Re.connections);ki.recalculateRoutesForNodes(new Set(ve),Ce,M)},0))}let c=new Map,u=Fe(Rn([]));const f=d2.subscribe(be=>{be.length>0&&($(u,[...p(u),...be],!0),d2.clear())});s8(()=>p(N).some(be=>be.selected));let h=0;const d=z5.subscribe(be=>{be>h&&(h=be,$(N,p(N).map(ze=>({...ze,selected:!1})),!0),$(B,p(B).map(ze=>({...ze,selected:!1})),!0),Er.set(new Set),gg(new Set))});let y=0;const m=q5.subscribe(be=>{if(be.id>y){y=be.id;const ze={x:be.x,y:be.y};$(N,p(N).map(ve=>ve.selected?{...ve,position:{x:ve.position.x+ze.x,y:ve.position.y+ze.y}}:ve),!0),It.mutate(()=>{p(N).forEach(ve=>{ve.selected&&(ve.type==="eventNode"?Re.isAtRoot()?vn.updateEventPosition(ve.id,ve.position):Re.updateSubsystemEventPosition(ve.id,ve.position):ve.type==="annotation"?Re.updateAnnotationPosition(ve.id,ve.position):Re.updateNodePosition(ve.id,ve.position))})})}});let x=0;const w=j5.subscribe(be=>{if(be.id>x){x=be.id;const ze=new Set(be.nodeIds);$(N,p(N).map(ve=>ze.has(ve.id)?{...ve,selected:!0}:be.addToSelection?ve:{...ve,selected:!1}),!0),be.addToSelection||$(B,p(B).map(ve=>({...ve,selected:!1})),!0),S()}});function S(){const be=p(N).filter(Ce=>Ce.selected),ze=new Set,ve=new Set;be.forEach(Ce=>{Ce.type==="eventNode"?ve.add(Ce.id):Ce.type!=="annotation"&&ze.add(Ce.id)}),Er.set(ze),gg(ve)}const A=[i,f,d,m,w];Ai(()=>{A.forEach(be=>be()),r!==null&&clearTimeout(r)});function _(){$(u,[],!0)}function M(be,ze,ve){const Ce=p(E).get(be);if(!Ce)return null;const Ie=Ce.data,rt=ve?Ie.outputs:Ie.inputs;if(ze>=rt.length)return null;const et=Ie.params?._rotation||0,vt=Ce.measured?.width??Ce.width??80,wt=Ce.measured?.height??Ce.height??40,Nt=rt.length,it=20,ct=-((Nt-1)*it)/2+ze*it;let yt=Ce.position.x,st=Ce.position.y,gt;const Bt=ve?n2:n2+EL;if(ve)switch(et){case 1:yt+=ct,st+=wt/2+Bt,gt="down";break;case 2:yt-=vt/2+Bt,st+=ct,gt="left";break;case 3:yt+=ct,st-=wt/2+Bt,gt="up";break;default:yt+=vt/2+Bt,st+=ct,gt="right";break}else switch(et){case 1:yt+=ct,st-=wt/2+Bt,gt="up";break;case 2:yt+=vt/2+Bt,st+=ct,gt="right";break;case 3:yt+=ct,st+=wt/2+Bt,gt="down";break;default:yt-=vt/2+Bt,st+=ct,gt="left";break}return{position:{x:yt,y:st},direction:gt}}function I(){const be=p(N).filter(rt=>rt.type==="pathview");if(be.length===0){ki.clearRoutes();return}const{nodeBounds:ze,canvasBounds:ve}=WL(be),Ce=[];for(const rt of be){const et=rt.data;for(let vt=0;vt<et.inputs.length;vt++){const wt=M(rt.id,vt,!1);wt&&Ce.push({position:wt.position,direction:wt.direction})}for(let vt=0;vt<et.outputs.length;vt++){const wt=M(rt.id,vt,!0);wt&&Ce.push({position:wt.position,direction:wt.direction})}}ki.setContext(ze,ve,Ce);const Ie=Ze(Re.connections);ki.recalculateAllRoutes(Ie,M)}const T={pathview:qE,eventNode:UE,annotation:CL},D={orthogonal:YL};let O=Fe(Rn([])),W=Fe(Rn([])),C=Fe(Rn([])),N=Fe(Rn([])),B=Fe(Rn([])),E=re(()=>new Map(p(N).map(be=>[be.id,be])));pn(()=>{const be=ea(()=>new Map(p(N).map(ve=>[ve.id,ve]))),ze=It.isRestoringState();$(N,[...p(O),...p(W),...p(C)].map(ve=>{const Ce=be.get(ve.id);return Ce&&!ze?{...ve,position:Ce.position,selected:Ce.selected}:ve}),!0)});let R=!1,q=!1,Z=new Set;pn(()=>{const be=new Set(p(N).map(ve=>ve.id)),ze=[...Z].filter(ve=>!be.has(ve));ze.length>0&&!R&&(R=!0,ze.forEach(ve=>{const Ce=Re.getNode(ve),Ie=vn.getEvent(ve);!Ce&&!Ie&&c.delete(ve)}),R=!1),Z=be}),pn(()=>{R||p(N).forEach(be=>{if(be.type==="annotation"&&be.width&&be.height){const ze=Re.getAnnotation(be.id);ze&&(ze.width!==be.width||ze.height!==be.height)&&(R=!0,Re.updateAnnotation(be.id,{width:be.width,height:be.height}),R=!1)}})}),A.push(Re.nodes.subscribe(be=>{if(R)return;const ze=Array.from(be.values()),ve=[],Ce=new Map(p(N).map(it=>[it.id,it])),Ie=new Set(ze.map(it=>it.id)),rt=new Set(p(N).map(it=>it.id)),et=ze.some(it=>!rt.has(it.id)),vt=p(N).some(it=>!Ie.has(it.id)),wt=ze.some(it=>{const kt=Ce.get(it.id);if(!kt)return!1;const ct=kt.data,yt=c.get(it.id),st={inputs:it.inputs.length,outputs:it.outputs.length};return!!(yt&&(yt.inputs!==st.inputs||yt.outputs!==st.outputs)||ct.name!==it.name||ct.color!==it.color||JSON.stringify(ct.params)!==JSON.stringify(it.params)||JSON.stringify(ct.pinnedParams)!==JSON.stringify(it.pinnedParams))});if(!et&&!vt&&!wt&&q)return;const Nt=ze.map(it=>{const kt=Ce.get(it.id),ct=c.get(it.id),yt={inputs:it.inputs.length,outputs:it.outputs.length};if(ct&&(ct.inputs!==yt.inputs||ct.outputs!==yt.outputs)&&ve.push(it.id),c.set(it.id,yt),kt){const xt=kt.data?.params?._rotation??0,dt=it.params?._rotation??0;xt!==dt&&ve.push(it.id)}const st=kt&&!It.isRestoringState()?kt.position:{...it.position},gt=it.type===_n.INTERFACE;return kt?{id:kt.id,type:kt.type,position:st,data:it,origin:[.5,.5],selectable:kt.selectable,draggable:kt.draggable,deletable:!gt}:{id:it.id,type:"pathview",position:st,data:it,origin:[.5,.5],selectable:!0,draggable:!0,deletable:!gt}});for(const it of c.keys())Ie.has(it)||c.delete(it);$(O,Nt,!0),ve.length>0&&($(u,[...ve],!0),setTimeout(()=>{const it=Ze(Re.connections);ki.recalculateRoutesForNodes(new Set(ve),it,M)},0)),ze.length>0&&!q&&setTimeout(()=>{q=!0},100)}));let U=[],X=[],de=[];function le(){const be=U.length===0?X:de;$(W,be.map(k7),!0)}A.push(Re.currentPath.subscribe(be=>{U=be,le(),ki.clearContext()})),A.push(vn.eventsArray.subscribe(be=>{X=be,le()})),A.push(Re.subsystemEvents.subscribe(be=>{de=Array.from(be.values()),le()})),A.push(Re.annotations.subscribe(be=>{$(C,Array.from(be.values()).map(A7),!0)})),A.push(Re.connections.subscribe(be=>{if(R)return;const ze=new Map(p(B).map(ve=>[ve.id,ve.selected]));$(B,be.map(ve=>{const Ce=f2(ve);return ze.get(ve.id)&&(Ce.selected=!0),Ce}),!0),s()}));let F=new Map;function V({nodes:be}){It.beginDrag(),F.clear();for(const ze of be){const ve=Math.round(ze.position.x/Fn)*Fn,Ce=Math.round(ze.position.y/Fn)*Fn;F.set(ze.id,{x:ve,y:Ce})}}function G({nodes:be}){const ze=new Set;for(const ve of be){if(ve.type!=="pathview")continue;const Ce=Math.round(ve.position.x/Fn)*Fn,Ie=Math.round(ve.position.y/Fn)*Fn,rt=F.get(ve.id);if(!rt||rt.x!==Ce||rt.y!==Ie){F.set(ve.id,{x:Ce,y:Ie}),ze.add(ve.id);const et=ve.measured?.width??ve.width??80,vt=ve.measured?.height??ve.height??40;ki.updateNodeBounds(ve.id,{x:Ce-et/2,y:Ie-vt/2,width:et,height:vt})}}if(ze.size>0){const ve=Ze(Re.connections);ki.recalculateRoutesForNodes(ze,ve,M)}}function se({targetNode:be}){F.clear(),be?.id&&be?.position&&(R=!0,be.type==="eventNode"?Re.isAtRoot()?vn.updateEventPosition(be.id,be.position):Re.updateSubsystemEventPosition(be.id,be.position):be.type==="annotation"?Re.updateAnnotationPosition(be.id,be.position):Re.updateNodePosition(be.id,be.position),R=!1),It.endDrag(),I()}function ae({nodes:be,edges:ze}){if(be.length===0&&ze.length===0)return;R=!0,It.mutate(()=>{be.forEach(Ie=>{Ie.type==="eventNode"?Re.isAtRoot()?vn.getEvent(Ie.id)&&vn.removeEvent(Ie.id):Re.getSubsystemEvent(Ie.id)&&Re.removeSubsystemEvent(Ie.id):Ie.type==="annotation"?Re.getAnnotation(Ie.id)&&Re.removeAnnotation(Ie.id):Re.getNode(Ie.id)&&(Re.removeNode(Ie.id),c.delete(Ie.id))}),ze.forEach(Ie=>{const rt=Ze(Re.connections);let et=rt.find(vt=>vt.id===Ie.id);if(!et&&Ie.sourceHandle&&Ie.targetHandle){const vt=Ie.sourceHandle.match(/-output-(\d+)$/),wt=Ie.targetHandle.match(/-input-(\d+)$/);if(vt&&wt){const Nt=parseInt(vt[1],10),it=parseInt(wt[1],10);et=rt.find(kt=>kt.sourceNodeId===Ie.source&&kt.sourcePortIndex===Nt&&kt.targetNodeId===Ie.target&&kt.targetPortIndex===it)}}et&&Re.removeConnection(et.id)})});const ve=new Set(be.map(Ie=>Ie.id));$(O,p(O).filter(Ie=>!ve.has(Ie.id)),!0),$(W,p(W).filter(Ie=>!ve.has(Ie.id)),!0),$(C,p(C).filter(Ie=>!ve.has(Ie.id)),!0);const Ce=Ze(Re.connections);$(B,Ce.map(f2),!0),R=!1}function te(be){if(!be.source||!be.target||!be.sourceHandle||!be.targetHandle)return;const ze=be.sourceHandle.match(/-output-(\d+)$/),ve=be.targetHandle.match(/-input-(\d+)$/);ze&&ve&&It.mutate(()=>{const Ce=parseInt(ze[1],10);let Ie=parseInt(ve[1],10);if(Ze(Re.connections).some(vt=>vt.targetNodeId===be.target&&vt.targetPortIndex===Ie)){const vt=M7(be.target);if(vt!==null)Ie=vt;else{const Nt=Ze(Re.nodesArray).find(kt=>kt.id===be.target);if(!Nt)return;const it=Ri.get(Nt.type);if(!it||it.ports.maxInputs!==null)return;Re.addInputPort(be.target),Ie=Nt.inputs.length}}Re.addConnection(be.source,Ce,be.target,Ie)})}function ue({nodes:be}){const ze=new Set,ve=new Set;be?.forEach(Ce=>{Ce.type==="eventNode"?ve.add(Ce.id):ze.add(Ce.id)}),Er.set(ze),gg(ve)}let pe=Fe(!1),ge=0;function me(be){return be.dataTransfer?.types.includes("Files")??!1}function Pe(be){me(be)&&(ge++,$(pe,!0))}function ke(be){me(be)&&(ge--,ge===0&&$(pe,!1))}function Ge(be){be.preventDefault(),ge=0,$(pe,!1),kw.handleDrop(be)}function K(be){be.preventDefault(),be.dataTransfer&&(be.dataTransfer.dropEffect="copy")}let Oe;function Ke({event:be,node:ze}){if(be.preventDefault(),ze.type==="eventNode"){to.openForEvent(ze.id,{x:be.clientX,y:be.clientY});return}if(ze.type==="annotation"){to.openForAnnotation(ze.id,{x:be.clientX,y:be.clientY});return}const ve=p(N).filter(Ce=>Ce.selected);ve.length>1&&ve.some(Ce=>Ce.id===ze.id)?to.openForSelection(ve.map(Ce=>Ce.id),{x:be.clientX,y:be.clientY}):to.openForNode(ze.id,{x:be.clientX,y:be.clientY})}function Be({event:be,edge:ze}){be.preventDefault(),to.openForEdge(ze.id,{x:be.clientX,y:be.clientY})}function Ee({event:be}){be.preventDefault(),to.openForCanvas({x:be.clientX,y:be.clientY})}function at(be){be.target.closest(".svelte-flow__pane")&&rl()}var Ue=O7();yn("keydown",$n,l),Ue.__dblclick=at,Ue.__mousemove=o;var Ye=ne(Ue);{var ut=be=>{var ze=T7();j(be,ze)};Se(Ye,be=>{p(pe)&&be(ut)})}var Ft=we(Ye,2);fC(Ft,vh({get nodeTypes(){return T},get edgeTypes(){return D},onconnect:te,onnodedragstart:V,onnodedrag:G,onnodedragstop:se,ondelete:ae,onselectionchange:ue,ondrop:be=>Ge(be.event||be),ondragover:be=>K(be.event||be),onnodecontextmenu:Ke,onedgecontextmenu:Be,onpanecontextmenu:Ee,nodeOrigin:[.5,.5]},()=>({snapToGrid:!0,snapGrid:aE}),{deleteKeyCode:["Delete","Backspace"],selectionKeyCode:["Shift"],multiSelectionKeyCode:["Shift","Meta","Control"],get colorMode(){return p(n)},connectOnClick:!0,edgesReconnectable:!0,edgesFocusable:!0,edgesSelectable:!0,zoomOnDoubleClick:!1,elevateEdgesOnSelect:!1,proOptions:{hideAttribution:!0},get nodes(){return p(N)},set nodes(be){$(N,be,!0)},get edges(){return p(B)},set edges(be){$(B,be,!0)},children:(be,ze)=>{var ve=D7(),Ce=He(ve);_7(Ce,{get pendingUpdates(){return p(u)},onUpdatesProcessed:_});var Ie=we(Ce,2);bC(Ie,{get variant(){return nl.Dots},get gap(){return oE},size:1}),j(be,ve)},$$slots:{default:!0}})),Q(Ue),Fi(Ue,be=>Oe=be,()=>Oe),yn("dragover",Ue,K),yn("dragenter",Ue,Pe),yn("dragleave",Ue,ke),j(t,Ue),Tt()}Xn(["dblclick","mousemove"]);var R7=Le("<button> </button>"),B7=Le("<button> </button>"),z7=Le("<button> </button>"),q7=Le("<button> </button>"),j7=Le("<button> </button>"),H7=Le('<div class="simulation-panel svelte-makk3l"><div class="settings-grid svelte-makk3l"><div class="setting-item svelte-makk3l"><label for="duration" class="svelte-makk3l"><span>Duration</span> <span class="help-icon svelte-makk3l">?</span></label> <div class="input-with-unit svelte-makk3l"><input id="duration" type="text" class="code-input svelte-makk3l" spellcheck="false"/> <span class="unit svelte-makk3l">s</span></div></div> <div class="setting-item svelte-makk3l"><label for="dt" class="svelte-makk3l"><span>Time Step</span> <span class="help-icon svelte-makk3l">?</span></label> <div class="input-with-unit svelte-makk3l"><input id="dt" type="text" class="code-input svelte-makk3l" spellcheck="false"/> <span class="unit svelte-makk3l">s</span></div></div></div> <div class="solver-section svelte-makk3l"><span class="section-label svelte-makk3l">Solver</span> <div class="solver-matrix svelte-makk3l"><div class="matrix-header corner svelte-makk3l"></div> <div class="matrix-header col-header svelte-makk3l"><span>Adaptive</span> <span class="help-icon svelte-makk3l">?</span></div> <div class="matrix-header col-header svelte-makk3l"><span>Fixed</span> <span class="help-icon svelte-makk3l">?</span></div> <div class="matrix-header row-header svelte-makk3l"><span class="rotated-text svelte-makk3l">Explicit</span> <span class="help-icon svelte-makk3l">?</span></div> <div class="matrix-cell svelte-makk3l"></div> <div class="matrix-cell svelte-makk3l"></div> <div class="matrix-header row-header svelte-makk3l"><span class="rotated-text svelte-makk3l">Implicit</span> <span class="help-icon svelte-makk3l">?</span></div> <div class="matrix-cell svelte-makk3l"></div> <div class="matrix-cell svelte-makk3l"></div></div></div> <div class="settings-grid svelte-makk3l"><div class="setting-item svelte-makk3l"><label for="rtol" class="svelte-makk3l"><span>Rel. Tolerance</span> <span class="help-icon svelte-makk3l">?</span></label> <input id="rtol" type="text" class="code-input svelte-makk3l" spellcheck="false"/></div> <div class="setting-item svelte-makk3l"><label for="atol" class="svelte-makk3l"><span>Abs. Tolerance</span> <span class="help-icon svelte-makk3l">?</span></label> <input id="atol" type="text" class="code-input svelte-makk3l" spellcheck="false"/></div> <div class="setting-item svelte-makk3l"><label for="ftol" class="svelte-makk3l"><span>FP Tolerance</span> <span class="help-icon svelte-makk3l">?</span></label> <input id="ftol" type="text" class="code-input svelte-makk3l" spellcheck="false"/></div></div> <div class="settings-grid svelte-makk3l"><div class="setting-item svelte-makk3l"><label for="dt_min" class="svelte-makk3l"><span>Min Timestep</span> <span class="help-icon svelte-makk3l">?</span></label> <div class="input-with-unit svelte-makk3l"><input id="dt_min" type="text" class="code-input svelte-makk3l" spellcheck="false"/> <span class="unit svelte-makk3l">s</span></div></div> <div class="setting-item svelte-makk3l"><label for="dt_max" class="svelte-makk3l"><span>Max Timestep</span> <span class="help-icon svelte-makk3l">?</span></label> <div class="input-with-unit svelte-makk3l"><input id="dt_max" type="text" class="code-input svelte-makk3l" spellcheck="false"/> <span class="unit svelte-makk3l">s</span></div></div></div> <div class="setting-item full-width svelte-makk3l"><span class="setting-label svelte-makk3l"><span>Ghost Traces</span> <span class="help-icon svelte-makk3l">?</span></span> <div class="ghost-selector svelte-makk3l"></div></div></div>');function U7(t,e){Mt(e,!0);let n=Fe(Rn(rs.get()));const i=rs.subscribe(ve=>{$(n,ve,!0)});Ai(i);const r={adaptive:{explicit:["RKBS32","RKCK54"],implicit:["GEAR52A","ESDIRK43"]},fixed:{explicit:["SSPRK22","RK4"],implicit:["BDF2"]}},s={adaptive:"Automatically adjusts step size for accuracy and speed",fixed:"Uses constant step size (dt) throughout simulation",explicit:"Fast, direct computation. Best for non-stiff systems",implicit:"Solves equations iteratively. Handles stiff systems",duration:"Total simulation time in seconds",dt:"Initial/fixed time step size in seconds",rtol:"Relative error tolerance for adaptive solvers",atol:"Absolute error tolerance for adaptive solvers",ftol:"Fixed-point iteration tolerance for implicit solvers and algebraic loops",dt_min:"Minimum allowed timestep for adaptive solvers",dt_max:"Maximum allowed timestep for adaptive solvers",ghostTraces:"Number of previous simulation traces to show faded"};function a(ve,Ce){rs.update({[ve]:Ce})}function o(ve){a("solver",ve)}function l(ve){ve<p(n).ghostTraces&&XP(ve),a("ghostTraces",ve)}var c=H7(),u=ne(c),f=ne(u),h=ne(f),d=we(ne(h),2);mt(d,(ve,Ce)=>Qt?.(ve,Ce),()=>s.duration),Q(h);var y=we(h,2),m=ne(y);jr(m),m.__input=ve=>a("duration",ve.currentTarget.value),mt(m,ve=>Zs?.(ve)),Mi(2),Q(y),Q(f);var x=we(f,2),w=ne(x),S=we(ne(w),2);mt(S,(ve,Ce)=>Qt?.(ve,Ce),()=>s.dt),Q(w);var A=we(w,2),_=ne(A);jr(_),_.__input=ve=>a("dt",ve.currentTarget.value),mt(_,ve=>Zs?.(ve)),Mi(2),Q(A),Q(x),Q(u);var M=we(u,2),I=we(ne(M),2),T=we(ne(I),2),D=we(ne(T),2);mt(D,(ve,Ce)=>Qt?.(ve,Ce),()=>s.adaptive),Q(T);var O=we(T,2),W=we(ne(O),2);mt(W,(ve,Ce)=>Qt?.(ve,Ce),()=>s.fixed),Q(O);var C=we(O,2),N=we(ne(C),2);mt(N,(ve,Ce)=>Qt?.(ve,Ce),()=>s.explicit),Q(C);var B=we(C,2);cn(B,21,()=>r.adaptive.explicit,Cn,(ve,Ce)=>{var Ie=R7();let rt;Ie.__click=()=>o(p(Ce));var et=ne(Ie,!0);Q(Ie),Ae(()=>{rt=Xt(Ie,1,"solver-pill svelte-makk3l",null,rt,{selected:p(n).solver===p(Ce)}),Ht(et,p(Ce))}),j(ve,Ie)}),Q(B);var E=we(B,2);cn(E,21,()=>r.fixed.explicit,Cn,(ve,Ce)=>{var Ie=B7();let rt;Ie.__click=()=>o(p(Ce));var et=ne(Ie,!0);Q(Ie),Ae(()=>{rt=Xt(Ie,1,"solver-pill svelte-makk3l",null,rt,{selected:p(n).solver===p(Ce)}),Ht(et,p(Ce))}),j(ve,Ie)}),Q(E);var R=we(E,2),q=we(ne(R),2);mt(q,(ve,Ce)=>Qt?.(ve,Ce),()=>s.implicit),Q(R);var Z=we(R,2);cn(Z,21,()=>r.adaptive.implicit,Cn,(ve,Ce)=>{var Ie=z7();let rt;Ie.__click=()=>o(p(Ce));var et=ne(Ie,!0);Q(Ie),Ae(()=>{rt=Xt(Ie,1,"solver-pill svelte-makk3l",null,rt,{selected:p(n).solver===p(Ce)}),Ht(et,p(Ce))}),j(ve,Ie)}),Q(Z);var U=we(Z,2);cn(U,21,()=>r.fixed.implicit,Cn,(ve,Ce)=>{var Ie=q7();let rt;Ie.__click=()=>o(p(Ce));var et=ne(Ie,!0);Q(Ie),Ae(()=>{rt=Xt(Ie,1,"solver-pill svelte-makk3l",null,rt,{selected:p(n).solver===p(Ce)}),Ht(et,p(Ce))}),j(ve,Ie)}),Q(U),Q(I),Q(M);var X=we(M,2),de=ne(X),le=ne(de),F=we(ne(le),2);mt(F,(ve,Ce)=>Qt?.(ve,Ce),()=>s.rtol),Q(le);var V=we(le,2);jr(V),V.__input=ve=>a("rtol",ve.currentTarget.value),mt(V,ve=>Zs?.(ve)),Q(de);var G=we(de,2),se=ne(G),ae=we(ne(se),2);mt(ae,(ve,Ce)=>Qt?.(ve,Ce),()=>s.atol),Q(se);var te=we(se,2);jr(te),te.__input=ve=>a("atol",ve.currentTarget.value),mt(te,ve=>Zs?.(ve)),Q(G);var ue=we(G,2),pe=ne(ue),ge=we(ne(pe),2);mt(ge,(ve,Ce)=>Qt?.(ve,Ce),()=>s.ftol),Q(pe);var me=we(pe,2);jr(me),me.__input=ve=>a("ftol",ve.currentTarget.value),mt(me,ve=>Zs?.(ve)),Q(ue),Q(X);var Pe=we(X,2),ke=ne(Pe),Ge=ne(ke),K=we(ne(Ge),2);mt(K,(ve,Ce)=>Qt?.(ve,Ce),()=>s.dt_min),Q(Ge);var Oe=we(Ge,2),Ke=ne(Oe);jr(Ke),Ke.__input=ve=>a("dt_min",ve.currentTarget.value),mt(Ke,ve=>Zs?.(ve)),Mi(2),Q(Oe),Q(ke);var Be=we(ke,2),Ee=ne(Be),at=we(ne(Ee),2);mt(at,(ve,Ce)=>Qt?.(ve,Ce),()=>s.dt_max),Q(Ee);var Ue=we(Ee,2),Ye=ne(Ue);jr(Ye),Ye.__input=ve=>a("dt_max",ve.currentTarget.value),mt(Ye,ve=>Zs?.(ve)),Mi(2),Q(Ue),Q(Be),Q(Pe);var ut=we(Pe,2),Ft=ne(ut),be=we(ne(Ft),2);mt(be,(ve,Ce)=>Qt?.(ve,Ce),()=>s.ghostTraces),Q(Ft);var ze=we(Ft,2);cn(ze,20,()=>[0,1,2,3,4,5,6,7,8],Cn,(ve,Ce)=>{var Ie=j7();let rt;Ie.__click=()=>l(Ce);var et=ne(Ie,!0);Q(Ie),Ae(()=>{rt=Xt(Ie,1,"ghost-pill svelte-makk3l",null,rt,{active:p(n).ghostTraces===Ce}),Ht(et,Ce)}),j(ve,Ie)}),Q(ze),Q(ut),Q(c),Ae(()=>{ms(m,p(n).duration),he(m,"placeholder",Go.duration),ms(_,p(n).dt),he(_,"placeholder",Go.dt),ms(V,p(n).rtol),he(V,"placeholder",Go.rtol),ms(te,p(n).atol),he(te,"placeholder",Go.atol),ms(me,p(n).ftol),he(me,"placeholder",Go.ftol),ms(Ke,p(n).dt_min),he(Ke,"placeholder",Go.dt_min),ms(Ye,p(n).dt_max),he(Ye,"placeholder",Go.dt_max)}),j(t,c),Tt()}Xn(["input","click"]);function jw(t,e,n={}){const{multiLine:i=!1,indent:r="    ",skipInternal:s=!1}=n,a=[];for(const[o,l]of Object.entries(t))l==null||l===""||s&&o.startsWith("_")||e.has(o)&&a.push(`${o}=${l}`);return i&&a.length>0?`
`+a.map(o=>r+o).join(`,
`)+`
`:a.join(", ")}function W7(t,e){const n=new Map;for(const i of t){const r=e.get(i.sourceNodeId),s=e.get(i.targetNodeId);if(!r||!s)continue;const a=`${i.sourceNodeId}:${i.sourcePortIndex}`;n.has(a)||n.set(a,{sourceVar:r,sourcePort:i.sourcePortIndex,targets:[]}),n.get(a).targets.push({varName:s,port:i.targetPortIndex})}return n}function $1(t,e,n="    "){const i=[],r=W7(t,e);for(const{sourceVar:s,sourcePort:a,targets:o}of r.values()){const l=o.map(c=>`${c.varName}[${c.port}]`);i.push(`${n}Connection(${s}[${a}], ${l.join(", ")}),`)}return i}function zh(t,e,n="    "){const i=[];i.push(`${t} = [`);for(const r of e)i.push(`${n}${r},`);return i.push("]"),i}function lo(t){if(!t)return"";let e="";for(const n of t)/[a-zA-Z0-9_]/.test(n)?e+=n:n===" "&&(e+="_");return e&&/^[0-9]/.test(e)&&(e="n_"+e),e.toLowerCase()}function Js(t,e){const n=t[e];return n===""||n===null||n===void 0?Go[e]:n}function Td(t,e,n=!1){return jw(t,e,{multiLine:n,skipInternal:!0})}function e0(t,e,n=!1){return jw(t,e,{multiLine:n})}function Hw(t,e,n,i=!1){const r=[];for(const s of t){const a=ra.get(s.type);if(!a)continue;let o=lo(s.name);(!o||e.includes(o)||r.includes(o))&&(o=`event_${r.length}`),r.push(o);const l=new Set(a.params.map(u=>u.name)),c=e0(s.params,l,i);c?n.push(`${o} = ${a.eventClass}(${c})`):n.push(`${o} = ${a.eventClass}()`)}return r}function Uw(t,e,n,i="    "){n.push("sim = Simulation("),n.push(`${i}blocks,`),n.push(`${i}connections,`),e&&n.push(`${i}events,`),n.push(`${i}Solver=${Js(t,"solver")},`),n.push(`${i}dt=${Js(t,"dt")},`),n.push(`${i}dt_min=${Js(t,"dt_min")},`);const r=Js(t,"dt_max");r&&n.push(`${i}dt_max=${r},`),n.push(`${i}tolerance_lte_rel=${Js(t,"rtol")},`),n.push(`${i}tolerance_lte_abs=${Js(t,"atol")},`),n.push(`${i}tolerance_fpi=${Js(t,"ftol")},`),n.push(")")}function t0(t){const e=[];for(const n of t)e.push(n),ao(n)&&e.push(...t0(n.graph?.nodes??[]));return e}function Ww(t){const e=t0(t),n=new Map;for(const i of e){if(ao(i)||Ld(i))continue;const r=Ri.get(i.type);if(!r)continue;const s=NC[r.blockClass]||"pathsim.blocks";n.has(s)||n.set(s,new Set),n.get(s).add(r.blockClass)}return n}function yp(t,e,n,i,r="",s={}){const{formatted:a=!1}=s,o=t.graph?.nodes??[],l=t.graph?.connections??[],c=t.graph?.events??[];let u=lo(t.name);(!u||n.includes(u))&&(u=`subsystem_${n.length}`),n.push(u),e.set(t.id,u);const f=r+u+"_",h=o.filter(Ld),d=o.filter(S=>!Ld(S)),y=[],m=new Map;a&&(i.push(""),i.push(`# Subsystem: ${t.name}`));for(const S of h){const A=f+"interface";y.push(A),m.set(S.id,A),i.push(`${A} = Interface()`)}for(const S of d)if(ao(S))yp(S,m,y,i,f,s);else{const A=Ri.get(S.type);if(!A)continue;let _=f+lo(S.name);(!_||y.includes(_))&&(_=`${f}block_${y.length}`),y.push(_),m.set(S.id,_);const M=new Set(A.params.map(T=>T.name)),I=Td(S.params,M,a);I?i.push(`${_} = ${A.blockClass}(${I})`):i.push(`${_} = ${A.blockClass}()`)}for(const[S,A]of m)e.set(S,A);const x=[];if(c.length>0)for(const S of c){const A=ra.get(S.type);if(!A)continue;let _=f+lo(S.name);(!_||n.includes(_)||x.includes(_))&&(_=`${f}event_${x.length}`),x.push(_);const M=new Set(A.params.map(T=>T.name)),I=e0(S.params,M,a);I?i.push(`${_} = ${A.eventClass}(${I})`):i.push(`${_} = ${A.eventClass}()`)}i.push(`${u} = Subsystem(`),i.push("    blocks=[");for(const S of y)i.push(`        ${S},`);i.push("    ],"),i.push("    connections=[");const w=$1(l,m,"        ");for(const S of w)i.push(S);if(i.push("    ],"),c.length>0){i.push("    events=[");for(const S of x)i.push(`        ${S},`);i.push("    ],")}return i.push(")"),a||i.push(""),u}function V7(t){const e=new Map;for(const n of t){const i=Ri.get(n.type);if(!i)continue;const r=i.category||"Other";e.has(r)||e.set(r,[]),e.get(r).push({node:n,typeDef:i})}return e}function G7(t,e,n,i,r=!0,s=[],a=!0){const o=[],l=t.some(ao),c=s.length>0,u=new Set(s.map(w=>ra.get(w.type)?.eventClass).filter(Boolean)),f=Ww(t);o.push("# IMPORTS"),o.push("import numpy as np"),l?o.push("from pathsim import Simulation, Connection, Subsystem, Interface"):o.push("from pathsim import Simulation, Connection");for(const[w]of f)o.push(`from ${w} import *`);f.has("pathsim.blocks")||o.push("from pathsim.blocks import *"),o.push(`from pathsim.solvers import ${Js(n,"solver")}`),c&&o.push(`from pathsim.events import ${[...u].join(", ")}`),o.push(""),i.trim()&&(o.push("# CODE CONTEXT"),o.push(i.trim()),o.push("")),o.push("# BLOCKS");const h=new Map,d=[],y=t.filter(ao);for(const w of y)yp(w,h,d,o);if(t.filter(w=>!ao(w)&&!Ld(w)).forEach((w,S)=>{const A=Ri.get(w.type);if(!A){console.warn(`Unknown node type: ${w.type}`);return}let _=lo(w.name);(!_||d.includes(_))&&(_=`block_${S}`),d.push(_),h.set(w.id,_);const M=new Set(A.params.map(T=>T.name)),I=Td(w.params,M);I?o.push(`${_} = ${A.blockClass}(${I})`):o.push(`${_} = ${A.blockClass}()`)}),o.push(""),o.push(...zh("blocks",d)),o.push(""),r){o.push("# NODE ID MAPPING (for data extraction)"),o.push("_node_id_map = {");for(const[S,A]of h)o.push(`    id(${A}): "${S}",`);o.push("}"),o.push(""),o.push("# NODE NAME MAPPING"),o.push("_node_name_map = {");const w=t0(t);for(const S of w){const A=S.name.replace(/"/g,'\\"');o.push(`    "${S.id}": "${A}",`)}o.push("}"),o.push("")}o.push("# CONNECTIONS"),o.push("connections = [");const x=$1(e,h,"    ");for(const w of x)o.push(w);if(o.push("]"),o.push(""),c){o.push("# EVENTS");const w=Hw(s,d,o);o.push(""),o.push(...zh("events",w)),o.push("")}return o.push("# SIMULATION"),Uw(n,c,o),a&&(o.push(""),o.push("# RUN"),o.push(`sim.run(duration=${Js(n,"duration")}, reset=True)`)),o.join(`
`)}function X7(t,e,n,i,r=[]){const s=[],a="# "+"â".repeat(76),l=new Date().toISOString().replace("T"," ").split(".")[0];s.push("#!/usr/bin/env python3"),s.push("# -*- coding: utf-8 -*-"),s.push('"""'),s.push("PathSim Simulation"),s.push("=================="),s.push(""),s.push(`Generated by PathView on ${l}`),s.push("https://view.pathsim.org"),s.push(""),s.push("PathSim documentation: https://docs.pathsim.org"),s.push('"""'),s.push("");const c=t.some(ao),u=r.length>0,f=new Set(r.map(_=>ra.get(_.type)?.eventClass).filter(Boolean));s.push(a),s.push("# IMPORTS"),s.push(a),s.push(""),s.push("import numpy as np"),s.push("import matplotlib.pyplot as plt"),s.push(""),c?s.push("from pathsim import Simulation, Connection, Subsystem, Interface"):s.push("from pathsim import Simulation, Connection");const h=Ww(t);for(const[_,M]of h){const I=[...M].sort();if(I.length===1)s.push(`from ${_} import ${I[0]}`);else{s.push(`from ${_} import (`);for(let T=0;T<I.length;T++){const D=T<I.length-1?",":"";s.push(`    ${I[T]}${D}`)}s.push(")")}}s.push(`from pathsim.solvers import ${Js(n,"solver")}`),u&&s.push(`from pathsim.events import ${[...f].join(", ")}`),s.push(""),i.trim()&&(s.push(a),s.push("# USER-DEFINED CODE"),s.push(a),s.push(""),s.push(i.trim()),s.push("")),s.push(a),s.push("# BLOCKS"),s.push(a);const d=new Map,y=[];let m=0;const x=t,w=x.filter(ao);for(const _ of w)yp(_,d,y,s,"",{formatted:!0});const S=x.filter(_=>!ao(_)&&!Ld(_)),A=V7(S);for(const _ of Bv){if(_==="Subsystem")continue;const M=A.get(_);if(!(!M||M.length===0)){s.push(""),s.push(`# ${_}`);for(const{node:I,typeDef:T}of M){let D=lo(I.name);(!D||y.includes(D))&&(D=`block_${m}`),y.push(D),d.set(I.id,D),m++;const O=new Set(T.params.map(C=>C.name)),W=Td(I.params,O,!0);W?s.push(`${D} = ${T.blockClass}(${W})`):s.push(`${D} = ${T.blockClass}()`)}}}for(const[_,M]of A)if(!Bv.includes(_)){s.push(""),s.push(`# ${_}`);for(const{node:I,typeDef:T}of M){let D=lo(I.name);(!D||y.includes(D))&&(D=`block_${m}`),y.push(D),d.set(I.id,D),m++;const O=new Set(T.params.map(C=>C.name)),W=Td(I.params,O,!0);W?s.push(`${D} = ${T.blockClass}(${W})`):s.push(`${D} = ${T.blockClass}()`)}}if(s.push(""),s.push(...zh("blocks",y)),s.push(""),s.push(a),s.push("# CONNECTIONS"),s.push(a),s.push(""),e.length===0)s.push("connections = []");else{s.push("connections = [");const _=$1(e,d,"    ");for(const M of _)s.push(M);s.push("]")}if(s.push(""),u){s.push(a),s.push("# EVENTS"),s.push(a),s.push("");const _=Hw(r,y,s,!0);s.push(""),s.push(...zh("events",_)),s.push("")}return s.push(a),s.push("# SIMULATION"),s.push(a),s.push(""),Uw(n,u,s),s.push(""),s.push(a),s.push("# MAIN"),s.push(a),s.push(""),s.push("if __name__ == '__main__':"),s.push(""),s.push("    # Run simulation"),s.push(`    sim.run(duration=${Js(n,"duration")})`),s.push(""),s.push("    # Plot results"),s.push("    sim.plot()"),s.push("    plt.show()"),s.push(""),s.join(`
`)}async function Y7(t,e,n,i,r=[],s){const a=G7(t,e,n,i,!0,r,!1),o=Js(n,"duration");return WP(a,String(o),s)}function K7(t,e,n,i,r=[]){return X7(t,e,n,i,r)}function n0(t,e,n){const i=Ri.get(t.type);if(!i)return"";if(t.type===_n.INTERFACE){const o=e||Re.getAllNodes(),l=W5(o,t.id);return l?n0(l,e,n):"# Interface block (no parent subsystem found)"}const r=lo(t.name)||"block";if(t.type===_n.SUBSYSTEM&&e&&n){const o=[];return yp(t,new Map,[],o,"",{formatted:!0}),o.join(`
`)}const s=new Set(i.params.map(o=>o.name)),a=Td(t.params,s,!0);return a?`${r} = ${i.blockClass}(${a})`:`${r} = ${i.blockClass}()`}function Vw(t){const e=ra.get(t.type);if(!e)return"";const n=lo(t.name)||"event",i=new Set(e.params.map(s=>s.name)),r=e0(t.params,i,!0);return r?`${n} = ${e.eventClass}(${r})`:`${n} = ${e.eventClass}()`}function Z7(t){const e={};for(const n of t){const i=Ri.get(n.type);if(!i)continue;const r=new Set(i.params.map(a=>a.name)),s={};for(const[a,o]of Object.entries(n.params))o==null||o===""||a.startsWith("_")||r.has(a)&&(s[a]=String(o));Object.keys(s).length>0&&(e[n.id]=s)}return e}async function J7(t,e){const n=Z7(t);return GP(e,n)}function Gw(t){const e=new RegExp("(?<![.\\w])([a-zA-Z_][a-zA-Z0-9_]*)","g"),n=new Set;let i;for(;(i=e.exec(t))!==null;)n.add(i[1]);return n}const Q7=new Set(["True","False","None","and","or","not","in","is","if","else","elif","for","while","def","class","return","yield","import","from","as","try","except","finally","with","lambda","pass","break","continue","raise","global","nonlocal","assert","del","print","len","range","list","dict","set","tuple","str","int","float","bool","type","np","numpy","math","sin","cos","tan","exp","log","sqrt","pi","abs","min","max","sum","any","all","map","filter","zip","enumerate"]);function Xw(t,e){if(!t.trim()||e.size===0)return"";const n=t.split(`
`),i=[];let r=!1,s=0;const a=new Set([...e].filter(o=>!Q7.has(o)));if(a.size===0)return"";for(let o=0;o<n.length;o++){const l=n[o],c=l.trim(),u=c.match(/^def\s+([a-zA-Z_][a-zA-Z0-9_]*)\s*\(/);if(u&&a.has(u[1])){r=!0,s=l.search(/\S/),i.push(l);continue}const f=c.match(/^([a-zA-Z_][a-zA-Z0-9_]*)\s*=/);if(f&&a.has(f[1])&&!r){i.push(l);continue}if(r){const h=l.search(/\S/);c===""||h>s?i.push(l):r=!1}}return i.join(`
`).trim()}function Yw(t){const e=[];for(const n of Object.values(t.params))n!=null&&n!==""&&e.push(String(n));if(t.graph)for(const n of t.graph.nodes)e.push(...Yw(n));return e}function Kw(t,e){if(t.graph)for(const n of t.graph.nodes){const i=Ri.get(n.type);i&&i.blockClass!=="Subsystem"&&i.blockClass!=="Interface"&&e.add(i.blockClass),n.type===_n.SUBSYSTEM&&Kw(n,e)}}function Zw(t,e){const n=Ri.get(t.type);if(!n)return"";const i=[];if(i.push("import numpy as np"),t.type===_n.SUBSYSTEM){i.push("from pathsim import Subsystem, Interface, Connection");const o=new Set;Kw(t,o),o.size>0&&i.push(`from pathsim.blocks import ${[...o].sort().join(", ")}`)}else i.push(`from pathsim.blocks import ${n.blockClass}`);const r=t.type===_n.SUBSYSTEM?Yw(t).join(" "):Object.values(t.params).filter(o=>o!=null&&o!=="").join(" "),s=Gw(r),a=Xw(e,s);return a&&(i.push(""),i.push(a)),i.push(""),i.join(`
`)}function Jw(t,e){const n=ra.get(t.type);if(!n)return"";const i=[];i.push("import numpy as np"),i.push(`from pathsim.events import ${n.eventClass}`);const r=Object.values(t.params).filter(o=>o!=null&&o!=="").join(" "),s=Gw(r),a=Xw(e,s);return a&&(i.push(""),i.push(a)),i.push(""),i.join(`
`)}function $7(t){return Mh[t]?.docstringHtml}const mi={keyword:"#E57373",operator:"#0070C0",special:"#FFB74D",number:"#4DB6AC",string:"#81C784",function:"#0070C0",comment:{dark:"#505060",light:"#909098"},invalid:"#BA68C8",variable:{dark:"#e0e0e0",light:"#383a42"},punctuation:{dark:"#abb2bf",light:"#505050"}};let Df=null;async function bp(){if(Df)return Df;const[t,e,n,i,r,s,a]=await Promise.all([gs(()=>import("./BaLj8HaF.js").then(o=>o.t),__vite__mapDeps([0,1]),import.meta.url),gs(()=>import("./BJrbMhgq.js"),[],import.meta.url),gs(()=>import("./zngUhAbX.js"),__vite__mapDeps([2,0,1,3,4,5]),import.meta.url),gs(()=>import("./AwXmWqiV.js"),__vite__mapDeps([6,4,3,1,0,5]),import.meta.url),gs(()=>import("./-suHlTGB.js"),__vite__mapDeps([7,0,1,3,4]),import.meta.url),gs(()=>import("./bH9uCY5d.js"),__vite__mapDeps([3,4,1,0]),import.meta.url),gs(()=>import("./DSDy7V6L.js").then(o=>o.i),[],import.meta.url)]);return Df={EditorView:t.EditorView,EditorState:e.EditorState,keymap:t.keymap,basicSetup:n.basicSetup,python:i.python,oneDark:r.oneDark,HighlightStyle:s.HighlightStyle,syntaxHighlighting:s.syntaxHighlighting,indentUnit:s.indentUnit,tags:a.tags},Df}function eM(t,e){const{HighlightStyle:n,tags:i}=t,r=e?mi.variable.dark:mi.variable.light,s=e?mi.punctuation.dark:mi.punctuation.light,a=e?mi.comment.dark:mi.comment.light;return n.define([{tag:i.keyword,color:mi.keyword},{tag:i.operator,color:mi.operator},{tag:i.special(i.variableName),color:mi.special},{tag:i.typeName,color:mi.special},{tag:i.atom,color:mi.number},{tag:i.number,color:mi.number},{tag:i.bool,color:mi.number},{tag:i.string,color:mi.string},{tag:i.character,color:mi.string},{tag:i.regexp,color:mi.string},{tag:i.escape,color:mi.operator},{tag:i.variableName,color:r},{tag:i.definition(i.variableName),color:r},{tag:i.propertyName,color:r},{tag:i.function(i.variableName),color:mi.function},{tag:i.function(i.propertyName),color:mi.function},{tag:i.definition(i.function(i.variableName)),color:mi.function},{tag:i.labelName,color:r},{tag:i.comment,color:a,fontStyle:"italic"},{tag:i.blockComment,color:a,fontStyle:"italic"},{tag:i.docComment,color:a,fontStyle:"italic"},{tag:i.invalid,color:"#ffffff",backgroundColor:mi.invalid},{tag:i.punctuation,color:s},{tag:i.bracket,color:s},{tag:i.className,color:mi.special},{tag:i.attributeName,color:r},{tag:i.attributeValue,color:mi.string},{tag:i.self,color:mi.special}])}function Vd(t,e,n={}){const{EditorView:i,EditorState:r,keymap:s,basicSetup:a,python:o,oneDark:l,syntaxHighlighting:c,indentUnit:u}=t,f=[];if(n.keymaps&&n.keymaps.length>0&&f.push(s.of(n.keymaps)),f.push(a,o(),u.of("    "),c(eM(t,e))),n.readOnly&&f.push(r.readOnly.of(!0)),n.onDocChange){const h=n.onDocChange;f.push(i.updateListener.of(d=>{d.docChanged&&h(d.state.doc.toString())}))}return e&&f.push(l),f}let gu=[],qh=[],mu=null;async function tM(t){if(!t?.trim())return'<p class="no-docs">No documentation available.</p>';const e=await W1(),n=document.createElement("div");n.innerHTML=t;const i=n.querySelectorAll(".math");for(const r of i){const s=r.textContent||"";if(s.trim())try{let a=s.replace(/^\\\(|\\\)$/g,"").replace(/^\\\[|\\\]$/g,"").trim();a=a.replace(/\\begin\{eqnarray\*?\}/g,"\\begin{aligned}").replace(/\\end\{eqnarray\*?\}/g,"\\end{aligned}"),a.includes("\\\\")&&!a.includes("\\begin{")&&(a=`\\begin{aligned}${a}\\end{aligned}`);const o=r.tagName==="DIV"||s.includes("\\["),l=e.default.renderToString(a,{displayMode:o,throwOnError:!1,strict:!1});r.innerHTML=l,r.classList.add("katex-rendered")}catch(a){console.warn("KaTeX error for:",s,a)}}return n.innerHTML}function nM(t){const e=t.querySelectorAll("dl.docutils");for(const n of e){if(n.classList.contains("table-transformed"))continue;const i=document.createElement("div");i.className="param-table-wrapper";const r=document.createElement("table");r.className="param-table";const s=document.createElement("thead"),a=document.createElement("tr");["Name","Type","Description"].forEach(c=>{const u=document.createElement("th");u.textContent=c,a.appendChild(u)}),s.appendChild(a),r.appendChild(s);const o=document.createElement("tbody"),l=n.querySelectorAll(":scope > dt");for(const c of l){const u=document.createElement("tr"),f=document.createElement("td");f.className="param-name";const h=document.createElement("code");let d="";for(const S of c.childNodes)if(S.nodeType===Node.TEXT_NODE){if(d=S.textContent?.trim()||"",d)break}else if(S.nodeType===Node.ELEMENT_NODE){const A=S;if(A.classList.contains("classifier-delimiter")||(d=A.textContent?.trim()||"",d))break}h.textContent=d,f.appendChild(h),u.appendChild(f);const y=document.createElement("td");y.className="param-type";const m=c.querySelector(".classifier");if(m){const S=document.createElement("code");S.textContent=m.textContent||"",y.appendChild(S)}u.appendChild(y);const x=document.createElement("td");x.className="param-desc";const w=c.nextElementSibling;w&&w.tagName==="DD"&&(x.innerHTML=w.innerHTML),u.appendChild(x),o.appendChild(u)}r.appendChild(o),i.appendChild(r),n.parentNode?.replaceChild(i,n)}}function iM(t){return t.includes(">>>")||t.includes("...")?"console":"python"}function rM(t){const e=document.createElement("button");return e.className="copy-btn",e.innerHTML='<svg width="12" height="12" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="9" y="9" width="13" height="13" rx="2" ry="2"></rect><path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"></path></svg>',e.title="Copy code",e.addEventListener("click",async()=>{try{await navigator.clipboard.writeText(t),e.innerHTML='<svg width="12" height="12" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><polyline points="20 6 9 17 4 12"></polyline></svg>',setTimeout(()=>{e.innerHTML='<svg width="12" height="12" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="9" y="9" width="13" height="13" rx="2" ry="2"></rect><path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"></path></svg>'},2e3)}catch(n){console.error("Failed to copy:",n)}}),e}async function sM(t){Rm(),mu=await bp();const e=document.documentElement.getAttribute("data-theme")!=="light",n=t.querySelectorAll("pre");for(const i of n){if(i.classList.contains("cm-processed"))continue;const r=i.querySelector("code"),s=r?r.textContent:i.textContent;if(!s?.trim())continue;i.classList.add("cm-processed");const a=s.trim(),o=iM(a),l=document.createElement("div");l.className="code-block-wrapper";const c=document.createElement("div");c.className="code-block-header";const u=document.createElement("span");u.className="code-label",u.textContent=o==="console"?"CONSOLE":"PYTHON",c.appendChild(u),c.appendChild(rM(a)),l.appendChild(c);const f=document.createElement("div");f.className="cm-container",l.appendChild(f),i.parentNode?.replaceChild(l,i),qh.push({wrapper:l,code:a});const h=new mu.EditorView({doc:a,extensions:Vd(mu,e,{readOnly:!0}),parent:f});gu.push(h)}}async function aM(){if(!mu||qh.length===0)return;const t=document.documentElement.getAttribute("data-theme")!=="light";for(const e of gu)e.destroy();gu=[];for(const{wrapper:e,code:n}of qh){const i=e.querySelector(".cm-container");if(!i)continue;i.innerHTML="";const r=new mu.EditorView({doc:n,extensions:Vd(mu,t,{readOnly:!0}),parent:i});gu.push(r)}}function Rm(){for(const t of gu)t.destroy();gu=[],qh=[]}var oM=Le('<link rel="stylesheet"/>'),lM=Le('<div class="docs-loading svelte-1tqxd15">Loading documentation...</div>'),cM=Le('<div class="docs-content svelte-1tqxd15"><!></div>'),uM=Le('<div class="docs-section svelte-1tqxd15"><button class="docs-toggle svelte-1tqxd15"><span><!></span> Documentation</button> <!></div>');function Qw(t,e){Mt(e,!0);let n=Fe(!1),i=Fe(""),r=Fe(!1),s=Fe(void 0);const a=re(()=>!!e.docstring||!!e.docstringHtml);async function o(){if($(n,!p(n)),p(n)&&!p(i)){const f=e.docstringHtml||e.docstring;if(!f)return;$(r,!0);try{$(i,await tM(f),!0)}catch(h){console.error("Failed to render docstring:",h),$(i,'<p class="docs-error">Failed to render documentation.</p>')}$(r,!1)}}pn(()=>{p(i)&&p(s)&&!p(r)&&requestAnimationFrame(async()=>{p(s)&&(nM(p(s)),await sM(p(s)))})}),al.subscribe(()=>{p(n)&&p(s)&&aM()}),pn(()=>{(e.docstring||e.docstringHtml)&&(Rm(),$(i,""),$(n,!1))}),Ai(()=>{Rm()});var l=Je();Zh("1tqxd15",f=>{var h=oM();Ae(d=>he(h,"href",d),[V1]),j(f,h)});var c=He(l);{var u=f=>{var h=uM(),d=ne(h);d.__click=o;var y=ne(d);let m;var x=ne(y);Ot(x,{name:"chevron-right",size:12}),Q(y),Mi(),Q(d);var w=we(d,2);{var S=A=>{var _=cM(),M=ne(_);{var I=D=>{var O=lM();j(D,O)},T=D=>{var O=Je(),W=He(O);c1(W,()=>p(i)),j(D,O)};Se(M,D=>{p(r)?D(I):D(T,!1)})}Q(_),Fi(_,D=>$(s,D),()=>p(s)),On(3,_,()=>rS,()=>({duration:200})),j(A,_)};Se(w,A=>{p(n)&&A(S)})}Q(h),Ae(()=>m=Xt(y,1,"toggle-icon svelte-1tqxd15",null,m,{expanded:p(n)})),j(f,h)};Se(c,f=>{p(a)&&f(u)})}j(t,l),Tt()}Xn(["click"]);var dM=Le('<div class="loading svelte-70gj2h">Loading...</div>'),fM=Le('<div class="dialog-backdrop nested" role="presentation"><div class="dialog glass-panel svelte-70gj2h" role="dialog" tabindex="-1" aria-labelledby="dialog-title"><div class="dialog-header"><span id="dialog-title"> </span> <div class="header-actions svelte-70gj2h"><button aria-label="Copy to Clipboard"><!></button> <button class="icon-btn" aria-label="Close"><!></button></div></div> <div class="dialog-body svelte-70gj2h"><div class="code-preview svelte-70gj2h"><!></div></div></div></div>');function i0(t,e){Mt(e,!0);let n=ot(e,"open",3,!1),i=ot(e,"code",3,""),r=ot(e,"title",3,"Python Code"),s=Fe(void 0),a=null,o=null,l=Fe(!0),c=Fe("dark"),u=Fe(!1);const f=al.subscribe(I=>{$(c,I,!0),a&&o&&p(s)&&y()});pn(()=>{n()?($(u,!1),$(l,!0),setTimeout(()=>m(),0)):d()}),pn(()=>{n()&&a&&i()!==a.state.doc.toString()&&a.dispatch({changes:{from:0,to:a.state.doc.length,insert:i()}})});function h(){return o?Vd(o,p(c)==="dark",{readOnly:!0}):[]}function d(){a&&(a.destroy(),a=null)}function y(){if(!a||!p(s)||!o)return;const I=a.state.doc.toString();a.destroy(),a=new o.EditorView({doc:I,extensions:h(),parent:p(s)})}async function m(){p(s)&&(d(),o=await bp(),a=new o.EditorView({doc:i(),extensions:h(),parent:p(s)}),$(l,!1))}function x(){navigator.clipboard.writeText(i()),$(u,!0),setTimeout(()=>$(u,!1),2e3)}function w(I){I.target===I.currentTarget&&e.onClose()}function S(I){I.key==="Escape"&&e.onClose()}Ai(()=>{f(),d()});var A=Je();yn("keydown",$n,S);var _=He(A);{var M=I=>{var T=fM();T.__click=w;var D=ne(T),O=ne(D),W=ne(O),C=ne(W,!0);Q(W);var N=we(W,2),B=ne(N);let E;B.__click=x;var R=ne(B);{var q=G=>{Ot(G,{name:"check",size:16})},Z=G=>{Ot(G,{name:"copy",size:16})};Se(R,G=>{p(u)?G(q):G(Z,!1)})}Q(B),mt(B,(G,se)=>Qt?.(G,se),()=>p(u)?"Copied!":"Copy to Clipboard");var U=we(B,2);U.__click=function(...G){e.onClose?.apply(this,G)};var X=ne(U);Ot(X,{name:"x",size:16}),Q(U),mt(U,(G,se)=>Qt?.(G,se),()=>({text:"Close",shortcut:"Esc"})),Q(N),Q(O);var de=we(O,2),le=ne(de),F=ne(le);{var V=G=>{var se=dM();j(G,se)};Se(F,G=>{p(l)&&G(V)})}Q(le),Fi(le,G=>$(s,G),()=>p(s)),Q(de),Q(D),Q(T),Ae(()=>{Ht(C,r()),E=Xt(B,1,"icon-btn",null,E,{success:p(u)})}),On(3,D,()=>fo,()=>({start:.95,duration:150,easing:Ea})),On(3,T,()=>Nr,()=>({duration:150})),j(I,T)};Se(_,I=>{n()&&I(M)})}j(t,A),Tt()}Xn(["click"]);function hM(t){const e=JSON.parse(JSON.stringify(t)),n=fp(e);return delete n.graph,{version:Z1,type:"block",metadata:{name:t.name,created:new Date().toISOString(),modified:new Date().toISOString()},content:{node:n}}}function pM(t){if(t.type!==_n.SUBSYSTEM)throw new Error("Node is not a subsystem");const e=JSON.parse(JSON.stringify(t)),n=fp(e);return{version:Z1,type:"subsystem",metadata:{name:t.name,created:new Date().toISOString(),modified:new Date().toISOString()},content:{node:n}}}function gM(t){return{block:".blk",subsystem:".sub",model:".pvm"}[t]}function mM(t){return{block:"PathView Block",subsystem:"PathView Subsystem",model:"PathView Model"}[t]}function vM(t,e){Lw(t,e)}async function Bm(t,e){const n=Re.getNode(e);if(!n)return console.error("Node not found:",e),!1;if(t==="subsystem"&&n.type!==_n.SUBSYSTEM)return console.error("Cannot export non-subsystem as subsystem"),!1;const i=t==="subsystem"?pM(n):hM(n),r=gM(t),s=`${n.name}${r}`;if(mp())try{const a=await window.showSaveFilePicker({suggestedName:s,types:[{description:mM(t),accept:{"application/json":[r]}}]}),o=JSON.stringify(i,null,2),l=await a.createWritable();return await l.write(o),await l.close(),!0}catch(a){if(a.name==="AbortError")return!1;console.error("Failed to save component:",a)}return vM(i,s),!0}const yM=/[/\\:*?"<>|]/g;function $w(t){return t.replace(yM,"").trim()||"export"}function bM(t,e,n){const i=["time"];for(let s=0;s<e.length;s++)i.push(n?.[s]??`port_${s}`);const r=[i.join(",")];for(let s=0;s<t.length;s++){const a=[t[s].toString()];for(let o=0;o<e.length;o++)a.push((e[o][s]??"").toString());r.push(a.join(","))}return r.join(`
`)}function wM(t,e,n){const i=["frequency"];for(let s=0;s<e.length;s++)i.push(n?.[s]??`port_${s}`);const r=[i.join(",")];for(let s=0;s<t.length;s++){const a=[t[s].toString()];for(let o=0;o<e.length;o++)a.push((e[o][s]??"").toString());r.push(a.join(","))}return r.join(`
`)}function ex(t,e){const n=Ze(Vi);if(!n.result)return!1;if(e==="scope"){const i=n.result.scopeData[t];return!!(i&&i.time.length>0)}else{const i=n.result.spectrumData[t];return!!(i&&i.frequency.length>0)}}function xM(t,e){const i=Ze(Vi).result?.scopeData[t];if(!i||i.time.length===0)return!1;const r=bM(i.time,i.signals,i.labels),s=`${$w(e||"Scope")}.csv`;return Mw(r,s),!0}function _M(t,e){const i=Ze(Vi).result?.spectrumData[t];if(!i||i.frequency.length===0)return!1;const r=wM(i.frequency,i.magnitude,i.labels),s=`${$w(e||"Spectrum")}.csv`;return Mw(r,s),!0}function r0(t,e,n){return n==="Scope"?xM(t,e):n==="Spectrum"?_M(t,e):!1}function SM(){let t=Fe(null),e=Fe(Rn([])),n=Fe("idle"),i=Fe(0);const r=Vi.subscribe(d=>{$(t,d.result,!0),$(e,d.resultHistory,!0),$(n,d.phase,!0)}),s=rs.subscribe(d=>{$(i,d.ghostTraces??0,!0)});function a(d){return d==="Scope"?"scope":"spectrum"}function o(d,y){if(!p(t))return!1;if(a(y)==="scope"){const x=p(t).scopeData?.[d];return!!(x&&x.time.length>0)}else{const x=p(t).spectrumData?.[d];return!!(x&&x.frequency.length>0)}}function l(d){return p(t)?.scopeData?.[d]||null}function c(d){return p(t)?.spectrumData?.[d]||null}function u(d,y){if(a(y)==="scope"){const x=l(d);if(x)return{type:"scope",data:x}}else{const x=c(d);if(x)return{type:"spectrum",data:x}}return null}function f(d,y){if(p(i)===0||p(e).length===0)return[];const m=a(y);return p(e).slice(0,p(i)).map(w=>m==="scope"?w.scopeData?.[d]:w.spectrumData?.[d]).filter(w=>w!=null)}function h(){r(),s()}return{get simResult(){return p(t)},get resultHistory(){return p(e)},get simPhase(){return p(n)},get ghostTraces(){return p(i)},hasData:o,getScopeData:l,getSpectrumData:c,getPlotData:u,getGhostData:f,destroy:h}}var kM=Le('<button class="icon-btn" aria-label="Export CSV"><!></button>'),AM=Le('<button class="icon-btn" aria-label="Export"><!></button>'),NM=Le('<span class="help-icon">?</span>'),CM=Le("<option> </option>"),PM=Le('<select class="svelte-kkoyc2"></select>'),EM=Le('<input type="text" class="svelte-kkoyc2"/>'),IM=Le('<div class="param-item"><label><span> </span> <!></label> <div class="param-input-row svelte-kkoyc2"><!> <button><!></button></div></div>'),LM=Le('<div class="section"><div class="section-title">Parameters</div> <div class="params-grid"></div></div>'),MM=Le('<div class="no-params">No configurable parameters</div>'),TM=Le('<div class="dialog-backdrop" role="presentation"><div class="properties-dialog glass-panel" role="dialog" tabindex="-1" aria-labelledby="dialog-title"><div class="dialog-header"><div class="node-info"><input id="dialog-title" class="node-name-input" type="text"/> <span class="node-type"> </span></div> <div class="header-actions"><!> <!> <!> <button class="icon-btn" aria-label="View Python Code"><!></button> <button class="icon-btn" aria-label="Close"><!></button></div></div> <div class="dialog-body"><!> <!></div> <div class="dialog-footer"><span class="hint">R rotate Â· X flip horizontal Â· Y flip vertical</span></div></div></div>'),DM=Le("<!> <!>",1);function OM(t,e){Mt(e,!0);let n=Fe(null),i=Fe(null);const r=L1.subscribe(R=>{$(n,R,!0),R?$(i,Re.getNode(R)||null,!0):$(i,null)}),s=Re.nodesArray.subscribe(R=>{p(n)&&$(i,R.find(q=>q.id===p(n))||null,!0)});Ai(()=>{r(),s()});const a=re(()=>p(i)?Ri.get(p(i).type):null),o=re(()=>p(a)?.blockClass?$7(p(a).blockClass):void 0),l=re(()=>p(i)?.color||il);function c(R){if(!p(i))return;const q=p(i).id;It.mutate(()=>Re.updateNodeColor(q,R))}let u=Fe(!1),f=Fe("");function h(){if(!p(i))return;const R=Re.getAllNodes(),q=Re.getAllConnections().map(de=>de.connection),Z=Os.getCode(),U=Zw(p(i),Z),X=n0(p(i),R,q);$(f,U+X),$(u,!0)}function d(){if(!p(i))return;const R=p(i).type===_n.SUBSYSTEM?"subsystem":"block";Bm(R,p(i).id)}const y=re(()=>p(i)?.type!==_n.INTERFACE),m=re(()=>p(i)?.type==="Scope"||p(i)?.type==="Spectrum"),x=SM(),w=re(()=>p(n)&&p(i)&&p(m)?x.hasData(p(n),p(i).type):!1);function S(){!p(i)||!p(n)||r0(p(n),p(i).name,p(i).type)}function A(R,q){if(!p(i))return;const Z=p(i).id;It.mutate(()=>Re.updateNodeParams(Z,{[R]:q}))}function _(R){return p(i)?.pinnedParams?.includes(R)??!1}function M(R){if(!p(i))return;const q=p(i).id,Z=p(i).pinnedParams??[],U=Z.includes(R)?Z.filter(X=>X!==R):[...Z,R];It.mutate(()=>Re.updateNode(q,{pinnedParams:U}))}function I(R){if(!p(i))return;const q=p(i).id;It.mutate(()=>Re.updateNodeName(q,R))}function T(R){return R==null?"":typeof R=="object"?JSON.stringify(R):String(R)}function D(R){return R==null?"None":typeof R=="object"?JSON.stringify(R):String(R)}function O(R){R.target===R.currentTarget&&pg()}function W(R){R.key==="Escape"&&pg()}var C=DM();yn("keydown",$n,W);var N=He(C);{var B=R=>{var q=TM();q.__click=O;var Z=ne(q),U=ne(Z),X=ne(U),de=ne(X);jr(de),de.__input=Be=>I(Be.currentTarget.value),mt(de,Be=>Zs?.(Be));var le=we(de,2),F=ne(le,!0);Q(le),Q(X);var V=we(X,2),G=ne(V);X1(G,{get currentColor(){return p(l)},get defaultColor(){return il},onSelect:c});var se=we(G,2);{var ae=Be=>{var Ee=kM();Ee.__click=S;var at=ne(Ee);Ot(at,{name:"table",size:16}),Q(Ee),mt(Ee,(Ue,Ye)=>Qt?.(Ue,Ye),()=>p(w)?"Export CSV":"Run simulation to export data"),Ae(()=>Ee.disabled=!p(w)),j(Be,Ee)};Se(se,Be=>{p(m)&&Be(ae)})}var te=we(se,2);{var ue=Be=>{var Ee=AM();Ee.__click=d;var at=ne(Ee);Ot(at,{name:"upload",size:16}),Q(Ee),mt(Ee,(Ue,Ye)=>Qt?.(Ue,Ye),()=>"Export"),j(Be,Ee)};Se(te,Be=>{p(y)&&Be(ue)})}var pe=we(te,2);pe.__click=h;var ge=ne(pe);Ot(ge,{name:"braces",size:16}),Q(pe),mt(pe,(Be,Ee)=>Qt?.(Be,Ee),()=>"View Python Code");var me=we(pe,2);me.__click=function(...Be){pg?.apply(this,Be)};var Pe=ne(me);Ot(Pe,{name:"x",size:16}),Q(me),Q(V),Q(U);var ke=we(U,2),Ge=ne(ke);{var K=Be=>{var Ee=LM(),at=we(ne(Ee),2);cn(at,21,()=>p(a).params,Cn,(Ue,Ye)=>{const ut=re(()=>p(i).params[p(Ye).name]),Ft=re(()=>_(p(Ye).name));var be=IM(),ze=ne(be),ve=ne(ze),Ce=ne(ve,!0);Q(ve);var Ie=we(ve,2);{var rt=yt=>{var st=NM();mt(st,(gt,Bt)=>Qt?.(gt,Bt),()=>p(Ye).description),j(yt,st)};Se(Ie,yt=>{p(Ye).description&&yt(rt)})}Q(ze);var et=we(ze,2),vt=ne(et);{var wt=yt=>{var st=PM();st.__change=Bt=>A(p(Ye).name,Bt.currentTarget.value),cn(st,21,()=>p(Ye).options,Cn,(Bt,xt)=>{var dt=CM(),Ut=ne(dt,!0);Q(dt);var ai={};Ae(()=>{Ht(Ut,p(xt)),ai!==(ai=p(xt))&&(dt.value=(dt.__value=p(xt))??"")}),j(Bt,dt)}),Q(st);var gt;vb(st),Ae(Bt=>{he(st,"id",`param-${p(Ye).name??""}`),gt!==(gt=Bt)&&(st.value=(st.__value=Bt)??"",yh(st,Bt))},[()=>T(p(ut))]),j(yt,st)},Nt=yt=>{var st=EM();jr(st),st.__input=gt=>A(p(Ye).name,gt.currentTarget.value),mt(st,gt=>Zs?.(gt)),Ae((gt,Bt)=>{he(st,"id",`param-${p(Ye).name??""}`),ms(st,gt),he(st,"placeholder",Bt)},[()=>T(p(ut)),()=>D(p(Ye).default)]),j(yt,st)};Se(vt,yt=>{p(Ye).options&&p(Ye).options.length>0?yt(wt):yt(Nt,!1)})}var it=we(vt,2);let kt;it.__click=()=>M(p(Ye).name);var ct=ne(it);{let yt=re(()=>p(Ft)?"pin-filled":"pin");Ot(ct,{get name(){return p(yt)},size:14})}Q(it),mt(it,(yt,st)=>Qt?.(yt,st),()=>p(Ft)?"Unpin from node":"Pin to node"),Q(et),Q(be),Ae(()=>{he(ze,"for",`param-${p(Ye).name??""}`),Ht(Ce,p(Ye).name),kt=Xt(it,1,"pin-btn svelte-kkoyc2",null,kt,{pinned:p(Ft)}),he(it,"aria-label",p(Ft)?"Unpin from node":"Pin to node")}),j(Ue,be)}),Q(at),Q(Ee),j(Be,Ee)},Oe=Be=>{var Ee=MM();j(Be,Ee)};Se(Ge,Be=>{p(a).params.length>0?Be(K):Be(Oe,!1)})}var Ke=we(Ge,2);Qw(Ke,{get docstringHtml(){return p(o)}}),Q(ke),Mi(2),Q(Z),Q(q),Ae(()=>{Nn(Z,`--node-color: ${p(l)??""}`),ms(de,p(i).name),Ht(F,p(a).name)}),On(3,Z,()=>fo,()=>({start:.95,duration:150,easing:Ea})),On(3,q,()=>Nr,()=>({duration:150})),j(R,q)};Se(N,R=>{p(n)&&p(i)&&p(a)&&R(B)})}var E=we(N,2);i0(E,{get open(){return p(u)},get code(){return p(f)},title:"Block Python Code",onClose:()=>$(u,!1)}),j(t,C),Tt()}Xn(["click","input","change"]);var FM=Le('<span class="block-pill svelte-n1vk93"> </span>'),RM=Le('<div class="section"><div class="section-title">Block References</div> <div class="block-pills svelte-n1vk93"></div></div>'),BM=Le('<span class="help-icon">?</span>'),zM=Le('<div class="param-item"><label><span> </span> <!></label> <input type="text"/></div>'),qM=Le('<div><div class="section-title">Parameters</div> <div class="params-grid"></div></div>'),jM=Le('<div class="no-params">No configurable parameters</div>'),HM=Le('<div class="dialog-backdrop" role="presentation"><div class="properties-dialog glass-panel" role="dialog" tabindex="-1" aria-labelledby="dialog-title"><div class="dialog-header"><div class="node-info"><input id="dialog-title" class="node-name-input" type="text"/> <span class="node-type"> </span></div> <div class="header-actions"><!> <button class="icon-btn" aria-label="View Python Code"><!></button> <button class="icon-btn" aria-label="Close"><!></button></div></div> <div class="dialog-body"><!> <!> <!></div> <div class="dialog-footer"><span class="hint">Events trigger actions during simulation</span></div></div></div>'),UM=Le("<!> <!>",1);function WM(t,e){Mt(e,!0);let n=Fe(null),i=Fe(null);const r=G1.subscribe(T=>{$(n,T,!0),T?$(i,vn.getEvent(T)||null,!0):$(i,null)}),s=vn.eventsArray.subscribe(T=>{p(n)&&$(i,T.find(D=>D.id===p(n))||null,!0)});Ai(()=>{r(),s()});const a=re(()=>p(i)?ra.get(p(i).type):null),o=re(()=>p(i)?.color||il);function l(T){if(!p(i))return;const D=p(i).id;It.mutate(()=>vn.updateEventColor(D,T))}let c=Fe(!1),u=Fe("");function f(){if(!p(i))return;const T=Os.getCode(),D=Jw(p(i),T),O=Vw(p(i));$(u,D+O),$(c,!0)}const h=re(()=>()=>{const T=Ze(Re.nodesArray),D=[],O=new Set;for(const W of T){let C=lo(W.name);(!C||O.has(C))&&(C=`block_${D.length}`),O.add(C),D.push(C)}return D.sort()});function d(T,D){if(!p(i))return;const O=p(i).id;It.mutate(()=>vn.updateEventParams(O,{[T]:D}))}function y(T){if(!p(i))return;const D=p(i).id;It.mutate(()=>vn.updateEventName(D,T))}function m(T){return T==null?"":typeof T=="object"?JSON.stringify(T):String(T)}function x(T){return T==null?"None":typeof T=="object"?JSON.stringify(T):String(T)}function w(T){T.target===T.currentTarget&&yg()}function S(T){T.key==="Escape"&&yg()}var A=UM();yn("keydown",$n,S);var _=He(A);{var M=T=>{var D=HM();D.__click=w;var O=ne(D),W=ne(O),C=ne(W),N=ne(C);jr(N),N.__input=ue=>y(ue.currentTarget.value),mt(N,ue=>Zs?.(ue));var B=we(N,2),E=ne(B,!0);Q(B),Q(C);var R=we(C,2),q=ne(R);X1(q,{get currentColor(){return p(o)},get defaultColor(){return il},onSelect:l});var Z=we(q,2);Z.__click=f;var U=ne(Z);Ot(U,{name:"braces",size:16}),Q(Z),mt(Z,(ue,pe)=>Qt?.(ue,pe),()=>"View Python Code");var X=we(Z,2);X.__click=function(...ue){yg?.apply(this,ue)};var de=ne(X);Ot(de,{name:"x",size:16}),Q(X),Q(R),Q(W);var le=we(W,2),F=ne(le);{var V=ue=>{var pe=RM(),ge=we(ne(pe),2);cn(ge,21,()=>p(h)(),Cn,(me,Pe)=>{var ke=FM(),Ge=ne(ke,!0);Q(ke),Ae(()=>Ht(Ge,p(Pe))),j(me,ke)}),Q(ge),Q(pe),j(ue,pe)};Se(F,ue=>{p(h)().length>0&&ue(V)})}var G=we(F,2);{var se=ue=>{var pe=qM();let ge;var me=we(ne(pe),2);cn(me,21,()=>p(a).params,Cn,(Pe,ke)=>{const Ge=re(()=>p(i).params[p(ke).name]),K=re(()=>p(ke).type==="callable"?p(ke).description?p(ke).description+". Define functions in Code Editor (E)":"Define functions in Code Editor (E)":p(ke).description);var Oe=zM(),Ke=ne(Oe),Be=ne(Ke),Ee=ne(Be,!0);Q(Be);var at=we(Be,2);{var Ue=ut=>{var Ft=BM();mt(Ft,(be,ze)=>Qt?.(be,ze),()=>p(K)),j(ut,Ft)};Se(at,ut=>{p(K)&&ut(Ue)})}Q(Ke);var Ye=we(Ke,2);jr(Ye),Ye.__input=ut=>d(p(ke).name,ut.currentTarget.value),mt(Ye,ut=>Zs?.(ut)),Q(Oe),Ae((ut,Ft)=>{he(Ke,"for",`param-${p(ke).name??""}`),Ht(Ee,p(ke).name),he(Ye,"id",`param-${p(ke).name??""}`),ms(Ye,ut),he(Ye,"placeholder",Ft)},[()=>m(p(Ge)),()=>x(p(ke).default)]),j(Pe,Oe)}),Q(me),Q(pe),Ae(Pe=>ge=Xt(pe,1,"section svelte-n1vk93",null,ge,Pe),[()=>({"with-separator":p(h)().length>0})]),j(ue,pe)},ae=ue=>{var pe=jM();j(ue,pe)};Se(G,ue=>{p(a).params.length>0?ue(se):ue(ae,!1)})}var te=we(G,2);Qw(te,{get docstringHtml(){return p(a).docstringHtml}}),Q(le),Mi(2),Q(O),Q(D),Ae(()=>{Nn(O,`--node-color: ${p(o)??""}`),ms(N,p(i).name),Ht(E,p(a).name)}),On(3,O,()=>fo,()=>({start:.95,duration:150,easing:Ea})),On(3,D,()=>Nr,()=>({duration:150})),j(T,D)};Se(_,T=>{p(n)&&p(i)&&p(a)&&T(M)})}var I=we(_,2);i0(I,{get open(){return p(c)},get code(){return p(u)},title:"Event Python Code",onClose:()=>$(c,!1)}),j(t,A),Tt()}Xn(["click","input"]);const{subscribe:VM,set:h2}=an(null),jh={subscribe:VM,open(t,e){h2({code:t,title:e})},close(){h2(null)}},_g={responsive:!0,displaylogo:!1,displayModeBar:"hover",modeBarButtonsToRemove:["lasso2d","select2d","toImage"],modeBarButtonsToAdd:[],scrollZoom:!0,doubleClick:"reset"};function tx(t,e=!1){const{style:n,ghost:i,signalIndex:r,label:s}=t,a=e?t.xDecimated:t.x,o=e?t.yDecimated:t.y,l=n.lineStyle!==null,c=n.markerStyle!==null;let u="lines";l&&c?u="lines+markers":c&&(u="markers");const f={x:a,y:o,type:"scatter",mode:u,name:s,legendgroup:`signal-${r}`};return i?(f.opacity=i.opacity,f.showlegend=!1,f.hoverinfo="skip"):f.hovertemplate=`<b style="color:${n.color}">${s}</b><br>x = %{x:.4g}<br>y = %{y:.4g}<extra></extra>`,l&&n.lineStyle&&(f.line={color:n.color,width:i?1:1.5,dash:QP[n.lineStyle]}),c&&n.markerStyle&&(f.marker={symbol:$P[n.markerStyle],size:i?5:6,color:n.color},f.cliponaxis=!1),f}function GM(t,e){const n=tx(t,!1);return!t.ghost&&e&&(n.customdata=e,n.hovertemplate=`<b style="color:${t.style.color}">${t.label}</b><br>f = %{customdata:.2f} Hz<br>mag = %{y:.4g}<extra></extra>`),n}function nx(){const t=iu("--text-muted"),e=iu("--text-disabled"),n=iu("--surface-raised"),i=iu("--border"),r=iu("--accent");return{paper_bgcolor:"transparent",plot_bgcolor:"transparent",font:{color:t,family:"Inter, system-ui, sans-serif",size:11},margin:{l:60,r:15,t:10,b:45},xaxis:{gridcolor:i,gridwidth:.5,zeroline:!1,linecolor:i,linewidth:1.5,tickfont:{size:10,color:e},title:{standoff:10}},yaxis:{gridcolor:i,gridwidth:.5,zeroline:!1,linecolor:i,linewidth:1.5,tickfont:{size:10,color:e},title:{standoff:5}},legend:{bgcolor:n,bordercolor:i,borderwidth:1,font:{size:10,color:t},x:.01,xanchor:"left",y:.99,yanchor:"top"},modebar:{bgcolor:"transparent",color:e,activecolor:r},hoverlabel:{bgcolor:n,bordercolor:i,font:{color:t,size:11}}}}function Sg(t){const{type:e,title:n,layout:i,frequencies:r}=t,s=nx(),a=e==="scope"?"Time (s)":"Frequency (Hz)",o=e==="scope"?n.toLowerCase().startsWith("scope")?n:`Scope: ${n}`:n.toLowerCase().startsWith("spectrum")?n:`Spectrum: ${n}`,l={...s,xaxis:{...s.xaxis,title:{text:a,font:{size:11},standoff:10},type:i.xAxisScale},yaxis:{...s.yaxis,title:{text:o,font:{size:11},standoff:5},type:i.yAxisScale},showlegend:i.showLegend,hovermode:"closest"};if(e==="spectrum"&&r&&r.length>0){const c=Math.min(6,r.length),u=Math.max(1,Math.floor((r.length-1)/(c-1))),f=[],h=[];for(let d=0;d<r.length;d+=u)f.push(d),h.push(Wv(r[d]));f[f.length-1]!==r.length-1&&(f.push(r.length-1),h.push(Wv(r[r.length-1]))),l.xaxis={...l.xaxis,tickvals:f,ticktext:h,tickangle:0}}return l}function XM(t){const e=iu("--text-disabled");return{...t,annotations:[{text:"No data",xref:"paper",yref:"paper",x:.5,y:.5,showarrow:!1,font:{size:14,color:e}}]}}var YM=Le('<div class="plot-container svelte-oa38j7"><div class="plot svelte-oa38j7"></div></div>');function p2(t,e){Mt(e,!0);let n,i=null,r=null,s=Fe(null),a=Fe(!1),o=!1,l=0,c=0,u=!1;const f=al.subscribe(()=>{if(i&&n){const I=nx();i.relayout(n,{"font.color":I.font?.color,"xaxis.gridcolor":I.xaxis?.gridcolor,"xaxis.linecolor":I.xaxis?.linecolor,"xaxis.tickfont.color":I.xaxis?.tickfont?.color,"yaxis.gridcolor":I.yaxis?.gridcolor,"yaxis.linecolor":I.yaxis?.linecolor,"yaxis.tickfont.color":I.yaxis?.tickfont?.color,"legend.bgcolor":I.legend?.bgcolor,"legend.bordercolor":I.legend?.bordercolor,"legend.font.color":I.legend?.font?.color,"modebar.color":I.modebar?.color,"modebar.activecolor":I.modebar?.activecolor,"hoverlabel.bgcolor":I.hoverlabel?.bgcolor,"hoverlabel.bordercolor":I.hoverlabel?.bordercolor,"hoverlabel.font.color":I.hoverlabel?.font?.color})}}),h=dp.subscribe(I=>{$(s,I.plots.get(e.nodeId)??null,!0);const T=I.isStreaming;(T&&!u||!T&&u)&&(o=!1,l=0,c=0),u=T,$(a,T,!0),i&&n&&d()});Du(async()=>{i=await gs(()=>import("./DyKbcKio.js").then(I=>I.p),[],import.meta.url),p(s)&&d(),r=new ResizeObserver(()=>{i&&n&&i.Plots.resize(n)}),r.observe(n)}),Ai(()=>{h(),f(),r?.disconnect(),i&&n&&i.purge(n)});function d(){if(!(!i||!n)){if(p(s)?.type==="spectrum"){y();return}m()}}function y(){if(!i||!n||!p(s)){S();return}const I=p(s).traces.map(T=>GM(T,p(s).frequencies));if(I.length===0)S();else{const T=Sg(p(s));i.react(n,I,T,_g)}}function m(){if(!i||!n)return;if(!p(s)||p(s).traces.length===0){S(),o=!1,l=0;return}const T=p(s).traces.find(D=>!D.ghost)?.x.length??0;if(p(a)&&o&&T>l){w(T);return}x()}function x(){if(!i||!n||!p(s))return;c=p(s).traces.filter(O=>O.ghost).length;const I=p(s).traces.map(O=>tx(O)),T=Sg(p(s));i.react(n,I,T,_g);const D=p(s).traces.find(O=>!O.ghost);p(a)&&D&&D.x.length>0&&(o=!0,l=D.x.length)}function w(I){if(!i||!n||!p(s))return;const T=l,D=p(s).traces.filter(N=>!N.ghost),O=[],W=[],C=[];D.forEach((N,B)=>{O.push(N.x.slice(T)),W.push(N.y.slice(T)),C.push(c+B)}),O.length>0&&O[0].length>0&&i.extendTraces(n,{x:O,y:W},C),l=I}function S(){if(!i||!n)return;const I=p(s)?Sg(p(s)):{paper_bgcolor:"transparent",plot_bgcolor:"transparent",margin:{l:60,r:15,t:10,b:45}},T=XM(I);i.newPlot(n,[],T,_g)}function A(I){I.preventDefault(),to.openForPlot(e.nodeId,n,{x:I.clientX,y:I.clientY})}var _=YM(),M=ne(_);M.__contextmenu=A,Fi(M,I=>n=I,()=>n),Q(_),j(t,_),Tt()}Xn(["contextmenu"]);var KM=Le('<div class="plot-tile svelte-qkhkod"><!></div>'),ZM=Le("<div></div>"),JM=Le('<div class="plot-area svelte-qkhkod"></div>'),QM=Le('<div class="placeholder svelte-qkhkod"><p>Run simulation to see plots</p> <p class="hint svelte-qkhkod">Add Scope or Spectrum nodes to record signals</p></div>'),$M=Le('<div class="plot-content svelte-qkhkod"><!></div>'),eT=Le("<div><!></div>");function tT(t,e){Mt(e,!0);let n=ot(e,"collapsed",3,!1),i=ot(e,"activeTab",15,0),r=ot(e,"viewMode",3,"tabs"),s=Fe(void 0),a=Fe(0),o=Fe(0),l=null;const c=320,u=220;function f(T,D){if(T<=1)return{cols:1,rows:1,needsScroll:!1};if(D===0)return{cols:1,rows:T,needsScroll:!1};const O=Math.min(Math.max(1,Math.floor(D/c)),T),W=Math.ceil(T/O),C=W*u>p(o);return{cols:O,rows:W,needsScroll:C}}pn(()=>(p(s)&&(l?.disconnect(),l=new ResizeObserver(T=>{for(const D of T)$(a,D.contentRect.width,!0),$(o,D.contentRect.height,!0)}),l.observe(p(s))),()=>{l?.disconnect()}));let h=Fe(Rn([]));const d=dp.subscribe(T=>{$(h,Array.from(T.plots.values()),!0)});Ai(()=>{d()});const y=re(()=>()=>p(h));pn(()=>{const T=p(y)();i()>=T.length&&T.length>0&&i(0)});const m=re(()=>p(y)().length>0),x=re(()=>f(p(y)().length,p(a)));function w(){return p(y)()}var S={getPlots:w},A=eT();let _;var M=ne(A);{var I=T=>{var D=$M(),O=ne(D);{var W=N=>{var B=Je(),E=He(B);{var R=Z=>{var U=ZM();let X;cn(U,21,()=>p(y)(),de=>de.nodeId,(de,le)=>{var F=KM(),V=ne(F);p2(V,{get nodeId(){return p(le).nodeId}}),Q(F),j(de,F)}),Q(U),Ae(()=>{X=Xt(U,1,"plot-grid svelte-qkhkod",null,X,{scrollable:p(x).needsScroll}),Nn(U,`grid-template-columns: repeat(${p(x).cols??""}, 1fr); --min-tile-height: 220px;`)}),j(Z,U)},q=Z=>{var U=JM();cn(U,23,()=>p(y)(),X=>X.nodeId,(X,de,le)=>{var F=Je(),V=He(F);{var G=se=>{p2(se,{get nodeId(){return p(de).nodeId}})};Se(V,se=>{i()===p(le)&&se(G)})}j(X,F)}),Q(U),j(Z,U)};Se(E,Z=>{r()==="tiles"?Z(R):Z(q,!1)})}j(N,B)},C=N=>{var B=QM();j(N,B)};Se(O,N=>{p(m)?N(W):N(C,!1)})}Q(D),Fi(D,N=>$(s,N),()=>p(s)),j(T,D)};Se(M,T=>{n()||T(I)})}return Q(A),Ae(()=>_=Xt(A,1,"plot-panel svelte-qkhkod",null,_,{collapsed:n()})),j(t,A),Tt(S)}var nT=Le('<div class="placeholder svelte-gwrzq5"><p>Run simulation to see output</p> <p class="shortcut svelte-gwrzq5">Ctrl+Enter</p></div>'),iT=Le('<div><span class="log-message svelte-gwrzq5"> </span></div>'),rT=Le('<button class="scroll-to-bottom svelte-gwrzq5" aria-label="Scroll to bottom"><!></button>'),sT=Le('<div class="console-panel svelte-gwrzq5"><div class="console-content svelte-gwrzq5"><!></div> <!></div>');function aT(t,e){Mt(e,!0);let n=Fe(Rn([])),i=Fe(void 0),r=Fe(!0),s=-1,a=null;const o=yi.subscribe(w=>{$(n,w,!0)});pn(()=>{const w=p(n).length>0?p(n)[p(n).length-1].id:-1;w>s&&p(r)&&p(i)&&(a!==null&&clearTimeout(a),a=setTimeout(()=>{a=null,p(i)&&(p(i).scrollTop=p(i).scrollHeight)},0)),s=w}),Ai(()=>{o(),a!==null&&clearTimeout(a)});function l(){if(!p(i))return;const{scrollTop:w,scrollHeight:S,clientHeight:A}=p(i);$(r,w+A>=S-20)}function c(){p(i)&&(p(i).scrollTop=p(i).scrollHeight,$(r,!0))}var u=sT(),f=ne(u),h=ne(f);{var d=w=>{var S=nT();j(w,S)},y=w=>{var S=Je(),A=He(S);cn(A,17,()=>p(n),_=>_.id,(_,M)=>{var I=iT(),T=ne(I),D=ne(T,!0);Q(T),Q(I),Ae(()=>{Xt(I,1,`log-entry ${p(M).level??""}`,"svelte-gwrzq5"),Ht(D,p(M).message)}),j(_,I)}),j(w,S)};Se(h,w=>{p(n).length===0?w(d):w(y,!1)})}Q(f),Fi(f,w=>$(i,w),()=>p(i));var m=we(f,2);{var x=w=>{var S=rT();S.__click=c;var A=ne(S);Ot(A,{name:"chevron-down",size:16}),Q(S),j(w,S)};Se(m,w=>{!p(r)&&p(n).length>0&&w(x)})}Q(u),yn("scroll",f,l),j(t,u),Tt()}Xn(["click"]);var oT=Le('<div class="loading svelte-1q7n0z0">Loading editor...</div>'),lT=Le('<div class="error-bar svelte-1q7n0z0"> </div>'),cT=Le('<div class="code-editor svelte-1q7n0z0"><div class="editor-container svelte-1q7n0z0"><!></div> <!> <div class="footer svelte-1q7n0z0">Define Python variables and functions to use in node parameters.</div></div>');function uT(t,e){Mt(e,!0);let n,i=null,r=null,s=Fe(!0),a=Fe("dark"),o=Fe(""),l=Fe(null),c=[];function u(){return r?Vd(r,p(a)==="dark",{keymaps:[{key:"Mod-Enter",run:()=>(window.dispatchEvent(new CustomEvent("run-simulation")),!0)},{key:"Shift-Enter",run:()=>(window.dispatchEvent(new CustomEvent("continue-simulation")),!0)},{key:"Escape",run:_=>(_.contentDOM.blur(),!0)}],onDocChange:_=>{Os.setCode(_)}}):[]}function f(){if(!i||!n||!r)return;const _=i.state.doc.toString();i.destroy(),i=new r.EditorView({doc:_,extensions:u(),parent:n})}function h(){i?.focus()}Du(async()=>{c.push(Os.code.subscribe(_=>{$(o,_,!0),i&&i.state.doc.toString()!==_&&i.dispatch({changes:{from:0,to:i.state.doc.length,insert:_}})})),c.push(Os.lastError.subscribe(_=>{$(l,_,!0)})),c.push(al.subscribe(_=>{$(a,_,!0),i&&r&&f()})),r=await bp(),i=new r.EditorView({doc:p(o),extensions:u(),parent:n}),$(s,!1)}),Ai(()=>{c.forEach(_=>_()),i&&i.destroy()});var d={focus:h},y=cT(),m=ne(y),x=ne(m);{var w=_=>{var M=oT();j(_,M)};Se(x,_=>{p(s)&&_(w)})}Q(m),Fi(m,_=>n=_,()=>n);var S=we(m,2);{var A=_=>{var M=lT(),I=ne(M,!0);Q(M),Ae(()=>Ht(I,p(l))),j(_,M)};Se(S,_=>{p(l)&&_(A)})}return Mi(2),Q(y),j(t,y),Tt(d)}var dT=Le('<div><span class="node-name svelte-1yeydg2"> </span></div>');function g2(t,e){Mt(e,!0);const n=re(()=>e.node.category==="Subsystem"),i=re(()=>()=>M5(e.node));var r=dT();let s;var a=ne(r),o=ne(a,!0);Q(a),Q(r),Ae(l=>{s=Xt(r,1,`node-preview ${l??""}`,"svelte-1yeydg2",s,{"subsystem-type":p(n)}),Ht(o,e.node.name)},[()=>p(i)()]),j(t,r),Tt()}var fT=Le('<button class="clear-btn svelte-xht9mx"><!></button>'),hT=Le('<button draggable="true"><!></button>'),pT=Le('<div class="tile-grid svelte-xht9mx"></div>'),gT=Le('<div class="category svelte-xht9mx"><button class="category-header svelte-xht9mx"><span><!></span> <span class="category-name svelte-xht9mx"> </span></button> <!></div>'),mT=Le('<div class="empty svelte-xht9mx"><span>No nodes found</span> <span class="hint svelte-xht9mx">Try "gain", "source", or "plot"</span></div>'),vT=Le('<div class="drag-preview-wrapper svelte-xht9mx"><!></div>'),yT=Le('<div class="node-library svelte-xht9mx"><div class="search-container svelte-xht9mx"><span class="search-icon svelte-xht9mx"><!></span> <input type="text" placeholder="Search nodes..." class="search-input svelte-xht9mx"/> <!></div> <div class="node-grid-container svelte-xht9mx"></div> <div class="footer svelte-xht9mx"><span>Click or drag to add</span> <span>ââ Enter</span></div> <div class="drag-preview-container svelte-xht9mx" aria-hidden="true"><!></div></div>');function bT(t,e){Mt(e,!0);let n=ot(e,"focusSearch",3,!1),i=Fe(""),r,s=Fe(-1),a=Fe(!1),o=Fe(null),l,c=Fe(Rn(new Set));function u(X){$(c,new Set(p(c)),!0),p(c).has(X)?p(c).delete(X):p(c).add(X)}const f=[...Object.keys(I5),"Subsystem"],h=Ri.getAll(),d=re(()=>()=>{let X=h.filter(le=>le.type!==_n.INTERFACE);if(!p(i).trim())return X;const de=p(i).toLowerCase();return X.filter(le=>le.name.toLowerCase().includes(de)||le.category.toLowerCase().includes(de)||le.description.toLowerCase().includes(de))}),y=re(()=>()=>{const X=new Map;for(const le of p(d)())X.has(le.category)||X.set(le.category,[]),X.get(le.category).push(le);const de=new Map;for(const le of f)X.has(le)&&de.set(le,X.get(le));return de}),m=re(()=>()=>{const X=[];for(const[,de]of p(y)())X.push(...de);return X});function x(X){$(o,X,!0)}function w(X,de){if($(a,!0),X.dataTransfer&&(X.dataTransfer.setData("application/pathview-node",de.type),X.dataTransfer.effectAllowed="copy",l)){const le=l.getBoundingClientRect();X.dataTransfer.setDragImage(l,le.width/2,le.height/2)}}function S(){setTimeout(()=>{$(a,!1),$(o,null)},100)}function A(X){p(a)||e.onAddNode&&e.onAddNode(X.type)}function _(X){const de=p(m)();if(X.key==="ArrowDown")X.preventDefault(),$(s,Math.min(p(s)+1,de.length-1),!0);else if(X.key==="ArrowUp")X.preventDefault(),$(s,Math.max(p(s)-1,-1),!0);else if(X.key==="Enter"&&p(s)>=0){X.preventDefault();const le=de[p(s)];le&&e.onAddNode&&e.onAddNode(le.type)}else X.key==="Escape"&&(p(i)?($(i,""),$(s,-1),X.stopPropagation()):r?.blur())}pn(()=>{p(i),$(s,p(i)?0:-1,!0)}),pn(()=>{n()&&r&&r.focus()});function M(X){return p(m)()[p(s)]?.type===X.type}function I(){r?.focus()}var T={focus:I},D=yT();D.__keydown=_;var O=ne(D),W=ne(O),C=ne(W);Ot(C,{name:"search",size:14}),Q(W);var N=we(W,2);jr(N),Fi(N,X=>r=X,()=>r);var B=we(N,2);{var E=X=>{var de=fT();de.__click=()=>$(i,"");var le=ne(de);Ot(le,{name:"x",size:12}),Q(de),j(X,de)};Se(B,X=>{p(i)&&X(E)})}Q(O);var R=we(O,2);cn(R,21,()=>Array.from(p(y)().entries()),Cn,(X,de)=>{var le=re(()=>Mc(p(de),2));let F=()=>p(le)[0],V=()=>p(le)[1];var G=gT(),se=ne(G);se.__click=()=>u(F());var ae=ne(se);let te;var ue=ne(ae);Ot(ue,{name:"chevron-right",size:12}),Q(ae);var pe=we(ae,2),ge=ne(pe,!0);Q(pe),Q(se);var me=we(se,2);{var Pe=ke=>{var Ge=pT();cn(Ge,21,V,Cn,(K,Oe)=>{var Ke=hT();let Be;Ke.__click=()=>A(p(Oe));var Ee=ne(Ke);g2(Ee,{get node(){return p(Oe)}}),Q(Ke),mt(Ke,(at,Ue)=>Qt?.(at,Ue),()=>p(Oe).description),Ae(at=>Be=Xt(Ke,1,"node-tile svelte-xht9mx",null,Be,at),[()=>({selected:M(p(Oe))})]),yn("mouseenter",Ke,()=>x(p(Oe))),yn("dragstart",Ke,at=>w(at,p(Oe))),yn("dragend",Ke,S),j(K,Ke)}),Q(Ge),j(ke,Ge)};Se(me,ke=>{p(c).has(F())||ke(Pe)})}Q(G),Ae(ke=>{te=Xt(ae,1,"chevron svelte-xht9mx",null,te,ke),Ht(ge,F())},[()=>({expanded:!p(c).has(F())})]),j(X,G)},X=>{var de=mT();j(X,de)}),Q(R);var q=we(R,4),Z=ne(q);{var U=X=>{var de=vT(),le=ne(de);g2(le,{get node(){return p(o)}}),Q(de),Fi(de,F=>l=F,()=>l),j(X,de)};Se(Z,X=>{p(o)&&X(U)})}return Q(q),Q(D),xb(N,()=>p(i),X=>$(i,X)),j(t,D),Tt(T)}Xn(["keydown","click"]);var wT=Le('<div class="event-preview-wrapper svelte-1s8vqme"><div class="event-preview svelte-1s8vqme"><span class="event-name svelte-1s8vqme"> </span></div></div>');function xT(t,e){Mt(e,!0);var n=wT(),i=ne(n),r=ne(i),s=ne(r,!0);Q(r),Q(i),Q(n),Ae(()=>Ht(s,e.event.name)),j(t,n),Tt()}var _T=Le('<button class="event-tile svelte-d3r2aj"><!></button>'),ST=Le('<div class="events-panel svelte-d3r2aj"><div class="event-grid-container svelte-d3r2aj"><div class="tile-grid svelte-d3r2aj"></div></div> <div class="footer svelte-d3r2aj">Click or drag to add</div></div>');function kT(t,e){Mt(e,!0);const n=ra.getAll();let i=Fe(!0);Re.currentPath.subscribe(h=>{$(i,h.length===0)});let r=Fe(!1);function s(h,d){const y=ra.get(h);y&&It.mutate(()=>{if(p(i))vn.addEvent(h,d);else{const m={id:crypto.randomUUID(),type:h,name:y.name,position:d,params:{}};Re.addSubsystemEvent(m)}})}function a(h,d){$(r,!0),h.dataTransfer&&(h.dataTransfer.setData("application/pathview-event",d.type),h.dataTransfer.effectAllowed="copy")}function o(){setTimeout(()=>{$(r,!1)},100)}function l(h){if(!p(r))if(e.onAddEvent)e.onAddEvent(h.type);else{const d=oo({x:window.innerWidth/2,y:window.innerHeight/2});s(h.type,d)}}var c=ST(),u=ne(c),f=ne(u);cn(f,21,()=>n,Cn,(h,d)=>{var y=_T();he(y,"draggable",!0),y.__click=()=>l(p(d));var m=ne(y);xT(m,{get event(){return p(d)}}),Q(y),mt(y,(x,w)=>Qt?.(x,w),()=>p(d).description),yn("dragstart",y,x=>a(x,p(d))),yn("dragend",y,o),j(h,y)}),Q(f),Q(u),Mi(2),Q(c),j(t,c),Tt()}Xn(["click"]);var AT=Le('<div class="divider svelte-192vamk"></div>'),NT=Le('<span class="icon svelte-192vamk"><!></span>'),CT=Le('<kbd class="shortcut svelte-192vamk"> </kbd>'),PT=Le('<button role="menuitem"><!> <span class="label svelte-192vamk"> </span> <!></button>'),ET=Le('<div class="backdrop svelte-192vamk" role="presentation"><div class="context-menu glass-panel svelte-192vamk" role="menu" tabindex="-1"></div></div>');function IT(t,e){Mt(e,!0);let n,i=Fe(null);pn(()=>{n&&$(i,n.getBoundingClientRect(),!0)});const r=re(()=>()=>{if(!p(i))return e.x;const u=window.innerWidth;return e.x+p(i).width>u-10?e.x-p(i).width:e.x}),s=re(()=>()=>{if(!p(i))return e.y;const u=window.innerHeight;return e.y+p(i).height>u-10?e.y-p(i).height:e.y});function a(u){u.disabled||(u.action(),e.onClose())}function o(u){u.key==="Escape"&&e.onClose()}var l=ET();yn("keydown",$n,o),l.__click=function(...u){e.onClose?.apply(this,u)},l.__contextmenu=u=>{u.preventDefault(),e.onClose()},l.__keydown=u=>u.key==="Escape"&&e.onClose();var c=ne(l);c.__click=u=>u.stopPropagation(),cn(c,21,()=>e.items,Cn,(u,f)=>{var h=Je(),d=He(h);{var y=x=>{var w=AT();j(x,w)},m=x=>{var w=PT();let S;w.__click=()=>a(p(f));var A=ne(w);{var _=O=>{var W=NT(),C=ne(W);Ot(C,{get name(){return p(f).icon}}),Q(W),j(O,W)};Se(A,O=>{p(f).icon&&O(_)})}var M=we(A,2),I=ne(M,!0);Q(M);var T=we(M,2);{var D=O=>{var W=CT(),C=ne(W,!0);Q(W),Ae(()=>Ht(C,p(f).shortcut)),j(O,W)};Se(T,O=>{p(f).shortcut&&O(D)})}Q(w),Ae(()=>{S=Xt(w,1,"menu-item svelte-192vamk",null,S,{disabled:p(f).disabled}),w.disabled=p(f).disabled,Ht(I,p(f).label)}),j(x,w)};Se(d,x=>{p(f).divider?x(y):x(m,!1)})}j(u,h)}),Q(c),Fi(c,u=>n=u,()=>n),Q(l),Ae((u,f)=>Nn(c,`left: ${u??""}px; top: ${f??""}px;`),[()=>p(r)(),()=>p(s)()]),On(3,c,()=>fo,()=>({start:.95,duration:100,easing:Ea})),j(t,l),Tt()}Xn(["click","contextmenu","keydown"]);function LT(){const t=Ze(Re.selectedNodeIds),e=Ze(vn.selectedEventIds);return t.size===0&&e.size===0?!1:It.mutate(()=>{for(const n of t)Re.getAnnotation(n)?Re.removeAnnotation(n):Re.removeNode(n);if(Re.isAtRoot())for(const n of e)vn.removeEvent(n);else for(const n of e)Re.removeSubsystemEvent(n);return!0})}const ix="pathview-clipboard",zm="1.0",qu=an(null);function Of(t){return{x:Math.round(t.x/Fn)*Fn,y:Math.round(t.y/Fn)*Fn}}function MT(t){if(t.length===0)return{x:0,y:0};let e=1/0,n=1/0,i=-1/0,r=-1/0;for(const s of t)e=Math.min(e,s.position.x),n=Math.min(n,s.position.y),i=Math.max(i,s.position.x),r=Math.max(r,s.position.y);return{x:(e+i)/2,y:(n+r)/2}}function TT(t){if(typeof t!="object"||t===null)return!1;const e=t;if(e.type!==ix||typeof e.version!="string")return!1;const n=e.content;return!n||typeof n!="object"?!1:Array.isArray(n.nodes)&&Array.isArray(n.connections)&&Array.isArray(n.events)&&typeof n.center=="object"&&n.center!==null}async function DT(t){try{const e={type:ix,version:zm,content:t};return await navigator.clipboard.writeText(JSON.stringify(e)),!0}catch(e){return console.debug("System clipboard write failed:",e),!1}}async function OT(){try{const t=await navigator.clipboard.readText();if(!t)return null;const e=JSON.parse(t);return TT(e)?(e.version!==zm&&console.warn(`Clipboard version mismatch: ${e.version} vs ${zm}`),e.content):null}catch{return null}}async function rx(){const t=Ze(Re.selectedNodeIds),e=Ze(vn.selectedEventIds),n=[];for(const h of t){const d=Re.getAnnotation(h);d&&n.push(JSON.parse(JSON.stringify(d)))}const i=new Set;for(const h of t)Re.getAnnotation(h)||i.add(h);if(i.size===0&&e.size===0&&n.length===0)return!1;const r=Ze(Re.nodes),s=Ze(Re.connections),a=[];for(const h of i){const d=r.get(h);d&&d.type!==_n.INTERFACE&&a.push(JSON.parse(JSON.stringify(d)))}const o=[];for(const h of s)i.has(h.sourceNodeId)&&i.has(h.targetNodeId)&&o.push(JSON.parse(JSON.stringify(h)));const l=[];if(Re.isAtRoot())for(const h of e){const d=vn.getEvent(h);d&&l.push(JSON.parse(JSON.stringify(d)))}else for(const h of e){const d=Re.getSubsystemEvent(h);d&&l.push(JSON.parse(JSON.stringify(d)))}const c=[...a.map(h=>({position:h.position})),...l.map(h=>({position:h.position})),...n.map(h=>({position:h.position}))],u=MT(c),f={nodes:a,connections:o,events:l,annotations:n,center:u};return qu.set(f),await DT(f),!0}async function FT(t){let e=await OT();if(e||(e=Ze(qu)),e?.annotations||(e=e?{...e,annotations:[]}:null),!e||e.nodes.length===0&&e.events.length===0&&e.annotations.length===0)return{nodeIds:[],eventIds:[],annotationIds:[]};const n=Bh(e.nodes);if(n.length>0){console.warn(`Clipboard paste: skipping unknown block types: ${n.join(", ")}`);const i=e.nodes.filter(a=>a.type===_n.SUBSYSTEM||a.type===_n.INTERFACE||Ri.has(a.type)),r=new Set(i.map(a=>a.id)),s=e.connections.filter(a=>r.has(a.sourceNodeId)&&r.has(a.targetNodeId));if(e={...e,nodes:i,connections:s},e.nodes.length===0&&e.events.length===0&&e.annotations.length===0)return{nodeIds:[],eventIds:[],annotationIds:[]}}return It.mutate(()=>{const i=Of(t),r={x:i.x-e.center.x,y:i.y-e.center.y},s=new Map,a=[];for(const f of e.nodes){const h=nr();s.set(f.id,h);const d=Of({x:f.position.x+r.x,y:f.position.y+r.y}),y=V5(f,d,h);a.push(y)}const o=[];for(const f of e.connections){const h=s.get(f.sourceNodeId),d=s.get(f.targetNodeId);h&&d&&o.push({id:nr(),sourceNodeId:h,sourcePortIndex:f.sourcePortIndex,targetNodeId:d,targetPortIndex:f.targetPortIndex})}Re.clearSelection(),vn.clearSelection();const l=Re.pasteNodes(a,o),c=[];for(const f of e.events){const h=Of({x:f.position.x+r.x,y:f.position.y+r.y});if(Re.isAtRoot()){const d=vn.addEvent(f.type,h,f.name);d&&(Object.keys(f.params).length>0&&vn.updateEventParams(d.id,f.params),f.color&&vn.updateEventColor(d.id,f.color),c.push(d.id),vn.selectEvent(d.id,!0))}else{const d=nr(),y={...f,id:d,position:h};Re.addSubsystemEvent(y),c.push(d)}}const u=[];for(const f of e.annotations){const h=Of({x:f.position.x+r.x,y:f.position.y+r.y}),d=Re.addAnnotation(h);Re.updateAnnotation(d,{content:f.content,width:f.width,height:f.height,color:f.color,fontSize:f.fontSize}),u.push(d)}return{nodeIds:l,eventIds:c,annotationIds:u}})}async function RT(){return await rx()?(LT(),!0):!1}function BT(){const t=Ze(qu);return t!==null&&(t.nodes.length>0||t.events.length>0||t.annotations.length>0)}function zT(){qu.set(null)}function qT(){const t=Ze(qu);return t?{nodes:t.nodes.length,connections:t.connections.length,events:t.events.length,annotations:t.annotations.length}:null}const co={subscribe:qu.subscribe,copy:rx,cut:RT,paste:FT,hasContent:BT,clear:zT,getSummary:qT};function jn(t){"@babel/helpers - typeof";return jn=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},jn(t)}var Ca=Uint8Array,Ds=Uint16Array,s0=Int32Array,a0=new Ca([0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0,0,0,0]),o0=new Ca([0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13,0,0]),m2=new Ca([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]),sx=function(t,e){for(var n=new Ds(31),i=0;i<31;++i)n[i]=e+=1<<t[i-1];for(var r=new s0(n[30]),i=1;i<30;++i)for(var s=n[i];s<n[i+1];++s)r[s]=s-n[i]<<5|i;return{b:n,r}},ax=sx(a0,2),jT=ax.b,qm=ax.r;jT[28]=258,qm[258]=28;var HT=sx(o0,0),v2=HT.r,jm=new Ds(32768);for(var ci=0;ci<32768;++ci){var Ol=(ci&43690)>>1|(ci&21845)<<1;Ol=(Ol&52428)>>2|(Ol&13107)<<2,Ol=(Ol&61680)>>4|(Ol&3855)<<4,jm[ci]=((Ol&65280)>>8|(Ol&255)<<8)>>1}var wd=(function(t,e,n){for(var i=t.length,r=0,s=new Ds(e);r<i;++r)t[r]&&++s[t[r]-1];var a=new Ds(e);for(r=1;r<e;++r)a[r]=a[r-1]+s[r-1]<<1;var o;if(n){o=new Ds(1<<e);var l=15-e;for(r=0;r<i;++r)if(t[r])for(var c=r<<4|t[r],u=e-t[r],f=a[t[r]-1]++<<u,h=f|(1<<u)-1;f<=h;++f)o[jm[f]>>l]=c}else for(o=new Ds(i),r=0;r<i;++r)t[r]&&(o[r]=jm[a[t[r]-1]++]>>15-t[r]);return o}),Cc=new Ca(288);for(var ci=0;ci<144;++ci)Cc[ci]=8;for(var ci=144;ci<256;++ci)Cc[ci]=9;for(var ci=256;ci<280;++ci)Cc[ci]=7;for(var ci=280;ci<288;++ci)Cc[ci]=8;var Hh=new Ca(32);for(var ci=0;ci<32;++ci)Hh[ci]=5;var UT=wd(Cc,9,0),WT=wd(Hh,5,0),ox=function(t){return(t+7)/8|0},VT=function(t,e,n){return(n==null||n>t.length)&&(n=t.length),new Ca(t.subarray(e,n))},Uo=function(t,e,n){n<<=e&7;var i=e/8|0;t[i]|=n,t[i+1]|=n>>8},td=function(t,e,n){n<<=e&7;var i=e/8|0;t[i]|=n,t[i+1]|=n>>8,t[i+2]|=n>>16},kg=function(t,e){for(var n=[],i=0;i<t.length;++i)t[i]&&n.push({s:i,f:t[i]});var r=n.length,s=n.slice();if(!r)return{t:cx,l:0};if(r==1){var a=new Ca(n[0].s+1);return a[n[0].s]=1,{t:a,l:1}}n.sort(function(M,I){return M.f-I.f}),n.push({s:-1,f:25001});var o=n[0],l=n[1],c=0,u=1,f=2;for(n[0]={s:-1,f:o.f+l.f,l:o,r:l};u!=r-1;)o=n[n[c].f<n[f].f?c++:f++],l=n[c!=u&&n[c].f<n[f].f?c++:f++],n[u++]={s:-1,f:o.f+l.f,l:o,r:l};for(var h=s[0].s,i=1;i<r;++i)s[i].s>h&&(h=s[i].s);var d=new Ds(h+1),y=Hm(n[u-1],d,0);if(y>e){var i=0,m=0,x=y-e,w=1<<x;for(s.sort(function(I,T){return d[T.s]-d[I.s]||I.f-T.f});i<r;++i){var S=s[i].s;if(d[S]>e)m+=w-(1<<y-d[S]),d[S]=e;else break}for(m>>=x;m>0;){var A=s[i].s;d[A]<e?m-=1<<e-d[A]++-1:++i}for(;i>=0&&m;--i){var _=s[i].s;d[_]==e&&(--d[_],++m)}y=e}return{t:new Ca(d),l:y}},Hm=function(t,e,n){return t.s==-1?Math.max(Hm(t.l,e,n+1),Hm(t.r,e,n+1)):e[t.s]=n},y2=function(t){for(var e=t.length;e&&!t[--e];);for(var n=new Ds(++e),i=0,r=t[0],s=1,a=function(l){n[i++]=l},o=1;o<=e;++o)if(t[o]==r&&o!=e)++s;else{if(!r&&s>2){for(;s>138;s-=138)a(32754);s>2&&(a(s>10?s-11<<5|28690:s-3<<5|12305),s=0)}else if(s>3){for(a(r),--s;s>6;s-=6)a(8304);s>2&&(a(s-3<<5|8208),s=0)}for(;s--;)a(r);s=1,r=t[o]}return{c:n.subarray(0,i),n:e}},nd=function(t,e){for(var n=0,i=0;i<e.length;++i)n+=t[i]*e[i];return n},lx=function(t,e,n){var i=n.length,r=ox(e+2);t[r]=i&255,t[r+1]=i>>8,t[r+2]=t[r]^255,t[r+3]=t[r+1]^255;for(var s=0;s<i;++s)t[r+s+4]=n[s];return(r+4+i)*8},b2=function(t,e,n,i,r,s,a,o,l,c,u){Uo(e,u++,n),++r[256];for(var f=kg(r,15),h=f.t,d=f.l,y=kg(s,15),m=y.t,x=y.l,w=y2(h),S=w.c,A=w.n,_=y2(m),M=_.c,I=_.n,T=new Ds(19),D=0;D<S.length;++D)++T[S[D]&31];for(var D=0;D<M.length;++D)++T[M[D]&31];for(var O=kg(T,7),W=O.t,C=O.l,N=19;N>4&&!W[m2[N-1]];--N);var B=c+5<<3,E=nd(r,Cc)+nd(s,Hh)+a,R=nd(r,h)+nd(s,m)+a+14+3*N+nd(T,W)+2*T[16]+3*T[17]+7*T[18];if(l>=0&&B<=E&&B<=R)return lx(e,u,t.subarray(l,l+c));var q,Z,U,X;if(Uo(e,u,1+(R<E)),u+=2,R<E){q=wd(h,d,0),Z=h,U=wd(m,x,0),X=m;var de=wd(W,C,0);Uo(e,u,A-257),Uo(e,u+5,I-1),Uo(e,u+10,N-4),u+=14;for(var D=0;D<N;++D)Uo(e,u+3*D,W[m2[D]]);u+=3*N;for(var le=[S,M],F=0;F<2;++F)for(var V=le[F],D=0;D<V.length;++D){var G=V[D]&31;Uo(e,u,de[G]),u+=W[G],G>15&&(Uo(e,u,V[D]>>5&127),u+=V[D]>>12)}}else q=UT,Z=Cc,U=WT,X=Hh;for(var D=0;D<o;++D){var se=i[D];if(se>255){var G=se>>18&31;td(e,u,q[G+257]),u+=Z[G+257],G>7&&(Uo(e,u,se>>23&31),u+=a0[G]);var ae=se&31;td(e,u,U[ae]),u+=X[ae],ae>3&&(td(e,u,se>>5&8191),u+=o0[ae])}else td(e,u,q[se]),u+=Z[se]}return td(e,u,q[256]),u+Z[256]},GT=new s0([65540,131080,131088,131104,262176,1048704,1048832,2114560,2117632]),cx=new Ca(0),XT=function(t,e,n,i,r,s){var a=s.z||t.length,o=new Ca(i+a+5*(1+Math.ceil(a/7e3))+r),l=o.subarray(i,o.length-r),c=s.l,u=(s.r||0)&7;if(e){u&&(l[0]=s.r>>3);for(var f=GT[e-1],h=f>>13,d=f&8191,y=(1<<n)-1,m=s.p||new Ds(32768),x=s.h||new Ds(y+1),w=Math.ceil(n/3),S=2*w,A=function(Ge){return(t[Ge]^t[Ge+1]<<w^t[Ge+2]<<S)&y},_=new s0(25e3),M=new Ds(288),I=new Ds(32),T=0,D=0,O=s.i||0,W=0,C=s.w||0,N=0;O+2<a;++O){var B=A(O),E=O&32767,R=x[B];if(m[E]=R,x[B]=E,C<=O){var q=a-O;if((T>7e3||W>24576)&&(q>423||!c)){u=b2(t,l,0,_,M,I,D,W,N,O-N,u),W=T=D=0,N=O;for(var Z=0;Z<286;++Z)M[Z]=0;for(var Z=0;Z<30;++Z)I[Z]=0}var U=2,X=0,de=d,le=E-R&32767;if(q>2&&B==A(O-le))for(var F=Math.min(h,q)-1,V=Math.min(32767,O),G=Math.min(258,q);le<=V&&--de&&E!=R;){if(t[O+U]==t[O+U-le]){for(var se=0;se<G&&t[O+se]==t[O+se-le];++se);if(se>U){if(U=se,X=le,se>F)break;for(var ae=Math.min(le,se-2),te=0,Z=0;Z<ae;++Z){var ue=O-le+Z&32767,pe=m[ue],ge=ue-pe&32767;ge>te&&(te=ge,R=ue)}}}E=R,R=m[E],le+=E-R&32767}if(X){_[W++]=268435456|qm[U]<<18|v2[X];var me=qm[U]&31,Pe=v2[X]&31;D+=a0[me]+o0[Pe],++M[257+me],++I[Pe],C=O+U,++T}else _[W++]=t[O],++M[t[O]]}}for(O=Math.max(O,C);O<a;++O)_[W++]=t[O],++M[t[O]];u=b2(t,l,c,_,M,I,D,W,N,O-N,u),c||(s.r=u&7|l[u/8|0]<<3,u-=7,s.h=x,s.p=m,s.i=O,s.w=C)}else{for(var O=s.w||0;O<a+c;O+=65535){var ke=O+65535;ke>=a&&(l[u/8|0]=c,ke=a),u=lx(l,u+1,t.subarray(O,ke))}s.i=a}return VT(o,0,i+ox(u)+r)},ux=function(){var t=1,e=0;return{p:function(n){for(var i=t,r=e,s=n.length|0,a=0;a!=s;){for(var o=Math.min(a+2655,s);a<o;++a)r+=i+=n[a];i=(i&65535)+15*(i>>16),r=(r&65535)+15*(r>>16)}t=i,e=r},d:function(){return t%=65521,e%=65521,(t&255)<<24|(t&65280)<<8|(e&255)<<8|e>>8}}},YT=function(t,e,n,i,r){if(!r&&(r={l:1},e.dictionary)){var s=e.dictionary.subarray(-32768),a=new Ca(s.length+t.length);a.set(s),a.set(t,s.length),t=a,r.w=s.length}return XT(t,e.level==null?6:e.level,e.mem==null?r.l?Math.ceil(Math.max(8,Math.min(13,Math.log(t.length)))*1.5):20:12+e.mem,n,i,r)},dx=function(t,e,n){for(;n;++e)t[e]=n,n>>>=8},KT=function(t,e){var n=e.level,i=n==0?0:n<6?1:n==9?3:2;if(t[0]=120,t[1]=i<<6|(e.dictionary&&32),t[1]|=31-(t[0]<<8|t[1])%31,e.dictionary){var r=ux();r.p(e.dictionary),dx(t,2,r.d())}};function Um(t,e){e||(e={});var n=ux();n.p(t);var i=YT(t,e,e.dictionary?6:2,4);return KT(i,e),dx(i,i.length-4,n.d()),i}var ZT=typeof TextDecoder<"u"&&new TextDecoder,JT=0;try{ZT.decode(cx,{stream:!0}),JT=1}catch{}function QT(t){if(Array.isArray(t))return t}function $T(t,e){var n=t==null?null:typeof Symbol<"u"&&t[Symbol.iterator]||t["@@iterator"];if(n!=null){var i,r,s,a,o=[],l=!0,c=!1;try{if(s=(n=n.call(t)).next,e!==0)for(;!(l=(i=s.call(n)).done)&&(o.push(i.value),o.length!==e);l=!0);}catch(u){c=!0,r=u}finally{try{if(!l&&n.return!=null&&(a=n.return(),Object(a)!==a))return}finally{if(c)throw r}}return o}}function w2(t,e){(e==null||e>t.length)&&(e=t.length);for(var n=0,i=Array(e);n<e;n++)i[n]=t[n];return i}function eD(t,e){if(t){if(typeof t=="string")return w2(t,e);var n={}.toString.call(t).slice(8,-1);return n==="Object"&&t.constructor&&(n=t.constructor.name),n==="Map"||n==="Set"?Array.from(t):n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?w2(t,e):void 0}}function tD(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function x2(t,e){return QT(t)||$T(t,e)||eD(t,e)||tD()}function _2(t,e="utf8"){return new TextDecoder(e).decode(t)}const nD=new TextEncoder;function iD(t){return nD.encode(t)}const rD=1024*8,sD=(()=>{const t=new Uint8Array(4),e=new Uint32Array(t.buffer);return!((e[0]=1)&t[0])})(),Ag={int8:globalThis.Int8Array,uint8:globalThis.Uint8Array,int16:globalThis.Int16Array,uint16:globalThis.Uint16Array,int32:globalThis.Int32Array,uint32:globalThis.Uint32Array,uint64:globalThis.BigUint64Array,int64:globalThis.BigInt64Array,float32:globalThis.Float32Array,float64:globalThis.Float64Array};class l0{buffer;byteLength;byteOffset;length;offset;lastWrittenByte;littleEndian;_data;_mark;_marks;constructor(e=rD,n={}){let i=!1;typeof e=="number"?e=new ArrayBuffer(e):(i=!0,this.lastWrittenByte=e.byteLength);const r=n.offset?n.offset>>>0:0,s=e.byteLength-r;let a=r;(ArrayBuffer.isView(e)||e instanceof l0)&&(e.byteLength!==e.buffer.byteLength&&(a=e.byteOffset+r),e=e.buffer),i?this.lastWrittenByte=s:this.lastWrittenByte=0,this.buffer=e,this.length=s,this.byteLength=s,this.byteOffset=a,this.offset=0,this.littleEndian=!0,this._data=new DataView(this.buffer,a,s),this._mark=0,this._marks=[]}available(e=1){return this.offset+e<=this.length}isLittleEndian(){return this.littleEndian}setLittleEndian(){return this.littleEndian=!0,this}isBigEndian(){return!this.littleEndian}setBigEndian(){return this.littleEndian=!1,this}skip(e=1){return this.offset+=e,this}back(e=1){return this.offset-=e,this}seek(e){return this.offset=e,this}mark(){return this._mark=this.offset,this}reset(){return this.offset=this._mark,this}pushMark(){return this._marks.push(this.offset),this}popMark(){const e=this._marks.pop();if(e===void 0)throw new Error("Mark stack empty");return this.seek(e),this}rewind(){return this.offset=0,this}ensureAvailable(e=1){if(!this.available(e)){const i=(this.offset+e)*2,r=new Uint8Array(i);r.set(new Uint8Array(this.buffer)),this.buffer=r.buffer,this.length=i,this.byteLength=i,this._data=new DataView(this.buffer)}return this}readBoolean(){return this.readUint8()!==0}readInt8(){return this._data.getInt8(this.offset++)}readUint8(){return this._data.getUint8(this.offset++)}readByte(){return this.readUint8()}readBytes(e=1){return this.readArray(e,"uint8")}readArray(e,n){const i=Ag[n].BYTES_PER_ELEMENT*e,r=this.byteOffset+this.offset,s=this.buffer.slice(r,r+i);if(this.littleEndian===sD&&n!=="uint8"&&n!=="int8"){const o=new Uint8Array(this.buffer.slice(r,r+i));o.reverse();const l=new Ag[n](o.buffer);return this.offset+=i,l.reverse(),l}const a=new Ag[n](s);return this.offset+=i,a}readInt16(){const e=this._data.getInt16(this.offset,this.littleEndian);return this.offset+=2,e}readUint16(){const e=this._data.getUint16(this.offset,this.littleEndian);return this.offset+=2,e}readInt32(){const e=this._data.getInt32(this.offset,this.littleEndian);return this.offset+=4,e}readUint32(){const e=this._data.getUint32(this.offset,this.littleEndian);return this.offset+=4,e}readFloat32(){const e=this._data.getFloat32(this.offset,this.littleEndian);return this.offset+=4,e}readFloat64(){const e=this._data.getFloat64(this.offset,this.littleEndian);return this.offset+=8,e}readBigInt64(){const e=this._data.getBigInt64(this.offset,this.littleEndian);return this.offset+=8,e}readBigUint64(){const e=this._data.getBigUint64(this.offset,this.littleEndian);return this.offset+=8,e}readChar(){return String.fromCharCode(this.readInt8())}readChars(e=1){let n="";for(let i=0;i<e;i++)n+=this.readChar();return n}readUtf8(e=1){return _2(this.readBytes(e))}decodeText(e=1,n="utf8"){return _2(this.readBytes(e),n)}writeBoolean(e){return this.writeUint8(e?255:0),this}writeInt8(e){return this.ensureAvailable(1),this._data.setInt8(this.offset++,e),this._updateLastWrittenByte(),this}writeUint8(e){return this.ensureAvailable(1),this._data.setUint8(this.offset++,e),this._updateLastWrittenByte(),this}writeByte(e){return this.writeUint8(e)}writeBytes(e){this.ensureAvailable(e.length);for(let n=0;n<e.length;n++)this._data.setUint8(this.offset++,e[n]);return this._updateLastWrittenByte(),this}writeInt16(e){return this.ensureAvailable(2),this._data.setInt16(this.offset,e,this.littleEndian),this.offset+=2,this._updateLastWrittenByte(),this}writeUint16(e){return this.ensureAvailable(2),this._data.setUint16(this.offset,e,this.littleEndian),this.offset+=2,this._updateLastWrittenByte(),this}writeInt32(e){return this.ensureAvailable(4),this._data.setInt32(this.offset,e,this.littleEndian),this.offset+=4,this._updateLastWrittenByte(),this}writeUint32(e){return this.ensureAvailable(4),this._data.setUint32(this.offset,e,this.littleEndian),this.offset+=4,this._updateLastWrittenByte(),this}writeFloat32(e){return this.ensureAvailable(4),this._data.setFloat32(this.offset,e,this.littleEndian),this.offset+=4,this._updateLastWrittenByte(),this}writeFloat64(e){return this.ensureAvailable(8),this._data.setFloat64(this.offset,e,this.littleEndian),this.offset+=8,this._updateLastWrittenByte(),this}writeBigInt64(e){return this.ensureAvailable(8),this._data.setBigInt64(this.offset,e,this.littleEndian),this.offset+=8,this._updateLastWrittenByte(),this}writeBigUint64(e){return this.ensureAvailable(8),this._data.setBigUint64(this.offset,e,this.littleEndian),this.offset+=8,this._updateLastWrittenByte(),this}writeChar(e){return this.writeUint8(e.charCodeAt(0))}writeChars(e){for(let n=0;n<e.length;n++)this.writeUint8(e.charCodeAt(n));return this}writeUtf8(e){return this.writeBytes(iD(e))}toArray(){return new Uint8Array(this.buffer,this.byteOffset,this.lastWrittenByte)}getWrittenByteLength(){return this.lastWrittenByte-this.byteOffset}_updateLastWrittenByte(){this.offset>this.lastWrittenByte&&(this.lastWrittenByte=this.offset)}}function ju(t){let e=t.length;for(;--e>=0;)t[e]=0}const aD=3,oD=258,fx=29,lD=256,cD=lD+1+fx,hx=30,uD=512,dD=new Array((cD+2)*2);ju(dD);const fD=new Array(hx*2);ju(fD);const hD=new Array(uD);ju(hD);const pD=new Array(oD-aD+1);ju(pD);const gD=new Array(fx);ju(gD);const mD=new Array(hx);ju(mD);const vD=(t,e,n,i)=>{let r=t&65535|0,s=t>>>16&65535|0,a=0;for(;n!==0;){a=n>2e3?2e3:n,n-=a;do r=r+e[i++]|0,s=s+r|0;while(--a);r%=65521,s%=65521}return r|s<<16|0};var Wm=vD;const yD=()=>{let t,e=[];for(var n=0;n<256;n++){t=n;for(var i=0;i<8;i++)t=t&1?3988292384^t>>>1:t>>>1;e[n]=t}return e},bD=new Uint32Array(yD()),wD=(t,e,n,i)=>{const r=bD,s=i+n;t^=-1;for(let a=i;a<s;a++)t=t>>>8^r[(t^e[a])&255];return t^-1};var Ja=wD,Vm={2:"need dictionary",1:"stream end",0:"","-1":"file error","-2":"stream error","-3":"data error","-4":"insufficient memory","-5":"buffer error","-6":"incompatible version"},px={Z_NO_FLUSH:0,Z_FINISH:4,Z_BLOCK:5,Z_TREES:6,Z_OK:0,Z_STREAM_END:1,Z_NEED_DICT:2,Z_STREAM_ERROR:-2,Z_DATA_ERROR:-3,Z_MEM_ERROR:-4,Z_BUF_ERROR:-5,Z_DEFLATED:8};const xD=(t,e)=>Object.prototype.hasOwnProperty.call(t,e);var _D=function(t){const e=Array.prototype.slice.call(arguments,1);for(;e.length;){const n=e.shift();if(n){if(typeof n!="object")throw new TypeError(n+"must be non-object");for(const i in n)xD(n,i)&&(t[i]=n[i])}}return t},SD=t=>{let e=0;for(let i=0,r=t.length;i<r;i++)e+=t[i].length;const n=new Uint8Array(e);for(let i=0,r=0,s=t.length;i<s;i++){let a=t[i];n.set(a,r),r+=a.length}return n},gx={assign:_D,flattenChunks:SD};let mx=!0;try{String.fromCharCode.apply(null,new Uint8Array(1))}catch{mx=!1}const Dd=new Uint8Array(256);for(let t=0;t<256;t++)Dd[t]=t>=252?6:t>=248?5:t>=240?4:t>=224?3:t>=192?2:1;Dd[254]=Dd[254]=1;var kD=t=>{if(typeof TextEncoder=="function"&&TextEncoder.prototype.encode)return new TextEncoder().encode(t);let e,n,i,r,s,a=t.length,o=0;for(r=0;r<a;r++)n=t.charCodeAt(r),(n&64512)===55296&&r+1<a&&(i=t.charCodeAt(r+1),(i&64512)===56320&&(n=65536+(n-55296<<10)+(i-56320),r++)),o+=n<128?1:n<2048?2:n<65536?3:4;for(e=new Uint8Array(o),s=0,r=0;s<o;r++)n=t.charCodeAt(r),(n&64512)===55296&&r+1<a&&(i=t.charCodeAt(r+1),(i&64512)===56320&&(n=65536+(n-55296<<10)+(i-56320),r++)),n<128?e[s++]=n:n<2048?(e[s++]=192|n>>>6,e[s++]=128|n&63):n<65536?(e[s++]=224|n>>>12,e[s++]=128|n>>>6&63,e[s++]=128|n&63):(e[s++]=240|n>>>18,e[s++]=128|n>>>12&63,e[s++]=128|n>>>6&63,e[s++]=128|n&63);return e};const AD=(t,e)=>{if(e<65534&&t.subarray&&mx)return String.fromCharCode.apply(null,t.length===e?t:t.subarray(0,e));let n="";for(let i=0;i<e;i++)n+=String.fromCharCode(t[i]);return n};var ND=(t,e)=>{const n=e||t.length;if(typeof TextDecoder=="function"&&TextDecoder.prototype.decode)return new TextDecoder().decode(t.subarray(0,e));let i,r;const s=new Array(n*2);for(r=0,i=0;i<n;){let a=t[i++];if(a<128){s[r++]=a;continue}let o=Dd[a];if(o>4){s[r++]=65533,i+=o-1;continue}for(a&=o===2?31:o===3?15:7;o>1&&i<n;)a=a<<6|t[i++]&63,o--;if(o>1){s[r++]=65533;continue}a<65536?s[r++]=a:(a-=65536,s[r++]=55296|a>>10&1023,s[r++]=56320|a&1023)}return AD(s,r)},CD=(t,e)=>{e=e||t.length,e>t.length&&(e=t.length);let n=e-1;for(;n>=0&&(t[n]&192)===128;)n--;return n<0||n===0?e:n+Dd[t[n]]>e?n:e},Gm={string2buf:kD,buf2string:ND,utf8border:CD};function PD(){this.input=null,this.next_in=0,this.avail_in=0,this.total_in=0,this.output=null,this.next_out=0,this.avail_out=0,this.total_out=0,this.msg="",this.state=null,this.data_type=2,this.adler=0}var ED=PD;const Ff=16209,ID=16191;var LD=function(e,n){let i,r,s,a,o,l,c,u,f,h,d,y,m,x,w,S,A,_,M,I,T,D,O,W;const C=e.state;i=e.next_in,O=e.input,r=i+(e.avail_in-5),s=e.next_out,W=e.output,a=s-(n-e.avail_out),o=s+(e.avail_out-257),l=C.dmax,c=C.wsize,u=C.whave,f=C.wnext,h=C.window,d=C.hold,y=C.bits,m=C.lencode,x=C.distcode,w=(1<<C.lenbits)-1,S=(1<<C.distbits)-1;e:do{y<15&&(d+=O[i++]<<y,y+=8,d+=O[i++]<<y,y+=8),A=m[d&w];t:for(;;){if(_=A>>>24,d>>>=_,y-=_,_=A>>>16&255,_===0)W[s++]=A&65535;else if(_&16){M=A&65535,_&=15,_&&(y<_&&(d+=O[i++]<<y,y+=8),M+=d&(1<<_)-1,d>>>=_,y-=_),y<15&&(d+=O[i++]<<y,y+=8,d+=O[i++]<<y,y+=8),A=x[d&S];n:for(;;){if(_=A>>>24,d>>>=_,y-=_,_=A>>>16&255,_&16){if(I=A&65535,_&=15,y<_&&(d+=O[i++]<<y,y+=8,y<_&&(d+=O[i++]<<y,y+=8)),I+=d&(1<<_)-1,I>l){e.msg="invalid distance too far back",C.mode=Ff;break e}if(d>>>=_,y-=_,_=s-a,I>_){if(_=I-_,_>u&&C.sane){e.msg="invalid distance too far back",C.mode=Ff;break e}if(T=0,D=h,f===0){if(T+=c-_,_<M){M-=_;do W[s++]=h[T++];while(--_);T=s-I,D=W}}else if(f<_){if(T+=c+f-_,_-=f,_<M){M-=_;do W[s++]=h[T++];while(--_);if(T=0,f<M){_=f,M-=_;do W[s++]=h[T++];while(--_);T=s-I,D=W}}}else if(T+=f-_,_<M){M-=_;do W[s++]=h[T++];while(--_);T=s-I,D=W}for(;M>2;)W[s++]=D[T++],W[s++]=D[T++],W[s++]=D[T++],M-=3;M&&(W[s++]=D[T++],M>1&&(W[s++]=D[T++]))}else{T=s-I;do W[s++]=W[T++],W[s++]=W[T++],W[s++]=W[T++],M-=3;while(M>2);M&&(W[s++]=W[T++],M>1&&(W[s++]=W[T++]))}}else if((_&64)===0){A=x[(A&65535)+(d&(1<<_)-1)];continue n}else{e.msg="invalid distance code",C.mode=Ff;break e}break}}else if((_&64)===0){A=m[(A&65535)+(d&(1<<_)-1)];continue t}else if(_&32){C.mode=ID;break e}else{e.msg="invalid literal/length code",C.mode=Ff;break e}break}}while(i<r&&s<o);M=y>>3,i-=M,y-=M<<3,d&=(1<<y)-1,e.next_in=i,e.next_out=s,e.avail_in=i<r?5+(r-i):5-(i-r),e.avail_out=s<o?257+(o-s):257-(s-o),C.hold=d,C.bits=y};const Jc=15,S2=852,k2=592,A2=0,Ng=1,N2=2,MD=new Uint16Array([3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,0,0]),TD=new Uint8Array([16,16,16,16,16,16,16,16,17,17,17,17,18,18,18,18,19,19,19,19,20,20,20,20,21,21,21,21,16,72,78]),DD=new Uint16Array([1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577,0,0]),OD=new Uint8Array([16,16,16,16,17,17,18,18,19,19,20,20,21,21,22,22,23,23,24,24,25,25,26,26,27,27,28,28,29,29,64,64]),FD=(t,e,n,i,r,s,a,o)=>{const l=o.bits;let c=0,u=0,f=0,h=0,d=0,y=0,m=0,x=0,w=0,S=0,A,_,M,I,T,D=null,O;const W=new Uint16Array(Jc+1),C=new Uint16Array(Jc+1);let N=null,B,E,R;for(c=0;c<=Jc;c++)W[c]=0;for(u=0;u<i;u++)W[e[n+u]]++;for(d=l,h=Jc;h>=1&&W[h]===0;h--);if(d>h&&(d=h),h===0)return r[s++]=1<<24|64<<16|0,r[s++]=1<<24|64<<16|0,o.bits=1,0;for(f=1;f<h&&W[f]===0;f++);for(d<f&&(d=f),x=1,c=1;c<=Jc;c++)if(x<<=1,x-=W[c],x<0)return-1;if(x>0&&(t===A2||h!==1))return-1;for(C[1]=0,c=1;c<Jc;c++)C[c+1]=C[c]+W[c];for(u=0;u<i;u++)e[n+u]!==0&&(a[C[e[n+u]]++]=u);if(t===A2?(D=N=a,O=20):t===Ng?(D=MD,N=TD,O=257):(D=DD,N=OD,O=0),S=0,u=0,c=f,T=s,y=d,m=0,M=-1,w=1<<d,I=w-1,t===Ng&&w>S2||t===N2&&w>k2)return 1;for(;;){B=c-m,a[u]+1<O?(E=0,R=a[u]):a[u]>=O?(E=N[a[u]-O],R=D[a[u]-O]):(E=96,R=0),A=1<<c-m,_=1<<y,f=_;do _-=A,r[T+(S>>m)+_]=B<<24|E<<16|R|0;while(_!==0);for(A=1<<c-1;S&A;)A>>=1;if(A!==0?(S&=A-1,S+=A):S=0,u++,--W[c]===0){if(c===h)break;c=e[n+a[u]]}if(c>d&&(S&I)!==M){for(m===0&&(m=d),T+=f,y=c-m,x=1<<y;y+m<h&&(x-=W[y+m],!(x<=0));)y++,x<<=1;if(w+=1<<y,t===Ng&&w>S2||t===N2&&w>k2)return 1;M=S&I,r[M]=d<<24|y<<16|T-s|0}}return S!==0&&(r[T+S]=c-m<<24|64<<16|0),o.bits=d,0};var xd=FD;const RD=0,vx=1,yx=2,{Z_FINISH:C2,Z_BLOCK:BD,Z_TREES:Rf,Z_OK:Pc,Z_STREAM_END:zD,Z_NEED_DICT:qD,Z_STREAM_ERROR:aa,Z_DATA_ERROR:bx,Z_MEM_ERROR:wx,Z_BUF_ERROR:jD,Z_DEFLATED:P2}=px,wp=16180,E2=16181,I2=16182,L2=16183,M2=16184,T2=16185,D2=16186,O2=16187,F2=16188,R2=16189,Uh=16190,Wo=16191,Cg=16192,B2=16193,Pg=16194,z2=16195,q2=16196,j2=16197,H2=16198,Bf=16199,zf=16200,U2=16201,W2=16202,V2=16203,G2=16204,X2=16205,Eg=16206,Y2=16207,K2=16208,vi=16209,xx=16210,_x=16211,HD=852,UD=592,WD=15,VD=WD,Z2=t=>(t>>>24&255)+(t>>>8&65280)+((t&65280)<<8)+((t&255)<<24);function GD(){this.strm=null,this.mode=0,this.last=!1,this.wrap=0,this.havedict=!1,this.flags=0,this.dmax=0,this.check=0,this.total=0,this.head=null,this.wbits=0,this.wsize=0,this.whave=0,this.wnext=0,this.window=null,this.hold=0,this.bits=0,this.length=0,this.offset=0,this.extra=0,this.lencode=null,this.distcode=null,this.lenbits=0,this.distbits=0,this.ncode=0,this.nlen=0,this.ndist=0,this.have=0,this.next=null,this.lens=new Uint16Array(320),this.work=new Uint16Array(288),this.lendyn=null,this.distdyn=null,this.sane=0,this.back=0,this.was=0}const Rc=t=>{if(!t)return 1;const e=t.state;return!e||e.strm!==t||e.mode<wp||e.mode>_x?1:0},Sx=t=>{if(Rc(t))return aa;const e=t.state;return t.total_in=t.total_out=e.total=0,t.msg="",e.wrap&&(t.adler=e.wrap&1),e.mode=wp,e.last=0,e.havedict=0,e.flags=-1,e.dmax=32768,e.head=null,e.hold=0,e.bits=0,e.lencode=e.lendyn=new Int32Array(HD),e.distcode=e.distdyn=new Int32Array(UD),e.sane=1,e.back=-1,Pc},kx=t=>{if(Rc(t))return aa;const e=t.state;return e.wsize=0,e.whave=0,e.wnext=0,Sx(t)},Ax=(t,e)=>{let n;if(Rc(t))return aa;const i=t.state;return e<0?(n=0,e=-e):(n=(e>>4)+5,e<48&&(e&=15)),e&&(e<8||e>15)?aa:(i.window!==null&&i.wbits!==e&&(i.window=null),i.wrap=n,i.wbits=e,kx(t))},Nx=(t,e)=>{if(!t)return aa;const n=new GD;t.state=n,n.strm=t,n.window=null,n.mode=wp;const i=Ax(t,e);return i!==Pc&&(t.state=null),i},XD=t=>Nx(t,VD);let J2=!0,Ig,Lg;const YD=t=>{if(J2){Ig=new Int32Array(512),Lg=new Int32Array(32);let e=0;for(;e<144;)t.lens[e++]=8;for(;e<256;)t.lens[e++]=9;for(;e<280;)t.lens[e++]=7;for(;e<288;)t.lens[e++]=8;for(xd(vx,t.lens,0,288,Ig,0,t.work,{bits:9}),e=0;e<32;)t.lens[e++]=5;xd(yx,t.lens,0,32,Lg,0,t.work,{bits:5}),J2=!1}t.lencode=Ig,t.lenbits=9,t.distcode=Lg,t.distbits=5},Cx=(t,e,n,i)=>{let r;const s=t.state;return s.window===null&&(s.wsize=1<<s.wbits,s.wnext=0,s.whave=0,s.window=new Uint8Array(s.wsize)),i>=s.wsize?(s.window.set(e.subarray(n-s.wsize,n),0),s.wnext=0,s.whave=s.wsize):(r=s.wsize-s.wnext,r>i&&(r=i),s.window.set(e.subarray(n-i,n-i+r),s.wnext),i-=r,i?(s.window.set(e.subarray(n-i,n),0),s.wnext=i,s.whave=s.wsize):(s.wnext+=r,s.wnext===s.wsize&&(s.wnext=0),s.whave<s.wsize&&(s.whave+=r))),0},KD=(t,e)=>{let n,i,r,s,a,o,l,c,u,f,h,d,y,m,x=0,w,S,A,_,M,I,T,D;const O=new Uint8Array(4);let W,C;const N=new Uint8Array([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]);if(Rc(t)||!t.output||!t.input&&t.avail_in!==0)return aa;n=t.state,n.mode===Wo&&(n.mode=Cg),a=t.next_out,r=t.output,l=t.avail_out,s=t.next_in,i=t.input,o=t.avail_in,c=n.hold,u=n.bits,f=o,h=l,D=Pc;e:for(;;)switch(n.mode){case wp:if(n.wrap===0){n.mode=Cg;break}for(;u<16;){if(o===0)break e;o--,c+=i[s++]<<u,u+=8}if(n.wrap&2&&c===35615){n.wbits===0&&(n.wbits=15),n.check=0,O[0]=c&255,O[1]=c>>>8&255,n.check=Ja(n.check,O,2,0),c=0,u=0,n.mode=E2;break}if(n.head&&(n.head.done=!1),!(n.wrap&1)||(((c&255)<<8)+(c>>8))%31){t.msg="incorrect header check",n.mode=vi;break}if((c&15)!==P2){t.msg="unknown compression method",n.mode=vi;break}if(c>>>=4,u-=4,T=(c&15)+8,n.wbits===0&&(n.wbits=T),T>15||T>n.wbits){t.msg="invalid window size",n.mode=vi;break}n.dmax=1<<n.wbits,n.flags=0,t.adler=n.check=1,n.mode=c&512?R2:Wo,c=0,u=0;break;case E2:for(;u<16;){if(o===0)break e;o--,c+=i[s++]<<u,u+=8}if(n.flags=c,(n.flags&255)!==P2){t.msg="unknown compression method",n.mode=vi;break}if(n.flags&57344){t.msg="unknown header flags set",n.mode=vi;break}n.head&&(n.head.text=c>>8&1),n.flags&512&&n.wrap&4&&(O[0]=c&255,O[1]=c>>>8&255,n.check=Ja(n.check,O,2,0)),c=0,u=0,n.mode=I2;case I2:for(;u<32;){if(o===0)break e;o--,c+=i[s++]<<u,u+=8}n.head&&(n.head.time=c),n.flags&512&&n.wrap&4&&(O[0]=c&255,O[1]=c>>>8&255,O[2]=c>>>16&255,O[3]=c>>>24&255,n.check=Ja(n.check,O,4,0)),c=0,u=0,n.mode=L2;case L2:for(;u<16;){if(o===0)break e;o--,c+=i[s++]<<u,u+=8}n.head&&(n.head.xflags=c&255,n.head.os=c>>8),n.flags&512&&n.wrap&4&&(O[0]=c&255,O[1]=c>>>8&255,n.check=Ja(n.check,O,2,0)),c=0,u=0,n.mode=M2;case M2:if(n.flags&1024){for(;u<16;){if(o===0)break e;o--,c+=i[s++]<<u,u+=8}n.length=c,n.head&&(n.head.extra_len=c),n.flags&512&&n.wrap&4&&(O[0]=c&255,O[1]=c>>>8&255,n.check=Ja(n.check,O,2,0)),c=0,u=0}else n.head&&(n.head.extra=null);n.mode=T2;case T2:if(n.flags&1024&&(d=n.length,d>o&&(d=o),d&&(n.head&&(T=n.head.extra_len-n.length,n.head.extra||(n.head.extra=new Uint8Array(n.head.extra_len)),n.head.extra.set(i.subarray(s,s+d),T)),n.flags&512&&n.wrap&4&&(n.check=Ja(n.check,i,d,s)),o-=d,s+=d,n.length-=d),n.length))break e;n.length=0,n.mode=D2;case D2:if(n.flags&2048){if(o===0)break e;d=0;do T=i[s+d++],n.head&&T&&n.length<65536&&(n.head.name+=String.fromCharCode(T));while(T&&d<o);if(n.flags&512&&n.wrap&4&&(n.check=Ja(n.check,i,d,s)),o-=d,s+=d,T)break e}else n.head&&(n.head.name=null);n.length=0,n.mode=O2;case O2:if(n.flags&4096){if(o===0)break e;d=0;do T=i[s+d++],n.head&&T&&n.length<65536&&(n.head.comment+=String.fromCharCode(T));while(T&&d<o);if(n.flags&512&&n.wrap&4&&(n.check=Ja(n.check,i,d,s)),o-=d,s+=d,T)break e}else n.head&&(n.head.comment=null);n.mode=F2;case F2:if(n.flags&512){for(;u<16;){if(o===0)break e;o--,c+=i[s++]<<u,u+=8}if(n.wrap&4&&c!==(n.check&65535)){t.msg="header crc mismatch",n.mode=vi;break}c=0,u=0}n.head&&(n.head.hcrc=n.flags>>9&1,n.head.done=!0),t.adler=n.check=0,n.mode=Wo;break;case R2:for(;u<32;){if(o===0)break e;o--,c+=i[s++]<<u,u+=8}t.adler=n.check=Z2(c),c=0,u=0,n.mode=Uh;case Uh:if(n.havedict===0)return t.next_out=a,t.avail_out=l,t.next_in=s,t.avail_in=o,n.hold=c,n.bits=u,qD;t.adler=n.check=1,n.mode=Wo;case Wo:if(e===BD||e===Rf)break e;case Cg:if(n.last){c>>>=u&7,u-=u&7,n.mode=Eg;break}for(;u<3;){if(o===0)break e;o--,c+=i[s++]<<u,u+=8}switch(n.last=c&1,c>>>=1,u-=1,c&3){case 0:n.mode=B2;break;case 1:if(YD(n),n.mode=Bf,e===Rf){c>>>=2,u-=2;break e}break;case 2:n.mode=q2;break;case 3:t.msg="invalid block type",n.mode=vi}c>>>=2,u-=2;break;case B2:for(c>>>=u&7,u-=u&7;u<32;){if(o===0)break e;o--,c+=i[s++]<<u,u+=8}if((c&65535)!==(c>>>16^65535)){t.msg="invalid stored block lengths",n.mode=vi;break}if(n.length=c&65535,c=0,u=0,n.mode=Pg,e===Rf)break e;case Pg:n.mode=z2;case z2:if(d=n.length,d){if(d>o&&(d=o),d>l&&(d=l),d===0)break e;r.set(i.subarray(s,s+d),a),o-=d,s+=d,l-=d,a+=d,n.length-=d;break}n.mode=Wo;break;case q2:for(;u<14;){if(o===0)break e;o--,c+=i[s++]<<u,u+=8}if(n.nlen=(c&31)+257,c>>>=5,u-=5,n.ndist=(c&31)+1,c>>>=5,u-=5,n.ncode=(c&15)+4,c>>>=4,u-=4,n.nlen>286||n.ndist>30){t.msg="too many length or distance symbols",n.mode=vi;break}n.have=0,n.mode=j2;case j2:for(;n.have<n.ncode;){for(;u<3;){if(o===0)break e;o--,c+=i[s++]<<u,u+=8}n.lens[N[n.have++]]=c&7,c>>>=3,u-=3}for(;n.have<19;)n.lens[N[n.have++]]=0;if(n.lencode=n.lendyn,n.lenbits=7,W={bits:n.lenbits},D=xd(RD,n.lens,0,19,n.lencode,0,n.work,W),n.lenbits=W.bits,D){t.msg="invalid code lengths set",n.mode=vi;break}n.have=0,n.mode=H2;case H2:for(;n.have<n.nlen+n.ndist;){for(;x=n.lencode[c&(1<<n.lenbits)-1],w=x>>>24,S=x>>>16&255,A=x&65535,!(w<=u);){if(o===0)break e;o--,c+=i[s++]<<u,u+=8}if(A<16)c>>>=w,u-=w,n.lens[n.have++]=A;else{if(A===16){for(C=w+2;u<C;){if(o===0)break e;o--,c+=i[s++]<<u,u+=8}if(c>>>=w,u-=w,n.have===0){t.msg="invalid bit length repeat",n.mode=vi;break}T=n.lens[n.have-1],d=3+(c&3),c>>>=2,u-=2}else if(A===17){for(C=w+3;u<C;){if(o===0)break e;o--,c+=i[s++]<<u,u+=8}c>>>=w,u-=w,T=0,d=3+(c&7),c>>>=3,u-=3}else{for(C=w+7;u<C;){if(o===0)break e;o--,c+=i[s++]<<u,u+=8}c>>>=w,u-=w,T=0,d=11+(c&127),c>>>=7,u-=7}if(n.have+d>n.nlen+n.ndist){t.msg="invalid bit length repeat",n.mode=vi;break}for(;d--;)n.lens[n.have++]=T}}if(n.mode===vi)break;if(n.lens[256]===0){t.msg="invalid code -- missing end-of-block",n.mode=vi;break}if(n.lenbits=9,W={bits:n.lenbits},D=xd(vx,n.lens,0,n.nlen,n.lencode,0,n.work,W),n.lenbits=W.bits,D){t.msg="invalid literal/lengths set",n.mode=vi;break}if(n.distbits=6,n.distcode=n.distdyn,W={bits:n.distbits},D=xd(yx,n.lens,n.nlen,n.ndist,n.distcode,0,n.work,W),n.distbits=W.bits,D){t.msg="invalid distances set",n.mode=vi;break}if(n.mode=Bf,e===Rf)break e;case Bf:n.mode=zf;case zf:if(o>=6&&l>=258){t.next_out=a,t.avail_out=l,t.next_in=s,t.avail_in=o,n.hold=c,n.bits=u,LD(t,h),a=t.next_out,r=t.output,l=t.avail_out,s=t.next_in,i=t.input,o=t.avail_in,c=n.hold,u=n.bits,n.mode===Wo&&(n.back=-1);break}for(n.back=0;x=n.lencode[c&(1<<n.lenbits)-1],w=x>>>24,S=x>>>16&255,A=x&65535,!(w<=u);){if(o===0)break e;o--,c+=i[s++]<<u,u+=8}if(S&&(S&240)===0){for(_=w,M=S,I=A;x=n.lencode[I+((c&(1<<_+M)-1)>>_)],w=x>>>24,S=x>>>16&255,A=x&65535,!(_+w<=u);){if(o===0)break e;o--,c+=i[s++]<<u,u+=8}c>>>=_,u-=_,n.back+=_}if(c>>>=w,u-=w,n.back+=w,n.length=A,S===0){n.mode=X2;break}if(S&32){n.back=-1,n.mode=Wo;break}if(S&64){t.msg="invalid literal/length code",n.mode=vi;break}n.extra=S&15,n.mode=U2;case U2:if(n.extra){for(C=n.extra;u<C;){if(o===0)break e;o--,c+=i[s++]<<u,u+=8}n.length+=c&(1<<n.extra)-1,c>>>=n.extra,u-=n.extra,n.back+=n.extra}n.was=n.length,n.mode=W2;case W2:for(;x=n.distcode[c&(1<<n.distbits)-1],w=x>>>24,S=x>>>16&255,A=x&65535,!(w<=u);){if(o===0)break e;o--,c+=i[s++]<<u,u+=8}if((S&240)===0){for(_=w,M=S,I=A;x=n.distcode[I+((c&(1<<_+M)-1)>>_)],w=x>>>24,S=x>>>16&255,A=x&65535,!(_+w<=u);){if(o===0)break e;o--,c+=i[s++]<<u,u+=8}c>>>=_,u-=_,n.back+=_}if(c>>>=w,u-=w,n.back+=w,S&64){t.msg="invalid distance code",n.mode=vi;break}n.offset=A,n.extra=S&15,n.mode=V2;case V2:if(n.extra){for(C=n.extra;u<C;){if(o===0)break e;o--,c+=i[s++]<<u,u+=8}n.offset+=c&(1<<n.extra)-1,c>>>=n.extra,u-=n.extra,n.back+=n.extra}if(n.offset>n.dmax){t.msg="invalid distance too far back",n.mode=vi;break}n.mode=G2;case G2:if(l===0)break e;if(d=h-l,n.offset>d){if(d=n.offset-d,d>n.whave&&n.sane){t.msg="invalid distance too far back",n.mode=vi;break}d>n.wnext?(d-=n.wnext,y=n.wsize-d):y=n.wnext-d,d>n.length&&(d=n.length),m=n.window}else m=r,y=a-n.offset,d=n.length;d>l&&(d=l),l-=d,n.length-=d;do r[a++]=m[y++];while(--d);n.length===0&&(n.mode=zf);break;case X2:if(l===0)break e;r[a++]=n.length,l--,n.mode=zf;break;case Eg:if(n.wrap){for(;u<32;){if(o===0)break e;o--,c|=i[s++]<<u,u+=8}if(h-=l,t.total_out+=h,n.total+=h,n.wrap&4&&h&&(t.adler=n.check=n.flags?Ja(n.check,r,h,a-h):Wm(n.check,r,h,a-h)),h=l,n.wrap&4&&(n.flags?c:Z2(c))!==n.check){t.msg="incorrect data check",n.mode=vi;break}c=0,u=0}n.mode=Y2;case Y2:if(n.wrap&&n.flags){for(;u<32;){if(o===0)break e;o--,c+=i[s++]<<u,u+=8}if(n.wrap&4&&c!==(n.total&4294967295)){t.msg="incorrect length check",n.mode=vi;break}c=0,u=0}n.mode=K2;case K2:D=zD;break e;case vi:D=bx;break e;case xx:return wx;case _x:default:return aa}return t.next_out=a,t.avail_out=l,t.next_in=s,t.avail_in=o,n.hold=c,n.bits=u,(n.wsize||h!==t.avail_out&&n.mode<vi&&(n.mode<Eg||e!==C2))&&Cx(t,t.output,t.next_out,h-t.avail_out),f-=t.avail_in,h-=t.avail_out,t.total_in+=f,t.total_out+=h,n.total+=h,n.wrap&4&&h&&(t.adler=n.check=n.flags?Ja(n.check,r,h,t.next_out-h):Wm(n.check,r,h,t.next_out-h)),t.data_type=n.bits+(n.last?64:0)+(n.mode===Wo?128:0)+(n.mode===Bf||n.mode===Pg?256:0),(f===0&&h===0||e===C2)&&D===Pc&&(D=jD),D},ZD=t=>{if(Rc(t))return aa;let e=t.state;return e.window&&(e.window=null),t.state=null,Pc},JD=(t,e)=>{if(Rc(t))return aa;const n=t.state;return(n.wrap&2)===0?aa:(n.head=e,e.done=!1,Pc)},QD=(t,e)=>{const n=e.length;let i,r,s;return Rc(t)||(i=t.state,i.wrap!==0&&i.mode!==Uh)?aa:i.mode===Uh&&(r=1,r=Wm(r,e,n,0),r!==i.check)?bx:(s=Cx(t,e,n,n),s?(i.mode=xx,wx):(i.havedict=1,Pc))};var $D=kx,eO=Ax,tO=Sx,nO=XD,iO=Nx,rO=KD,sO=ZD,aO=JD,oO=QD,lO="pako inflate (from Nodeca project)",Xo={inflateReset:$D,inflateReset2:eO,inflateResetKeep:tO,inflateInit:nO,inflateInit2:iO,inflate:rO,inflateEnd:sO,inflateGetHeader:aO,inflateSetDictionary:oO,inflateInfo:lO};function cO(){this.text=0,this.time=0,this.xflags=0,this.os=0,this.extra=null,this.extra_len=0,this.name="",this.comment="",this.hcrc=0,this.done=!1}var uO=cO;const Px=Object.prototype.toString,{Z_NO_FLUSH:dO,Z_FINISH:fO,Z_OK:Od,Z_STREAM_END:Mg,Z_NEED_DICT:Tg,Z_STREAM_ERROR:hO,Z_DATA_ERROR:Q2,Z_MEM_ERROR:pO}=px;function Gd(t){this.options=gx.assign({chunkSize:1024*64,windowBits:15,to:""},t||{});const e=this.options;e.raw&&e.windowBits>=0&&e.windowBits<16&&(e.windowBits=-e.windowBits,e.windowBits===0&&(e.windowBits=-15)),e.windowBits>=0&&e.windowBits<16&&!(t&&t.windowBits)&&(e.windowBits+=32),e.windowBits>15&&e.windowBits<48&&(e.windowBits&15)===0&&(e.windowBits|=15),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new ED,this.strm.avail_out=0;let n=Xo.inflateInit2(this.strm,e.windowBits);if(n!==Od)throw new Error(Vm[n]);if(this.header=new uO,Xo.inflateGetHeader(this.strm,this.header),e.dictionary&&(typeof e.dictionary=="string"?e.dictionary=Gm.string2buf(e.dictionary):Px.call(e.dictionary)==="[object ArrayBuffer]"&&(e.dictionary=new Uint8Array(e.dictionary)),e.raw&&(n=Xo.inflateSetDictionary(this.strm,e.dictionary),n!==Od)))throw new Error(Vm[n])}Gd.prototype.push=function(t,e){const n=this.strm,i=this.options.chunkSize,r=this.options.dictionary;let s,a,o;if(this.ended)return!1;for(e===~~e?a=e:a=e===!0?fO:dO,Px.call(t)==="[object ArrayBuffer]"?n.input=new Uint8Array(t):n.input=t,n.next_in=0,n.avail_in=n.input.length;;){for(n.avail_out===0&&(n.output=new Uint8Array(i),n.next_out=0,n.avail_out=i),s=Xo.inflate(n,a),s===Tg&&r&&(s=Xo.inflateSetDictionary(n,r),s===Od?s=Xo.inflate(n,a):s===Q2&&(s=Tg));n.avail_in>0&&s===Mg&&n.state.wrap>0&&t[n.next_in]!==0;)Xo.inflateReset(n),s=Xo.inflate(n,a);switch(s){case hO:case Q2:case Tg:case pO:return this.onEnd(s),this.ended=!0,!1}if(o=n.avail_out,n.next_out&&(n.avail_out===0||s===Mg))if(this.options.to==="string"){let l=Gm.utf8border(n.output,n.next_out),c=n.next_out-l,u=Gm.buf2string(n.output,l);n.next_out=c,n.avail_out=i-c,c&&n.output.set(n.output.subarray(l,l+c),0),this.onData(u)}else this.onData(n.output.length===n.next_out?n.output:n.output.subarray(0,n.next_out));if(!(s===Od&&o===0)){if(s===Mg)return s=Xo.inflateEnd(this.strm),this.onEnd(s),this.ended=!0,!0;if(n.avail_in===0)break}}return!0};Gd.prototype.onData=function(t){this.chunks.push(t)};Gd.prototype.onEnd=function(t){t===Od&&(this.options.to==="string"?this.result=this.chunks.join(""):this.result=gx.flattenChunks(this.chunks)),this.chunks=[],this.err=t,this.msg=this.strm.msg};function gO(t,e){const n=new Gd(e);if(n.push(t),n.err)throw n.msg||Vm[n.err];return n.result}var mO=Gd,vO=gO,yO={Inflate:mO,inflate:vO};const{Inflate:bO,inflate:wO}=yO;var $2=bO,xO=wO;const Ex=[];for(let t=0;t<256;t++){let e=t;for(let n=0;n<8;n++)e&1?e=3988292384^e>>>1:e=e>>>1;Ex[t]=e}const ey=4294967295;function _O(t,e,n){let i=t;for(let r=0;r<n;r++)i=Ex[(i^e[r])&255]^i>>>8;return i}function SO(t,e){return(_O(ey,t,e)^ey)>>>0}function ty(t,e,n){const i=t.readUint32(),r=SO(new Uint8Array(t.buffer,t.byteOffset+t.offset-e-4,e),e);if(r!==i)throw new Error(`CRC mismatch for chunk ${n}. Expected ${i}, found ${r}`)}function Ix(t,e,n){for(let i=0;i<n;i++)e[i]=t[i]}function Lx(t,e,n,i){let r=0;for(;r<i;r++)e[r]=t[r];for(;r<n;r++)e[r]=t[r]+e[r-i]&255}function Mx(t,e,n,i){let r=0;if(n.length===0)for(;r<i;r++)e[r]=t[r];else for(;r<i;r++)e[r]=t[r]+n[r]&255}function Tx(t,e,n,i,r){let s=0;if(n.length===0){for(;s<r;s++)e[s]=t[s];for(;s<i;s++)e[s]=t[s]+(e[s-r]>>1)&255}else{for(;s<r;s++)e[s]=t[s]+(n[s]>>1)&255;for(;s<i;s++)e[s]=t[s]+(e[s-r]+n[s]>>1)&255}}function Dx(t,e,n,i,r){let s=0;if(n.length===0){for(;s<r;s++)e[s]=t[s];for(;s<i;s++)e[s]=t[s]+e[s-r]&255}else{for(;s<r;s++)e[s]=t[s]+n[s]&255;for(;s<i;s++)e[s]=t[s]+kO(e[s-r],n[s],n[s-r])&255}}function kO(t,e,n){const i=t+e-n,r=Math.abs(i-t),s=Math.abs(i-e),a=Math.abs(i-n);return r<=s&&r<=a?t:s<=a?e:n}function AO(t,e,n,i,r,s){switch(t){case 0:Ix(e,n,r);break;case 1:Lx(e,n,r,s);break;case 2:Mx(e,n,i,r);break;case 3:Tx(e,n,i,r,s);break;case 4:Dx(e,n,i,r,s);break;default:throw new Error(`Unsupported filter: ${t}`)}}const NO=new Uint16Array([255]),CO=new Uint8Array(NO.buffer),PO=CO[0]===255;function EO(t){const{data:e,width:n,height:i,channels:r,depth:s}=t,a=[{x:0,y:0,xStep:8,yStep:8},{x:4,y:0,xStep:8,yStep:8},{x:0,y:4,xStep:4,yStep:8},{x:2,y:0,xStep:4,yStep:4},{x:0,y:2,xStep:2,yStep:4},{x:1,y:0,xStep:2,yStep:2},{x:0,y:1,xStep:1,yStep:2}],o=Math.ceil(s/8)*r,l=new Uint8Array(i*n*o);let c=0;for(let u=0;u<7;u++){const f=a[u],h=Math.ceil((n-f.x)/f.xStep),d=Math.ceil((i-f.y)/f.yStep);if(h<=0||d<=0)continue;const y=h*o,m=new Uint8Array(y);for(let x=0;x<d;x++){const w=e[c++],S=e.subarray(c,c+y);c+=y;const A=new Uint8Array(y);AO(w,S,A,m,y,o),m.set(A);for(let _=0;_<h;_++){const M=f.x+_*f.xStep,I=f.y+x*f.yStep;if(!(M>=n||I>=i))for(let T=0;T<o;T++)l[(I*n+M)*o+T]=A[_*o+T]}}}if(s===16){const u=new Uint16Array(l.buffer);if(PO)for(let f=0;f<u.length;f++)u[f]=IO(u[f]);return u}else return l}function IO(t){return(t&255)<<8|t>>8&255}const LO=new Uint16Array([255]),MO=new Uint8Array(LO.buffer),TO=MO[0]===255,DO=new Uint8Array(0);function ny(t){const{data:e,width:n,height:i,channels:r,depth:s}=t,a=Math.ceil(s/8)*r,o=Math.ceil(s/8*r*n),l=new Uint8Array(i*o);let c=DO,u=0,f,h;for(let d=0;d<i;d++){switch(f=e.subarray(u+1,u+1+o),h=l.subarray(d*o,(d+1)*o),e[u]){case 0:Ix(f,h,o);break;case 1:Lx(f,h,o,a);break;case 2:Mx(f,h,c,o);break;case 3:Tx(f,h,c,o,a);break;case 4:Dx(f,h,c,o,a);break;default:throw new Error(`Unsupported filter: ${e[u]}`)}c=h,u+=o+1}if(s===16){const d=new Uint16Array(l.buffer);if(TO)for(let y=0;y<d.length;y++)d[y]=OO(d[y]);return d}else return l}function OO(t){return(t&255)<<8|t>>8&255}const oh=Uint8Array.of(137,80,78,71,13,10,26,10);function iy(t){if(!FO(t.readBytes(oh.length)))throw new Error("wrong PNG signature")}function FO(t){if(t.length<oh.length)return!1;for(let e=0;e<oh.length;e++)if(t[e]!==oh[e])return!1;return!0}const RO="tEXt",BO=0,Ox=new TextDecoder("latin1");function zO(t){if(jO(t),t.length===0||t.length>79)throw new Error("keyword length must be between 1 and 79")}const qO=/^[\u0000-\u00FF]*$/;function jO(t){if(!qO.test(t))throw new Error("invalid latin1 text")}function HO(t,e,n){const i=Fx(e);t[i]=UO(e,n-i.length-1)}function Fx(t){for(t.mark();t.readByte()!==BO;);const e=t.offset;t.reset();const n=Ox.decode(t.readBytes(e-t.offset-1));return t.skip(1),zO(n),n}function UO(t,e){return Ox.decode(t.readBytes(e))}const Ms={UNKNOWN:-1,GREYSCALE:0,TRUECOLOUR:2,INDEXED_COLOUR:3,GREYSCALE_ALPHA:4,TRUECOLOUR_ALPHA:6},Dg={UNKNOWN:-1,DEFLATE:0},ry={UNKNOWN:-1,ADAPTIVE:0},Og={UNKNOWN:-1,NO_INTERLACE:0,ADAM7:1},qf={NONE:0,BACKGROUND:1,PREVIOUS:2},Fg={SOURCE:0,OVER:1};class WO extends l0{_checkCrc;_inflator;_png;_apng;_end;_hasPalette;_palette;_hasTransparency;_transparency;_compressionMethod;_filterMethod;_interlaceMethod;_colorType;_isAnimated;_numberOfFrames;_numberOfPlays;_frames;_writingDataChunks;constructor(e,n={}){super(e);const{checkCrc:i=!1}=n;this._checkCrc=i,this._inflator=new $2,this._png={width:-1,height:-1,channels:-1,data:new Uint8Array(0),depth:1,text:{}},this._apng={width:-1,height:-1,channels:-1,depth:1,numberOfFrames:1,numberOfPlays:0,text:{},frames:[]},this._end=!1,this._hasPalette=!1,this._palette=[],this._hasTransparency=!1,this._transparency=new Uint16Array(0),this._compressionMethod=Dg.UNKNOWN,this._filterMethod=ry.UNKNOWN,this._interlaceMethod=Og.UNKNOWN,this._colorType=Ms.UNKNOWN,this._isAnimated=!1,this._numberOfFrames=1,this._numberOfPlays=0,this._frames=[],this._writingDataChunks=!1,this.setBigEndian()}decode(){for(iy(this);!this._end;){const e=this.readUint32(),n=this.readChars(4);this.decodeChunk(e,n)}return this.decodeImage(),this._png}decodeApng(){for(iy(this);!this._end;){const e=this.readUint32(),n=this.readChars(4);this.decodeApngChunk(e,n)}return this.decodeApngImage(),this._apng}decodeChunk(e,n){const i=this.offset;switch(n){case"IHDR":this.decodeIHDR();break;case"PLTE":this.decodePLTE(e);break;case"IDAT":this.decodeIDAT(e);break;case"IEND":this._end=!0;break;case"tRNS":this.decodetRNS(e);break;case"iCCP":this.decodeiCCP(e);break;case RO:HO(this._png.text,this,e);break;case"pHYs":this.decodepHYs();break;default:this.skip(e);break}if(this.offset-i!==e)throw new Error(`Length mismatch while decoding chunk ${n}`);this._checkCrc?ty(this,e+4,n):this.skip(4)}decodeApngChunk(e,n){const i=this.offset;switch(n!=="fdAT"&&n!=="IDAT"&&this._writingDataChunks&&this.pushDataToFrame(),n){case"acTL":this.decodeACTL();break;case"fcTL":this.decodeFCTL();break;case"fdAT":this.decodeFDAT(e);break;default:this.decodeChunk(e,n),this.offset=i+e;break}if(this.offset-i!==e)throw new Error(`Length mismatch while decoding chunk ${n}`);this._checkCrc?ty(this,e+4,n):this.skip(4)}decodeIHDR(){const e=this._png;e.width=this.readUint32(),e.height=this.readUint32(),e.depth=VO(this.readUint8());const n=this.readUint8();this._colorType=n;let i;switch(n){case Ms.GREYSCALE:i=1;break;case Ms.TRUECOLOUR:i=3;break;case Ms.INDEXED_COLOUR:i=1;break;case Ms.GREYSCALE_ALPHA:i=2;break;case Ms.TRUECOLOUR_ALPHA:i=4;break;case Ms.UNKNOWN:default:throw new Error(`Unknown color type: ${n}`)}if(this._png.channels=i,this._compressionMethod=this.readUint8(),this._compressionMethod!==Dg.DEFLATE)throw new Error(`Unsupported compression method: ${this._compressionMethod}`);this._filterMethod=this.readUint8(),this._interlaceMethod=this.readUint8()}decodeACTL(){this._numberOfFrames=this.readUint32(),this._numberOfPlays=this.readUint32(),this._isAnimated=!0}decodeFCTL(){const e={sequenceNumber:this.readUint32(),width:this.readUint32(),height:this.readUint32(),xOffset:this.readUint32(),yOffset:this.readUint32(),delayNumber:this.readUint16(),delayDenominator:this.readUint16(),disposeOp:this.readUint8(),blendOp:this.readUint8(),data:new Uint8Array(0)};this._frames.push(e)}decodePLTE(e){if(e%3!==0)throw new RangeError(`PLTE field length must be a multiple of 3. Got ${e}`);const n=e/3;this._hasPalette=!0;const i=[];this._palette=i;for(let r=0;r<n;r++)i.push([this.readUint8(),this.readUint8(),this.readUint8()])}decodeIDAT(e){this._writingDataChunks=!0;const n=e,i=this.offset+this.byteOffset;if(this._inflator.push(new Uint8Array(this.buffer,i,n)),this._inflator.err)throw new Error(`Error while decompressing the data: ${this._inflator.err}`);this.skip(e)}decodeFDAT(e){this._writingDataChunks=!0;let n=e,i=this.offset+this.byteOffset;if(i+=4,n-=4,this._inflator.push(new Uint8Array(this.buffer,i,n)),this._inflator.err)throw new Error(`Error while decompressing the data: ${this._inflator.err}`);this.skip(e)}decodetRNS(e){switch(this._colorType){case Ms.GREYSCALE:case Ms.TRUECOLOUR:{if(e%2!==0)throw new RangeError(`tRNS chunk length must be a multiple of 2. Got ${e}`);if(e/2>this._png.width*this._png.height)throw new Error(`tRNS chunk contains more alpha values than there are pixels (${e/2} vs ${this._png.width*this._png.height})`);this._hasTransparency=!0,this._transparency=new Uint16Array(e/2);for(let n=0;n<e/2;n++)this._transparency[n]=this.readUint16();break}case Ms.INDEXED_COLOUR:{if(e>this._palette.length)throw new Error(`tRNS chunk contains more alpha values than there are palette colors (${e} vs ${this._palette.length})`);let n=0;for(;n<e;n++){const i=this.readByte();this._palette[n].push(i)}for(;n<this._palette.length;n++)this._palette[n].push(255);break}case Ms.UNKNOWN:case Ms.GREYSCALE_ALPHA:case Ms.TRUECOLOUR_ALPHA:default:throw new Error(`tRNS chunk is not supported for color type ${this._colorType}`)}}decodeiCCP(e){const n=Fx(this),i=this.readUint8();if(i!==Dg.DEFLATE)throw new Error(`Unsupported iCCP compression method: ${i}`);const r=this.readBytes(e-n.length-2);this._png.iccEmbeddedProfile={name:n,profile:xO(r)}}decodepHYs(){const e=this.readUint32(),n=this.readUint32(),i=this.readByte();this._png.resolution={x:e,y:n,unit:i}}decodeApngImage(){this._apng.width=this._png.width,this._apng.height=this._png.height,this._apng.channels=this._png.channels,this._apng.depth=this._png.depth,this._apng.numberOfFrames=this._numberOfFrames,this._apng.numberOfPlays=this._numberOfPlays,this._apng.text=this._png.text,this._apng.resolution=this._png.resolution;for(let e=0;e<this._numberOfFrames;e++){const n={sequenceNumber:this._frames[e].sequenceNumber,delayNumber:this._frames[e].delayNumber,delayDenominator:this._frames[e].delayDenominator,data:this._apng.depth===8?new Uint8Array(this._apng.width*this._apng.height*this._apng.channels):new Uint16Array(this._apng.width*this._apng.height*this._apng.channels)},i=this._frames.at(e);if(i){if(i.data=ny({data:i.data,width:i.width,height:i.height,channels:this._apng.channels,depth:this._apng.depth}),this._hasPalette&&(this._apng.palette=this._palette),this._hasTransparency&&(this._apng.transparency=this._transparency),e===0||i.xOffset===0&&i.yOffset===0&&i.width===this._png.width&&i.height===this._png.height)n.data=i.data;else{const r=this._apng.frames.at(e-1);this.disposeFrame(i,r,n),this.addFrameDataToCanvas(n,i)}this._apng.frames.push(n)}}return this._apng}disposeFrame(e,n,i){switch(e.disposeOp){case qf.NONE:break;case qf.BACKGROUND:for(let r=0;r<this._png.height;r++)for(let s=0;s<this._png.width;s++){const a=(r*e.width+s)*this._png.channels;for(let o=0;o<this._png.channels;o++)i.data[a+o]=0}break;case qf.PREVIOUS:i.data.set(n.data);break;default:throw new Error("Unknown disposeOp")}}addFrameDataToCanvas(e,n){const i=1<<this._png.depth,r=(s,a)=>{const o=((s+n.yOffset)*this._png.width+n.xOffset+a)*this._png.channels,l=(s*n.width+a)*this._png.channels;return{index:o,frameIndex:l}};switch(n.blendOp){case Fg.SOURCE:for(let s=0;s<n.height;s++)for(let a=0;a<n.width;a++){const{index:o,frameIndex:l}=r(s,a);for(let c=0;c<this._png.channels;c++)e.data[o+c]=n.data[l+c]}break;case Fg.OVER:for(let s=0;s<n.height;s++)for(let a=0;a<n.width;a++){const{index:o,frameIndex:l}=r(s,a);for(let c=0;c<this._png.channels;c++){const u=n.data[l+this._png.channels-1]/i,f=c%(this._png.channels-1)===0?1:n.data[l+c],h=Math.floor(u*f+(1-u)*e.data[o+c]);e.data[o+c]+=h}}break;default:throw new Error("Unknown blendOp")}}decodeImage(){if(this._inflator.err)throw new Error(`Error while decompressing the data: ${this._inflator.err}`);const e=this._isAnimated?(this._frames?.at(0)).data:this._inflator.result;if(this._filterMethod!==ry.ADAPTIVE)throw new Error(`Filter method ${this._filterMethod} not supported`);if(this._interlaceMethod===Og.NO_INTERLACE)this._png.data=ny({data:e,width:this._png.width,height:this._png.height,channels:this._png.channels,depth:this._png.depth});else if(this._interlaceMethod===Og.ADAM7)this._png.data=EO({data:e,width:this._png.width,height:this._png.height,channels:this._png.channels,depth:this._png.depth});else throw new Error(`Interlace method ${this._interlaceMethod} not supported`);this._hasPalette&&(this._png.palette=this._palette),this._hasTransparency&&(this._png.transparency=this._transparency)}pushDataToFrame(){const e=this._inflator.result,n=this._frames.at(-1);n?n.data=e:this._frames.push({sequenceNumber:0,width:this._png.width,height:this._png.height,xOffset:0,yOffset:0,delayNumber:0,delayDenominator:0,disposeOp:qf.NONE,blendOp:Fg.SOURCE,data:e}),this._inflator=new $2,this._writingDataChunks=!1}}function VO(t){if(t!==1&&t!==2&&t!==4&&t!==8&&t!==16)throw new Error(`invalid bit depth: ${t}`);return t}var sy;(function(t){t[t.UNKNOWN=0]="UNKNOWN",t[t.METRE=1]="METRE"})(sy||(sy={}));function GO(t,e){return new WO(t,e).decode()}var nn=(function(){return typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:this})();function Rg(){nn.console&&typeof nn.console.log=="function"&&nn.console.log.apply(nn.console,arguments)}var Qn={log:Rg,warn:function(t){nn.console&&(typeof nn.console.warn=="function"?nn.console.warn.apply(nn.console,arguments):Rg.call(null,arguments))},error:function(t){nn.console&&(typeof nn.console.error=="function"?nn.console.error.apply(nn.console,arguments):Rg(t))}};function Bg(t,e,n){var i=new XMLHttpRequest;i.open("GET",t),i.responseType="blob",i.onload=function(){hc(i.response,e,n)},i.onerror=function(){Qn.error("could not download file")},i.send()}function ay(t){var e=new XMLHttpRequest;e.open("HEAD",t,!1);try{e.send()}catch{}return e.status>=200&&e.status<=299}function jf(t){try{t.dispatchEvent(new MouseEvent("click"))}catch{var e=document.createEvent("MouseEvents");e.initMouseEvent("click",!0,!0,window,0,0,0,80,20,!1,!1,!1,!1,0,null),t.dispatchEvent(e)}}var hc=nn.saveAs||((typeof window>"u"?"undefined":jn(window))!=="object"||window!==nn?function(){}:typeof HTMLAnchorElement<"u"&&"download"in HTMLAnchorElement.prototype?function(t,e,n){var i=nn.URL||nn.webkitURL,r=document.createElement("a");e=e||t.name||"download",r.download=e,r.rel="noopener",typeof t=="string"?(r.href=t,r.origin!==location.origin?ay(r.href)?Bg(t,e,n):jf(r,r.target="_blank"):jf(r)):(r.href=i.createObjectURL(t),setTimeout(function(){i.revokeObjectURL(r.href)},4e4),setTimeout(function(){jf(r)},0))}:"msSaveOrOpenBlob"in navigator?function(t,e,n){if(e=e||t.name||"download",typeof t=="string")if(ay(t))Bg(t,e,n);else{var i=document.createElement("a");i.href=t,i.target="_blank",setTimeout(function(){jf(i)})}else navigator.msSaveOrOpenBlob((function(r,s){return s===void 0?s={autoBom:!1}:jn(s)!=="object"&&(Qn.warn("Deprecated: Expected third argument to be a object"),s={autoBom:!s}),s.autoBom&&/^\s*(?:text\/\S*|application\/xml|\S*\/\S*\+xml)\s*;.*charset\s*=\s*utf-8/i.test(r.type)?new Blob(["\uFEFF",r],{type:r.type}):r})(t,n),e)}:function(t,e,n,i){if((i=i||open("","_blank"))&&(i.document.title=i.document.body.innerText="downloading..."),typeof t=="string")return Bg(t,e,n);var r=t.type==="application/octet-stream",s=/constructor/i.test(nn.HTMLElement)||nn.safari,a=/CriOS\/[\d]+/.test(navigator.userAgent);if((a||r&&s)&&(typeof FileReader>"u"?"undefined":jn(FileReader))==="object"){var o=new FileReader;o.onloadend=function(){var u=o.result;u=a?u:u.replace(/^data:[^;]*;/,"data:attachment/file;"),i?i.location.href=u:location=u,i=null},o.readAsDataURL(t)}else{var l=nn.URL||nn.webkitURL,c=l.createObjectURL(t);i?i.location=c:location.href=c,i=null,setTimeout(function(){l.revokeObjectURL(c)},4e4)}});function Rx(t){var e;t=t||"",this.ok=!1,t.charAt(0)=="#"&&(t=t.substr(1,6)),t={aliceblue:"f0f8ff",antiquewhite:"faebd7",aqua:"00ffff",aquamarine:"7fffd4",azure:"f0ffff",beige:"f5f5dc",bisque:"ffe4c4",black:"000000",blanchedalmond:"ffebcd",blue:"0000ff",blueviolet:"8a2be2",brown:"a52a2a",burlywood:"deb887",cadetblue:"5f9ea0",chartreuse:"7fff00",chocolate:"d2691e",coral:"ff7f50",cornflowerblue:"6495ed",cornsilk:"fff8dc",crimson:"dc143c",cyan:"00ffff",darkblue:"00008b",darkcyan:"008b8b",darkgoldenrod:"b8860b",darkgray:"a9a9a9",darkgreen:"006400",darkkhaki:"bdb76b",darkmagenta:"8b008b",darkolivegreen:"556b2f",darkorange:"ff8c00",darkorchid:"9932cc",darkred:"8b0000",darksalmon:"e9967a",darkseagreen:"8fbc8f",darkslateblue:"483d8b",darkslategray:"2f4f4f",darkturquoise:"00ced1",darkviolet:"9400d3",deeppink:"ff1493",deepskyblue:"00bfff",dimgray:"696969",dodgerblue:"1e90ff",feldspar:"d19275",firebrick:"b22222",floralwhite:"fffaf0",forestgreen:"228b22",fuchsia:"ff00ff",gainsboro:"dcdcdc",ghostwhite:"f8f8ff",gold:"ffd700",goldenrod:"daa520",gray:"808080",green:"008000",greenyellow:"adff2f",honeydew:"f0fff0",hotpink:"ff69b4",indianred:"cd5c5c",indigo:"4b0082",ivory:"fffff0",khaki:"f0e68c",lavender:"e6e6fa",lavenderblush:"fff0f5",lawngreen:"7cfc00",lemonchiffon:"fffacd",lightblue:"add8e6",lightcoral:"f08080",lightcyan:"e0ffff",lightgoldenrodyellow:"fafad2",lightgrey:"d3d3d3",lightgreen:"90ee90",lightpink:"ffb6c1",lightsalmon:"ffa07a",lightseagreen:"20b2aa",lightskyblue:"87cefa",lightslateblue:"8470ff",lightslategray:"778899",lightsteelblue:"b0c4de",lightyellow:"ffffe0",lime:"00ff00",limegreen:"32cd32",linen:"faf0e6",magenta:"ff00ff",maroon:"800000",mediumaquamarine:"66cdaa",mediumblue:"0000cd",mediumorchid:"ba55d3",mediumpurple:"9370d8",mediumseagreen:"3cb371",mediumslateblue:"7b68ee",mediumspringgreen:"00fa9a",mediumturquoise:"48d1cc",mediumvioletred:"c71585",midnightblue:"191970",mintcream:"f5fffa",mistyrose:"ffe4e1",moccasin:"ffe4b5",navajowhite:"ffdead",navy:"000080",oldlace:"fdf5e6",olive:"808000",olivedrab:"6b8e23",orange:"ffa500",orangered:"ff4500",orchid:"da70d6",palegoldenrod:"eee8aa",palegreen:"98fb98",paleturquoise:"afeeee",palevioletred:"d87093",papayawhip:"ffefd5",peachpuff:"ffdab9",peru:"cd853f",pink:"ffc0cb",plum:"dda0dd",powderblue:"b0e0e6",purple:"800080",red:"ff0000",rosybrown:"bc8f8f",royalblue:"4169e1",saddlebrown:"8b4513",salmon:"fa8072",sandybrown:"f4a460",seagreen:"2e8b57",seashell:"fff5ee",sienna:"a0522d",silver:"c0c0c0",skyblue:"87ceeb",slateblue:"6a5acd",slategray:"708090",snow:"fffafa",springgreen:"00ff7f",steelblue:"4682b4",tan:"d2b48c",teal:"008080",thistle:"d8bfd8",tomato:"ff6347",turquoise:"40e0d0",violet:"ee82ee",violetred:"d02090",wheat:"f5deb3",white:"ffffff",whitesmoke:"f5f5f5",yellow:"ffff00",yellowgreen:"9acd32"}[t=(t=t.replace(/ /g,"")).toLowerCase()]||t;for(var n=[{re:/^rgb\((\d{1,3}),\s*(\d{1,3}),\s*(\d{1,3})\)$/,example:["rgb(123, 234, 45)","rgb(255,234,245)"],process:function(o){return[parseInt(o[1]),parseInt(o[2]),parseInt(o[3])]}},{re:/^(\w{2})(\w{2})(\w{2})$/,example:["#00ff00","336699"],process:function(o){return[parseInt(o[1],16),parseInt(o[2],16),parseInt(o[3],16)]}},{re:/^(\w{1})(\w{1})(\w{1})$/,example:["#fb0","f0f"],process:function(o){return[parseInt(o[1]+o[1],16),parseInt(o[2]+o[2],16),parseInt(o[3]+o[3],16)]}}],i=0;i<n.length;i++){var r=n[i].re,s=n[i].process,a=r.exec(t);a&&(e=s(a),this.r=e[0],this.g=e[1],this.b=e[2],this.ok=!0)}this.r=this.r<0||isNaN(this.r)?0:this.r>255?255:this.r,this.g=this.g<0||isNaN(this.g)?0:this.g>255?255:this.g,this.b=this.b<0||isNaN(this.b)?0:this.b>255?255:this.b,this.toRGB=function(){return"rgb("+this.r+", "+this.g+", "+this.b+")"},this.toHex=function(){var o=this.r.toString(16),l=this.g.toString(16),c=this.b.toString(16);return o.length==1&&(o="0"+o),l.length==1&&(l="0"+l),c.length==1&&(c="0"+c),"#"+o+l+c}}var lh=nn.atob.bind(nn),oy=nn.btoa.bind(nn);function zg(t,e){var n=t[0],i=t[1],r=t[2],s=t[3];n=Fr(n,i,r,s,e[0],7,-680876936),s=Fr(s,n,i,r,e[1],12,-389564586),r=Fr(r,s,n,i,e[2],17,606105819),i=Fr(i,r,s,n,e[3],22,-1044525330),n=Fr(n,i,r,s,e[4],7,-176418897),s=Fr(s,n,i,r,e[5],12,1200080426),r=Fr(r,s,n,i,e[6],17,-1473231341),i=Fr(i,r,s,n,e[7],22,-45705983),n=Fr(n,i,r,s,e[8],7,1770035416),s=Fr(s,n,i,r,e[9],12,-1958414417),r=Fr(r,s,n,i,e[10],17,-42063),i=Fr(i,r,s,n,e[11],22,-1990404162),n=Fr(n,i,r,s,e[12],7,1804603682),s=Fr(s,n,i,r,e[13],12,-40341101),r=Fr(r,s,n,i,e[14],17,-1502002290),n=Rr(n,i=Fr(i,r,s,n,e[15],22,1236535329),r,s,e[1],5,-165796510),s=Rr(s,n,i,r,e[6],9,-1069501632),r=Rr(r,s,n,i,e[11],14,643717713),i=Rr(i,r,s,n,e[0],20,-373897302),n=Rr(n,i,r,s,e[5],5,-701558691),s=Rr(s,n,i,r,e[10],9,38016083),r=Rr(r,s,n,i,e[15],14,-660478335),i=Rr(i,r,s,n,e[4],20,-405537848),n=Rr(n,i,r,s,e[9],5,568446438),s=Rr(s,n,i,r,e[14],9,-1019803690),r=Rr(r,s,n,i,e[3],14,-187363961),i=Rr(i,r,s,n,e[8],20,1163531501),n=Rr(n,i,r,s,e[13],5,-1444681467),s=Rr(s,n,i,r,e[2],9,-51403784),r=Rr(r,s,n,i,e[7],14,1735328473),n=Br(n,i=Rr(i,r,s,n,e[12],20,-1926607734),r,s,e[5],4,-378558),s=Br(s,n,i,r,e[8],11,-2022574463),r=Br(r,s,n,i,e[11],16,1839030562),i=Br(i,r,s,n,e[14],23,-35309556),n=Br(n,i,r,s,e[1],4,-1530992060),s=Br(s,n,i,r,e[4],11,1272893353),r=Br(r,s,n,i,e[7],16,-155497632),i=Br(i,r,s,n,e[10],23,-1094730640),n=Br(n,i,r,s,e[13],4,681279174),s=Br(s,n,i,r,e[0],11,-358537222),r=Br(r,s,n,i,e[3],16,-722521979),i=Br(i,r,s,n,e[6],23,76029189),n=Br(n,i,r,s,e[9],4,-640364487),s=Br(s,n,i,r,e[12],11,-421815835),r=Br(r,s,n,i,e[15],16,530742520),n=zr(n,i=Br(i,r,s,n,e[2],23,-995338651),r,s,e[0],6,-198630844),s=zr(s,n,i,r,e[7],10,1126891415),r=zr(r,s,n,i,e[14],15,-1416354905),i=zr(i,r,s,n,e[5],21,-57434055),n=zr(n,i,r,s,e[12],6,1700485571),s=zr(s,n,i,r,e[3],10,-1894986606),r=zr(r,s,n,i,e[10],15,-1051523),i=zr(i,r,s,n,e[1],21,-2054922799),n=zr(n,i,r,s,e[8],6,1873313359),s=zr(s,n,i,r,e[15],10,-30611744),r=zr(r,s,n,i,e[6],15,-1560198380),i=zr(i,r,s,n,e[13],21,1309151649),n=zr(n,i,r,s,e[4],6,-145523070),s=zr(s,n,i,r,e[11],10,-1120210379),r=zr(r,s,n,i,e[2],15,718787259),i=zr(i,r,s,n,e[9],21,-343485551),t[0]=Wl(n,t[0]),t[1]=Wl(i,t[1]),t[2]=Wl(r,t[2]),t[3]=Wl(s,t[3])}function xp(t,e,n,i,r,s){return e=Wl(Wl(e,t),Wl(i,s)),Wl(e<<r|e>>>32-r,n)}function Fr(t,e,n,i,r,s,a){return xp(e&n|~e&i,t,e,r,s,a)}function Rr(t,e,n,i,r,s,a){return xp(e&i|n&~i,t,e,r,s,a)}function Br(t,e,n,i,r,s,a){return xp(e^n^i,t,e,r,s,a)}function zr(t,e,n,i,r,s,a){return xp(n^(e|~i),t,e,r,s,a)}function Bx(t){var e,n=t.length,i=[1732584193,-271733879,-1732584194,271733878];for(e=64;e<=t.length;e+=64)zg(i,XO(t.substring(e-64,e)));t=t.substring(e-64);var r=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0];for(e=0;e<t.length;e++)r[e>>2]|=t.charCodeAt(e)<<(e%4<<3);if(r[e>>2]|=128<<(e%4<<3),e>55)for(zg(i,r),e=0;e<16;e++)r[e]=0;return r[14]=8*n,zg(i,r),i}function XO(t){var e,n=[];for(e=0;e<64;e+=4)n[e>>2]=t.charCodeAt(e)+(t.charCodeAt(e+1)<<8)+(t.charCodeAt(e+2)<<16)+(t.charCodeAt(e+3)<<24);return n}var ly="0123456789abcdef".split("");function YO(t){for(var e="",n=0;n<4;n++)e+=ly[t>>8*n+4&15]+ly[t>>8*n&15];return e}function KO(t){return String.fromCharCode(255&t,(65280&t)>>8,(16711680&t)>>16,(4278190080&t)>>24)}function Xm(t){return Bx(t).map(KO).join("")}var ZO=(function(t){for(var e=0;e<t.length;e++)t[e]=YO(t[e]);return t.join("")})(Bx("hello"))!="5d41402abc4b2a76b9719d911017c592";function Wl(t,e){if(ZO){var n=(65535&t)+(65535&e);return(t>>16)+(e>>16)+(n>>16)<<16|65535&n}return t+e&4294967295}function Ym(t,e){var n,i,r,s;if(t!==n){for(var a=(r=t,s=1+(256/t.length|0),new Array(s+1).join(r)),o=[],l=0;l<256;l++)o[l]=l;var c=0;for(l=0;l<256;l++){var u=o[l];c=(c+u+a.charCodeAt(l))%256,o[l]=o[c],o[c]=u}n=t,i=o}else o=i;var f=e.length,h=0,d=0,y="";for(l=0;l<f;l++)d=(d+(u=o[h=(h+1)%256]))%256,o[h]=o[d],o[d]=u,a=o[(o[h]+o[d])%256],y+=String.fromCharCode(e.charCodeAt(l)^a);return y}var cy={print:4,modify:8,copy:16,"annot-forms":32};function su(t,e,n,i){this.v=1,this.r=2;var r=192;t.forEach(function(o){if(cy.perm!==void 0)throw new Error("Invalid permission: "+o);r+=cy[o]}),this.padding="(Â¿N^NuÂAd\0NVÃ¿Ãº\b..\0Â¶Ãh>Â/\fÂ©Ã¾dSiz";var s=(e+this.padding).substr(0,32),a=(n+this.padding).substr(0,32);this.O=this.processOwnerPassword(s,a),this.P=-(1+(255^r)),this.encryptionKey=Xm(s+this.O+this.lsbFirstWord(this.P)+this.hexToBytes(i)).substr(0,5),this.U=Ym(this.encryptionKey,this.padding)}function au(t){if(/[^\u0000-\u00ff]/.test(t))throw new Error("Invalid PDF Name Object: "+t+", Only accept ASCII characters.");for(var e="",n=t.length,i=0;i<n;i++){var r=t.charCodeAt(i);e+=r<33||r===35||r===37||r===40||r===41||r===47||r===60||r===62||r===91||r===93||r===123||r===125||r>126?"#"+("0"+r.toString(16)).slice(-2):t[i]}return e}function uy(t){if(jn(t)!=="object")throw new Error("Invalid Context passed to initialize PubSub (jsPDF-module)");var e={};this.subscribe=function(n,i,r){if(r=r||!1,typeof n!="string"||typeof i!="function"||typeof r!="boolean")throw new Error("Invalid arguments passed to PubSub.subscribe (jsPDF-module)");e.hasOwnProperty(n)||(e[n]={});var s=Math.random().toString(35);return e[n][s]=[i,!!r],s},this.unsubscribe=function(n){for(var i in e)if(e[i][n])return delete e[i][n],Object.keys(e[i]).length===0&&delete e[i],!0;return!1},this.publish=function(n){if(e.hasOwnProperty(n)){var i=Array.prototype.slice.call(arguments,1),r=[];for(var s in e[n]){var a=e[n][s];try{a[0].apply(t,i)}catch(o){nn.console&&Qn.error("jsPDF PubSub Error",o.message,o)}a[1]&&r.push(s)}r.length&&r.forEach(this.unsubscribe)}},this.getTopics=function(){return e}}function Ec(t){if(!(this instanceof Ec))return new Ec(t);var e="opacity,stroke-opacity".split(",");for(var n in t)t.hasOwnProperty(n)&&e.indexOf(n)>=0&&(this[n]=t[n]);this.id="",this.objectNumber=-1}function zx(t,e){this.gState=t,this.matrix=e,this.id="",this.objectNumber=-1}function jl(t,e,n,i,r){if(!(this instanceof jl))return new jl(t,e,n,i,r);this.type=t==="axial"?2:3,this.coords=e,this.colors=n,zx.call(this,i,r)}function vc(t,e,n,i,r){if(!(this instanceof vc))return new vc(t,e,n,i,r);this.boundingBox=t,this.xStep=e,this.yStep=n,this.stream="",this.cloneIndex=0,zx.call(this,i,r)}function qt(t){var e,n=typeof arguments[0]=="string"?arguments[0]:"p",i=arguments[1],r=arguments[2],s=arguments[3],a=[],o=1,l=16,c="S",u=null;jn(t=t||{})==="object"&&(n=t.orientation,i=t.unit||i,r=t.format||r,s=t.compress||t.compressPdf||s,(u=t.encryption||null)!==null&&(u.userPassword=u.userPassword||"",u.ownerPassword=u.ownerPassword||"",u.userPermissions=u.userPermissions||[]),o=typeof t.userUnit=="number"?Math.abs(t.userUnit):1,t.precision!==void 0&&(e=t.precision),t.floatPrecision!==void 0&&(l=t.floatPrecision),c=t.defaultPathOperation||"S"),a=t.filters||(s===!0?["FlateEncode"]:a),i=i||"mm",n=(""+(n||"P")).toLowerCase();var f=t.putOnlyUsedFonts||!1,h={},d={internal:{},__private__:{}};d.__private__.PubSub=uy;var y="1.3",m=d.__private__.getPdfVersion=function(){return y};d.__private__.setPdfVersion=function(b){y=b};var x={a0:[2383.94,3370.39],a1:[1683.78,2383.94],a2:[1190.55,1683.78],a3:[841.89,1190.55],a4:[595.28,841.89],a5:[419.53,595.28],a6:[297.64,419.53],a7:[209.76,297.64],a8:[147.4,209.76],a9:[104.88,147.4],a10:[73.7,104.88],b0:[2834.65,4008.19],b1:[2004.09,2834.65],b2:[1417.32,2004.09],b3:[1000.63,1417.32],b4:[708.66,1000.63],b5:[498.9,708.66],b6:[354.33,498.9],b7:[249.45,354.33],b8:[175.75,249.45],b9:[124.72,175.75],b10:[87.87,124.72],c0:[2599.37,3676.54],c1:[1836.85,2599.37],c2:[1298.27,1836.85],c3:[918.43,1298.27],c4:[649.13,918.43],c5:[459.21,649.13],c6:[323.15,459.21],c7:[229.61,323.15],c8:[161.57,229.61],c9:[113.39,161.57],c10:[79.37,113.39],dl:[311.81,623.62],letter:[612,792],"government-letter":[576,756],legal:[612,1008],"junior-legal":[576,360],ledger:[1224,792],tabloid:[792,1224],"credit-card":[153,243]};d.__private__.getPageFormats=function(){return x};var w=d.__private__.getPageFormat=function(b){return x[b]};r=r||"a4";var S="compat",A="advanced",_=S;function M(){this.saveGraphicsState(),K(new Ct(rt,0,0,-rt,0,da()*rt).toString()+" cm"),this.setFontSize(this.getFontSize()/rt),c="n",_=A}function I(){this.restoreGraphicsState(),c="S",_=S}var T=d.__private__.combineFontStyleAndFontWeight=function(b,P){if(b=="bold"&&P=="normal"||b=="bold"&&P==400||b=="normal"&&P=="italic"||b=="bold"&&P=="italic")throw new Error("Invalid Combination of fontweight and fontstyle");return P&&(b=P==400||P==="normal"?b==="italic"?"italic":"normal":P!=700&&P!=="bold"||b!=="normal"?(P==700?"bold":P)+""+b:"bold"),b};d.advancedAPI=function(b){var P=_===S;return P&&M.call(this),typeof b!="function"||(b(this),P&&I.call(this)),this},d.compatAPI=function(b){var P=_===A;return P&&I.call(this),typeof b!="function"||(b(this),P&&M.call(this)),this},d.isAdvancedAPI=function(){return _===A};var D,O=function(b){if(_!==A)throw new Error(b+" is only available in 'advanced' API mode. You need to call advancedAPI() first.")},W=d.roundToPrecision=d.__private__.roundToPrecision=function(b,P){var J=e||P;if(isNaN(b)||isNaN(J))throw new Error("Invalid argument passed to jsPDF.roundToPrecision");return b.toFixed(J).replace(/0+$/,"")};D=d.hpf=d.__private__.hpf=typeof l=="number"?function(b){if(isNaN(b))throw new Error("Invalid argument passed to jsPDF.hpf");return W(b,l)}:l==="smart"?function(b){if(isNaN(b))throw new Error("Invalid argument passed to jsPDF.hpf");return W(b,b>-1&&b<1?16:5)}:function(b){if(isNaN(b))throw new Error("Invalid argument passed to jsPDF.hpf");return W(b,16)};var C=d.f2=d.__private__.f2=function(b){if(isNaN(b))throw new Error("Invalid argument passed to jsPDF.f2");return W(b,2)},N=d.__private__.f3=function(b){if(isNaN(b))throw new Error("Invalid argument passed to jsPDF.f3");return W(b,3)},B=d.scale=d.__private__.scale=function(b){if(isNaN(b))throw new Error("Invalid argument passed to jsPDF.scale");return _===S?b*rt:_===A?b:void 0},E=function(b){return B((function(P){return _===S?da()-P:_===A?P:void 0})(b))};d.__private__.setPrecision=d.setPrecision=function(b){typeof parseInt(b,10)=="number"&&(e=parseInt(b,10))};var R,q="00000000000000000000000000000000",Z=d.__private__.getFileId=function(){return q},U=d.__private__.setFileId=function(b){return q=b!==void 0&&/^[a-fA-F0-9]{32}$/.test(b)?b.toUpperCase():q.split("").map(function(){return"ABCDEF0123456789".charAt(Math.floor(16*Math.random()))}).join(""),u!==null&&(ui=new su(u.userPermissions,u.userPassword,u.ownerPassword,q)),q};d.setFileId=function(b){return U(b),this},d.getFileId=function(){return Z()};var X=d.__private__.convertDateToPDFDate=function(b){var P=b.getTimezoneOffset(),J=P<0?"+":"-",fe=Math.floor(Math.abs(P/60)),ye=Math.abs(P%60),Te=[J,G(fe),"'",G(ye),"'"].join("");return["D:",b.getFullYear(),G(b.getMonth()+1),G(b.getDate()),G(b.getHours()),G(b.getMinutes()),G(b.getSeconds()),Te].join("")},de=d.__private__.convertPDFDateToDate=function(b){var P=parseInt(b.substr(2,4),10),J=parseInt(b.substr(6,2),10)-1,fe=parseInt(b.substr(8,2),10),ye=parseInt(b.substr(10,2),10),Te=parseInt(b.substr(12,2),10),We=parseInt(b.substr(14,2),10);return new Date(P,J,fe,ye,Te,We,0)},le=d.__private__.setCreationDate=function(b){var P;if(b===void 0&&(b=new Date),b instanceof Date)P=X(b);else{if(!/^D:(20[0-2][0-9]|203[0-7]|19[7-9][0-9])(0[0-9]|1[0-2])([0-2][0-9]|3[0-1])(0[0-9]|1[0-9]|2[0-3])(0[0-9]|[1-5][0-9])(0[0-9]|[1-5][0-9])(\+0[0-9]|\+1[0-4]|-0[0-9]|-1[0-1])'(0[0-9]|[1-5][0-9])'?$/.test(b))throw new Error("Invalid argument passed to jsPDF.setCreationDate");P=b}return R=P},F=d.__private__.getCreationDate=function(b){var P=R;return b==="jsDate"&&(P=de(R)),P};d.setCreationDate=function(b){return le(b),this},d.getCreationDate=function(b){return F(b)};var V,G=d.__private__.padd2=function(b){return("0"+parseInt(b)).slice(-2)},se=d.__private__.padd2Hex=function(b){return("00"+(b=b.toString())).substr(b.length)},ae=0,te=[],ue=[],pe=0,ge=[],me=[],Pe=!1,ke=ue;d.__private__.setCustomOutputDestination=function(b){Pe=!0,ke=b};var Ge=function(b){Pe||(ke=b)};d.__private__.resetCustomOutputDestination=function(){Pe=!1,ke=ue};var K=d.__private__.out=function(b){return b=b.toString(),pe+=b.length+1,ke.push(b),ke},Oe=d.__private__.write=function(b){return K(arguments.length===1?b.toString():Array.prototype.join.call(arguments," "))},Ke=d.__private__.getArrayBuffer=function(b){for(var P=b.length,J=new ArrayBuffer(P),fe=new Uint8Array(J);P--;)fe[P]=b.charCodeAt(P);return J},Be=[["Helvetica","helvetica","normal","WinAnsiEncoding"],["Helvetica-Bold","helvetica","bold","WinAnsiEncoding"],["Helvetica-Oblique","helvetica","italic","WinAnsiEncoding"],["Helvetica-BoldOblique","helvetica","bolditalic","WinAnsiEncoding"],["Courier","courier","normal","WinAnsiEncoding"],["Courier-Bold","courier","bold","WinAnsiEncoding"],["Courier-Oblique","courier","italic","WinAnsiEncoding"],["Courier-BoldOblique","courier","bolditalic","WinAnsiEncoding"],["Times-Roman","times","normal","WinAnsiEncoding"],["Times-Bold","times","bold","WinAnsiEncoding"],["Times-Italic","times","italic","WinAnsiEncoding"],["Times-BoldItalic","times","bolditalic","WinAnsiEncoding"],["ZapfDingbats","zapfdingbats","normal",null],["Symbol","symbol","normal",null]];d.__private__.getStandardFonts=function(){return Be};var Ee=t.fontSize||16;d.__private__.setFontSize=d.setFontSize=function(b){return Ee=_===A?b/rt:b,this};var at,Ue=d.__private__.getFontSize=d.getFontSize=function(){return _===S?Ee:Ee*rt},Ye=t.R2L||!1;d.__private__.setR2L=d.setR2L=function(b){return Ye=b,this},d.__private__.getR2L=d.getR2L=function(){return Ye};var ut,Ft=d.__private__.setZoomMode=function(b){if(/^(?:\d+\.\d*|\d*\.\d+|\d+)%$/.test(b))at=b;else if(isNaN(b)){if([void 0,null,"fullwidth","fullheight","fullpage","original"].indexOf(b)===-1)throw new Error('zoom must be Integer (e.g. 2), a percentage Value (e.g. 300%) or fullwidth, fullheight, fullpage, original. "'+b+'" is not recognized.');at=b}else at=parseInt(b,10)};d.__private__.getZoomMode=function(){return at};var be,ze=d.__private__.setPageMode=function(b){if([void 0,null,"UseNone","UseOutlines","UseThumbs","FullScreen"].indexOf(b)==-1)throw new Error('Page mode must be one of UseNone, UseOutlines, UseThumbs, or FullScreen. "'+b+'" is not recognized.');ut=b};d.__private__.getPageMode=function(){return ut};var ve=d.__private__.setLayoutMode=function(b){if([void 0,null,"continuous","single","twoleft","tworight","two"].indexOf(b)==-1)throw new Error('Layout mode must be one of continuous, single, twoleft, tworight. "'+b+'" is not recognized.');be=b};d.__private__.getLayoutMode=function(){return be},d.__private__.setDisplayMode=d.setDisplayMode=function(b,P,J){return Ft(b),ve(P),ze(J),this};var Ce={title:"",subject:"",author:"",keywords:"",creator:""};d.__private__.getDocumentProperty=function(b){if(Object.keys(Ce).indexOf(b)===-1)throw new Error("Invalid argument passed to jsPDF.getDocumentProperty");return Ce[b]},d.__private__.getDocumentProperties=function(){return Ce},d.__private__.setDocumentProperties=d.setProperties=d.setDocumentProperties=function(b){for(var P in Ce)Ce.hasOwnProperty(P)&&b[P]&&(Ce[P]=b[P]);return this},d.__private__.setDocumentProperty=function(b,P){if(Object.keys(Ce).indexOf(b)===-1)throw new Error("Invalid arguments passed to jsPDF.setDocumentProperty");return Ce[b]=P};var Ie,rt,et,vt,wt,Nt={},it={},kt=[],ct={},yt={},st={},gt={},Bt=null,xt=0,dt=[],Ut=new uy(d),ai=t.hotfixes||[],bn={},Ln={},ni=[],Ct=function b(P,J,fe,ye,Te,We){if(!(this instanceof b))return new b(P,J,fe,ye,Te,We);isNaN(P)&&(P=1),isNaN(J)&&(J=0),isNaN(fe)&&(fe=0),isNaN(ye)&&(ye=1),isNaN(Te)&&(Te=0),isNaN(We)&&(We=0),this._matrix=[P,J,fe,ye,Te,We]};Object.defineProperty(Ct.prototype,"sx",{get:function(){return this._matrix[0]},set:function(b){this._matrix[0]=b}}),Object.defineProperty(Ct.prototype,"shy",{get:function(){return this._matrix[1]},set:function(b){this._matrix[1]=b}}),Object.defineProperty(Ct.prototype,"shx",{get:function(){return this._matrix[2]},set:function(b){this._matrix[2]=b}}),Object.defineProperty(Ct.prototype,"sy",{get:function(){return this._matrix[3]},set:function(b){this._matrix[3]=b}}),Object.defineProperty(Ct.prototype,"tx",{get:function(){return this._matrix[4]},set:function(b){this._matrix[4]=b}}),Object.defineProperty(Ct.prototype,"ty",{get:function(){return this._matrix[5]},set:function(b){this._matrix[5]=b}}),Object.defineProperty(Ct.prototype,"a",{get:function(){return this._matrix[0]},set:function(b){this._matrix[0]=b}}),Object.defineProperty(Ct.prototype,"b",{get:function(){return this._matrix[1]},set:function(b){this._matrix[1]=b}}),Object.defineProperty(Ct.prototype,"c",{get:function(){return this._matrix[2]},set:function(b){this._matrix[2]=b}}),Object.defineProperty(Ct.prototype,"d",{get:function(){return this._matrix[3]},set:function(b){this._matrix[3]=b}}),Object.defineProperty(Ct.prototype,"e",{get:function(){return this._matrix[4]},set:function(b){this._matrix[4]=b}}),Object.defineProperty(Ct.prototype,"f",{get:function(){return this._matrix[5]},set:function(b){this._matrix[5]=b}}),Object.defineProperty(Ct.prototype,"rotation",{get:function(){return Math.atan2(this.shx,this.sx)}}),Object.defineProperty(Ct.prototype,"scaleX",{get:function(){return this.decompose().scale.sx}}),Object.defineProperty(Ct.prototype,"scaleY",{get:function(){return this.decompose().scale.sy}}),Object.defineProperty(Ct.prototype,"isIdentity",{get:function(){return this.sx===1&&this.shy===0&&this.shx===0&&this.sy===1&&this.tx===0&&this.ty===0}}),Ct.prototype.join=function(b){return[this.sx,this.shy,this.shx,this.sy,this.tx,this.ty].map(D).join(b)},Ct.prototype.multiply=function(b){var P=b.sx*this.sx+b.shy*this.shx,J=b.sx*this.shy+b.shy*this.sy,fe=b.shx*this.sx+b.sy*this.shx,ye=b.shx*this.shy+b.sy*this.sy,Te=b.tx*this.sx+b.ty*this.shx+this.tx,We=b.tx*this.shy+b.ty*this.sy+this.ty;return new Ct(P,J,fe,ye,Te,We)},Ct.prototype.decompose=function(){var b=this.sx,P=this.shy,J=this.shx,fe=this.sy,ye=this.tx,Te=this.ty,We=Math.sqrt(b*b+P*P),pt=(b/=We)*J+(P/=We)*fe;J-=b*pt,fe-=P*pt;var ht=Math.sqrt(J*J+fe*fe);return pt/=ht,b*(fe/=ht)<P*(J/=ht)&&(b=-b,P=-P,pt=-pt,We=-We),{scale:new Ct(We,0,0,ht,0,0),translate:new Ct(1,0,0,1,ye,Te),rotate:new Ct(b,P,-P,b,0,0),skew:new Ct(1,0,pt,1,0,0)}},Ct.prototype.toString=function(b){return this.join(" ")},Ct.prototype.inversed=function(){var b=this.sx,P=this.shy,J=this.shx,fe=this.sy,ye=this.tx,Te=this.ty,We=1/(b*fe-P*J),pt=fe*We,ht=-P*We,Rt=-J*We,jt=b*We;return new Ct(pt,ht,Rt,jt,-pt*ye-Rt*Te,-ht*ye-jt*Te)},Ct.prototype.applyToPoint=function(b){var P=b.x*this.sx+b.y*this.shx+this.tx,J=b.x*this.shy+b.y*this.sy+this.ty;return new Ki(P,J)},Ct.prototype.applyToRectangle=function(b){var P=this.applyToPoint(b),J=this.applyToPoint(new Ki(b.x+b.w,b.y+b.h));return new wo(P.x,P.y,J.x-P.x,J.y-P.y)},Ct.prototype.clone=function(){var b=this.sx,P=this.shy,J=this.shx,fe=this.sy,ye=this.tx,Te=this.ty;return new Ct(b,P,J,fe,ye,Te)},d.Matrix=Ct;var oi=d.matrixMult=function(b,P){return P.multiply(b)},Hn=new Ct(1,0,0,1,0,0);d.unitMatrix=d.identityMatrix=Hn;var Sn=function(b,P){if(!yt[b]){var J=(P instanceof jl?"Sh":"P")+(Object.keys(ct).length+1).toString(10);P.id=J,yt[b]=J,ct[J]=P,Ut.publish("addPattern",P)}};d.ShadingPattern=jl,d.TilingPattern=vc,d.addShadingPattern=function(b,P){return O("addShadingPattern()"),Sn(b,P),this},d.beginTilingPattern=function(b){O("beginTilingPattern()"),za(b.boundingBox[0],b.boundingBox[1],b.boundingBox[2]-b.boundingBox[0],b.boundingBox[3]-b.boundingBox[1],b.matrix)},d.endTilingPattern=function(b,P){O("endTilingPattern()"),P.stream=me[V].join(`
`),Sn(b,P),Ut.publish("endTilingPattern",P),ni.pop().restore()};var Mn,Pn=d.__private__.newObject=function(){var b=qe();return $e(b,!0),b},qe=d.__private__.newObjectDeferred=function(){return ae++,te[ae]=function(){return pe},ae},$e=function(b,P){return P=typeof P=="boolean"&&P,te[b]=pe,P&&K(b+" 0 obj"),b},Pt=d.__private__.newAdditionalObject=function(){var b={objId:qe(),content:""};return ge.push(b),b},tn=qe(),Wt=qe(),Gt=d.__private__.decodeColorString=function(b){var P=b.split(" ");if(P.length!==2||P[1]!=="g"&&P[1]!=="G")P.length!==5||P[4]!=="k"&&P[4]!=="K"||(P=[(1-P[0])*(1-P[3]),(1-P[1])*(1-P[3]),(1-P[2])*(1-P[3]),"r"]);else{var J=parseFloat(P[0]);P=[J,J,J,"r"]}for(var fe="#",ye=0;ye<3;ye++)fe+=("0"+Math.floor(255*parseFloat(P[ye])).toString(16)).slice(-2);return fe},Dt=d.__private__.encodeColorString=function(b){var P;typeof b=="string"&&(b={ch1:b});var J=b.ch1,fe=b.ch2,ye=b.ch3,Te=b.ch4,We=b.pdfColorType==="draw"?["G","RG","K"]:["g","rg","k"];if(typeof J=="string"&&J.charAt(0)!=="#"){var pt=new Rx(J);if(pt.ok)J=pt.toHex();else if(!/^\d*\.?\d*$/.test(J))throw new Error('Invalid color "'+J+'" passed to jsPDF.encodeColorString.')}if(typeof J=="string"&&/^#[0-9A-Fa-f]{3}$/.test(J)&&(J="#"+J[1]+J[1]+J[2]+J[2]+J[3]+J[3]),typeof J=="string"&&/^#[0-9A-Fa-f]{6}$/.test(J)){var ht=parseInt(J.substr(1),16);J=ht>>16&255,fe=ht>>8&255,ye=255&ht}if(fe===void 0||Te===void 0&&J===fe&&fe===ye)P=typeof J=="string"?J+" "+We[0]:b.precision===2?C(J/255)+" "+We[0]:N(J/255)+" "+We[0];else if(Te===void 0||jn(Te)==="object"){if(Te&&!isNaN(Te.a)&&Te.a===0)return["1.","1.","1.",We[1]].join(" ");P=typeof J=="string"?[J,fe,ye,We[1]].join(" "):b.precision===2?[C(J/255),C(fe/255),C(ye/255),We[1]].join(" "):[N(J/255),N(fe/255),N(ye/255),We[1]].join(" ")}else P=typeof J=="string"?[J,fe,ye,Te,We[2]].join(" "):b.precision===2?[C(J),C(fe),C(ye),C(Te),We[2]].join(" "):[N(J),N(fe),N(ye),N(Te),We[2]].join(" ");return P},Jt=d.__private__.getFilters=function(){return a},$t=d.__private__.putStream=function(b){var P=(b=b||{}).data||"",J=b.filters||Jt(),fe=b.alreadyAppliedFilters||[],ye=b.addLength1||!1,Te=P.length,We=b.objectId,pt=function(dn){return dn};if(u!==null&&We===void 0)throw new Error("ObjectId must be passed to putStream for file encryption");u!==null&&(pt=ui.encryptor(We,0));var ht={};J===!0&&(J=["FlateEncode"]);var Rt=b.additionalKeyValues||[],jt=(ht=qt.API.processDataByFilters!==void 0?qt.API.processDataByFilters(P,J):{data:P,reverseChain:[]}).reverseChain+(Array.isArray(fe)?fe.join(" "):fe.toString());if(ht.data.length!==0&&(Rt.push({key:"Length",value:ht.data.length}),ye===!0&&Rt.push({key:"Length1",value:Te})),jt.length!=0)if(jt.split("/").length-1==1)Rt.push({key:"Filter",value:jt});else{Rt.push({key:"Filter",value:"["+jt+"]"});for(var Vt=0;Vt<Rt.length;Vt+=1)if(Rt[Vt].key==="DecodeParms"){for(var _t=[],hn=0;hn<ht.reverseChain.split("/").length-1;hn+=1)_t.push("null");_t.push(Rt[Vt].value),Rt[Vt].value="["+_t.join(" ")+"]"}}K("<<");for(var gn=0;gn<Rt.length;gn++)K("/"+Rt[gn].key+" "+Rt[gn].value);K(">>"),ht.data.length!==0&&(K("stream"),K(pt(ht.data)),K("endstream"))},wn=d.__private__.putPage=function(b){var P=b.number,J=b.data,fe=b.objId,ye=b.contentsObjId;$e(fe,!0),K("<</Type /Page"),K("/Parent "+b.rootDictionaryObjId+" 0 R"),K("/Resources "+b.resourceDictionaryObjId+" 0 R"),K("/MediaBox ["+parseFloat(D(b.mediaBox.bottomLeftX))+" "+parseFloat(D(b.mediaBox.bottomLeftY))+" "+D(b.mediaBox.topRightX)+" "+D(b.mediaBox.topRightY)+"]"),b.cropBox!==null&&K("/CropBox ["+D(b.cropBox.bottomLeftX)+" "+D(b.cropBox.bottomLeftY)+" "+D(b.cropBox.topRightX)+" "+D(b.cropBox.topRightY)+"]"),b.bleedBox!==null&&K("/BleedBox ["+D(b.bleedBox.bottomLeftX)+" "+D(b.bleedBox.bottomLeftY)+" "+D(b.bleedBox.topRightX)+" "+D(b.bleedBox.topRightY)+"]"),b.trimBox!==null&&K("/TrimBox ["+D(b.trimBox.bottomLeftX)+" "+D(b.trimBox.bottomLeftY)+" "+D(b.trimBox.topRightX)+" "+D(b.trimBox.topRightY)+"]"),b.artBox!==null&&K("/ArtBox ["+D(b.artBox.bottomLeftX)+" "+D(b.artBox.bottomLeftY)+" "+D(b.artBox.topRightX)+" "+D(b.artBox.topRightY)+"]"),typeof b.userUnit=="number"&&b.userUnit!==1&&K("/UserUnit "+b.userUnit),Ut.publish("putPage",{objId:fe,pageContext:dt[P],pageNumber:P,page:J}),K("/Contents "+ye+" 0 R"),K(">>"),K("endobj");var Te=J.join(`
`);return _===A&&(Te+=`
Q`),$e(ye,!0),$t({data:Te,filters:Jt(),objectId:ye}),K("endobj"),fe},en=d.__private__.putPages=function(){var b,P,J=[];for(b=1;b<=xt;b++)dt[b].objId=qe(),dt[b].contentsObjId=qe();for(b=1;b<=xt;b++)J.push(wn({number:b,data:me[b],objId:dt[b].objId,contentsObjId:dt[b].contentsObjId,mediaBox:dt[b].mediaBox,cropBox:dt[b].cropBox,bleedBox:dt[b].bleedBox,trimBox:dt[b].trimBox,artBox:dt[b].artBox,userUnit:dt[b].userUnit,rootDictionaryObjId:tn,resourceDictionaryObjId:Wt}));$e(tn,!0),K("<</Type /Pages");var fe="/Kids [";for(P=0;P<xt;P++)fe+=J[P]+" 0 R ";K(fe+"]"),K("/Count "+xt),K(">>"),K("endobj"),Ut.publish("postPutPages")},ii=function(b){Ut.publish("putFont",{font:b,out:K,newObject:Pn,putStream:$t}),b.isAlreadyPutted!==!0&&(b.objectNumber=Pn(),K("<<"),K("/Type /Font"),K("/BaseFont /"+au(b.postScriptName)),K("/Subtype /Type1"),typeof b.encoding=="string"&&K("/Encoding /"+b.encoding),K("/FirstChar 32"),K("/LastChar 255"),K(">>"),K("endobj"))},kn=function(b){b.objectNumber=Pn();var P=[];P.push({key:"Type",value:"/XObject"}),P.push({key:"Subtype",value:"/Form"}),P.push({key:"BBox",value:"["+[D(b.x),D(b.y),D(b.x+b.width),D(b.y+b.height)].join(" ")+"]"}),P.push({key:"Matrix",value:"["+b.matrix.toString()+"]"});var J=b.pages[1].join(`
`);$t({data:J,additionalKeyValues:P,objectId:b.objectNumber}),K("endobj")},En=function(b,P){P||(P=21);var J=Pn(),fe=(function(We,pt){var ht,Rt=[],jt=1/(pt-1);for(ht=0;ht<1;ht+=jt)Rt.push(ht);if(Rt.push(1),We[0].offset!=0){var Vt={offset:0,color:We[0].color};We.unshift(Vt)}if(We[We.length-1].offset!=1){var _t={offset:1,color:We[We.length-1].color};We.push(_t)}for(var hn="",gn=0,dn=0;dn<Rt.length;dn++){for(ht=Rt[dn];ht>We[gn+1].offset;)gn++;var mn=We[gn].offset,zn=(ht-mn)/(We[gn+1].offset-mn),Bi=We[gn].color,Kn=We[gn+1].color;hn+=se(Math.round((1-zn)*Bi[0]+zn*Kn[0]).toString(16))+se(Math.round((1-zn)*Bi[1]+zn*Kn[1]).toString(16))+se(Math.round((1-zn)*Bi[2]+zn*Kn[2]).toString(16))}return hn.trim()})(b.colors,P),ye=[];ye.push({key:"FunctionType",value:"0"}),ye.push({key:"Domain",value:"[0.0 1.0]"}),ye.push({key:"Size",value:"["+P+"]"}),ye.push({key:"BitsPerSample",value:"8"}),ye.push({key:"Range",value:"[0.0 1.0 0.0 1.0 0.0 1.0]"}),ye.push({key:"Decode",value:"[0.0 1.0 0.0 1.0 0.0 1.0]"}),$t({data:fe,additionalKeyValues:ye,alreadyAppliedFilters:["/ASCIIHexDecode"],objectId:J}),K("endobj"),b.objectNumber=Pn(),K("<< /ShadingType "+b.type),K("/ColorSpace /DeviceRGB");var Te="/Coords ["+D(parseFloat(b.coords[0]))+" "+D(parseFloat(b.coords[1]))+" ";b.type===2?Te+=D(parseFloat(b.coords[2]))+" "+D(parseFloat(b.coords[3])):Te+=D(parseFloat(b.coords[2]))+" "+D(parseFloat(b.coords[3]))+" "+D(parseFloat(b.coords[4]))+" "+D(parseFloat(b.coords[5])),K(Te+="]"),b.matrix&&K("/Matrix ["+b.matrix.toString()+"]"),K("/Function "+J+" 0 R"),K("/Extend [true true]"),K(">>"),K("endobj")},Bs=function(b,P){var J=qe(),fe=Pn();P.push({resourcesOid:J,objectOid:fe}),b.objectNumber=fe;var ye=[];ye.push({key:"Type",value:"/Pattern"}),ye.push({key:"PatternType",value:"1"}),ye.push({key:"PaintType",value:"1"}),ye.push({key:"TilingType",value:"1"}),ye.push({key:"BBox",value:"["+b.boundingBox.map(D).join(" ")+"]"}),ye.push({key:"XStep",value:D(b.xStep)}),ye.push({key:"YStep",value:D(b.yStep)}),ye.push({key:"Resources",value:J+" 0 R"}),b.matrix&&ye.push({key:"Matrix",value:"["+b.matrix.toString()+"]"}),$t({data:b.stream,additionalKeyValues:ye,objectId:b.objectNumber}),K("endobj")},oa=function(b){for(var P in b.objectNumber=Pn(),K("<<"),b)switch(P){case"opacity":K("/ca "+C(b[P]));break;case"stroke-opacity":K("/CA "+C(b[P]))}K(">>"),K("endobj")},ss=function(b){$e(b.resourcesOid,!0),K("<<"),K("/ProcSet [/PDF /Text /ImageB /ImageC /ImageI]"),(function(){for(var P in K("/Font <<"),Nt)Nt.hasOwnProperty(P)&&(f===!1||f===!0&&h.hasOwnProperty(P))&&K("/"+P+" "+Nt[P].objectNumber+" 0 R");K(">>")})(),(function(){if(Object.keys(ct).length>0){for(var P in K("/Shading <<"),ct)ct.hasOwnProperty(P)&&ct[P]instanceof jl&&ct[P].objectNumber>=0&&K("/"+P+" "+ct[P].objectNumber+" 0 R");Ut.publish("putShadingPatternDict"),K(">>")}})(),(function(P){if(Object.keys(ct).length>0){for(var J in K("/Pattern <<"),ct)ct.hasOwnProperty(J)&&ct[J]instanceof d.TilingPattern&&ct[J].objectNumber>=0&&ct[J].objectNumber<P&&K("/"+J+" "+ct[J].objectNumber+" 0 R");Ut.publish("putTilingPatternDict"),K(">>")}})(b.objectOid),(function(){if(Object.keys(st).length>0){var P;for(P in K("/ExtGState <<"),st)st.hasOwnProperty(P)&&st[P].objectNumber>=0&&K("/"+P+" "+st[P].objectNumber+" 0 R");Ut.publish("putGStateDict"),K(">>")}})(),(function(){for(var P in K("/XObject <<"),bn)bn.hasOwnProperty(P)&&bn[P].objectNumber>=0&&K("/"+P+" "+bn[P].objectNumber+" 0 R");Ut.publish("putXobjectDict"),K(">>")})(),K(">>"),K("endobj")},yr=function(b){it[b.fontName]=it[b.fontName]||{},it[b.fontName][b.fontStyle]=b.id},go=function(b,P,J,fe,ye){var Te={id:"F"+(Object.keys(Nt).length+1).toString(10),postScriptName:b,fontName:P,fontStyle:J,encoding:fe,isStandardFont:ye||!1,metadata:{}};return Ut.publish("addFont",{font:Te,instance:this}),Nt[Te.id]=Te,yr(Te),Te.id},Ir=d.__private__.pdfEscape=d.pdfEscape=function(b,P){return(function(J,fe){var ye,Te,We,pt,ht,Rt,jt,Vt,_t;if(We=(fe=fe||{}).sourceEncoding||"Unicode",ht=fe.outputEncoding,(fe.autoencode||ht)&&Nt[Ie].metadata&&Nt[Ie].metadata[We]&&Nt[Ie].metadata[We].encoding&&(pt=Nt[Ie].metadata[We].encoding,!ht&&Nt[Ie].encoding&&(ht=Nt[Ie].encoding),!ht&&pt.codePages&&(ht=pt.codePages[0]),typeof ht=="string"&&(ht=pt[ht]),ht)){for(jt=!1,Rt=[],ye=0,Te=J.length;ye<Te;ye++)(Vt=ht[J.charCodeAt(ye)])?Rt.push(String.fromCharCode(Vt)):Rt.push(J[ye]),Rt[ye].charCodeAt(0)>>8&&(jt=!0);J=Rt.join("")}for(ye=J.length;jt===void 0&&ye!==0;)J.charCodeAt(ye-1)>>8&&(jt=!0),ye--;if(!jt)return J;for(Rt=fe.noBOM?[]:[254,255],ye=0,Te=J.length;ye<Te;ye++){if((_t=(Vt=J.charCodeAt(ye))>>8)>>8)throw new Error("Character at position "+ye+" of string '"+J+"' exceeds 16bits. Cannot be encoded into UCS-2 BE");Rt.push(_t),Rt.push(Vt-(_t<<8))}return String.fromCharCode.apply(void 0,Rt)})(b,P).replace(/\\/g,"\\\\").replace(/\(/g,"\\(").replace(/\)/g,"\\)")},mo=d.__private__.beginPage=function(b){me[++xt]=[],dt[xt]={objId:0,contentsObjId:0,userUnit:Number(o),artBox:null,bleedBox:null,cropBox:null,trimBox:null,mediaBox:{bottomLeftX:0,bottomLeftY:0,topRightX:Number(b[0]),topRightY:Number(b[1])}},vo(xt),Ge(me[V])},xs=function(b,P){var J,fe,ye;switch(n=P||n,typeof b=="string"&&(J=w(b.toLowerCase()),Array.isArray(J)&&(fe=J[0],ye=J[1])),Array.isArray(b)&&(fe=b[0]*rt,ye=b[1]*rt),isNaN(fe)&&(fe=r[0],ye=r[1]),(fe>14400||ye>14400)&&(Qn.warn("A page in a PDF can not be wider or taller than 14400 userUnit. jsPDF limits the width/height to 14400"),fe=Math.min(14400,fe),ye=Math.min(14400,ye)),r=[fe,ye],n.substr(0,1)){case"l":ye>fe&&(r=[ye,fe]);break;case"p":fe>ye&&(r=[ye,fe])}mo(r),Yt(yo),K(Fa),bo!==0&&K(bo+" J"),Ba!==0&&K(Ba+" j"),Ut.publish("addPage",{pageNumber:xt})},ir=function(b){b>0&&b<=xt&&(me.splice(b,1),dt.splice(b,1),xt--,V>xt&&(V=xt),this.setPage(V))},vo=function(b){b>0&&b<=xt&&(V=b)},cl=d.__private__.getNumberOfPages=d.getNumberOfPages=function(){return me.length-1},ul=function(b,P,J){var fe,ye=void 0;return J=J||{},b=b!==void 0?b:Nt[Ie].fontName,P=P!==void 0?P:Nt[Ie].fontStyle,fe=b.toLowerCase(),it[fe]!==void 0&&it[fe][P]!==void 0?ye=it[fe][P]:it[b]!==void 0&&it[b][P]!==void 0?ye=it[b][P]:J.disableWarning===!1&&Qn.warn("Unable to look up font label for font '"+b+"', '"+P+"'. Refer to getFontList() for available fonts."),ye||J.noFallback||(ye=it.times[P])==null&&(ye=it.times.normal),ye},Xi=d.__private__.putInfo=function(){var b=Pn(),P=function(fe){return fe};for(var J in u!==null&&(P=ui.encryptor(b,0)),K("<<"),K("/Producer ("+Ir(P("jsPDF "+qt.version))+")"),Ce)Ce.hasOwnProperty(J)&&Ce[J]&&K("/"+J.substr(0,1).toUpperCase()+J.substr(1)+" ("+Ir(P(Ce[J]))+")");K("/CreationDate ("+Ir(P(R))+")"),K(">>"),K("endobj")},rr=d.__private__.putCatalog=function(b){var P=(b=b||{}).rootDictionaryObjId||tn;switch(Pn(),K("<<"),K("/Type /Catalog"),K("/Pages "+P+" 0 R"),at||(at="fullwidth"),at){case"fullwidth":K("/OpenAction [3 0 R /FitH null]");break;case"fullheight":K("/OpenAction [3 0 R /FitV null]");break;case"fullpage":K("/OpenAction [3 0 R /Fit]");break;case"original":K("/OpenAction [3 0 R /XYZ null null 1]");break;default:var J=""+at;J.substr(J.length-1)==="%"&&(at=parseInt(at)/100),typeof at=="number"&&K("/OpenAction [3 0 R /XYZ null null "+C(at)+"]")}switch(be||(be="continuous"),be){case"continuous":K("/PageLayout /OneColumn");break;case"single":K("/PageLayout /SinglePage");break;case"two":case"twoleft":K("/PageLayout /TwoColumnLeft");break;case"tworight":K("/PageLayout /TwoColumnRight")}ut&&K("/PageMode /"+ut),Ut.publish("putCatalog"),K(">>"),K("endobj")},ec=d.__private__.putTrailer=function(){K("trailer"),K("<<"),K("/Size "+(ae+1)),K("/Root "+ae+" 0 R"),K("/Info "+(ae-1)+" 0 R"),u!==null&&K("/Encrypt "+ui.oid+" 0 R"),K("/ID [ <"+q+"> <"+q+"> ]"),K(">>")},li=d.__private__.putHeader=function(){K("%PDF-"+y),K("%ÂºÃÂ¬Ã ")},la=d.__private__.putXRef=function(){var b="0000000000";K("xref"),K("0 "+(ae+1)),K("0000000000 65535 f ");for(var P=1;P<=ae;P++)typeof te[P]=="function"?K((b+te[P]()).slice(-10)+" 00000 n "):te[P]!==void 0?K((b+te[P]).slice(-10)+" 00000 n "):K("0000000000 00000 n ")},Yi=d.__private__.buildDocument=function(){var b;ae=0,pe=0,ue=[],te=[],ge=[],tn=qe(),Wt=qe(),Ge(ue),Ut.publish("buildDocument"),li(),en(),(function(){Ut.publish("putAdditionalObjects");for(var J=0;J<ge.length;J++){var fe=ge[J];$e(fe.objId,!0),K(fe.content),K("endobj")}Ut.publish("postPutAdditionalObjects")})(),b=[],(function(){for(var J in Nt)Nt.hasOwnProperty(J)&&(f===!1||f===!0&&h.hasOwnProperty(J))&&ii(Nt[J])})(),(function(){var J;for(J in st)st.hasOwnProperty(J)&&oa(st[J])})(),(function(){for(var J in bn)bn.hasOwnProperty(J)&&kn(bn[J])})(),(function(J){var fe;for(fe in ct)ct.hasOwnProperty(fe)&&(ct[fe]instanceof jl?En(ct[fe]):ct[fe]instanceof vc&&Bs(ct[fe],J))})(b),Ut.publish("putResources"),b.forEach(ss),ss({resourcesOid:Wt,objectOid:Number.MAX_SAFE_INTEGER}),Ut.publish("postPutResources"),u!==null&&(ui.oid=Pn(),K("<<"),K("/Filter /Standard"),K("/V "+ui.v),K("/R "+ui.r),K("/U <"+ui.toHexString(ui.U)+">"),K("/O <"+ui.toHexString(ui.O)+">"),K("/P "+ui.P),K(">>"),K("endobj")),Xi(),rr();var P=pe;return la(),ec(),K("startxref"),K(""+P),K("%%EOF"),Ge(me[V]),ue.join(`
`)},sr=d.__private__.getBlob=function(b){return new Blob([Ke(b)],{type:"application/pdf"})},Ta=d.output=d.__private__.output=(Mn=function(b,P){switch(typeof(P=P||{})=="string"?P={filename:P}:P.filename=P.filename||"generated.pdf",b){case void 0:return Yi();case"save":d.save(P.filename);break;case"arraybuffer":return Ke(Yi());case"blob":return sr(Yi());case"bloburi":case"bloburl":if(nn.URL!==void 0&&typeof nn.URL.createObjectURL=="function")return nn.URL&&nn.URL.createObjectURL(sr(Yi()))||void 0;Qn.warn("bloburl is not supported by your system, because URL.createObjectURL is not supported by your browser.");break;case"datauristring":case"dataurlstring":var J="",fe=Yi();try{J=oy(fe)}catch{J=oy(unescape(encodeURIComponent(fe)))}return"data:application/pdf;filename="+P.filename+";base64,"+J;case"pdfobjectnewwindow":if(Object.prototype.toString.call(nn)==="[object Window]"){var ye="https://cdnjs.cloudflare.com/ajax/libs/pdfobject/2.1.1/pdfobject.min.js",Te=' integrity="sha512-4ze/a9/4jqu+tX9dfOqJYSvyYd5M6qum/3HpCLr+/Jqf0whc37VUbkpNGHR7/8pSnCFw47T1fmIpwBV7UySh3g==" crossorigin="anonymous"';P.pdfObjectUrl&&(ye=P.pdfObjectUrl,Te="");var We='<html><style>html, body { padding: 0; margin: 0; } iframe { width: 100%; height: 100%; border: 0;}  </style><body><script src="'+ye+'"'+Te+'><\/script><script >PDFObject.embed("'+this.output("dataurlstring")+'", '+JSON.stringify(P)+");<\/script></body></html>",pt=nn.open();return pt!==null&&pt.document.write(We),pt}throw new Error("The option pdfobjectnewwindow just works in a browser-environment.");case"pdfjsnewwindow":if(Object.prototype.toString.call(nn)==="[object Window]"){var ht='<html><style>html, body { padding: 0; margin: 0; } iframe { width: 100%; height: 100%; border: 0;}  </style><body><iframe id="pdfViewer" src="'+(P.pdfJsUrl||"examples/PDF.js/web/viewer.html")+"?file=&downloadName="+P.filename+'" width="500px" height="400px" /></body></html>',Rt=nn.open();if(Rt!==null){Rt.document.write(ht);var jt=this;Rt.document.documentElement.querySelector("#pdfViewer").onload=function(){Rt.document.title=P.filename,Rt.document.documentElement.querySelector("#pdfViewer").contentWindow.PDFViewerApplication.open(jt.output("bloburl"))}}return Rt}throw new Error("The option pdfjsnewwindow just works in a browser-environment.");case"dataurlnewwindow":if(Object.prototype.toString.call(nn)!=="[object Window]")throw new Error("The option dataurlnewwindow just works in a browser-environment.");var Vt='<html><style>html, body { padding: 0; margin: 0; } iframe { width: 100%; height: 100%; border: 0;}  </style><body><iframe src="'+this.output("datauristring",P)+'"></iframe></body></html>',_t=nn.open();if(_t!==null&&(_t.document.write(Vt),_t.document.title=P.filename),_t||typeof safari>"u")return _t;break;case"datauri":case"dataurl":return nn.document.location.href=this.output("datauristring",P);default:return null}},Mn.foo=function(){try{return Mn.apply(this,arguments)}catch(J){var b=J.stack||"";~b.indexOf(" at ")&&(b=b.split(" at ")[1]);var P="Error in function "+b.split(`
`)[0].split("<")[0]+": "+J.message;if(!nn.console)throw new Error(P);nn.console.error(P,J),nn.alert&&alert(P)}},Mn.foo.bar=Mn,Mn.foo),Ni=function(b){return Array.isArray(ai)===!0&&ai.indexOf(b)>-1};switch(i){case"pt":rt=1;break;case"mm":rt=72/25.4;break;case"cm":rt=72/2.54;break;case"in":rt=72;break;case"px":rt=Ni("px_scaling")==1?.75:96/72;break;case"pc":case"em":rt=12;break;case"ex":rt=6;break;default:if(typeof i!="number")throw new Error("Invalid unit: "+i);rt=i}var ui=null;le(),U();var ar=d.__private__.getPageInfo=d.getPageInfo=function(b){if(isNaN(b)||b%1!=0)throw new Error("Invalid argument passed to jsPDF.getPageInfo");return{objId:dt[b].objId,pageNumber:b,pageContext:dt[b]}},or=d.__private__.getPageInfoByObjId=function(b){if(isNaN(b)||b%1!=0)throw new Error("Invalid argument passed to jsPDF.getPageInfoByObjId");for(var P in dt)if(dt[P].objId===b)break;return ar(P)},dl=d.__private__.getCurrentPageInfo=d.getCurrentPageInfo=function(){return{objId:dt[V].objId,pageNumber:V,pageContext:dt[V]}};d.addPage=function(){return xs.apply(this,arguments),this},d.setPage=function(){return vo.apply(this,arguments),Ge.call(this,me[V]),this},d.insertPage=function(b){return this.addPage(),this.movePage(V,b),this},d.movePage=function(b,P){var J,fe;if(b>P){J=me[b],fe=dt[b];for(var ye=b;ye>P;ye--)me[ye]=me[ye-1],dt[ye]=dt[ye-1];me[P]=J,dt[P]=fe,this.setPage(P)}else if(b<P){J=me[b],fe=dt[b];for(var Te=b;Te<P;Te++)me[Te]=me[Te+1],dt[Te]=dt[Te+1];me[P]=J,dt[P]=fe,this.setPage(P)}return this},d.deletePage=function(){return ir.apply(this,arguments),this},d.__private__.text=d.text=function(b,P,J,fe,ye){var Te,We,pt,ht,Rt,jt,Vt,_t,hn,gn=(fe=fe||{}).scope||this;if(typeof b=="number"&&typeof P=="number"&&(typeof J=="string"||Array.isArray(J))){var dn=J;J=P,P=b,b=dn}if(arguments[3]instanceof Ct==0?(pt=arguments[4],ht=arguments[5],jn(Vt=arguments[3])==="object"&&Vt!==null||(typeof pt=="string"&&(ht=pt,pt=null),typeof Vt=="string"&&(ht=Vt,Vt=null),typeof Vt=="number"&&(pt=Vt,Vt=null),fe={flags:Vt,angle:pt,align:ht})):(O("The transform parameter of text() with a Matrix value"),hn=ye),isNaN(P)||isNaN(J)||b==null)throw new Error("Invalid arguments passed to jsPDF.text");if(b.length===0)return gn;var mn,zn="",Bi=typeof fe.lineHeightFactor=="number"?fe.lineHeightFactor:wr,Kn=gn.internal.scaleFactor;function ur(In){return In=In.split("	").join(Array(fe.TabLen||9).join(" ")),Ir(In,Vt)}function Us(In){for(var An,Un=In.concat(),Ci=[],pa=Un.length;pa--;)typeof(An=Un.shift())=="string"?Ci.push(An):Array.isArray(In)&&(An.length===1||An[1]===void 0&&An[2]===void 0)?Ci.push(An[0]):Ci.push([An[0],An[1],An[2]]);return Ci}function Ps(In,An){var Un;if(typeof In=="string")Un=An(In)[0];else if(Array.isArray(In)){for(var Ci,pa,lc=In.concat(),Es=[],ga=lc.length;ga--;)typeof(Ci=lc.shift())=="string"?Es.push(An(Ci)[0]):Array.isArray(Ci)&&typeof Ci[0]=="string"&&(pa=An(Ci[0],Ci[1],Ci[2]),Es.push([pa[0],pa[1],pa[2]]));Un=Es}return Un}var qa=!1,So=!0;if(typeof b=="string")qa=!0;else if(Array.isArray(b)){var ko=b.concat();We=[];for(var Vr,di=ko.length;di--;)(typeof(Vr=ko.shift())!="string"||Array.isArray(Vr)&&typeof Vr[0]!="string")&&(So=!1);qa=So}if(qa===!1)throw new Error('Type of text must be string or Array. "'+b+'" is not recognized.');typeof b=="string"&&(b=b.match(/[\r?\n]/)?b.split(/\r\n|\r|\n/g):[b]);var Ao=Ee/gn.internal.scaleFactor,No=Ao*(Bi-1);switch(fe.baseline){case"bottom":J-=No;break;case"top":J+=Ao-No;break;case"hanging":J+=Ao-2*No;break;case"middle":J+=Ao/2-No}if((jt=fe.maxWidth||0)>0&&(typeof b=="string"?b=gn.splitTextToSize(b,jt):Object.prototype.toString.call(b)==="[object Array]"&&(b=b.reduce(function(In,An){return In.concat(gn.splitTextToSize(An,jt))},[]))),Te={text:b,x:P,y:J,options:fe,mutex:{pdfEscape:Ir,activeFontKey:Ie,fonts:Nt,activeFontSize:Ee}},Ut.publish("preProcessText",Te),b=Te.text,pt=(fe=Te.options).angle,hn instanceof Ct==0&&pt&&typeof pt=="number"){pt*=Math.PI/180,fe.rotationDirection===0&&(pt=-pt),_===A&&(pt=-pt);var nc=Math.cos(pt),Ws=Math.sin(pt);hn=new Ct(nc,Ws,-Ws,nc,0,0)}else pt&&pt instanceof Ct&&(hn=pt);_!==A||hn||(hn=Hn),(Rt=fe.charSpace||cr)!==void 0&&(zn+=D(B(Rt))+` Tc
`,this.setCharSpace(this.getCharSpace()||0)),(_t=fe.horizontalScale)!==void 0&&(zn+=D(100*_t)+` Tz
`),fe.lang;var xi=-1,fa=fe.renderingMode!==void 0?fe.renderingMode:fe.stroke,vl=gn.internal.getCurrentPageInfo().pageContext;switch(fa){case 0:case!1:case"fill":xi=0;break;case 1:case!0:case"stroke":xi=1;break;case 2:case"fillThenStroke":xi=2;break;case 3:case"invisible":xi=3;break;case 4:case"fillAndAddForClipping":xi=4;break;case 5:case"strokeAndAddPathForClipping":xi=5;break;case 6:case"fillThenStrokeAndAddToPathForClipping":xi=6;break;case 7:case"addToPathForClipping":xi=7}var qc=vl.usedRenderingMode!==void 0?vl.usedRenderingMode:-1;xi!==-1?zn+=xi+` Tr
`:qc!==-1&&(zn+=`0 Tr
`),xi!==-1&&(vl.usedRenderingMode=xi),ht=fe.align||"left";var Ji,us=Ee*Bi,ic=gn.internal.pageSize.getWidth(),rc=Nt[Ie];Rt=fe.charSpace||cr,jt=fe.maxWidth||0,Vt=Object.assign({autoencode:!0,noBOM:!0},fe.flags);var ja=[],ds=function(In){return gn.getStringUnitWidth(In,{font:rc,charSpace:Rt,fontSize:Ee,doKerning:!1})*Ee/Kn};if(Object.prototype.toString.call(b)==="[object Array]"){var zi;We=Us(b),ht!=="left"&&(Ji=We.map(ds));var Gr,Ha=0;if(ht==="right"){P-=Ji[0],b=[],di=We.length;for(var ha=0;ha<di;ha++)ha===0?(Gr=ks(P),zi=os(J)):(Gr=B(Ha-Ji[ha]),zi=-us),b.push([We[ha],Gr,zi]),Ha=Ji[ha]}else if(ht==="center"){P-=Ji[0]/2,b=[],di=We.length;for(var Xr=0;Xr<di;Xr++)Xr===0?(Gr=ks(P),zi=os(J)):(Gr=B((Ha-Ji[Xr])/2),zi=-us),b.push([We[Xr],Gr,zi]),Ha=Ji[Xr]}else if(ht==="left"){b=[],di=We.length;for(var Vs=0;Vs<di;Vs++)b.push(We[Vs])}else if(ht==="justify"&&rc.encoding==="Identity-H"){b=[],di=We.length,jt=jt!==0?jt:ic;for(var yl=0,bi=0;bi<di;bi++)if(zi=bi===0?os(J):-us,Gr=bi===0?ks(P):yl,bi<di-1){var jc=B((jt-Ji[bi])/(We[bi].split(" ").length-1)),_r=We[bi].split(" ");b.push([_r[0]+" ",Gr,zi]),yl=0;for(var Sr=1;Sr<_r.length;Sr++){var sc=(ds(_r[Sr-1]+" "+_r[Sr])-ds(_r[Sr]))*Kn+jc;Sr==_r.length-1?b.push([_r[Sr],sc,0]):b.push([_r[Sr]+" ",sc,0]),yl-=sc}}else b.push([We[bi],Gr,zi]);b.push(["",yl,0])}else{if(ht!=="justify")throw new Error('Unrecognized alignment option, use "left", "center", "right" or "justify".');for(b=[],di=We.length,jt=jt!==0?jt:ic,bi=0;bi<di;bi++){zi=bi===0?os(J):-us,Gr=bi===0?ks(P):0;var ac=We[bi].split(" ").length-1,oc=ac>0?(jt-Ji[bi])/ac:0;bi<di-1?ja.push(D(B(oc))):ja.push(0),b.push([We[bi],Gr,zi])}}}(typeof fe.R2L=="boolean"?fe.R2L:Ye)===!0&&(b=Ps(b,function(In,An,Un){return[In.split("").reverse().join(""),An,Un]})),Te={text:b,x:P,y:J,options:fe,mutex:{pdfEscape:Ir,activeFontKey:Ie,fonts:Nt,activeFontSize:Ee}},Ut.publish("postProcessText",Te),b=Te.text,mn=Te.mutex.isHex||!1;var Gs=Nt[Ie].encoding;Gs!=="WinAnsiEncoding"&&Gs!=="StandardEncoding"||(b=Ps(b,function(In,An,Un){return[ur(In),An,Un]})),We=Us(b),b=[];for(var Yr,Ua,Wa,Co=Array.isArray(We[0])?1:0,Kr="",fs=function(In,An,Un){var Ci="";return Un instanceof Ct?(Un=typeof fe.angle=="number"?oi(Un,new Ct(1,0,0,1,In,An)):oi(new Ct(1,0,0,1,In,An),Un),_===A&&(Un=oi(new Ct(1,0,0,-1,0,0),Un)),Ci=Un.join(" ")+` Tm
`):Ci=D(In)+" "+D(An)+` Td
`,Ci},hs=0;hs<We.length;hs++){switch(Kr="",Co){case 1:Wa=(mn?"<":"(")+We[hs][0]+(mn?">":")"),Yr=parseFloat(We[hs][1]),Ua=parseFloat(We[hs][2]);break;case 0:Wa=(mn?"<":"(")+We[hs]+(mn?">":")"),Yr=ks(P),Ua=os(J)}ja!==void 0&&ja[hs]!==void 0&&(Kr=ja[hs]+` Tw
`),hs===0?b.push(Kr+fs(Yr,Ua,hn)+Wa):Co===0?b.push(Kr+Wa):Co===1&&b.push(Kr+fs(Yr,Ua,hn)+Wa)}b=Co===0?b.join(` Tj
T* `):b.join(` Tj
`),b+=` Tj
`;var Xs=`BT
/`;return Xs+=Ie+" "+Ee+` Tf
`,Xs+=D(Ee*Bi)+` TL
`,Xs+=ca+`
`,Xs+=zn,Xs+=b,K(Xs+="ET"),h[Ie]=!0,gn};var tc=d.__private__.clip=d.clip=function(b){return K(b==="evenodd"?"W*":"W"),this};d.clipEvenOdd=function(){return tc("evenodd")},d.__private__.discardPath=d.discardPath=function(){return K("n"),this};var lr=d.__private__.isValidStyle=function(b){var P=!1;return[void 0,null,"S","D","F","DF","FD","f","f*","B","B*","n"].indexOf(b)!==-1&&(P=!0),P};d.__private__.setDefaultPathOperation=d.setDefaultPathOperation=function(b){return lr(b)&&(c=b),this};var as=d.__private__.getStyle=d.getStyle=function(b){var P=c;switch(b){case"D":case"S":P="S";break;case"F":P="f";break;case"FD":case"DF":P="B";break;case"f":case"f*":case"B":case"B*":P=b}return P},_s=d.close=function(){return K("h"),this};d.stroke=function(){return K("S"),this},d.fill=function(b){return zs("f",b),this},d.fillEvenOdd=function(b){return zs("f*",b),this},d.fillStroke=function(b){return zs("B",b),this},d.fillStrokeEvenOdd=function(b){return zs("B*",b),this};var zs=function(b,P){jn(P)==="object"?qs(P,b):K(b)},Lr=function(b){b===null||_===A&&b===void 0||(b=as(b),K(b))};function fl(b,P,J,fe,ye){var Te=new vc(P||this.boundingBox,J||this.xStep,fe||this.yStep,this.gState,ye||this.matrix);Te.stream=this.stream;var We=b+"$$"+this.cloneIndex+++"$$";return Sn(We,Te),Te}var qs=function(b,P){var J=yt[b.key],fe=ct[J];if(fe instanceof jl)K("q"),K(Mr(P)),fe.gState&&d.setGState(fe.gState),K(b.matrix.toString()+" cm"),K("/"+J+" sh"),K("Q");else if(fe instanceof vc){var ye=new Ct(1,0,0,-1,0,da());b.matrix&&(ye=ye.multiply(b.matrix||Hn),J=fl.call(fe,b.key,b.boundingBox,b.xStep,b.yStep,ye).id),K("q"),K("/Pattern cs"),K("/"+J+" scn"),fe.gState&&d.setGState(fe.gState),K(P),K("Q")}},Mr=function(b){switch(b){case"f":case"F":case"n":return"W n";case"f*":return"W* n";case"B":case"S":return"W S";case"B*":return"W* S"}},Da=d.moveTo=function(b,P){return K(D(B(b))+" "+D(E(P))+" m"),this},hl=d.lineTo=function(b,P){return K(D(B(b))+" "+D(E(P))+" l"),this},br=d.curveTo=function(b,P,J,fe,ye,Te){return K([D(B(b)),D(E(P)),D(B(J)),D(E(fe)),D(B(ye)),D(E(Te)),"c"].join(" ")),this};d.__private__.line=d.line=function(b,P,J,fe,ye){if(isNaN(b)||isNaN(P)||isNaN(J)||isNaN(fe)||!lr(ye))throw new Error("Invalid arguments passed to jsPDF.line");return _===S?this.lines([[J-b,fe-P]],b,P,[1,1],ye||"S"):this.lines([[J-b,fe-P]],b,P,[1,1]).stroke()},d.__private__.lines=d.lines=function(b,P,J,fe,ye,Te){var We,pt,ht,Rt,jt,Vt,_t,hn,gn,dn,mn,zn;if(typeof b=="number"&&(zn=J,J=P,P=b,b=zn),fe=fe||[1,1],Te=Te||!1,isNaN(P)||isNaN(J)||!Array.isArray(b)||!Array.isArray(fe)||!lr(ye)||typeof Te!="boolean")throw new Error("Invalid arguments passed to jsPDF.lines");for(Da(P,J),We=fe[0],pt=fe[1],Rt=b.length,dn=P,mn=J,ht=0;ht<Rt;ht++)(jt=b[ht]).length===2?(dn=jt[0]*We+dn,mn=jt[1]*pt+mn,hl(dn,mn)):(Vt=jt[0]*We+dn,_t=jt[1]*pt+mn,hn=jt[2]*We+dn,gn=jt[3]*pt+mn,dn=jt[4]*We+dn,mn=jt[5]*pt+mn,br(Vt,_t,hn,gn,dn,mn));return Te&&_s(),Lr(ye),this},d.path=function(b){for(var P=0;P<b.length;P++){var J=b[P],fe=J.c;switch(J.op){case"m":Da(fe[0],fe[1]);break;case"l":hl(fe[0],fe[1]);break;case"c":br.apply(this,fe);break;case"h":_s()}}return this},d.__private__.rect=d.rect=function(b,P,J,fe,ye){if(isNaN(b)||isNaN(P)||isNaN(J)||isNaN(fe)||!lr(ye))throw new Error("Invalid arguments passed to jsPDF.rect");return _===S&&(fe=-fe),K([D(B(b)),D(E(P)),D(B(J)),D(B(fe)),"re"].join(" ")),Lr(ye),this},d.__private__.triangle=d.triangle=function(b,P,J,fe,ye,Te,We){if(isNaN(b)||isNaN(P)||isNaN(J)||isNaN(fe)||isNaN(ye)||isNaN(Te)||!lr(We))throw new Error("Invalid arguments passed to jsPDF.triangle");return this.lines([[J-b,fe-P],[ye-J,Te-fe],[b-ye,P-Te]],b,P,[1,1],We,!0),this},d.__private__.roundedRect=d.roundedRect=function(b,P,J,fe,ye,Te,We){if(isNaN(b)||isNaN(P)||isNaN(J)||isNaN(fe)||isNaN(ye)||isNaN(Te)||!lr(We))throw new Error("Invalid arguments passed to jsPDF.roundedRect");var pt=4/3*(Math.SQRT2-1);return ye=Math.min(ye,.5*J),Te=Math.min(Te,.5*fe),this.lines([[J-2*ye,0],[ye*pt,0,ye,Te-Te*pt,ye,Te],[0,fe-2*Te],[0,Te*pt,-ye*pt,Te,-ye,Te],[2*ye-J,0],[-ye*pt,0,-ye,-Te*pt,-ye,-Te],[0,2*Te-fe],[0,-Te*pt,ye*pt,-Te,ye,-Te]],b+ye,P,[1,1],We,!0),this},d.__private__.ellipse=d.ellipse=function(b,P,J,fe,ye){if(isNaN(b)||isNaN(P)||isNaN(J)||isNaN(fe)||!lr(ye))throw new Error("Invalid arguments passed to jsPDF.ellipse");var Te=4/3*(Math.SQRT2-1)*J,We=4/3*(Math.SQRT2-1)*fe;return Da(b+J,P),br(b+J,P-We,b+Te,P-fe,b,P-fe),br(b-Te,P-fe,b-J,P-We,b-J,P),br(b-J,P+We,b-Te,P+fe,b,P+fe),br(b+Te,P+fe,b+J,P+We,b+J,P),Lr(ye),this},d.__private__.circle=d.circle=function(b,P,J,fe){if(isNaN(b)||isNaN(P)||isNaN(J)||!lr(fe))throw new Error("Invalid arguments passed to jsPDF.circle");return this.ellipse(b,P,J,J,fe)},d.setFont=function(b,P,J){return J&&(P=T(P,J)),Ie=ul(b,P,{disableWarning:!1}),this};var Tr=d.__private__.getFont=d.getFont=function(){return Nt[ul.apply(d,arguments)]};d.__private__.getFontList=d.getFontList=function(){var b,P,J={};for(b in it)if(it.hasOwnProperty(b))for(P in J[b]=[],it[b])it[b].hasOwnProperty(P)&&J[b].push(P);return J},d.addFont=function(b,P,J,fe,ye){var Te=["StandardEncoding","MacRomanEncoding","Identity-H","WinAnsiEncoding"];return arguments[3]&&Te.indexOf(arguments[3])!==-1?ye=arguments[3]:arguments[3]&&Te.indexOf(arguments[3])==-1&&(J=T(J,fe)),go.call(this,b,P,J,ye=ye||"Identity-H")};var wr,yo=t.lineWidth||.200025,pl=d.__private__.getLineWidth=d.getLineWidth=function(){return yo},Yt=d.__private__.setLineWidth=d.setLineWidth=function(b){return yo=b,K(D(B(b))+" w"),this};d.__private__.setLineDash=qt.API.setLineDash=qt.API.setLineDashPattern=function(b,P){if(b=b||[],P=P||0,isNaN(P)||!Array.isArray(b))throw new Error("Invalid arguments passed to jsPDF.setLineDash");return b=b.map(function(J){return D(B(J))}).join(" "),P=D(B(P)),K("["+b+"] "+P+" d"),this};var Ss=d.__private__.getLineHeight=d.getLineHeight=function(){return Ee*wr};d.__private__.getLineHeight=d.getLineHeight=function(){return Ee*wr};var js=d.__private__.setLineHeightFactor=d.setLineHeightFactor=function(b){return typeof(b=b||1.15)=="number"&&(wr=b),this},Oa=d.__private__.getLineHeightFactor=d.getLineHeightFactor=function(){return wr};js(t.lineHeight);var ks=d.__private__.getHorizontalCoordinate=function(b){return B(b)},os=d.__private__.getVerticalCoordinate=function(b){return _===A?b:dt[V].mediaBox.topRightY-dt[V].mediaBox.bottomLeftY-B(b)},Hs=d.__private__.getHorizontalCoordinateString=d.getHorizontalCoordinateString=function(b){return D(ks(b))},As=d.__private__.getVerticalCoordinateString=d.getVerticalCoordinateString=function(b){return D(os(b))},Fa=t.strokeColor||"0 G";d.__private__.getStrokeColor=d.getDrawColor=function(){return Gt(Fa)},d.__private__.setStrokeColor=d.setDrawColor=function(b,P,J,fe){return Fa=Dt({ch1:b,ch2:P,ch3:J,ch4:fe,pdfColorType:"draw",precision:2}),K(Fa),this};var Ra=t.fillColor||"0 g";d.__private__.getFillColor=d.getFillColor=function(){return Gt(Ra)},d.__private__.setFillColor=d.setFillColor=function(b,P,J,fe){return Ra=Dt({ch1:b,ch2:P,ch3:J,ch4:fe,pdfColorType:"fill",precision:2}),K(Ra),this};var ca=t.textColor||"0 g",Ns=d.__private__.getTextColor=d.getTextColor=function(){return Gt(ca)};d.__private__.setTextColor=d.setTextColor=function(b,P,J,fe){return ca=Dt({ch1:b,ch2:P,ch3:J,ch4:fe,pdfColorType:"text",precision:3}),this};var cr=t.charSpace,gl=d.__private__.getCharSpace=d.getCharSpace=function(){return parseFloat(cr||0)};d.__private__.setCharSpace=d.setCharSpace=function(b){if(isNaN(b))throw new Error("Invalid argument passed to jsPDF.setCharSpace");return cr=b,this};var bo=0;d.CapJoinStyles={0:0,butt:0,but:0,miter:0,1:1,round:1,rounded:1,circle:1,2:2,projecting:2,project:2,square:2,bevel:2},d.__private__.setLineCap=d.setLineCap=function(b){var P=d.CapJoinStyles[b];if(P===void 0)throw new Error("Line cap style of '"+b+"' is not recognized. See or extend .CapJoinStyles property for valid styles");return bo=P,K(P+" J"),this};var Ba=0;d.__private__.setLineJoin=d.setLineJoin=function(b){var P=d.CapJoinStyles[b];if(P===void 0)throw new Error("Line join style of '"+b+"' is not recognized. See or extend .CapJoinStyles property for valid styles");return Ba=P,K(P+" j"),this},d.__private__.setLineMiterLimit=d.__private__.setMiterLimit=d.setLineMiterLimit=d.setMiterLimit=function(b){if(b=b||0,isNaN(b))throw new Error("Invalid argument passed to jsPDF.setLineMiterLimit");return K(D(B(b))+" M"),this},d.GState=Ec,d.setGState=function(b){(b=typeof b=="string"?st[gt[b]]:Cs(null,b)).equals(Bt)||(K("/"+b.id+" gs"),Bt=b)};var Cs=function(b,P){if(!b||!gt[b]){var J=!1;for(var fe in st)if(st.hasOwnProperty(fe)&&st[fe].equals(P)){J=!0;break}if(J)P=st[fe];else{var ye="GS"+(Object.keys(st).length+1).toString(10);st[ye]=P,P.id=ye}return b&&(gt[b]=P.id),Ut.publish("addGState",P),P}};d.addGState=function(b,P){return Cs(b,P),this},d.saveGraphicsState=function(){return K("q"),kt.push({key:Ie,size:Ee,color:ca}),this},d.restoreGraphicsState=function(){K("Q");var b=kt.pop();return Ie=b.key,Ee=b.size,ca=b.color,Bt=null,this},d.setCurrentTransformationMatrix=function(b){return K(b.toString()+" cm"),this},d.comment=function(b){return K("#"+b),this};var Ki=function(b,P){var J=b||0;Object.defineProperty(this,"x",{enumerable:!0,get:function(){return J},set:function(Te){isNaN(Te)||(J=parseFloat(Te))}});var fe=P||0;Object.defineProperty(this,"y",{enumerable:!0,get:function(){return fe},set:function(Te){isNaN(Te)||(fe=parseFloat(Te))}});var ye="pt";return Object.defineProperty(this,"type",{enumerable:!0,get:function(){return ye},set:function(Te){ye=Te.toString()}}),this},wo=function(b,P,J,fe){Ki.call(this,b,P),this.type="rect";var ye=J||0;Object.defineProperty(this,"w",{enumerable:!0,get:function(){return ye},set:function(We){isNaN(We)||(ye=parseFloat(We))}});var Te=fe||0;return Object.defineProperty(this,"h",{enumerable:!0,get:function(){return Te},set:function(We){isNaN(We)||(Te=parseFloat(We))}}),this},ua=function(){this.page=xt,this.currentPage=V,this.pages=me.slice(0),this.pagesContext=dt.slice(0),this.x=et,this.y=vt,this.matrix=wt,this.width=Wr(V),this.height=_o(V),this.outputDestination=ke,this.id="",this.objectNumber=-1};ua.prototype.restore=function(){xt=this.page,V=this.currentPage,dt=this.pagesContext,me=this.pages,et=this.x,vt=this.y,wt=this.matrix,xo(V,this.width),ls(V,this.height),ke=this.outputDestination};var za=function(b,P,J,fe,ye){ni.push(new ua),xt=V=0,me=[],et=b,vt=P,wt=ye,mo([J,fe])};for(var xr in d.beginFormObject=function(b,P,J,fe,ye){return za(b,P,J,fe,ye),this},d.endFormObject=function(b){return(function(P){if(Ln[P])ni.pop().restore();else{var J=new ua,fe="Xo"+(Object.keys(bn).length+1).toString(10);J.id=fe,Ln[P]=fe,bn[fe]=J,Ut.publish("addFormObject",J),ni.pop().restore()}})(b),this},d.doFormObject=function(b,P){var J=bn[Ln[b]];return K("q"),K(P.toString()+" cm"),K("/"+J.id+" Do"),K("Q"),this},d.getFormObject=function(b){var P=bn[Ln[b]];return{x:P.x,y:P.y,width:P.width,height:P.height,matrix:P.matrix}},d.save=function(b,P){return b=b||"generated.pdf",(P=P||{}).returnPromise=P.returnPromise||!1,P.returnPromise===!1?(hc(sr(Yi()),b),typeof hc.unload=="function"&&nn.setTimeout&&setTimeout(hc.unload,911),this):new Promise(function(J,fe){try{var ye=hc(sr(Yi()),b);typeof hc.unload=="function"&&nn.setTimeout&&setTimeout(hc.unload,911),J(ye)}catch(Te){fe(Te.message)}})},qt.API)qt.API.hasOwnProperty(xr)&&(xr==="events"&&qt.API.events.length?(function(b,P){var J,fe,ye;for(ye=P.length-1;ye!==-1;ye--)J=P[ye][0],fe=P[ye][1],b.subscribe.apply(b,[J].concat(typeof fe=="function"?[fe]:fe))})(Ut,qt.API.events):d[xr]=qt.API[xr]);function Wr(b){return dt[b].mediaBox.topRightX-dt[b].mediaBox.bottomLeftX}function xo(b,P){dt[b].mediaBox.topRightX=P+dt[b].mediaBox.bottomLeftX}function _o(b){return dt[b].mediaBox.topRightY-dt[b].mediaBox.bottomLeftY}function ls(b,P){dt[b].mediaBox.topRightY=P+dt[b].mediaBox.bottomLeftY}var Zi=d.getPageWidth=function(b){return Wr(b=b||V)/rt},cs=d.setPageWidth=function(b,P){xo(b,P*rt)},da=d.getPageHeight=function(b){return _o(b=b||V)/rt},ml=d.setPageHeight=function(b,P){ls(b,P*rt)};return d.internal={pdfEscape:Ir,getStyle:as,getFont:Tr,getFontSize:Ue,getCharSpace:gl,getTextColor:Ns,getLineHeight:Ss,getLineHeightFactor:Oa,getLineWidth:pl,write:Oe,getHorizontalCoordinate:ks,getVerticalCoordinate:os,getCoordinateString:Hs,getVerticalCoordinateString:As,collections:{},newObject:Pn,newAdditionalObject:Pt,newObjectDeferred:qe,newObjectDeferredBegin:$e,getFilters:Jt,putStream:$t,events:Ut,scaleFactor:rt,pageSize:{getWidth:function(){return Zi(V)},setWidth:function(b){cs(V,b)},getHeight:function(){return da(V)},setHeight:function(b){ml(V,b)}},encryptionOptions:u,encryption:ui,getEncryptor:function(b){return u!==null?ui.encryptor(b,0):function(P){return P}},output:Ta,getNumberOfPages:cl,get pages(){return me},out:K,f2:C,f3:N,getPageInfo:ar,getPageInfoByObjId:or,getCurrentPageInfo:dl,getPDFVersion:m,Point:Ki,Rectangle:wo,Matrix:Ct,hasHotfix:Ni},Object.defineProperty(d.internal.pageSize,"width",{get:function(){return Zi(V)},set:function(b){cs(V,b)},enumerable:!0,configurable:!0}),Object.defineProperty(d.internal.pageSize,"height",{get:function(){return da(V)},set:function(b){ml(V,b)},enumerable:!0,configurable:!0}),(function(b){for(var P=0,J=Be.length;P<J;P++){var fe=go.call(this,b[P][0],b[P][1],b[P][2],Be[P][3],!0);f===!1&&(h[fe]=!0);var ye=b[P][0].split("-");yr({id:fe,fontName:ye[0],fontStyle:ye[1]||""})}Ut.publish("addFonts",{fonts:Nt,dictionary:it})}).call(d,Be),Ie="F1",xs(r,n),Ut.publish("initialized"),d}su.prototype.lsbFirstWord=function(t){return String.fromCharCode(255&t,t>>8&255,t>>16&255,t>>24&255)},su.prototype.toHexString=function(t){return t.split("").map(function(e){return("0"+(255&e.charCodeAt(0)).toString(16)).slice(-2)}).join("")},su.prototype.hexToBytes=function(t){for(var e=[],n=0;n<t.length;n+=2)e.push(String.fromCharCode(parseInt(t.substr(n,2),16)));return e.join("")},su.prototype.processOwnerPassword=function(t,e){return Ym(Xm(e).substr(0,5),t)},su.prototype.encryptor=function(t,e){var n=Xm(this.encryptionKey+String.fromCharCode(255&t,t>>8&255,t>>16&255,255&e,e>>8&255)).substr(0,10);return function(i){return Ym(n,i)}},Ec.prototype.equals=function(t){var e,n="id,objectNumber,equals";if(!t||jn(t)!==jn(this))return!1;var i=0;for(e in this)if(!(n.indexOf(e)>=0)){if(this.hasOwnProperty(e)&&!t.hasOwnProperty(e)||this[e]!==t[e])return!1;i++}for(e in t)t.hasOwnProperty(e)&&n.indexOf(e)<0&&i--;return i===0},qt.API={events:[]},qt.version="4.1.0";var Si=qt.API,c0=1,Bc=function(t){return t.replace(/\\/g,"\\\\").replace(/\(/g,"\\(").replace(/\)/g,"\\)")},Qc=function(t){return t.replace(/\\\\/g,"\\").replace(/\\\(/g,"(").replace(/\\\)/g,")")},Wh=function(t){return t.toString().replace(/#/g,"#23").replace(/[\s\n\r()<>[\]{}\/%]/g,function(e){var n=e.charCodeAt(0).toString(16).toUpperCase();return"#"+(n.length===1?"0"+n:n)})},sn=function(t){return t.toFixed(2)},Fl=function(t){return t.toFixed(5)};Si.__acroform__={};var ws=function(t,e){t.prototype=Object.create(e.prototype),t.prototype.constructor=t},dy=function(t){return t*c0},Qa=function(t){var e=new jx,n=Et.internal.getHeight(t)||0,i=Et.internal.getWidth(t)||0;return e.BBox=[0,0,Number(sn(i)),Number(sn(n))],e},JO=Si.__acroform__.setBit=function(t,e){if(t=t||0,e=e||0,isNaN(t)||isNaN(e))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.setBit");return t|1<<e},QO=Si.__acroform__.clearBit=function(t,e){if(t=t||0,e=e||0,isNaN(t)||isNaN(e))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.clearBit");return t&~(1<<e)},$O=Si.__acroform__.getBit=function(t,e){if(isNaN(t)||isNaN(e))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.getBit");return t&1<<e?1:0},Ti=Si.__acroform__.getBitForPdf=function(t,e){if(isNaN(t)||isNaN(e))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.getBitForPdf");return $O(t,e-1)},Di=Si.__acroform__.setBitForPdf=function(t,e){if(isNaN(t)||isNaN(e))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.setBitForPdf");return JO(t,e-1)},Oi=Si.__acroform__.clearBitForPdf=function(t,e){if(isNaN(t)||isNaN(e))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.clearBitForPdf");return QO(t,e-1)},eF=Si.__acroform__.calculateCoordinates=function(t,e){var n=e.internal.getHorizontalCoordinate,i=e.internal.getVerticalCoordinate,r=t[0],s=t[1],a=t[2],o=t[3],l={};return l.lowerLeft_X=n(r)||0,l.lowerLeft_Y=i(s+o)||0,l.upperRight_X=n(r+a)||0,l.upperRight_Y=i(s)||0,[Number(sn(l.lowerLeft_X)),Number(sn(l.lowerLeft_Y)),Number(sn(l.upperRight_X)),Number(sn(l.upperRight_Y))]},tF=function(t){if(t.appearanceStreamContent)return t.appearanceStreamContent;if(t.V||t.DV){var e=[],n=t._V||t.DV,i=Km(t,n),r=t.scope.internal.getFont(t.fontName,t.fontStyle).id;e.push("/Tx BMC"),e.push("q"),e.push("BT"),e.push(t.scope.__private__.encodeColorString(t.color)),e.push("/"+r+" "+sn(i.fontSize)+" Tf"),e.push("1 0 0 1 0 0 Tm"),e.push(i.text),e.push("ET"),e.push("Q"),e.push("EMC");var s=Qa(t);return s.scope=t.scope,s.stream=e.join(`
`),s}},Km=function(t,e){var n=t.fontSize===0?t.maxFontSize:t.fontSize,i={text:"",fontSize:""},r=(e=(e=e.substr(0,1)=="("?e.substr(1):e).substr(e.length-1)==")"?e.substr(0,e.length-1):e).split(" ");r=t.multiline?r.map(function(C){return C.split(`
`)}):r.map(function(C){return[C]});var s=n,a=Et.internal.getHeight(t)||0;a=a<0?-a:a;var o=Et.internal.getWidth(t)||0;o=o<0?-o:o;var l=function(C,N,B){if(C+1<r.length){var E=N+" "+r[C+1][0];return Hf(E,t,B).width<=o-4}return!1};s++;e:for(;s>0;){e="",s--;var c,u,f=Hf("3",t,s).height,h=t.multiline?a-s:(a-f)/2,d=h+=2,y=0,m=0,x=0;if(s<=0){e=`(...) Tj
`,e+="% Width of Text: "+Hf(e,t,s=12).width+", FieldWidth:"+o+`
`;break}for(var w="",S=0,A=0;A<r.length;A++)if(r.hasOwnProperty(A)){var _=!1;if(r[A].length!==1&&x!==r[A].length-1){if((f+2)*(S+2)+2>a)continue e;w+=r[A][x],_=!0,m=A,A--}else{w=(w+=r[A][x]+" ").substr(w.length-1)==" "?w.substr(0,w.length-1):w;var M=parseInt(A),I=l(M,w,s),T=A>=r.length-1;if(I&&!T){w+=" ",x=0;continue}if(I||T){if(T)m=M;else if(t.multiline&&(f+2)*(S+2)+2>a)continue e}else{if(!t.multiline||(f+2)*(S+2)+2>a)continue e;m=M}}for(var D="",O=y;O<=m;O++){var W=r[O];if(t.multiline){if(O===m){D+=W[x]+" ",x=(x+1)%W.length;continue}if(O===y){D+=W[W.length-1]+" ";continue}}D+=W[0]+" "}switch(D=D.substr(D.length-1)==" "?D.substr(0,D.length-1):D,u=Hf(D,t,s).width,t.textAlign){case"right":c=o-u-2;break;case"center":c=(o-u)/2;break;default:c=2}e+=sn(c)+" "+sn(d)+` Td
`,e+="("+Bc(D)+`) Tj
`,e+=-sn(c)+` 0 Td
`,d=-(s+2),u=0,y=_?m:m+1,S++,w=""}break}return i.text=e,i.fontSize=s,i},Hf=function(t,e,n){var i=e.scope.internal.getFont(e.fontName,e.fontStyle),r=e.scope.getStringUnitWidth(t,{font:i,fontSize:parseFloat(n),charSpace:0})*parseFloat(n);return{height:e.scope.getStringUnitWidth("3",{font:i,fontSize:parseFloat(n),charSpace:0})*parseFloat(n)*1.5,width:r}},nF={fields:[],xForms:[],acroFormDictionaryRoot:null,printedOut:!1,internal:null,isInitialized:!1},iF=function(t,e){var n={type:"reference",object:t};e.internal.getPageInfo(t.page).pageContext.annotations.find(function(i){return i.type===n.type&&i.object===n.object})===void 0&&e.internal.getPageInfo(t.page).pageContext.annotations.push(n)},rF=function(t,e){if(e.scope=t,t.internal!==void 0&&(t.internal.acroformPlugin===void 0||t.internal.acroformPlugin.isInitialized===!1)){if(La.FieldNum=0,t.internal.acroformPlugin=JSON.parse(JSON.stringify(nF)),t.internal.acroformPlugin.acroFormDictionaryRoot)throw new Error("Exception while creating AcroformDictionary");c0=t.internal.scaleFactor,t.internal.acroformPlugin.acroFormDictionaryRoot=new Hx,t.internal.acroformPlugin.acroFormDictionaryRoot.scope=t,t.internal.acroformPlugin.acroFormDictionaryRoot._eventID=t.internal.events.subscribe("postPutResources",function(){(function(n){n.internal.events.unsubscribe(n.internal.acroformPlugin.acroFormDictionaryRoot._eventID),delete n.internal.acroformPlugin.acroFormDictionaryRoot._eventID,n.internal.acroformPlugin.printedOut=!0})(t)}),t.internal.events.subscribe("buildDocument",function(){(function(n){n.internal.acroformPlugin.acroFormDictionaryRoot.objId=void 0;var i=n.internal.acroformPlugin.acroFormDictionaryRoot.Fields;for(var r in i)if(i.hasOwnProperty(r)){var s=i[r];s.objId=void 0,s.hasAnnotation&&iF(s,n)}})(t)}),t.internal.events.subscribe("putCatalog",function(){(function(n){if(n.internal.acroformPlugin.acroFormDictionaryRoot===void 0)throw new Error("putCatalogCallback: Root missing.");n.internal.write("/AcroForm "+n.internal.acroformPlugin.acroFormDictionaryRoot.objId+" 0 R")})(t)}),t.internal.events.subscribe("postPutPages",function(n){(function(i,r){var s=!i;for(var a in i||(r.internal.newObjectDeferredBegin(r.internal.acroformPlugin.acroFormDictionaryRoot.objId,!0),r.internal.acroformPlugin.acroFormDictionaryRoot.putStream()),i=i||r.internal.acroformPlugin.acroFormDictionaryRoot.Kids)if(i.hasOwnProperty(a)){var o=i[a],l=[],c=o.Rect;if(o.Rect&&(o.Rect=eF(o.Rect,r)),r.internal.newObjectDeferredBegin(o.objId,!0),o.DA=Et.createDefaultAppearanceStream(o),jn(o)==="object"&&typeof o.getKeyValueListForStream=="function"&&(l=o.getKeyValueListForStream()),o.Rect=c,o.hasAppearanceStream&&!o.appearanceStreamContent){var u=tF(o);l.push({key:"AP",value:"<</N "+u+">>"}),r.internal.acroformPlugin.xForms.push(u)}if(o.appearanceStreamContent){var f="";for(var h in o.appearanceStreamContent)if(o.appearanceStreamContent.hasOwnProperty(h)){var d=o.appearanceStreamContent[h];if(f+="/"+h+" ",f+="<<",Object.keys(d).length>=1||Array.isArray(d)){for(var a in d)if(d.hasOwnProperty(a)){var y=d[a];typeof y=="function"&&(y=y.call(r,o)),f+="/"+a+" "+y+" ",r.internal.acroformPlugin.xForms.indexOf(y)>=0||r.internal.acroformPlugin.xForms.push(y)}}else typeof(y=d)=="function"&&(y=y.call(r,o)),f+="/"+a+" "+y,r.internal.acroformPlugin.xForms.indexOf(y)>=0||r.internal.acroformPlugin.xForms.push(y);f+=">>"}l.push({key:"AP",value:`<<
`+f+">>"})}r.internal.putStream({additionalKeyValues:l,objectId:o.objId}),r.internal.out("endobj")}s&&(function(m,x){for(var w in m)if(m.hasOwnProperty(w)){var S=w,A=m[w];x.internal.newObjectDeferredBegin(A.objId,!0),jn(A)==="object"&&typeof A.putStream=="function"&&A.putStream(),delete m[S]}})(r.internal.acroformPlugin.xForms,r)})(n,t)}),t.internal.acroformPlugin.isInitialized=!0}},qx=Si.__acroform__.arrayToPdfArray=function(t,e,n){var i=function(a){return a};if(Array.isArray(t)){for(var r="[",s=0;s<t.length;s++)switch(s!==0&&(r+=" "),jn(t[s])){case"boolean":case"number":case"object":r+=t[s].toString();break;case"string":t[s].substr(0,1)==="/"?r+="/"+Wh(t[s].substr(1)):(e!==void 0&&n&&(i=n.internal.getEncryptor(e)),r+="("+Bc(i(t[s].toString()))+")")}return r+"]"}throw new Error("Invalid argument passed to jsPDF.__acroform__.arrayToPdfArray")},qg=function(t,e,n){var i=function(r){return r};return e!==void 0&&n&&(i=n.internal.getEncryptor(e)),(t=t||"").toString(),"("+Bc(i(t))+")"},ro=function(){this._objId=void 0,this._scope=void 0,Object.defineProperty(this,"objId",{get:function(){if(this._objId===void 0){if(this.scope===void 0)return;this._objId=this.scope.internal.newObjectDeferred()}return this._objId},set:function(t){this._objId=t}}),Object.defineProperty(this,"scope",{value:this._scope,writable:!0})};ro.prototype.toString=function(){return this.objId+" 0 R"},ro.prototype.putStream=function(){var t=this.getKeyValueListForStream();this.scope.internal.putStream({data:this.stream,additionalKeyValues:t,objectId:this.objId}),this.scope.internal.out("endobj")},ro.prototype.getKeyValueListForStream=function(){var t=[],e=Object.getOwnPropertyNames(this).filter(function(s){return s!="content"&&s!="appearanceStreamContent"&&s!="scope"&&s!="objId"&&s.substring(0,1)!="_"});for(var n in e)if(Object.getOwnPropertyDescriptor(this,e[n]).configurable===!1){var i=e[n],r=this[i];r&&(Array.isArray(r)?t.push({key:i,value:qx(r,this.objId,this.scope)}):r instanceof ro?(r.scope=this.scope,t.push({key:i,value:r.objId+" 0 R"})):typeof r!="function"&&t.push({key:i,value:r}))}return t};var jx=function(){ro.call(this),Object.defineProperty(this,"Type",{value:"/XObject",configurable:!1,writable:!0}),Object.defineProperty(this,"Subtype",{value:"/Form",configurable:!1,writable:!0}),Object.defineProperty(this,"FormType",{value:1,configurable:!1,writable:!0});var t,e=[];Object.defineProperty(this,"BBox",{configurable:!1,get:function(){return e},set:function(n){e=n}}),Object.defineProperty(this,"Resources",{value:"2 0 R",configurable:!1,writable:!0}),Object.defineProperty(this,"stream",{enumerable:!1,configurable:!0,set:function(n){t=n.trim()},get:function(){return t||null}})};ws(jx,ro);var Hx=function(){ro.call(this);var t,e=[];Object.defineProperty(this,"Kids",{enumerable:!1,configurable:!0,get:function(){return e.length>0?e:void 0}}),Object.defineProperty(this,"Fields",{enumerable:!1,configurable:!1,get:function(){return e}}),Object.defineProperty(this,"DA",{enumerable:!1,configurable:!1,get:function(){if(t){var n=function(i){return i};return this.scope&&(n=this.scope.internal.getEncryptor(this.objId)),"("+Bc(n(t))+")"}},set:function(n){t=n}})};ws(Hx,ro);var La=function t(){ro.call(this);var e=4;Object.defineProperty(this,"F",{enumerable:!1,configurable:!1,get:function(){return e},set:function(w){if(isNaN(w))throw new Error('Invalid value "'+w+'" for attribute F supplied.');e=w}}),Object.defineProperty(this,"showWhenPrinted",{enumerable:!0,configurable:!0,get:function(){return!!Ti(e,3)},set:function(w){w?this.F=Di(e,3):this.F=Oi(e,3)}});var n=0;Object.defineProperty(this,"Ff",{enumerable:!1,configurable:!1,get:function(){return n},set:function(w){if(isNaN(w))throw new Error('Invalid value "'+w+'" for attribute Ff supplied.');n=w}});var i=[];Object.defineProperty(this,"Rect",{enumerable:!1,configurable:!1,get:function(){if(i.length!==0)return i},set:function(w){i=w!==void 0?w:[]}}),Object.defineProperty(this,"x",{enumerable:!0,configurable:!0,get:function(){return!i||isNaN(i[0])?0:i[0]},set:function(w){i[0]=w}}),Object.defineProperty(this,"y",{enumerable:!0,configurable:!0,get:function(){return!i||isNaN(i[1])?0:i[1]},set:function(w){i[1]=w}}),Object.defineProperty(this,"width",{enumerable:!0,configurable:!0,get:function(){return!i||isNaN(i[2])?0:i[2]},set:function(w){i[2]=w}}),Object.defineProperty(this,"height",{enumerable:!0,configurable:!0,get:function(){return!i||isNaN(i[3])?0:i[3]},set:function(w){i[3]=w}});var r="";Object.defineProperty(this,"FT",{enumerable:!0,configurable:!1,get:function(){return r},set:function(w){switch(w){case"/Btn":case"/Tx":case"/Ch":case"/Sig":r=w;break;default:throw new Error('Invalid value "'+w+'" for attribute FT supplied.')}}});var s=null;Object.defineProperty(this,"T",{enumerable:!0,configurable:!1,get:function(){if(!s||s.length<1){if(this instanceof Vh)return;s="FieldObject"+t.FieldNum++}var w=function(S){return S};return this.scope&&(w=this.scope.internal.getEncryptor(this.objId)),"("+Bc(w(s))+")"},set:function(w){s=w.toString()}}),Object.defineProperty(this,"fieldName",{configurable:!0,enumerable:!0,get:function(){return s},set:function(w){s=w}});var a="helvetica";Object.defineProperty(this,"fontName",{enumerable:!0,configurable:!0,get:function(){return a},set:function(w){a=w}});var o="normal";Object.defineProperty(this,"fontStyle",{enumerable:!0,configurable:!0,get:function(){return o},set:function(w){o=w}});var l=0;Object.defineProperty(this,"fontSize",{enumerable:!0,configurable:!0,get:function(){return l},set:function(w){l=w}});var c=void 0;Object.defineProperty(this,"maxFontSize",{enumerable:!0,configurable:!0,get:function(){return c===void 0?50/c0:c},set:function(w){c=w}});var u="black";Object.defineProperty(this,"color",{enumerable:!0,configurable:!0,get:function(){return u},set:function(w){u=w}});var f="/F1 0 Tf 0 g";Object.defineProperty(this,"DA",{enumerable:!0,configurable:!1,get:function(){if(!(!f||this instanceof Vh||this instanceof wc))return qg(f,this.objId,this.scope)},set:function(w){w=w.toString(),f=w}});var h=null;Object.defineProperty(this,"DV",{enumerable:!1,configurable:!1,get:function(){if(h)return this instanceof gr==0?qg(h,this.objId,this.scope):h},set:function(w){w=w.toString(),h=this instanceof gr==0?w.substr(0,1)==="("?Qc(w.substr(1,w.length-2)):Qc(w):w}}),Object.defineProperty(this,"defaultValue",{enumerable:!0,configurable:!0,get:function(){return this instanceof gr==1?Qc(h.substr(1,h.length-1)):h},set:function(w){w=w.toString(),h=this instanceof gr==1?"/"+Wh(w):w}});var d=null;Object.defineProperty(this,"_V",{enumerable:!1,configurable:!1,get:function(){if(d)return d},set:function(w){this.V=w}}),Object.defineProperty(this,"V",{enumerable:!1,configurable:!1,get:function(){if(d)return this instanceof gr==0?qg(d,this.objId,this.scope):d},set:function(w){w=w.toString(),d=this instanceof gr==0?w.substr(0,1)==="("?Qc(w.substr(1,w.length-2)):Qc(w):w}}),Object.defineProperty(this,"value",{enumerable:!0,configurable:!0,get:function(){return this instanceof gr==1?Qc(d.substr(1,d.length-1)):d},set:function(w){w=w.toString(),d=this instanceof gr==1?"/"+Wh(w):w}}),Object.defineProperty(this,"hasAnnotation",{enumerable:!0,configurable:!0,get:function(){return this.Rect}}),Object.defineProperty(this,"Type",{enumerable:!0,configurable:!1,get:function(){return this.hasAnnotation?"/Annot":null}}),Object.defineProperty(this,"Subtype",{enumerable:!0,configurable:!1,get:function(){return this.hasAnnotation?"/Widget":null}});var y,m=!1;Object.defineProperty(this,"hasAppearanceStream",{enumerable:!0,configurable:!0,get:function(){return m},set:function(w){w=!!w,m=w}}),Object.defineProperty(this,"page",{enumerable:!0,configurable:!0,get:function(){if(y)return y},set:function(w){y=w}}),Object.defineProperty(this,"readOnly",{enumerable:!0,configurable:!0,get:function(){return!!Ti(this.Ff,1)},set:function(w){w?this.Ff=Di(this.Ff,1):this.Ff=Oi(this.Ff,1)}}),Object.defineProperty(this,"required",{enumerable:!0,configurable:!0,get:function(){return!!Ti(this.Ff,2)},set:function(w){w?this.Ff=Di(this.Ff,2):this.Ff=Oi(this.Ff,2)}}),Object.defineProperty(this,"noExport",{enumerable:!0,configurable:!0,get:function(){return!!Ti(this.Ff,3)},set:function(w){w?this.Ff=Di(this.Ff,3):this.Ff=Oi(this.Ff,3)}});var x=null;Object.defineProperty(this,"Q",{enumerable:!0,configurable:!1,get:function(){if(x!==null)return x},set:function(w){if([0,1,2].indexOf(w)===-1)throw new Error('Invalid value "'+w+'" for attribute Q supplied.');x=w}}),Object.defineProperty(this,"textAlign",{get:function(){var w;switch(x){case 0:default:w="left";break;case 1:w="center";break;case 2:w="right"}return w},configurable:!0,enumerable:!0,set:function(w){switch(w){case"right":case 2:x=2;break;case"center":case 1:x=1;break;default:x=0}}})};ws(La,ro);var vu=function(){La.call(this),this.FT="/Ch",this.V="()",this.fontName="zapfdingbats";var t=0;Object.defineProperty(this,"TI",{enumerable:!0,configurable:!1,get:function(){return t},set:function(n){t=n}}),Object.defineProperty(this,"topIndex",{enumerable:!0,configurable:!0,get:function(){return t},set:function(n){t=n}});var e=[];Object.defineProperty(this,"Opt",{enumerable:!0,configurable:!1,get:function(){return qx(e,this.objId,this.scope)},set:function(n){var i,r;r=[],typeof(i=n)=="string"&&(r=(function(s,a,o){o||(o=1);for(var l,c=[];l=a.exec(s);)c.push(l[o]);return c})(i,/\((.*?)\)/g)),e=r}}),this.getOptions=function(){return e},this.setOptions=function(n){e=n,this.sort&&e.sort()},this.addOption=function(n){n=(n=n||"").toString(),e.push(n),this.sort&&e.sort()},this.removeOption=function(n,i){for(i=i||!1,n=(n=n||"").toString();e.indexOf(n)!==-1&&(e.splice(e.indexOf(n),1),i!==!1););},Object.defineProperty(this,"combo",{enumerable:!0,configurable:!0,get:function(){return!!Ti(this.Ff,18)},set:function(n){n?this.Ff=Di(this.Ff,18):this.Ff=Oi(this.Ff,18)}}),Object.defineProperty(this,"edit",{enumerable:!0,configurable:!0,get:function(){return!!Ti(this.Ff,19)},set:function(n){this.combo===!0&&(n?this.Ff=Di(this.Ff,19):this.Ff=Oi(this.Ff,19))}}),Object.defineProperty(this,"sort",{enumerable:!0,configurable:!0,get:function(){return!!Ti(this.Ff,20)},set:function(n){n?(this.Ff=Di(this.Ff,20),e.sort()):this.Ff=Oi(this.Ff,20)}}),Object.defineProperty(this,"multiSelect",{enumerable:!0,configurable:!0,get:function(){return!!Ti(this.Ff,22)},set:function(n){n?this.Ff=Di(this.Ff,22):this.Ff=Oi(this.Ff,22)}}),Object.defineProperty(this,"doNotSpellCheck",{enumerable:!0,configurable:!0,get:function(){return!!Ti(this.Ff,23)},set:function(n){n?this.Ff=Di(this.Ff,23):this.Ff=Oi(this.Ff,23)}}),Object.defineProperty(this,"commitOnSelChange",{enumerable:!0,configurable:!0,get:function(){return!!Ti(this.Ff,27)},set:function(n){n?this.Ff=Di(this.Ff,27):this.Ff=Oi(this.Ff,27)}}),this.hasAppearanceStream=!1};ws(vu,La);var yu=function(){vu.call(this),this.fontName="helvetica",this.combo=!1};ws(yu,vu);var bu=function(){yu.call(this),this.combo=!0};ws(bu,yu);var ch=function(){bu.call(this),this.edit=!0};ws(ch,bu);var gr=function(){La.call(this),this.FT="/Btn",Object.defineProperty(this,"noToggleToOff",{enumerable:!0,configurable:!0,get:function(){return!!Ti(this.Ff,15)},set:function(n){n?this.Ff=Di(this.Ff,15):this.Ff=Oi(this.Ff,15)}}),Object.defineProperty(this,"radio",{enumerable:!0,configurable:!0,get:function(){return!!Ti(this.Ff,16)},set:function(n){n?this.Ff=Di(this.Ff,16):this.Ff=Oi(this.Ff,16)}}),Object.defineProperty(this,"pushButton",{enumerable:!0,configurable:!0,get:function(){return!!Ti(this.Ff,17)},set:function(n){n?this.Ff=Di(this.Ff,17):this.Ff=Oi(this.Ff,17)}}),Object.defineProperty(this,"radioIsUnison",{enumerable:!0,configurable:!0,get:function(){return!!Ti(this.Ff,26)},set:function(n){n?this.Ff=Di(this.Ff,26):this.Ff=Oi(this.Ff,26)}});var t,e={};Object.defineProperty(this,"MK",{enumerable:!1,configurable:!1,get:function(){var n=function(s){return s};if(this.scope&&(n=this.scope.internal.getEncryptor(this.objId)),Object.keys(e).length!==0){var i,r=[];for(i in r.push("<<"),e)r.push("/"+i+" ("+Bc(n(e[i]))+")");return r.push(">>"),r.join(`
`)}},set:function(n){jn(n)==="object"&&(e=n)}}),Object.defineProperty(this,"caption",{enumerable:!0,configurable:!0,get:function(){return e.CA||""},set:function(n){typeof n=="string"&&(e.CA=n)}}),Object.defineProperty(this,"AS",{enumerable:!1,configurable:!1,get:function(){return t},set:function(n){t=n}}),Object.defineProperty(this,"appearanceState",{enumerable:!0,configurable:!0,get:function(){return t.substr(1,t.length-1)},set:function(n){t="/"+Wh(n)}})};ws(gr,La);var uh=function(){gr.call(this),this.pushButton=!0};ws(uh,gr);var wu=function(){gr.call(this),this.radio=!0,this.pushButton=!1;var t=[];Object.defineProperty(this,"Kids",{enumerable:!0,configurable:!1,get:function(){return t},set:function(e){t=e!==void 0?e:[]}})};ws(wu,gr);var Vh=function(){var t,e;La.call(this),Object.defineProperty(this,"Parent",{enumerable:!1,configurable:!1,get:function(){return t},set:function(r){t=r}}),Object.defineProperty(this,"optionName",{enumerable:!1,configurable:!0,get:function(){return e},set:function(r){e=r}});var n,i={};Object.defineProperty(this,"MK",{enumerable:!1,configurable:!1,get:function(){var r=function(o){return o};this.scope&&(r=this.scope.internal.getEncryptor(this.objId));var s,a=[];for(s in a.push("<<"),i)a.push("/"+s+" ("+Bc(r(i[s]))+")");return a.push(">>"),a.join(`
`)},set:function(r){jn(r)==="object"&&(i=r)}}),Object.defineProperty(this,"caption",{enumerable:!0,configurable:!0,get:function(){return i.CA||""},set:function(r){typeof r=="string"&&(i.CA=r)}}),Object.defineProperty(this,"AS",{enumerable:!1,configurable:!1,get:function(){return n},set:function(r){n=r}}),Object.defineProperty(this,"appearanceState",{enumerable:!0,configurable:!0,get:function(){return n.substr(1,n.length-1)},set:function(r){n="/"+r}}),this.caption="l",this.appearanceState="Off",this._AppearanceType=Et.RadioButton.Circle,this.appearanceStreamContent=this._AppearanceType.createAppearanceStream(this.optionName)};ws(Vh,La),wu.prototype.setAppearance=function(t){if(!("createAppearanceStream"in t)||!("getCA"in t))throw new Error("Couldn't assign Appearance to RadioButton. Appearance was Invalid!");for(var e in this.Kids)if(this.Kids.hasOwnProperty(e)){var n=this.Kids[e];n.appearanceStreamContent=t.createAppearanceStream(n.optionName),n.caption=t.getCA()}},wu.prototype.createOption=function(t){var e=new Vh;return e.Parent=this,e.optionName=t,this.Kids.push(e),sF.call(this.scope,e),e};var dh=function(){gr.call(this),this.fontName="zapfdingbats",this.caption="3",this.appearanceState="On",this.value="On",this.textAlign="center",this.appearanceStreamContent=Et.CheckBox.createAppearanceStream()};ws(dh,gr);var wc=function(){La.call(this),this.FT="/Tx",Object.defineProperty(this,"multiline",{enumerable:!0,configurable:!0,get:function(){return!!Ti(this.Ff,13)},set:function(e){e?this.Ff=Di(this.Ff,13):this.Ff=Oi(this.Ff,13)}}),Object.defineProperty(this,"fileSelect",{enumerable:!0,configurable:!0,get:function(){return!!Ti(this.Ff,21)},set:function(e){e?this.Ff=Di(this.Ff,21):this.Ff=Oi(this.Ff,21)}}),Object.defineProperty(this,"doNotSpellCheck",{enumerable:!0,configurable:!0,get:function(){return!!Ti(this.Ff,23)},set:function(e){e?this.Ff=Di(this.Ff,23):this.Ff=Oi(this.Ff,23)}}),Object.defineProperty(this,"doNotScroll",{enumerable:!0,configurable:!0,get:function(){return!!Ti(this.Ff,24)},set:function(e){e?this.Ff=Di(this.Ff,24):this.Ff=Oi(this.Ff,24)}}),Object.defineProperty(this,"comb",{enumerable:!0,configurable:!0,get:function(){return!!Ti(this.Ff,25)},set:function(e){e?this.Ff=Di(this.Ff,25):this.Ff=Oi(this.Ff,25)}}),Object.defineProperty(this,"richText",{enumerable:!0,configurable:!0,get:function(){return!!Ti(this.Ff,26)},set:function(e){e?this.Ff=Di(this.Ff,26):this.Ff=Oi(this.Ff,26)}});var t=null;Object.defineProperty(this,"MaxLen",{enumerable:!0,configurable:!1,get:function(){return t},set:function(e){t=e}}),Object.defineProperty(this,"maxLength",{enumerable:!0,configurable:!0,get:function(){return t},set:function(e){Number.isInteger(e)&&(t=e)}}),Object.defineProperty(this,"hasAppearanceStream",{enumerable:!0,configurable:!0,get:function(){return this.V||this.DV}})};ws(wc,La);var fh=function(){wc.call(this),Object.defineProperty(this,"password",{enumerable:!0,configurable:!0,get:function(){return!!Ti(this.Ff,14)},set:function(t){t?this.Ff=Di(this.Ff,14):this.Ff=Oi(this.Ff,14)}}),this.password=!0};ws(fh,wc);var Et={CheckBox:{createAppearanceStream:function(){return{N:{On:Et.CheckBox.YesNormal},D:{On:Et.CheckBox.YesPushDown,Off:Et.CheckBox.OffPushDown}}},YesPushDown:function(t){var e=Qa(t);e.scope=t.scope;var n=[],i=t.scope.internal.getFont(t.fontName,t.fontStyle).id,r=t.scope.__private__.encodeColorString(t.color),s=Km(t,t.caption);return n.push("0.749023 g"),n.push("0 0 "+sn(Et.internal.getWidth(t))+" "+sn(Et.internal.getHeight(t))+" re"),n.push("f"),n.push("BMC"),n.push("q"),n.push("0 0 1 rg"),n.push("/"+i+" "+sn(s.fontSize)+" Tf "+r),n.push("BT"),n.push(s.text),n.push("ET"),n.push("Q"),n.push("EMC"),e.stream=n.join(`
`),e},YesNormal:function(t){var e=Qa(t);e.scope=t.scope;var n=t.scope.internal.getFont(t.fontName,t.fontStyle).id,i=t.scope.__private__.encodeColorString(t.color),r=[],s=Et.internal.getHeight(t),a=Et.internal.getWidth(t),o=Km(t,t.caption);return r.push("1 g"),r.push("0 0 "+sn(a)+" "+sn(s)+" re"),r.push("f"),r.push("q"),r.push("0 0 1 rg"),r.push("0 0 "+sn(a-1)+" "+sn(s-1)+" re"),r.push("W"),r.push("n"),r.push("0 g"),r.push("BT"),r.push("/"+n+" "+sn(o.fontSize)+" Tf "+i),r.push(o.text),r.push("ET"),r.push("Q"),e.stream=r.join(`
`),e},OffPushDown:function(t){var e=Qa(t);e.scope=t.scope;var n=[];return n.push("0.749023 g"),n.push("0 0 "+sn(Et.internal.getWidth(t))+" "+sn(Et.internal.getHeight(t))+" re"),n.push("f"),e.stream=n.join(`
`),e}},RadioButton:{Circle:{createAppearanceStream:function(t){var e={D:{Off:Et.RadioButton.Circle.OffPushDown},N:{}};return e.N[t]=Et.RadioButton.Circle.YesNormal,e.D[t]=Et.RadioButton.Circle.YesPushDown,e},getCA:function(){return"l"},YesNormal:function(t){var e=Qa(t);e.scope=t.scope;var n=[],i=Et.internal.getWidth(t)<=Et.internal.getHeight(t)?Et.internal.getWidth(t)/4:Et.internal.getHeight(t)/4;i=Number((.9*i).toFixed(5));var r=Et.internal.Bezier_C,s=Number((i*r).toFixed(5));return n.push("q"),n.push("1 0 0 1 "+Fl(Et.internal.getWidth(t)/2)+" "+Fl(Et.internal.getHeight(t)/2)+" cm"),n.push(i+" 0 m"),n.push(i+" "+s+" "+s+" "+i+" 0 "+i+" c"),n.push("-"+s+" "+i+" -"+i+" "+s+" -"+i+" 0 c"),n.push("-"+i+" -"+s+" -"+s+" -"+i+" 0 -"+i+" c"),n.push(s+" -"+i+" "+i+" -"+s+" "+i+" 0 c"),n.push("f"),n.push("Q"),e.stream=n.join(`
`),e},YesPushDown:function(t){var e=Qa(t);e.scope=t.scope;var n=[],i=Et.internal.getWidth(t)<=Et.internal.getHeight(t)?Et.internal.getWidth(t)/4:Et.internal.getHeight(t)/4;i=Number((.9*i).toFixed(5));var r=Number((2*i).toFixed(5)),s=Number((r*Et.internal.Bezier_C).toFixed(5)),a=Number((i*Et.internal.Bezier_C).toFixed(5));return n.push("0.749023 g"),n.push("q"),n.push("1 0 0 1 "+Fl(Et.internal.getWidth(t)/2)+" "+Fl(Et.internal.getHeight(t)/2)+" cm"),n.push(r+" 0 m"),n.push(r+" "+s+" "+s+" "+r+" 0 "+r+" c"),n.push("-"+s+" "+r+" -"+r+" "+s+" -"+r+" 0 c"),n.push("-"+r+" -"+s+" -"+s+" -"+r+" 0 -"+r+" c"),n.push(s+" -"+r+" "+r+" -"+s+" "+r+" 0 c"),n.push("f"),n.push("Q"),n.push("0 g"),n.push("q"),n.push("1 0 0 1 "+Fl(Et.internal.getWidth(t)/2)+" "+Fl(Et.internal.getHeight(t)/2)+" cm"),n.push(i+" 0 m"),n.push(i+" "+a+" "+a+" "+i+" 0 "+i+" c"),n.push("-"+a+" "+i+" -"+i+" "+a+" -"+i+" 0 c"),n.push("-"+i+" -"+a+" -"+a+" -"+i+" 0 -"+i+" c"),n.push(a+" -"+i+" "+i+" -"+a+" "+i+" 0 c"),n.push("f"),n.push("Q"),e.stream=n.join(`
`),e},OffPushDown:function(t){var e=Qa(t);e.scope=t.scope;var n=[],i=Et.internal.getWidth(t)<=Et.internal.getHeight(t)?Et.internal.getWidth(t)/4:Et.internal.getHeight(t)/4;i=Number((.9*i).toFixed(5));var r=Number((2*i).toFixed(5)),s=Number((r*Et.internal.Bezier_C).toFixed(5));return n.push("0.749023 g"),n.push("q"),n.push("1 0 0 1 "+Fl(Et.internal.getWidth(t)/2)+" "+Fl(Et.internal.getHeight(t)/2)+" cm"),n.push(r+" 0 m"),n.push(r+" "+s+" "+s+" "+r+" 0 "+r+" c"),n.push("-"+s+" "+r+" -"+r+" "+s+" -"+r+" 0 c"),n.push("-"+r+" -"+s+" -"+s+" -"+r+" 0 -"+r+" c"),n.push(s+" -"+r+" "+r+" -"+s+" "+r+" 0 c"),n.push("f"),n.push("Q"),e.stream=n.join(`
`),e}},Cross:{createAppearanceStream:function(t){var e={D:{Off:Et.RadioButton.Cross.OffPushDown},N:{}};return e.N[t]=Et.RadioButton.Cross.YesNormal,e.D[t]=Et.RadioButton.Cross.YesPushDown,e},getCA:function(){return"8"},YesNormal:function(t){var e=Qa(t);e.scope=t.scope;var n=[],i=Et.internal.calculateCross(t);return n.push("q"),n.push("1 1 "+sn(Et.internal.getWidth(t)-2)+" "+sn(Et.internal.getHeight(t)-2)+" re"),n.push("W"),n.push("n"),n.push(sn(i.x1.x)+" "+sn(i.x1.y)+" m"),n.push(sn(i.x2.x)+" "+sn(i.x2.y)+" l"),n.push(sn(i.x4.x)+" "+sn(i.x4.y)+" m"),n.push(sn(i.x3.x)+" "+sn(i.x3.y)+" l"),n.push("s"),n.push("Q"),e.stream=n.join(`
`),e},YesPushDown:function(t){var e=Qa(t);e.scope=t.scope;var n=Et.internal.calculateCross(t),i=[];return i.push("0.749023 g"),i.push("0 0 "+sn(Et.internal.getWidth(t))+" "+sn(Et.internal.getHeight(t))+" re"),i.push("f"),i.push("q"),i.push("1 1 "+sn(Et.internal.getWidth(t)-2)+" "+sn(Et.internal.getHeight(t)-2)+" re"),i.push("W"),i.push("n"),i.push(sn(n.x1.x)+" "+sn(n.x1.y)+" m"),i.push(sn(n.x2.x)+" "+sn(n.x2.y)+" l"),i.push(sn(n.x4.x)+" "+sn(n.x4.y)+" m"),i.push(sn(n.x3.x)+" "+sn(n.x3.y)+" l"),i.push("s"),i.push("Q"),e.stream=i.join(`
`),e},OffPushDown:function(t){var e=Qa(t);e.scope=t.scope;var n=[];return n.push("0.749023 g"),n.push("0 0 "+sn(Et.internal.getWidth(t))+" "+sn(Et.internal.getHeight(t))+" re"),n.push("f"),e.stream=n.join(`
`),e}}},createDefaultAppearanceStream:function(t){var e=t.scope.internal.getFont(t.fontName,t.fontStyle).id,n=t.scope.__private__.encodeColorString(t.color);return"/"+e+" "+t.fontSize+" Tf "+n}};Et.internal={Bezier_C:.551915024494,calculateCross:function(t){var e=Et.internal.getWidth(t),n=Et.internal.getHeight(t),i=Math.min(e,n);return{x1:{x:(e-i)/2,y:(n-i)/2+i},x2:{x:(e-i)/2+i,y:(n-i)/2},x3:{x:(e-i)/2,y:(n-i)/2},x4:{x:(e-i)/2+i,y:(n-i)/2+i}}}},Et.internal.getWidth=function(t){var e=0;return jn(t)==="object"&&(e=dy(t.Rect[2])),e},Et.internal.getHeight=function(t){var e=0;return jn(t)==="object"&&(e=dy(t.Rect[3])),e};var sF=Si.addField=function(t){if(rF(this,t),!(t instanceof La))throw new Error("Invalid argument passed to jsPDF.addField.");var e;return(e=t).scope.internal.acroformPlugin.printedOut&&(e.scope.internal.acroformPlugin.printedOut=!1,e.scope.internal.acroformPlugin.acroFormDictionaryRoot=null),e.scope.internal.acroformPlugin.acroFormDictionaryRoot.Fields.push(e),t.page=t.scope.internal.getCurrentPageInfo().pageNumber,this};Si.AcroFormChoiceField=vu,Si.AcroFormListBox=yu,Si.AcroFormComboBox=bu,Si.AcroFormEditBox=ch,Si.AcroFormButton=gr,Si.AcroFormPushButton=uh,Si.AcroFormRadioButton=wu,Si.AcroFormCheckBox=dh,Si.AcroFormTextField=wc,Si.AcroFormPasswordField=fh,Si.AcroFormAppearance=Et,Si.AcroForm={ChoiceField:vu,ListBox:yu,ComboBox:bu,EditBox:ch,Button:gr,PushButton:uh,RadioButton:wu,CheckBox:dh,TextField:wc,PasswordField:fh,Appearance:Et},qt.AcroForm={ChoiceField:vu,ListBox:yu,ComboBox:bu,EditBox:ch,Button:gr,PushButton:uh,RadioButton:wu,CheckBox:dh,TextField:wc,PasswordField:fh,Appearance:Et};qt.AcroForm;function Ux(t){return t.reduce(function(e,n,i){return e[n]=i,e},{})}(function(t){var e="addImage_";t.__addimage__={};var n="UNKNOWN",i={PNG:[[137,80,78,71]],TIFF:[[77,77,0,42],[73,73,42,0]],JPEG:[[255,216,255,224,void 0,void 0,74,70,73,70,0],[255,216,255,225,void 0,void 0,69,120,105,102,0,0],[255,216,255,219],[255,216,255,238]],JPEG2000:[[0,0,0,12,106,80,32,32]],GIF87a:[[71,73,70,56,55,97]],GIF89a:[[71,73,70,56,57,97]],WEBP:[[82,73,70,70,void 0,void 0,void 0,void 0,87,69,66,80]],BMP:[[66,77],[66,65],[67,73],[67,80],[73,67],[80,84]]},r=t.__addimage__.getImageFileTypeByImageData=function(C,N){var B,E,R,q,Z,U=n;if((N=N||n)==="RGBA"||C.data!==void 0&&C.data instanceof Uint8ClampedArray&&"height"in C&&"width"in C)return"RGBA";if(I(C))for(Z in i)for(R=i[Z],B=0;B<R.length;B+=1){for(q=!0,E=0;E<R[B].length;E+=1)if(R[B][E]!==void 0&&R[B][E]!==C[E]){q=!1;break}if(q===!0){U=Z;break}}else for(Z in i)for(R=i[Z],B=0;B<R.length;B+=1){for(q=!0,E=0;E<R[B].length;E+=1)if(R[B][E]!==void 0&&R[B][E]!==C.charCodeAt(E)){q=!1;break}if(q===!0){U=Z;break}}return U===n&&N!==n&&(U=N),U},s=function C(N){for(var B=this.internal.write,E=this.internal.putStream,R=(0,this.internal.getFilters)();R.indexOf("FlateEncode")!==-1;)R.splice(R.indexOf("FlateEncode"),1);N.objectId=this.internal.newObject();var q=[];if(q.push({key:"Type",value:"/XObject"}),q.push({key:"Subtype",value:"/Image"}),q.push({key:"Width",value:N.width}),q.push({key:"Height",value:N.height}),N.colorSpace===w.INDEXED?q.push({key:"ColorSpace",value:"[/Indexed /DeviceRGB "+(N.palette.length/3-1)+" "+("sMask"in N&&N.sMask!==void 0?N.objectId+2:N.objectId+1)+" 0 R]"}):(q.push({key:"ColorSpace",value:"/"+N.colorSpace}),N.colorSpace===w.DEVICE_CMYK&&q.push({key:"Decode",value:"[1 0 1 0 1 0 1 0]"})),q.push({key:"BitsPerComponent",value:N.bitsPerComponent}),"decodeParameters"in N&&N.decodeParameters!==void 0&&q.push({key:"DecodeParms",value:"<<"+N.decodeParameters+">>"}),"transparency"in N&&Array.isArray(N.transparency)&&N.transparency.length>0){for(var Z="",U=0,X=N.transparency.length;U<X;U++)Z+=N.transparency[U]+" "+N.transparency[U]+" ";q.push({key:"Mask",value:"["+Z+"]"})}N.sMask!==void 0&&q.push({key:"SMask",value:N.objectId+1+" 0 R"});var de=N.filter!==void 0?["/"+N.filter]:void 0;if(E({data:N.data,additionalKeyValues:q,alreadyAppliedFilters:de,objectId:N.objectId}),B("endobj"),"sMask"in N&&N.sMask!==void 0){var le,F=(le=N.sMaskBitsPerComponent)!==null&&le!==void 0?le:N.bitsPerComponent,V={width:N.width,height:N.height,colorSpace:"DeviceGray",bitsPerComponent:F,data:N.sMask};"filter"in N&&(V.decodeParameters="/Predictor ".concat(N.predictor," /Colors 1 /BitsPerComponent ").concat(F," /Columns ").concat(N.width),V.filter=N.filter),C.call(this,V)}if(N.colorSpace===w.INDEXED){var G=this.internal.newObject();E({data:D(new Uint8Array(N.palette)),objectId:G}),B("endobj")}},a=function(){var C=this.internal.collections[e+"images"];for(var N in C)s.call(this,C[N])},o=function(){var C,N=this.internal.collections[e+"images"],B=this.internal.write;for(var E in N)B("/I"+(C=N[E]).index,C.objectId,"0","R")},l=function(){this.internal.collections[e+"images"]||(this.internal.collections[e+"images"]={},this.internal.events.subscribe("putResources",a),this.internal.events.subscribe("putXobjectDict",o))},c=function(){var C=this.internal.collections[e+"images"];return l.call(this),C},u=function(){return Object.keys(this.internal.collections[e+"images"]).length},f=function(C){return typeof t["process"+C.toUpperCase()]=="function"},h=function(C){return jn(C)==="object"&&C.nodeType===1},d=function(C,N){if(C.nodeName==="IMG"&&C.hasAttribute("src")){var B=""+C.getAttribute("src");if(B.indexOf("data:image/")===0)return lh(unescape(B).split("base64,").pop());var E=t.loadFile(B,!0);if(E!==void 0)return E}if(C.nodeName==="CANVAS"){if(C.width===0||C.height===0)throw new Error("Given canvas must have data. Canvas width: "+C.width+", height: "+C.height);var R;switch(N){case"PNG":R="image/png";break;case"WEBP":R="image/webp";break;default:R="image/jpeg"}return lh(C.toDataURL(R,1).split("base64,").pop())}},y=function(C){var N=this.internal.collections[e+"images"];if(N){for(var B in N)if(C===N[B].alias)return N[B]}},m=function(C,N,B){return C||N||(C=-96,N=-96),C<0&&(C=-1*B.width*72/C/this.internal.scaleFactor),N<0&&(N=-1*B.height*72/N/this.internal.scaleFactor),C===0&&(C=N*B.width/B.height),N===0&&(N=C*B.height/B.width),[C,N]},x=function(C,N,B,E,R,q){var Z=m.call(this,B,E,R),U=this.internal.getCoordinateString,X=this.internal.getVerticalCoordinateString,de=c.call(this);if(B=Z[0],E=Z[1],de[R.index]=R,q){q*=Math.PI/180;var le=Math.cos(q),F=Math.sin(q),V=function(se){return se.toFixed(4)},G=[V(le),V(F),V(-1*F),V(le),0,0,"cm"]}this.internal.write("q"),q?(this.internal.write([1,"0","0",1,U(C),X(N+E),"cm"].join(" ")),this.internal.write(G.join(" ")),this.internal.write([U(B),"0","0",U(E),"0","0","cm"].join(" "))):this.internal.write([U(B),"0","0",U(E),U(C),X(N+E),"cm"].join(" ")),this.isAdvancedAPI()&&this.internal.write([1,0,0,-1,0,0,"cm"].join(" ")),this.internal.write("/I"+R.index+" Do"),this.internal.write("Q")},w=t.color_spaces={DEVICE_RGB:"DeviceRGB",DEVICE_GRAY:"DeviceGray",DEVICE_CMYK:"DeviceCMYK",CAL_GREY:"CalGray",CAL_RGB:"CalRGB",LAB:"Lab",ICC_BASED:"ICCBased",INDEXED:"Indexed",PATTERN:"Pattern",SEPARATION:"Separation",DEVICE_N:"DeviceN"};t.decode={DCT_DECODE:"DCTDecode",FLATE_DECODE:"FlateDecode",LZW_DECODE:"LZWDecode",JPX_DECODE:"JPXDecode",JBIG2_DECODE:"JBIG2Decode",ASCII85_DECODE:"ASCII85Decode",ASCII_HEX_DECODE:"ASCIIHexDecode",RUN_LENGTH_DECODE:"RunLengthDecode",CCITT_FAX_DECODE:"CCITTFaxDecode"};var S=t.image_compression={NONE:"NONE",FAST:"FAST",MEDIUM:"MEDIUM",SLOW:"SLOW"},A=t.__addimage__.sHashCode=function(C){var N,B,E=0;if(typeof C=="string")for(B=C.length,N=0;N<B;N++)E=(E<<5)-E+C.charCodeAt(N),E|=0;else if(I(C))for(B=C.byteLength/2,N=0;N<B;N++)E=(E<<5)-E+C[N],E|=0;return E},_=t.__addimage__.validateStringAsBase64=function(C){(C=C||"").toString().trim();var N=!0;return C.length===0&&(N=!1),C.length%4!=0&&(N=!1),/^[A-Za-z0-9+/]+$/.test(C.substr(0,C.length-2))===!1&&(N=!1),/^[A-Za-z0-9/][A-Za-z0-9+/]|[A-Za-z0-9+/]=|==$/.test(C.substr(-2))===!1&&(N=!1),N},M=t.__addimage__.extractImageFromDataUrl=function(C){if(C==null||!(C=C.trim()).startsWith("data:"))return null;var N=C.indexOf(",");return N<0?null:C.substring(0,N).trim().endsWith("base64")?C.substring(N+1):null};t.__addimage__.isArrayBuffer=function(C){return C instanceof ArrayBuffer};var I=t.__addimage__.isArrayBufferView=function(C){return C instanceof Int8Array||C instanceof Uint8Array||C instanceof Uint8ClampedArray||C instanceof Int16Array||C instanceof Uint16Array||C instanceof Int32Array||C instanceof Uint32Array||C instanceof Float32Array||C instanceof Float64Array},T=t.__addimage__.binaryStringToUint8Array=function(C){for(var N=C.length,B=new Uint8Array(N),E=0;E<N;E++)B[E]=C.charCodeAt(E);return B},D=t.__addimage__.arrayBufferToBinaryString=function(C){for(var N="",B=I(C)?C:new Uint8Array(C),E=0;E<B.length;E+=8192)N+=String.fromCharCode.apply(null,B.subarray(E,E+8192));return N};t.addImage=function(){var C,N,B,E,R,q,Z,U,X;if(typeof arguments[1]=="number"?(N=n,B=arguments[1],E=arguments[2],R=arguments[3],q=arguments[4],Z=arguments[5],U=arguments[6],X=arguments[7]):(N=arguments[1],B=arguments[2],E=arguments[3],R=arguments[4],q=arguments[5],Z=arguments[6],U=arguments[7],X=arguments[8]),jn(C=arguments[0])==="object"&&!h(C)&&"imageData"in C){var de=C;C=de.imageData,N=de.format||N||n,B=de.x||B||0,E=de.y||E||0,R=de.w||de.width||R,q=de.h||de.height||q,Z=de.alias||Z,U=de.compression||U,X=de.rotation||de.angle||X}var le=this.internal.getFilters();if(U===void 0&&le.indexOf("FlateEncode")!==-1&&(U="SLOW"),isNaN(B)||isNaN(E))throw new Error("Invalid coordinates passed to jsPDF.addImage");l.call(this);var F=O.call(this,C,N,Z,U);return x.call(this,B,E,R,q,F,X),this};var O=function(C,N,B,E){var R,q,Z;if(typeof C=="string"&&r(C)===n){C=unescape(C);var U=W(C,!1);(U!==""||(U=t.loadFile(C,!0))!==void 0)&&(C=U)}if(h(C)&&(C=d(C,N)),N=r(C,N),!f(N))throw new Error("addImage does not support files of type '"+N+"', please ensure that a plugin for '"+N+"' support is added.");if(((Z=B)==null||Z.length===0)&&(B=(function(X){return typeof X=="string"||I(X)?A(X):I(X.data)?A(X.data):null})(C)),(R=y.call(this,B))||(C instanceof Uint8Array||N==="RGBA"||(q=C,C=T(C)),R=this["process"+N.toUpperCase()](C,u.call(this),B,(function(X){return X&&typeof X=="string"&&(X=X.toUpperCase()),X in t.image_compression?X:S.NONE})(E),q)),!R)throw new Error("An unknown error occurred whilst processing the image.");return R},W=t.__addimage__.convertBase64ToBinaryString=function(C,N){N=typeof N!="boolean"||N;var B,E="";if(typeof C=="string"){var R;B=(R=M(C))!==null&&R!==void 0?R:C;try{E=lh(B)}catch(q){if(N)throw _(B)?new Error("atob-Error in jsPDF.convertBase64ToBinaryString "+q.message):new Error("Supplied Data is not a valid base64-String jsPDF.convertBase64ToBinaryString ")}}return E};t.getImageProperties=function(C){var N,B,E="";if(h(C)&&(C=d(C)),typeof C=="string"&&r(C)===n&&((E=W(C,!1))===""&&(E=t.loadFile(C)||""),C=E),B=r(C),!f(B))throw new Error("addImage does not support files of type '"+B+"', please ensure that a plugin for '"+B+"' support is added.");if(C instanceof Uint8Array||(C=T(C)),!(N=this["process"+B.toUpperCase()](C)))throw new Error("An unknown error occurred whilst processing the image");return N.fileType=B,N}})(qt.API),(function(t){var e=function(n){if(n!==void 0&&n!="")return!0};qt.API.events.push(["addPage",function(n){this.internal.getPageInfo(n.pageNumber).pageContext.annotations=[]}]),t.events.push(["putPage",function(n){for(var i,r,s,a=this.internal.getCoordinateString,o=this.internal.getVerticalCoordinateString,l=this.internal.getPageInfoByObjId(n.objId),c=n.pageContext.annotations,u=!1,f=0;f<c.length&&!u;f++)switch((i=c[f]).type){case"link":(e(i.options.url)||e(i.options.pageNumber))&&(u=!0);break;case"reference":case"text":case"freetext":u=!0}if(u!=0){this.internal.write("/Annots [");for(var h=0;h<c.length;h++){i=c[h];var d=this.internal.pdfEscape,y=this.internal.getEncryptor(n.objId);switch(i.type){case"reference":this.internal.write(" "+i.object.objId+" 0 R ");break;case"text":var m=this.internal.newAdditionalObject(),x=this.internal.newAdditionalObject(),w=this.internal.getEncryptor(m.objId),S=i.title||"Note";s="<</Type /Annot /Subtype /Text "+(r="/Rect ["+a(i.bounds.x)+" "+o(i.bounds.y+i.bounds.h)+" "+a(i.bounds.x+i.bounds.w)+" "+o(i.bounds.y)+"] ")+"/Contents ("+d(w(i.contents))+")",s+=" /Popup "+x.objId+" 0 R",s+=" /P "+l.objId+" 0 R",s+=" /T ("+d(w(S))+") >>",m.content=s;var A=m.objId+" 0 R";s="<</Type /Annot /Subtype /Popup "+(r="/Rect ["+a(i.bounds.x+30)+" "+o(i.bounds.y+i.bounds.h)+" "+a(i.bounds.x+i.bounds.w+30)+" "+o(i.bounds.y)+"] ")+" /Parent "+A,i.open&&(s+=" /Open true"),s+=" >>",x.content=s,this.internal.write(m.objId,"0 R",x.objId,"0 R");break;case"freetext":r="/Rect ["+a(i.bounds.x)+" "+o(i.bounds.y)+" "+a(i.bounds.x+i.bounds.w)+" "+o(i.bounds.y+i.bounds.h)+"] ";var _=i.color||"#000000";s="<</Type /Annot /Subtype /FreeText "+r+"/Contents ("+d(y(i.contents))+")",s+=" /DS(font: Helvetica,sans-serif 12.0pt; text-align:left; color:#"+_+")",s+=" /Border [0 0 0]",s+=" >>",this.internal.write(s);break;case"link":if(i.options.name){var M=this.annotations._nameMap[i.options.name];i.options.pageNumber=M.page,i.options.top=M.y}else i.options.top||(i.options.top=0);if(r="/Rect ["+i.finalBounds.x+" "+i.finalBounds.y+" "+i.finalBounds.w+" "+i.finalBounds.h+"] ",s="",i.options.url)s="<</Type /Annot /Subtype /Link "+r+"/Border [0 0 0] /A <</S /URI /URI ("+d(y(i.options.url))+") >>";else if(i.options.pageNumber)switch(s="<</Type /Annot /Subtype /Link "+r+"/Border [0 0 0] /Dest ["+this.internal.getPageInfo(i.options.pageNumber).objId+" 0 R",i.options.magFactor=i.options.magFactor||"XYZ",i.options.magFactor){case"Fit":s+=" /Fit]";break;case"FitH":s+=" /FitH "+i.options.top+"]";break;case"FitV":i.options.left=i.options.left||0,s+=" /FitV "+i.options.left+"]";break;default:var I=o(i.options.top);i.options.left=i.options.left||0,i.options.zoom===void 0&&(i.options.zoom=0),s+=" /XYZ "+i.options.left+" "+I+" "+i.options.zoom+"]"}s!=""&&(s+=" >>",this.internal.write(s))}}this.internal.write("]")}}]),t.createAnnotation=function(n){var i=this.internal.getCurrentPageInfo();switch(n.type){case"link":this.link(n.bounds.x,n.bounds.y,n.bounds.w,n.bounds.h,n);break;case"text":case"freetext":i.pageContext.annotations.push(n)}},t.link=function(n,i,r,s,a){var o=this.internal.getCurrentPageInfo(),l=this.internal.getCoordinateString,c=this.internal.getVerticalCoordinateString;o.pageContext.annotations.push({finalBounds:{x:l(n),y:c(i),w:l(n+r),h:c(i+s)},options:a,type:"link"})},t.textWithLink=function(n,i,r,s){var a,o,l=this.getTextWidth(n),c=this.internal.getLineHeight()/this.internal.scaleFactor;if(s.maxWidth!==void 0){o=s.maxWidth;var u=this.splitTextToSize(n,o).length;a=Math.ceil(c*u)}else o=l,a=c;return this.text(n,i,r,s),r+=.2*c,s.align==="center"&&(i-=l/2),s.align==="right"&&(i-=l),this.link(i,r-c,o,a,s),l},t.getTextWidth=function(n){var i=this.internal.getFontSize();return this.getStringUnitWidth(n)*i/this.internal.scaleFactor}})(qt.API),(function(t){var e={1569:[65152],1570:[65153,65154],1571:[65155,65156],1572:[65157,65158],1573:[65159,65160],1574:[65161,65162,65163,65164],1575:[65165,65166],1576:[65167,65168,65169,65170],1577:[65171,65172],1578:[65173,65174,65175,65176],1579:[65177,65178,65179,65180],1580:[65181,65182,65183,65184],1581:[65185,65186,65187,65188],1582:[65189,65190,65191,65192],1583:[65193,65194],1584:[65195,65196],1585:[65197,65198],1586:[65199,65200],1587:[65201,65202,65203,65204],1588:[65205,65206,65207,65208],1589:[65209,65210,65211,65212],1590:[65213,65214,65215,65216],1591:[65217,65218,65219,65220],1592:[65221,65222,65223,65224],1593:[65225,65226,65227,65228],1594:[65229,65230,65231,65232],1601:[65233,65234,65235,65236],1602:[65237,65238,65239,65240],1603:[65241,65242,65243,65244],1604:[65245,65246,65247,65248],1605:[65249,65250,65251,65252],1606:[65253,65254,65255,65256],1607:[65257,65258,65259,65260],1608:[65261,65262],1609:[65263,65264,64488,64489],1610:[65265,65266,65267,65268],1649:[64336,64337],1655:[64477],1657:[64358,64359,64360,64361],1658:[64350,64351,64352,64353],1659:[64338,64339,64340,64341],1662:[64342,64343,64344,64345],1663:[64354,64355,64356,64357],1664:[64346,64347,64348,64349],1667:[64374,64375,64376,64377],1668:[64370,64371,64372,64373],1670:[64378,64379,64380,64381],1671:[64382,64383,64384,64385],1672:[64392,64393],1676:[64388,64389],1677:[64386,64387],1678:[64390,64391],1681:[64396,64397],1688:[64394,64395],1700:[64362,64363,64364,64365],1702:[64366,64367,64368,64369],1705:[64398,64399,64400,64401],1709:[64467,64468,64469,64470],1711:[64402,64403,64404,64405],1713:[64410,64411,64412,64413],1715:[64406,64407,64408,64409],1722:[64414,64415],1723:[64416,64417,64418,64419],1726:[64426,64427,64428,64429],1728:[64420,64421],1729:[64422,64423,64424,64425],1733:[64480,64481],1734:[64473,64474],1735:[64471,64472],1736:[64475,64476],1737:[64482,64483],1739:[64478,64479],1740:[64508,64509,64510,64511],1744:[64484,64485,64486,64487],1746:[64430,64431],1747:[64432,64433]},n={65247:{65154:65269,65156:65271,65160:65273,65166:65275},65248:{65154:65270,65156:65272,65160:65274,65166:65276},65165:{65247:{65248:{65258:65010}}},1617:{1612:64606,1613:64607,1614:64608,1615:64609,1616:64610}},i={1612:64606,1613:64607,1614:64608,1615:64609,1616:64610},r=[1570,1571,1573,1575];t.__arabicParser__={};var s=t.__arabicParser__.isInArabicSubstitutionA=function(m){return e[m.charCodeAt(0)]!==void 0},a=t.__arabicParser__.isArabicLetter=function(m){return typeof m=="string"&&/^[\u0600-\u06FF\u0750-\u077F\u08A0-\u08FF\uFB50-\uFDFF\uFE70-\uFEFF]+$/.test(m)},o=t.__arabicParser__.isArabicEndLetter=function(m){return a(m)&&s(m)&&e[m.charCodeAt(0)].length<=2},l=t.__arabicParser__.isArabicAlfLetter=function(m){return a(m)&&r.indexOf(m.charCodeAt(0))>=0};t.__arabicParser__.arabicLetterHasIsolatedForm=function(m){return a(m)&&s(m)&&e[m.charCodeAt(0)].length>=1};var c=t.__arabicParser__.arabicLetterHasFinalForm=function(m){return a(m)&&s(m)&&e[m.charCodeAt(0)].length>=2};t.__arabicParser__.arabicLetterHasInitialForm=function(m){return a(m)&&s(m)&&e[m.charCodeAt(0)].length>=3};var u=t.__arabicParser__.arabicLetterHasMedialForm=function(m){return a(m)&&s(m)&&e[m.charCodeAt(0)].length==4},f=t.__arabicParser__.resolveLigatures=function(m){var x=0,w=n,S="",A=0;for(x=0;x<m.length;x+=1)w[m.charCodeAt(x)]!==void 0?(A++,typeof(w=w[m.charCodeAt(x)])=="number"&&(S+=String.fromCharCode(w),w=n,A=0),x===m.length-1&&(w=n,S+=m.charAt(x-(A-1)),x-=A-1,A=0)):(w=n,S+=m.charAt(x-A),x-=A,A=0);return S};t.__arabicParser__.isArabicDiacritic=function(m){return m!==void 0&&i[m.charCodeAt(0)]!==void 0};var h=t.__arabicParser__.getCorrectForm=function(m,x,w){return a(m)?s(m)===!1?-1:!c(m)||!a(x)&&!a(w)||!a(w)&&o(x)||o(m)&&!a(x)||o(m)&&l(x)||o(m)&&o(x)?0:u(m)&&a(x)&&!o(x)&&a(w)&&c(w)?3:o(m)||!a(w)?1:2:-1},d=function(m){var x=0,w=0,S=0,A="",_="",M="",I=(m=m||"").split("\\s+"),T=[];for(x=0;x<I.length;x+=1){for(T.push(""),w=0;w<I[x].length;w+=1)A=I[x][w],_=I[x][w-1],M=I[x][w+1],a(A)?(S=h(A,_,M),T[x]+=S!==-1?String.fromCharCode(e[A.charCodeAt(0)][S]):A):T[x]+=A;T[x]=f(T[x])}return T.join(" ")},y=t.__arabicParser__.processArabic=t.processArabic=function(){var m,x=typeof arguments[0]=="string"?arguments[0]:arguments[0].text,w=[];if(Array.isArray(x)){var S=0;for(w=[],S=0;S<x.length;S+=1)Array.isArray(x[S])?w.push([d(x[S][0]),x[S][1],x[S][2]]):w.push([d(x[S])]);m=w}else m=d(x);return typeof arguments[0]=="string"?m:(arguments[0].text=m,arguments[0])};t.events.push(["preProcessText",y])})(qt.API),qt.API.autoPrint=function(t){var e;return(t=t||{}).variant=t.variant||"non-conform",t.variant==="javascript"?this.addJS("print({});"):(this.internal.events.subscribe("postPutResources",function(){e=this.internal.newObject(),this.internal.out("<<"),this.internal.out("/S /Named"),this.internal.out("/Type /Action"),this.internal.out("/N /Print"),this.internal.out(">>"),this.internal.out("endobj")}),this.internal.events.subscribe("putCatalog",function(){this.internal.out("/OpenAction "+e+" 0 R")})),this},(function(t){var e=function(){var n=void 0;Object.defineProperty(this,"pdf",{get:function(){return n},set:function(o){n=o}});var i=150;Object.defineProperty(this,"width",{get:function(){return i},set:function(o){i=isNaN(o)||Number.isInteger(o)===!1||o<0?150:o,this.getContext("2d").pageWrapXEnabled&&(this.getContext("2d").pageWrapX=i+1)}});var r=300;Object.defineProperty(this,"height",{get:function(){return r},set:function(o){r=isNaN(o)||Number.isInteger(o)===!1||o<0?300:o,this.getContext("2d").pageWrapYEnabled&&(this.getContext("2d").pageWrapY=r+1)}});var s=[];Object.defineProperty(this,"childNodes",{get:function(){return s},set:function(o){s=o}});var a={};Object.defineProperty(this,"style",{get:function(){return a},set:function(o){a=o}}),Object.defineProperty(this,"parentNode",{})};e.prototype.getContext=function(n,i){var r;if((n=n||"2d")!=="2d")return null;for(r in i)this.pdf.context2d.hasOwnProperty(r)&&(this.pdf.context2d[r]=i[r]);return this.pdf.context2d._canvas=this,this.pdf.context2d},e.prototype.toDataURL=function(){throw new Error("toDataURL is not implemented.")},t.events.push(["initialized",function(){this.canvas=new e,this.canvas.pdf=this}])})(qt.API),(function(t){var e={left:0,top:0,bottom:0,right:0},n=!1,i=function(){this.internal.__cell__===void 0&&(this.internal.__cell__={},this.internal.__cell__.padding=3,this.internal.__cell__.headerFunction=void 0,this.internal.__cell__.margins=Object.assign({},e),this.internal.__cell__.margins.width=this.getPageWidth(),r.call(this))},r=function(){this.internal.__cell__.lastCell=new s,this.internal.__cell__.pages=1},s=function(){var l=arguments[0];Object.defineProperty(this,"x",{enumerable:!0,get:function(){return l},set:function(m){l=m}});var c=arguments[1];Object.defineProperty(this,"y",{enumerable:!0,get:function(){return c},set:function(m){c=m}});var u=arguments[2];Object.defineProperty(this,"width",{enumerable:!0,get:function(){return u},set:function(m){u=m}});var f=arguments[3];Object.defineProperty(this,"height",{enumerable:!0,get:function(){return f},set:function(m){f=m}});var h=arguments[4];Object.defineProperty(this,"text",{enumerable:!0,get:function(){return h},set:function(m){h=m}});var d=arguments[5];Object.defineProperty(this,"lineNumber",{enumerable:!0,get:function(){return d},set:function(m){d=m}});var y=arguments[6];return Object.defineProperty(this,"align",{enumerable:!0,get:function(){return y},set:function(m){y=m}}),this};s.prototype.clone=function(){return new s(this.x,this.y,this.width,this.height,this.text,this.lineNumber,this.align)},s.prototype.toArray=function(){return[this.x,this.y,this.width,this.height,this.text,this.lineNumber,this.align]},t.setHeaderFunction=function(l){return i.call(this),this.internal.__cell__.headerFunction=typeof l=="function"?l:void 0,this},t.getTextDimensions=function(l,c){i.call(this);var u=(c=c||{}).fontSize||this.getFontSize(),f=c.font||this.getFont(),h=c.scaleFactor||this.internal.scaleFactor,d=0,y=0,m=0,x=this;if(!Array.isArray(l)&&typeof l!="string"){if(typeof l!="number")throw new Error("getTextDimensions expects text-parameter to be of type String or type Number or an Array of Strings.");l=String(l)}var w=c.maxWidth;w>0?typeof l=="string"?l=this.splitTextToSize(l,w):Object.prototype.toString.call(l)==="[object Array]"&&(l=l.reduce(function(A,_){return A.concat(x.splitTextToSize(_,w))},[])):l=Array.isArray(l)?l:[l];for(var S=0;S<l.length;S++)d<(m=this.getStringUnitWidth(l[S],{font:f})*u)&&(d=m);return d!==0&&(y=l.length),{w:d/=h,h:Math.max((y*u*this.getLineHeightFactor()-u*(this.getLineHeightFactor()-1))/h,0)}},t.cellAddPage=function(){i.call(this),this.addPage();var l=this.internal.__cell__.margins||e;return this.internal.__cell__.lastCell=new s(l.left,l.top,void 0,void 0),this.internal.__cell__.pages+=1,this};var a=t.cell=function(){var l;l=arguments[0]instanceof s?arguments[0]:new s(arguments[0],arguments[1],arguments[2],arguments[3],arguments[4],arguments[5],arguments[6]),i.call(this);var c=this.internal.__cell__.lastCell,u=this.internal.__cell__.padding,f=this.internal.__cell__.margins||e,h=this.internal.__cell__.tableHeaderRow,d=this.internal.__cell__.printHeaders;return c.lineNumber!==void 0&&(c.lineNumber===l.lineNumber?(l.x=(c.x||0)+(c.width||0),l.y=c.y||0):c.y+c.height+l.height+f.bottom>this.getPageHeight()?(this.cellAddPage(),l.y=f.top,d&&h&&(this.printHeaderRow(l.lineNumber,!0),l.y+=h[0].height)):l.y=c.y+c.height||l.y),l.text[0]!==void 0&&(this.rect(l.x,l.y,l.width,l.height,n===!0?"FD":void 0),l.align==="right"?this.text(l.text,l.x+l.width-u,l.y+u,{align:"right",baseline:"top"}):l.align==="center"?this.text(l.text,l.x+l.width/2,l.y+u,{align:"center",baseline:"top",maxWidth:l.width-u-u}):this.text(l.text,l.x+u,l.y+u,{align:"left",baseline:"top",maxWidth:l.width-u-u})),this.internal.__cell__.lastCell=l,this};t.table=function(l,c,u,f,h){if(i.call(this),!u)throw new Error("No data for PDF table.");var d,y,m,x,w=[],S=[],A=[],_={},M={},I=[],T=[],D=(h=h||{}).autoSize||!1,O=h.printHeaders!==!1,W=h.css&&h.css["font-size"]!==void 0?16*h.css["font-size"]:h.fontSize||12,C=h.margins||Object.assign({width:this.getPageWidth()},e),N=typeof h.padding=="number"?h.padding:3,B=h.headerBackgroundColor||"#c8c8c8",E=h.headerTextColor||"#000";if(r.call(this),this.internal.__cell__.printHeaders=O,this.internal.__cell__.margins=C,this.internal.__cell__.table_font_size=W,this.internal.__cell__.padding=N,this.internal.__cell__.headerBackgroundColor=B,this.internal.__cell__.headerTextColor=E,this.setFontSize(W),f==null)S=w=Object.keys(u[0]),A=w.map(function(){return"left"});else if(Array.isArray(f)&&jn(f[0])==="object")for(w=f.map(function(de){return de.name}),S=f.map(function(de){return de.prompt||de.name||""}),A=f.map(function(de){return de.align||"left"}),d=0;d<f.length;d+=1)M[f[d].name]=.7499990551181103*f[d].width;else Array.isArray(f)&&typeof f[0]=="string"&&(S=w=f,A=w.map(function(){return"left"}));if(D||Array.isArray(f)&&typeof f[0]=="string")for(d=0;d<w.length;d+=1){for(_[x=w[d]]=u.map(function(de){return de[x]}),this.setFont(void 0,"bold"),I.push(this.getTextDimensions(S[d],{fontSize:this.internal.__cell__.table_font_size,scaleFactor:this.internal.scaleFactor}).w),y=_[x],this.setFont(void 0,"normal"),m=0;m<y.length;m+=1)I.push(this.getTextDimensions(y[m],{fontSize:this.internal.__cell__.table_font_size,scaleFactor:this.internal.scaleFactor}).w);M[x]=Math.max.apply(null,I)+N+N,I=[]}if(O){var R={};for(d=0;d<w.length;d+=1)R[w[d]]={},R[w[d]].text=S[d],R[w[d]].align=A[d];var q=o.call(this,R,M);T=w.map(function(de){return new s(l,c,M[de],q,R[de].text,void 0,R[de].align)}),this.setTableHeaderRow(T),this.printHeaderRow(1,!1)}var Z=f.reduce(function(de,le){return de[le.name]=le.align,de},{});for(d=0;d<u.length;d+=1){"rowStart"in h&&h.rowStart instanceof Function&&h.rowStart({row:d,data:u[d]},this);var U=o.call(this,u[d],M);for(m=0;m<w.length;m+=1){var X=u[d][w[m]];"cellStart"in h&&h.cellStart instanceof Function&&h.cellStart({row:d,col:m,data:X},this),a.call(this,new s(l,c,M[w[m]],U,X,d+2,Z[w[m]]))}}return this.internal.__cell__.table_x=l,this.internal.__cell__.table_y=c,this};var o=function(l,c){var u=this.internal.__cell__.padding,f=this.internal.__cell__.table_font_size,h=this.internal.scaleFactor;return Object.keys(l).map(function(d){var y=l[d];return this.splitTextToSize(y.hasOwnProperty("text")?y.text:y,c[d]-u-u)},this).map(function(d){return this.getLineHeightFactor()*d.length*f/h+u+u},this).reduce(function(d,y){return Math.max(d,y)},0)};t.setTableHeaderRow=function(l){i.call(this),this.internal.__cell__.tableHeaderRow=l},t.printHeaderRow=function(l,c){if(i.call(this),!this.internal.__cell__.tableHeaderRow)throw new Error("Property tableHeaderRow does not exist.");var u;if(n=!0,typeof this.internal.__cell__.headerFunction=="function"){var f=this.internal.__cell__.headerFunction(this,this.internal.__cell__.pages);this.internal.__cell__.lastCell=new s(f[0],f[1],f[2],f[3],void 0,-1)}this.setFont(void 0,"bold");for(var h=[],d=0;d<this.internal.__cell__.tableHeaderRow.length;d+=1){u=this.internal.__cell__.tableHeaderRow[d].clone(),c&&(u.y=this.internal.__cell__.margins.top||0,h.push(u)),u.lineNumber=l;var y=this.getTextColor();this.setTextColor(this.internal.__cell__.headerTextColor),this.setFillColor(this.internal.__cell__.headerBackgroundColor),a.call(this,u),this.setTextColor(y)}h.length>0&&this.setTableHeaderRow(h),this.setFont(void 0,"normal"),n=!1}})(qt.API);var Wx={italic:["italic","oblique","normal"],oblique:["oblique","italic","normal"],normal:["normal","oblique","italic"]},Vx=["ultra-condensed","extra-condensed","condensed","semi-condensed","normal","semi-expanded","expanded","extra-expanded","ultra-expanded"],Zm=Ux(Vx),Gx=[100,200,300,400,500,600,700,800,900],aF=Ux(Gx);function jg(t){var e=t.family.replace(/"|'/g,"").toLowerCase(),n=(function(s){return Wx[s=s||"normal"]?s:"normal"})(t.style),i=(function(s){return s?typeof s=="number"?s>=100&&s<=900&&s%100==0?s:400:/^\d00$/.test(s)?parseInt(s):s==="bold"?700:400:400})(t.weight),r=(function(s){return typeof Zm[s=s||"normal"]=="number"?s:"normal"})(t.stretch);return{family:e,style:n,weight:i,stretch:r,src:t.src||[],ref:t.ref||{name:e,style:[r,n,i].join(" ")}}}function fy(t,e,n,i){var r;for(r=n;r>=0&&r<e.length;r+=i)if(t[e[r]])return t[e[r]];for(r=n;r>=0&&r<e.length;r-=i)if(t[e[r]])return t[e[r]]}var oF={"sans-serif":"helvetica",fixed:"courier",monospace:"courier",terminal:"courier",cursive:"times",fantasy:"times",serif:"times"},hy={caption:"times",icon:"times",menu:"times","message-box":"times","small-caption":"times","status-bar":"times"};function py(t){return[t.stretch,t.style,t.weight,t.family].join(" ")}function gy(t){return t.trimLeft()}function lF(t,e){for(var n=0;n<t.length;){if(t.charAt(n)===e)return[t.substring(0,n),t.substring(n+1)];n+=1}return null}function cF(t){var e=t.match(/^(-[a-z_]|[a-z_])[a-z0-9_-]*/i);return e===null?null:[e[0],t.substring(e[0].length)]}var $c,Uf,my,vy,yy,Hg=["times"];function by(t,e,n,i,r){var s=4,a=xy;switch(r){case qt.API.image_compression.FAST:s=1,a=wy;break;case qt.API.image_compression.MEDIUM:s=6,a=_y;break;case qt.API.image_compression.SLOW:s=9,a=Sy}t=(function(l,c,u,f){for(var h,d=l.length/c,y=new Uint8Array(l.length+d),m=[uF,wy,xy,_y,Sy],x=0;x<d;x+=1){var w=x*c,S=l.subarray(w,w+c);if(f)y.set(f(S,u,h),w+x);else{for(var A=m.length,_=[],M=0;M<A;M+=1)_[M]=m[M](S,u,h);var I=fF(_.concat());y.set(_[I],w+x)}h=S}return y})(t,e,Math.ceil(n*i/8),a);var o=Um(t,{level:s});return qt.API.__addimage__.arrayBufferToBinaryString(o)}function uF(t){var e=Array.apply([],t);return e.unshift(0),e}function wy(t,e){var n=t.length,i=[];i[0]=1;for(var r=0;r<n;r+=1){var s=t[r-e]||0;i[r+1]=t[r]-s+256&255}return i}function xy(t,e,n){var i=t.length,r=[];r[0]=2;for(var s=0;s<i;s+=1){var a=n&&n[s]||0;r[s+1]=t[s]-a+256&255}return r}function _y(t,e,n){var i=t.length,r=[];r[0]=3;for(var s=0;s<i;s+=1){var a=t[s-e]||0,o=n&&n[s]||0;r[s+1]=t[s]+256-(a+o>>>1)&255}return r}function Sy(t,e,n){var i=t.length,r=[];r[0]=4;for(var s=0;s<i;s+=1){var a=dF(t[s-e]||0,n&&n[s]||0,n&&n[s-e]||0);r[s+1]=t[s]-a+256&255}return r}function dF(t,e,n){if(t===e&&e===n)return t;var i=Math.abs(e-n),r=Math.abs(t-n),s=Math.abs(t+e-n-n);return i<=r&&i<=s?t:r<=s?e:n}function fF(t){var e=t.map(function(n){return n.reduce(function(i,r){return i+Math.abs(r)},0)});return e.indexOf(Math.min.apply(null,e))}function Ug(t,e,n){var i=e*n,r=Math.floor(i/8),s=16-(i-8*r+n),a=(1<<n)-1;return Xx(t,r)>>s&a}function ky(t,e,n,i){var r=n*i,s=Math.floor(r/8),a=16-(r-8*s+i),o=(1<<i)-1,l=(e&o)<<a;(function(c,u,f){if(u+1<c.byteLength)c.setUint16(u,f,!1);else{var h=f>>8&255;c.setUint8(u,h)}})(t,s,Xx(t,s)&~(o<<a)&65535|l)}function Xx(t,e){return e+1<t.byteLength?t.getUint16(e,!1):t.getUint8(e)<<8}function hF(t){var e=0;if(t[e++]!==71||t[e++]!==73||t[e++]!==70||t[e++]!==56||(t[e++]+1&253)!=56||t[e++]!==97)throw new Error("Invalid GIF 87a/89a header.");var n=t[e++]|t[e++]<<8,i=t[e++]|t[e++]<<8,r=t[e++],s=r>>7,a=1<<1+(7&r);t[e++],t[e++];var o=null,l=null;s&&(o=e,l=a,e+=3*a);var c=!0,u=[],f=0,h=null,d=0,y=null;for(this.width=n,this.height=i;c&&e<t.length;)switch(t[e++]){case 33:switch(t[e++]){case 255:if(t[e]!==11||t[e+1]==78&&t[e+2]==69&&t[e+3]==84&&t[e+4]==83&&t[e+5]==67&&t[e+6]==65&&t[e+7]==80&&t[e+8]==69&&t[e+9]==50&&t[e+10]==46&&t[e+11]==48&&t[e+12]==3&&t[e+13]==1&&t[e+16]==0)e+=14,y=t[e++]|t[e++]<<8,e++;else for(e+=12;;){if(!((C=t[e++])>=0))throw Error("Invalid block size");if(C===0)break;e+=C}break;case 249:if(t[e++]!==4||t[e+4]!==0)throw new Error("Invalid graphics extension block.");var m=t[e++];f=t[e++]|t[e++]<<8,h=t[e++],1&m||(h=null),d=m>>2&7,e++;break;case 254:for(;;){if(!((C=t[e++])>=0))throw Error("Invalid block size");if(C===0)break;e+=C}break;default:throw new Error("Unknown graphic control label: 0x"+t[e-1].toString(16))}break;case 44:var x=t[e++]|t[e++]<<8,w=t[e++]|t[e++]<<8,S=t[e++]|t[e++]<<8,A=t[e++]|t[e++]<<8,_=t[e++],M=_>>6&1,I=1<<1+(7&_),T=o,D=l,O=!1;_>>7&&(O=!0,T=e,D=I,e+=3*I);var W=e;for(e++;;){var C;if(!((C=t[e++])>=0))throw Error("Invalid block size");if(C===0)break;e+=C}u.push({x,y:w,width:S,height:A,has_local_palette:O,palette_offset:T,palette_size:D,data_offset:W,data_length:e-W,transparent_index:h,interlaced:!!M,delay:f,disposal:d});break;case 59:c=!1;break;default:throw new Error("Unknown gif block: 0x"+t[e-1].toString(16))}this.numFrames=function(){return u.length},this.loopCount=function(){return y},this.frameInfo=function(N){if(N<0||N>=u.length)throw new Error("Frame index out of range.");return u[N]},this.decodeAndBlitFrameBGRA=function(N,B){var E=this.frameInfo(N),R=E.width*E.height,q=new Uint8Array(R);Ay(t,E.data_offset,q,R);var Z=E.palette_offset,U=E.transparent_index;U===null&&(U=256);var X=E.width,de=n-X,le=X,F=4*(E.y*n+E.x),V=4*((E.y+E.height)*n+E.x),G=F,se=4*de;E.interlaced===!0&&(se+=4*n*7);for(var ae=8,te=0,ue=q.length;te<ue;++te){var pe=q[te];if(le===0&&(le=X,(G+=se)>=V&&(se=4*de+4*n*(ae-1),G=F+(X+de)*(ae<<1),ae>>=1)),pe===U)G+=4;else{var ge=t[Z+3*pe],me=t[Z+3*pe+1],Pe=t[Z+3*pe+2];B[G++]=Pe,B[G++]=me,B[G++]=ge,B[G++]=255}--le}},this.decodeAndBlitFrameRGBA=function(N,B){var E=this.frameInfo(N),R=E.width*E.height,q=new Uint8Array(R);Ay(t,E.data_offset,q,R);var Z=E.palette_offset,U=E.transparent_index;U===null&&(U=256);var X=E.width,de=n-X,le=X,F=4*(E.y*n+E.x),V=4*((E.y+E.height)*n+E.x),G=F,se=4*de;E.interlaced===!0&&(se+=4*n*7);for(var ae=8,te=0,ue=q.length;te<ue;++te){var pe=q[te];if(le===0&&(le=X,(G+=se)>=V&&(se=4*de+4*n*(ae-1),G=F+(X+de)*(ae<<1),ae>>=1)),pe===U)G+=4;else{var ge=t[Z+3*pe],me=t[Z+3*pe+1],Pe=t[Z+3*pe+2];B[G++]=ge,B[G++]=me,B[G++]=Pe,B[G++]=255}--le}}}function Ay(t,e,n,i){for(var r=t[e++],s=1<<r,a=s+1,o=a+1,l=r+1,c=(1<<l)-1,u=0,f=0,h=0,d=t[e++],y=new Int32Array(4096),m=null;;){for(;u<16&&d!==0;)f|=t[e++]<<u,u+=8,d===1?d=t[e++]:--d;if(u<l)break;var x=f&c;if(f>>=l,u-=l,x!==s){if(x===a)break;for(var w=x<o?x:m,S=0,A=w;A>s;)A=y[A]>>8,++S;var _=A;if(h+S+(w!==x?1:0)>i)return void Qn.log("Warning, gif stream longer than expected.");n[h++]=_;var M=h+=S;for(w!==x&&(n[h++]=_),A=w;S--;)A=y[A],n[--M]=255&A,A>>=8;m!==null&&o<4096&&(y[o++]=m<<8|_,o>=c+1&&l<12&&(++l,c=c<<1|1)),m=x}else o=a+1,c=(1<<(l=r+1))-1,m=null}return h!==i&&Qn.log("Warning, gif stream shorter than expected."),n}function Wg(t){var e,n,i,r,s,a=Math.floor,o=new Array(64),l=new Array(64),c=new Array(64),u=new Array(64),f=new Array(65535),h=new Array(65535),d=new Array(64),y=new Array(64),m=[],x=0,w=7,S=new Array(64),A=new Array(64),_=new Array(64),M=new Array(256),I=new Array(2048),T=[0,1,5,6,14,15,27,28,2,4,7,13,16,26,29,42,3,8,12,17,25,30,41,43,9,11,18,24,31,40,44,53,10,19,23,32,39,45,52,54,20,22,33,38,46,51,55,60,21,34,37,47,50,56,59,61,35,36,48,49,57,58,62,63],D=[0,0,1,5,1,1,1,1,1,1,0,0,0,0,0,0,0],O=[0,1,2,3,4,5,6,7,8,9,10,11],W=[0,0,2,1,3,3,2,4,3,5,5,4,4,0,0,1,125],C=[1,2,3,0,4,17,5,18,33,49,65,6,19,81,97,7,34,113,20,50,129,145,161,8,35,66,177,193,21,82,209,240,36,51,98,114,130,9,10,22,23,24,25,26,37,38,39,40,41,42,52,53,54,55,56,57,58,67,68,69,70,71,72,73,74,83,84,85,86,87,88,89,90,99,100,101,102,103,104,105,106,115,116,117,118,119,120,121,122,131,132,133,134,135,136,137,138,146,147,148,149,150,151,152,153,154,162,163,164,165,166,167,168,169,170,178,179,180,181,182,183,184,185,186,194,195,196,197,198,199,200,201,202,210,211,212,213,214,215,216,217,218,225,226,227,228,229,230,231,232,233,234,241,242,243,244,245,246,247,248,249,250],N=[0,0,3,1,1,1,1,1,1,1,1,1,0,0,0,0,0],B=[0,1,2,3,4,5,6,7,8,9,10,11],E=[0,0,2,1,2,4,4,3,4,7,5,4,4,0,1,2,119],R=[0,1,2,3,17,4,5,33,49,6,18,65,81,7,97,113,19,34,50,129,8,20,66,145,161,177,193,9,35,51,82,240,21,98,114,209,10,22,36,52,225,37,241,23,24,25,26,38,39,40,41,42,53,54,55,56,57,58,67,68,69,70,71,72,73,74,83,84,85,86,87,88,89,90,99,100,101,102,103,104,105,106,115,116,117,118,119,120,121,122,130,131,132,133,134,135,136,137,138,146,147,148,149,150,151,152,153,154,162,163,164,165,166,167,168,169,170,178,179,180,181,182,183,184,185,186,194,195,196,197,198,199,200,201,202,210,211,212,213,214,215,216,217,218,226,227,228,229,230,231,232,233,234,242,243,244,245,246,247,248,249,250];function q(F,V){for(var G=0,se=0,ae=new Array,te=1;te<=16;te++){for(var ue=1;ue<=F[te];ue++)ae[V[se]]=[],ae[V[se]][0]=G,ae[V[se]][1]=te,se++,G++;G*=2}return ae}function Z(F){for(var V=F[0],G=F[1]-1;G>=0;)V&1<<G&&(x|=1<<w),G--,--w<0&&(x==255?(U(255),U(0)):U(x),w=7,x=0)}function U(F){m.push(F)}function X(F){U(F>>8&255),U(255&F)}function de(F,V,G,se,ae){for(var te,ue=ae[0],pe=ae[240],ge=(function(Ee,at){var Ue,Ye,ut,Ft,be,ze,ve,Ce,Ie,rt,et=0;for(Ie=0;Ie<8;++Ie){Ue=Ee[et],Ye=Ee[et+1],ut=Ee[et+2],Ft=Ee[et+3],be=Ee[et+4],ze=Ee[et+5],ve=Ee[et+6];var vt=Ue+(Ce=Ee[et+7]),wt=Ue-Ce,Nt=Ye+ve,it=Ye-ve,kt=ut+ze,ct=ut-ze,yt=Ft+be,st=Ft-be,gt=vt+yt,Bt=vt-yt,xt=Nt+kt,dt=Nt-kt;Ee[et]=gt+xt,Ee[et+4]=gt-xt;var Ut=.707106781*(dt+Bt);Ee[et+2]=Bt+Ut,Ee[et+6]=Bt-Ut;var ai=.382683433*((gt=st+ct)-(dt=it+wt)),bn=.5411961*gt+ai,Ln=1.306562965*dt+ai,ni=.707106781*(xt=ct+it),Ct=wt+ni,oi=wt-ni;Ee[et+5]=oi+bn,Ee[et+3]=oi-bn,Ee[et+1]=Ct+Ln,Ee[et+7]=Ct-Ln,et+=8}for(et=0,Ie=0;Ie<8;++Ie){Ue=Ee[et],Ye=Ee[et+8],ut=Ee[et+16],Ft=Ee[et+24],be=Ee[et+32],ze=Ee[et+40],ve=Ee[et+48];var Hn=Ue+(Ce=Ee[et+56]),Sn=Ue-Ce,Mn=Ye+ve,Pn=Ye-ve,qe=ut+ze,$e=ut-ze,Pt=Ft+be,tn=Ft-be,Wt=Hn+Pt,Gt=Hn-Pt,Dt=Mn+qe,Jt=Mn-qe;Ee[et]=Wt+Dt,Ee[et+32]=Wt-Dt;var $t=.707106781*(Jt+Gt);Ee[et+16]=Gt+$t,Ee[et+48]=Gt-$t;var wn=.382683433*((Wt=tn+$e)-(Jt=Pn+Sn)),en=.5411961*Wt+wn,ii=1.306562965*Jt+wn,kn=.707106781*(Dt=$e+Pn),En=Sn+kn,Bs=Sn-kn;Ee[et+40]=Bs+en,Ee[et+24]=Bs-en,Ee[et+8]=En+ii,Ee[et+56]=En-ii,et++}for(Ie=0;Ie<64;++Ie)rt=Ee[Ie]*at[Ie],d[Ie]=rt>0?rt+.5|0:rt-.5|0;return d})(F,V),me=0;me<64;++me)y[T[me]]=ge[me];var Pe=y[0]-G;G=y[0],Pe==0?Z(se[0]):(Z(se[h[te=32767+Pe]]),Z(f[te]));for(var ke=63;ke>0&&y[ke]==0;)ke--;if(ke==0)return Z(ue),G;for(var Ge,K=1;K<=ke;){for(var Oe=K;y[K]==0&&K<=ke;)++K;var Ke=K-Oe;if(Ke>=16){Ge=Ke>>4;for(var Be=1;Be<=Ge;++Be)Z(pe);Ke&=15}te=32767+y[K],Z(ae[(Ke<<4)+h[te]]),Z(f[te]),K++}return ke!=63&&Z(ue),G}function le(F){F=Math.min(Math.max(F,1),100),s!=F&&((function(V){for(var G=[16,11,10,16,24,40,51,61,12,12,14,19,26,58,60,55,14,13,16,24,40,57,69,56,14,17,22,29,51,87,80,62,18,22,37,56,68,109,103,77,24,35,55,64,81,104,113,92,49,64,78,87,103,121,120,101,72,92,95,98,112,100,103,99],se=0;se<64;se++){var ae=a((G[se]*V+50)/100);ae=Math.min(Math.max(ae,1),255),o[T[se]]=ae}for(var te=[17,18,24,47,99,99,99,99,18,21,26,66,99,99,99,99,24,26,56,99,99,99,99,99,47,66,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99],ue=0;ue<64;ue++){var pe=a((te[ue]*V+50)/100);pe=Math.min(Math.max(pe,1),255),l[T[ue]]=pe}for(var ge=[1,1.387039845,1.306562965,1.175875602,1,.785694958,.5411961,.275899379],me=0,Pe=0;Pe<8;Pe++)for(var ke=0;ke<8;ke++)c[me]=1/(o[T[me]]*ge[Pe]*ge[ke]*8),u[me]=1/(l[T[me]]*ge[Pe]*ge[ke]*8),me++})(F<50?Math.floor(5e3/F):Math.floor(200-2*F)),s=F)}this.encode=function(F,V){V&&le(V),m=new Array,x=0,w=7,X(65496),X(65504),X(16),U(74),U(70),U(73),U(70),U(0),U(1),U(1),U(0),X(1),X(1),U(0),U(0),(function(){X(65499),X(132),U(0);for(var Ye=0;Ye<64;Ye++)U(o[Ye]);U(1);for(var ut=0;ut<64;ut++)U(l[ut])})(),(function(Ye,ut){X(65472),X(17),U(8),X(ut),X(Ye),U(3),U(1),U(17),U(0),U(2),U(17),U(1),U(3),U(17),U(1)})(F.width,F.height),(function(){X(65476),X(418),U(0);for(var Ye=0;Ye<16;Ye++)U(D[Ye+1]);for(var ut=0;ut<=11;ut++)U(O[ut]);U(16);for(var Ft=0;Ft<16;Ft++)U(W[Ft+1]);for(var be=0;be<=161;be++)U(C[be]);U(1);for(var ze=0;ze<16;ze++)U(N[ze+1]);for(var ve=0;ve<=11;ve++)U(B[ve]);U(17);for(var Ce=0;Ce<16;Ce++)U(E[Ce+1]);for(var Ie=0;Ie<=161;Ie++)U(R[Ie])})(),X(65498),X(12),U(3),U(1),U(0),U(2),U(17),U(3),U(17),U(0),U(63),U(0);var G=0,se=0,ae=0;x=0,w=7,this.encode.displayName="_encode_";for(var te,ue,pe,ge,me,Pe,ke,Ge,K,Oe=F.data,Ke=F.width,Be=F.height,Ee=4*Ke,at=0;at<Be;){for(te=0;te<Ee;){for(me=Ee*at+te,ke=-1,Ge=0,K=0;K<64;K++)Pe=me+(Ge=K>>3)*Ee+(ke=4*(7&K)),at+Ge>=Be&&(Pe-=Ee*(at+1+Ge-Be)),te+ke>=Ee&&(Pe-=te+ke-Ee+4),ue=Oe[Pe++],pe=Oe[Pe++],ge=Oe[Pe++],S[K]=(I[ue]+I[pe+256|0]+I[ge+512|0]>>16)-128,A[K]=(I[ue+768|0]+I[pe+1024|0]+I[ge+1280|0]>>16)-128,_[K]=(I[ue+1280|0]+I[pe+1536|0]+I[ge+1792|0]>>16)-128;G=de(S,c,G,e,i),se=de(A,u,se,n,r),ae=de(_,u,ae,n,r),te+=32}at+=8}if(w>=0){var Ue=[];Ue[1]=w+1,Ue[0]=(1<<w+1)-1,Z(Ue)}return X(65497),new Uint8Array(m)},t=t||50,(function(){for(var F=String.fromCharCode,V=0;V<256;V++)M[V]=F(V)})(),e=q(D,O),n=q(N,B),i=q(W,C),r=q(E,R),(function(){for(var F=1,V=2,G=1;G<=15;G++){for(var se=F;se<V;se++)h[32767+se]=G,f[32767+se]=[],f[32767+se][1]=G,f[32767+se][0]=se;for(var ae=-(V-1);ae<=-F;ae++)h[32767+ae]=G,f[32767+ae]=[],f[32767+ae][1]=G,f[32767+ae][0]=V-1+ae;F<<=1,V<<=1}})(),(function(){for(var F=0;F<256;F++)I[F]=19595*F,I[F+256|0]=38470*F,I[F+512|0]=7471*F+32768,I[F+768|0]=-11059*F,I[F+1024|0]=-21709*F,I[F+1280|0]=32768*F+8421375,I[F+1536|0]=-27439*F,I[F+1792|0]=-5329*F})(),le(t)}function _a(t,e){if(this.pos=0,this.buffer=t,this.datav=new DataView(t.buffer),this.is_with_alpha=!!e,this.bottom_up=!0,this.flag=String.fromCharCode(this.buffer[0])+String.fromCharCode(this.buffer[1]),this.pos+=2,["BM","BA","CI","CP","IC","PT"].indexOf(this.flag)===-1)throw new Error("Invalid BMP File");this.parseHeader(),this.parseBGR()}function Ny(t){function e(O){if(!O)throw Error("assert :P")}function n(O,W,C){for(var N=0;4>N;N++)if(O[W+N]!=C.charCodeAt(N))return!0;return!1}function i(O,W,C,N,B){for(var E=0;E<B;E++)O[W+E]=C[N+E]}function r(O,W,C,N){for(var B=0;B<N;B++)O[W+B]=C}function s(O){return new Int32Array(O)}function a(O,W){for(var C=[],N=0;N<O;N++)C.push(new W);return C}function o(O,W){var C=[];return(function N(B,E,R){for(var q=R[E],Z=0;Z<q&&(B.push(R.length>E+1?[]:new W),!(R.length<E+1));Z++)N(B[Z],E+1,R)})(C,0,O),C}var l=function(){var O=this;function W(g,v){for(var k=1<<v-1>>>0;g&k;)k>>>=1;return k?(g&k-1)+k:g}function C(g,v,k,L,z){e(!(L%k));do g[v+(L-=k)]=z;while(0<L)}function N(g,v,k,L,z){if(e(2328>=z),512>=z)var H=s(512);else if((H=s(z))==null)return 0;return(function(Y,ee,ie,oe,xe,De){var ce,_e,Ne=ee,je=1<<ie,Me=s(16),Ve=s(16);for(e(xe!=0),e(oe!=null),e(Y!=null),e(0<ie),_e=0;_e<xe;++_e){if(15<oe[_e])return 0;++Me[oe[_e]]}if(Me[0]==xe)return 0;for(Ve[1]=0,ce=1;15>ce;++ce){if(Me[ce]>1<<ce)return 0;Ve[ce+1]=Ve[ce]+Me[ce]}for(_e=0;_e<xe;++_e)ce=oe[_e],0<oe[_e]&&(De[Ve[ce]++]=_e);if(Ve[15]==1)return(oe=new B).g=0,oe.value=De[0],C(Y,Ne,1,je,oe),je;var Xe,tt=-1,Qe=je-1,zt=0,At=1,on=1,St=1<<ie;for(_e=0,ce=1,xe=2;ce<=ie;++ce,xe<<=1){if(At+=on<<=1,0>(on-=Me[ce]))return 0;for(;0<Me[ce];--Me[ce])(oe=new B).g=ce,oe.value=De[_e++],C(Y,Ne+zt,xe,St,oe),zt=W(zt,ce)}for(ce=ie+1,xe=2;15>=ce;++ce,xe<<=1){if(At+=on<<=1,0>(on-=Me[ce]))return 0;for(;0<Me[ce];--Me[ce]){if(oe=new B,(zt&Qe)!=tt){for(Ne+=St,Xe=1<<(tt=ce)-ie;15>tt&&!(0>=(Xe-=Me[tt]));)++tt,Xe<<=1;je+=St=1<<(Xe=tt-ie),Y[ee+(tt=zt&Qe)].g=Xe+ie,Y[ee+tt].value=Ne-ee-tt}oe.g=ce-ie,oe.value=De[_e++],C(Y,Ne+(zt>>ie),xe,St,oe),zt=W(zt,ce)}}return At!=2*Ve[15]-1?0:je})(g,v,k,L,z,H)}function B(){this.value=this.g=0}function E(){this.value=this.g=0}function R(){this.G=a(5,B),this.H=s(5),this.jc=this.Qb=this.qb=this.nd=0,this.pd=a(ds,E)}function q(g,v,k,L){e(g!=null),e(v!=null),e(2147483648>L),g.Ca=254,g.I=0,g.b=-8,g.Ka=0,g.oa=v,g.pa=k,g.Jd=v,g.Yc=k+L,g.Zc=4<=L?k+L-4+1:k,ue(g)}function Z(g,v){for(var k=0;0<v--;)k|=ge(g,128)<<v;return k}function U(g,v){var k=Z(g,v);return pe(g)?-k:k}function X(g,v,k,L){var z,H=0;for(e(g!=null),e(v!=null),e(4294967288>L),g.Sb=L,g.Ra=0,g.u=0,g.h=0,4<L&&(L=4),z=0;z<L;++z)H+=v[k+z]<<8*z;g.Ra=H,g.bb=L,g.oa=v,g.pa=k}function de(g){for(;8<=g.u&&g.bb<g.Sb;)g.Ra>>>=8,g.Ra+=g.oa[g.pa+g.bb]<<Ha-8>>>0,++g.bb,g.u-=8;se(g)&&(g.h=1,g.u=0)}function le(g,v){if(e(0<=v),!g.h&&v<=Gr){var k=G(g)&zi[v];return g.u+=v,de(g),k}return g.h=1,g.u=0}function F(){this.b=this.Ca=this.I=0,this.oa=[],this.pa=0,this.Jd=[],this.Yc=0,this.Zc=[],this.Ka=0}function V(){this.Ra=0,this.oa=[],this.h=this.u=this.bb=this.Sb=this.pa=0}function G(g){return g.Ra>>>(g.u&Ha-1)>>>0}function se(g){return e(g.bb<=g.Sb),g.h||g.bb==g.Sb&&g.u>Ha}function ae(g,v){g.u=v,g.h=se(g)}function te(g){g.u>=ha&&(e(g.u>=ha),de(g))}function ue(g){e(g!=null&&g.oa!=null),g.pa<g.Zc?(g.I=(g.oa[g.pa++]|g.I<<8)>>>0,g.b+=8):(e(g!=null&&g.oa!=null),g.pa<g.Yc?(g.b+=8,g.I=g.oa[g.pa++]|g.I<<8):g.Ka?g.b=0:(g.I<<=8,g.b+=8,g.Ka=1))}function pe(g){return Z(g,1)}function ge(g,v){var k=g.Ca;0>g.b&&ue(g);var L=g.b,z=k*v>>>8,H=(g.I>>>L>z)+0;for(H?(k-=z,g.I-=z+1<<L>>>0):k=z+1,L=k,z=0;256<=L;)z+=8,L>>=8;return L=7^z+Xr[L],g.b-=L,g.Ca=(k<<L)-1,H}function me(g,v,k){g[v+0]=k>>24&255,g[v+1]=k>>16&255,g[v+2]=k>>8&255,g[v+3]=255&k}function Pe(g,v){return g[v+0]|g[v+1]<<8}function ke(g,v){return Pe(g,v)|g[v+2]<<16}function Ge(g,v){return Pe(g,v)|Pe(g,v+2)<<16}function K(g,v){var k=1<<v;return e(g!=null),e(0<v),g.X=s(k),g.X==null?0:(g.Mb=32-v,g.Xa=v,1)}function Oe(g,v){e(g!=null),e(v!=null),e(g.Xa==v.Xa),i(v.X,0,g.X,0,1<<v.Xa)}function Ke(){this.X=[],this.Xa=this.Mb=0}function Be(g,v,k,L){e(k!=null),e(L!=null);var z=k[0],H=L[0];return z==0&&(z=(g*H+v/2)/v),H==0&&(H=(v*z+g/2)/g),0>=z||0>=H?0:(k[0]=z,L[0]=H,1)}function Ee(g,v){return g+(1<<v)-1>>>v}function at(g,v){return((4278255360&g)+(4278255360&v)>>>0&4278255360)+((16711935&g)+(16711935&v)>>>0&16711935)>>>0}function Ue(g,v){O[v]=function(k,L,z,H,Y,ee,ie){var oe;for(oe=0;oe<Y;++oe){var xe=O[g](ee[ie+oe-1],z,H+oe);ee[ie+oe]=at(k[L+oe],xe)}}}function Ye(){this.ud=this.hd=this.jd=0}function ut(g,v){return((4278124286&(g^v))>>>1)+(g&v)>>>0}function Ft(g){return 0<=g&&256>g?g:0>g?0:255<g?255:void 0}function be(g,v){return Ft(g+(g-v+.5>>1))}function ze(g,v,k){return Math.abs(v-k)-Math.abs(g-k)}function ve(g,v,k,L,z,H,Y){for(L=H[Y-1],k=0;k<z;++k)H[Y+k]=L=at(g[v+k],L)}function Ce(g,v,k,L,z){var H;for(H=0;H<k;++H){var Y=g[v+H],ee=Y>>8&255,ie=16711935&(ie=(ie=16711935&Y)+((ee<<16)+ee));L[z+H]=(4278255360&Y)+ie>>>0}}function Ie(g,v){v.jd=255&g,v.hd=g>>8&255,v.ud=g>>16&255}function rt(g,v,k,L,z,H){var Y;for(Y=0;Y<L;++Y){var ee=v[k+Y],ie=ee>>>8,oe=ee,xe=255&(xe=(xe=ee>>>16)+((g.jd<<24>>24)*(ie<<24>>24)>>>5));oe=255&(oe=(oe+=(g.hd<<24>>24)*(ie<<24>>24)>>>5)+((g.ud<<24>>24)*(xe<<24>>24)>>>5)),z[H+Y]=(4278255360&ee)+(xe<<16)+oe}}function et(g,v,k,L,z){O[v]=function(H,Y,ee,ie,oe,xe,De,ce,_e){for(ie=De;ie<ce;++ie)for(De=0;De<_e;++De)oe[xe++]=z(ee[L(H[Y++])])},O[g]=function(H,Y,ee,ie,oe,xe,De){var ce=8>>H.b,_e=H.Ea,Ne=H.K[0],je=H.w;if(8>ce)for(H=(1<<H.b)-1,je=(1<<ce)-1;Y<ee;++Y){var Me,Ve=0;for(Me=0;Me<_e;++Me)Me&H||(Ve=L(ie[oe++])),xe[De++]=z(Ne[Ve&je]),Ve>>=ce}else O["VP8LMapColor"+k](ie,oe,Ne,je,xe,De,Y,ee,_e)}}function vt(g,v,k,L,z){for(k=v+k;v<k;){var H=g[v++];L[z++]=H>>16&255,L[z++]=H>>8&255,L[z++]=255&H}}function wt(g,v,k,L,z){for(k=v+k;v<k;){var H=g[v++];L[z++]=H>>16&255,L[z++]=H>>8&255,L[z++]=255&H,L[z++]=H>>24&255}}function Nt(g,v,k,L,z){for(k=v+k;v<k;){var H=(Y=g[v++])>>16&240|Y>>12&15,Y=240&Y|Y>>28&15;L[z++]=H,L[z++]=Y}}function it(g,v,k,L,z){for(k=v+k;v<k;){var H=(Y=g[v++])>>16&248|Y>>13&7,Y=Y>>5&224|Y>>3&31;L[z++]=H,L[z++]=Y}}function kt(g,v,k,L,z){for(k=v+k;v<k;){var H=g[v++];L[z++]=255&H,L[z++]=H>>8&255,L[z++]=H>>16&255}}function ct(g,v,k,L,z,H){if(H==0)for(k=v+k;v<k;)me(L,((H=g[v++])[0]>>24|H[1]>>8&65280|H[2]<<8&16711680|H[3]<<24)>>>0),z+=32;else i(L,z,g,v,k)}function yt(g,v){O[v][0]=O[g+"0"],O[v][1]=O[g+"1"],O[v][2]=O[g+"2"],O[v][3]=O[g+"3"],O[v][4]=O[g+"4"],O[v][5]=O[g+"5"],O[v][6]=O[g+"6"],O[v][7]=O[g+"7"],O[v][8]=O[g+"8"],O[v][9]=O[g+"9"],O[v][10]=O[g+"10"],O[v][11]=O[g+"11"],O[v][12]=O[g+"12"],O[v][13]=O[g+"13"],O[v][14]=O[g+"0"],O[v][15]=O[g+"0"]}function st(g){return g==Uu||g==Wu||g==ya||g==Ga}function gt(){this.eb=[],this.size=this.A=this.fb=0}function Bt(){this.y=[],this.f=[],this.ea=[],this.F=[],this.Tc=this.Ed=this.Cd=this.Fd=this.lb=this.Db=this.Ab=this.fa=this.J=this.W=this.N=this.O=0}function xt(){this.Rd=this.height=this.width=this.S=0,this.f={},this.f.RGBA=new gt,this.f.kb=new Bt,this.sd=null}function dt(){this.width=[0],this.height=[0],this.Pd=[0],this.Qd=[0],this.format=[0]}function Ut(){this.Id=this.fd=this.Md=this.hb=this.ib=this.da=this.bd=this.cd=this.j=this.v=this.Da=this.Sd=this.ob=0}function ai(g){return alert("todo:WebPSamplerProcessPlane"),g.T}function bn(g,v){var k=g.T,L=v.ba.f.RGBA,z=L.eb,H=L.fb+g.ka*L.A,Y=$i[v.ba.S],ee=g.y,ie=g.O,oe=g.f,xe=g.N,De=g.ea,ce=g.W,_e=v.cc,Ne=v.dc,je=v.Mc,Me=v.Nc,Ve=g.ka,Xe=g.ka+g.T,tt=g.U,Qe=tt+1>>1;for(Ve==0?Y(ee,ie,null,null,oe,xe,De,ce,oe,xe,De,ce,z,H,null,null,tt):(Y(v.ec,v.fc,ee,ie,_e,Ne,je,Me,oe,xe,De,ce,z,H-L.A,z,H,tt),++k);Ve+2<Xe;Ve+=2)_e=oe,Ne=xe,je=De,Me=ce,xe+=g.Rc,ce+=g.Rc,H+=2*L.A,Y(ee,(ie+=2*g.fa)-g.fa,ee,ie,_e,Ne,je,Me,oe,xe,De,ce,z,H-L.A,z,H,tt);return ie+=g.fa,g.j+Xe<g.o?(i(v.ec,v.fc,ee,ie,tt),i(v.cc,v.dc,oe,xe,Qe),i(v.Mc,v.Nc,De,ce,Qe),k--):1&Xe||Y(ee,ie,null,null,oe,xe,De,ce,oe,xe,De,ce,z,H+L.A,null,null,tt),k}function Ln(g,v,k){var L=g.F,z=[g.J];if(L!=null){var H=g.U,Y=v.ba.S,ee=Y==va||Y==ya;v=v.ba.f.RGBA;var ie=[0],oe=g.ka;ie[0]=g.T,g.Kb&&(oe==0?--ie[0]:(--oe,z[0]-=g.width),g.j+g.ka+g.T==g.o&&(ie[0]=g.o-g.j-oe));var xe=v.eb;oe=v.fb+oe*v.A,g=Io(L,z[0],g.width,H,ie,xe,oe+(ee?0:3),v.A),e(k==ie),g&&st(Y)&&cc(xe,oe,ee,H,ie,v.A)}return 0}function ni(g){var v=g.ma,k=v.ba.S,L=11>k,z=k==Uc||k==Wc||k==va||k==Va||k==12||st(k);if(v.memory=null,v.Ib=null,v.Jb=null,v.Nd=null,!ic(v.Oa,g,z?11:12))return 0;if(z&&st(k)&&Us(),g.da)alert("todo:use_scaling");else{if(L){if(v.Ib=ai,g.Kb){if(k=g.U+1>>1,v.memory=s(g.U+2*k),v.memory==null)return 0;v.ec=v.memory,v.fc=0,v.cc=v.ec,v.dc=v.fc+g.U,v.Mc=v.cc,v.Nc=v.dc+k,v.Ib=bn,Us()}}else alert("todo:EmitYUV");z&&(v.Jb=Ln,L&&Kn())}if(L&&!hf){for(g=0;256>g;++g)_l[g]=89858*(g-128)+wa>>Vc,jp[g]=-22014*(g-128)+wa,qp[g]=-45773*(g-128),Sl[g]=113618*(g-128)+wa>>Vc;for(g=Ys;g<Vu;++g)v=76283*(g-16)+wa>>Vc,Hp[g-Ys]=Xi(v,255),kl[g-Ys]=Xi(v+8>>4,15);hf=1}return 1}function Ct(g){var v=g.ma,k=g.U,L=g.T;return e(!(1&g.ka)),0>=k||0>=L?0:(k=v.Ib(g,v),v.Jb!=null&&v.Jb(g,v,k),v.Dc+=k,1)}function oi(g){g.ma.memory=null}function Hn(g,v,k,L){return le(g,8)!=47?0:(v[0]=le(g,14)+1,k[0]=le(g,14)+1,L[0]=le(g,1),le(g,3)!=0?0:!g.h)}function Sn(g,v){if(4>g)return g+1;var k=g-2>>1;return(2+(1&g)<<k)+le(v,k)+1}function Mn(g,v){return 120<v?v-120:1<=(k=((k=Cp[v-1])>>4)*g+(8-(15&k)))?k:1;var k}function Pn(g,v,k){var L=G(k),z=g[v+=255&L].g-8;return 0<z&&(ae(k,k.u+8),L=G(k),v+=g[v].value,v+=L&(1<<z)-1),ae(k,k.u+g[v].g),g[v].value}function qe(g,v,k){return k.g+=g.g,k.value+=g.value<<v>>>0,e(8>=k.g),g.g}function $e(g,v,k){var L=g.xc;return e((v=L==0?0:g.vc[g.md*(k>>L)+(v>>L)])<g.Wb),g.Ya[v]}function Pt(g,v,k,L){var z=g.ab,H=g.c*v,Y=g.C;v=Y+v;var ee=k,ie=L;for(L=g.Ta,k=g.Ua;0<z--;){var oe=g.gc[z],xe=Y,De=v,ce=ee,_e=ie,Ne=(ie=L,ee=k,oe.Ea);switch(e(xe<De),e(De<=oe.nc),oe.hc){case 2:bi(ce,_e,(De-xe)*Ne,ie,ee);break;case 0:var je=xe,Me=De,Ve=ie,Xe=ee,tt=(St=oe).Ea;je==0&&(Vs(ce,_e,null,null,1,Ve,Xe),ve(ce,_e+1,0,0,tt-1,Ve,Xe+1),_e+=tt,Xe+=tt,++je);for(var Qe=1<<St.b,zt=Qe-1,At=Ee(tt,St.b),on=St.K,St=St.w+(je>>St.b)*At;je<Me;){var un=on,Pi=St,ln=1;for(yl(ce,_e,Ve,Xe-tt,1,Ve,Xe);ln<tt;){var Lt=(ln&~zt)+Qe;Lt>tt&&(Lt=tt),(0,ac[un[Pi++]>>8&15])(ce,_e+ +ln,Ve,Xe+ln-tt,Lt-ln,Ve,Xe+ln),ln=Lt}_e+=tt,Xe+=tt,++je&zt||(St+=At)}De!=oe.nc&&i(ie,ee-Ne,ie,ee+(De-xe-1)*Ne,Ne);break;case 1:for(Ne=ce,Me=_e,tt=(ce=oe.Ea)-(Xe=ce&~(Ve=(_e=1<<oe.b)-1)),je=Ee(ce,oe.b),Qe=oe.K,oe=oe.w+(xe>>oe.b)*je;xe<De;){for(zt=Qe,At=oe,on=new Ye,St=Me+Xe,un=Me+ce;Me<St;)Ie(zt[At++],on),oc(on,Ne,Me,_e,ie,ee),Me+=_e,ee+=_e;Me<un&&(Ie(zt[At++],on),oc(on,Ne,Me,tt,ie,ee),Me+=tt,ee+=tt),++xe&Ve||(oe+=je)}break;case 3:if(ce==ie&&_e==ee&&0<oe.b){for(Me=ie,ce=Ne=ee+(De-xe)*Ne-(Xe=(De-xe)*Ee(oe.Ea,oe.b)),_e=ie,Ve=ee,je=[],Xe=(tt=Xe)-1;0<=Xe;--Xe)je[Xe]=_e[Ve+Xe];for(Xe=tt-1;0<=Xe;--Xe)Me[ce+Xe]=je[Xe];jc(oe,xe,De,ie,Ne,ie,ee)}else jc(oe,xe,De,ce,_e,ie,ee)}ee=L,ie=k}ie!=k&&i(L,k,ee,ie,H)}function tn(g,v){var k=g.V,L=g.Ba+g.c*g.C,z=v-g.C;if(e(v<=g.l.o),e(16>=z),0<z){var H=g.l,Y=g.Ta,ee=g.Ua,ie=H.width;if(Pt(g,z,k,L),z=ee=[ee],e((k=g.C)<(L=v)),e(H.v<H.va),L>H.o&&(L=H.o),k<H.j){var oe=H.j-k;k=H.j,z[0]+=oe*ie}if(k>=L?k=0:(z[0]+=4*H.v,H.ka=k-H.j,H.U=H.va-H.v,H.T=L-k,k=1),k){if(ee=ee[0],11>(k=g.ca).S){var xe=k.f.RGBA,De=(L=k.S,z=H.U,H=H.T,oe=xe.eb,xe.A),ce=H;for(xe=xe.fb+g.Ma*xe.A;0<ce--;){var _e=Y,Ne=ee,je=z,Me=oe,Ve=xe;switch(L){case ma:Gs(_e,Ne,je,Me,Ve);break;case Uc:Yr(_e,Ne,je,Me,Ve);break;case Uu:Yr(_e,Ne,je,Me,Ve),cc(Me,Ve,0,je,1,0);break;case of:Co(_e,Ne,je,Me,Ve);break;case Wc:ct(_e,Ne,je,Me,Ve,1);break;case Wu:ct(_e,Ne,je,Me,Ve,1),cc(Me,Ve,0,je,1,0);break;case va:ct(_e,Ne,je,Me,Ve,0);break;case ya:ct(_e,Ne,je,Me,Ve,0),cc(Me,Ve,1,je,1,0);break;case Va:Ua(_e,Ne,je,Me,Ve);break;case Ga:Ua(_e,Ne,je,Me,Ve),nf(Me,Ve,je,1,0);break;case lf:Wa(_e,Ne,je,Me,Ve);break;default:e(0)}ee+=ie,xe+=De}g.Ma+=H}else alert("todo:EmitRescaledRowsYUVA");e(g.Ma<=k.height)}}g.C=v,e(g.C<=g.i)}function Wt(g){var v;if(0<g.ua)return 0;for(v=0;v<g.Wb;++v){var k=g.Ya[v].G,L=g.Ya[v].H;if(0<k[1][L[1]+0].g||0<k[2][L[2]+0].g||0<k[3][L[3]+0].g)return 0}return 1}function Gt(g,v,k,L,z,H){if(g.Z!=0){var Y=g.qd,ee=g.rd;for(e(Qr[g.Z]!=null);v<k;++v)Qr[g.Z](Y,ee,L,z,L,z,H),Y=L,ee=z,z+=H;g.qd=Y,g.rd=ee}}function Dt(g,v){var k=g.l.ma,L=k.Z==0||k.Z==1?g.l.j:g.C;if(L=g.C<L?L:g.C,e(v<=g.l.o),v>L){var z=g.l.width,H=k.ca,Y=k.tb+z*L,ee=g.V,ie=g.Ba+g.c*L,oe=g.gc;e(g.ab==1),e(oe[0].hc==3),Sr(oe[0],L,v,ee,ie,H,Y),Gt(k,L,v,H,Y,z)}g.C=g.Ma=v}function Jt(g,v,k,L,z,H,Y){var ee=g.$/L,ie=g.$%L,oe=g.m,xe=g.s,De=k+g.$,ce=De;z=k+L*z;var _e=k+L*H,Ne=280+xe.ua,je=g.Pb?ee:16777216,Me=0<xe.ua?xe.Wa:null,Ve=xe.wc,Xe=De<_e?$e(xe,ie,ee):null;e(g.C<H),e(_e<=z);var tt=!1;e:for(;;){for(;tt||De<_e;){var Qe=0;if(ee>=je){var zt=De-k;e((je=g).Pb),je.wd=je.m,je.xd=zt,0<je.s.ua&&Oe(je.s.Wa,je.s.vb),je=ee+Ep}if(ie&Ve||(Xe=$e(xe,ie,ee)),e(Xe!=null),Xe.Qb&&(v[De]=Xe.qb,tt=!0),!tt)if(te(oe),Xe.jc){Qe=oe,zt=v;var At=De,on=Xe.pd[G(Qe)&ds-1];e(Xe.jc),256>on.g?(ae(Qe,Qe.u+on.g),zt[At]=on.value,Qe=0):(ae(Qe,Qe.u+on.g-256),e(256<=on.value),Qe=on.value),Qe==0&&(tt=!0)}else Qe=Pn(Xe.G[0],Xe.H[0],oe);if(oe.h)break;if(tt||256>Qe){if(!tt)if(Xe.nd)v[De]=(Xe.qb|Qe<<8)>>>0;else{if(te(oe),tt=Pn(Xe.G[1],Xe.H[1],oe),te(oe),zt=Pn(Xe.G[2],Xe.H[2],oe),At=Pn(Xe.G[3],Xe.H[3],oe),oe.h)break;v[De]=(At<<24|tt<<16|Qe<<8|zt)>>>0}if(tt=!1,++De,++ie>=L&&(ie=0,++ee,Y!=null&&ee<=H&&!(ee%16)&&Y(g,ee),Me!=null))for(;ce<De;)Qe=v[ce++],Me.X[(506832829*Qe&4294967295)>>>Me.Mb]=Qe}else if(280>Qe){if(Qe=Sn(Qe-256,oe),zt=Pn(Xe.G[4],Xe.H[4],oe),te(oe),zt=Mn(L,zt=Sn(zt,oe)),oe.h)break;if(De-k<zt||z-De<Qe)break e;for(At=0;At<Qe;++At)v[De+At]=v[De+At-zt];for(De+=Qe,ie+=Qe;ie>=L;)ie-=L,++ee,Y!=null&&ee<=H&&!(ee%16)&&Y(g,ee);if(e(De<=z),ie&Ve&&(Xe=$e(xe,ie,ee)),Me!=null)for(;ce<De;)Qe=v[ce++],Me.X[(506832829*Qe&4294967295)>>>Me.Mb]=Qe}else{if(!(Qe<Ne))break e;for(tt=Qe-280,e(Me!=null);ce<De;)Qe=v[ce++],Me.X[(506832829*Qe&4294967295)>>>Me.Mb]=Qe;Qe=De,e(!(tt>>>(zt=Me).Xa)),v[Qe]=zt.X[tt],tt=!0}tt||e(oe.h==se(oe))}if(g.Pb&&oe.h&&De<z)e(g.m.h),g.a=5,g.m=g.wd,g.$=g.xd,0<g.s.ua&&Oe(g.s.vb,g.s.Wa);else{if(oe.h)break e;Y?.(g,ee>H?H:ee),g.a=0,g.$=De-k}return 1}return g.a=3,0}function $t(g){e(g!=null),g.vc=null,g.yc=null,g.Ya=null;var v=g.Wa;v!=null&&(v.X=null),g.vb=null,e(g!=null)}function wn(){var g=new Rt;return g==null?null:(g.a=0,g.xb=uf,yt("Predictor","VP8LPredictors"),yt("Predictor","VP8LPredictors_C"),yt("PredictorAdd","VP8LPredictorsAdd"),yt("PredictorAdd","VP8LPredictorsAdd_C"),bi=Ce,oc=rt,Gs=vt,Yr=wt,Ua=Nt,Wa=it,Co=kt,O.VP8LMapColor32b=_r,O.VP8LMapColor8b=sc,g)}function en(g,v,k,L,z){var H=1,Y=[g],ee=[v],ie=L.m,oe=L.s,xe=null,De=0;e:for(;;){if(k)for(;H&&le(ie,1);){var ce=Y,_e=ee,Ne=L,je=1,Me=Ne.m,Ve=Ne.gc[Ne.ab],Xe=le(Me,2);if(Ne.Oc&1<<Xe)H=0;else{switch(Ne.Oc|=1<<Xe,Ve.hc=Xe,Ve.Ea=ce[0],Ve.nc=_e[0],Ve.K=[null],++Ne.ab,e(4>=Ne.ab),Xe){case 0:case 1:Ve.b=le(Me,3)+2,je=en(Ee(Ve.Ea,Ve.b),Ee(Ve.nc,Ve.b),0,Ne,Ve.K),Ve.K=Ve.K[0];break;case 3:var tt,Qe=le(Me,8)+1,zt=16<Qe?0:4<Qe?1:2<Qe?2:3;if(ce[0]=Ee(Ve.Ea,zt),Ve.b=zt,tt=je=en(Qe,1,0,Ne,Ve.K)){var At,on=Qe,St=Ve,un=1<<(8>>St.b),Pi=s(un);if(Pi==null)tt=0;else{var ln=St.K[0],Lt=St.w;for(Pi[0]=St.K[0][0],At=1;At<1*on;++At)Pi[At]=at(ln[Lt+At],Pi[At-1]);for(;At<4*un;++At)Pi[At]=0;St.K[0]=null,St.K[0]=Pi,tt=1}}je=tt;break;case 2:break;default:e(0)}H=je}}if(Y=Y[0],ee=ee[0],H&&le(ie,1)&&!(H=1<=(De=le(ie,4))&&11>=De)){L.a=3;break e}var ft;if(ft=H)t:{var Wn,rn,xn,Zn=L,fi=Y,_i=ee,hi=De,fr=k,kr=Zn.m,ri=Zn.s,fn=[null],Tn=1,pi=0,Dn=Pp[hi];n:for(;;){if(fr&&le(kr,1)){var gi=le(kr,3)+2,hr=Ee(fi,gi),wi=Ee(_i,gi),Dr=hr*wi;if(!en(hr,wi,0,Zn,fn))break n;for(fn=fn[0],ri.xc=gi,Wn=0;Wn<Dr;++Wn){var qn=fn[Wn]>>8&65535;fn[Wn]=qn,qn>=Tn&&(Tn=qn+1)}}if(kr.h)break n;for(rn=0;5>rn;++rn){var si=cf[rn];!rn&&0<hi&&(si+=1<<hi),pi<si&&(pi=si)}var qi=a(Tn*Dn,B),Ar=Tn,$r=a(Ar,R);if($r==null)var es=null;else e(65536>=Ar),es=$r;var Ei=s(pi);if(es==null||Ei==null||qi==null){Zn.a=1;break n}var ji=qi;for(Wn=xn=0;Wn<Tn;++Wn){var Vn=es[Wn],ts=Vn.G,Is=Vn.H,ps=0,Or=1,er=0;for(rn=0;5>rn;++rn){si=cf[rn],ts[rn]=ji,Is[rn]=xn,!rn&&0<hi&&(si+=1<<hi);r:{var Xc,Gu=si,xa=Zn,Ls=Ei,Vp=ji,M_=xn,Gp=0,Al=xa.m,T_=le(Al,1);if(r(Ls,0,0,Gu),T_){var D_=le(Al,1)+1,O_=le(Al,1),w0=le(Al,O_==0?1:8);Ls[w0]=1,D_==2&&(Ls[w0=le(Al,8)]=1);var pf=1}else{var x0=s(19),_0=le(Al,4)+4;if(19<_0){xa.a=3;var gf=0;break r}for(Xc=0;Xc<_0;++Xc)x0[wl[Xc]]=le(Al,3);var Xp=void 0,Xu=void 0,S0=xa,F_=x0,mf=Gu,k0=Ls,Yp=0,Nl=S0.m,A0=8,N0=a(128,B);i:for(;N(N0,0,7,F_,19);){if(le(Nl,1)){var R_=2+2*le(Nl,3);if((Xp=2+le(Nl,R_))>mf)break i}else Xp=mf;for(Xu=0;Xu<mf&&Xp--;){te(Nl);var C0=N0[0+(127&G(Nl))];ae(Nl,Nl.u+C0.g);var Yc=C0.value;if(16>Yc)k0[Xu++]=Yc,Yc!=0&&(A0=Yc);else{var B_=Yc==16,P0=Yc-16,z_=Np[P0],E0=le(Nl,Ap[P0])+z_;if(Xu+E0>mf)break i;for(var q_=B_?A0:0;0<E0--;)k0[Xu++]=q_}}Yp=1;break i}Yp||(S0.a=3),pf=Yp}(pf=pf&&!Al.h)&&(Gp=N(Vp,M_,8,Ls,Gu)),pf&&Gp!=0?gf=Gp:(xa.a=3,gf=0)}if(gf==0)break n;if(Or&&bl[rn]==1&&(Or=ji[xn].g==0),ps+=ji[xn].g,xn+=gf,3>=rn){var Yu,Kp=Ei[0];for(Yu=1;Yu<si;++Yu)Ei[Yu]>Kp&&(Kp=Ei[Yu]);er+=Kp}}if(Vn.nd=Or,Vn.Qb=0,Or&&(Vn.qb=(ts[3][Is[3]+0].value<<24|ts[1][Is[1]+0].value<<16|ts[2][Is[2]+0].value)>>>0,ps==0&&256>ts[0][Is[0]+0].value&&(Vn.Qb=1,Vn.qb+=ts[0][Is[0]+0].value<<8)),Vn.jc=!Vn.Qb&&6>er,Vn.jc){var vf,zo=Vn;for(vf=0;vf<ds;++vf){var Cl=vf,Pl=zo.pd[Cl],yf=zo.G[0][zo.H[0]+Cl];256<=yf.value?(Pl.g=yf.g+256,Pl.value=yf.value):(Pl.g=0,Pl.value=0,Cl>>=qe(yf,8,Pl),Cl>>=qe(zo.G[1][zo.H[1]+Cl],16,Pl),Cl>>=qe(zo.G[2][zo.H[2]+Cl],0,Pl),qe(zo.G[3][zo.H[3]+Cl],24,Pl))}}}ri.vc=fn,ri.Wb=Tn,ri.Ya=es,ri.yc=qi,ft=1;break t}ft=0}if(!(H=ft)){L.a=3;break e}if(0<De){if(oe.ua=1<<De,!K(oe.Wa,De)){L.a=1,H=0;break e}}else oe.ua=0;var Zp=L,I0=Y,j_=ee,Jp=Zp.s,Qp=Jp.xc;if(Zp.c=I0,Zp.i=j_,Jp.md=Ee(I0,Qp),Jp.wc=Qp==0?-1:(1<<Qp)-1,k){L.xb=Op;break e}if((xe=s(Y*ee))==null){L.a=1,H=0;break e}H=(H=Jt(L,xe,0,Y,ee,ee,null))&&!ie.h;break e}return H?(z!=null?z[0]=xe:(e(xe==null),e(k)),L.$=0,k||$t(oe)):$t(oe),H}function ii(g,v){var k=g.c*g.i,L=k+v+16*v;return e(g.c<=v),g.V=s(L),g.V==null?(g.Ta=null,g.Ua=0,g.a=1,0):(g.Ta=g.V,g.Ua=g.Ba+k+v,1)}function kn(g,v){var k=g.C,L=v-k,z=g.V,H=g.Ba+g.c*k;for(e(v<=g.l.o);0<L;){var Y=16<L?16:L,ee=g.l.ma,ie=g.l.width,oe=ie*Y,xe=ee.ca,De=ee.tb+ie*k,ce=g.Ta,_e=g.Ua;Pt(g,Y,z,H),Lo(ce,_e,xe,De,oe),Gt(ee,k,k+Y,xe,De,ie),L-=Y,z+=Y*g.c,k+=Y}e(k==v),g.C=g.Ma=v}function En(){this.ub=this.yd=this.td=this.Rb=0}function Bs(){this.Kd=this.Ld=this.Ud=this.Td=this.i=this.c=0}function oa(){this.Fb=this.Bb=this.Cb=0,this.Zb=s(4),this.Lb=s(4)}function ss(){this.Yb=(function(){var g=[];return(function v(k,L,z){for(var H=z[L],Y=0;Y<H&&(k.push(z.length>L+1?[]:0),!(z.length<L+1));Y++)v(k[Y],L+1,z)})(g,0,[3,11]),g})()}function yr(){this.jb=s(3),this.Wc=o([4,8],ss),this.Xc=o([4,17],ss)}function go(){this.Pc=this.wb=this.Tb=this.zd=0,this.vd=new s(4),this.od=new s(4)}function Ir(){this.ld=this.La=this.dd=this.tc=0}function mo(){this.Na=this.la=0}function xs(){this.Sc=[0,0],this.Eb=[0,0],this.Qc=[0,0],this.ia=this.lc=0}function ir(){this.ad=s(384),this.Za=0,this.Ob=s(16),this.$b=this.Ad=this.ia=this.Gc=this.Hc=this.Dd=0}function vo(){this.uc=this.M=this.Nb=0,this.wa=Array(new Ir),this.Y=0,this.ya=Array(new ir),this.aa=0,this.l=new rr}function cl(){this.y=s(16),this.f=s(8),this.ea=s(8)}function ul(){this.cb=this.a=0,this.sc="",this.m=new F,this.Od=new En,this.Kc=new Bs,this.ed=new go,this.Qa=new oa,this.Ic=this.$c=this.Aa=0,this.D=new vo,this.Xb=this.Va=this.Hb=this.zb=this.yb=this.Ub=this.za=0,this.Jc=a(8,F),this.ia=0,this.pb=a(4,xs),this.Pa=new yr,this.Bd=this.kc=0,this.Ac=[],this.Bc=0,this.zc=[0,0,0,0],this.Gd=Array(new cl),this.Hd=0,this.rb=Array(new mo),this.sb=0,this.wa=Array(new Ir),this.Y=0,this.oc=[],this.pc=0,this.sa=[],this.ta=0,this.qa=[],this.ra=0,this.Ha=[],this.B=this.R=this.Ia=0,this.Ec=[],this.M=this.ja=this.Vb=this.Fc=0,this.ya=Array(new ir),this.L=this.aa=0,this.gd=o([4,2],Ir),this.ga=null,this.Fa=[],this.Cc=this.qc=this.P=0,this.Gb=[],this.Uc=0,this.mb=[],this.nb=0,this.rc=[],this.Ga=this.Vc=0}function Xi(g,v){return 0>g?0:g>v?v:g}function rr(){this.T=this.U=this.ka=this.height=this.width=0,this.y=[],this.f=[],this.ea=[],this.Rc=this.fa=this.W=this.N=this.O=0,this.ma="void",this.put="VP8IoPutHook",this.ac="VP8IoSetupHook",this.bc="VP8IoTeardownHook",this.ha=this.Kb=0,this.data=[],this.hb=this.ib=this.da=this.o=this.j=this.va=this.v=this.Da=this.ob=this.w=0,this.F=[],this.J=0}function ec(){var g=new ul;return g!=null&&(g.a=0,g.sc="OK",g.cb=0,g.Xb=0,uc||(uc=sr)),g}function li(g,v,k){return g.a==0&&(g.a=v,g.sc=k,g.cb=0),0}function la(g,v,k){return 3<=k&&g[v+0]==157&&g[v+1]==1&&g[v+2]==42}function Yi(g,v){if(g==null)return 0;if(g.a=0,g.sc="OK",v==null)return li(g,2,"null VP8Io passed to VP8GetHeaders()");var k=v.data,L=v.w,z=v.ha;if(4>z)return li(g,7,"Truncated header.");var H=k[L+0]|k[L+1]<<8|k[L+2]<<16,Y=g.Od;if(Y.Rb=!(1&H),Y.td=H>>1&7,Y.yd=H>>4&1,Y.ub=H>>5,3<Y.td)return li(g,3,"Incorrect keyframe parameters.");if(!Y.yd)return li(g,4,"Frame not displayable.");L+=3,z-=3;var ee=g.Kc;if(Y.Rb){if(7>z)return li(g,7,"cannot parse picture header");if(!la(k,L,z))return li(g,3,"Bad code word");ee.c=16383&(k[L+4]<<8|k[L+3]),ee.Td=k[L+4]>>6,ee.i=16383&(k[L+6]<<8|k[L+5]),ee.Ud=k[L+6]>>6,L+=7,z-=7,g.za=ee.c+15>>4,g.Ub=ee.i+15>>4,v.width=ee.c,v.height=ee.i,v.Da=0,v.j=0,v.v=0,v.va=v.width,v.o=v.height,v.da=0,v.ib=v.width,v.hb=v.height,v.U=v.width,v.T=v.height,r((H=g.Pa).jb,0,255,H.jb.length),e((H=g.Qa)!=null),H.Cb=0,H.Bb=0,H.Fb=1,r(H.Zb,0,0,H.Zb.length),r(H.Lb,0,0,H.Lb)}if(Y.ub>z)return li(g,7,"bad partition length");q(H=g.m,k,L,Y.ub),L+=Y.ub,z-=Y.ub,Y.Rb&&(ee.Ld=pe(H),ee.Kd=pe(H)),ee=g.Qa;var ie,oe=g.Pa;if(e(H!=null),e(ee!=null),ee.Cb=pe(H),ee.Cb){if(ee.Bb=pe(H),pe(H)){for(ee.Fb=pe(H),ie=0;4>ie;++ie)ee.Zb[ie]=pe(H)?U(H,7):0;for(ie=0;4>ie;++ie)ee.Lb[ie]=pe(H)?U(H,6):0}if(ee.Bb)for(ie=0;3>ie;++ie)oe.jb[ie]=pe(H)?Z(H,8):255}else ee.Bb=0;if(H.Ka)return li(g,3,"cannot parse segment header");if((ee=g.ed).zd=pe(H),ee.Tb=Z(H,6),ee.wb=Z(H,3),ee.Pc=pe(H),ee.Pc&&pe(H)){for(oe=0;4>oe;++oe)pe(H)&&(ee.vd[oe]=U(H,6));for(oe=0;4>oe;++oe)pe(H)&&(ee.od[oe]=U(H,6))}if(g.L=ee.Tb==0?0:ee.zd?1:2,H.Ka)return li(g,3,"cannot parse filter header");var xe=z;if(z=ie=L,L=ie+xe,ee=xe,g.Xb=(1<<Z(g.m,2))-1,xe<3*(oe=g.Xb))k=7;else{for(ie+=3*oe,ee-=3*oe,xe=0;xe<oe;++xe){var De=k[z+0]|k[z+1]<<8|k[z+2]<<16;De>ee&&(De=ee),q(g.Jc[+xe],k,ie,De),ie+=De,ee-=De,z+=3}q(g.Jc[+oe],k,ie,ee),k=ie<L?0:5}if(k!=0)return li(g,k,"cannot parse partitions");for(k=Z(ie=g.m,7),z=pe(ie)?U(ie,4):0,L=pe(ie)?U(ie,4):0,ee=pe(ie)?U(ie,4):0,oe=pe(ie)?U(ie,4):0,ie=pe(ie)?U(ie,4):0,xe=g.Qa,De=0;4>De;++De){if(xe.Cb){var ce=xe.Zb[De];xe.Fb||(ce+=k)}else{if(0<De){g.pb[De]=g.pb[0];continue}ce=k}var _e=g.pb[De];_e.Sc[0]=Xa[Xi(ce+z,127)],_e.Sc[1]=Ya[Xi(ce+0,127)],_e.Eb[0]=2*Xa[Xi(ce+L,127)],_e.Eb[1]=101581*Ya[Xi(ce+ee,127)]>>16,8>_e.Eb[1]&&(_e.Eb[1]=8),_e.Qc[0]=Xa[Xi(ce+oe,117)],_e.Qc[1]=Ya[Xi(ce+ie,127)],_e.lc=ce+ie}if(!Y.Rb)return li(g,4,"Not a key frame.");for(pe(H),Y=g.Pa,k=0;4>k;++k){for(z=0;8>z;++z)for(L=0;3>L;++L)for(ee=0;11>ee;++ee)oe=ge(H,Tp[k][z][L][ee])?Z(H,8):xl[k][z][L][ee],Y.Wc[k][z].Yb[L][ee]=oe;for(z=0;17>z;++z)Y.Xc[k][z]=Y.Wc[k][Dp[z]]}return g.kc=pe(H),g.kc&&(g.Bd=Z(H,8)),g.cb=1}function sr(g,v,k,L,z,H,Y){var ee=v[z].Yb[k];for(k=0;16>z;++z){if(!ge(g,ee[k+0]))return z;for(;!ge(g,ee[k+1]);)if(ee=v[++z].Yb[0],k=0,z==16)return 16;var ie=v[z+1].Yb;if(ge(g,ee[k+2])){var oe=g,xe=0;if(ge(oe,(ce=ee)[(De=k)+3]))if(ge(oe,ce[De+6])){for(ee=0,De=2*(xe=ge(oe,ce[De+8]))+(ce=ge(oe,ce[De+9+xe])),xe=0,ce=Ip[De];ce[ee];++ee)xe+=xe+ge(oe,ce[ee]);xe+=3+(8<<De)}else ge(oe,ce[De+7])?(xe=7+2*ge(oe,165),xe+=ge(oe,145)):xe=5+ge(oe,159);else xe=ge(oe,ce[De+4])?3+ge(oe,ce[De+5]):2;ee=ie[2]}else xe=1,ee=ie[1];ie=Y+Lp[z],0>(oe=g).b&&ue(oe);var De,ce=oe.b,_e=(De=oe.Ca>>1)-(oe.I>>ce)>>31;--oe.b,oe.Ca+=_e,oe.Ca|=1,oe.I-=(De+1&_e)<<ce,H[ie]=((xe^_e)-_e)*L[(0<z)+0]}return 16}function Ta(g){var v=g.rb[g.sb-1];v.la=0,v.Na=0,r(g.zc,0,0,g.zc.length),g.ja=0}function Ni(g,v,k,L,z){z=g[v+k+32*L]+(z>>3),g[v+k+32*L]=-256&z?0>z?0:255:z}function ui(g,v,k,L,z,H){Ni(g,v,0,k,L+z),Ni(g,v,1,k,L+H),Ni(g,v,2,k,L-H),Ni(g,v,3,k,L-z)}function ar(g){return(20091*g>>16)+g}function or(g,v,k,L){var z,H=0,Y=s(16);for(z=0;4>z;++z){var ee=g[v+0]+g[v+8],ie=g[v+0]-g[v+8],oe=(35468*g[v+4]>>16)-ar(g[v+12]),xe=ar(g[v+4])+(35468*g[v+12]>>16);Y[H+0]=ee+xe,Y[H+1]=ie+oe,Y[H+2]=ie-oe,Y[H+3]=ee-xe,H+=4,v++}for(z=H=0;4>z;++z)ee=(g=Y[H+0]+4)+Y[H+8],ie=g-Y[H+8],oe=(35468*Y[H+4]>>16)-ar(Y[H+12]),Ni(k,L,0,0,ee+(xe=ar(Y[H+4])+(35468*Y[H+12]>>16))),Ni(k,L,1,0,ie+oe),Ni(k,L,2,0,ie-oe),Ni(k,L,3,0,ee-xe),H++,L+=32}function dl(g,v,k,L){var z=g[v+0]+4,H=35468*g[v+4]>>16,Y=ar(g[v+4]),ee=35468*g[v+1]>>16;ui(k,L,0,z+Y,g=ar(g[v+1]),ee),ui(k,L,1,z+H,g,ee),ui(k,L,2,z-H,g,ee),ui(k,L,3,z-Y,g,ee)}function tc(g,v,k,L,z){or(g,v,k,L),z&&or(g,v+16,k,L+4)}function lr(g,v,k,L){fs(g,v+0,k,L,1),fs(g,v+32,k,L+128,1)}function as(g,v,k,L){var z;for(g=g[v+0]+4,z=0;4>z;++z)for(v=0;4>v;++v)Ni(k,L,v,z,g)}function _s(g,v,k,L){g[v+0]&&In(g,v+0,k,L),g[v+16]&&In(g,v+16,k,L+4),g[v+32]&&In(g,v+32,k,L+128),g[v+48]&&In(g,v+48,k,L+128+4)}function zs(g,v,k,L){var z,H=s(16);for(z=0;4>z;++z){var Y=g[v+0+z]+g[v+12+z],ee=g[v+4+z]+g[v+8+z],ie=g[v+4+z]-g[v+8+z],oe=g[v+0+z]-g[v+12+z];H[0+z]=Y+ee,H[8+z]=Y-ee,H[4+z]=oe+ie,H[12+z]=oe-ie}for(z=0;4>z;++z)Y=(g=H[0+4*z]+3)+H[3+4*z],ee=H[1+4*z]+H[2+4*z],ie=H[1+4*z]-H[2+4*z],oe=g-H[3+4*z],k[L+0]=Y+ee>>3,k[L+16]=oe+ie>>3,k[L+32]=Y-ee>>3,k[L+48]=oe-ie>>3,L+=64}function Lr(g,v,k){var L,z=v-32,H=Zr,Y=255-g[z-1];for(L=0;L<k;++L){var ee,ie=H,oe=Y+g[v-1];for(ee=0;ee<k;++ee)g[v+ee]=ie[oe+g[z+ee]];v+=32}}function fl(g,v){Lr(g,v,4)}function qs(g,v){Lr(g,v,8)}function Mr(g,v){Lr(g,v,16)}function Da(g,v){var k;for(k=0;16>k;++k)i(g,v+32*k,g,v-32,16)}function hl(g,v){var k;for(k=16;0<k;--k)r(g,v,g[v-1],16),v+=32}function br(g,v,k){var L;for(L=0;16>L;++L)r(v,k+32*L,g,16)}function Tr(g,v){var k,L=16;for(k=0;16>k;++k)L+=g[v-1+32*k]+g[v+k-32];br(L>>5,g,v)}function wr(g,v){var k,L=8;for(k=0;16>k;++k)L+=g[v-1+32*k];br(L>>4,g,v)}function yo(g,v){var k,L=8;for(k=0;16>k;++k)L+=g[v+k-32];br(L>>4,g,v)}function pl(g,v){br(128,g,v)}function Yt(g,v,k){return g+2*v+k+2>>2}function Ss(g,v){var k,L=v-32;for(L=new Uint8Array([Yt(g[L-1],g[L+0],g[L+1]),Yt(g[L+0],g[L+1],g[L+2]),Yt(g[L+1],g[L+2],g[L+3]),Yt(g[L+2],g[L+3],g[L+4])]),k=0;4>k;++k)i(g,v+32*k,L,0,L.length)}function js(g,v){var k=g[v-1],L=g[v-1+32],z=g[v-1+64],H=g[v-1+96];me(g,v+0,16843009*Yt(g[v-1-32],k,L)),me(g,v+32,16843009*Yt(k,L,z)),me(g,v+64,16843009*Yt(L,z,H)),me(g,v+96,16843009*Yt(z,H,H))}function Oa(g,v){var k,L=4;for(k=0;4>k;++k)L+=g[v+k-32]+g[v-1+32*k];for(L>>=3,k=0;4>k;++k)r(g,v+32*k,L,4)}function ks(g,v){var k=g[v-1+0],L=g[v-1+32],z=g[v-1+64],H=g[v-1-32],Y=g[v+0-32],ee=g[v+1-32],ie=g[v+2-32],oe=g[v+3-32];g[v+0+96]=Yt(L,z,g[v-1+96]),g[v+1+96]=g[v+0+64]=Yt(k,L,z),g[v+2+96]=g[v+1+64]=g[v+0+32]=Yt(H,k,L),g[v+3+96]=g[v+2+64]=g[v+1+32]=g[v+0+0]=Yt(Y,H,k),g[v+3+64]=g[v+2+32]=g[v+1+0]=Yt(ee,Y,H),g[v+3+32]=g[v+2+0]=Yt(ie,ee,Y),g[v+3+0]=Yt(oe,ie,ee)}function os(g,v){var k=g[v+1-32],L=g[v+2-32],z=g[v+3-32],H=g[v+4-32],Y=g[v+5-32],ee=g[v+6-32],ie=g[v+7-32];g[v+0+0]=Yt(g[v+0-32],k,L),g[v+1+0]=g[v+0+32]=Yt(k,L,z),g[v+2+0]=g[v+1+32]=g[v+0+64]=Yt(L,z,H),g[v+3+0]=g[v+2+32]=g[v+1+64]=g[v+0+96]=Yt(z,H,Y),g[v+3+32]=g[v+2+64]=g[v+1+96]=Yt(H,Y,ee),g[v+3+64]=g[v+2+96]=Yt(Y,ee,ie),g[v+3+96]=Yt(ee,ie,ie)}function Hs(g,v){var k=g[v-1+0],L=g[v-1+32],z=g[v-1+64],H=g[v-1-32],Y=g[v+0-32],ee=g[v+1-32],ie=g[v+2-32],oe=g[v+3-32];g[v+0+0]=g[v+1+64]=H+Y+1>>1,g[v+1+0]=g[v+2+64]=Y+ee+1>>1,g[v+2+0]=g[v+3+64]=ee+ie+1>>1,g[v+3+0]=ie+oe+1>>1,g[v+0+96]=Yt(z,L,k),g[v+0+64]=Yt(L,k,H),g[v+0+32]=g[v+1+96]=Yt(k,H,Y),g[v+1+32]=g[v+2+96]=Yt(H,Y,ee),g[v+2+32]=g[v+3+96]=Yt(Y,ee,ie),g[v+3+32]=Yt(ee,ie,oe)}function As(g,v){var k=g[v+0-32],L=g[v+1-32],z=g[v+2-32],H=g[v+3-32],Y=g[v+4-32],ee=g[v+5-32],ie=g[v+6-32],oe=g[v+7-32];g[v+0+0]=k+L+1>>1,g[v+1+0]=g[v+0+64]=L+z+1>>1,g[v+2+0]=g[v+1+64]=z+H+1>>1,g[v+3+0]=g[v+2+64]=H+Y+1>>1,g[v+0+32]=Yt(k,L,z),g[v+1+32]=g[v+0+96]=Yt(L,z,H),g[v+2+32]=g[v+1+96]=Yt(z,H,Y),g[v+3+32]=g[v+2+96]=Yt(H,Y,ee),g[v+3+64]=Yt(Y,ee,ie),g[v+3+96]=Yt(ee,ie,oe)}function Fa(g,v){var k=g[v-1+0],L=g[v-1+32],z=g[v-1+64],H=g[v-1+96];g[v+0+0]=k+L+1>>1,g[v+2+0]=g[v+0+32]=L+z+1>>1,g[v+2+32]=g[v+0+64]=z+H+1>>1,g[v+1+0]=Yt(k,L,z),g[v+3+0]=g[v+1+32]=Yt(L,z,H),g[v+3+32]=g[v+1+64]=Yt(z,H,H),g[v+3+64]=g[v+2+64]=g[v+0+96]=g[v+1+96]=g[v+2+96]=g[v+3+96]=H}function Ra(g,v){var k=g[v-1+0],L=g[v-1+32],z=g[v-1+64],H=g[v-1+96],Y=g[v-1-32],ee=g[v+0-32],ie=g[v+1-32],oe=g[v+2-32];g[v+0+0]=g[v+2+32]=k+Y+1>>1,g[v+0+32]=g[v+2+64]=L+k+1>>1,g[v+0+64]=g[v+2+96]=z+L+1>>1,g[v+0+96]=H+z+1>>1,g[v+3+0]=Yt(ee,ie,oe),g[v+2+0]=Yt(Y,ee,ie),g[v+1+0]=g[v+3+32]=Yt(k,Y,ee),g[v+1+32]=g[v+3+64]=Yt(L,k,Y),g[v+1+64]=g[v+3+96]=Yt(z,L,k),g[v+1+96]=Yt(H,z,L)}function ca(g,v){var k;for(k=0;8>k;++k)i(g,v+32*k,g,v-32,8)}function Ns(g,v){var k;for(k=0;8>k;++k)r(g,v,g[v-1],8),v+=32}function cr(g,v,k){var L;for(L=0;8>L;++L)r(v,k+32*L,g,8)}function gl(g,v){var k,L=8;for(k=0;8>k;++k)L+=g[v+k-32]+g[v-1+32*k];cr(L>>4,g,v)}function bo(g,v){var k,L=4;for(k=0;8>k;++k)L+=g[v+k-32];cr(L>>3,g,v)}function Ba(g,v){var k,L=4;for(k=0;8>k;++k)L+=g[v-1+32*k];cr(L>>3,g,v)}function Cs(g,v){cr(128,g,v)}function Ki(g,v,k){var L=g[v-k],z=g[v+0],H=3*(z-L)+Hu[1020+g[v-2*k]-g[v+k]],Y=Hc[112+(H+4>>3)];g[v-k]=Zr[255+L+Hc[112+(H+3>>3)]],g[v+0]=Zr[255+z-Y]}function wo(g,v,k,L){var z=g[v+0],H=g[v+k];return Qi[255+g[v-2*k]-g[v-k]]>L||Qi[255+H-z]>L}function ua(g,v,k,L){return 4*Qi[255+g[v-k]-g[v+0]]+Qi[255+g[v-2*k]-g[v+k]]<=L}function za(g,v,k,L,z){var H=g[v-3*k],Y=g[v-2*k],ee=g[v-k],ie=g[v+0],oe=g[v+k],xe=g[v+2*k],De=g[v+3*k];return 4*Qi[255+ee-ie]+Qi[255+Y-oe]>L?0:Qi[255+g[v-4*k]-H]<=z&&Qi[255+H-Y]<=z&&Qi[255+Y-ee]<=z&&Qi[255+De-xe]<=z&&Qi[255+xe-oe]<=z&&Qi[255+oe-ie]<=z}function xr(g,v,k,L){var z=2*L+1;for(L=0;16>L;++L)ua(g,v+L,k,z)&&Ki(g,v+L,k)}function Wr(g,v,k,L){var z=2*L+1;for(L=0;16>L;++L)ua(g,v+L*k,1,z)&&Ki(g,v+L*k,1)}function xo(g,v,k,L){var z;for(z=3;0<z;--z)xr(g,v+=4*k,k,L)}function _o(g,v,k,L){var z;for(z=3;0<z;--z)Wr(g,v+=4,k,L)}function ls(g,v,k,L,z,H,Y,ee){for(H=2*H+1;0<z--;){if(za(g,v,k,H,Y))if(wo(g,v,k,ee))Ki(g,v,k);else{var ie=g,oe=v,xe=k,De=ie[oe-2*xe],ce=ie[oe-xe],_e=ie[oe+0],Ne=ie[oe+xe],je=ie[oe+2*xe],Me=27*(Xe=Hu[1020+3*(_e-ce)+Hu[1020+De-Ne]])+63>>7,Ve=18*Xe+63>>7,Xe=9*Xe+63>>7;ie[oe-3*xe]=Zr[255+ie[oe-3*xe]+Xe],ie[oe-2*xe]=Zr[255+De+Ve],ie[oe-xe]=Zr[255+ce+Me],ie[oe+0]=Zr[255+_e-Me],ie[oe+xe]=Zr[255+Ne-Ve],ie[oe+2*xe]=Zr[255+je-Xe]}v+=L}}function Zi(g,v,k,L,z,H,Y,ee){for(H=2*H+1;0<z--;){if(za(g,v,k,H,Y))if(wo(g,v,k,ee))Ki(g,v,k);else{var ie=g,oe=v,xe=k,De=ie[oe-xe],ce=ie[oe+0],_e=ie[oe+xe],Ne=Hc[112+(4+(je=3*(ce-De))>>3)],je=Hc[112+(je+3>>3)],Me=Ne+1>>1;ie[oe-2*xe]=Zr[255+ie[oe-2*xe]+Me],ie[oe-xe]=Zr[255+De+je],ie[oe+0]=Zr[255+ce-Ne],ie[oe+xe]=Zr[255+_e-Me]}v+=L}}function cs(g,v,k,L,z,H){ls(g,v,k,1,16,L,z,H)}function da(g,v,k,L,z,H){ls(g,v,1,k,16,L,z,H)}function ml(g,v,k,L,z,H){var Y;for(Y=3;0<Y;--Y)Zi(g,v+=4*k,k,1,16,L,z,H)}function b(g,v,k,L,z,H){var Y;for(Y=3;0<Y;--Y)Zi(g,v+=4,1,k,16,L,z,H)}function P(g,v,k,L,z,H,Y,ee){ls(g,v,z,1,8,H,Y,ee),ls(k,L,z,1,8,H,Y,ee)}function J(g,v,k,L,z,H,Y,ee){ls(g,v,1,z,8,H,Y,ee),ls(k,L,1,z,8,H,Y,ee)}function fe(g,v,k,L,z,H,Y,ee){Zi(g,v+4*z,z,1,8,H,Y,ee),Zi(k,L+4*z,z,1,8,H,Y,ee)}function ye(g,v,k,L,z,H,Y,ee){Zi(g,v+4,1,z,8,H,Y,ee),Zi(k,L+4,1,z,8,H,Y,ee)}function Te(){this.ba=new xt,this.ec=[],this.cc=[],this.Mc=[],this.Dc=this.Nc=this.dc=this.fc=0,this.Oa=new Ut,this.memory=0,this.Ib="OutputFunc",this.Jb="OutputAlphaFunc",this.Nd="OutputRowFunc"}function We(){this.data=[],this.offset=this.kd=this.ha=this.w=0,this.na=[],this.xa=this.gb=this.Ja=this.Sa=this.P=0}function pt(){this.nc=this.Ea=this.b=this.hc=0,this.K=[],this.w=0}function ht(){this.ua=0,this.Wa=new Ke,this.vb=new Ke,this.md=this.xc=this.wc=0,this.vc=[],this.Wb=0,this.Ya=new R,this.yc=new B}function Rt(){this.xb=this.a=0,this.l=new rr,this.ca=new xt,this.V=[],this.Ba=0,this.Ta=[],this.Ua=0,this.m=new V,this.Pb=0,this.wd=new V,this.Ma=this.$=this.C=this.i=this.c=this.xd=0,this.s=new ht,this.ab=0,this.gc=a(4,pt),this.Oc=0}function jt(){this.Lc=this.Z=this.$a=this.i=this.c=0,this.l=new rr,this.ic=0,this.ca=[],this.tb=0,this.qd=null,this.rd=0}function Vt(g,v,k,L,z,H,Y){for(g=g==null?0:g[v+0],v=0;v<Y;++v)z[H+v]=g+k[L+v]&255,g=z[H+v]}function _t(g,v,k,L,z,H,Y){var ee;if(g==null)Vt(null,null,k,L,z,H,Y);else for(ee=0;ee<Y;++ee)z[H+ee]=g[v+ee]+k[L+ee]&255}function hn(g,v,k,L,z,H,Y){if(g==null)Vt(null,null,k,L,z,H,Y);else{var ee,ie=g[v+0],oe=ie,xe=ie;for(ee=0;ee<Y;++ee)oe=xe+(ie=g[v+ee])-oe,xe=k[L+ee]+(-256&oe?0>oe?0:255:oe)&255,oe=ie,z[H+ee]=xe}}function gn(g,v,k,L){var z=v.width,H=v.o;if(e(g!=null&&v!=null),0>k||0>=L||k+L>H)return null;if(!g.Cc){if(g.ga==null){var Y;if(g.ga=new jt,(Y=g.ga==null)||(Y=v.width*v.o,e(g.Gb.length==0),g.Gb=s(Y),g.Uc=0,g.Gb==null?Y=0:(g.mb=g.Gb,g.nb=g.Uc,g.rc=null,Y=1),Y=!Y),!Y){Y=g.ga;var ee=g.Fa,ie=g.P,oe=g.qc,xe=g.mb,De=g.nb,ce=ie+1,_e=oe-1,Ne=Y.l;if(e(ee!=null&&xe!=null&&v!=null),Qr[0]=null,Qr[1]=Vt,Qr[2]=_t,Qr[3]=hn,Y.ca=xe,Y.tb=De,Y.c=v.width,Y.i=v.height,e(0<Y.c&&0<Y.i),1>=oe)v=0;else if(Y.$a=3&ee[ie+0],Y.Z=ee[ie+0]>>2&3,Y.Lc=ee[ie+0]>>4&3,ie=ee[ie+0]>>6&3,0>Y.$a||1<Y.$a||4<=Y.Z||1<Y.Lc||ie)v=0;else if(Ne.put=Ct,Ne.ac=ni,Ne.bc=oi,Ne.ma=Y,Ne.width=v.width,Ne.height=v.height,Ne.Da=v.Da,Ne.v=v.v,Ne.va=v.va,Ne.j=v.j,Ne.o=v.o,Y.$a)e:{e(Y.$a==1),v=wn();t:for(;;){if(v==null){v=0;break e}if(e(Y!=null),Y.mc=v,v.c=Y.c,v.i=Y.i,v.l=Y.l,v.l.ma=Y,v.l.width=Y.c,v.l.height=Y.i,v.a=0,X(v.m,ee,ce,_e),!en(Y.c,Y.i,1,v,null)||(v.ab==1&&v.gc[0].hc==3&&Wt(v.s)?(Y.ic=1,ee=v.c*v.i,v.Ta=null,v.Ua=0,v.V=s(ee),v.Ba=0,v.V==null?(v.a=1,v=0):v=1):(Y.ic=0,v=ii(v,Y.c)),!v))break t;v=1;break e}Y.mc=null,v=0}else v=_e>=Y.c*Y.i;Y=!v}if(Y)return null;g.ga.Lc!=1?g.Ga=0:L=H-k}e(g.ga!=null),e(k+L<=H);e:{if(v=(ee=g.ga).c,H=ee.l.o,ee.$a==0){if(ce=g.rc,_e=g.Vc,Ne=g.Fa,ie=g.P+1+k*v,oe=g.mb,xe=g.nb+k*v,e(ie<=g.P+g.qc),ee.Z!=0)for(e(Qr[ee.Z]!=null),Y=0;Y<L;++Y)Qr[ee.Z](ce,_e,Ne,ie,oe,xe,v),ce=oe,_e=xe,xe+=v,ie+=v;else for(Y=0;Y<L;++Y)i(oe,xe,Ne,ie,v),ce=oe,_e=xe,xe+=v,ie+=v;g.rc=ce,g.Vc=_e}else{if(e(ee.mc!=null),v=k+L,e((Y=ee.mc)!=null),e(v<=Y.i),Y.C>=v)v=1;else if(ee.ic||Kn(),ee.ic){ee=Y.V,ce=Y.Ba,_e=Y.c;var je=Y.i,Me=(Ne=1,ie=Y.$/_e,oe=Y.$%_e,xe=Y.m,De=Y.s,Y.$),Ve=_e*je,Xe=_e*v,tt=De.wc,Qe=Me<Xe?$e(De,oe,ie):null;e(Me<=Ve),e(v<=je),e(Wt(De));t:for(;;){for(;!xe.h&&Me<Xe;){if(oe&tt||(Qe=$e(De,oe,ie)),e(Qe!=null),te(xe),256>(je=Pn(Qe.G[0],Qe.H[0],xe)))ee[ce+Me]=je,++Me,++oe>=_e&&(oe=0,++ie<=v&&!(ie%16)&&Dt(Y,ie));else{if(!(280>je)){Ne=0;break t}je=Sn(je-256,xe);var zt,At=Pn(Qe.G[4],Qe.H[4],xe);if(te(xe),!(Me>=(At=Mn(_e,At=Sn(At,xe)))&&Ve-Me>=je)){Ne=0;break t}for(zt=0;zt<je;++zt)ee[ce+Me+zt]=ee[ce+Me+zt-At];for(Me+=je,oe+=je;oe>=_e;)oe-=_e,++ie<=v&&!(ie%16)&&Dt(Y,ie);Me<Xe&&oe&tt&&(Qe=$e(De,oe,ie))}e(xe.h==se(xe))}Dt(Y,ie>v?v:ie);break t}!Ne||xe.h&&Me<Ve?(Ne=0,Y.a=xe.h?5:3):Y.$=Me,v=Ne}else v=Jt(Y,Y.V,Y.Ba,Y.c,Y.i,v,kn);if(!v){L=0;break e}}k+L>=H&&(g.Cc=1),L=1}if(!L)return null;if(g.Cc&&((L=g.ga)!=null&&(L.mc=null),g.ga=null,0<g.Ga))return alert("todo:WebPDequantizeLevels"),null}return g.nb+k*z}function dn(g,v,k,L,z,H){for(;0<z--;){var Y,ee=g,ie=v+(k?1:0),oe=g,xe=v+(k?0:3);for(Y=0;Y<L;++Y){var De=oe[xe+4*Y];De!=255&&(De*=32897,ee[ie+4*Y+0]=ee[ie+4*Y+0]*De>>23,ee[ie+4*Y+1]=ee[ie+4*Y+1]*De>>23,ee[ie+4*Y+2]=ee[ie+4*Y+2]*De>>23)}v+=H}}function mn(g,v,k,L,z){for(;0<L--;){var H;for(H=0;H<k;++H){var Y=g[v+2*H+0],ee=15&(oe=g[v+2*H+1]),ie=4369*ee,oe=(240&oe|oe>>4)*ie>>16;g[v+2*H+0]=(240&Y|Y>>4)*ie>>16&240|(15&Y|Y<<4)*ie>>16>>4&15,g[v+2*H+1]=240&oe|ee}v+=z}}function zn(g,v,k,L,z,H,Y,ee){var ie,oe,xe=255;for(oe=0;oe<z;++oe){for(ie=0;ie<L;++ie){var De=g[v+ie];H[Y+4*ie]=De,xe&=De}v+=k,Y+=ee}return xe!=255}function Bi(g,v,k,L,z){var H;for(H=0;H<z;++H)k[L+H]=g[v+H]>>8}function Kn(){cc=dn,nf=mn,Io=zn,Lo=Bi}function ur(g,v,k){O[g]=function(L,z,H,Y,ee,ie,oe,xe,De,ce,_e,Ne,je,Me,Ve,Xe,tt){var Qe,zt=tt-1>>1,At=ee[ie+0]|oe[xe+0]<<16,on=De[ce+0]|_e[Ne+0]<<16;e(L!=null);var St=3*At+on+131074>>2;for(v(L[z+0],255&St,St>>16,je,Me),H!=null&&(St=3*on+At+131074>>2,v(H[Y+0],255&St,St>>16,Ve,Xe)),Qe=1;Qe<=zt;++Qe){var un=ee[ie+Qe]|oe[xe+Qe]<<16,Pi=De[ce+Qe]|_e[Ne+Qe]<<16,ln=At+un+on+Pi+524296,Lt=ln+2*(un+on)>>3;St=Lt+At>>1,At=(ln=ln+2*(At+Pi)>>3)+un>>1,v(L[z+2*Qe-1],255&St,St>>16,je,Me+(2*Qe-1)*k),v(L[z+2*Qe-0],255&At,At>>16,je,Me+(2*Qe-0)*k),H!=null&&(St=ln+on>>1,At=Lt+Pi>>1,v(H[Y+2*Qe-1],255&St,St>>16,Ve,Xe+(2*Qe-1)*k),v(H[Y+2*Qe+0],255&At,At>>16,Ve,Xe+(2*Qe+0)*k)),At=un,on=Pi}1&tt||(St=3*At+on+131074>>2,v(L[z+tt-1],255&St,St>>16,je,Me+(tt-1)*k),H!=null&&(St=3*on+At+131074>>2,v(H[Y+tt-1],255&St,St>>16,Ve,Xe+(tt-1)*k)))}}function Us(){$i[ma]=Fp,$i[Uc]=df,$i[of]=Rp,$i[Wc]=Oo,$i[va]=Fo,$i[Va]=ff,$i[lf]=Bp,$i[Uu]=df,$i[Wu]=Oo,$i[ya]=Fo,$i[Ga]=ff}function Ps(g){return g&-16384?0>g?0:255:g>>zp}function qa(g,v){return Ps((19077*g>>8)+(26149*v>>8)-14234)}function So(g,v,k){return Ps((19077*g>>8)-(6419*v>>8)-(13320*k>>8)+8708)}function ko(g,v){return Ps((19077*g>>8)+(33050*v>>8)-17685)}function Vr(g,v,k,L,z){L[z+0]=qa(g,k),L[z+1]=So(g,v,k),L[z+2]=ko(g,v)}function di(g,v,k,L,z){L[z+0]=ko(g,v),L[z+1]=So(g,v,k),L[z+2]=qa(g,k)}function Ao(g,v,k,L,z){var H=So(g,v,k);v=H<<3&224|ko(g,v)>>3,L[z+0]=248&qa(g,k)|H>>5,L[z+1]=v}function No(g,v,k,L,z){var H=240&ko(g,v)|15;L[z+0]=240&qa(g,k)|So(g,v,k)>>4,L[z+1]=H}function nc(g,v,k,L,z){L[z+0]=255,Vr(g,v,k,L,z+1)}function Ws(g,v,k,L,z){di(g,v,k,L,z),L[z+3]=255}function xi(g,v,k,L,z){Vr(g,v,k,L,z),L[z+3]=255}function fa(g,v,k){O[g]=function(L,z,H,Y,ee,ie,oe,xe,De){for(var ce=xe+(-2&De)*k;xe!=ce;)v(L[z+0],H[Y+0],ee[ie+0],oe,xe),v(L[z+1],H[Y+0],ee[ie+0],oe,xe+k),z+=2,++Y,++ie,xe+=2*k;1&De&&v(L[z+0],H[Y+0],ee[ie+0],oe,xe)}}function vl(g,v,k){return k==0?g==0?v==0?6:5:v==0?4:0:k}function qc(g,v,k,L,z){switch(g>>>30){case 3:fs(v,k,L,z,0);break;case 2:hs(v,k,L,z);break;case 1:In(v,k,L,z)}}function Ji(g,v){var k,L,z=v.M,H=v.Nb,Y=g.oc,ee=g.pc+40,ie=g.oc,oe=g.pc+584,xe=g.oc,De=g.pc+600;for(k=0;16>k;++k)Y[ee+32*k-1]=129;for(k=0;8>k;++k)ie[oe+32*k-1]=129,xe[De+32*k-1]=129;for(0<z?Y[ee-1-32]=ie[oe-1-32]=xe[De-1-32]=129:(r(Y,ee-32-1,127,21),r(ie,oe-32-1,127,9),r(xe,De-32-1,127,9)),L=0;L<g.za;++L){var ce=v.ya[v.aa+L];if(0<L){for(k=-1;16>k;++k)i(Y,ee+32*k-4,Y,ee+32*k+12,4);for(k=-1;8>k;++k)i(ie,oe+32*k-4,ie,oe+32*k+4,4),i(xe,De+32*k-4,xe,De+32*k+4,4)}var _e=g.Gd,Ne=g.Hd+L,je=ce.ad,Me=ce.Hc;if(0<z&&(i(Y,ee-32,_e[Ne].y,0,16),i(ie,oe-32,_e[Ne].f,0,8),i(xe,De-32,_e[Ne].ea,0,8)),ce.Za){var Ve=Y,Xe=ee-32+16;for(0<z&&(L>=g.za-1?r(Ve,Xe,_e[Ne].y[15],4):i(Ve,Xe,_e[Ne+1].y,0,4)),k=0;4>k;k++)Ve[Xe+128+k]=Ve[Xe+256+k]=Ve[Xe+384+k]=Ve[Xe+0+k];for(k=0;16>k;++k,Me<<=2)Ve=Y,Xe=ee+Ro[k],dr[ce.Ob[k]](Ve,Xe),qc(Me,je,16*+k,Ve,Xe)}else if(Ve=vl(L,z,ce.Ob[0]),Jr[Ve](Y,ee),Me!=0)for(k=0;16>k;++k,Me<<=2)qc(Me,je,16*+k,Y,ee+Ro[k]);for(k=ce.Gc,Ve=vl(L,z,ce.Dd),ba[Ve](ie,oe),ba[Ve](xe,De),Me=je,Ve=ie,Xe=oe,255&(ce=0|k)&&(170&ce?Xs(Me,256,Ve,Xe):An(Me,256,Ve,Xe)),ce=xe,Me=De,255&(k>>=8)&&(170&k?Xs(je,320,ce,Me):An(je,320,ce,Me)),z<g.Ub-1&&(i(_e[Ne].y,0,Y,ee+480,16),i(_e[Ne].f,0,ie,oe+224,8),i(_e[Ne].ea,0,xe,De+224,8)),k=8*H*g.B,_e=g.sa,Ne=g.ta+16*L+16*H*g.R,je=g.qa,ce=g.ra+8*L+k,Me=g.Ha,Ve=g.Ia+8*L+k,k=0;16>k;++k)i(_e,Ne+k*g.R,Y,ee+32*k,16);for(k=0;8>k;++k)i(je,ce+k*g.B,ie,oe+32*k,8),i(Me,Ve+k*g.B,xe,De+32*k,8)}}function us(g,v,k,L,z,H,Y,ee,ie){var oe=[0],xe=[0],De=0,ce=ie!=null?ie.kd:0,_e=ie??new We;if(g==null||12>k)return 7;_e.data=g,_e.w=v,_e.ha=k,v=[v],k=[k],_e.gb=[_e.gb];e:{var Ne=v,je=k,Me=_e.gb;if(e(g!=null),e(je!=null),e(Me!=null),Me[0]=0,12<=je[0]&&!n(g,Ne[0],"RIFF")){if(n(g,Ne[0]+8,"WEBP")){Me=3;break e}var Ve=Ge(g,Ne[0]+4);if(12>Ve||4294967286<Ve){Me=3;break e}if(ce&&Ve>je[0]-8){Me=7;break e}Me[0]=Ve,Ne[0]+=12,je[0]-=12}Me=0}if(Me!=0)return Me;for(Ve=0<_e.gb[0],k=k[0];;){e:{var Xe=g;je=v,Me=k;var tt=oe,Qe=xe,zt=Ne=[0];if((St=De=[De])[0]=0,8>Me[0])Me=7;else{if(!n(Xe,je[0],"VP8X")){if(Ge(Xe,je[0]+4)!=10){Me=3;break e}if(18>Me[0]){Me=7;break e}var At=Ge(Xe,je[0]+8),on=1+ke(Xe,je[0]+12);if(2147483648<=on*(Xe=1+ke(Xe,je[0]+15))){Me=3;break e}zt!=null&&(zt[0]=At),tt!=null&&(tt[0]=on),Qe!=null&&(Qe[0]=Xe),je[0]+=18,Me[0]-=18,St[0]=1}Me=0}}if(De=De[0],Ne=Ne[0],Me!=0)return Me;if(je=!!(2&Ne),!Ve&&De)return 3;if(H!=null&&(H[0]=!!(16&Ne)),Y!=null&&(Y[0]=je),ee!=null&&(ee[0]=0),Y=oe[0],Ne=xe[0],De&&je&&ie==null){Me=0;break}if(4>k){Me=7;break}if(Ve&&De||!Ve&&!De&&!n(g,v[0],"ALPH")){k=[k],_e.na=[_e.na],_e.P=[_e.P],_e.Sa=[_e.Sa];e:{At=g,Me=v,Ve=k;var St=_e.gb;tt=_e.na,Qe=_e.P,zt=_e.Sa,on=22,e(At!=null),e(Ve!=null),Xe=Me[0];var un=Ve[0];for(e(tt!=null),e(zt!=null),tt[0]=null,Qe[0]=null,zt[0]=0;;){if(Me[0]=Xe,Ve[0]=un,8>un){Me=7;break e}var Pi=Ge(At,Xe+4);if(4294967286<Pi){Me=3;break e}var ln=8+Pi+1&-2;if(on+=ln,0<St&&on>St){Me=3;break e}if(!n(At,Xe,"VP8 ")||!n(At,Xe,"VP8L")){Me=0;break e}if(un[0]<ln){Me=7;break e}n(At,Xe,"ALPH")||(tt[0]=At,Qe[0]=Xe+8,zt[0]=Pi),Xe+=ln,un-=ln}}if(k=k[0],_e.na=_e.na[0],_e.P=_e.P[0],_e.Sa=_e.Sa[0],Me!=0)break}k=[k],_e.Ja=[_e.Ja],_e.xa=[_e.xa];e:if(St=g,Me=v,Ve=k,tt=_e.gb[0],Qe=_e.Ja,zt=_e.xa,At=Me[0],Xe=!n(St,At,"VP8 "),on=!n(St,At,"VP8L"),e(St!=null),e(Ve!=null),e(Qe!=null),e(zt!=null),8>Ve[0])Me=7;else{if(Xe||on){if(St=Ge(St,At+4),12<=tt&&St>tt-12){Me=3;break e}if(ce&&St>Ve[0]-8){Me=7;break e}Qe[0]=St,Me[0]+=8,Ve[0]-=8,zt[0]=on}else zt[0]=5<=Ve[0]&&St[At+0]==47&&!(St[At+4]>>5),Qe[0]=Ve[0];Me=0}if(k=k[0],_e.Ja=_e.Ja[0],_e.xa=_e.xa[0],v=v[0],Me!=0)break;if(4294967286<_e.Ja)return 3;if(ee==null||je||(ee[0]=_e.xa?2:1),Y=[Y],Ne=[Ne],_e.xa){if(5>k){Me=7;break}ee=Y,ce=Ne,je=H,g==null||5>k?g=0:5<=k&&g[v+0]==47&&!(g[v+4]>>5)?(Ve=[0],St=[0],tt=[0],X(Qe=new V,g,v,k),Hn(Qe,Ve,St,tt)?(ee!=null&&(ee[0]=Ve[0]),ce!=null&&(ce[0]=St[0]),je!=null&&(je[0]=tt[0]),g=1):g=0):g=0}else{if(10>k){Me=7;break}ee=Ne,g==null||10>k||!la(g,v+3,k-3)?g=0:(ce=g[v+0]|g[v+1]<<8|g[v+2]<<16,je=16383&(g[v+7]<<8|g[v+6]),g=16383&(g[v+9]<<8|g[v+8]),1&ce||3<(ce>>1&7)||!(ce>>4&1)||ce>>5>=_e.Ja||!je||!g?g=0:(Y&&(Y[0]=je),ee&&(ee[0]=g),g=1))}if(!g||(Y=Y[0],Ne=Ne[0],De&&(oe[0]!=Y||xe[0]!=Ne)))return 3;ie!=null&&(ie[0]=_e,ie.offset=v-ie.w,e(4294967286>v-ie.w),e(ie.offset==ie.ha-k));break}return Me==0||Me==7&&De&&ie==null?(H!=null&&(H[0]|=_e.na!=null&&0<_e.na.length),L!=null&&(L[0]=Y),z!=null&&(z[0]=Ne),0):Me}function ic(g,v,k){var L=v.width,z=v.height,H=0,Y=0,ee=L,ie=z;if(v.Da=g!=null&&0<g.Da,v.Da&&(ee=g.cd,ie=g.bd,H=g.v,Y=g.j,11>k||(H&=-2,Y&=-2),0>H||0>Y||0>=ee||0>=ie||H+ee>L||Y+ie>z))return 0;if(v.v=H,v.j=Y,v.va=H+ee,v.o=Y+ie,v.U=ee,v.T=ie,v.da=g!=null&&0<g.da,v.da){if(!Be(ee,ie,k=[g.ib],H=[g.hb]))return 0;v.ib=k[0],v.hb=H[0]}return v.ob=g!=null&&g.ob,v.Kb=g==null||!g.Sd,v.da&&(v.ob=v.ib<3*L/4&&v.hb<3*z/4,v.Kb=0),1}function rc(g){if(g==null)return 2;if(11>g.S){var v=g.f.RGBA;v.fb+=(g.height-1)*v.A,v.A=-v.A}else v=g.f.kb,g=g.height,v.O+=(g-1)*v.fa,v.fa=-v.fa,v.N+=(g-1>>1)*v.Ab,v.Ab=-v.Ab,v.W+=(g-1>>1)*v.Db,v.Db=-v.Db,v.F!=null&&(v.J+=(g-1)*v.lb,v.lb=-v.lb);return 0}function ja(g,v,k,L){if(L==null||0>=g||0>=v)return 2;if(k!=null){if(k.Da){var z=k.cd,H=k.bd,Y=-2&k.v,ee=-2&k.j;if(0>Y||0>ee||0>=z||0>=H||Y+z>g||ee+H>v)return 2;g=z,v=H}if(k.da){if(!Be(g,v,z=[k.ib],H=[k.hb]))return 2;g=z[0],v=H[0]}}L.width=g,L.height=v;e:{var ie=L.width,oe=L.height;if(g=L.S,0>=ie||0>=oe||!(g>=ma&&13>g))g=2;else{if(0>=L.Rd&&L.sd==null){Y=H=z=v=0;var xe=(ee=ie*Bo[g])*oe;if(11>g||(H=(oe+1)/2*(v=(ie+1)/2),g==12&&(Y=(z=ie)*oe)),(oe=s(xe+2*H+Y))==null){g=1;break e}L.sd=oe,11>g?((ie=L.f.RGBA).eb=oe,ie.fb=0,ie.A=ee,ie.size=xe):((ie=L.f.kb).y=oe,ie.O=0,ie.fa=ee,ie.Fd=xe,ie.f=oe,ie.N=0+xe,ie.Ab=v,ie.Cd=H,ie.ea=oe,ie.W=0+xe+H,ie.Db=v,ie.Ed=H,g==12&&(ie.F=oe,ie.J=0+xe+2*H),ie.Tc=Y,ie.lb=z)}if(v=1,z=L.S,H=L.width,Y=L.height,z>=ma&&13>z)if(11>z)g=L.f.RGBA,v&=(ee=Math.abs(g.A))*(Y-1)+H<=g.size,v&=ee>=H*Bo[z],v&=g.eb!=null;else{g=L.f.kb,ee=(H+1)/2,xe=(Y+1)/2,ie=Math.abs(g.fa),oe=Math.abs(g.Ab);var De=Math.abs(g.Db),ce=Math.abs(g.lb),_e=ce*(Y-1)+H;v&=ie*(Y-1)+H<=g.Fd,v&=oe*(xe-1)+ee<=g.Cd,v=(v&=De*(xe-1)+ee<=g.Ed)&ie>=H&oe>=ee&De>=ee,v&=g.y!=null,v&=g.f!=null,v&=g.ea!=null,z==12&&(v&=ce>=H,v&=_e<=g.Tc,v&=g.F!=null)}else v=0;g=v?0:2}}return g!=0||k!=null&&k.fd&&(g=rc(L)),g}var ds=64,zi=[0,1,3,7,15,31,63,127,255,511,1023,2047,4095,8191,16383,32767,65535,131071,262143,524287,1048575,2097151,4194303,8388607,16777215],Gr=24,Ha=32,ha=8,Xr=[0,0,1,1,2,2,2,2,3,3,3,3,3,3,3,3,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7];Ue("Predictor0","PredictorAdd0"),O.Predictor0=function(){return 4278190080},O.Predictor1=function(g){return g},O.Predictor2=function(g,v,k){return v[k+0]},O.Predictor3=function(g,v,k){return v[k+1]},O.Predictor4=function(g,v,k){return v[k-1]},O.Predictor5=function(g,v,k){return ut(ut(g,v[k+1]),v[k+0])},O.Predictor6=function(g,v,k){return ut(g,v[k-1])},O.Predictor7=function(g,v,k){return ut(g,v[k+0])},O.Predictor8=function(g,v,k){return ut(v[k-1],v[k+0])},O.Predictor9=function(g,v,k){return ut(v[k+0],v[k+1])},O.Predictor10=function(g,v,k){return ut(ut(g,v[k-1]),ut(v[k+0],v[k+1]))},O.Predictor11=function(g,v,k){var L=v[k+0];return 0>=ze(L>>24&255,g>>24&255,(v=v[k-1])>>24&255)+ze(L>>16&255,g>>16&255,v>>16&255)+ze(L>>8&255,g>>8&255,v>>8&255)+ze(255&L,255&g,255&v)?L:g},O.Predictor12=function(g,v,k){var L=v[k+0];return(Ft((g>>24&255)+(L>>24&255)-((v=v[k-1])>>24&255))<<24|Ft((g>>16&255)+(L>>16&255)-(v>>16&255))<<16|Ft((g>>8&255)+(L>>8&255)-(v>>8&255))<<8|Ft((255&g)+(255&L)-(255&v)))>>>0},O.Predictor13=function(g,v,k){var L=v[k-1];return(be((g=ut(g,v[k+0]))>>24&255,L>>24&255)<<24|be(g>>16&255,L>>16&255)<<16|be(g>>8&255,L>>8&255)<<8|be(255&g,255&L))>>>0};var Vs=O.PredictorAdd0;O.PredictorAdd1=ve,Ue("Predictor2","PredictorAdd2"),Ue("Predictor3","PredictorAdd3"),Ue("Predictor4","PredictorAdd4"),Ue("Predictor5","PredictorAdd5"),Ue("Predictor6","PredictorAdd6"),Ue("Predictor7","PredictorAdd7"),Ue("Predictor8","PredictorAdd8"),Ue("Predictor9","PredictorAdd9"),Ue("Predictor10","PredictorAdd10"),Ue("Predictor11","PredictorAdd11"),Ue("Predictor12","PredictorAdd12"),Ue("Predictor13","PredictorAdd13");var yl=O.PredictorAdd2;et("ColorIndexInverseTransform","MapARGB","32b",function(g){return g>>8&255},function(g){return g}),et("VP8LColorIndexInverseTransformAlpha","MapAlpha","8b",function(g){return g},function(g){return g>>8&255});var bi,jc=O.ColorIndexInverseTransform,_r=O.MapARGB,Sr=O.VP8LColorIndexInverseTransformAlpha,sc=O.MapAlpha,ac=O.VP8LPredictorsAdd=[];ac.length=16,(O.VP8LPredictors=[]).length=16,(O.VP8LPredictorsAdd_C=[]).length=16,(O.VP8LPredictors_C=[]).length=16;var oc,Gs,Yr,Ua,Wa,Co,Kr,fs,hs,Xs,In,An,Un,Ci,pa,lc,Es,ga,Qd,$d,ef,Po,Eo,tf,cc,nf,Io,Lo,rf=s(511),sf=s(2041),af=s(225),Mo=s(767),To=0,Hu=sf,Hc=af,Zr=Mo,Qi=rf,ma=0,Uc=1,of=2,Wc=3,va=4,Va=5,lf=6,Uu=7,Wu=8,ya=9,Ga=10,Ap=[2,3,7],Np=[3,3,11],cf=[280,256,256,256,40],bl=[0,1,1,1,0],wl=[17,18,0,1,2,3,4,5,16,6,7,8,9,10,11,12,13,14,15],Cp=[24,7,23,25,40,6,39,41,22,26,38,42,56,5,55,57,21,27,54,58,37,43,72,4,71,73,20,28,53,59,70,74,36,44,88,69,75,52,60,3,87,89,19,29,86,90,35,45,68,76,85,91,51,61,104,2,103,105,18,30,102,106,34,46,84,92,67,77,101,107,50,62,120,1,119,121,83,93,17,31,100,108,66,78,118,122,33,47,117,123,49,63,99,109,82,94,0,116,124,65,79,16,32,98,110,48,115,125,81,95,64,114,126,97,111,80,113,127,96,112],Pp=[2954,2956,2958,2962,2970,2986,3018,3082,3212,3468,3980,5004],Ep=8,Xa=[4,5,6,7,8,9,10,10,11,12,13,14,15,16,17,17,18,19,20,20,21,21,22,22,23,23,24,25,25,26,27,28,29,30,31,32,33,34,35,36,37,37,38,39,40,41,42,43,44,45,46,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76,76,77,78,79,80,81,82,83,84,85,86,87,88,89,91,93,95,96,98,100,101,102,104,106,108,110,112,114,116,118,122,124,126,128,130,132,134,136,138,140,143,145,148,151,154,157],Ya=[4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,60,62,64,66,68,70,72,74,76,78,80,82,84,86,88,90,92,94,96,98,100,102,104,106,108,110,112,114,116,119,122,125,128,131,134,137,140,143,146,149,152,155,158,161,164,167,170,173,177,181,185,189,193,197,201,205,209,213,217,221,225,229,234,239,245,249,254,259,264,269,274,279,284],uc=null,Ip=[[173,148,140,0],[176,155,140,135,0],[180,157,141,134,130,0],[254,254,243,230,196,177,153,140,133,130,129,0]],Lp=[0,1,4,8,5,2,3,6,9,12,13,10,7,11,14,15],Do=[-0,1,-1,2,-2,3,4,6,-3,5,-4,-5,-6,7,-7,8,-8,-9],xl=[[[[128,128,128,128,128,128,128,128,128,128,128],[128,128,128,128,128,128,128,128,128,128,128],[128,128,128,128,128,128,128,128,128,128,128]],[[253,136,254,255,228,219,128,128,128,128,128],[189,129,242,255,227,213,255,219,128,128,128],[106,126,227,252,214,209,255,255,128,128,128]],[[1,98,248,255,236,226,255,255,128,128,128],[181,133,238,254,221,234,255,154,128,128,128],[78,134,202,247,198,180,255,219,128,128,128]],[[1,185,249,255,243,255,128,128,128,128,128],[184,150,247,255,236,224,128,128,128,128,128],[77,110,216,255,236,230,128,128,128,128,128]],[[1,101,251,255,241,255,128,128,128,128,128],[170,139,241,252,236,209,255,255,128,128,128],[37,116,196,243,228,255,255,255,128,128,128]],[[1,204,254,255,245,255,128,128,128,128,128],[207,160,250,255,238,128,128,128,128,128,128],[102,103,231,255,211,171,128,128,128,128,128]],[[1,152,252,255,240,255,128,128,128,128,128],[177,135,243,255,234,225,128,128,128,128,128],[80,129,211,255,194,224,128,128,128,128,128]],[[1,1,255,128,128,128,128,128,128,128,128],[246,1,255,128,128,128,128,128,128,128,128],[255,128,128,128,128,128,128,128,128,128,128]]],[[[198,35,237,223,193,187,162,160,145,155,62],[131,45,198,221,172,176,220,157,252,221,1],[68,47,146,208,149,167,221,162,255,223,128]],[[1,149,241,255,221,224,255,255,128,128,128],[184,141,234,253,222,220,255,199,128,128,128],[81,99,181,242,176,190,249,202,255,255,128]],[[1,129,232,253,214,197,242,196,255,255,128],[99,121,210,250,201,198,255,202,128,128,128],[23,91,163,242,170,187,247,210,255,255,128]],[[1,200,246,255,234,255,128,128,128,128,128],[109,178,241,255,231,245,255,255,128,128,128],[44,130,201,253,205,192,255,255,128,128,128]],[[1,132,239,251,219,209,255,165,128,128,128],[94,136,225,251,218,190,255,255,128,128,128],[22,100,174,245,186,161,255,199,128,128,128]],[[1,182,249,255,232,235,128,128,128,128,128],[124,143,241,255,227,234,128,128,128,128,128],[35,77,181,251,193,211,255,205,128,128,128]],[[1,157,247,255,236,231,255,255,128,128,128],[121,141,235,255,225,227,255,255,128,128,128],[45,99,188,251,195,217,255,224,128,128,128]],[[1,1,251,255,213,255,128,128,128,128,128],[203,1,248,255,255,128,128,128,128,128,128],[137,1,177,255,224,255,128,128,128,128,128]]],[[[253,9,248,251,207,208,255,192,128,128,128],[175,13,224,243,193,185,249,198,255,255,128],[73,17,171,221,161,179,236,167,255,234,128]],[[1,95,247,253,212,183,255,255,128,128,128],[239,90,244,250,211,209,255,255,128,128,128],[155,77,195,248,188,195,255,255,128,128,128]],[[1,24,239,251,218,219,255,205,128,128,128],[201,51,219,255,196,186,128,128,128,128,128],[69,46,190,239,201,218,255,228,128,128,128]],[[1,191,251,255,255,128,128,128,128,128,128],[223,165,249,255,213,255,128,128,128,128,128],[141,124,248,255,255,128,128,128,128,128,128]],[[1,16,248,255,255,128,128,128,128,128,128],[190,36,230,255,236,255,128,128,128,128,128],[149,1,255,128,128,128,128,128,128,128,128]],[[1,226,255,128,128,128,128,128,128,128,128],[247,192,255,128,128,128,128,128,128,128,128],[240,128,255,128,128,128,128,128,128,128,128]],[[1,134,252,255,255,128,128,128,128,128,128],[213,62,250,255,255,128,128,128,128,128,128],[55,93,255,128,128,128,128,128,128,128,128]],[[128,128,128,128,128,128,128,128,128,128,128],[128,128,128,128,128,128,128,128,128,128,128],[128,128,128,128,128,128,128,128,128,128,128]]],[[[202,24,213,235,186,191,220,160,240,175,255],[126,38,182,232,169,184,228,174,255,187,128],[61,46,138,219,151,178,240,170,255,216,128]],[[1,112,230,250,199,191,247,159,255,255,128],[166,109,228,252,211,215,255,174,128,128,128],[39,77,162,232,172,180,245,178,255,255,128]],[[1,52,220,246,198,199,249,220,255,255,128],[124,74,191,243,183,193,250,221,255,255,128],[24,71,130,219,154,170,243,182,255,255,128]],[[1,182,225,249,219,240,255,224,128,128,128],[149,150,226,252,216,205,255,171,128,128,128],[28,108,170,242,183,194,254,223,255,255,128]],[[1,81,230,252,204,203,255,192,128,128,128],[123,102,209,247,188,196,255,233,128,128,128],[20,95,153,243,164,173,255,203,128,128,128]],[[1,222,248,255,216,213,128,128,128,128,128],[168,175,246,252,235,205,255,255,128,128,128],[47,116,215,255,211,212,255,255,128,128,128]],[[1,121,236,253,212,214,255,255,128,128,128],[141,84,213,252,201,202,255,219,128,128,128],[42,80,160,240,162,185,255,205,128,128,128]],[[1,1,255,128,128,128,128,128,128,128,128],[244,1,255,128,128,128,128,128,128,128,128],[238,1,255,128,128,128,128,128,128,128,128]]]],Mp=[[[231,120,48,89,115,113,120,152,112],[152,179,64,126,170,118,46,70,95],[175,69,143,80,85,82,72,155,103],[56,58,10,171,218,189,17,13,152],[114,26,17,163,44,195,21,10,173],[121,24,80,195,26,62,44,64,85],[144,71,10,38,171,213,144,34,26],[170,46,55,19,136,160,33,206,71],[63,20,8,114,114,208,12,9,226],[81,40,11,96,182,84,29,16,36]],[[134,183,89,137,98,101,106,165,148],[72,187,100,130,157,111,32,75,80],[66,102,167,99,74,62,40,234,128],[41,53,9,178,241,141,26,8,107],[74,43,26,146,73,166,49,23,157],[65,38,105,160,51,52,31,115,128],[104,79,12,27,217,255,87,17,7],[87,68,71,44,114,51,15,186,23],[47,41,14,110,182,183,21,17,194],[66,45,25,102,197,189,23,18,22]],[[88,88,147,150,42,46,45,196,205],[43,97,183,117,85,38,35,179,61],[39,53,200,87,26,21,43,232,171],[56,34,51,104,114,102,29,93,77],[39,28,85,171,58,165,90,98,64],[34,22,116,206,23,34,43,166,73],[107,54,32,26,51,1,81,43,31],[68,25,106,22,64,171,36,225,114],[34,19,21,102,132,188,16,76,124],[62,18,78,95,85,57,50,48,51]],[[193,101,35,159,215,111,89,46,111],[60,148,31,172,219,228,21,18,111],[112,113,77,85,179,255,38,120,114],[40,42,1,196,245,209,10,25,109],[88,43,29,140,166,213,37,43,154],[61,63,30,155,67,45,68,1,209],[100,80,8,43,154,1,51,26,71],[142,78,78,16,255,128,34,197,171],[41,40,5,102,211,183,4,1,221],[51,50,17,168,209,192,23,25,82]],[[138,31,36,171,27,166,38,44,229],[67,87,58,169,82,115,26,59,179],[63,59,90,180,59,166,93,73,154],[40,40,21,116,143,209,34,39,175],[47,15,16,183,34,223,49,45,183],[46,17,33,183,6,98,15,32,183],[57,46,22,24,128,1,54,17,37],[65,32,73,115,28,128,23,128,205],[40,3,9,115,51,192,18,6,223],[87,37,9,115,59,77,64,21,47]],[[104,55,44,218,9,54,53,130,226],[64,90,70,205,40,41,23,26,57],[54,57,112,184,5,41,38,166,213],[30,34,26,133,152,116,10,32,134],[39,19,53,221,26,114,32,73,255],[31,9,65,234,2,15,1,118,73],[75,32,12,51,192,255,160,43,51],[88,31,35,67,102,85,55,186,85],[56,21,23,111,59,205,45,37,192],[55,38,70,124,73,102,1,34,98]],[[125,98,42,88,104,85,117,175,82],[95,84,53,89,128,100,113,101,45],[75,79,123,47,51,128,81,171,1],[57,17,5,71,102,57,53,41,49],[38,33,13,121,57,73,26,1,85],[41,10,67,138,77,110,90,47,114],[115,21,2,10,102,255,166,23,6],[101,29,16,10,85,128,101,196,26],[57,18,10,102,102,213,34,20,43],[117,20,15,36,163,128,68,1,26]],[[102,61,71,37,34,53,31,243,192],[69,60,71,38,73,119,28,222,37],[68,45,128,34,1,47,11,245,171],[62,17,19,70,146,85,55,62,70],[37,43,37,154,100,163,85,160,1],[63,9,92,136,28,64,32,201,85],[75,15,9,9,64,255,184,119,16],[86,6,28,5,64,255,25,248,1],[56,8,17,132,137,255,55,116,128],[58,15,20,82,135,57,26,121,40]],[[164,50,31,137,154,133,25,35,218],[51,103,44,131,131,123,31,6,158],[86,40,64,135,148,224,45,183,128],[22,26,17,131,240,154,14,1,209],[45,16,21,91,64,222,7,1,197],[56,21,39,155,60,138,23,102,213],[83,12,13,54,192,255,68,47,28],[85,26,85,85,128,128,32,146,171],[18,11,7,63,144,171,4,4,246],[35,27,10,146,174,171,12,26,128]],[[190,80,35,99,180,80,126,54,45],[85,126,47,87,176,51,41,20,32],[101,75,128,139,118,146,116,128,85],[56,41,15,176,236,85,37,9,62],[71,30,17,119,118,255,17,18,138],[101,38,60,138,55,70,43,26,142],[146,36,19,30,171,255,97,27,20],[138,45,61,62,219,1,81,188,64],[32,41,20,117,151,142,20,21,163],[112,19,12,61,195,128,48,4,24]]],Tp=[[[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[176,246,255,255,255,255,255,255,255,255,255],[223,241,252,255,255,255,255,255,255,255,255],[249,253,253,255,255,255,255,255,255,255,255]],[[255,244,252,255,255,255,255,255,255,255,255],[234,254,254,255,255,255,255,255,255,255,255],[253,255,255,255,255,255,255,255,255,255,255]],[[255,246,254,255,255,255,255,255,255,255,255],[239,253,254,255,255,255,255,255,255,255,255],[254,255,254,255,255,255,255,255,255,255,255]],[[255,248,254,255,255,255,255,255,255,255,255],[251,255,254,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,253,254,255,255,255,255,255,255,255,255],[251,254,254,255,255,255,255,255,255,255,255],[254,255,254,255,255,255,255,255,255,255,255]],[[255,254,253,255,254,255,255,255,255,255,255],[250,255,254,255,254,255,255,255,255,255,255],[254,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]]],[[[217,255,255,255,255,255,255,255,255,255,255],[225,252,241,253,255,255,254,255,255,255,255],[234,250,241,250,253,255,253,254,255,255,255]],[[255,254,255,255,255,255,255,255,255,255,255],[223,254,254,255,255,255,255,255,255,255,255],[238,253,254,254,255,255,255,255,255,255,255]],[[255,248,254,255,255,255,255,255,255,255,255],[249,254,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,253,255,255,255,255,255,255,255,255,255],[247,254,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,253,254,255,255,255,255,255,255,255,255],[252,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,254,254,255,255,255,255,255,255,255,255],[253,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,254,253,255,255,255,255,255,255,255,255],[250,255,255,255,255,255,255,255,255,255,255],[254,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]]],[[[186,251,250,255,255,255,255,255,255,255,255],[234,251,244,254,255,255,255,255,255,255,255],[251,251,243,253,254,255,254,255,255,255,255]],[[255,253,254,255,255,255,255,255,255,255,255],[236,253,254,255,255,255,255,255,255,255,255],[251,253,253,254,254,255,255,255,255,255,255]],[[255,254,254,255,255,255,255,255,255,255,255],[254,254,254,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,254,255,255,255,255,255,255,255,255,255],[254,254,255,255,255,255,255,255,255,255,255],[254,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[254,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]]],[[[248,255,255,255,255,255,255,255,255,255,255],[250,254,252,254,255,255,255,255,255,255,255],[248,254,249,253,255,255,255,255,255,255,255]],[[255,253,253,255,255,255,255,255,255,255,255],[246,253,253,255,255,255,255,255,255,255,255],[252,254,251,254,254,255,255,255,255,255,255]],[[255,254,252,255,255,255,255,255,255,255,255],[248,254,253,255,255,255,255,255,255,255,255],[253,255,254,254,255,255,255,255,255,255,255]],[[255,251,254,255,255,255,255,255,255,255,255],[245,251,254,255,255,255,255,255,255,255,255],[253,253,254,255,255,255,255,255,255,255,255]],[[255,251,253,255,255,255,255,255,255,255,255],[252,253,254,255,255,255,255,255,255,255,255],[255,254,255,255,255,255,255,255,255,255,255]],[[255,252,255,255,255,255,255,255,255,255,255],[249,255,254,255,255,255,255,255,255,255,255],[255,255,254,255,255,255,255,255,255,255,255]],[[255,255,253,255,255,255,255,255,255,255,255],[250,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[254,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]]]],Dp=[0,1,2,3,6,4,5,6,6,6,6,6,6,6,6,7,0],Jr=[],dr=[],ba=[],Op=1,uf=2,Qr=[],$i=[];ur("UpsampleRgbLinePair",Vr,3),ur("UpsampleBgrLinePair",di,3),ur("UpsampleRgbaLinePair",xi,4),ur("UpsampleBgraLinePair",Ws,4),ur("UpsampleArgbLinePair",nc,4),ur("UpsampleRgba4444LinePair",No,2),ur("UpsampleRgb565LinePair",Ao,2);var Fp=O.UpsampleRgbLinePair,Rp=O.UpsampleBgrLinePair,df=O.UpsampleRgbaLinePair,Oo=O.UpsampleBgraLinePair,Fo=O.UpsampleArgbLinePair,ff=O.UpsampleRgba4444LinePair,Bp=O.UpsampleRgb565LinePair,Vc=16,wa=1<<Vc-1,Ys=-227,Vu=482,zp=6,hf=0,_l=s(256),Sl=s(256),qp=s(256),jp=s(256),Hp=s(Vu-Ys),kl=s(Vu-Ys);fa("YuvToRgbRow",Vr,3),fa("YuvToBgrRow",di,3),fa("YuvToRgbaRow",xi,4),fa("YuvToBgraRow",Ws,4),fa("YuvToArgbRow",nc,4),fa("YuvToRgba4444Row",No,2),fa("YuvToRgb565Row",Ao,2);var Ro=[0,4,8,12,128,132,136,140,256,260,264,268,384,388,392,396],Gc=[0,2,8],Up=[8,7,6,4,4,2,2,2,1,1,1,1],Wp=1;this.WebPDecodeRGBA=function(g,v,k,L,z){var H=Uc,Y=new Te,ee=new xt;Y.ba=ee,ee.S=H,ee.width=[ee.width],ee.height=[ee.height];var ie=ee.width,oe=ee.height,xe=new dt;if(xe==null||g==null)var De=2;else e(xe!=null),De=us(g,v,k,xe.width,xe.height,xe.Pd,xe.Qd,xe.format,null);if(De!=0?ie=0:(ie!=null&&(ie[0]=xe.width[0]),oe!=null&&(oe[0]=xe.height[0]),ie=1),ie){ee.width=ee.width[0],ee.height=ee.height[0],L!=null&&(L[0]=ee.width),z!=null&&(z[0]=ee.height);e:{if(L=new rr,(z=new We).data=g,z.w=v,z.ha=k,z.kd=1,v=[0],e(z!=null),((g=us(z.data,z.w,z.ha,null,null,null,v,null,z))==0||g==7)&&v[0]&&(g=4),(v=g)==0){if(e(Y!=null),L.data=z.data,L.w=z.w+z.offset,L.ha=z.ha-z.offset,L.put=Ct,L.ac=ni,L.bc=oi,L.ma=Y,z.xa){if((g=wn())==null){Y=1;break e}if((function(ce,_e){var Ne=[0],je=[0],Me=[0];t:for(;;){if(ce==null)return 0;if(_e==null)return ce.a=2,0;if(ce.l=_e,ce.a=0,X(ce.m,_e.data,_e.w,_e.ha),!Hn(ce.m,Ne,je,Me)){ce.a=3;break t}if(ce.xb=uf,_e.width=Ne[0],_e.height=je[0],!en(Ne[0],je[0],1,ce,null))break t;return 1}return e(ce.a!=0),0})(g,L)){if(L=(v=ja(L.width,L.height,Y.Oa,Y.ba))==0){t:{L=g;n:for(;;){if(L==null){L=0;break t}if(e(L.s.yc!=null),e(L.s.Ya!=null),e(0<L.s.Wb),e((k=L.l)!=null),e((z=k.ma)!=null),L.xb!=0){if(L.ca=z.ba,L.tb=z.tb,e(L.ca!=null),!ic(z.Oa,k,Wc)){L.a=2;break n}if(!ii(L,k.width)||k.da)break n;if((k.da||st(L.ca.S))&&Kn(),11>L.ca.S||(alert("todo:WebPInitConvertARGBToYUV"),L.ca.f.kb.F!=null&&Kn()),L.Pb&&0<L.s.ua&&L.s.vb.X==null&&!K(L.s.vb,L.s.Wa.Xa)){L.a=1;break n}L.xb=0}if(!Jt(L,L.V,L.Ba,L.c,L.i,k.o,tn))break n;z.Dc=L.Ma,L=1;break t}e(L.a!=0),L=0}L=!L}L&&(v=g.a)}else v=g.a}else{if((g=new ec)==null){Y=1;break e}if(g.Fa=z.na,g.P=z.P,g.qc=z.Sa,Yi(g,L)){if((v=ja(L.width,L.height,Y.Oa,Y.ba))==0){if(g.Aa=0,k=Y.Oa,e((z=g)!=null),k!=null){if(0<(ie=0>(ie=k.Md)?0:100<ie?255:255*ie/100)){for(oe=xe=0;4>oe;++oe)12>(De=z.pb[oe]).lc&&(De.ia=ie*Up[0>De.lc?0:De.lc]>>3),xe|=De.ia;xe&&(alert("todo:VP8InitRandom"),z.ia=1)}z.Ga=k.Id,100<z.Ga?z.Ga=100:0>z.Ga&&(z.Ga=0)}(function(ce,_e){if(ce==null)return 0;if(_e==null)return li(ce,2,"NULL VP8Io parameter in VP8Decode().");if(!ce.cb&&!Yi(ce,_e))return 0;if(e(ce.cb),_e.ac==null||_e.ac(_e)){_e.ob&&(ce.L=0);var Ne=Gc[ce.L];if(ce.L==2?(ce.yb=0,ce.zb=0):(ce.yb=_e.v-Ne>>4,ce.zb=_e.j-Ne>>4,0>ce.yb&&(ce.yb=0),0>ce.zb&&(ce.zb=0)),ce.Va=_e.o+15+Ne>>4,ce.Hb=_e.va+15+Ne>>4,ce.Hb>ce.za&&(ce.Hb=ce.za),ce.Va>ce.Ub&&(ce.Va=ce.Ub),0<ce.L){var je=ce.ed;for(Ne=0;4>Ne;++Ne){var Me;if(ce.Qa.Cb){var Ve=ce.Qa.Lb[Ne];ce.Qa.Fb||(Ve+=je.Tb)}else Ve=je.Tb;for(Me=0;1>=Me;++Me){var Xe=ce.gd[Ne][Me],tt=Ve;if(je.Pc&&(tt+=je.vd[0],Me&&(tt+=je.od[0])),0<(tt=0>tt?0:63<tt?63:tt)){var Qe=tt;0<je.wb&&(Qe=4<je.wb?Qe>>2:Qe>>1)>9-je.wb&&(Qe=9-je.wb),1>Qe&&(Qe=1),Xe.dd=Qe,Xe.tc=2*tt+Qe,Xe.ld=40<=tt?2:15<=tt?1:0}else Xe.tc=0;Xe.La=Me}}}Ne=0}else li(ce,6,"Frame setup failed"),Ne=ce.a;if(Ne=Ne==0){if(Ne){ce.$c=0,0<ce.Aa||(ce.Ic=Wp);t:{Ne=ce.Ic,je=4*(Qe=ce.za);var zt=32*Qe,At=Qe+1,on=0<ce.L?Qe*(0<ce.Aa?2:1):0,St=(ce.Aa==2?2:1)*Qe;if((Xe=je+832+(Me=3*(16*Ne+Gc[ce.L])/2*zt)+(Ve=ce.Fa!=null&&0<ce.Fa.length?ce.Kc.c*ce.Kc.i:0))!=Xe)Ne=0;else{if(Xe>ce.Vb){if(ce.Vb=0,ce.Ec=s(Xe),ce.Fc=0,ce.Ec==null){Ne=li(ce,1,"no memory during frame initialization.");break t}ce.Vb=Xe}Xe=ce.Ec,tt=ce.Fc,ce.Ac=Xe,ce.Bc=tt,tt+=je,ce.Gd=a(zt,cl),ce.Hd=0,ce.rb=a(At+1,mo),ce.sb=1,ce.wa=on?a(on,Ir):null,ce.Y=0,ce.D.Nb=0,ce.D.wa=ce.wa,ce.D.Y=ce.Y,0<ce.Aa&&(ce.D.Y+=Qe),e(!0),ce.oc=Xe,ce.pc=tt,tt+=832,ce.ya=a(St,ir),ce.aa=0,ce.D.ya=ce.ya,ce.D.aa=ce.aa,ce.Aa==2&&(ce.D.aa+=Qe),ce.R=16*Qe,ce.B=8*Qe,Qe=(zt=Gc[ce.L])*ce.R,zt=zt/2*ce.B,ce.sa=Xe,ce.ta=tt+Qe,ce.qa=ce.sa,ce.ra=ce.ta+16*Ne*ce.R+zt,ce.Ha=ce.qa,ce.Ia=ce.ra+8*Ne*ce.B+zt,ce.$c=0,tt+=Me,ce.mb=Ve?Xe:null,ce.nb=Ve?tt:null,e(tt+Ve<=ce.Fc+ce.Vb),Ta(ce),r(ce.Ac,ce.Bc,0,je),Ne=1}}if(Ne){if(_e.ka=0,_e.y=ce.sa,_e.O=ce.ta,_e.f=ce.qa,_e.N=ce.ra,_e.ea=ce.Ha,_e.Vd=ce.Ia,_e.fa=ce.R,_e.Rc=ce.B,_e.F=null,_e.J=0,!To){for(Ne=-255;255>=Ne;++Ne)rf[255+Ne]=0>Ne?-Ne:Ne;for(Ne=-1020;1020>=Ne;++Ne)sf[1020+Ne]=-128>Ne?-128:127<Ne?127:Ne;for(Ne=-112;112>=Ne;++Ne)af[112+Ne]=-16>Ne?-16:15<Ne?15:Ne;for(Ne=-255;510>=Ne;++Ne)Mo[255+Ne]=0>Ne?0:255<Ne?255:Ne;To=1}Kr=zs,fs=tc,Xs=lr,In=as,An=_s,hs=dl,Un=cs,Ci=da,pa=P,lc=J,Es=ml,ga=b,Qd=fe,$d=ye,ef=xr,Po=Wr,Eo=xo,tf=_o,dr[0]=Oa,dr[1]=fl,dr[2]=Ss,dr[3]=js,dr[4]=ks,dr[5]=Hs,dr[6]=os,dr[7]=As,dr[8]=Ra,dr[9]=Fa,Jr[0]=Tr,Jr[1]=Mr,Jr[2]=Da,Jr[3]=hl,Jr[4]=wr,Jr[5]=yo,Jr[6]=pl,ba[0]=gl,ba[1]=qs,ba[2]=ca,ba[3]=Ns,ba[4]=Ba,ba[5]=bo,ba[6]=Cs,Ne=1}else Ne=0}Ne&&(Ne=(function(un,Pi){for(un.M=0;un.M<un.Va;++un.M){var ln,Lt=un.Jc[un.M&un.Xb],ft=un.m,Wn=un;for(ln=0;ln<Wn.za;++ln){var rn=ft,xn=Wn,Zn=xn.Ac,fi=xn.Bc+4*ln,_i=xn.zc,hi=xn.ya[xn.aa+ln];if(xn.Qa.Bb?hi.$b=ge(rn,xn.Pa.jb[0])?2+ge(rn,xn.Pa.jb[2]):ge(rn,xn.Pa.jb[1]):hi.$b=0,xn.kc&&(hi.Ad=ge(rn,xn.Bd)),hi.Za=!ge(rn,145)+0,hi.Za){var fr=hi.Ob,kr=0;for(xn=0;4>xn;++xn){var ri,fn=_i[0+xn];for(ri=0;4>ri;++ri){fn=Mp[Zn[fi+ri]][fn];for(var Tn=Do[ge(rn,fn[0])];0<Tn;)Tn=Do[2*Tn+ge(rn,fn[Tn])];fn=-Tn,Zn[fi+ri]=fn}i(fr,kr,Zn,fi,4),kr+=4,_i[0+xn]=fn}}else fn=ge(rn,156)?ge(rn,128)?1:3:ge(rn,163)?2:0,hi.Ob[0]=fn,r(Zn,fi,fn,4),r(_i,0,fn,4);hi.Dd=ge(rn,142)?ge(rn,114)?ge(rn,183)?1:3:2:0}if(Wn.m.Ka)return li(un,7,"Premature end-of-partition0 encountered.");for(;un.ja<un.za;++un.ja){if(Wn=Lt,rn=(ft=un).rb[ft.sb-1],Zn=ft.rb[ft.sb+ft.ja],ln=ft.ya[ft.aa+ft.ja],fi=ft.kc?ln.Ad:0)rn.la=Zn.la=0,ln.Za||(rn.Na=Zn.Na=0),ln.Hc=0,ln.Gc=0,ln.ia=0;else{var pi,Dn;if(rn=Zn,Zn=Wn,fi=ft.Pa.Xc,_i=ft.ya[ft.aa+ft.ja],hi=ft.pb[_i.$b],xn=_i.ad,fr=0,kr=ft.rb[ft.sb-1],fn=ri=0,r(xn,fr,0,384),_i.Za)var gi=0,hr=fi[3];else{Tn=s(16);var wi=rn.Na+kr.Na;if(wi=uc(Zn,fi[1],wi,hi.Eb,0,Tn,0),rn.Na=kr.Na=(0<wi)+0,1<wi)Kr(Tn,0,xn,fr);else{var Dr=Tn[0]+3>>3;for(Tn=0;256>Tn;Tn+=16)xn[fr+Tn]=Dr}gi=1,hr=fi[0]}var qn=15&rn.la,si=15&kr.la;for(Tn=0;4>Tn;++Tn){var qi=1&si;for(Dr=Dn=0;4>Dr;++Dr)qn=qn>>1|(qi=(wi=uc(Zn,hr,wi=qi+(1&qn),hi.Sc,gi,xn,fr))>gi)<<7,Dn=Dn<<2|(3<wi?3:1<wi?2:xn[fr+0]!=0),fr+=16;qn>>=4,si=si>>1|qi<<7,ri=(ri<<8|Dn)>>>0}for(hr=qn,gi=si>>4,pi=0;4>pi;pi+=2){for(Dn=0,qn=rn.la>>4+pi,si=kr.la>>4+pi,Tn=0;2>Tn;++Tn){for(qi=1&si,Dr=0;2>Dr;++Dr)wi=qi+(1&qn),qn=qn>>1|(qi=0<(wi=uc(Zn,fi[2],wi,hi.Qc,0,xn,fr)))<<3,Dn=Dn<<2|(3<wi?3:1<wi?2:xn[fr+0]!=0),fr+=16;qn>>=2,si=si>>1|qi<<5}fn|=Dn<<4*pi,hr|=qn<<4<<pi,gi|=(240&si)<<pi}rn.la=hr,kr.la=gi,_i.Hc=ri,_i.Gc=fn,_i.ia=43690&fn?0:hi.ia,fi=!(ri|fn)}if(0<ft.L&&(ft.wa[ft.Y+ft.ja]=ft.gd[ln.$b][ln.Za],ft.wa[ft.Y+ft.ja].La|=!fi),Wn.Ka)return li(un,7,"Premature end-of-file encountered.")}if(Ta(un),ft=Pi,Wn=1,ln=(Lt=un).D,rn=0<Lt.L&&Lt.M>=Lt.zb&&Lt.M<=Lt.Va,Lt.Aa==0)t:{if(ln.M=Lt.M,ln.uc=rn,Ji(Lt,ln),Wn=1,ln=(Dn=Lt.D).Nb,rn=(fn=Gc[Lt.L])*Lt.R,Zn=fn/2*Lt.B,Tn=16*ln*Lt.R,Dr=8*ln*Lt.B,fi=Lt.sa,_i=Lt.ta-rn+Tn,hi=Lt.qa,xn=Lt.ra-Zn+Dr,fr=Lt.Ha,kr=Lt.Ia-Zn+Dr,si=(qn=Dn.M)==0,ri=qn>=Lt.Va-1,Lt.Aa==2&&Ji(Lt,Dn),Dn.uc)for(qi=(wi=Lt).D.M,e(wi.D.uc),Dn=wi.yb;Dn<wi.Hb;++Dn){gi=Dn,hr=qi;var Ar=($r=(er=wi).D).Nb;pi=er.R;var $r=$r.wa[$r.Y+gi],es=er.sa,Ei=er.ta+16*Ar*pi+16*gi,ji=$r.dd,Vn=$r.tc;if(Vn!=0)if(e(3<=Vn),er.L==1)0<gi&&Po(es,Ei,pi,Vn+4),$r.La&&tf(es,Ei,pi,Vn),0<hr&&ef(es,Ei,pi,Vn+4),$r.La&&Eo(es,Ei,pi,Vn);else{var ts=er.B,Is=er.qa,ps=er.ra+8*Ar*ts+8*gi,Or=er.Ha,er=er.Ia+8*Ar*ts+8*gi;Ar=$r.ld,0<gi&&(Ci(es,Ei,pi,Vn+4,ji,Ar),lc(Is,ps,Or,er,ts,Vn+4,ji,Ar)),$r.La&&(ga(es,Ei,pi,Vn,ji,Ar),$d(Is,ps,Or,er,ts,Vn,ji,Ar)),0<hr&&(Un(es,Ei,pi,Vn+4,ji,Ar),pa(Is,ps,Or,er,ts,Vn+4,ji,Ar)),$r.La&&(Es(es,Ei,pi,Vn,ji,Ar),Qd(Is,ps,Or,er,ts,Vn,ji,Ar))}}if(Lt.ia&&alert("todo:DitherRow"),ft.put!=null){if(Dn=16*qn,qn=16*(qn+1),si?(ft.y=Lt.sa,ft.O=Lt.ta+Tn,ft.f=Lt.qa,ft.N=Lt.ra+Dr,ft.ea=Lt.Ha,ft.W=Lt.Ia+Dr):(Dn-=fn,ft.y=fi,ft.O=_i,ft.f=hi,ft.N=xn,ft.ea=fr,ft.W=kr),ri||(qn-=fn),qn>ft.o&&(qn=ft.o),ft.F=null,ft.J=null,Lt.Fa!=null&&0<Lt.Fa.length&&Dn<qn&&(ft.J=gn(Lt,ft,Dn,qn-Dn),ft.F=Lt.mb,ft.F==null&&ft.F.length==0)){Wn=li(Lt,3,"Could not decode alpha data.");break t}Dn<ft.j&&(fn=ft.j-Dn,Dn=ft.j,e(!(1&fn)),ft.O+=Lt.R*fn,ft.N+=Lt.B*(fn>>1),ft.W+=Lt.B*(fn>>1),ft.F!=null&&(ft.J+=ft.width*fn)),Dn<qn&&(ft.O+=ft.v,ft.N+=ft.v>>1,ft.W+=ft.v>>1,ft.F!=null&&(ft.J+=ft.v),ft.ka=Dn-ft.j,ft.U=ft.va-ft.v,ft.T=qn-Dn,Wn=ft.put(ft))}ln+1!=Lt.Ic||ri||(i(Lt.sa,Lt.ta-rn,fi,_i+16*Lt.R,rn),i(Lt.qa,Lt.ra-Zn,hi,xn+8*Lt.B,Zn),i(Lt.Ha,Lt.Ia-Zn,fr,kr+8*Lt.B,Zn))}if(!Wn)return li(un,6,"Output aborted.")}return 1})(ce,_e)),_e.bc!=null&&_e.bc(_e),Ne&=1}return Ne?(ce.cb=0,Ne):0})(g,L)||(v=g.a)}}else v=g.a}v==0&&Y.Oa!=null&&Y.Oa.fd&&(v=rc(Y.ba))}Y=v}H=Y!=0?null:11>H?ee.f.RGBA.eb:ee.f.kb.y}else H=null;return H};var Bo=[3,4,3,4,4,2,2,4,4,4,2,1,1]};function c(O,W){for(var C="",N=0;N<4;N++)C+=String.fromCharCode(O[W++]);return C}function u(O,W){return O[W+0]|O[W+1]<<8}function f(O,W){return(O[W+0]|O[W+1]<<8|O[W+2]<<16)>>>0}function h(O,W){return(O[W+0]|O[W+1]<<8|O[W+2]<<16|O[W+3]<<24)>>>0}new l;var d=[0],y=[0],m=[],x=new l,w=t,S=(function(O,W){var C={},N=0,B=!1,E=0,R=0;if(C.frames=[],!(function(F,V){for(var G=0;G<4;G++)if(F[V+G]!="RIFF".charCodeAt(G))return!0;return!1})(O,W)){for(h(O,W+=4),W+=8;W<O.length;){var q=c(O,W),Z=h(O,W+=4);W+=4;var U=Z+(1&Z);switch(q){case"VP8 ":case"VP8L":C.frames[N]===void 0&&(C.frames[N]={}),(le=C.frames[N]).src_off=B?R:W-8,le.src_size=E+Z+8,N++,B&&(B=!1,E=0,R=0);break;case"VP8X":(le=C.header={}).feature_flags=O[W];var X=W+4;le.canvas_width=1+f(O,X),X+=3,le.canvas_height=1+f(O,X),X+=3;break;case"ALPH":B=!0,E=U+8,R=W-8;break;case"ANIM":(le=C.header).bgcolor=h(O,W),X=W+4,le.loop_count=u(O,X),X+=2;break;case"ANMF":var de,le;(le=C.frames[N]={}).offset_x=2*f(O,W),W+=3,le.offset_y=2*f(O,W),W+=3,le.width=1+f(O,W),W+=3,le.height=1+f(O,W),W+=3,le.duration=f(O,W),W+=3,de=O[W++],le.dispose=1&de,le.blend=de>>1&1}q!="ANMF"&&(W+=U)}return C}})(w,0);S.response=w,S.rgbaoutput=!0,S.dataurl=!1;var A=S.header?S.header:null,_=S.frames?S.frames:null;if(A){A.loop_counter=A.loop_count,d=[A.canvas_height],y=[A.canvas_width];for(var M=0;M<_.length&&_[M].blend!=0;M++);}var I=_[0],T=x.WebPDecodeRGBA(w,I.src_off,I.src_size,y,d);I.rgba=T,I.imgwidth=y[0],I.imgheight=d[0];for(var D=0;D<y[0]*d[0]*4;D++)m[D]=T[D];return this.width=y,this.height=d,this.data=m,this}function pF(){var t,e=this.internal.__metadata__.metadata,n=unescape(encodeURIComponent(e));t=this.internal.__metadata__.rawXml?n:'<x:xmpmeta xmlns:x="adobe:ns:meta/"><rdf:RDF xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#"><rdf:Description rdf:about="" xmlns:jspdf="'+this.internal.__metadata__.namespaceUri+'"><jspdf:metadata>'+n.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&apos;")+"</jspdf:metadata></rdf:Description></rdf:RDF></x:xmpmeta>",this.internal.__metadata__.metadataObjectNumber=this.internal.newObject(),this.internal.write("<< /Type /Metadata /Subtype /XML /Length "+t.length+" >>"),this.internal.write("stream"),this.internal.write(t),this.internal.write("endstream"),this.internal.write("endobj")}function gF(){this.internal.__metadata__.metadataObjectNumber&&this.internal.write("/Metadata "+this.internal.__metadata__.metadataObjectNumber+" 0 R")}(function(t){var e,n,i,r,s,a,o,l,c,u=function(F){return F=F||{},this.isStrokeTransparent=F.isStrokeTransparent||!1,this.strokeOpacity=F.strokeOpacity||1,this.strokeStyle=F.strokeStyle||"#000000",this.fillStyle=F.fillStyle||"#000000",this.isFillTransparent=F.isFillTransparent||!1,this.fillOpacity=F.fillOpacity||1,this.font=F.font||"10px sans-serif",this.textBaseline=F.textBaseline||"alphabetic",this.textAlign=F.textAlign||"left",this.lineWidth=F.lineWidth||1,this.lineJoin=F.lineJoin||"miter",this.lineCap=F.lineCap||"butt",this.path=F.path||[],this.transform=F.transform!==void 0?F.transform.clone():new l,this.globalCompositeOperation=F.globalCompositeOperation||"normal",this.globalAlpha=F.globalAlpha||1,this.clip_path=F.clip_path||[],this.currentPoint=F.currentPoint||new a,this.miterLimit=F.miterLimit||10,this.lastPoint=F.lastPoint||new a,this.lineDashOffset=F.lineDashOffset||0,this.lineDash=F.lineDash||[],this.margin=F.margin||[0,0,0,0],this.prevPageLastElemOffset=F.prevPageLastElemOffset||0,this.ignoreClearRect=typeof F.ignoreClearRect!="boolean"||F.ignoreClearRect,this};t.events.push(["initialized",function(){this.context2d=new f(this),e=this.internal.f2,n=this.internal.getCoordinateString,i=this.internal.getVerticalCoordinateString,r=this.internal.getHorizontalCoordinate,s=this.internal.getVerticalCoordinate,a=this.internal.Point,o=this.internal.Rectangle,l=this.internal.Matrix,c=new u}]);var f=function(F){Object.defineProperty(this,"canvas",{get:function(){return{parentNode:!1,style:!1}}});var V=F;Object.defineProperty(this,"pdf",{get:function(){return V}});var G=!1;Object.defineProperty(this,"pageWrapXEnabled",{get:function(){return G},set:function(K){G=!!K}});var se=!1;Object.defineProperty(this,"pageWrapYEnabled",{get:function(){return se},set:function(K){se=!!K}});var ae=0;Object.defineProperty(this,"posX",{get:function(){return ae},set:function(K){isNaN(K)||(ae=K)}});var te=0;Object.defineProperty(this,"posY",{get:function(){return te},set:function(K){isNaN(K)||(te=K)}}),Object.defineProperty(this,"margin",{get:function(){return c.margin},set:function(K){var Oe;typeof K=="number"?Oe=[K,K,K,K]:((Oe=new Array(4))[0]=K[0],Oe[1]=K.length>=2?K[1]:Oe[0],Oe[2]=K.length>=3?K[2]:Oe[0],Oe[3]=K.length>=4?K[3]:Oe[1]),c.margin=Oe}});var ue=!1;Object.defineProperty(this,"autoPaging",{get:function(){return ue},set:function(K){ue=K}});var pe=0;Object.defineProperty(this,"lastBreak",{get:function(){return pe},set:function(K){pe=K}});var ge=[];Object.defineProperty(this,"pageBreaks",{get:function(){return ge},set:function(K){ge=K}}),Object.defineProperty(this,"ctx",{get:function(){return c},set:function(K){K instanceof u&&(c=K)}}),Object.defineProperty(this,"path",{get:function(){return c.path},set:function(K){c.path=K}});var me=[];Object.defineProperty(this,"ctxStack",{get:function(){return me},set:function(K){me=K}}),Object.defineProperty(this,"fillStyle",{get:function(){return this.ctx.fillStyle},set:function(K){var Oe;Oe=h(K),this.ctx.fillStyle=Oe.style,this.ctx.isFillTransparent=Oe.a===0,this.ctx.fillOpacity=Oe.a,this.pdf.setFillColor(Oe.r,Oe.g,Oe.b,{a:Oe.a}),this.pdf.setTextColor(Oe.r,Oe.g,Oe.b,{a:Oe.a})}}),Object.defineProperty(this,"strokeStyle",{get:function(){return this.ctx.strokeStyle},set:function(K){var Oe=h(K);this.ctx.strokeStyle=Oe.style,this.ctx.isStrokeTransparent=Oe.a===0,this.ctx.strokeOpacity=Oe.a,Oe.a===0?this.pdf.setDrawColor(255,255,255):(Oe.a,this.pdf.setDrawColor(Oe.r,Oe.g,Oe.b))}}),Object.defineProperty(this,"lineCap",{get:function(){return this.ctx.lineCap},set:function(K){["butt","round","square"].indexOf(K)!==-1&&(this.ctx.lineCap=K,this.pdf.setLineCap(K))}}),Object.defineProperty(this,"lineWidth",{get:function(){return this.ctx.lineWidth},set:function(K){isNaN(K)||(this.ctx.lineWidth=K,this.pdf.setLineWidth(K))}}),Object.defineProperty(this,"lineJoin",{get:function(){return this.ctx.lineJoin},set:function(K){["bevel","round","miter"].indexOf(K)!==-1&&(this.ctx.lineJoin=K,this.pdf.setLineJoin(K))}}),Object.defineProperty(this,"miterLimit",{get:function(){return this.ctx.miterLimit},set:function(K){isNaN(K)||(this.ctx.miterLimit=K,this.pdf.setMiterLimit(K))}}),Object.defineProperty(this,"textBaseline",{get:function(){return this.ctx.textBaseline},set:function(K){this.ctx.textBaseline=K}}),Object.defineProperty(this,"textAlign",{get:function(){return this.ctx.textAlign},set:function(K){["right","end","center","left","start"].indexOf(K)!==-1&&(this.ctx.textAlign=K)}});var Pe=null,ke=null,Ge=null;Object.defineProperty(this,"fontFaces",{get:function(){return Ge},set:function(K){Pe=null,ke=null,Ge=K}}),Object.defineProperty(this,"font",{get:function(){return this.ctx.font},set:function(K){var Oe;if(this.ctx.font=K,(Oe=/^\s*(?=(?:(?:[-a-z]+\s*){0,2}(italic|oblique))?)(?=(?:(?:[-a-z]+\s*){0,2}(small-caps))?)(?=(?:(?:[-a-z]+\s*){0,2}(bold(?:er)?|lighter|[1-9]00))?)(?:(?:normal|\1|\2|\3)\s*){0,3}((?:xx?-)?(?:small|large)|medium|smaller|larger|[.\d]+(?:\%|in|[cem]m|ex|p[ctx]))(?:\s*\/\s*(normal|[.\d]+(?:\%|in|[cem]m|ex|p[ctx])))?\s*([-_,\"\'\sa-z0-9]+?)\s*$/i.exec(K))!==null){var Ke=Oe[1];Oe[2];var Be=Oe[3],Ee=Oe[4];Oe[5];var at=Oe[6],Ue=/^([.\d]+)((?:%|in|[cem]m|ex|p[ctx]))$/i.exec(Ee)[2];Ee=Math.floor(Ue==="px"?parseFloat(Ee)*this.pdf.internal.scaleFactor:Ue==="em"?parseFloat(Ee)*this.pdf.getFontSize():parseFloat(Ee)*this.pdf.internal.scaleFactor),this.pdf.setFontSize(Ee);var Ye=(function(et){var vt,wt,Nt=[],it=et.trim();if(it==="")return Hg;if(it in hy)return[hy[it]];for(;it!=="";){switch(wt=null,vt=(it=gy(it)).charAt(0)){case'"':case"'":wt=lF(it.substring(1),vt);break;default:wt=cF(it)}if(wt===null||(Nt.push(wt[0]),(it=gy(wt[1]))!==""&&it.charAt(0)!==","))return Hg;it=it.replace(/^,/,"")}return Nt})(at);if(this.fontFaces){var ut=(function(et,vt){var wt=et.getFontList(),Nt=JSON.stringify(wt);if(Pe===null||ke!==Nt){var it=(function(kt){var ct=[];return Object.keys(kt).forEach(function(yt){kt[yt].forEach(function(st){var gt=null;switch(st){case"bold":gt={family:yt,weight:"bold"};break;case"italic":gt={family:yt,style:"italic"};break;case"bolditalic":gt={family:yt,weight:"bold",style:"italic"};break;case"":case"normal":gt={family:yt}}gt!==null&&(gt.ref={name:yt,style:st},ct.push(gt))})}),ct})(wt);Pe=(function(kt){for(var ct={},yt=0;yt<kt.length;++yt){var st=jg(kt[yt]),gt=st.family,Bt=st.stretch,xt=st.style,dt=st.weight;ct[gt]=ct[gt]||{},ct[gt][Bt]=ct[gt][Bt]||{},ct[gt][Bt][xt]=ct[gt][Bt][xt]||{},ct[gt][Bt][xt][dt]=st}return ct})(it.concat(vt)),ke=Nt}return Pe})(this.pdf,this.fontFaces),Ft=Ye.map(function(et){return{family:et,stretch:"normal",weight:Be,style:Ke}}),be=(function(et,vt,wt){for(var Nt=(wt=wt||{}).defaultFontFamily||"times",it=Object.assign({},oF,wt.genericFontFamilies||{}),kt=null,ct=null,yt=0;yt<vt.length;++yt)if(it[(kt=jg(vt[yt])).family]&&(kt.family=it[kt.family]),et.hasOwnProperty(kt.family)){ct=et[kt.family];break}if(!(ct=ct||et[Nt]))throw new Error("Could not find a font-family for the rule '"+py(kt)+"' and default family '"+Nt+"'.");if(ct=(function(st,gt){if(gt[st])return gt[st];var Bt=Zm[st],xt=Bt<=Zm.normal?-1:1,dt=fy(gt,Vx,Bt,xt);if(!dt)throw new Error("Could not find a matching font-stretch value for "+st);return dt})(kt.stretch,ct),ct=(function(st,gt){if(gt[st])return gt[st];for(var Bt=Wx[st],xt=0;xt<Bt.length;++xt)if(gt[Bt[xt]])return gt[Bt[xt]];throw new Error("Could not find a matching font-style for "+st)})(kt.style,ct),!(ct=(function(st,gt){if(gt[st])return gt[st];if(st===400&&gt[500])return gt[500];if(st===500&&gt[400])return gt[400];var Bt=aF[st],xt=fy(gt,Gx,Bt,st<400?-1:1);if(!xt)throw new Error("Could not find a matching font-weight for value "+st);return xt})(kt.weight,ct)))throw new Error("Failed to resolve a font for the rule '"+py(kt)+"'.");return ct})(ut,Ft);this.pdf.setFont(be.ref.name,be.ref.style)}else{var ze="";(Be==="bold"||parseInt(Be,10)>=700||Ke==="bold")&&(ze="bold"),Ke==="italic"&&(ze+="italic"),ze.length===0&&(ze="normal");for(var ve="",Ce={arial:"Helvetica",Arial:"Helvetica",verdana:"Helvetica",Verdana:"Helvetica",helvetica:"Helvetica",Helvetica:"Helvetica","sans-serif":"Helvetica",fixed:"Courier",monospace:"Courier",terminal:"Courier",cursive:"Times",fantasy:"Times",serif:"Times"},Ie=0;Ie<Ye.length;Ie++){if(this.pdf.internal.getFont(Ye[Ie],ze,{noFallback:!0,disableWarning:!0})!==void 0){ve=Ye[Ie];break}if(ze==="bolditalic"&&this.pdf.internal.getFont(Ye[Ie],"bold",{noFallback:!0,disableWarning:!0})!==void 0)ve=Ye[Ie],ze="bold";else if(this.pdf.internal.getFont(Ye[Ie],"normal",{noFallback:!0,disableWarning:!0})!==void 0){ve=Ye[Ie],ze="normal";break}}if(ve===""){for(var rt=0;rt<Ye.length;rt++)if(Ce[Ye[rt]]){ve=Ce[Ye[rt]];break}}ve=ve===""?"Times":ve,this.pdf.setFont(ve,ze)}}}}),Object.defineProperty(this,"globalCompositeOperation",{get:function(){return this.ctx.globalCompositeOperation},set:function(K){this.ctx.globalCompositeOperation=K}}),Object.defineProperty(this,"globalAlpha",{get:function(){return this.ctx.globalAlpha},set:function(K){this.ctx.globalAlpha=K}}),Object.defineProperty(this,"lineDashOffset",{get:function(){return this.ctx.lineDashOffset},set:function(K){this.ctx.lineDashOffset=K,le.call(this)}}),Object.defineProperty(this,"lineDash",{get:function(){return this.ctx.lineDash},set:function(K){this.ctx.lineDash=K,le.call(this)}}),Object.defineProperty(this,"ignoreClearRect",{get:function(){return this.ctx.ignoreClearRect},set:function(K){this.ctx.ignoreClearRect=!!K}})};f.prototype.setLineDash=function(F){this.lineDash=F},f.prototype.getLineDash=function(){return this.lineDash.length%2?this.lineDash.concat(this.lineDash):this.lineDash.slice()},f.prototype.fill=function(){_.call(this,"fill",!1)},f.prototype.stroke=function(){_.call(this,"stroke",!1)},f.prototype.beginPath=function(){this.path=[{type:"begin"}]},f.prototype.moveTo=function(F,V){if(isNaN(F)||isNaN(V))throw Qn.error("jsPDF.context2d.moveTo: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.moveTo");var G=this.ctx.transform.applyToPoint(new a(F,V));this.path.push({type:"mt",x:G.x,y:G.y}),this.ctx.lastPoint=new a(F,V)},f.prototype.closePath=function(){var F=new a(0,0),V=0;for(V=this.path.length-1;V!==-1;V--)if(this.path[V].type==="begin"&&jn(this.path[V+1])==="object"&&typeof this.path[V+1].x=="number"){F=new a(this.path[V+1].x,this.path[V+1].y);break}this.path.push({type:"close"}),this.ctx.lastPoint=new a(F.x,F.y)},f.prototype.lineTo=function(F,V){if(isNaN(F)||isNaN(V))throw Qn.error("jsPDF.context2d.lineTo: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.lineTo");var G=this.ctx.transform.applyToPoint(new a(F,V));this.path.push({type:"lt",x:G.x,y:G.y}),this.ctx.lastPoint=new a(G.x,G.y)},f.prototype.clip=function(){this.ctx.clip_path=JSON.parse(JSON.stringify(this.path)),_.call(this,null,!0)},f.prototype.quadraticCurveTo=function(F,V,G,se){if(isNaN(G)||isNaN(se)||isNaN(F)||isNaN(V))throw Qn.error("jsPDF.context2d.quadraticCurveTo: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.quadraticCurveTo");var ae=this.ctx.transform.applyToPoint(new a(G,se)),te=this.ctx.transform.applyToPoint(new a(F,V));this.path.push({type:"qct",x1:te.x,y1:te.y,x:ae.x,y:ae.y}),this.ctx.lastPoint=new a(ae.x,ae.y)},f.prototype.bezierCurveTo=function(F,V,G,se,ae,te){if(isNaN(ae)||isNaN(te)||isNaN(F)||isNaN(V)||isNaN(G)||isNaN(se))throw Qn.error("jsPDF.context2d.bezierCurveTo: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.bezierCurveTo");var ue=this.ctx.transform.applyToPoint(new a(ae,te)),pe=this.ctx.transform.applyToPoint(new a(F,V)),ge=this.ctx.transform.applyToPoint(new a(G,se));this.path.push({type:"bct",x1:pe.x,y1:pe.y,x2:ge.x,y2:ge.y,x:ue.x,y:ue.y}),this.ctx.lastPoint=new a(ue.x,ue.y)},f.prototype.arc=function(F,V,G,se,ae,te){if(isNaN(F)||isNaN(V)||isNaN(G)||isNaN(se)||isNaN(ae))throw Qn.error("jsPDF.context2d.arc: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.arc");if(te=!!te,!this.ctx.transform.isIdentity){var ue=this.ctx.transform.applyToPoint(new a(F,V));F=ue.x,V=ue.y;var pe=this.ctx.transform.applyToPoint(new a(0,G)),ge=this.ctx.transform.applyToPoint(new a(0,0));G=Math.sqrt(Math.pow(pe.x-ge.x,2)+Math.pow(pe.y-ge.y,2))}Math.abs(ae-se)>=2*Math.PI&&(se=0,ae=2*Math.PI),this.path.push({type:"arc",x:F,y:V,radius:G,startAngle:se,endAngle:ae,counterclockwise:te})},f.prototype.arcTo=function(F,V,G,se,ae){throw new Error("arcTo not implemented.")},f.prototype.rect=function(F,V,G,se){if(isNaN(F)||isNaN(V)||isNaN(G)||isNaN(se))throw Qn.error("jsPDF.context2d.rect: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.rect");this.moveTo(F,V),this.lineTo(F+G,V),this.lineTo(F+G,V+se),this.lineTo(F,V+se),this.lineTo(F,V),this.lineTo(F+G,V),this.lineTo(F,V)},f.prototype.fillRect=function(F,V,G,se){if(isNaN(F)||isNaN(V)||isNaN(G)||isNaN(se))throw Qn.error("jsPDF.context2d.fillRect: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.fillRect");if(!d.call(this)){var ae={};this.lineCap!=="butt"&&(ae.lineCap=this.lineCap,this.lineCap="butt"),this.lineJoin!=="miter"&&(ae.lineJoin=this.lineJoin,this.lineJoin="miter"),this.beginPath(),this.rect(F,V,G,se),this.fill(),ae.hasOwnProperty("lineCap")&&(this.lineCap=ae.lineCap),ae.hasOwnProperty("lineJoin")&&(this.lineJoin=ae.lineJoin)}},f.prototype.strokeRect=function(F,V,G,se){if(isNaN(F)||isNaN(V)||isNaN(G)||isNaN(se))throw Qn.error("jsPDF.context2d.strokeRect: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.strokeRect");y.call(this)||(this.beginPath(),this.rect(F,V,G,se),this.stroke())},f.prototype.clearRect=function(F,V,G,se){if(isNaN(F)||isNaN(V)||isNaN(G)||isNaN(se))throw Qn.error("jsPDF.context2d.clearRect: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.clearRect");this.ignoreClearRect||(this.fillStyle="#ffffff",this.fillRect(F,V,G,se))},f.prototype.save=function(F){F=typeof F!="boolean"||F;for(var V=this.pdf.internal.getCurrentPageInfo().pageNumber,G=0;G<this.pdf.internal.getNumberOfPages();G++)this.pdf.setPage(G+1),this.pdf.internal.out("q");if(this.pdf.setPage(V),F){this.ctx.fontSize=this.pdf.internal.getFontSize();var se=new u(this.ctx);this.ctxStack.push(this.ctx),this.ctx=se}},f.prototype.restore=function(F){F=typeof F!="boolean"||F;for(var V=this.pdf.internal.getCurrentPageInfo().pageNumber,G=0;G<this.pdf.internal.getNumberOfPages();G++)this.pdf.setPage(G+1),this.pdf.internal.out("Q");this.pdf.setPage(V),F&&this.ctxStack.length!==0&&(this.ctx=this.ctxStack.pop(),this.fillStyle=this.ctx.fillStyle,this.strokeStyle=this.ctx.strokeStyle,this.font=this.ctx.font,this.lineCap=this.ctx.lineCap,this.lineWidth=this.ctx.lineWidth,this.lineJoin=this.ctx.lineJoin,this.lineDash=this.ctx.lineDash,this.lineDashOffset=this.ctx.lineDashOffset)},f.prototype.toDataURL=function(){throw new Error("toDataUrl not implemented.")};var h=function(F){var V,G,se,ae;if(F.isCanvasGradient===!0&&(F=F.getColor()),!F)return{r:0,g:0,b:0,a:0,style:F};if(/transparent|rgba\s*\(\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*,\s*0+\s*\)/.test(F))V=0,G=0,se=0,ae=0;else{var te=/rgb\s*\(\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*\)/.exec(F);if(te!==null)V=parseInt(te[1]),G=parseInt(te[2]),se=parseInt(te[3]),ae=1;else if((te=/rgba\s*\(\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*,\s*([\d.]+)\s*\)/.exec(F))!==null)V=parseInt(te[1]),G=parseInt(te[2]),se=parseInt(te[3]),ae=parseFloat(te[4]);else{if(ae=1,typeof F=="string"&&F.charAt(0)!=="#"){var ue=new Rx(F);F=ue.ok?ue.toHex():"#000000"}F.length===4?(V=F.substring(1,2),V+=V,G=F.substring(2,3),G+=G,se=F.substring(3,4),se+=se):(V=F.substring(1,3),G=F.substring(3,5),se=F.substring(5,7)),V=parseInt(V,16),G=parseInt(G,16),se=parseInt(se,16)}}return{r:V,g:G,b:se,a:ae,style:F}},d=function(){return this.ctx.isFillTransparent||this.globalAlpha==0},y=function(){return!!(this.ctx.isStrokeTransparent||this.globalAlpha==0)};f.prototype.fillText=function(F,V,G,se){if(isNaN(V)||isNaN(G)||typeof F!="string")throw Qn.error("jsPDF.context2d.fillText: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.fillText");if(se=isNaN(se)?void 0:se,!d.call(this)){var ae=U(this.ctx.transform.rotation),te=this.ctx.transform.scaleX;N.call(this,{text:F,x:V,y:G,scale:te,angle:ae,align:this.textAlign,maxWidth:se})}},f.prototype.strokeText=function(F,V,G,se){if(isNaN(V)||isNaN(G)||typeof F!="string")throw Qn.error("jsPDF.context2d.strokeText: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.strokeText");if(!y.call(this)){se=isNaN(se)?void 0:se;var ae=U(this.ctx.transform.rotation),te=this.ctx.transform.scaleX;N.call(this,{text:F,x:V,y:G,scale:te,renderingMode:"stroke",angle:ae,align:this.textAlign,maxWidth:se})}},f.prototype.measureText=function(F){if(typeof F!="string")throw Qn.error("jsPDF.context2d.measureText: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.measureText");var V=this.pdf,G=this.pdf.internal.scaleFactor,se=V.internal.getFontSize(),ae=V.getStringUnitWidth(F)*se/V.internal.scaleFactor;return new function(te){var ue=(te=te||{}).width||0;return Object.defineProperty(this,"width",{get:function(){return ue}}),this}({width:ae*=Math.round(96*G/72*1e4)/1e4})},f.prototype.scale=function(F,V){if(isNaN(F)||isNaN(V))throw Qn.error("jsPDF.context2d.scale: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.scale");var G=new l(F,0,0,V,0,0);this.ctx.transform=this.ctx.transform.multiply(G)},f.prototype.rotate=function(F){if(isNaN(F))throw Qn.error("jsPDF.context2d.rotate: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.rotate");var V=new l(Math.cos(F),Math.sin(F),-Math.sin(F),Math.cos(F),0,0);this.ctx.transform=this.ctx.transform.multiply(V)},f.prototype.translate=function(F,V){if(isNaN(F)||isNaN(V))throw Qn.error("jsPDF.context2d.translate: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.translate");var G=new l(1,0,0,1,F,V);this.ctx.transform=this.ctx.transform.multiply(G)},f.prototype.transform=function(F,V,G,se,ae,te){if(isNaN(F)||isNaN(V)||isNaN(G)||isNaN(se)||isNaN(ae)||isNaN(te))throw Qn.error("jsPDF.context2d.transform: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.transform");var ue=new l(F,V,G,se,ae,te);this.ctx.transform=this.ctx.transform.multiply(ue)},f.prototype.setTransform=function(F,V,G,se,ae,te){F=isNaN(F)?1:F,V=isNaN(V)?0:V,G=isNaN(G)?0:G,se=isNaN(se)?1:se,ae=isNaN(ae)?0:ae,te=isNaN(te)?0:te,this.ctx.transform=new l(F,V,G,se,ae,te)};var m=function(){return this.margin[0]>0||this.margin[1]>0||this.margin[2]>0||this.margin[3]>0};f.prototype.drawImage=function(F,V,G,se,ae,te,ue,pe,ge){var me=this.pdf.getImageProperties(F),Pe=1,ke=1,Ge=1,K=1;se!==void 0&&pe!==void 0&&(Ge=pe/se,K=ge/ae,Pe=me.width/se*pe/se,ke=me.height/ae*ge/ae),te===void 0&&(te=V,ue=G,V=0,G=0),se!==void 0&&pe===void 0&&(pe=se,ge=ae),se===void 0&&pe===void 0&&(pe=me.width,ge=me.height);var Oe=this.ctx.transform.decompose(),Ke=U(Oe.rotate.shx),Be=new l,Ee=(Be=(Be=(Be=Be.multiply(Oe.translate)).multiply(Oe.skew)).multiply(Oe.scale)).applyToRectangle(new o(te-V*Ge,ue-G*K,se*Pe,ae*ke));if(this.autoPaging){for(var at,Ue=x.call(this,Ee),Ye=[],ut=0;ut<Ue.length;ut+=1)Ye.indexOf(Ue[ut])===-1&&Ye.push(Ue[ut]);A(Ye);for(var Ft=Ye[0],be=Ye[Ye.length-1],ze=Ft;ze<be+1;ze++){this.pdf.setPage(ze);var ve=this.pdf.internal.pageSize.width-this.margin[3]-this.margin[1],Ce=ze===1?this.posY+this.margin[0]:this.margin[0],Ie=this.pdf.internal.pageSize.height-this.posY-this.margin[0]-this.margin[2],rt=this.pdf.internal.pageSize.height-this.margin[0]-this.margin[2],et=ze===1?0:Ie+(ze-2)*rt;if(this.ctx.clip_path.length!==0){var vt=this.path;at=JSON.parse(JSON.stringify(this.ctx.clip_path)),this.path=S(at,this.posX+this.margin[3],-et+Ce+this.ctx.prevPageLastElemOffset),M.call(this,"fill",!0),this.path=vt}var wt=JSON.parse(JSON.stringify(Ee));wt=S([wt],this.posX+this.margin[3],-et+Ce+this.ctx.prevPageLastElemOffset)[0];var Nt=(ze>Ft||ze<be)&&m.call(this);Nt&&(this.pdf.saveGraphicsState(),this.pdf.rect(this.margin[3],this.margin[0],ve,rt,null).clip().discardPath()),this.pdf.addImage(F,"JPEG",wt.x,wt.y,wt.w,wt.h,null,null,Ke),Nt&&this.pdf.restoreGraphicsState()}}else this.pdf.addImage(F,"JPEG",Ee.x,Ee.y,Ee.w,Ee.h,null,null,Ke)};var x=function(F,V,G){var se=[];V=V||this.pdf.internal.pageSize.width,G=G||this.pdf.internal.pageSize.height-this.margin[0]-this.margin[2];var ae=this.posY+this.ctx.prevPageLastElemOffset;switch(F.type){default:case"mt":case"lt":se.push(Math.floor((F.y+ae)/G)+1);break;case"arc":se.push(Math.floor((F.y+ae-F.radius)/G)+1),se.push(Math.floor((F.y+ae+F.radius)/G)+1);break;case"qct":var te=X(this.ctx.lastPoint.x,this.ctx.lastPoint.y,F.x1,F.y1,F.x,F.y);se.push(Math.floor((te.y+ae)/G)+1),se.push(Math.floor((te.y+te.h+ae)/G)+1);break;case"bct":var ue=de(this.ctx.lastPoint.x,this.ctx.lastPoint.y,F.x1,F.y1,F.x2,F.y2,F.x,F.y);se.push(Math.floor((ue.y+ae)/G)+1),se.push(Math.floor((ue.y+ue.h+ae)/G)+1);break;case"rect":se.push(Math.floor((F.y+ae)/G)+1),se.push(Math.floor((F.y+F.h+ae)/G)+1)}for(var pe=0;pe<se.length;pe+=1)for(;this.pdf.internal.getNumberOfPages()<se[pe];)w.call(this);return se},w=function(){var F=this.fillStyle,V=this.strokeStyle,G=this.font,se=this.lineCap,ae=this.lineWidth,te=this.lineJoin;this.pdf.addPage(),this.fillStyle=F,this.strokeStyle=V,this.font=G,this.lineCap=se,this.lineWidth=ae,this.lineJoin=te},S=function(F,V,G){for(var se=0;se<F.length;se++)switch(F[se].type){case"bct":F[se].x2+=V,F[se].y2+=G;case"qct":F[se].x1+=V,F[se].y1+=G;default:F[se].x+=V,F[se].y+=G}return F},A=function(F){return F.sort(function(V,G){return V-G})},_=function(F,V){var G=this.fillStyle,se=this.strokeStyle,ae=this.lineCap,te=this.lineWidth,ue=Math.abs(te*this.ctx.transform.scaleX),pe=this.lineJoin;if(this.autoPaging){for(var ge,me,Pe=JSON.parse(JSON.stringify(this.path)),ke=JSON.parse(JSON.stringify(this.path)),Ge=[],K=0;K<ke.length;K++)if(ke[K].x!==void 0)for(var Oe=x.call(this,ke[K]),Ke=0;Ke<Oe.length;Ke+=1)Ge.indexOf(Oe[Ke])===-1&&Ge.push(Oe[Ke]);for(var Be=0;Be<Ge.length;Be++)for(;this.pdf.internal.getNumberOfPages()<Ge[Be];)w.call(this);A(Ge);for(var Ee=Ge[0],at=Ge[Ge.length-1],Ue=Ee;Ue<at+1;Ue++){this.pdf.setPage(Ue),this.fillStyle=G,this.strokeStyle=se,this.lineCap=ae,this.lineWidth=ue,this.lineJoin=pe;var Ye=this.pdf.internal.pageSize.width-this.margin[3]-this.margin[1],ut=Ue===1?this.posY+this.margin[0]:this.margin[0],Ft=this.pdf.internal.pageSize.height-this.posY-this.margin[0]-this.margin[2],be=this.pdf.internal.pageSize.height-this.margin[0]-this.margin[2],ze=Ue===1?0:Ft+(Ue-2)*be;if(this.ctx.clip_path.length!==0){var ve=this.path;ge=JSON.parse(JSON.stringify(this.ctx.clip_path)),this.path=S(ge,this.posX+this.margin[3],-ze+ut+this.ctx.prevPageLastElemOffset),M.call(this,F,!0),this.path=ve}if(me=JSON.parse(JSON.stringify(Pe)),this.path=S(me,this.posX+this.margin[3],-ze+ut+this.ctx.prevPageLastElemOffset),V===!1||Ue===0){var Ce=(Ue>Ee||Ue<at)&&m.call(this);Ce&&(this.pdf.saveGraphicsState(),this.pdf.rect(this.margin[3],this.margin[0],Ye,be,null).clip().discardPath()),M.call(this,F,V),Ce&&this.pdf.restoreGraphicsState()}this.lineWidth=te}this.path=Pe}else this.lineWidth=ue,M.call(this,F,V),this.lineWidth=te},M=function(F,V){if((F!=="stroke"||V||!y.call(this))&&(F==="stroke"||V||!d.call(this))){for(var G,se,ae=[],te=this.path,ue=0;ue<te.length;ue++){var pe=te[ue];switch(pe.type){case"begin":ae.push({begin:!0});break;case"close":ae.push({close:!0});break;case"mt":ae.push({start:pe,deltas:[],abs:[]});break;case"lt":var ge=ae.length;if(te[ue-1]&&!isNaN(te[ue-1].x)&&(G=[pe.x-te[ue-1].x,pe.y-te[ue-1].y],ge>0)){for(;ge>=0;ge--)if(ae[ge-1].close!==!0&&ae[ge-1].begin!==!0){ae[ge-1].deltas.push(G),ae[ge-1].abs.push(pe);break}}break;case"bct":G=[pe.x1-te[ue-1].x,pe.y1-te[ue-1].y,pe.x2-te[ue-1].x,pe.y2-te[ue-1].y,pe.x-te[ue-1].x,pe.y-te[ue-1].y],ae[ae.length-1].deltas.push(G);break;case"qct":var me=te[ue-1].x+2/3*(pe.x1-te[ue-1].x),Pe=te[ue-1].y+2/3*(pe.y1-te[ue-1].y),ke=pe.x+2/3*(pe.x1-pe.x),Ge=pe.y+2/3*(pe.y1-pe.y),K=pe.x,Oe=pe.y;G=[me-te[ue-1].x,Pe-te[ue-1].y,ke-te[ue-1].x,Ge-te[ue-1].y,K-te[ue-1].x,Oe-te[ue-1].y],ae[ae.length-1].deltas.push(G);break;case"arc":ae.push({deltas:[],abs:[],arc:!0}),Array.isArray(ae[ae.length-1].abs)&&ae[ae.length-1].abs.push(pe)}}se=V?null:F==="stroke"?"stroke":"fill";for(var Ke=!1,Be=0;Be<ae.length;Be++)if(ae[Be].arc)for(var Ee=ae[Be].abs,at=0;at<Ee.length;at++){var Ue=Ee[at];Ue.type==="arc"?D.call(this,Ue.x,Ue.y,Ue.radius,Ue.startAngle,Ue.endAngle,Ue.counterclockwise,void 0,V,!Ke):B.call(this,Ue.x,Ue.y),Ke=!0}else if(ae[Be].close===!0)this.pdf.internal.out("h"),Ke=!1;else if(ae[Be].begin!==!0){var Ye=ae[Be].start.x,ut=ae[Be].start.y;E.call(this,ae[Be].deltas,Ye,ut),Ke=!0}se&&O.call(this,se),V&&W.call(this)}},I=function(F){var V=this.pdf.internal.getFontSize()/this.pdf.internal.scaleFactor,G=V*(this.pdf.internal.getLineHeightFactor()-1);switch(this.ctx.textBaseline){case"bottom":return F-G;case"top":return F+V-G;case"hanging":return F+V-2*G;case"middle":return F+V/2-G;default:return F}},T=function(F){return F+this.pdf.internal.getFontSize()/this.pdf.internal.scaleFactor*(this.pdf.internal.getLineHeightFactor()-1)};f.prototype.createLinearGradient=function(){var F=function(){};return F.colorStops=[],F.addColorStop=function(V,G){this.colorStops.push([V,G])},F.getColor=function(){return this.colorStops.length===0?"#000000":this.colorStops[0][1]},F.isCanvasGradient=!0,F},f.prototype.createPattern=function(){return this.createLinearGradient()},f.prototype.createRadialGradient=function(){return this.createLinearGradient()};var D=function(F,V,G,se,ae,te,ue,pe,ge){for(var me=q.call(this,G,se,ae,te),Pe=0;Pe<me.length;Pe++){var ke=me[Pe];Pe===0&&(ge?C.call(this,ke.x1+F,ke.y1+V):B.call(this,ke.x1+F,ke.y1+V)),R.call(this,F,V,ke.x2,ke.y2,ke.x3,ke.y3,ke.x4,ke.y4)}pe?W.call(this):O.call(this,ue)},O=function(F){switch(F){case"stroke":this.pdf.internal.out("S");break;case"fill":this.pdf.internal.out("f")}},W=function(){this.pdf.clip(),this.pdf.discardPath()},C=function(F,V){this.pdf.internal.out(n(F)+" "+i(V)+" m")},N=function(F){var V;switch(F.align){case"right":case"end":V="right";break;case"center":V="center";break;default:V="left"}var G,se,ae,te=this.pdf.getTextDimensions(F.text),ue=I.call(this,F.y),pe=T.call(this,ue)-te.h,ge=this.ctx.transform.applyToPoint(new a(F.x,ue));if(this.autoPaging){var me=this.ctx.transform.decompose(),Pe=new l;Pe=(Pe=(Pe=Pe.multiply(me.translate)).multiply(me.skew)).multiply(me.scale);for(var ke=this.ctx.transform.applyToRectangle(new o(F.x,ue,te.w,te.h)),Ge=Pe.applyToRectangle(new o(F.x,pe,te.w,te.h)),K=x.call(this,Ge),Oe=[],Ke=0;Ke<K.length;Ke+=1)Oe.indexOf(K[Ke])===-1&&Oe.push(K[Ke]);A(Oe);for(var Be=Oe[0],Ee=Oe[Oe.length-1],at=Be;at<Ee+1;at++){this.pdf.setPage(at);var Ue=at===1?this.posY+this.margin[0]:this.margin[0],Ye=this.pdf.internal.pageSize.height-this.posY-this.margin[0]-this.margin[2],ut=this.pdf.internal.pageSize.height-this.margin[2],Ft=ut-this.margin[0],be=this.pdf.internal.pageSize.width-this.margin[1],ze=be-this.margin[3],ve=at===1?0:Ye+(at-2)*Ft;if(this.ctx.clip_path.length!==0){var Ce=this.path;G=JSON.parse(JSON.stringify(this.ctx.clip_path)),this.path=S(G,this.posX+this.margin[3],-1*ve+Ue),M.call(this,"fill",!0),this.path=Ce}var Ie=S([JSON.parse(JSON.stringify(Ge))],this.posX+this.margin[3],-ve+Ue+this.ctx.prevPageLastElemOffset)[0];F.scale>=.01&&(se=this.pdf.internal.getFontSize(),this.pdf.setFontSize(se*F.scale),ae=this.lineWidth,this.lineWidth=ae*F.scale);var rt=this.autoPaging!=="text";if(rt||Ie.y+Ie.h<=ut){if(rt||Ie.y>=Ue&&Ie.x<=be){var et=rt?F.text:this.pdf.splitTextToSize(F.text,F.maxWidth||be-Ie.x)[0],vt=S([JSON.parse(JSON.stringify(ke))],this.posX+this.margin[3],-ve+Ue+this.ctx.prevPageLastElemOffset)[0],wt=rt&&(at>Be||at<Ee)&&m.call(this);wt&&(this.pdf.saveGraphicsState(),this.pdf.rect(this.margin[3],this.margin[0],ze,Ft,null).clip().discardPath()),this.pdf.text(et,vt.x,vt.y,{angle:F.angle,align:V,renderingMode:F.renderingMode}),wt&&this.pdf.restoreGraphicsState()}}else Ie.y<ut&&(this.ctx.prevPageLastElemOffset+=ut-Ie.y);F.scale>=.01&&(this.pdf.setFontSize(se),this.lineWidth=ae)}}else F.scale>=.01&&(se=this.pdf.internal.getFontSize(),this.pdf.setFontSize(se*F.scale),ae=this.lineWidth,this.lineWidth=ae*F.scale),this.pdf.text(F.text,ge.x+this.posX,ge.y+this.posY,{angle:F.angle,align:V,renderingMode:F.renderingMode,maxWidth:F.maxWidth}),F.scale>=.01&&(this.pdf.setFontSize(se),this.lineWidth=ae)},B=function(F,V,G,se){G=G||0,se=se||0,this.pdf.internal.out(n(F+G)+" "+i(V+se)+" l")},E=function(F,V,G){return this.pdf.lines(F,V,G,null,null)},R=function(F,V,G,se,ae,te,ue,pe){this.pdf.internal.out([e(r(G+F)),e(s(se+V)),e(r(ae+F)),e(s(te+V)),e(r(ue+F)),e(s(pe+V)),"c"].join(" "))},q=function(F,V,G,se){for(var ae=2*Math.PI,te=Math.PI/2;V>G;)V-=ae;var ue=Math.abs(G-V);ue<ae&&se&&(ue=ae-ue);for(var pe=[],ge=se?-1:1,me=V;ue>1e-5;){var Pe=me+ge*Math.min(ue,te);pe.push(Z.call(this,F,me,Pe)),ue-=Math.abs(Pe-me),me=Pe}return pe},Z=function(F,V,G){var se=(G-V)/2,ae=F*Math.cos(se),te=F*Math.sin(se),ue=ae,pe=-te,ge=ue*ue+pe*pe,me=ge+ue*ae+pe*te,Pe=4/3*(Math.sqrt(2*ge*me)-me)/(ue*te-pe*ae),ke=ue-Pe*pe,Ge=pe+Pe*ue,K=ke,Oe=-Ge,Ke=se+V,Be=Math.cos(Ke),Ee=Math.sin(Ke);return{x1:F*Math.cos(V),y1:F*Math.sin(V),x2:ke*Be-Ge*Ee,y2:ke*Ee+Ge*Be,x3:K*Be-Oe*Ee,y3:K*Ee+Oe*Be,x4:F*Math.cos(G),y4:F*Math.sin(G)}},U=function(F){return 180*F/Math.PI},X=function(F,V,G,se,ae,te){var ue=F+.5*(G-F),pe=V+.5*(se-V),ge=ae+.5*(G-ae),me=te+.5*(se-te),Pe=Math.min(F,ae,ue,ge),ke=Math.max(F,ae,ue,ge),Ge=Math.min(V,te,pe,me),K=Math.max(V,te,pe,me);return new o(Pe,Ge,ke-Pe,K-Ge)},de=function(F,V,G,se,ae,te,ue,pe){var ge,me,Pe,ke,Ge,K,Oe,Ke,Be,Ee,at,Ue,Ye,ut,Ft=G-F,be=se-V,ze=ae-G,ve=te-se,Ce=ue-ae,Ie=pe-te;for(me=0;me<41;me++)Be=(Oe=(Pe=F+(ge=me/40)*Ft)+ge*((Ge=G+ge*ze)-Pe))+ge*(Ge+ge*(ae+ge*Ce-Ge)-Oe),Ee=(Ke=(ke=V+ge*be)+ge*((K=se+ge*ve)-ke))+ge*(K+ge*(te+ge*Ie-K)-Ke),me==0?(at=Be,Ue=Ee,Ye=Be,ut=Ee):(at=Math.min(at,Be),Ue=Math.min(Ue,Ee),Ye=Math.max(Ye,Be),ut=Math.max(ut,Ee));return new o(Math.round(at),Math.round(Ue),Math.round(Ye-at),Math.round(ut-Ue))},le=function(){if(this.prevLineDash||this.ctx.lineDash.length||this.ctx.lineDashOffset){var F,V,G=(F=this.ctx.lineDash,V=this.ctx.lineDashOffset,JSON.stringify({lineDash:F,lineDashOffset:V}));this.prevLineDash!==G&&(this.pdf.setLineDash(this.ctx.lineDash,this.ctx.lineDashOffset),this.prevLineDash=G)}}})(qt.API),(function(t){var e=function(a){var o,l,c,u,f,h,d,y,m,x;for(l=[],c=0,u=(a+=o="\0\0\0\0".slice(a.length%4||4)).length;u>c;c+=4)(f=(a.charCodeAt(c)<<24)+(a.charCodeAt(c+1)<<16)+(a.charCodeAt(c+2)<<8)+a.charCodeAt(c+3))!==0?(h=(f=((f=((f=((f=(f-(x=f%85))/85)-(m=f%85))/85)-(y=f%85))/85)-(d=f%85))/85)%85,l.push(h+33,d+33,y+33,m+33,x+33)):l.push(122);return(function(w,S){for(var A=S;A>0;A--)w.pop()})(l,o.length),String.fromCharCode.apply(String,l)+"~>"},n=function(a){var o,l,c,u,f,h=String,d="length",y=255,m="charCodeAt",x="slice",w="replace";for(a[x](-2),a=a[x](0,-2)[w](/\s/g,"")[w]("z","!!!!!"),c=[],u=0,f=(a+=o="uuuuu"[x](a[d]%5||5))[d];f>u;u+=5)l=52200625*(a[m](u)-33)+614125*(a[m](u+1)-33)+7225*(a[m](u+2)-33)+85*(a[m](u+3)-33)+(a[m](u+4)-33),c.push(y&l>>24,y&l>>16,y&l>>8,y&l);return(function(S,A){for(var _=A;_>0;_--)S.pop()})(c,o[d]),h.fromCharCode.apply(h,c)},i=function(a){return a.split("").map(function(o){return("0"+o.charCodeAt().toString(16)).slice(-2)}).join("")+">"},r=function(a){var o=new RegExp(/^([0-9A-Fa-f]{2})+$/);if((a=a.replace(/\s/g,"")).indexOf(">")!==-1&&(a=a.substr(0,a.indexOf(">"))),a.length%2&&(a+="0"),o.test(a)===!1)return"";for(var l="",c=0;c<a.length;c+=2)l+=String.fromCharCode("0x"+(a[c]+a[c+1]));return l},s=function(a){for(var o=new Uint8Array(a.length),l=a.length;l--;)o[l]=a.charCodeAt(l);return(o=Um(o)).reduce(function(c,u){return c+String.fromCharCode(u)},"")};t.processDataByFilters=function(a,o){var l=0,c=a||"",u=[];for(typeof(o=o||[])=="string"&&(o=[o]),l=0;l<o.length;l+=1)switch(o[l]){case"ASCII85Decode":case"/ASCII85Decode":c=n(c),u.push("/ASCII85Encode");break;case"ASCII85Encode":case"/ASCII85Encode":c=e(c),u.push("/ASCII85Decode");break;case"ASCIIHexDecode":case"/ASCIIHexDecode":c=r(c),u.push("/ASCIIHexEncode");break;case"ASCIIHexEncode":case"/ASCIIHexEncode":c=i(c),u.push("/ASCIIHexDecode");break;case"FlateEncode":case"/FlateEncode":c=s(c),u.push("/FlateDecode");break;default:throw new Error('The filter: "'+o[l]+'" is not implemented')}return{data:c,reverseChain:u.reverse().join(" ")}}})(qt.API),(function(t){t.loadFile=function(e,n,i){return(function(r,s,a){s=s!==!1,a=typeof a=="function"?a:function(){};var o=void 0;try{o=(function(l,c,u){var f=new XMLHttpRequest,h=0,d=function(y){var m=y.length,x=[],w=String.fromCharCode;for(h=0;h<m;h+=1)x.push(w(255&y.charCodeAt(h)));return x.join("")};if(f.open("GET",l,!c),f.overrideMimeType("text/plain; charset=x-user-defined"),c===!1&&(f.onload=function(){f.status===200?u(d(this.responseText)):u(void 0)}),f.send(null),c&&f.status===200)return d(f.responseText)})(r,s,a)}catch{}return o})(e,n,i)},t.allowFsRead=void 0,t.loadImageFile=t.loadFile})(qt.API),(function(t){function e(){return(nn.html2canvas?Promise.resolve(nn.html2canvas):gs(()=>import("./DXEQVQnt.js"),[],import.meta.url)).catch(function(o){return Promise.reject(new Error("Could not load html2canvas: "+o))}).then(function(o){return o.default?o.default:o})}function n(){return(nn.DOMPurify?Promise.resolve(nn.DOMPurify):gs(()=>import("./Bzr520pe.js"),[],import.meta.url)).catch(function(o){return Promise.reject(new Error("Could not load dompurify: "+o))}).then(function(o){return o.default?o.default:o})}var i=function(o){var l=jn(o);return l==="undefined"?"undefined":l==="string"||o instanceof String?"string":l==="number"||o instanceof Number?"number":l==="function"||o instanceof Function?"function":o&&o.constructor===Array?"array":o&&o.nodeType===1?"element":l==="object"?"object":"unknown"},r=function(o,l){var c=document.createElement(o);for(var u in l.className&&(c.className=l.className),l.innerHTML&&l.dompurify&&(c.innerHTML=l.dompurify.sanitize(l.innerHTML)),l.style)c.style[u]=l.style[u];return c},s=function o(l,c){for(var u=l.nodeType===3?document.createTextNode(l.nodeValue):l.cloneNode(!1),f=l.firstChild;f;f=f.nextSibling)c!==!0&&f.nodeType===1&&f.nodeName==="SCRIPT"||u.appendChild(o(f,c));return l.nodeType===1&&(l.nodeName==="CANVAS"?(u.width=l.width,u.height=l.height,u.getContext("2d").drawImage(l,0,0)):l.nodeName!=="TEXTAREA"&&l.nodeName!=="SELECT"||(u.value=l.value),u.addEventListener("load",function(){u.scrollTop=l.scrollTop,u.scrollLeft=l.scrollLeft},!0)),u},a=function o(l){var c=Object.assign(o.convert(Promise.resolve()),JSON.parse(JSON.stringify(o.template))),u=o.convert(Promise.resolve(),c);return(u=u.setProgress(1,o,1,[o])).set(l)};(a.prototype=Object.create(Promise.prototype)).constructor=a,a.convert=function(o,l){return o.__proto__=l||a.prototype,o},a.template={prop:{src:null,container:null,overlay:null,canvas:null,img:null,pdf:null,pageSize:null,callback:function(){}},progress:{val:0,state:null,n:0,stack:[]},opt:{filename:"file.pdf",margin:[0,0,0,0],enableLinks:!0,x:0,y:0,html2canvas:{},jsPDF:{},backgroundColor:"transparent"}},a.prototype.from=function(o,l){return this.then(function(){switch(l=l||(function(c){switch(i(c)){case"string":return"string";case"element":return c.nodeName.toLowerCase()==="canvas"?"canvas":"element";default:return"unknown"}})(o),l){case"string":return this.then(n).then(function(c){return this.set({src:r("div",{innerHTML:o,dompurify:c})})});case"element":return this.set({src:o});case"canvas":return this.set({canvas:o});case"img":return this.set({img:o});default:return this.error("Unknown source type.")}})},a.prototype.to=function(o){switch(o){case"container":return this.toContainer();case"canvas":return this.toCanvas();case"img":return this.toImg();case"pdf":return this.toPdf();default:return this.error("Invalid target.")}},a.prototype.toContainer=function(){return this.thenList([function(){return this.prop.src||this.error("Cannot duplicate - no source HTML.")},function(){return this.prop.pageSize||this.setPageSize()}]).then(function(){var o={position:"relative",display:"inline-block",width:(typeof this.opt.width!="number"||isNaN(this.opt.width)||typeof this.opt.windowWidth!="number"||isNaN(this.opt.windowWidth)?Math.max(this.prop.src.clientWidth,this.prop.src.scrollWidth,this.prop.src.offsetWidth):this.opt.windowWidth)+"px",left:0,right:0,top:0,margin:"auto",backgroundColor:this.opt.backgroundColor},l=s(this.prop.src,this.opt.html2canvas.javascriptEnabled);l.tagName==="BODY"&&(o.height=Math.max(document.body.scrollHeight,document.body.offsetHeight,document.documentElement.clientHeight,document.documentElement.scrollHeight,document.documentElement.offsetHeight)+"px"),this.prop.overlay=r("div",{className:"html2pdf__overlay",style:{position:"fixed",overflow:"hidden",zIndex:1e3,left:"-100000px",right:0,bottom:0,top:0}}),this.prop.container=r("div",{className:"html2pdf__container",style:o}),this.prop.container.appendChild(l),this.prop.container.firstChild.appendChild(r("div",{style:{clear:"both",border:"0 none transparent",margin:0,padding:0,height:0}})),this.prop.container.style.float="none",this.prop.overlay.appendChild(this.prop.container),document.body.appendChild(this.prop.overlay),this.prop.container.firstChild.style.position="relative",this.prop.container.height=Math.max(this.prop.container.firstChild.clientHeight,this.prop.container.firstChild.scrollHeight,this.prop.container.firstChild.offsetHeight)+"px"})},a.prototype.toCanvas=function(){var o=[function(){return document.body.contains(this.prop.container)||this.toContainer()}];return this.thenList(o).then(e).then(function(l){var c=Object.assign({},this.opt.html2canvas);return delete c.onrendered,l(this.prop.container,c)}).then(function(l){(this.opt.html2canvas.onrendered||function(){})(l),this.prop.canvas=l,document.body.removeChild(this.prop.overlay)})},a.prototype.toContext2d=function(){var o=[function(){return document.body.contains(this.prop.container)||this.toContainer()}];return this.thenList(o).then(e).then(function(l){var c=this.opt.jsPDF,u=this.opt.fontFaces,f=typeof this.opt.width!="number"||isNaN(this.opt.width)||typeof this.opt.windowWidth!="number"||isNaN(this.opt.windowWidth)?1:this.opt.width/this.opt.windowWidth,h=Object.assign({async:!0,allowTaint:!0,scale:f,scrollX:this.opt.scrollX||0,scrollY:this.opt.scrollY||0,backgroundColor:"#ffffff",imageTimeout:15e3,logging:!0,proxy:null,removeContainer:!0,foreignObjectRendering:!1,useCORS:!1},this.opt.html2canvas);if(delete h.onrendered,c.context2d.autoPaging=this.opt.autoPaging===void 0||this.opt.autoPaging,c.context2d.posX=this.opt.x,c.context2d.posY=this.opt.y,c.context2d.margin=this.opt.margin,c.context2d.fontFaces=u,u)for(var d=0;d<u.length;++d){var y=u[d],m=y.src.find(function(x){return x.format==="truetype"});m&&c.addFont(m.url,y.ref.name,y.ref.style)}return h.windowHeight=h.windowHeight||0,h.windowHeight=h.windowHeight==0?Math.max(this.prop.container.clientHeight,this.prop.container.scrollHeight,this.prop.container.offsetHeight):h.windowHeight,c.context2d.save(!0),l(this.prop.container,h)}).then(function(l){this.opt.jsPDF.context2d.restore(!0),(this.opt.html2canvas.onrendered||function(){})(l),this.prop.canvas=l,document.body.removeChild(this.prop.overlay)})},a.prototype.toImg=function(){return this.thenList([function(){return this.prop.canvas||this.toCanvas()}]).then(function(){var o=this.prop.canvas.toDataURL("image/"+this.opt.image.type,this.opt.image.quality);this.prop.img=document.createElement("img"),this.prop.img.src=o})},a.prototype.toPdf=function(){return this.thenList([function(){return this.toContext2d()}]).then(function(){this.prop.pdf=this.prop.pdf||this.opt.jsPDF})},a.prototype.output=function(o,l,c){return(c=c||"pdf").toLowerCase()==="img"||c.toLowerCase()==="image"?this.outputImg(o,l):this.outputPdf(o,l)},a.prototype.outputPdf=function(o,l){return this.thenList([function(){return this.prop.pdf||this.toPdf()}]).then(function(){return this.prop.pdf.output(o,l)})},a.prototype.outputImg=function(o){return this.thenList([function(){return this.prop.img||this.toImg()}]).then(function(){switch(o){case void 0:case"img":return this.prop.img;case"datauristring":case"dataurlstring":return this.prop.img.src;case"datauri":case"dataurl":return document.location.href=this.prop.img.src;default:throw'Image output type "'+o+'" is not supported.'}})},a.prototype.save=function(o){return this.thenList([function(){return this.prop.pdf||this.toPdf()}]).set(o?{filename:o}:null).then(function(){this.prop.pdf.save(this.opt.filename)})},a.prototype.doCallback=function(){return this.thenList([function(){return this.prop.pdf||this.toPdf()}]).then(function(){this.prop.callback(this.prop.pdf)})},a.prototype.set=function(o){if(i(o)!=="object")return this;var l=Object.keys(o||{}).map(function(c){if(c in a.template.prop)return function(){this.prop[c]=o[c]};switch(c){case"margin":return this.setMargin.bind(this,o.margin);case"jsPDF":return function(){return this.opt.jsPDF=o.jsPDF,this.setPageSize()};case"pageSize":return this.setPageSize.bind(this,o.pageSize);default:return function(){this.opt[c]=o[c]}}},this);return this.then(function(){return this.thenList(l)})},a.prototype.get=function(o,l){return this.then(function(){var c=o in a.template.prop?this.prop[o]:this.opt[o];return l?l(c):c})},a.prototype.setMargin=function(o){return this.then(function(){switch(i(o)){case"number":o=[o,o,o,o];case"array":if(o.length===2&&(o=[o[0],o[1],o[0],o[1]]),o.length===4)break;default:return this.error("Invalid margin array.")}this.opt.margin=o}).then(this.setPageSize)},a.prototype.setPageSize=function(o){function l(c,u){return Math.floor(c*u/72*96)}return this.then(function(){(o=o||qt.getPageSize(this.opt.jsPDF)).hasOwnProperty("inner")||(o.inner={width:o.width-this.opt.margin[1]-this.opt.margin[3],height:o.height-this.opt.margin[0]-this.opt.margin[2]},o.inner.px={width:l(o.inner.width,o.k),height:l(o.inner.height,o.k)},o.inner.ratio=o.inner.height/o.inner.width),this.prop.pageSize=o})},a.prototype.setProgress=function(o,l,c,u){return o!=null&&(this.progress.val=o),l!=null&&(this.progress.state=l),c!=null&&(this.progress.n=c),u!=null&&(this.progress.stack=u),this.progress.ratio=this.progress.val/this.progress.state,this},a.prototype.updateProgress=function(o,l,c,u){return this.setProgress(o?this.progress.val+o:null,l||null,c?this.progress.n+c:null,u?this.progress.stack.concat(u):null)},a.prototype.then=function(o,l){var c=this;return this.thenCore(o,l,function(u,f){return c.updateProgress(null,null,1,[u]),Promise.prototype.then.call(this,function(h){return c.updateProgress(null,u),h}).then(u,f).then(function(h){return c.updateProgress(1),h})})},a.prototype.thenCore=function(o,l,c){c=c||Promise.prototype.then;var u=this;o&&(o=o.bind(u)),l&&(l=l.bind(u));var f=Promise.toString().indexOf("[native code]")!==-1&&Promise.name==="Promise"?u:a.convert(Object.assign({},u),Promise.prototype),h=c.call(f,o,l);return a.convert(h,u.__proto__)},a.prototype.thenExternal=function(o,l){return Promise.prototype.then.call(this,o,l)},a.prototype.thenList=function(o){var l=this;return o.forEach(function(c){l=l.thenCore(c)}),l},a.prototype.catch=function(o){o&&(o=o.bind(this));var l=Promise.prototype.catch.call(this,o);return a.convert(l,this)},a.prototype.catchExternal=function(o){return Promise.prototype.catch.call(this,o)},a.prototype.error=function(o){return this.then(function(){throw new Error(o)})},a.prototype.using=a.prototype.set,a.prototype.saveAs=a.prototype.save,a.prototype.export=a.prototype.output,a.prototype.run=a.prototype.then,qt.getPageSize=function(o,l,c){if(jn(o)==="object"){var u=o;o=u.orientation,l=u.unit||l,c=u.format||c}l=l||"mm",c=c||"a4",o=(""+(o||"P")).toLowerCase();var f,h=(""+c).toLowerCase(),d={a0:[2383.94,3370.39],a1:[1683.78,2383.94],a2:[1190.55,1683.78],a3:[841.89,1190.55],a4:[595.28,841.89],a5:[419.53,595.28],a6:[297.64,419.53],a7:[209.76,297.64],a8:[147.4,209.76],a9:[104.88,147.4],a10:[73.7,104.88],b0:[2834.65,4008.19],b1:[2004.09,2834.65],b2:[1417.32,2004.09],b3:[1000.63,1417.32],b4:[708.66,1000.63],b5:[498.9,708.66],b6:[354.33,498.9],b7:[249.45,354.33],b8:[175.75,249.45],b9:[124.72,175.75],b10:[87.87,124.72],c0:[2599.37,3676.54],c1:[1836.85,2599.37],c2:[1298.27,1836.85],c3:[918.43,1298.27],c4:[649.13,918.43],c5:[459.21,649.13],c6:[323.15,459.21],c7:[229.61,323.15],c8:[161.57,229.61],c9:[113.39,161.57],c10:[79.37,113.39],dl:[311.81,623.62],letter:[612,792],"government-letter":[576,756],legal:[612,1008],"junior-legal":[576,360],ledger:[1224,792],tabloid:[792,1224],"credit-card":[153,243]};switch(l){case"pt":f=1;break;case"mm":f=72/25.4;break;case"cm":f=72/2.54;break;case"in":f=72;break;case"px":f=.75;break;case"pc":case"em":f=12;break;case"ex":f=6;break;default:throw"Invalid unit: "+l}var y,m=0,x=0;if(d.hasOwnProperty(h))m=d[h][1]/f,x=d[h][0]/f;else try{m=c[1],x=c[0]}catch{throw new Error("Invalid format: "+c)}if(o==="p"||o==="portrait")o="p",x>m&&(y=x,x=m,m=y);else{if(o!=="l"&&o!=="landscape")throw"Invalid orientation: "+o;o="l",m>x&&(y=x,x=m,m=y)}return{width:x,height:m,unit:l,k:f,orientation:o}},t.html=function(o,l){(l=l||{}).callback=l.callback||function(){},l.html2canvas=l.html2canvas||{},l.html2canvas.canvas=l.html2canvas.canvas||this.canvas,l.jsPDF=l.jsPDF||this,l.fontFaces=l.fontFaces?l.fontFaces.map(jg):null;var c=new a(l);return l.worker?c:c.from(o).doCallback()}})(qt.API),qt.API.addJS=function(t){var e,n,i=t;return this.internal.events.subscribe("postPutResources",function(){e=this.internal.newObject(),this.internal.out("<<"),this.internal.out("/Names [(EmbeddedJS) "+(e+1)+" 0 R]"),this.internal.out(">>"),this.internal.out("endobj"),n=this.internal.newObject(),this.internal.out("<<"),this.internal.out("/S /JavaScript"),this.internal.out("/JS ("+i+")"),this.internal.out(">>"),this.internal.out("endobj")}),this.internal.events.subscribe("putCatalog",function(){e!==void 0&&n!==void 0&&this.internal.out("/Names <</JavaScript "+e+" 0 R>>")}),this},(function(t){var e;t.events.push(["postPutResources",function(){var n=this,i=/^(\d+) 0 obj$/;if(this.outline.root.children.length>0)for(var r=n.outline.render().split(/\r\n/),s=0;s<r.length;s++){var a=r[s],o=i.exec(a);if(o!=null){var l=o[1];n.internal.newObjectDeferredBegin(l,!1)}n.internal.write(a)}if(this.outline.createNamedDestinations){var c=this.internal.pages.length,u=[];for(s=0;s<c;s++){var f=n.internal.newObject();u.push(f);var h=n.internal.getPageInfo(s+1);n.internal.write("<< /D["+h.objId+" 0 R /XYZ null null null]>> endobj")}var d=n.internal.newObject();for(n.internal.write("<< /Names [ "),s=0;s<u.length;s++)n.internal.write("(page_"+(s+1)+")"+u[s]+" 0 R");n.internal.write(" ] >>","endobj"),e=n.internal.newObject(),n.internal.write("<< /Dests "+d+" 0 R"),n.internal.write(">>","endobj")}}]),t.events.push(["putCatalog",function(){var n=this;n.outline.root.children.length>0&&(n.internal.write("/Outlines",this.outline.makeRef(this.outline.root)),this.outline.createNamedDestinations&&n.internal.write("/Names "+e+" 0 R"))}]),t.events.push(["initialized",function(){var n=this;n.outline={createNamedDestinations:!1,root:{children:[]}},n.outline.add=function(i,r,s){var a={title:r,options:s,children:[]};return i==null&&(i=this.root),i.children.push(a),a},n.outline.render=function(){return this.ctx={},this.ctx.val="",this.ctx.pdf=n,this.genIds_r(this.root),this.renderRoot(this.root),this.renderItems(this.root),this.ctx.val},n.outline.genIds_r=function(i){i.id=n.internal.newObjectDeferred();for(var r=0;r<i.children.length;r++)this.genIds_r(i.children[r])},n.outline.renderRoot=function(i){this.objStart(i),this.line("/Type /Outlines"),i.children.length>0&&(this.line("/First "+this.makeRef(i.children[0])),this.line("/Last "+this.makeRef(i.children[i.children.length-1]))),this.line("/Count "+this.count_r({count:0},i)),this.objEnd()},n.outline.renderItems=function(i){for(var r=this.ctx.pdf.internal.getVerticalCoordinateString,s=0;s<i.children.length;s++){var a=i.children[s];this.objStart(a),this.line("/Title "+this.makeString(a.title)),this.line("/Parent "+this.makeRef(i)),s>0&&this.line("/Prev "+this.makeRef(i.children[s-1])),s<i.children.length-1&&this.line("/Next "+this.makeRef(i.children[s+1])),a.children.length>0&&(this.line("/First "+this.makeRef(a.children[0])),this.line("/Last "+this.makeRef(a.children[a.children.length-1])));var o=this.count=this.count_r({count:0},a);if(o>0&&this.line("/Count "+o),a.options&&a.options.pageNumber){var l=n.internal.getPageInfo(a.options.pageNumber);this.line("/Dest ["+l.objId+" 0 R /XYZ 0 "+r(0)+" 0]")}this.objEnd()}for(var c=0;c<i.children.length;c++)this.renderItems(i.children[c])},n.outline.line=function(i){this.ctx.val+=i+`\r
`},n.outline.makeRef=function(i){return i.id+" 0 R"},n.outline.makeString=function(i){return"("+n.internal.pdfEscape(i)+")"},n.outline.objStart=function(i){this.ctx.val+=`\r
`+i.id+` 0 obj\r
<<\r
`},n.outline.objEnd=function(){this.ctx.val+=`>> \r
endobj\r
`},n.outline.count_r=function(i,r){for(var s=0;s<r.children.length;s++)i.count++,this.count_r(i,r.children[s]);return i.count}}])})(qt.API),(function(t){var e=[192,193,194,195,196,197,198,199];t.processJPEG=function(n,i,r,s,a,o){var l,c=this.decode.DCT_DECODE,u=null;if(typeof n=="string"||this.__addimage__.isArrayBuffer(n)||this.__addimage__.isArrayBufferView(n)){switch(n=a||n,n=this.__addimage__.isArrayBuffer(n)?new Uint8Array(n):n,l=(function(f){for(var h,d=256*f.charCodeAt(4)+f.charCodeAt(5),y=f.length,m={width:0,height:0,numcomponents:1},x=4;x<y;x+=2){if(x+=d,e.indexOf(f.charCodeAt(x+1))!==-1){h=256*f.charCodeAt(x+5)+f.charCodeAt(x+6),m={width:256*f.charCodeAt(x+7)+f.charCodeAt(x+8),height:h,numcomponents:f.charCodeAt(x+9)};break}d=256*f.charCodeAt(x+2)+f.charCodeAt(x+3)}return m})(n=this.__addimage__.isArrayBufferView(n)?this.__addimage__.arrayBufferToBinaryString(n):n),l.numcomponents){case 1:o=this.color_spaces.DEVICE_GRAY;break;case 4:o=this.color_spaces.DEVICE_CMYK;break;case 3:o=this.color_spaces.DEVICE_RGB}u={data:n,width:l.width,height:l.height,colorSpace:o,bitsPerComponent:8,filter:c,index:i,alias:r}}return u}})(qt.API),qt.API.processPNG=function(t,e,n,i){if(this.__addimage__.isArrayBuffer(t)&&(t=new Uint8Array(t)),this.__addimage__.isArrayBufferView(t)){var r,s=GO(t,{checkCrc:!0}),a=s.width,o=s.height,l=s.channels,c=s.palette,u=s.depth;r=c&&l===1?(function(D){for(var O=D.width,W=D.height,C=D.data,N=D.palette,B=D.depth,E=!1,R=[],q=[],Z=void 0,U=!1,X=0,de=0;de<N.length;de++){var le=x2(N[de],4),F=le[0],V=le[1],G=le[2],se=le[3];R.push(F,V,G),se!=null&&(se===0?(X++,q.length<1&&q.push(de)):se<255&&(U=!0))}if(U||X>1){E=!0,q=void 0;var ae=O*W;Z=new Uint8Array(ae);for(var te=new DataView(C.buffer),ue=0;ue<ae;ue++){var pe=Ug(te,ue,B),ge=x2(N[pe],4)[3];Z[ue]=ge}}else X===0&&(q=void 0);return{colorSpace:"Indexed",colorsPerPixel:1,sMaskBitsPerComponent:E?8:void 0,colorBytes:C,alphaBytes:Z,needSMask:E,palette:R,mask:q}})(s):l===2||l===4?(function(D){for(var O=D.data,W=D.width,C=D.height,N=D.channels,B=D.depth,E=N===2?"DeviceGray":"DeviceRGB",R=N-1,q=W*C,Z=R,U=q*Z,X=1*q,de=Math.ceil(U*B/8),le=Math.ceil(X*B/8),F=new Uint8Array(de),V=new Uint8Array(le),G=new DataView(O.buffer),se=new DataView(F.buffer),ae=new DataView(V.buffer),te=!1,ue=0;ue<q;ue++){for(var pe=ue*N,ge=0;ge<Z;ge++)ky(se,Ug(G,pe+ge,B),ue*Z+ge,B);var me=Ug(G,pe+Z,B);me<(1<<B)-1&&(te=!0),ky(ae,me,1*ue,B)}return{colorSpace:E,colorsPerPixel:R,sMaskBitsPerComponent:te?B:void 0,colorBytes:F,alphaBytes:V,needSMask:te}})(s):(function(D){var O=D.data,W=D.channels===1?"DeviceGray":"DeviceRGB";return{colorSpace:W,colorsPerPixel:W==="DeviceGray"?1:3,colorBytes:O instanceof Uint16Array?(function(C){for(var N=C.length,B=new Uint8Array(2*N),E=new DataView(B.buffer,B.byteOffset,B.byteLength),R=0;R<N;R++)E.setUint16(2*R,C[R],!1);return B})(O):O,needSMask:!1}})(s);var f,h,d,y=r,m=y.colorSpace,x=y.colorsPerPixel,w=y.sMaskBitsPerComponent,S=y.colorBytes,A=y.alphaBytes,_=y.needSMask,M=y.palette,I=y.mask,T=null;return i!==qt.API.image_compression.NONE&&typeof Um=="function"?(T=(function(D){var O;switch(D){case qt.API.image_compression.FAST:O=11;break;case qt.API.image_compression.MEDIUM:O=13;break;case qt.API.image_compression.SLOW:O=14;break;default:O=12}return O})(i),f=this.decode.FLATE_DECODE,h="/Predictor ".concat(T," /Colors ").concat(x," /BitsPerComponent ").concat(u," /Columns ").concat(a),t=by(S,Math.ceil(a*x*u/8),x,u,i),_&&(d=by(A,Math.ceil(a*w/8),1,w,i))):(f=void 0,h=void 0,t=S,_&&(d=A)),(this.__addimage__.isArrayBuffer(t)||this.__addimage__.isArrayBufferView(t))&&(t=this.__addimage__.arrayBufferToBinaryString(t)),(d&&this.__addimage__.isArrayBuffer(d)||this.__addimage__.isArrayBufferView(d))&&(d=this.__addimage__.arrayBufferToBinaryString(d)),{alias:n,data:t,index:e,filter:f,decodeParameters:h,transparency:I,palette:M,sMask:d,predictor:T,width:a,height:o,bitsPerComponent:u,sMaskBitsPerComponent:w,colorSpace:m}}},(function(t){t.processGIF89A=function(e,n,i,r){var s=new hF(e),a=s.width,o=s.height,l=[];s.decodeAndBlitFrameRGBA(0,l);var c={data:l,width:a,height:o},u=new Wg(100).encode(c,100);return t.processJPEG.call(this,u,n,i,r)},t.processGIF87A=t.processGIF89A})(qt.API),_a.prototype.parseHeader=function(){if(this.fileSize=this.datav.getUint32(this.pos,!0),this.pos+=4,this.reserved=this.datav.getUint32(this.pos,!0),this.pos+=4,this.offset=this.datav.getUint32(this.pos,!0),this.pos+=4,this.headerSize=this.datav.getUint32(this.pos,!0),this.pos+=4,this.width=this.datav.getUint32(this.pos,!0),this.pos+=4,this.height=this.datav.getInt32(this.pos,!0),this.pos+=4,this.planes=this.datav.getUint16(this.pos,!0),this.pos+=2,this.bitPP=this.datav.getUint16(this.pos,!0),this.pos+=2,this.compress=this.datav.getUint32(this.pos,!0),this.pos+=4,this.rawSize=this.datav.getUint32(this.pos,!0),this.pos+=4,this.hr=this.datav.getUint32(this.pos,!0),this.pos+=4,this.vr=this.datav.getUint32(this.pos,!0),this.pos+=4,this.colors=this.datav.getUint32(this.pos,!0),this.pos+=4,this.importantColors=this.datav.getUint32(this.pos,!0),this.pos+=4,this.bitPP===16&&this.is_with_alpha&&(this.bitPP=15),this.bitPP<15){var t=this.colors===0?1<<this.bitPP:this.colors;this.palette=new Array(t);for(var e=0;e<t;e++){var n=this.datav.getUint8(this.pos++,!0),i=this.datav.getUint8(this.pos++,!0),r=this.datav.getUint8(this.pos++,!0),s=this.datav.getUint8(this.pos++,!0);this.palette[e]={red:r,green:i,blue:n,quad:s}}}this.height<0&&(this.height*=-1,this.bottom_up=!1)},_a.prototype.parseBGR=function(){this.pos=this.offset;var t="bit"+this.bitPP,e=this.width*this.height*4;if(e>536870912)throw new Error("Image dimensions exceed 512MB, which is too large.");this.data=new Uint8Array(e);try{this[t]()}catch(n){Qn.log("bit decode error:"+n)}},_a.prototype.bit1=function(){var t,e=Math.ceil(this.width/8),n=e%4;for(t=this.height-1;t>=0;t--){for(var i=this.bottom_up?t:this.height-1-t,r=0;r<e;r++)for(var s=this.datav.getUint8(this.pos++,!0),a=i*this.width*4+8*r*4,o=0;o<8&&8*r+o<this.width;o++){var l=this.palette[s>>7-o&1];this.data[a+4*o]=l.blue,this.data[a+4*o+1]=l.green,this.data[a+4*o+2]=l.red,this.data[a+4*o+3]=255}n!==0&&(this.pos+=4-n)}},_a.prototype.bit4=function(){for(var t=Math.ceil(this.width/2),e=t%4,n=this.height-1;n>=0;n--){for(var i=this.bottom_up?n:this.height-1-n,r=0;r<t;r++){var s=this.datav.getUint8(this.pos++,!0),a=i*this.width*4+2*r*4,o=s>>4,l=15&s,c=this.palette[o];if(this.data[a]=c.blue,this.data[a+1]=c.green,this.data[a+2]=c.red,this.data[a+3]=255,2*r+1>=this.width)break;c=this.palette[l],this.data[a+4]=c.blue,this.data[a+4+1]=c.green,this.data[a+4+2]=c.red,this.data[a+4+3]=255}e!==0&&(this.pos+=4-e)}},_a.prototype.bit8=function(){for(var t=this.width%4,e=this.height-1;e>=0;e--){for(var n=this.bottom_up?e:this.height-1-e,i=0;i<this.width;i++){var r=this.datav.getUint8(this.pos++,!0),s=n*this.width*4+4*i;if(r<this.palette.length){var a=this.palette[r];this.data[s]=a.red,this.data[s+1]=a.green,this.data[s+2]=a.blue,this.data[s+3]=255}else this.data[s]=255,this.data[s+1]=255,this.data[s+2]=255,this.data[s+3]=255}t!==0&&(this.pos+=4-t)}},_a.prototype.bit15=function(){for(var t=this.width%3,e=parseInt("11111",2),n=this.height-1;n>=0;n--){for(var i=this.bottom_up?n:this.height-1-n,r=0;r<this.width;r++){var s=this.datav.getUint16(this.pos,!0);this.pos+=2;var a=(s&e)/e*255|0,o=(s>>5&e)/e*255|0,l=(s>>10&e)/e*255|0,c=s>>15?255:0,u=i*this.width*4+4*r;this.data[u]=l,this.data[u+1]=o,this.data[u+2]=a,this.data[u+3]=c}this.pos+=t}},_a.prototype.bit16=function(){for(var t=this.width%3,e=parseInt("11111",2),n=parseInt("111111",2),i=this.height-1;i>=0;i--){for(var r=this.bottom_up?i:this.height-1-i,s=0;s<this.width;s++){var a=this.datav.getUint16(this.pos,!0);this.pos+=2;var o=(a&e)/e*255|0,l=(a>>5&n)/n*255|0,c=(a>>11)/e*255|0,u=r*this.width*4+4*s;this.data[u]=c,this.data[u+1]=l,this.data[u+2]=o,this.data[u+3]=255}this.pos+=t}},_a.prototype.bit24=function(){for(var t=this.height-1;t>=0;t--){for(var e=this.bottom_up?t:this.height-1-t,n=0;n<this.width;n++){var i=this.datav.getUint8(this.pos++,!0),r=this.datav.getUint8(this.pos++,!0),s=this.datav.getUint8(this.pos++,!0),a=e*this.width*4+4*n;this.data[a]=s,this.data[a+1]=r,this.data[a+2]=i,this.data[a+3]=255}this.pos+=this.width%4}},_a.prototype.bit32=function(){for(var t=this.height-1;t>=0;t--)for(var e=this.bottom_up?t:this.height-1-t,n=0;n<this.width;n++){var i=this.datav.getUint8(this.pos++,!0),r=this.datav.getUint8(this.pos++,!0),s=this.datav.getUint8(this.pos++,!0),a=this.datav.getUint8(this.pos++,!0),o=e*this.width*4+4*n;this.data[o]=s,this.data[o+1]=r,this.data[o+2]=i,this.data[o+3]=a}},_a.prototype.getData=function(){return this.data},(function(t){t.processBMP=function(e,n,i,r){var s=new _a(e,!1),a=s.width,o=s.height,l={data:s.getData(),width:a,height:o},c=new Wg(100).encode(l,100);return t.processJPEG.call(this,c,n,i,r)}})(qt.API),Ny.prototype.getData=function(){return this.data},(function(t){t.processWEBP=function(e,n,i,r){var s=new Ny(e),a=s.width,o=s.height,l={data:s.getData(),width:a,height:o},c=new Wg(100).encode(l,100);return t.processJPEG.call(this,c,n,i,r)}})(qt.API),qt.API.processRGBA=function(t,e,n){for(var i=t.data,r=i.length,s=new Uint8Array(r/4*3),a=new Uint8Array(r/4),o=0,l=0,c=0;c<r;c+=4){var u=i[c],f=i[c+1],h=i[c+2],d=i[c+3];s[o++]=u,s[o++]=f,s[o++]=h,a[l++]=d}var y=this.__addimage__.arrayBufferToBinaryString(s);return{alpha:this.__addimage__.arrayBufferToBinaryString(a),data:y,index:e,alias:n,colorSpace:"DeviceRGB",bitsPerComponent:8,width:t.width,height:t.height}},qt.API.setLanguage=function(t){return this.internal.languageSettings===void 0&&(this.internal.languageSettings={},this.internal.languageSettings.isSubscribed=!1),{af:"Afrikaans",sq:"Albanian",ar:"Arabic (Standard)","ar-DZ":"Arabic (Algeria)","ar-BH":"Arabic (Bahrain)","ar-EG":"Arabic (Egypt)","ar-IQ":"Arabic (Iraq)","ar-JO":"Arabic (Jordan)","ar-KW":"Arabic (Kuwait)","ar-LB":"Arabic (Lebanon)","ar-LY":"Arabic (Libya)","ar-MA":"Arabic (Morocco)","ar-OM":"Arabic (Oman)","ar-QA":"Arabic (Qatar)","ar-SA":"Arabic (Saudi Arabia)","ar-SY":"Arabic (Syria)","ar-TN":"Arabic (Tunisia)","ar-AE":"Arabic (U.A.E.)","ar-YE":"Arabic (Yemen)",an:"Aragonese",hy:"Armenian",as:"Assamese",ast:"Asturian",az:"Azerbaijani",eu:"Basque",be:"Belarusian",bn:"Bengali",bs:"Bosnian",br:"Breton",bg:"Bulgarian",my:"Burmese",ca:"Catalan",ch:"Chamorro",ce:"Chechen",zh:"Chinese","zh-HK":"Chinese (Hong Kong)","zh-CN":"Chinese (PRC)","zh-SG":"Chinese (Singapore)","zh-TW":"Chinese (Taiwan)",cv:"Chuvash",co:"Corsican",cr:"Cree",hr:"Croatian",cs:"Czech",da:"Danish",nl:"Dutch (Standard)","nl-BE":"Dutch (Belgian)",en:"English","en-AU":"English (Australia)","en-BZ":"English (Belize)","en-CA":"English (Canada)","en-IE":"English (Ireland)","en-JM":"English (Jamaica)","en-NZ":"English (New Zealand)","en-PH":"English (Philippines)","en-ZA":"English (South Africa)","en-TT":"English (Trinidad & Tobago)","en-GB":"English (United Kingdom)","en-US":"English (United States)","en-ZW":"English (Zimbabwe)",eo:"Esperanto",et:"Estonian",fo:"Faeroese",fj:"Fijian",fi:"Finnish",fr:"French (Standard)","fr-BE":"French (Belgium)","fr-CA":"French (Canada)","fr-FR":"French (France)","fr-LU":"French (Luxembourg)","fr-MC":"French (Monaco)","fr-CH":"French (Switzerland)",fy:"Frisian",fur:"Friulian",gd:"Gaelic (Scots)","gd-IE":"Gaelic (Irish)",gl:"Galacian",ka:"Georgian",de:"German (Standard)","de-AT":"German (Austria)","de-DE":"German (Germany)","de-LI":"German (Liechtenstein)","de-LU":"German (Luxembourg)","de-CH":"German (Switzerland)",el:"Greek",gu:"Gujurati",ht:"Haitian",he:"Hebrew",hi:"Hindi",hu:"Hungarian",is:"Icelandic",id:"Indonesian",iu:"Inuktitut",ga:"Irish",it:"Italian (Standard)","it-CH":"Italian (Switzerland)",ja:"Japanese",kn:"Kannada",ks:"Kashmiri",kk:"Kazakh",km:"Khmer",ky:"Kirghiz",tlh:"Klingon",ko:"Korean","ko-KP":"Korean (North Korea)","ko-KR":"Korean (South Korea)",la:"Latin",lv:"Latvian",lt:"Lithuanian",lb:"Luxembourgish",mk:"North Macedonia",ms:"Malay",ml:"Malayalam",mt:"Maltese",mi:"Maori",mr:"Marathi",mo:"Moldavian",nv:"Navajo",ng:"Ndonga",ne:"Nepali",no:"Norwegian",nb:"Norwegian (Bokmal)",nn:"Norwegian (Nynorsk)",oc:"Occitan",or:"Oriya",om:"Oromo",fa:"Persian","fa-IR":"Persian/Iran",pl:"Polish",pt:"Portuguese","pt-BR":"Portuguese (Brazil)",pa:"Punjabi","pa-IN":"Punjabi (India)","pa-PK":"Punjabi (Pakistan)",qu:"Quechua",rm:"Rhaeto-Romanic",ro:"Romanian","ro-MO":"Romanian (Moldavia)",ru:"Russian","ru-MO":"Russian (Moldavia)",sz:"Sami (Lappish)",sg:"Sango",sa:"Sanskrit",sc:"Sardinian",sd:"Sindhi",si:"Singhalese",sr:"Serbian",sk:"Slovak",sl:"Slovenian",so:"Somani",sb:"Sorbian",es:"Spanish","es-AR":"Spanish (Argentina)","es-BO":"Spanish (Bolivia)","es-CL":"Spanish (Chile)","es-CO":"Spanish (Colombia)","es-CR":"Spanish (Costa Rica)","es-DO":"Spanish (Dominican Republic)","es-EC":"Spanish (Ecuador)","es-SV":"Spanish (El Salvador)","es-GT":"Spanish (Guatemala)","es-HN":"Spanish (Honduras)","es-MX":"Spanish (Mexico)","es-NI":"Spanish (Nicaragua)","es-PA":"Spanish (Panama)","es-PY":"Spanish (Paraguay)","es-PE":"Spanish (Peru)","es-PR":"Spanish (Puerto Rico)","es-ES":"Spanish (Spain)","es-UY":"Spanish (Uruguay)","es-VE":"Spanish (Venezuela)",sx:"Sutu",sw:"Swahili",sv:"Swedish","sv-FI":"Swedish (Finland)","sv-SV":"Swedish (Sweden)",ta:"Tamil",tt:"Tatar",te:"Teluga",th:"Thai",tig:"Tigre",ts:"Tsonga",tn:"Tswana",tr:"Turkish",tk:"Turkmen",uk:"Ukrainian",hsb:"Upper Sorbian",ur:"Urdu",ve:"Venda",vi:"Vietnamese",vo:"Volapuk",wa:"Walloon",cy:"Welsh",xh:"Xhosa",ji:"Yiddish",zu:"Zulu"}[t]!==void 0&&(this.internal.languageSettings.languageCode=t,this.internal.languageSettings.isSubscribed===!1&&(this.internal.events.subscribe("putCatalog",function(){this.internal.write("/Lang ("+this.internal.languageSettings.languageCode+")")}),this.internal.languageSettings.isSubscribed=!0)),this},$c=qt.API,Uf=$c.getCharWidthsArray=function(t,e){var n,i,r=(e=e||{}).font||this.internal.getFont(),s=e.fontSize||this.internal.getFontSize(),a=e.charSpace||this.internal.getCharSpace(),o=e.widths?e.widths:r.metadata.Unicode.widths,l=o.fof?o.fof:1,c=e.kerning?e.kerning:r.metadata.Unicode.kerning,u=c.fof?c.fof:1,f=e.doKerning!==!1,h=0,d=t.length,y=0,m=o[0]||l,x=[];for(n=0;n<d;n++)i=t.charCodeAt(n),typeof r.metadata.widthOfString=="function"?x.push((r.metadata.widthOfGlyph(r.metadata.characterToGlyph(i))+a*(1e3/s)||0)/1e3):(h=f&&jn(c[i])==="object"&&!isNaN(parseInt(c[i][y],10))?c[i][y]/u:0,x.push((o[i]||m)/l+h)),y=i;return x},my=$c.getStringUnitWidth=function(t,e){var n=(e=e||{}).fontSize||this.internal.getFontSize(),i=e.font||this.internal.getFont(),r=e.charSpace||this.internal.getCharSpace();return $c.processArabic&&(t=$c.processArabic(t)),typeof i.metadata.widthOfString=="function"?i.metadata.widthOfString(t,n,r)/n:Uf.apply(this,arguments).reduce(function(s,a){return s+a},0)},vy=function(t,e,n,i){for(var r=[],s=0,a=t.length,o=0;s!==a&&o+e[s]<n;)o+=e[s],s++;r.push(t.slice(0,s));var l=s;for(o=0;s!==a;)o+e[s]>i&&(r.push(t.slice(l,s)),o=0,l=s),o+=e[s],s++;return l!==s&&r.push(t.slice(l,s)),r},yy=function(t,e,n){n||(n={});var i,r,s,a,o,l,c,u=[],f=[u],h=n.textIndent||0,d=0,y=0,m=t.split(" "),x=Uf.apply(this,[" ",n])[0];if(l=n.lineIndent===-1?m[0].length+2:n.lineIndent||0){var w=Array(l).join(" "),S=[];m.map(function(_){(_=_.split(/\s*\n/)).length>1?S=S.concat(_.map(function(M,I){return(I&&M.length?`
`:"")+M})):S.push(_[0])}),m=S,l=my.apply(this,[w,n])}for(s=0,a=m.length;s<a;s++){var A=0;if(i=m[s],l&&i[0]==`
`&&(i=i.substr(1),A=1),h+d+(y=(r=Uf.apply(this,[i,n])).reduce(function(_,M){return _+M},0))>e||A){if(y>e){for(o=vy.apply(this,[i,r,e-(h+d),e]),u.push(o.shift()),u=[o.pop()];o.length;)f.push([o.shift()]);y=r.slice(i.length-(u[0]?u[0].length:0)).reduce(function(_,M){return _+M},0)}else u=[i];f.push(u),h=y+l,d=x}else u.push(i),h+=d+y,d=x}return c=l?function(_,M){return(M?w:"")+_.join(" ")}:function(_){return _.join(" ")},f.map(c)},$c.splitTextToSize=function(t,e,n){var i,r=(n=n||{}).fontSize||this.internal.getFontSize(),s=(function(u){if(u.widths&&u.kerning)return{widths:u.widths,kerning:u.kerning};var f=this.internal.getFont(u.fontName,u.fontStyle),h="Unicode";return f.metadata[h]?{widths:f.metadata[h].widths||{0:1},kerning:f.metadata[h].kerning||{}}:{font:f.metadata,fontSize:this.internal.getFontSize(),charSpace:this.internal.getCharSpace()}}).call(this,n);i=Array.isArray(t)?t:String(t).split(/\r?\n/);var a=1*this.internal.scaleFactor*e/r;s.textIndent=n.textIndent?1*n.textIndent*this.internal.scaleFactor/r:0,s.lineIndent=n.lineIndent;var o,l,c=[];for(o=0,l=i.length;o<l;o++)c=c.concat(yy.apply(this,[i[o],a,s]));return c},(function(t){t.__fontmetrics__=t.__fontmetrics__||{};for(var e="0123456789abcdef",n="klmnopqrstuvwxyz",i={},r={},s=0;s<16;s++)i[n[s]]=e[s],r[e[s]]=n[s];var a=function(h){return"0x"+parseInt(h,10).toString(16)},o=t.__fontmetrics__.compress=function(h){var d,y,m,x,w=["{"];for(var S in h){if(d=h[S],isNaN(parseInt(S,10))?y="'"+S+"'":(S=parseInt(S,10),y=(y=a(S).slice(2)).slice(0,-1)+r[y.slice(-1)]),typeof d=="number")d<0?(m=a(d).slice(3),x="-"):(m=a(d).slice(2),x=""),m=x+m.slice(0,-1)+r[m.slice(-1)];else{if(jn(d)!=="object")throw new Error("Don't know what to do with value type "+jn(d)+".");m=o(d)}w.push(y+m)}return w.push("}"),w.join("")},l=t.__fontmetrics__.uncompress=function(h){if(typeof h!="string")throw new Error("Invalid argument passed to uncompress.");for(var d,y,m,x,w={},S=1,A=w,_=[],M="",I="",T=h.length-1,D=1;D<T;D+=1)(x=h[D])=="'"?d?(m=d.join(""),d=void 0):d=[]:d?d.push(x):x=="{"?(_.push([A,m]),A={},m=void 0):x=="}"?((y=_.pop())[0][y[1]]=A,m=void 0,A=y[0]):x=="-"?S=-1:m===void 0?i.hasOwnProperty(x)?(M+=i[x],m=parseInt(M,16)*S,S=1,M=""):M+=x:i.hasOwnProperty(x)?(I+=i[x],A[m]=parseInt(I,16)*S,S=1,m=void 0,I=""):I+=x;return w},c={codePages:["WinAnsiEncoding"],WinAnsiEncoding:l("{19m8n201n9q201o9r201s9l201t9m201u8m201w9n201x9o201y8o202k8q202l8r202m9p202q8p20aw8k203k8t203t8v203u9v2cq8s212m9t15m8w15n9w2dw9s16k8u16l9u17s9z17x8y17y9y}")},u={Unicode:{Courier:c,"Courier-Bold":c,"Courier-BoldOblique":c,"Courier-Oblique":c,Helvetica:c,"Helvetica-Bold":c,"Helvetica-BoldOblique":c,"Helvetica-Oblique":c,"Times-Roman":c,"Times-Bold":c,"Times-BoldItalic":c,"Times-Italic":c}},f={Unicode:{"Courier-Oblique":l("{'widths'{k3w'fof'6o}'kerning'{'fof'-6o}}"),"Times-BoldItalic":l("{'widths'{k3o2q4ycx2r201n3m201o6o201s2l201t2l201u2l201w3m201x3m201y3m2k1t2l2r202m2n2n3m2o3m2p5n202q6o2r1w2s2l2t2l2u3m2v3t2w1t2x2l2y1t2z1w3k3m3l3m3m3m3n3m3o3m3p3m3q3m3r3m3s3m203t2l203u2l3v2l3w3t3x3t3y3t3z3m4k5n4l4m4m4m4n4m4o4s4p4m4q4m4r4s4s4y4t2r4u3m4v4m4w3x4x5t4y4s4z4s5k3x5l4s5m4m5n3r5o3x5p4s5q4m5r5t5s4m5t3x5u3x5v2l5w1w5x2l5y3t5z3m6k2l6l3m6m3m6n2w6o3m6p2w6q2l6r3m6s3r6t1w6u1w6v3m6w1w6x4y6y3r6z3m7k3m7l3m7m2r7n2r7o1w7p3r7q2w7r4m7s3m7t2w7u2r7v2n7w1q7x2n7y3t202l3mcl4mal2ram3man3mao3map3mar3mas2lat4uau1uav3maw3way4uaz2lbk2sbl3t'fof'6obo2lbp3tbq3mbr1tbs2lbu1ybv3mbz3mck4m202k3mcm4mcn4mco4mcp4mcq5ycr4mcs4mct4mcu4mcv4mcw2r2m3rcy2rcz2rdl4sdm4sdn4sdo4sdp4sdq4sds4sdt4sdu4sdv4sdw4sdz3mek3mel3mem3men3meo3mep3meq4ser2wes2wet2weu2wev2wew1wex1wey1wez1wfl3rfm3mfn3mfo3mfp3mfq3mfr3tfs3mft3rfu3rfv3rfw3rfz2w203k6o212m6o2dw2l2cq2l3t3m3u2l17s3x19m3m}'kerning'{cl{4qu5kt5qt5rs17ss5ts}201s{201ss}201t{cks4lscmscnscoscpscls2wu2yu201ts}201x{2wu2yu}2k{201ts}2w{4qx5kx5ou5qx5rs17su5tu}2x{17su5tu5ou}2y{4qx5kx5ou5qx5rs17ss5ts}'fof'-6ofn{17sw5tw5ou5qw5rs}7t{cksclscmscnscoscps4ls}3u{17su5tu5os5qs}3v{17su5tu5os5qs}7p{17su5tu}ck{4qu5kt5qt5rs17ss5ts}4l{4qu5kt5qt5rs17ss5ts}cm{4qu5kt5qt5rs17ss5ts}cn{4qu5kt5qt5rs17ss5ts}co{4qu5kt5qt5rs17ss5ts}cp{4qu5kt5qt5rs17ss5ts}6l{4qu5ou5qw5rt17su5tu}5q{ckuclucmucnucoucpu4lu}5r{ckuclucmucnucoucpu4lu}7q{cksclscmscnscoscps4ls}6p{4qu5ou5qw5rt17sw5tw}ek{4qu5ou5qw5rt17su5tu}el{4qu5ou5qw5rt17su5tu}em{4qu5ou5qw5rt17su5tu}en{4qu5ou5qw5rt17su5tu}eo{4qu5ou5qw5rt17su5tu}ep{4qu5ou5qw5rt17su5tu}es{17ss5ts5qs4qu}et{4qu5ou5qw5rt17sw5tw}eu{4qu5ou5qw5rt17ss5ts}ev{17ss5ts5qs4qu}6z{17sw5tw5ou5qw5rs}fm{17sw5tw5ou5qw5rs}7n{201ts}fo{17sw5tw5ou5qw5rs}fp{17sw5tw5ou5qw5rs}fq{17sw5tw5ou5qw5rs}7r{cksclscmscnscoscps4ls}fs{17sw5tw5ou5qw5rs}ft{17su5tu}fu{17su5tu}fv{17su5tu}fw{17su5tu}fz{cksclscmscnscoscps4ls}}}"),"Helvetica-Bold":l("{'widths'{k3s2q4scx1w201n3r201o6o201s1w201t1w201u1w201w3m201x3m201y3m2k1w2l2l202m2n2n3r2o3r2p5t202q6o2r1s2s2l2t2l2u2r2v3u2w1w2x2l2y1w2z1w3k3r3l3r3m3r3n3r3o3r3p3r3q3r3r3r3s3r203t2l203u2l3v2l3w3u3x3u3y3u3z3x4k6l4l4s4m4s4n4s4o4s4p4m4q3x4r4y4s4s4t1w4u3r4v4s4w3x4x5n4y4s4z4y5k4m5l4y5m4s5n4m5o3x5p4s5q4m5r5y5s4m5t4m5u3x5v2l5w1w5x2l5y3u5z3r6k2l6l3r6m3x6n3r6o3x6p3r6q2l6r3x6s3x6t1w6u1w6v3r6w1w6x5t6y3x6z3x7k3x7l3x7m2r7n3r7o2l7p3x7q3r7r4y7s3r7t3r7u3m7v2r7w1w7x2r7y3u202l3rcl4sal2lam3ran3rao3rap3rar3ras2lat4tau2pav3raw3uay4taz2lbk2sbl3u'fof'6obo2lbp3xbq3rbr1wbs2lbu2obv3rbz3xck4s202k3rcm4scn4sco4scp4scq6ocr4scs4mct4mcu4mcv4mcw1w2m2zcy1wcz1wdl4sdm4ydn4ydo4ydp4ydq4yds4ydt4sdu4sdv4sdw4sdz3xek3rel3rem3ren3reo3rep3req5ter3res3ret3reu3rev3rew1wex1wey1wez1wfl3xfm3xfn3xfo3xfp3xfq3xfr3ufs3xft3xfu3xfv3xfw3xfz3r203k6o212m6o2dw2l2cq2l3t3r3u2l17s4m19m3r}'kerning'{cl{4qs5ku5ot5qs17sv5tv}201t{2ww4wy2yw}201w{2ks}201x{2ww4wy2yw}2k{201ts201xs}2w{7qs4qu5kw5os5qw5rs17su5tu7tsfzs}2x{5ow5qs}2y{7qs4qu5kw5os5qw5rs17su5tu7tsfzs}'fof'-6o7p{17su5tu5ot}ck{4qs5ku5ot5qs17sv5tv}4l{4qs5ku5ot5qs17sv5tv}cm{4qs5ku5ot5qs17sv5tv}cn{4qs5ku5ot5qs17sv5tv}co{4qs5ku5ot5qs17sv5tv}cp{4qs5ku5ot5qs17sv5tv}6l{17st5tt5os}17s{2kwclvcmvcnvcovcpv4lv4wwckv}5o{2kucltcmtcntcotcpt4lt4wtckt}5q{2ksclscmscnscoscps4ls4wvcks}5r{2ks4ws}5t{2kwclvcmvcnvcovcpv4lv4wwckv}eo{17st5tt5os}fu{17su5tu5ot}6p{17ss5ts}ek{17st5tt5os}el{17st5tt5os}em{17st5tt5os}en{17st5tt5os}6o{201ts}ep{17st5tt5os}es{17ss5ts}et{17ss5ts}eu{17ss5ts}ev{17ss5ts}6z{17su5tu5os5qt}fm{17su5tu5os5qt}fn{17su5tu5os5qt}fo{17su5tu5os5qt}fp{17su5tu5os5qt}fq{17su5tu5os5qt}fs{17su5tu5os5qt}ft{17su5tu5ot}7m{5os}fv{17su5tu5ot}fw{17su5tu5ot}}}"),Courier:l("{'widths'{k3w'fof'6o}'kerning'{'fof'-6o}}"),"Courier-BoldOblique":l("{'widths'{k3w'fof'6o}'kerning'{'fof'-6o}}"),"Times-Bold":l("{'widths'{k3q2q5ncx2r201n3m201o6o201s2l201t2l201u2l201w3m201x3m201y3m2k1t2l2l202m2n2n3m2o3m2p6o202q6o2r1w2s2l2t2l2u3m2v3t2w1t2x2l2y1t2z1w3k3m3l3m3m3m3n3m3o3m3p3m3q3m3r3m3s3m203t2l203u2l3v2l3w3t3x3t3y3t3z3m4k5x4l4s4m4m4n4s4o4s4p4m4q3x4r4y4s4y4t2r4u3m4v4y4w4m4x5y4y4s4z4y5k3x5l4y5m4s5n3r5o4m5p4s5q4s5r6o5s4s5t4s5u4m5v2l5w1w5x2l5y3u5z3m6k2l6l3m6m3r6n2w6o3r6p2w6q2l6r3m6s3r6t1w6u2l6v3r6w1w6x5n6y3r6z3m7k3r7l3r7m2w7n2r7o2l7p3r7q3m7r4s7s3m7t3m7u2w7v2r7w1q7x2r7y3o202l3mcl4sal2lam3man3mao3map3mar3mas2lat4uau1yav3maw3tay4uaz2lbk2sbl3t'fof'6obo2lbp3rbr1tbs2lbu2lbv3mbz3mck4s202k3mcm4scn4sco4scp4scq6ocr4scs4mct4mcu4mcv4mcw2r2m3rcy2rcz2rdl4sdm4ydn4ydo4ydp4ydq4yds4ydt4sdu4sdv4sdw4sdz3rek3mel3mem3men3meo3mep3meq4ser2wes2wet2weu2wev2wew1wex1wey1wez1wfl3rfm3mfn3mfo3mfp3mfq3mfr3tfs3mft3rfu3rfv3rfw3rfz3m203k6o212m6o2dw2l2cq2l3t3m3u2l17s4s19m3m}'kerning'{cl{4qt5ks5ot5qy5rw17sv5tv}201t{cks4lscmscnscoscpscls4wv}2k{201ts}2w{4qu5ku7mu5os5qx5ru17su5tu}2x{17su5tu5ou5qs}2y{4qv5kv7mu5ot5qz5ru17su5tu}'fof'-6o7t{cksclscmscnscoscps4ls}3u{17su5tu5os5qu}3v{17su5tu5os5qu}fu{17su5tu5ou5qu}7p{17su5tu5ou5qu}ck{4qt5ks5ot5qy5rw17sv5tv}4l{4qt5ks5ot5qy5rw17sv5tv}cm{4qt5ks5ot5qy5rw17sv5tv}cn{4qt5ks5ot5qy5rw17sv5tv}co{4qt5ks5ot5qy5rw17sv5tv}cp{4qt5ks5ot5qy5rw17sv5tv}6l{17st5tt5ou5qu}17s{ckuclucmucnucoucpu4lu4wu}5o{ckuclucmucnucoucpu4lu4wu}5q{ckzclzcmzcnzcozcpz4lz4wu}5r{ckxclxcmxcnxcoxcpx4lx4wu}5t{ckuclucmucnucoucpu4lu4wu}7q{ckuclucmucnucoucpu4lu}6p{17sw5tw5ou5qu}ek{17st5tt5qu}el{17st5tt5ou5qu}em{17st5tt5qu}en{17st5tt5qu}eo{17st5tt5qu}ep{17st5tt5ou5qu}es{17ss5ts5qu}et{17sw5tw5ou5qu}eu{17sw5tw5ou5qu}ev{17ss5ts5qu}6z{17sw5tw5ou5qu5rs}fm{17sw5tw5ou5qu5rs}fn{17sw5tw5ou5qu5rs}fo{17sw5tw5ou5qu5rs}fp{17sw5tw5ou5qu5rs}fq{17sw5tw5ou5qu5rs}7r{cktcltcmtcntcotcpt4lt5os}fs{17sw5tw5ou5qu5rs}ft{17su5tu5ou5qu}7m{5os}fv{17su5tu5ou5qu}fw{17su5tu5ou5qu}fz{cksclscmscnscoscps4ls}}}"),Symbol:l("{'widths'{k3uaw4r19m3m2k1t2l2l202m2y2n3m2p5n202q6o3k3m2s2l2t2l2v3r2w1t3m3m2y1t2z1wbk2sbl3r'fof'6o3n3m3o3m3p3m3q3m3r3m3s3m3t3m3u1w3v1w3w3r3x3r3y3r3z2wbp3t3l3m5v2l5x2l5z3m2q4yfr3r7v3k7w1o7x3k}'kerning'{'fof'-6o}}"),Helvetica:l("{'widths'{k3p2q4mcx1w201n3r201o6o201s1q201t1q201u1q201w2l201x2l201y2l2k1w2l1w202m2n2n3r2o3r2p5t202q6o2r1n2s2l2t2l2u2r2v3u2w1w2x2l2y1w2z1w3k3r3l3r3m3r3n3r3o3r3p3r3q3r3r3r3s3r203t2l203u2l3v1w3w3u3x3u3y3u3z3r4k6p4l4m4m4m4n4s4o4s4p4m4q3x4r4y4s4s4t1w4u3m4v4m4w3r4x5n4y4s4z4y5k4m5l4y5m4s5n4m5o3x5p4s5q4m5r5y5s4m5t4m5u3x5v1w5w1w5x1w5y2z5z3r6k2l6l3r6m3r6n3m6o3r6p3r6q1w6r3r6s3r6t1q6u1q6v3m6w1q6x5n6y3r6z3r7k3r7l3r7m2l7n3m7o1w7p3r7q3m7r4s7s3m7t3m7u3m7v2l7w1u7x2l7y3u202l3rcl4mal2lam3ran3rao3rap3rar3ras2lat4tau2pav3raw3uay4taz2lbk2sbl3u'fof'6obo2lbp3rbr1wbs2lbu2obv3rbz3xck4m202k3rcm4mcn4mco4mcp4mcq6ocr4scs4mct4mcu4mcv4mcw1w2m2ncy1wcz1wdl4sdm4ydn4ydo4ydp4ydq4yds4ydt4sdu4sdv4sdw4sdz3xek3rel3rem3ren3reo3rep3req5ter3mes3ret3reu3rev3rew1wex1wey1wez1wfl3rfm3rfn3rfo3rfp3rfq3rfr3ufs3xft3rfu3rfv3rfw3rfz3m203k6o212m6o2dw2l2cq2l3t3r3u1w17s4m19m3r}'kerning'{5q{4wv}cl{4qs5kw5ow5qs17sv5tv}201t{2wu4w1k2yu}201x{2wu4wy2yu}17s{2ktclucmucnu4otcpu4lu4wycoucku}2w{7qs4qz5k1m17sy5ow5qx5rsfsu5ty7tufzu}2x{17sy5ty5oy5qs}2y{7qs4qz5k1m17sy5ow5qx5rsfsu5ty7tufzu}'fof'-6o7p{17sv5tv5ow}ck{4qs5kw5ow5qs17sv5tv}4l{4qs5kw5ow5qs17sv5tv}cm{4qs5kw5ow5qs17sv5tv}cn{4qs5kw5ow5qs17sv5tv}co{4qs5kw5ow5qs17sv5tv}cp{4qs5kw5ow5qs17sv5tv}6l{17sy5ty5ow}do{17st5tt}4z{17st5tt}7s{fst}dm{17st5tt}dn{17st5tt}5o{ckwclwcmwcnwcowcpw4lw4wv}dp{17st5tt}dq{17st5tt}7t{5ow}ds{17st5tt}5t{2ktclucmucnu4otcpu4lu4wycoucku}fu{17sv5tv5ow}6p{17sy5ty5ow5qs}ek{17sy5ty5ow}el{17sy5ty5ow}em{17sy5ty5ow}en{5ty}eo{17sy5ty5ow}ep{17sy5ty5ow}es{17sy5ty5qs}et{17sy5ty5ow5qs}eu{17sy5ty5ow5qs}ev{17sy5ty5ow5qs}6z{17sy5ty5ow5qs}fm{17sy5ty5ow5qs}fn{17sy5ty5ow5qs}fo{17sy5ty5ow5qs}fp{17sy5ty5qs}fq{17sy5ty5ow5qs}7r{5ow}fs{17sy5ty5ow5qs}ft{17sv5tv5ow}7m{5ow}fv{17sv5tv5ow}fw{17sv5tv5ow}}}"),"Helvetica-BoldOblique":l("{'widths'{k3s2q4scx1w201n3r201o6o201s1w201t1w201u1w201w3m201x3m201y3m2k1w2l2l202m2n2n3r2o3r2p5t202q6o2r1s2s2l2t2l2u2r2v3u2w1w2x2l2y1w2z1w3k3r3l3r3m3r3n3r3o3r3p3r3q3r3r3r3s3r203t2l203u2l3v2l3w3u3x3u3y3u3z3x4k6l4l4s4m4s4n4s4o4s4p4m4q3x4r4y4s4s4t1w4u3r4v4s4w3x4x5n4y4s4z4y5k4m5l4y5m4s5n4m5o3x5p4s5q4m5r5y5s4m5t4m5u3x5v2l5w1w5x2l5y3u5z3r6k2l6l3r6m3x6n3r6o3x6p3r6q2l6r3x6s3x6t1w6u1w6v3r6w1w6x5t6y3x6z3x7k3x7l3x7m2r7n3r7o2l7p3x7q3r7r4y7s3r7t3r7u3m7v2r7w1w7x2r7y3u202l3rcl4sal2lam3ran3rao3rap3rar3ras2lat4tau2pav3raw3uay4taz2lbk2sbl3u'fof'6obo2lbp3xbq3rbr1wbs2lbu2obv3rbz3xck4s202k3rcm4scn4sco4scp4scq6ocr4scs4mct4mcu4mcv4mcw1w2m2zcy1wcz1wdl4sdm4ydn4ydo4ydp4ydq4yds4ydt4sdu4sdv4sdw4sdz3xek3rel3rem3ren3reo3rep3req5ter3res3ret3reu3rev3rew1wex1wey1wez1wfl3xfm3xfn3xfo3xfp3xfq3xfr3ufs3xft3xfu3xfv3xfw3xfz3r203k6o212m6o2dw2l2cq2l3t3r3u2l17s4m19m3r}'kerning'{cl{4qs5ku5ot5qs17sv5tv}201t{2ww4wy2yw}201w{2ks}201x{2ww4wy2yw}2k{201ts201xs}2w{7qs4qu5kw5os5qw5rs17su5tu7tsfzs}2x{5ow5qs}2y{7qs4qu5kw5os5qw5rs17su5tu7tsfzs}'fof'-6o7p{17su5tu5ot}ck{4qs5ku5ot5qs17sv5tv}4l{4qs5ku5ot5qs17sv5tv}cm{4qs5ku5ot5qs17sv5tv}cn{4qs5ku5ot5qs17sv5tv}co{4qs5ku5ot5qs17sv5tv}cp{4qs5ku5ot5qs17sv5tv}6l{17st5tt5os}17s{2kwclvcmvcnvcovcpv4lv4wwckv}5o{2kucltcmtcntcotcpt4lt4wtckt}5q{2ksclscmscnscoscps4ls4wvcks}5r{2ks4ws}5t{2kwclvcmvcnvcovcpv4lv4wwckv}eo{17st5tt5os}fu{17su5tu5ot}6p{17ss5ts}ek{17st5tt5os}el{17st5tt5os}em{17st5tt5os}en{17st5tt5os}6o{201ts}ep{17st5tt5os}es{17ss5ts}et{17ss5ts}eu{17ss5ts}ev{17ss5ts}6z{17su5tu5os5qt}fm{17su5tu5os5qt}fn{17su5tu5os5qt}fo{17su5tu5os5qt}fp{17su5tu5os5qt}fq{17su5tu5os5qt}fs{17su5tu5os5qt}ft{17su5tu5ot}7m{5os}fv{17su5tu5ot}fw{17su5tu5ot}}}"),ZapfDingbats:l("{'widths'{k4u2k1w'fof'6o}'kerning'{'fof'-6o}}"),"Courier-Bold":l("{'widths'{k3w'fof'6o}'kerning'{'fof'-6o}}"),"Times-Italic":l("{'widths'{k3n2q4ycx2l201n3m201o5t201s2l201t2l201u2l201w3r201x3r201y3r2k1t2l2l202m2n2n3m2o3m2p5n202q5t2r1p2s2l2t2l2u3m2v4n2w1t2x2l2y1t2z1w3k3m3l3m3m3m3n3m3o3m3p3m3q3m3r3m3s3m203t2l203u2l3v2l3w4n3x4n3y4n3z3m4k5w4l3x4m3x4n4m4o4s4p3x4q3x4r4s4s4s4t2l4u2w4v4m4w3r4x5n4y4m4z4s5k3x5l4s5m3x5n3m5o3r5p4s5q3x5r5n5s3x5t3r5u3r5v2r5w1w5x2r5y2u5z3m6k2l6l3m6m3m6n2w6o3m6p2w6q1w6r3m6s3m6t1w6u1w6v2w6w1w6x4s6y3m6z3m7k3m7l3m7m2r7n2r7o1w7p3m7q2w7r4m7s2w7t2w7u2r7v2s7w1v7x2s7y3q202l3mcl3xal2ram3man3mao3map3mar3mas2lat4wau1vav3maw4nay4waz2lbk2sbl4n'fof'6obo2lbp3mbq3obr1tbs2lbu1zbv3mbz3mck3x202k3mcm3xcn3xco3xcp3xcq5tcr4mcs3xct3xcu3xcv3xcw2l2m2ucy2lcz2ldl4mdm4sdn4sdo4sdp4sdq4sds4sdt4sdu4sdv4sdw4sdz3mek3mel3mem3men3meo3mep3meq4mer2wes2wet2weu2wev2wew1wex1wey1wez1wfl3mfm3mfn3mfo3mfp3mfq3mfr4nfs3mft3mfu3mfv3mfw3mfz2w203k6o212m6m2dw2l2cq2l3t3m3u2l17s3r19m3m}'kerning'{cl{5kt4qw}201s{201sw}201t{201tw2wy2yy6q-t}201x{2wy2yy}2k{201tw}2w{7qs4qy7rs5ky7mw5os5qx5ru17su5tu}2x{17ss5ts5os}2y{7qs4qy7rs5ky7mw5os5qx5ru17su5tu}'fof'-6o6t{17ss5ts5qs}7t{5os}3v{5qs}7p{17su5tu5qs}ck{5kt4qw}4l{5kt4qw}cm{5kt4qw}cn{5kt4qw}co{5kt4qw}cp{5kt4qw}6l{4qs5ks5ou5qw5ru17su5tu}17s{2ks}5q{ckvclvcmvcnvcovcpv4lv}5r{ckuclucmucnucoucpu4lu}5t{2ks}6p{4qs5ks5ou5qw5ru17su5tu}ek{4qs5ks5ou5qw5ru17su5tu}el{4qs5ks5ou5qw5ru17su5tu}em{4qs5ks5ou5qw5ru17su5tu}en{4qs5ks5ou5qw5ru17su5tu}eo{4qs5ks5ou5qw5ru17su5tu}ep{4qs5ks5ou5qw5ru17su5tu}es{5ks5qs4qs}et{4qs5ks5ou5qw5ru17su5tu}eu{4qs5ks5qw5ru17su5tu}ev{5ks5qs4qs}ex{17ss5ts5qs}6z{4qv5ks5ou5qw5ru17su5tu}fm{4qv5ks5ou5qw5ru17su5tu}fn{4qv5ks5ou5qw5ru17su5tu}fo{4qv5ks5ou5qw5ru17su5tu}fp{4qv5ks5ou5qw5ru17su5tu}fq{4qv5ks5ou5qw5ru17su5tu}7r{5os}fs{4qv5ks5ou5qw5ru17su5tu}ft{17su5tu5qs}fu{17su5tu5qs}fv{17su5tu5qs}fw{17su5tu5qs}}}"),"Times-Roman":l("{'widths'{k3n2q4ycx2l201n3m201o6o201s2l201t2l201u2l201w2w201x2w201y2w2k1t2l2l202m2n2n3m2o3m2p5n202q6o2r1m2s2l2t2l2u3m2v3s2w1t2x2l2y1t2z1w3k3m3l3m3m3m3n3m3o3m3p3m3q3m3r3m3s3m203t2l203u2l3v1w3w3s3x3s3y3s3z2w4k5w4l4s4m4m4n4m4o4s4p3x4q3r4r4s4s4s4t2l4u2r4v4s4w3x4x5t4y4s4z4s5k3r5l4s5m4m5n3r5o3x5p4s5q4s5r5y5s4s5t4s5u3x5v2l5w1w5x2l5y2z5z3m6k2l6l2w6m3m6n2w6o3m6p2w6q2l6r3m6s3m6t1w6u1w6v3m6w1w6x4y6y3m6z3m7k3m7l3m7m2l7n2r7o1w7p3m7q3m7r4s7s3m7t3m7u2w7v3k7w1o7x3k7y3q202l3mcl4sal2lam3man3mao3map3mar3mas2lat4wau1vav3maw3say4waz2lbk2sbl3s'fof'6obo2lbp3mbq2xbr1tbs2lbu1zbv3mbz2wck4s202k3mcm4scn4sco4scp4scq5tcr4mcs3xct3xcu3xcv3xcw2l2m2tcy2lcz2ldl4sdm4sdn4sdo4sdp4sdq4sds4sdt4sdu4sdv4sdw4sdz3mek2wel2wem2wen2weo2wep2weq4mer2wes2wet2weu2wev2wew1wex1wey1wez1wfl3mfm3mfn3mfo3mfp3mfq3mfr3sfs3mft3mfu3mfv3mfw3mfz3m203k6o212m6m2dw2l2cq2l3t3m3u1w17s4s19m3m}'kerning'{cl{4qs5ku17sw5ou5qy5rw201ss5tw201ws}201s{201ss}201t{ckw4lwcmwcnwcowcpwclw4wu201ts}2k{201ts}2w{4qs5kw5os5qx5ru17sx5tx}2x{17sw5tw5ou5qu}2y{4qs5kw5os5qx5ru17sx5tx}'fof'-6o7t{ckuclucmucnucoucpu4lu5os5rs}3u{17su5tu5qs}3v{17su5tu5qs}7p{17sw5tw5qs}ck{4qs5ku17sw5ou5qy5rw201ss5tw201ws}4l{4qs5ku17sw5ou5qy5rw201ss5tw201ws}cm{4qs5ku17sw5ou5qy5rw201ss5tw201ws}cn{4qs5ku17sw5ou5qy5rw201ss5tw201ws}co{4qs5ku17sw5ou5qy5rw201ss5tw201ws}cp{4qs5ku17sw5ou5qy5rw201ss5tw201ws}6l{17su5tu5os5qw5rs}17s{2ktclvcmvcnvcovcpv4lv4wuckv}5o{ckwclwcmwcnwcowcpw4lw4wu}5q{ckyclycmycnycoycpy4ly4wu5ms}5r{cktcltcmtcntcotcpt4lt4ws}5t{2ktclvcmvcnvcovcpv4lv4wuckv}7q{cksclscmscnscoscps4ls}6p{17su5tu5qw5rs}ek{5qs5rs}el{17su5tu5os5qw5rs}em{17su5tu5os5qs5rs}en{17su5qs5rs}eo{5qs5rs}ep{17su5tu5os5qw5rs}es{5qs}et{17su5tu5qw5rs}eu{17su5tu5qs5rs}ev{5qs}6z{17sv5tv5os5qx5rs}fm{5os5qt5rs}fn{17sv5tv5os5qx5rs}fo{17sv5tv5os5qx5rs}fp{5os5qt5rs}fq{5os5qt5rs}7r{ckuclucmucnucoucpu4lu5os}fs{17sv5tv5os5qx5rs}ft{17ss5ts5qs}fu{17sw5tw5qs}fv{17sw5tw5qs}fw{17ss5ts5qs}fz{ckuclucmucnucoucpu4lu5os5rs}}}"),"Helvetica-Oblique":l("{'widths'{k3p2q4mcx1w201n3r201o6o201s1q201t1q201u1q201w2l201x2l201y2l2k1w2l1w202m2n2n3r2o3r2p5t202q6o2r1n2s2l2t2l2u2r2v3u2w1w2x2l2y1w2z1w3k3r3l3r3m3r3n3r3o3r3p3r3q3r3r3r3s3r203t2l203u2l3v1w3w3u3x3u3y3u3z3r4k6p4l4m4m4m4n4s4o4s4p4m4q3x4r4y4s4s4t1w4u3m4v4m4w3r4x5n4y4s4z4y5k4m5l4y5m4s5n4m5o3x5p4s5q4m5r5y5s4m5t4m5u3x5v1w5w1w5x1w5y2z5z3r6k2l6l3r6m3r6n3m6o3r6p3r6q1w6r3r6s3r6t1q6u1q6v3m6w1q6x5n6y3r6z3r7k3r7l3r7m2l7n3m7o1w7p3r7q3m7r4s7s3m7t3m7u3m7v2l7w1u7x2l7y3u202l3rcl4mal2lam3ran3rao3rap3rar3ras2lat4tau2pav3raw3uay4taz2lbk2sbl3u'fof'6obo2lbp3rbr1wbs2lbu2obv3rbz3xck4m202k3rcm4mcn4mco4mcp4mcq6ocr4scs4mct4mcu4mcv4mcw1w2m2ncy1wcz1wdl4sdm4ydn4ydo4ydp4ydq4yds4ydt4sdu4sdv4sdw4sdz3xek3rel3rem3ren3reo3rep3req5ter3mes3ret3reu3rev3rew1wex1wey1wez1wfl3rfm3rfn3rfo3rfp3rfq3rfr3ufs3xft3rfu3rfv3rfw3rfz3m203k6o212m6o2dw2l2cq2l3t3r3u1w17s4m19m3r}'kerning'{5q{4wv}cl{4qs5kw5ow5qs17sv5tv}201t{2wu4w1k2yu}201x{2wu4wy2yu}17s{2ktclucmucnu4otcpu4lu4wycoucku}2w{7qs4qz5k1m17sy5ow5qx5rsfsu5ty7tufzu}2x{17sy5ty5oy5qs}2y{7qs4qz5k1m17sy5ow5qx5rsfsu5ty7tufzu}'fof'-6o7p{17sv5tv5ow}ck{4qs5kw5ow5qs17sv5tv}4l{4qs5kw5ow5qs17sv5tv}cm{4qs5kw5ow5qs17sv5tv}cn{4qs5kw5ow5qs17sv5tv}co{4qs5kw5ow5qs17sv5tv}cp{4qs5kw5ow5qs17sv5tv}6l{17sy5ty5ow}do{17st5tt}4z{17st5tt}7s{fst}dm{17st5tt}dn{17st5tt}5o{ckwclwcmwcnwcowcpw4lw4wv}dp{17st5tt}dq{17st5tt}7t{5ow}ds{17st5tt}5t{2ktclucmucnu4otcpu4lu4wycoucku}fu{17sv5tv5ow}6p{17sy5ty5ow5qs}ek{17sy5ty5ow}el{17sy5ty5ow}em{17sy5ty5ow}en{5ty}eo{17sy5ty5ow}ep{17sy5ty5ow}es{17sy5ty5qs}et{17sy5ty5ow5qs}eu{17sy5ty5ow5qs}ev{17sy5ty5ow5qs}6z{17sy5ty5ow5qs}fm{17sy5ty5ow5qs}fn{17sy5ty5ow5qs}fo{17sy5ty5ow5qs}fp{17sy5ty5qs}fq{17sy5ty5ow5qs}7r{5ow}fs{17sy5ty5ow5qs}ft{17sv5tv5ow}7m{5ow}fv{17sv5tv5ow}fw{17sv5tv5ow}}}")}};t.events.push(["addFont",function(h){var d=h.font,y=f.Unicode[d.postScriptName];y&&(d.metadata.Unicode={},d.metadata.Unicode.widths=y.widths,d.metadata.Unicode.kerning=y.kerning);var m=u.Unicode[d.postScriptName];m&&(d.metadata.Unicode.encoding=m,d.encoding=m.codePages[0])}])})(qt.API),(function(t){var e=function(n){for(var i=n.length,r=new Uint8Array(i),s=0;s<i;s++)r[s]=n.charCodeAt(s);return r};t.API.events.push(["addFont",function(n){var i=void 0,r=n.font,s=n.instance;if(!r.isStandardFont){if(s===void 0)throw new Error("Font does not exist in vFS, import fonts or remove declaration doc.addFont('"+r.postScriptName+"').");if(typeof(i=s.existsFileInVFS(r.postScriptName)===!1?s.loadFile(r.postScriptName):s.getFileFromVFS(r.postScriptName))!="string")throw new Error("Font is not stored as string-data in vFS, import fonts or remove declaration doc.addFont('"+r.postScriptName+"').");(function(a,o){o=/^\x00\x01\x00\x00/.test(o)?e(o):e(lh(o)),a.metadata=t.API.TTFFont.open(o),a.metadata.Unicode=a.metadata.Unicode||{encoding:{},kerning:{},widths:[]},a.metadata.glyIdsUsed=[0]})(r,i)}}])})(qt),qt.API.addSvgAsImage=function(t,e,n,i,r,s,a,o){if(isNaN(e)||isNaN(n))throw Qn.error("jsPDF.addSvgAsImage: Invalid coordinates",arguments),new Error("Invalid coordinates passed to jsPDF.addSvgAsImage");if(isNaN(i)||isNaN(r))throw Qn.error("jsPDF.addSvgAsImage: Invalid measurements",arguments),new Error("Invalid measurements (width and/or height) passed to jsPDF.addSvgAsImage");var l=document.createElement("canvas");l.width=i,l.height=r;var c=l.getContext("2d");c.fillStyle="#fff",c.fillRect(0,0,l.width,l.height);var u={ignoreMouse:!0,ignoreAnimation:!0,ignoreDimensions:!0},f=this;return(nn.canvg?Promise.resolve(nn.canvg):gs(()=>import("./CCPXzrsK.js"),[],import.meta.url)).catch(function(h){return Promise.reject(new Error("Could not load canvg: "+h))}).then(function(h){return h.default?h.default:h}).then(function(h){return h.fromString(c,t,u)},function(){return Promise.reject(new Error("Could not load canvg."))}).then(function(h){return h.render(u)}).then(function(){f.addImage(l.toDataURL("image/jpeg",1),e,n,i,r,a,o)})},qt.API.putTotalPages=function(t){var e,n=0;parseInt(this.internal.getFont().id.substr(1),10)<15?(e=new RegExp(t,"g"),n=this.internal.getNumberOfPages()):(e=new RegExp(this.pdfEscape16(t,this.internal.getFont()),"g"),n=this.pdfEscape16(this.internal.getNumberOfPages()+"",this.internal.getFont()));for(var i=1;i<=this.internal.getNumberOfPages();i++)for(var r=0;r<this.internal.pages[i].length;r++)this.internal.pages[i][r]=this.internal.pages[i][r].replace(e,n);return this},qt.API.viewerPreferences=function(t,e){var n;t=t||{},e=e||!1;var i,r,s,a={HideToolbar:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.3},HideMenubar:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.3},HideWindowUI:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.3},FitWindow:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.3},CenterWindow:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.3},DisplayDocTitle:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.4},NonFullScreenPageMode:{defaultValue:"UseNone",value:"UseNone",type:"name",explicitSet:!1,valueSet:["UseNone","UseOutlines","UseThumbs","UseOC"],pdfVersion:1.3},Direction:{defaultValue:"L2R",value:"L2R",type:"name",explicitSet:!1,valueSet:["L2R","R2L"],pdfVersion:1.3},ViewArea:{defaultValue:"CropBox",value:"CropBox",type:"name",explicitSet:!1,valueSet:["MediaBox","CropBox","TrimBox","BleedBox","ArtBox"],pdfVersion:1.4},ViewClip:{defaultValue:"CropBox",value:"CropBox",type:"name",explicitSet:!1,valueSet:["MediaBox","CropBox","TrimBox","BleedBox","ArtBox"],pdfVersion:1.4},PrintArea:{defaultValue:"CropBox",value:"CropBox",type:"name",explicitSet:!1,valueSet:["MediaBox","CropBox","TrimBox","BleedBox","ArtBox"],pdfVersion:1.4},PrintClip:{defaultValue:"CropBox",value:"CropBox",type:"name",explicitSet:!1,valueSet:["MediaBox","CropBox","TrimBox","BleedBox","ArtBox"],pdfVersion:1.4},PrintScaling:{defaultValue:"AppDefault",value:"AppDefault",type:"name",explicitSet:!1,valueSet:["AppDefault","None"],pdfVersion:1.6},Duplex:{defaultValue:"",value:"none",type:"name",explicitSet:!1,valueSet:["Simplex","DuplexFlipShortEdge","DuplexFlipLongEdge","none"],pdfVersion:1.7},PickTrayByPDFSize:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.7},PrintPageRange:{defaultValue:"",value:"",type:"array",explicitSet:!1,valueSet:null,pdfVersion:1.7},NumCopies:{defaultValue:1,value:1,type:"integer",explicitSet:!1,valueSet:null,pdfVersion:1.7}},o=Object.keys(a),l=[],c=0,u=0,f=0;function h(y,m){var x,w=!1;for(x=0;x<y.length;x+=1)y[x]===m&&(w=!0);return w}if(this.internal.viewerpreferences===void 0&&(this.internal.viewerpreferences={},this.internal.viewerpreferences.configuration=JSON.parse(JSON.stringify(a)),this.internal.viewerpreferences.isSubscribed=!1),n=this.internal.viewerpreferences.configuration,t==="reset"||e===!0){var d=o.length;for(f=0;f<d;f+=1)n[o[f]].value=n[o[f]].defaultValue,n[o[f]].explicitSet=!1}if(jn(t)==="object"){for(r in t)if(s=t[r],h(o,r)&&s!==void 0){if(n[r].type==="boolean"&&typeof s=="boolean")n[r].value=s;else if(n[r].type==="name"&&h(n[r].valueSet,s))n[r].value=s;else if(n[r].type==="integer"&&Number.isInteger(s))n[r].value=s;else if(n[r].type==="array"){for(c=0;c<s.length;c+=1)if(i=!0,s[c].length===1&&typeof s[c][0]=="number")l.push(String(s[c]-1));else if(s[c].length>1){for(u=0;u<s[c].length;u+=1)typeof s[c][u]!="number"&&(i=!1);i===!0&&l.push([s[c][0]-1,s[c][1]-1].join(" "))}n[r].value="["+l.join(" ")+"]"}else n[r].value=n[r].defaultValue;n[r].explicitSet=!0}}return this.internal.viewerpreferences.isSubscribed===!1&&(this.internal.events.subscribe("putCatalog",function(){var y,m=[];for(y in n)n[y].explicitSet===!0&&(n[y].type==="name"?m.push("/"+y+" /"+n[y].value):m.push("/"+y+" "+n[y].value));m.length!==0&&this.internal.write(`/ViewerPreferences
<<
`+m.join(`
`)+`
>>`)}),this.internal.viewerpreferences.isSubscribed=!0),this.internal.viewerpreferences.configuration=n,this},qt.API.addMetadata=function(t,e){return this.internal.__metadata__===void 0&&(this.internal.__metadata__={metadata:t,namespaceUri:e??"http://jspdf.default.namespaceuri/",rawXml:typeof e=="boolean"&&e},this.internal.events.subscribe("putCatalog",gF),this.internal.events.subscribe("postPutResources",pF)),this},(function(t){var e=t.API,n=e.pdfEscape16=function(s,a){for(var o,l=a.metadata.Unicode.widths,c=["","0","00","000","0000"],u=[""],f=0,h=s.length;f<h;++f){if(o=a.metadata.characterToGlyph(s.charCodeAt(f)),a.metadata.glyIdsUsed.push(o),a.metadata.toUnicode[o]=s.charCodeAt(f),l.indexOf(o)==-1&&(l.push(o),l.push([parseInt(a.metadata.widthOfGlyph(o),10)])),o=="0")return u.join("");o=o.toString(16),u.push(c[4-o.length],o)}return u.join("")},i=function(s){var a,o,l,c,u,f,h;for(u=`/CIDInit /ProcSet findresource begin
12 dict begin
begincmap
/CIDSystemInfo <<
  /Registry (Adobe)
  /Ordering (UCS)
  /Supplement 0
>> def
/CMapName /Adobe-Identity-UCS def
/CMapType 2 def
1 begincodespacerange
<0000><ffff>
endcodespacerange`,l=[],f=0,h=(o=Object.keys(s).sort(function(d,y){return d-y})).length;f<h;f++)a=o[f],l.length>=100&&(u+=`
`+l.length+` beginbfchar
`+l.join(`
`)+`
endbfchar`,l=[]),s[a]!==void 0&&s[a]!==null&&typeof s[a].toString=="function"&&(c=("0000"+s[a].toString(16)).slice(-4),a=("0000"+(+a).toString(16)).slice(-4),l.push("<"+a+"><"+c+">"));return l.length&&(u+=`
`+l.length+` beginbfchar
`+l.join(`
`)+`
endbfchar
`),u+`endcmap
CMapName currentdict /CMap defineresource pop
end
end`};e.events.push(["putFont",function(s){(function(a){var o=a.font,l=a.out,c=a.newObject,u=a.putStream;if(o.metadata instanceof t.API.TTFFont&&o.encoding==="Identity-H"){for(var f=o.metadata.Unicode.widths,h=o.metadata.subset.encode(o.metadata.glyIdsUsed,1),d="",y=0;y<h.length;y++)d+=String.fromCharCode(h[y]);var m=c();u({data:d,addLength1:!0,objectId:m}),l("endobj");var x=c();u({data:i(o.metadata.toUnicode),addLength1:!0,objectId:x}),l("endobj");var w=c();l("<<"),l("/Type /FontDescriptor"),l("/FontName /"+au(o.fontName)),l("/FontFile2 "+m+" 0 R"),l("/FontBBox "+t.API.PDFObject.convert(o.metadata.bbox)),l("/Flags "+o.metadata.flags),l("/StemV "+o.metadata.stemV),l("/ItalicAngle "+o.metadata.italicAngle),l("/Ascent "+o.metadata.ascender),l("/Descent "+o.metadata.decender),l("/CapHeight "+o.metadata.capHeight),l(">>"),l("endobj");var S=c();l("<<"),l("/Type /Font"),l("/BaseFont /"+au(o.fontName)),l("/FontDescriptor "+w+" 0 R"),l("/W "+t.API.PDFObject.convert(f)),l("/CIDToGIDMap /Identity"),l("/DW 1000"),l("/Subtype /CIDFontType2"),l("/CIDSystemInfo"),l("<<"),l("/Supplement 0"),l("/Registry (Adobe)"),l("/Ordering ("+o.encoding+")"),l(">>"),l(">>"),l("endobj"),o.objectNumber=c(),l("<<"),l("/Type /Font"),l("/Subtype /Type0"),l("/ToUnicode "+x+" 0 R"),l("/BaseFont /"+au(o.fontName)),l("/Encoding /"+o.encoding),l("/DescendantFonts ["+S+" 0 R]"),l(">>"),l("endobj"),o.isAlreadyPutted=!0}})(s)}]),e.events.push(["putFont",function(s){(function(a){var o=a.font,l=a.out,c=a.newObject,u=a.putStream;if(o.metadata instanceof t.API.TTFFont&&o.encoding==="WinAnsiEncoding"){for(var f=o.metadata.rawData,h="",d=0;d<f.length;d++)h+=String.fromCharCode(f[d]);var y=c();u({data:h,addLength1:!0,objectId:y}),l("endobj");var m=c();u({data:i(o.metadata.toUnicode),addLength1:!0,objectId:m}),l("endobj");var x=c();l("<<"),l("/Descent "+o.metadata.decender),l("/CapHeight "+o.metadata.capHeight),l("/StemV "+o.metadata.stemV),l("/Type /FontDescriptor"),l("/FontFile2 "+y+" 0 R"),l("/Flags 96"),l("/FontBBox "+t.API.PDFObject.convert(o.metadata.bbox)),l("/FontName /"+au(o.fontName)),l("/ItalicAngle "+o.metadata.italicAngle),l("/Ascent "+o.metadata.ascender),l(">>"),l("endobj"),o.objectNumber=c();for(var w=0;w<o.metadata.hmtx.widths.length;w++)o.metadata.hmtx.widths[w]=parseInt(o.metadata.hmtx.widths[w]*(1e3/o.metadata.head.unitsPerEm));l("<</Subtype/TrueType/Type/Font/ToUnicode "+m+" 0 R/BaseFont/"+au(o.fontName)+"/FontDescriptor "+x+" 0 R/Encoding/"+o.encoding+" /FirstChar 29 /LastChar 255 /Widths "+t.API.PDFObject.convert(o.metadata.hmtx.widths)+">>"),l("endobj"),o.isAlreadyPutted=!0}})(s)}]);var r=function(s){var a,o=s.text||"",l=s.x,c=s.y,u=s.options||{},f=s.mutex||{},h=f.pdfEscape,d=f.activeFontKey,y=f.fonts,m=d,x="",w=0,S="",A=y[m].encoding;if(y[m].encoding!=="Identity-H")return{text:o,x:l,y:c,options:u,mutex:f};for(S=o,m=d,Array.isArray(o)&&(S=o[0]),w=0;w<S.length;w+=1)y[m].metadata.hasOwnProperty("cmap")&&(a=y[m].metadata.cmap.unicode.codeMap[S[w].charCodeAt(0)]),a||S[w].charCodeAt(0)<256&&y[m].metadata.hasOwnProperty("Unicode")?x+=S[w]:x+="";var _="";return parseInt(m.slice(1))<14||A==="WinAnsiEncoding"?_=h(x,m).split("").map(function(M){return M.charCodeAt(0).toString(16)}).join(""):A==="Identity-H"&&(_=n(x,y[m])),f.isHex=!0,{text:_,x:l,y:c,options:u,mutex:f}};e.events.push(["postProcessText",function(s){var a=s.text||"",o=[],l={text:a,x:s.x,y:s.y,options:s.options,mutex:s.mutex};if(Array.isArray(a)){var c=0;for(c=0;c<a.length;c+=1)Array.isArray(a[c])&&a[c].length===3?o.push([r(Object.assign({},l,{text:a[c][0]})).text,a[c][1],a[c][2]]):o.push(r(Object.assign({},l,{text:a[c]})).text);s.text=o}else s.text=r(Object.assign({},l,{text:a})).text}])})(qt),(function(t){var e=function(){return this.internal.vFS===void 0&&(this.internal.vFS={}),!0};t.existsFileInVFS=function(n){return e.call(this),this.internal.vFS[n]!==void 0},t.addFileToVFS=function(n,i){return e.call(this),this.internal.vFS[n]=i,this},t.getFileFromVFS=function(n){return e.call(this),this.internal.vFS[n]!==void 0?this.internal.vFS[n]:null}})(qt.API),(function(t){t.__bidiEngine__=t.prototype.__bidiEngine__=function(i){var r,s,a,o,l,c,u,f=e,h=[[0,3,0,1,0,0,0],[0,3,0,1,2,2,0],[0,3,0,17,2,0,1],[0,3,5,5,4,1,0],[0,3,21,21,4,0,1],[0,3,5,5,4,2,0]],d=[[2,0,1,1,0,1,0],[2,0,1,1,0,2,0],[2,0,2,1,3,2,0],[2,0,2,33,3,1,1]],y={L:0,R:1,EN:2,AN:3,N:4,B:5,S:6},m={0:0,5:1,6:2,7:3,32:4,251:5,254:6,255:7},x=["(",")","(","<",">","<","[","]","[","{","}","{","Â«","Â»","Â«","â¹","âº","â¹","â","â","â","â½","â¾","â½","â","â","â","â¤","â¥","â¤","â©","âª","â©","ï¹","ï¹","ï¹","ï¹","ï¹","ï¹","ï¹","ï¹","ï¹","ï¹¤","ï¹¥","ï¹¤"],w=new RegExp(/^([1-4|9]|1[0-9]|2[0-9]|3[0168]|4[04589]|5[012]|7[78]|159|16[0-9]|17[0-2]|21[569]|22[03489]|250)$/),S=!1,A=0;this.__bidiEngine__={};var _=function(C){var N=C.charCodeAt(),B=N>>8,E=m[B];return E!==void 0?f[256*E+(255&N)]:B===252||B===253?"AL":w.test(B)?"L":B===8?"R":"N"},M=function(C){for(var N,B=0;B<C.length;B++){if((N=_(C.charAt(B)))==="L")return!1;if(N==="R")return!0}return!1},I=function(C,N,B,E){var R,q,Z,U,X=N[E];switch(X){case"L":case"R":case"LRE":case"RLE":case"LRO":case"RLO":case"PDF":S=!1;break;case"N":case"AN":break;case"EN":S&&(X="AN");break;case"AL":S=!0,X="R";break;case"WS":case"BN":X="N";break;case"CS":E<1||E+1>=N.length||(R=B[E-1])!=="EN"&&R!=="AN"||(q=N[E+1])!=="EN"&&q!=="AN"?X="N":S&&(q="AN"),X=q===R?q:"N";break;case"ES":X=(R=E>0?B[E-1]:"B")==="EN"&&E+1<N.length&&N[E+1]==="EN"?"EN":"N";break;case"ET":if(E>0&&B[E-1]==="EN"){X="EN";break}if(S){X="N";break}for(Z=E+1,U=N.length;Z<U&&N[Z]==="ET";)Z++;X=Z<U&&N[Z]==="EN"?"EN":"N";break;case"NSM":if(a&&!o){for(U=N.length,Z=E+1;Z<U&&N[Z]==="NSM";)Z++;if(Z<U){var de=C[E],le=de>=1425&&de<=2303||de===64286;if(R=N[Z],le&&(R==="R"||R==="AL")){X="R";break}}}X=E<1||(R=N[E-1])==="B"?"N":B[E-1];break;case"B":S=!1,r=!0,X=A;break;case"S":s=!0,X="N"}return X},T=function(C,N,B){var E=C.split("");return B&&D(E,B,{hiLevel:A}),E.reverse(),N&&N.reverse(),E.join("")},D=function(C,N,B){var E,R,q,Z,U,X=-1,de=C.length,le=0,F=[],V=A?d:h,G=[];for(S=!1,r=!1,s=!1,R=0;R<de;R++)G[R]=_(C[R]);for(q=0;q<de;q++){if(U=le,F[q]=I(C,G,F,q),E=240&(le=V[U][y[F[q]]]),le&=15,N[q]=Z=V[le][5],E>0)if(E===16){for(R=X;R<q;R++)N[R]=1;X=-1}else X=-1;if(V[le][6])X===-1&&(X=q);else if(X>-1){for(R=X;R<q;R++)N[R]=Z;X=-1}G[q]==="B"&&(N[q]=0),B.hiLevel|=Z}s&&(function(se,ae,te){for(var ue=0;ue<te;ue++)if(se[ue]==="S"){ae[ue]=A;for(var pe=ue-1;pe>=0&&se[pe]==="WS";pe--)ae[pe]=A}})(G,N,de)},O=function(C,N,B,E,R){if(!(R.hiLevel<C)){if(C===1&&A===1&&!r)return N.reverse(),void(B&&B.reverse());for(var q,Z,U,X,de=N.length,le=0;le<de;){if(E[le]>=C){for(U=le+1;U<de&&E[U]>=C;)U++;for(X=le,Z=U-1;X<Z;X++,Z--)q=N[X],N[X]=N[Z],N[Z]=q,B&&(q=B[X],B[X]=B[Z],B[Z]=q);le=U}le++}}},W=function(C,N,B){var E=C.split(""),R={hiLevel:A};return B||(B=[]),D(E,B,R),(function(q,Z,U){if(U.hiLevel!==0&&u)for(var X,de=0;de<q.length;de++)Z[de]===1&&(X=x.indexOf(q[de]))>=0&&(q[de]=x[X+1])})(E,B,R),O(2,E,N,B,R),O(1,E,N,B,R),E.join("")};return this.__bidiEngine__.doBidiReorder=function(C,N,B){if((function(R,q){if(q)for(var Z=0;Z<R.length;Z++)q[Z]=Z;o===void 0&&(o=M(R)),c===void 0&&(c=M(R))})(C,N),a||!l||c)if(a&&l&&o^c)A=o?1:0,C=T(C,N,B);else if(!a&&l&&c)A=o?1:0,C=W(C,N,B),C=T(C,N);else if(!a||o||l||c){if(a&&!l&&o^c)C=T(C,N),o?(A=0,C=W(C,N,B)):(A=1,C=W(C,N,B),C=T(C,N));else if(a&&o&&!l&&c)A=1,C=W(C,N,B),C=T(C,N);else if(!a&&!l&&o^c){var E=u;o?(A=1,C=W(C,N,B),A=0,u=!1,C=W(C,N,B),u=E):(A=0,C=W(C,N,B),C=T(C,N),A=1,u=!1,C=W(C,N,B),u=E,C=T(C,N))}}else A=0,C=W(C,N,B);else A=o?1:0,C=W(C,N,B);return C},this.__bidiEngine__.setOptions=function(C){C&&(a=C.isInputVisual,l=C.isOutputVisual,o=C.isInputRtl,c=C.isOutputRtl,u=C.isSymmetricSwapping)},this.__bidiEngine__.setOptions(i),this.__bidiEngine__};var e=["BN","BN","BN","BN","BN","BN","BN","BN","BN","S","B","S","WS","B","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","B","B","B","S","WS","N","N","ET","ET","ET","N","N","N","N","N","ES","CS","ES","CS","CS","EN","EN","EN","EN","EN","EN","EN","EN","EN","EN","CS","N","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","N","BN","BN","BN","BN","BN","BN","B","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","CS","N","ET","ET","ET","ET","N","N","N","N","L","N","N","BN","N","N","ET","ET","EN","EN","N","L","N","N","N","EN","L","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","L","L","L","L","L","L","L","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","L","N","N","N","N","N","ET","N","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","R","NSM","R","NSM","NSM","R","NSM","NSM","R","NSM","N","N","N","N","N","N","N","N","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","N","N","N","N","N","R","R","R","R","R","N","N","N","N","N","N","N","N","N","N","N","AN","AN","AN","AN","AN","AN","N","N","AL","ET","ET","AL","CS","AL","N","N","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","AL","AL","N","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","AN","AN","AN","AN","AN","AN","AN","AN","AN","AN","ET","AN","AN","AL","AL","AL","NSM","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","NSM","NSM","NSM","NSM","NSM","NSM","NSM","AN","N","NSM","NSM","NSM","NSM","NSM","NSM","AL","AL","NSM","NSM","N","NSM","NSM","NSM","NSM","AL","AL","EN","EN","EN","EN","EN","EN","EN","EN","EN","EN","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","N","AL","AL","NSM","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","N","N","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","AL","N","N","N","N","N","N","N","N","N","N","N","N","N","N","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","R","R","N","N","N","N","R","N","N","N","N","N","WS","WS","WS","WS","WS","WS","WS","WS","WS","WS","WS","BN","BN","BN","L","R","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","WS","B","LRE","RLE","PDF","LRO","RLO","CS","ET","ET","ET","ET","ET","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","CS","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","WS","BN","BN","BN","BN","BN","N","LRI","RLI","FSI","PDI","BN","BN","BN","BN","BN","BN","EN","L","N","N","EN","EN","EN","EN","EN","EN","ES","ES","N","N","N","L","EN","EN","EN","EN","EN","EN","EN","EN","EN","EN","ES","ES","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","L","L","L","L","L","L","L","N","N","N","N","N","N","N","N","N","N","N","N","L","L","L","L","L","N","N","N","N","N","R","NSM","R","R","R","R","R","R","R","R","R","R","ES","R","R","R","R","R","R","R","R","R","R","R","R","R","N","R","R","R","R","R","N","R","N","R","R","N","R","R","N","R","R","R","R","R","R","R","R","R","R","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","CS","N","CS","N","N","CS","N","N","N","N","N","N","N","N","N","ET","N","N","ES","ES","N","N","N","N","N","ET","ET","N","N","N","N","N","AL","AL","AL","AL","AL","N","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","N","N","BN","N","N","N","ET","ET","ET","N","N","N","N","N","ES","CS","ES","CS","CS","EN","EN","EN","EN","EN","EN","EN","EN","EN","EN","CS","N","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","N","N","N","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","L","L","L","L","L","L","N","N","L","L","L","L","L","L","N","N","L","L","L","L","L","L","N","N","L","L","L","N","N","N","ET","ET","N","N","N","ET","ET","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N"],n=new t.__bidiEngine__({isInputVisual:!0});t.API.events.push(["postProcessText",function(i){var r=i.text;i.x,i.y;var s=i.options||{};i.mutex,s.lang;var a=[];if(s.isInputVisual=typeof s.isInputVisual!="boolean"||s.isInputVisual,n.setOptions(s),Object.prototype.toString.call(r)==="[object Array]"){var o=0;for(a=[],o=0;o<r.length;o+=1)Object.prototype.toString.call(r[o])==="[object Array]"?a.push([n.doBidiReorder(r[o][0]),r[o][1],r[o][2]]):a.push([n.doBidiReorder(r[o])]);i.text=a}else i.text=n.doBidiReorder(r);n.setOptions({isInputVisual:!0})}])})(qt),qt.API.TTFFont=(function(){function t(e){var n;if(this.rawData=e,n=this.contents=new Gl(e),this.contents.pos=4,n.readString(4)==="ttcf")throw new Error("TTCF not supported.");n.pos=0,this.parse(),this.subset=new IF(this),this.registerTTF()}return t.open=function(e){return new t(e)},t.prototype.parse=function(){return this.directory=new mF(this.contents),this.head=new yF(this),this.name=new SF(this),this.cmap=new Yx(this),this.toUnicode={},this.hhea=new bF(this),this.maxp=new kF(this),this.hmtx=new AF(this),this.post=new xF(this),this.os2=new wF(this),this.loca=new EF(this),this.glyf=new NF(this),this.ascender=this.os2.exists&&this.os2.ascender||this.hhea.ascender,this.decender=this.os2.exists&&this.os2.decender||this.hhea.decender,this.lineGap=this.os2.exists&&this.os2.lineGap||this.hhea.lineGap,this.bbox=[this.head.xMin,this.head.yMin,this.head.xMax,this.head.yMax]},t.prototype.registerTTF=function(){var e,n,i,r,s;if(this.scaleFactor=1e3/this.head.unitsPerEm,this.bbox=(function(){var a,o,l,c;for(c=[],a=0,o=(l=this.bbox).length;a<o;a++)e=l[a],c.push(Math.round(e*this.scaleFactor));return c}).call(this),this.stemV=0,this.post.exists?(i=255&(r=this.post.italic_angle),32768&(n=r>>16)&&(n=-(1+(65535^n))),this.italicAngle=+(n+"."+i)):this.italicAngle=0,this.ascender=Math.round(this.ascender*this.scaleFactor),this.decender=Math.round(this.decender*this.scaleFactor),this.lineGap=Math.round(this.lineGap*this.scaleFactor),this.capHeight=this.os2.exists&&this.os2.capHeight||this.ascender,this.xHeight=this.os2.exists&&this.os2.xHeight||0,this.familyClass=(this.os2.exists&&this.os2.familyClass||0)>>8,this.isSerif=(s=this.familyClass)===1||s===2||s===3||s===4||s===5||s===7,this.isScript=this.familyClass===10,this.flags=0,this.post.isFixedPitch&&(this.flags|=1),this.isSerif&&(this.flags|=2),this.isScript&&(this.flags|=8),this.italicAngle!==0&&(this.flags|=64),this.flags|=32,!this.cmap.unicode)throw new Error("No unicode cmap for font")},t.prototype.characterToGlyph=function(e){var n;return((n=this.cmap.unicode)!=null?n.codeMap[e]:void 0)||0},t.prototype.widthOfGlyph=function(e){var n;return n=1e3/this.head.unitsPerEm,this.hmtx.forGlyph(e).advance*n},t.prototype.widthOfString=function(e,n,i){var r,s,a,o;for(a=0,s=0,o=(e=""+e).length;0<=o?s<o:s>o;s=0<=o?++s:--s)r=e.charCodeAt(s),a+=this.widthOfGlyph(this.characterToGlyph(r))+i*(1e3/n)||0;return a*(n/1e3)},t.prototype.lineHeight=function(e,n){var i;return n==null&&(n=!1),i=n?this.lineGap:0,(this.ascender+i-this.decender)/1e3*e},t})();var Ma,Gl=(function(){function t(e){this.data=e??[],this.pos=0,this.length=this.data.length}return t.prototype.readByte=function(){return this.data[this.pos++]},t.prototype.writeByte=function(e){return this.data[this.pos++]=e},t.prototype.readUInt32=function(){return 16777216*this.readByte()+(this.readByte()<<16)+(this.readByte()<<8)+this.readByte()},t.prototype.writeUInt32=function(e){return this.writeByte(e>>>24&255),this.writeByte(e>>16&255),this.writeByte(e>>8&255),this.writeByte(255&e)},t.prototype.readInt32=function(){var e;return(e=this.readUInt32())>=2147483648?e-4294967296:e},t.prototype.writeInt32=function(e){return e<0&&(e+=4294967296),this.writeUInt32(e)},t.prototype.readUInt16=function(){return this.readByte()<<8|this.readByte()},t.prototype.writeUInt16=function(e){return this.writeByte(e>>8&255),this.writeByte(255&e)},t.prototype.readInt16=function(){var e;return(e=this.readUInt16())>=32768?e-65536:e},t.prototype.writeInt16=function(e){return e<0&&(e+=65536),this.writeUInt16(e)},t.prototype.readString=function(e){var n,i;for(i=[],n=0;0<=e?n<e:n>e;n=0<=e?++n:--n)i[n]=String.fromCharCode(this.readByte());return i.join("")},t.prototype.writeString=function(e){var n,i,r;for(r=[],n=0,i=e.length;0<=i?n<i:n>i;n=0<=i?++n:--n)r.push(this.writeByte(e.charCodeAt(n)));return r},t.prototype.readShort=function(){return this.readInt16()},t.prototype.writeShort=function(e){return this.writeInt16(e)},t.prototype.readLongLong=function(){var e,n,i,r,s,a,o,l;return e=this.readByte(),n=this.readByte(),i=this.readByte(),r=this.readByte(),s=this.readByte(),a=this.readByte(),o=this.readByte(),l=this.readByte(),128&e?-1*(72057594037927940*(255^e)+281474976710656*(255^n)+1099511627776*(255^i)+4294967296*(255^r)+16777216*(255^s)+65536*(255^a)+256*(255^o)+(255^l)+1):72057594037927940*e+281474976710656*n+1099511627776*i+4294967296*r+16777216*s+65536*a+256*o+l},t.prototype.writeLongLong=function(e){var n,i;return n=Math.floor(e/4294967296),i=4294967295&e,this.writeByte(n>>24&255),this.writeByte(n>>16&255),this.writeByte(n>>8&255),this.writeByte(255&n),this.writeByte(i>>24&255),this.writeByte(i>>16&255),this.writeByte(i>>8&255),this.writeByte(255&i)},t.prototype.readInt=function(){return this.readInt32()},t.prototype.writeInt=function(e){return this.writeInt32(e)},t.prototype.read=function(e){var n,i;for(n=[],i=0;0<=e?i<e:i>e;i=0<=e?++i:--i)n.push(this.readByte());return n},t.prototype.write=function(e){var n,i,r,s;for(s=[],i=0,r=e.length;i<r;i++)n=e[i],s.push(this.writeByte(n));return s},t})(),mF=(function(){var t;function e(n){var i,r,s;for(this.scalarType=n.readInt(),this.tableCount=n.readShort(),this.searchRange=n.readShort(),this.entrySelector=n.readShort(),this.rangeShift=n.readShort(),this.tables={},r=0,s=this.tableCount;0<=s?r<s:r>s;r=0<=s?++r:--r)i={tag:n.readString(4),checksum:n.readInt(),offset:n.readInt(),length:n.readInt()},this.tables[i.tag]=i}return e.prototype.encode=function(n){var i,r,s,a,o,l,c,u,f,h,d,y,m;for(m in d=Object.keys(n).length,l=Math.log(2),f=16*Math.floor(Math.log(d)/l),a=Math.floor(f/l),u=16*d-f,(r=new Gl).writeInt(this.scalarType),r.writeShort(d),r.writeShort(f),r.writeShort(a),r.writeShort(u),s=16*d,c=r.pos+s,o=null,y=[],n)for(h=n[m],r.writeString(m),r.writeInt(t(h)),r.writeInt(c),r.writeInt(h.length),y=y.concat(h),m==="head"&&(o=c),c+=h.length;c%4;)y.push(0),c++;return r.write(y),i=2981146554-t(r.data),r.pos=o+8,r.writeUInt32(i),r.data},t=function(n){var i,r,s,a;for(n=Kx.call(n);n.length%4;)n.push(0);for(s=new Gl(n),r=0,i=0,a=n.length;i<a;i=i+=4)r+=s.readUInt32();return 4294967295&r},e})(),vF={}.hasOwnProperty,po=function(t,e){for(var n in e)vF.call(e,n)&&(t[n]=e[n]);function i(){this.constructor=t}return i.prototype=e.prototype,t.prototype=new i,t.__super__=e.prototype,t};Ma=(function(){function t(e){var n;this.file=e,n=this.file.directory.tables[this.tag],this.exists=!!n,n&&(this.offset=n.offset,this.length=n.length,this.parse(this.file.contents))}return t.prototype.parse=function(){},t.prototype.encode=function(){},t.prototype.raw=function(){return this.exists?(this.file.contents.pos=this.offset,this.file.contents.read(this.length)):null},t})();var yF=(function(){function t(){return t.__super__.constructor.apply(this,arguments)}return po(t,Ma),t.prototype.tag="head",t.prototype.parse=function(e){return e.pos=this.offset,this.version=e.readInt(),this.revision=e.readInt(),this.checkSumAdjustment=e.readInt(),this.magicNumber=e.readInt(),this.flags=e.readShort(),this.unitsPerEm=e.readShort(),this.created=e.readLongLong(),this.modified=e.readLongLong(),this.xMin=e.readShort(),this.yMin=e.readShort(),this.xMax=e.readShort(),this.yMax=e.readShort(),this.macStyle=e.readShort(),this.lowestRecPPEM=e.readShort(),this.fontDirectionHint=e.readShort(),this.indexToLocFormat=e.readShort(),this.glyphDataFormat=e.readShort()},t.prototype.encode=function(e){var n;return(n=new Gl).writeInt(this.version),n.writeInt(this.revision),n.writeInt(this.checkSumAdjustment),n.writeInt(this.magicNumber),n.writeShort(this.flags),n.writeShort(this.unitsPerEm),n.writeLongLong(this.created),n.writeLongLong(this.modified),n.writeShort(this.xMin),n.writeShort(this.yMin),n.writeShort(this.xMax),n.writeShort(this.yMax),n.writeShort(this.macStyle),n.writeShort(this.lowestRecPPEM),n.writeShort(this.fontDirectionHint),n.writeShort(e),n.writeShort(this.glyphDataFormat),n.data},t})(),Cy=(function(){function t(e,n){var i,r,s,a,o,l,c,u,f,h,d,y,m,x,w,S,A;switch(this.platformID=e.readUInt16(),this.encodingID=e.readShort(),this.offset=n+e.readInt(),f=e.pos,e.pos=this.offset,this.format=e.readUInt16(),this.length=e.readUInt16(),this.language=e.readUInt16(),this.isUnicode=this.platformID===3&&this.encodingID===1&&this.format===4||this.platformID===0&&this.format===4,this.codeMap={},this.format){case 0:for(l=0;l<256;++l)this.codeMap[l]=e.readByte();break;case 4:for(d=e.readUInt16(),h=d/2,e.pos+=6,s=(function(){var _,M;for(M=[],l=_=0;0<=h?_<h:_>h;l=0<=h?++_:--_)M.push(e.readUInt16());return M})(),e.pos+=2,m=(function(){var _,M;for(M=[],l=_=0;0<=h?_<h:_>h;l=0<=h?++_:--_)M.push(e.readUInt16());return M})(),c=(function(){var _,M;for(M=[],l=_=0;0<=h?_<h:_>h;l=0<=h?++_:--_)M.push(e.readUInt16());return M})(),u=(function(){var _,M;for(M=[],l=_=0;0<=h?_<h:_>h;l=0<=h?++_:--_)M.push(e.readUInt16());return M})(),r=(this.length-e.pos+this.offset)/2,o=(function(){var _,M;for(M=[],l=_=0;0<=r?_<r:_>r;l=0<=r?++_:--_)M.push(e.readUInt16());return M})(),l=w=0,A=s.length;w<A;l=++w)for(x=s[l],i=S=y=m[l];y<=x?S<=x:S>=x;i=y<=x?++S:--S)u[l]===0?a=i+c[l]:(a=o[u[l]/2+(i-y)-(h-l)]||0)!==0&&(a+=c[l]),this.codeMap[i]=65535&a}e.pos=f}return t.encode=function(e,n){var i,r,s,a,o,l,c,u,f,h,d,y,m,x,w,S,A,_,M,I,T,D,O,W,C,N,B,E,R,q,Z,U,X,de,le,F,V,G,se,ae,te,ue,pe,ge,me,Pe;switch(E=new Gl,a=Object.keys(e).sort(function(ke,Ge){return ke-Ge}),n){case"macroman":for(m=0,x=(function(){var ke=[];for(y=0;y<256;++y)ke.push(0);return ke})(),S={0:0},s={},R=0,X=a.length;R<X;R++)S[pe=e[r=a[R]]]==null&&(S[pe]=++m),s[r]={old:e[r],new:S[e[r]]},x[r]=S[e[r]];return E.writeUInt16(1),E.writeUInt16(0),E.writeUInt32(12),E.writeUInt16(0),E.writeUInt16(262),E.writeUInt16(0),E.write(x),{charMap:s,subtable:E.data,maxGlyphID:m+1};case"unicode":for(N=[],f=[],A=0,S={},i={},w=c=null,q=0,de=a.length;q<de;q++)S[M=e[r=a[q]]]==null&&(S[M]=++A),i[r]={old:M,new:S[M]},o=S[M]-r,w!=null&&o===c||(w&&f.push(w),N.push(r),c=o),w=r;for(w&&f.push(w),f.push(65535),N.push(65535),W=2*(O=N.length),D=2*Math.pow(Math.log(O)/Math.LN2,2),h=Math.log(D/2)/Math.LN2,T=2*O-D,l=[],I=[],d=[],y=Z=0,le=N.length;Z<le;y=++Z){if(C=N[y],u=f[y],C===65535){l.push(0),I.push(0);break}if(C-(B=i[C].new)>=32768)for(l.push(0),I.push(2*(d.length+O-y)),r=U=C;C<=u?U<=u:U>=u;r=C<=u?++U:--U)d.push(i[r].new);else l.push(B-C),I.push(0)}for(E.writeUInt16(3),E.writeUInt16(1),E.writeUInt32(12),E.writeUInt16(4),E.writeUInt16(16+8*O+2*d.length),E.writeUInt16(0),E.writeUInt16(W),E.writeUInt16(D),E.writeUInt16(h),E.writeUInt16(T),te=0,F=f.length;te<F;te++)r=f[te],E.writeUInt16(r);for(E.writeUInt16(0),ue=0,V=N.length;ue<V;ue++)r=N[ue],E.writeUInt16(r);for(ge=0,G=l.length;ge<G;ge++)o=l[ge],E.writeUInt16(o);for(me=0,se=I.length;me<se;me++)_=I[me],E.writeUInt16(_);for(Pe=0,ae=d.length;Pe<ae;Pe++)m=d[Pe],E.writeUInt16(m);return{charMap:i,subtable:E.data,maxGlyphID:A+1}}},t})(),Yx=(function(){function t(){return t.__super__.constructor.apply(this,arguments)}return po(t,Ma),t.prototype.tag="cmap",t.prototype.parse=function(e){var n,i,r;for(e.pos=this.offset,this.version=e.readUInt16(),r=e.readUInt16(),this.tables=[],this.unicode=null,i=0;0<=r?i<r:i>r;i=0<=r?++i:--i)n=new Cy(e,this.offset),this.tables.push(n),n.isUnicode&&this.unicode==null&&(this.unicode=n);return!0},t.encode=function(e,n){var i,r;return n==null&&(n="macroman"),i=Cy.encode(e,n),(r=new Gl).writeUInt16(0),r.writeUInt16(1),i.table=r.data.concat(i.subtable),i},t})(),bF=(function(){function t(){return t.__super__.constructor.apply(this,arguments)}return po(t,Ma),t.prototype.tag="hhea",t.prototype.parse=function(e){return e.pos=this.offset,this.version=e.readInt(),this.ascender=e.readShort(),this.decender=e.readShort(),this.lineGap=e.readShort(),this.advanceWidthMax=e.readShort(),this.minLeftSideBearing=e.readShort(),this.minRightSideBearing=e.readShort(),this.xMaxExtent=e.readShort(),this.caretSlopeRise=e.readShort(),this.caretSlopeRun=e.readShort(),this.caretOffset=e.readShort(),e.pos+=8,this.metricDataFormat=e.readShort(),this.numberOfMetrics=e.readUInt16()},t})(),wF=(function(){function t(){return t.__super__.constructor.apply(this,arguments)}return po(t,Ma),t.prototype.tag="OS/2",t.prototype.parse=function(e){if(e.pos=this.offset,this.version=e.readUInt16(),this.averageCharWidth=e.readShort(),this.weightClass=e.readUInt16(),this.widthClass=e.readUInt16(),this.type=e.readShort(),this.ySubscriptXSize=e.readShort(),this.ySubscriptYSize=e.readShort(),this.ySubscriptXOffset=e.readShort(),this.ySubscriptYOffset=e.readShort(),this.ySuperscriptXSize=e.readShort(),this.ySuperscriptYSize=e.readShort(),this.ySuperscriptXOffset=e.readShort(),this.ySuperscriptYOffset=e.readShort(),this.yStrikeoutSize=e.readShort(),this.yStrikeoutPosition=e.readShort(),this.familyClass=e.readShort(),this.panose=(function(){var n,i;for(i=[],n=0;n<10;++n)i.push(e.readByte());return i})(),this.charRange=(function(){var n,i;for(i=[],n=0;n<4;++n)i.push(e.readInt());return i})(),this.vendorID=e.readString(4),this.selection=e.readShort(),this.firstCharIndex=e.readShort(),this.lastCharIndex=e.readShort(),this.version>0&&(this.ascent=e.readShort(),this.descent=e.readShort(),this.lineGap=e.readShort(),this.winAscent=e.readShort(),this.winDescent=e.readShort(),this.codePageRange=(function(){var n,i;for(i=[],n=0;n<2;n=++n)i.push(e.readInt());return i})(),this.version>1))return this.xHeight=e.readShort(),this.capHeight=e.readShort(),this.defaultChar=e.readShort(),this.breakChar=e.readShort(),this.maxContext=e.readShort()},t})(),xF=(function(){function t(){return t.__super__.constructor.apply(this,arguments)}return po(t,Ma),t.prototype.tag="post",t.prototype.parse=function(e){var n,i,r;switch(e.pos=this.offset,this.format=e.readInt(),this.italicAngle=e.readInt(),this.underlinePosition=e.readShort(),this.underlineThickness=e.readShort(),this.isFixedPitch=e.readInt(),this.minMemType42=e.readInt(),this.maxMemType42=e.readInt(),this.minMemType1=e.readInt(),this.maxMemType1=e.readInt(),this.format){case 65536:case 196608:break;case 131072:var s;for(i=e.readUInt16(),this.glyphNameIndex=[],s=0;0<=i?s<i:s>i;s=0<=i?++s:--s)this.glyphNameIndex.push(e.readUInt16());for(this.names=[],r=[];e.pos<this.offset+this.length;)n=e.readByte(),r.push(this.names.push(e.readString(n)));return r;case 151552:return i=e.readUInt16(),this.offsets=e.read(i);case 262144:return this.map=(function(){var a,o,l;for(l=[],s=a=0,o=this.file.maxp.numGlyphs;0<=o?a<o:a>o;s=0<=o?++a:--a)l.push(e.readUInt32());return l}).call(this)}},t})(),_F=function(t,e){this.raw=t,this.length=t.length,this.platformID=e.platformID,this.encodingID=e.encodingID,this.languageID=e.languageID},SF=(function(){function t(){return t.__super__.constructor.apply(this,arguments)}return po(t,Ma),t.prototype.tag="name",t.prototype.parse=function(e){var n,i,r,s,a,o,l,c,u,f,h;for(e.pos=this.offset,e.readShort(),n=e.readShort(),o=e.readShort(),i=[],s=0;0<=n?s<n:s>n;s=0<=n?++s:--s)i.push({platformID:e.readShort(),encodingID:e.readShort(),languageID:e.readShort(),nameID:e.readShort(),length:e.readShort(),offset:this.offset+o+e.readShort()});for(l={},s=u=0,f=i.length;u<f;s=++u)r=i[s],e.pos=r.offset,c=e.readString(r.length),a=new _F(c,r),l[h=r.nameID]==null&&(l[h]=[]),l[r.nameID].push(a);this.strings=l,this.copyright=l[0],this.fontFamily=l[1],this.fontSubfamily=l[2],this.uniqueSubfamily=l[3],this.fontName=l[4],this.version=l[5];try{this.postscriptName=l[6][0].raw.replace(/[\x00-\x19\x80-\xff]/g,"")}catch{this.postscriptName=l[4][0].raw.replace(/[\x00-\x19\x80-\xff]/g,"")}return this.trademark=l[7],this.manufacturer=l[8],this.designer=l[9],this.description=l[10],this.vendorUrl=l[11],this.designerUrl=l[12],this.license=l[13],this.licenseUrl=l[14],this.preferredFamily=l[15],this.preferredSubfamily=l[17],this.compatibleFull=l[18],this.sampleText=l[19]},t})(),kF=(function(){function t(){return t.__super__.constructor.apply(this,arguments)}return po(t,Ma),t.prototype.tag="maxp",t.prototype.parse=function(e){return e.pos=this.offset,this.version=e.readInt(),this.numGlyphs=e.readUInt16(),this.maxPoints=e.readUInt16(),this.maxContours=e.readUInt16(),this.maxCompositePoints=e.readUInt16(),this.maxComponentContours=e.readUInt16(),this.maxZones=e.readUInt16(),this.maxTwilightPoints=e.readUInt16(),this.maxStorage=e.readUInt16(),this.maxFunctionDefs=e.readUInt16(),this.maxInstructionDefs=e.readUInt16(),this.maxStackElements=e.readUInt16(),this.maxSizeOfInstructions=e.readUInt16(),this.maxComponentElements=e.readUInt16(),this.maxComponentDepth=e.readUInt16()},t})(),AF=(function(){function t(){return t.__super__.constructor.apply(this,arguments)}return po(t,Ma),t.prototype.tag="hmtx",t.prototype.parse=function(e){var n,i,r,s,a,o,l;for(e.pos=this.offset,this.metrics=[],n=0,o=this.file.hhea.numberOfMetrics;0<=o?n<o:n>o;n=0<=o?++n:--n)this.metrics.push({advance:e.readUInt16(),lsb:e.readInt16()});for(r=this.file.maxp.numGlyphs-this.file.hhea.numberOfMetrics,this.leftSideBearings=(function(){var c,u;for(u=[],n=c=0;0<=r?c<r:c>r;n=0<=r?++c:--c)u.push(e.readInt16());return u})(),this.widths=(function(){var c,u,f,h;for(h=[],c=0,u=(f=this.metrics).length;c<u;c++)s=f[c],h.push(s.advance);return h}).call(this),i=this.widths[this.widths.length-1],l=[],n=a=0;0<=r?a<r:a>r;n=0<=r?++a:--a)l.push(this.widths.push(i));return l},t.prototype.forGlyph=function(e){return e in this.metrics?this.metrics[e]:{advance:this.metrics[this.metrics.length-1].advance,lsb:this.leftSideBearings[e-this.metrics.length]}},t})(),Kx=[].slice,NF=(function(){function t(){return t.__super__.constructor.apply(this,arguments)}return po(t,Ma),t.prototype.tag="glyf",t.prototype.parse=function(){return this.cache={}},t.prototype.glyphFor=function(e){var n,i,r,s,a,o,l,c,u,f;return e in this.cache?this.cache[e]:(s=this.file.loca,n=this.file.contents,i=s.indexOf(e),(r=s.lengthOf(e))===0?this.cache[e]=null:(n.pos=this.offset+i,a=(o=new Gl(n.read(r))).readShort(),c=o.readShort(),f=o.readShort(),l=o.readShort(),u=o.readShort(),this.cache[e]=a===-1?new PF(o,c,f,l,u):new CF(o,a,c,f,l,u),this.cache[e]))},t.prototype.encode=function(e,n,i){var r,s,a,o,l;for(a=[],s=[],o=0,l=n.length;o<l;o++)r=e[n[o]],s.push(a.length),r&&(a=a.concat(r.encode(i)));return s.push(a.length),{table:a,offsets:s}},t})(),CF=(function(){function t(e,n,i,r,s,a){this.raw=e,this.numberOfContours=n,this.xMin=i,this.yMin=r,this.xMax=s,this.yMax=a,this.compound=!1}return t.prototype.encode=function(){return this.raw.data},t})(),PF=(function(){function t(e,n,i,r,s){var a,o;for(this.raw=e,this.xMin=n,this.yMin=i,this.xMax=r,this.yMax=s,this.compound=!0,this.glyphIDs=[],this.glyphOffsets=[],a=this.raw;o=a.readShort(),this.glyphOffsets.push(a.pos),this.glyphIDs.push(a.readUInt16()),32&o;)a.pos+=1&o?4:2,128&o?a.pos+=8:64&o?a.pos+=4:8&o&&(a.pos+=2)}return t.prototype.encode=function(){var e,n,i;for(n=new Gl(Kx.call(this.raw.data)),e=0,i=this.glyphIDs.length;e<i;++e)n.pos=this.glyphOffsets[e];return n.data},t})(),EF=(function(){function t(){return t.__super__.constructor.apply(this,arguments)}return po(t,Ma),t.prototype.tag="loca",t.prototype.parse=function(e){var n,i;return e.pos=this.offset,n=this.file.head.indexToLocFormat,this.offsets=n===0?(function(){var r,s;for(s=[],i=0,r=this.length;i<r;i+=2)s.push(2*e.readUInt16());return s}).call(this):(function(){var r,s;for(s=[],i=0,r=this.length;i<r;i+=4)s.push(e.readUInt32());return s}).call(this)},t.prototype.indexOf=function(e){return this.offsets[e]},t.prototype.lengthOf=function(e){return this.offsets[e+1]-this.offsets[e]},t.prototype.encode=function(e,n){for(var i=new Uint32Array(this.offsets.length),r=0,s=0,a=0;a<i.length;++a)if(i[a]=r,s<n.length&&n[s]==a){++s,i[a]=r;var o=this.offsets[a],l=this.offsets[a+1]-o;l>0&&(r+=l)}for(var c=new Array(4*i.length),u=0;u<i.length;++u)c[4*u+3]=255&i[u],c[4*u+2]=(65280&i[u])>>8,c[4*u+1]=(16711680&i[u])>>16,c[4*u]=(4278190080&i[u])>>24;return c},t})(),IF=(function(){function t(e){this.font=e,this.subset={},this.unicodes={},this.next=33}return t.prototype.generateCmap=function(){var e,n,i,r,s;for(n in r=this.font.cmap.tables[0].codeMap,e={},s=this.subset)i=s[n],e[n]=r[i];return e},t.prototype.glyphsFor=function(e){var n,i,r,s,a,o,l;for(r={},a=0,o=e.length;a<o;a++)r[s=e[a]]=this.font.glyf.glyphFor(s);for(s in n=[],r)(i=r[s])!=null&&i.compound&&n.push.apply(n,i.glyphIDs);if(n.length>0)for(s in l=this.glyphsFor(n))i=l[s],r[s]=i;return r},t.prototype.encode=function(e,n){var i,r,s,a,o,l,c,u,f,h,d,y,m,x,w;for(r in i=Yx.encode(this.generateCmap(),"unicode"),a=this.glyphsFor(e),d={0:0},w=i.charMap)d[(l=w[r]).old]=l.new;for(y in h=i.maxGlyphID,a)y in d||(d[y]=h++);return u=(function(S){var A,_;for(A in _={},S)_[S[A]]=A;return _})(d),f=Object.keys(u).sort(function(S,A){return S-A}),m=(function(){var S,A,_;for(_=[],S=0,A=f.length;S<A;S++)o=f[S],_.push(u[o]);return _})(),s=this.font.glyf.encode(a,m,d),c=this.font.loca.encode(s.offsets,m),x={cmap:this.font.cmap.raw(),glyf:s.table,loca:c,hmtx:this.font.hmtx.raw(),hhea:this.font.hhea.raw(),maxp:this.font.maxp.raw(),post:this.font.post.raw(),name:this.font.name.raw(),head:this.font.head.encode(n)},this.font.os2.exists&&(x["OS/2"]=this.font.os2.raw()),this.font.directory.encode(x)},t})();qt.API.PDFObject=(function(){var t;function e(){}return t=function(n,i){return(Array(i+1).join("0")+n).slice(-i)},e.convert=function(n){var i,r,s,a;if(Array.isArray(n))return"["+(function(){var o,l,c;for(c=[],o=0,l=n.length;o<l;o++)i=n[o],c.push(e.convert(i));return c})().join(" ")+"]";if(typeof n=="string")return"/"+n;if(n?.isString)return"("+n+")";if(n instanceof Date)return"(D:"+t(n.getUTCFullYear(),4)+t(n.getUTCMonth(),2)+t(n.getUTCDate(),2)+t(n.getUTCHours(),2)+t(n.getUTCMinutes(),2)+t(n.getUTCSeconds(),2)+"Z)";if({}.toString.call(n)==="[object Object]"){for(r in s=["<<"],n)a=n[r],s.push("/"+r+" "+e.convert(a));return s.push(">>"),s.join(`
`)}return""+n},e})();var Bz=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function u0(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}var Vg,Py;function LF(){if(Py)return Vg;Py=1;var t={},e=t.hasOwnProperty,n=function(l,c){if(!l)return c;var u={};for(var f in c)u[f]=e.call(l,f)?l[f]:c[f];return u},i=/[ -,\.\/:-@\[-\^`\{-~]/,r=/[ -,\.\/:-@\[\]\^`\{-~]/,s=/(^|\\+)?(\\[A-F0-9]{1,6})\x20(?![a-fA-F0-9\x20])/g,a=function o(l,c){c=n(c,o.options),c.quotes!="single"&&c.quotes!="double"&&(c.quotes="single");for(var u=c.quotes=="double"?'"':"'",f=c.isIdentifier,h=l.charAt(0),d="",y=0,m=l.length;y<m;){var x=l.charAt(y++),w=x.charCodeAt(),S=void 0;if(w<32||w>126){if(w>=55296&&w<=56319&&y<m){var A=l.charCodeAt(y++);(A&64512)==56320?w=((w&1023)<<10)+(A&1023)+65536:y--}S="\\"+w.toString(16).toUpperCase()+" "}else c.escapeEverything?i.test(x)?S="\\"+x:S="\\"+w.toString(16).toUpperCase()+" ":/[\t\n\f\r\x0B]/.test(x)?S="\\"+w.toString(16).toUpperCase()+" ":x=="\\"||!f&&(x=='"'&&u==x||x=="'"&&u==x)||f&&r.test(x)?S="\\"+x:S=x;d+=S}return f&&(/^-[-\d]/.test(d)?d="\\-"+d.slice(1):/\d/.test(h)&&(d="\\3"+h+" "+d.slice(1))),d=d.replace(s,function(_,M,I){return M&&M.length%2?_:(M||"")+I}),!f&&c.wrap?u+d+u:d};return a.options={escapeEverything:!1,isIdentifier:!1,quotes:"single",wrap:!1},a.version="3.0.0",Vg=a,Vg}var MF=LF();const Zx=u0(MF);var Gg,Ey;function TF(){if(Ey)return Gg;Ey=1;var t=0,e=1,n=2,i=3,r=4,s=5,a=6,o=/[a-z0-9_-]/i,l=/[\s\t]/,c=function(h){for(var d=!0,y=t,m="",x=0,w,S,A=[];;){if(S=h[x],y===t){if(!S&&d)break;if(!S&&!d)throw new Error("Parse error");if(S==='"'||S==="'")w=S,y=e,d=!1;else if(!l.test(S))if(o.test(S))y=i,d=!1,x--;else throw new Error("Parse error")}else if(y===e)if(S)S==="\\"?y=n:S===w?(A.push(m),m="",y=r):m+=S;else throw new Error("Parse Error");else if(y===n)if(S===w||S==="\\")m+=S,y=e;else throw new Error("Parse error");else if(y===i)if(S)o.test(S)?m+=S:S===","?(A.push(m),m="",y=t):l.test(S)?y=s:S==="\\"&&(y=a);else{A.push(m);break}else if(y===a){if(/[0-9a-f]/i.test(S))throw new Error("Parse error");m+=S,y=i}else if(y===s)if(S){if(o.test(S))m+=" "+S,y=i;else if(S===",")A.push(m),m="",y=t;else if(!l.test(S))throw new Error("Parse error")}else{A.push(m);break}else if(y===r)if(S){if(S===",")y=t;else if(!l.test(S))throw new Error("Parse error")}else break;x++}return A},u=/[^a-z0-9_-]/i,f=function(h,d){var y=d&&d.quote||'"';if(y!=='"'&&y!=="'")throw new Error("Quote must be `'` or `\"`");for(var m=new RegExp(y,"g"),x=[],w=0;w<h.length;++w){var S=h[w];u.test(S)&&(S=S.replace(/\\/g,"\\\\").replace(m,"\\"+y),S=y+S+y),x.push(S)}return x.join(", ")};return Gg={parse:c,stringify:f},Gg}var DF=TF();const OF=u0(DF);var Xg,Iy;function FF(){if(Iy)return Xg;Iy=1;var t={a:7,c:6,h:1,l:2,m:2,r:4,q:4,s:4,t:2,v:1,z:0},e=[5760,6158,8192,8193,8194,8195,8196,8197,8198,8199,8200,8201,8202,8239,8287,12288,65279];function n(d){return d===10||d===13||d===8232||d===8233||d===32||d===9||d===11||d===12||d===160||d>=5760&&e.indexOf(d)>=0}function i(d){switch(d|32){case 109:case 122:case 108:case 104:case 118:case 99:case 115:case 113:case 116:case 97:case 114:return!0}return!1}function r(d){return(d|32)===97}function s(d){return d>=48&&d<=57}function a(d){return d>=48&&d<=57||d===43||d===45||d===46}function o(d){this.index=0,this.path=d,this.max=d.length,this.result=[],this.param=0,this.err="",this.segmentStart=0,this.data=[]}function l(d){for(;d.index<d.max&&n(d.path.charCodeAt(d.index));)d.index++}function c(d){var y=d.path.charCodeAt(d.index);if(y===48){d.param=0,d.index++;return}if(y===49){d.param=1,d.index++;return}d.err="SvgPath: arc flag can be 0 or 1 only (at pos "+d.index+")"}function u(d){var y=d.index,m=y,x=d.max,w=!1,S=!1,A=!1,_=!1,M;if(m>=x){d.err="SvgPath: missed param (at pos "+m+")";return}if(M=d.path.charCodeAt(m),(M===43||M===45)&&(m++,M=m<x?d.path.charCodeAt(m):0),!s(M)&&M!==46){d.err="SvgPath: param should start with 0..9 or `.` (at pos "+m+")";return}if(M!==46){if(w=M===48,m++,M=m<x?d.path.charCodeAt(m):0,w&&m<x&&M&&s(M)){d.err="SvgPath: numbers started with `0` such as `09` are illegal (at pos "+y+")";return}for(;m<x&&s(d.path.charCodeAt(m));)m++,S=!0;M=m<x?d.path.charCodeAt(m):0}if(M===46){for(_=!0,m++;s(d.path.charCodeAt(m));)m++,A=!0;M=m<x?d.path.charCodeAt(m):0}if(M===101||M===69){if(_&&!S&&!A){d.err="SvgPath: invalid float exponent (at pos "+m+")";return}if(m++,M=m<x?d.path.charCodeAt(m):0,(M===43||M===45)&&m++,m<x&&s(d.path.charCodeAt(m)))for(;m<x&&s(d.path.charCodeAt(m));)m++;else{d.err="SvgPath: invalid float exponent (at pos "+m+")";return}}d.index=m,d.param=parseFloat(d.path.slice(y,m))+0}function f(d){var y,m;y=d.path[d.segmentStart],m=y.toLowerCase();var x=d.data;if(m==="m"&&x.length>2&&(d.result.push([y,x[0],x[1]]),x=x.slice(2),m="l",y=y==="m"?"l":"L"),m==="r")d.result.push([y].concat(x));else for(;x.length>=t[m]&&(d.result.push([y].concat(x.splice(0,t[m]))),!!t[m]););}function h(d){var y=d.max,m,x,w,S,A;if(d.segmentStart=d.index,m=d.path.charCodeAt(d.index),x=r(m),!i(m)){d.err="SvgPath: bad command "+d.path[d.index]+" (at pos "+d.index+")";return}if(S=t[d.path[d.index].toLowerCase()],d.index++,l(d),d.data=[],!S){f(d);return}for(w=!1;;){for(A=S;A>0;A--){if(x&&(A===3||A===4)?c(d):u(d),d.err.length){f(d);return}d.data.push(d.param),l(d),w=!1,d.index<y&&d.path.charCodeAt(d.index)===44&&(d.index++,l(d),w=!0)}if(!w&&(d.index>=d.max||!a(d.path.charCodeAt(d.index))))break}f(d)}return Xg=function(y){var m=new o(y),x=m.max;for(l(m);m.index<x&&!m.err.length;)h(m);return m.result.length&&("mM".indexOf(m.result[0][0])<0?(m.err="SvgPath: string should start with `M` or `m`",m.result=[]):m.result[0][0]="M"),{err:m.err,segments:m.result}},Xg}var Yg,Ly;function Jx(){if(Ly)return Yg;Ly=1;function t(n,i){return[n[0]*i[0]+n[2]*i[1],n[1]*i[0]+n[3]*i[1],n[0]*i[2]+n[2]*i[3],n[1]*i[2]+n[3]*i[3],n[0]*i[4]+n[2]*i[5]+n[4],n[1]*i[4]+n[3]*i[5]+n[5]]}function e(){if(!(this instanceof e))return new e;this.queue=[],this.cache=null}return e.prototype.matrix=function(n){return n[0]===1&&n[1]===0&&n[2]===0&&n[3]===1&&n[4]===0&&n[5]===0?this:(this.cache=null,this.queue.push(n),this)},e.prototype.translate=function(n,i){return(n!==0||i!==0)&&(this.cache=null,this.queue.push([1,0,0,1,n,i])),this},e.prototype.scale=function(n,i){return(n!==1||i!==1)&&(this.cache=null,this.queue.push([n,0,0,i,0,0])),this},e.prototype.rotate=function(n,i,r){var s,a,o;return n!==0&&(this.translate(i,r),s=n*Math.PI/180,a=Math.cos(s),o=Math.sin(s),this.queue.push([a,o,-o,a,0,0]),this.cache=null,this.translate(-i,-r)),this},e.prototype.skewX=function(n){return n!==0&&(this.cache=null,this.queue.push([1,0,Math.tan(n*Math.PI/180),1,0,0])),this},e.prototype.skewY=function(n){return n!==0&&(this.cache=null,this.queue.push([1,Math.tan(n*Math.PI/180),0,1,0,0])),this},e.prototype.toArray=function(){if(this.cache)return this.cache;if(!this.queue.length)return this.cache=[1,0,0,1,0,0],this.cache;if(this.cache=this.queue[0],this.queue.length===1)return this.cache;for(var n=1;n<this.queue.length;n++)this.cache=t(this.cache,this.queue[n]);return this.cache},e.prototype.calc=function(n,i,r){var s;return this.queue.length?(this.cache||(this.cache=this.toArray()),s=this.cache,[n*s[0]+i*s[2]+(r?0:s[4]),n*s[1]+i*s[3]+(r?0:s[5])]):[n,i]},Yg=e,Yg}var Kg,My;function RF(){if(My)return Kg;My=1;var t=Jx(),e={matrix:!0,scale:!0,rotate:!0,translate:!0,skewX:!0,skewY:!0},n=/\s*(matrix|translate|scale|rotate|skewX|skewY)\s*\(\s*(.+?)\s*\)[\s,]*/,i=/[\s,]+/;return Kg=function(s){var a=new t,o,l;return s.split(n).forEach(function(c){if(c.length){if(typeof e[c]<"u"){o=c;return}switch(l=c.split(i).map(function(u){return+u||0}),o){case"matrix":l.length===6&&a.matrix(l);return;case"scale":l.length===1?a.scale(l[0],l[0]):l.length===2&&a.scale(l[0],l[1]);return;case"rotate":l.length===1?a.rotate(l[0],0,0):l.length===3&&a.rotate(l[0],l[1],l[2]);return;case"translate":l.length===1?a.translate(l[0],0):l.length===2&&a.translate(l[0],l[1]);return;case"skewX":l.length===1&&a.skewX(l[0]);return;case"skewY":l.length===1&&a.skewY(l[0]);return}}}),a},Kg}var Zg,Ty;function BF(){if(Ty)return Zg;Ty=1;var t=Math.PI*2;function e(r,s,a,o){var l=r*o-s*a<0?-1:1,c=r*a+s*o;return c>1&&(c=1),c<-1&&(c=-1),l*Math.acos(c)}function n(r,s,a,o,l,c,u,f,h,d){var y=d*(r-a)/2+h*(s-o)/2,m=-h*(r-a)/2+d*(s-o)/2,x=u*u,w=f*f,S=y*y,A=m*m,_=x*w-x*A-w*S;_<0&&(_=0),_/=x*A+w*S,_=Math.sqrt(_)*(l===c?-1:1);var M=_*u/f*m,I=_*-f/u*y,T=d*M-h*I+(r+a)/2,D=h*M+d*I+(s+o)/2,O=(y-M)/u,W=(m-I)/f,C=(-y-M)/u,N=(-m-I)/f,B=e(1,0,O,W),E=e(O,W,C,N);return c===0&&E>0&&(E-=t),c===1&&E<0&&(E+=t),[T,D,B,E]}function i(r,s){var a=1.3333333333333333*Math.tan(s/4),o=Math.cos(r),l=Math.sin(r),c=Math.cos(r+s),u=Math.sin(r+s);return[o,l,o-l*a,l+o*a,c+u*a,u-c*a,c,u]}return Zg=function(s,a,o,l,c,u,f,h,d){var y=Math.sin(d*t/360),m=Math.cos(d*t/360),x=m*(s-o)/2+y*(a-l)/2,w=-y*(s-o)/2+m*(a-l)/2;if(x===0&&w===0)return[];if(f===0||h===0)return[];f=Math.abs(f),h=Math.abs(h);var S=x*x/(f*f)+w*w/(h*h);S>1&&(f*=Math.sqrt(S),h*=Math.sqrt(S));var A=n(s,a,o,l,c,u,f,h,y,m),_=[],M=A[2],I=A[3],T=Math.max(Math.ceil(Math.abs(I)/(t/4)),1);I/=T;for(var D=0;D<T;D++)_.push(i(M,I)),M+=I;return _.map(function(O){for(var W=0;W<O.length;W+=2){var C=O[W+0],N=O[W+1];C*=f,N*=h;var B=m*C-y*N,E=y*C+m*N;O[W+0]=B+A[0],O[W+1]=E+A[1]}return O})},Zg}var Jg,Dy;function zF(){if(Dy)return Jg;Dy=1;var t=1e-10,e=Math.PI/180;function n(i,r,s){if(!(this instanceof n))return new n(i,r,s);this.rx=i,this.ry=r,this.ax=s}return n.prototype.transform=function(i){var r=Math.cos(this.ax*e),s=Math.sin(this.ax*e),a=[this.rx*(i[0]*r+i[2]*s),this.rx*(i[1]*r+i[3]*s),this.ry*(-i[0]*s+i[2]*r),this.ry*(-i[1]*s+i[3]*r)],o=a[0]*a[0]+a[2]*a[2],l=a[1]*a[1]+a[3]*a[3],c=((a[0]-a[3])*(a[0]-a[3])+(a[2]+a[1])*(a[2]+a[1]))*((a[0]+a[3])*(a[0]+a[3])+(a[2]-a[1])*(a[2]-a[1])),u=(o+l)/2;if(c<t*u)return this.rx=this.ry=Math.sqrt(u),this.ax=0,this;var f=a[0]*a[1]+a[2]*a[3];c=Math.sqrt(c);var h=u+c/2,d=u-c/2;return this.ax=Math.abs(f)<t&&Math.abs(h-l)<t?90:Math.atan(Math.abs(f)>Math.abs(h-l)?(h-o)/f:f/(h-l))*180/Math.PI,this.ax>=0?(this.rx=Math.sqrt(h),this.ry=Math.sqrt(d)):(this.ax+=90,this.rx=Math.sqrt(d),this.ry=Math.sqrt(h)),this},n.prototype.isDegenerate=function(){return this.rx<t*this.ry||this.ry<t*this.rx},Jg=n,Jg}var Qg,Oy;function qF(){if(Oy)return Qg;Oy=1;var t=FF(),e=RF(),n=Jx(),i=BF(),r=zF();function s(a){if(!(this instanceof s))return new s(a);var o=t(a);this.segments=o.segments,this.err=o.err,this.__stack=[]}return s.from=function(a){if(typeof a=="string")return new s(a);if(a instanceof s){var o=new s("");return o.err=a.err,o.segments=a.segments.map(function(l){return l.slice()}),o.__stack=a.__stack.map(function(l){return n().matrix(l.toArray())}),o}throw new Error("SvgPath.from: invalid param type "+a)},s.prototype.__matrix=function(a){var o=this,l;a.queue.length&&this.iterate(function(c,u,f,h){var d,y,m,x;switch(c[0]){case"v":d=a.calc(0,c[1],!0),y=d[0]===0?["v",d[1]]:["l",d[0],d[1]];break;case"V":d=a.calc(f,c[1],!1),y=d[0]===a.calc(f,h,!1)[0]?["V",d[1]]:["L",d[0],d[1]];break;case"h":d=a.calc(c[1],0,!0),y=d[1]===0?["h",d[0]]:["l",d[0],d[1]];break;case"H":d=a.calc(c[1],h,!1),y=d[1]===a.calc(f,h,!1)[1]?["H",d[0]]:["L",d[0],d[1]];break;case"a":case"A":var w=a.toArray(),S=r(c[1],c[2],c[3]).transform(w);if(w[0]*w[3]-w[1]*w[2]<0&&(c[5]=c[5]?"0":"1"),d=a.calc(c[6],c[7],c[0]==="a"),c[0]==="A"&&c[6]===f&&c[7]===h||c[0]==="a"&&c[6]===0&&c[7]===0){y=[c[0]==="a"?"l":"L",d[0],d[1]];break}S.isDegenerate()?y=[c[0]==="a"?"l":"L",d[0],d[1]]:y=[c[0],S.rx,S.ry,S.ax,c[4],c[5],d[0],d[1]];break;case"m":x=u>0,d=a.calc(c[1],c[2],x),y=["m",d[0],d[1]];break;default:for(m=c[0],y=[m],x=m.toLowerCase()===m,l=1;l<c.length;l+=2)d=a.calc(c[l],c[l+1],x),y.push(d[0],d[1])}o.segments[u]=y},!0)},s.prototype.__evaluateStack=function(){var a,o;if(this.__stack.length){if(this.__stack.length===1){this.__matrix(this.__stack[0]),this.__stack=[];return}for(a=n(),o=this.__stack.length;--o>=0;)a.matrix(this.__stack[o].toArray());this.__matrix(a),this.__stack=[]}},s.prototype.toString=function(){var a="",o="",l=!1;this.__evaluateStack();for(var c=0,u=this.segments.length;c<u;c++){var f=this.segments[c],h=f[0];h!==o||h==="m"||h==="M"?(h==="m"&&o==="z"&&(a+=" "),a+=h,l=!1):l=!0;for(var d=1;d<f.length;d++){var y=f[d];d===1?l&&y>=0&&(a+=" "):y>=0&&(a+=" "),a+=y}o=h}return a},s.prototype.translate=function(a,o){return this.__stack.push(n().translate(a,o||0)),this},s.prototype.scale=function(a,o){return this.__stack.push(n().scale(a,!o&&o!==0?a:o)),this},s.prototype.rotate=function(a,o,l){return this.__stack.push(n().rotate(a,o||0,l||0)),this},s.prototype.skewX=function(a){return this.__stack.push(n().skewX(a)),this},s.prototype.skewY=function(a){return this.__stack.push(n().skewY(a)),this},s.prototype.matrix=function(a){return this.__stack.push(n().matrix(a)),this},s.prototype.transform=function(a){return a.trim()?(this.__stack.push(e(a)),this):this},s.prototype.round=function(a){var o=0,l=0,c=0,u=0,f;return a=a||0,this.__evaluateStack(),this.segments.forEach(function(h){var d=h[0].toLowerCase()===h[0];switch(h[0]){case"H":case"h":d&&(h[1]+=c),c=h[1]-h[1].toFixed(a),h[1]=+h[1].toFixed(a);return;case"V":case"v":d&&(h[1]+=u),u=h[1]-h[1].toFixed(a),h[1]=+h[1].toFixed(a);return;case"Z":case"z":c=o,u=l;return;case"M":case"m":d&&(h[1]+=c,h[2]+=u),c=h[1]-h[1].toFixed(a),u=h[2]-h[2].toFixed(a),o=c,l=u,h[1]=+h[1].toFixed(a),h[2]=+h[2].toFixed(a);return;case"A":case"a":d&&(h[6]+=c,h[7]+=u),c=h[6]-h[6].toFixed(a),u=h[7]-h[7].toFixed(a),h[1]=+h[1].toFixed(a),h[2]=+h[2].toFixed(a),h[3]=+h[3].toFixed(a+2),h[6]=+h[6].toFixed(a),h[7]=+h[7].toFixed(a);return;default:f=h.length,d&&(h[f-2]+=c,h[f-1]+=u),c=h[f-2]-h[f-2].toFixed(a),u=h[f-1]-h[f-1].toFixed(a),h.forEach(function(y,m){m&&(h[m]=+h[m].toFixed(a))});return}}),this},s.prototype.iterate=function(a,o){var l=this.segments,c={},u=!1,f=0,h=0,d=0,y=0,m,x,w;if(o||this.__evaluateStack(),l.forEach(function(S,A){var _=a(S,A,f,h);Array.isArray(_)&&(c[A]=_,u=!0);var M=S[0]===S[0].toLowerCase();switch(S[0]){case"m":case"M":f=S[1]+(M?f:0),h=S[2]+(M?h:0),d=f,y=h;return;case"h":case"H":f=S[1]+(M?f:0);return;case"v":case"V":h=S[1]+(M?h:0);return;case"z":case"Z":f=d,h=y;return;default:f=S[S.length-2]+(M?f:0),h=S[S.length-1]+(M?h:0)}}),!u)return this;for(w=[],m=0;m<l.length;m++)if(typeof c[m]<"u")for(x=0;x<c[m].length;x++)w.push(c[m][x]);else w.push(l[m]);return this.segments=w,this},s.prototype.abs=function(){return this.iterate(function(a,o,l,c){var u=a[0],f=u.toUpperCase(),h;if(u!==f)switch(a[0]=f,u){case"v":a[1]+=c;return;case"a":a[6]+=l,a[7]+=c;return;default:for(h=1;h<a.length;h++)a[h]+=h%2?l:c}},!0),this},s.prototype.rel=function(){return this.iterate(function(a,o,l,c){var u=a[0],f=u.toLowerCase(),h;if(u!==f&&!(o===0&&u==="M"))switch(a[0]=f,u){case"V":a[1]-=c;return;case"A":a[6]-=l,a[7]-=c;return;default:for(h=1;h<a.length;h++)a[h]-=h%2?l:c}},!0),this},s.prototype.unarc=function(){return this.iterate(function(a,o,l,c){var u,f,h,d=[],y=a[0];return y!=="A"&&y!=="a"?null:(y==="a"?(f=l+a[6],h=c+a[7]):(f=a[6],h=a[7]),u=i(l,c,f,h,a[4],a[5],a[1],a[2],a[3]),u.length===0?[[a[0]==="a"?"l":"L",a[6],a[7]]]:(u.forEach(function(m){d.push(["C",m[2],m[3],m[4],m[5],m[6],m[7]])}),d))}),this},s.prototype.unshort=function(){var a=this.segments,o,l,c,u,f;return this.iterate(function(h,d,y,m){var x=h[0],w=x.toUpperCase(),S;d&&(w==="T"?(S=x==="t",c=a[d-1],c[0]==="Q"?(o=c[1]-y,l=c[2]-m):c[0]==="q"?(o=c[1]-c[3],l=c[2]-c[4]):(o=0,l=0),u=-o,f=-l,S||(u+=y,f+=m),a[d]=[S?"q":"Q",u,f,h[1],h[2]]):w==="S"&&(S=x==="s",c=a[d-1],c[0]==="C"?(o=c[3]-y,l=c[4]-m):c[0]==="c"?(o=c[3]-c[5],l=c[4]-c[6]):(o=0,l=0),u=-o,f=-l,S||(u+=y,f+=m),a[d]=[S?"c":"C",u,f,h[1],h[2],h[3],h[4]]))}),this},Qg=s,Qg}var $g,Fy;function jF(){return Fy||(Fy=1,$g=qF()),$g}var HF=jF();const UF=u0(HF);var Ry=function(t){var e=t,n,i={a:0,b:0,c:0},r=[],s=/(\[[^\]]+\])/g,a=/(#[^\#\s\+>~\.\[:\)]+)/g,o=/(\.[^\s\+>~\.\[:\)]+)/g,l=/(::[^\s\+>~\.\[:]+|:first-line|:first-letter|:before|:after)/gi,c=/(:(?!not|global|local)[\w-]+\([^\)]*\))/gi,u=/(:(?!not|global|local)[^\s\+>~\.\[:]+)/g,f=/([^\s\+>~\.\[:]+)/g;return n=function(h,d){var y,m,x,w,S,A;if(h.test(e))for(y=e.match(h),m=0,x=y.length;m<x;m+=1)i[d]+=1,w=y[m],S=e.indexOf(w),A=w.length,r.push({selector:t.substr(S,A),type:d,index:S,length:A}),e=e.replace(w,Array(A+1).join(" "))},(function(){var h=function(x){var w,S,A,_;if(x.test(e))for(w=e.match(x),S=0,A=w.length;S<A;S+=1)_=w[S],e=e.replace(_,Array(_.length+1).join("A"))},d=/\\[0-9A-Fa-f]{6}\s?/g,y=/\\[0-9A-Fa-f]{1,5}\s/g,m=/\\./g;h(d),h(y),h(m)})(),(function(){var h=/{[^]*/gm,d,y,m,x;if(h.test(e))for(d=e.match(h),y=0,m=d.length;y<m;y+=1)x=d[y],e=e.replace(x,Array(x.length+1).join(" "))})(),n(s,"b"),n(a,"a"),n(o,"b"),n(l,"c"),n(c,"b"),n(u,"b"),e=e.replace(/[\*\s\+>~]/g," "),e=e.replace(/[#\.]/g," "),e=e.replace(/:not/g,"    "),e=e.replace(/:local/g,"      "),e=e.replace(/:global/g,"       "),e=e.replace(/[\(\)]/g," "),n(f,"c"),r.sort(function(h,d){return h.index-d.index}),{selector:t,specificity:"0,"+i.a.toString()+","+i.b.toString()+","+i.c.toString(),specificityArray:[0,i.a,i.b,i.c],parts:r}},WF=function(t,e){var n,i,r;if(typeof t=="string"){if(t.indexOf(",")!==-1)throw"Invalid CSS selector";n=Ry(t).specificityArray}else if(Array.isArray(t)){if(t.filter(function(s){return typeof s=="number"}).length!==4)throw"Invalid specificity array";n=t}else throw"Invalid CSS selector or specificity array";if(typeof e=="string"){if(e.indexOf(",")!==-1)throw"Invalid CSS selector";i=Ry(e).specificityArray}else if(Array.isArray(e)){if(e.filter(function(s){return typeof s=="number"}).length!==4)throw"Invalid specificity array";i=e}else throw"Invalid CSS selector or specificity array";for(r=0;r<4;r+=1){if(n[r]<i[r])return-1;if(n[r]>i[r])return 1}return 0},Jm=function(t,e){return Jm=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,i){n.__proto__=i}||function(n,i){for(var r in i)Object.prototype.hasOwnProperty.call(i,r)&&(n[r]=i[r])},Jm(t,e)};function Yn(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");function n(){this.constructor=t}Jm(t,e),t.prototype=e===null?Object.create(e):(n.prototype=e.prototype,new n)}var Gh=function(){return Gh=Object.assign||function(t){for(var e,n=1,i=arguments.length;n<i;n++)for(var r in e=arguments[n])Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t},Gh.apply(this,arguments)};function ei(t,e,n,i){return new(n||(n=Promise))((function(r,s){function a(c){try{l(i.next(c))}catch(u){s(u)}}function o(c){try{l(i.throw(c))}catch(u){s(u)}}function l(c){var u;c.done?r(c.value):(u=c.value,u instanceof n?u:new n((function(f){f(u)}))).then(a,o)}l((i=i.apply(t,e||[])).next())}))}function ti(t,e){var n,i,r,s,a={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]};return s={next:o(0),throw:o(1),return:o(2)},typeof Symbol=="function"&&(s[Symbol.iterator]=function(){return this}),s;function o(l){return function(c){return(function(u){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,i&&(r=2&u[0]?i.return:u[0]?i.throw||((r=i.return)&&r.call(i),0):i.next)&&!(r=r.call(i,u[1])).done)return r;switch(i=0,r&&(u=[2&u[0],r.value]),u[0]){case 0:case 1:r=u;break;case 4:return a.label++,{value:u[1],done:!1};case 5:a.label++,i=u[1],u=[0];continue;case 7:u=a.ops.pop(),a.trys.pop();continue;default:if(r=a.trys,!((r=r.length>0&&r[r.length-1])||u[0]!==6&&u[0]!==2)){a=0;continue}if(u[0]===3&&(!r||u[1]>r[0]&&u[1]<r[3])){a.label=u[1];break}if(u[0]===6&&a.label<r[1]){a.label=r[1],r=u;break}if(r&&a.label<r[2]){a.label=r[2],a.ops.push(u);break}r[2]&&a.ops.pop(),a.trys.pop();continue}u=e.call(t,a)}catch(f){u=[6,f],i=0}finally{n=r=0}if(5&u[0])throw u[1];return{value:u[0]?u[1]:void 0,done:!0}})([l,c])}}}var ka=(function(){function t(e){if(this.a=void 0,this.r=0,this.g=0,this.b=0,this.simpleColors={},this.colorDefs=[],this.ok=!1,e){for(var n in e.charAt(0)=="#"&&(e=e.substr(1,6)),e=(e=e.replace(/ /g,"")).toLowerCase(),this.simpleColors={aliceblue:"f0f8ff",antiquewhite:"faebd7",aqua:"00ffff",aquamarine:"7fffd4",azure:"f0ffff",beige:"f5f5dc",bisque:"ffe4c4",black:"000000",blanchedalmond:"ffebcd",blue:"0000ff",blueviolet:"8a2be2",brown:"a52a2a",burlywood:"deb887",cadetblue:"5f9ea0",chartreuse:"7fff00",chocolate:"d2691e",coral:"ff7f50",cornflowerblue:"6495ed",cornsilk:"fff8dc",crimson:"dc143c",cyan:"00ffff",darkblue:"00008b",darkcyan:"008b8b",darkgoldenrod:"b8860b",darkgray:"a9a9a9",darkgrey:"a9a9a9",darkgreen:"006400",darkkhaki:"bdb76b",darkmagenta:"8b008b",darkolivegreen:"556b2f",darkorange:"ff8c00",darkorchid:"9932cc",darkred:"8b0000",darksalmon:"e9967a",darkseagreen:"8fbc8f",darkslateblue:"483d8b",darkslategray:"2f4f4f",darkslategrey:"2f4f4f",darkturquoise:"00ced1",darkviolet:"9400d3",deeppink:"ff1493",deepskyblue:"00bfff",dimgray:"696969",dimgrey:"696969",dodgerblue:"1e90ff",feldspar:"d19275",firebrick:"b22222",floralwhite:"fffaf0",forestgreen:"228b22",fuchsia:"ff00ff",gainsboro:"dcdcdc",ghostwhite:"f8f8ff",gold:"ffd700",goldenrod:"daa520",gray:"808080",grey:"808080",green:"008000",greenyellow:"adff2f",honeydew:"f0fff0",hotpink:"ff69b4",indianred:"cd5c5c",indigo:"4b0082",ivory:"fffff0",khaki:"f0e68c",lavender:"e6e6fa",lavenderblush:"fff0f5",lawngreen:"7cfc00",lemonchiffon:"fffacd",lightblue:"add8e6",lightcoral:"f08080",lightcyan:"e0ffff",lightgoldenrodyellow:"fafad2",lightgray:"d3d3d3",lightgrey:"d3d3d3",lightgreen:"90ee90",lightpink:"ffb6c1",lightsalmon:"ffa07a",lightseagreen:"20b2aa",lightskyblue:"87cefa",lightslateblue:"8470ff",lightslategray:"778899",lightslategrey:"778899",lightsteelblue:"b0c4de",lightyellow:"ffffe0",lime:"00ff00",limegreen:"32cd32",linen:"faf0e6",magenta:"ff00ff",maroon:"800000",mediumaquamarine:"66cdaa",mediumblue:"0000cd",mediumorchid:"ba55d3",mediumpurple:"9370d8",mediumseagreen:"3cb371",mediumslateblue:"7b68ee",mediumspringgreen:"00fa9a",mediumturquoise:"48d1cc",mediumvioletred:"c71585",midnightblue:"191970",mintcream:"f5fffa",mistyrose:"ffe4e1",moccasin:"ffe4b5",navajowhite:"ffdead",navy:"000080",oldlace:"fdf5e6",olive:"808000",olivedrab:"6b8e23",orange:"ffa500",orangered:"ff4500",orchid:"da70d6",palegoldenrod:"eee8aa",palegreen:"98fb98",paleturquoise:"afeeee",palevioletred:"d87093",papayawhip:"ffefd5",peachpuff:"ffdab9",peru:"cd853f",pink:"ffc0cb",plum:"dda0dd",powderblue:"b0e0e6",purple:"800080",red:"ff0000",rosybrown:"bc8f8f",royalblue:"4169e1",saddlebrown:"8b4513",salmon:"fa8072",sandybrown:"f4a460",seagreen:"2e8b57",seashell:"fff5ee",sienna:"a0522d",silver:"c0c0c0",skyblue:"87ceeb",slateblue:"6a5acd",slategray:"708090",slategrey:"708090",snow:"fffafa",springgreen:"00ff7f",steelblue:"4682b4",tan:"d2b48c",teal:"008080",thistle:"d8bfd8",tomato:"ff6347",turquoise:"40e0d0",violet:"ee82ee",violetred:"d02090",wheat:"f5deb3",white:"ffffff",whitesmoke:"f5f5f5",yellow:"ffff00",yellowgreen:"9acd32"},this.simpleColors)e==n&&(e=this.simpleColors[n]);this.colorDefs=[{re:/^rgb\((\d{1,3}),\s*(\d{1,3}),\s*(\d{1,3})\)$/,example:["rgb(123, 234, 45)","rgb(255,234,245)"],process:function(l){return[parseInt(l[1]),parseInt(l[2]),parseInt(l[3])]}},{re:/^rgb\(([0-9.]+)%,\s*([0-9.]+)%,\s*([0-9.]+)%\)$/,example:["rgb(50.5%, 25.75%, 75.5%)","rgb(100%,0%,0%)"],process:function(l){return[Math.round(2.55*parseFloat(l[1])),Math.round(2.55*parseFloat(l[2])),Math.round(2.55*parseFloat(l[3]))]}},{re:/^(\w{2})(\w{2})(\w{2})$/,example:["#00ff00","336699"],process:function(l){return[parseInt(l[1],16),parseInt(l[2],16),parseInt(l[3],16)]}},{re:/^(\w{1})(\w{1})(\w{1})$/,example:["#fb0","f0f"],process:function(l){return[parseInt(l[1]+l[1],16),parseInt(l[2]+l[2],16),parseInt(l[3]+l[3],16)]}}];for(var i=0;i<this.colorDefs.length;i++){var r=this.colorDefs[i].re,s=this.colorDefs[i].process,a=r.exec(e);if(a){var o=s(a);this.r=o[0],this.g=o[1],this.b=o[2],this.ok=!0}}this.r=this.r<0||isNaN(this.r)?0:this.r>255?255:this.r,this.g=this.g<0||isNaN(this.g)?0:this.g>255?255:this.g,this.b=this.b<0||isNaN(this.b)?0:this.b>255?255:this.b}}return t.prototype.toRGB=function(){return"rgb("+this.r+", "+this.g+", "+this.b+")"},t.prototype.toRGBA=function(){return"rgba("+this.r+", "+this.g+", "+this.b+", "+(this.a||"1")+")"},t.prototype.toHex=function(){var e=this.r.toString(16),n=this.g.toString(16),i=this.b.toString(16);return e.length==1&&(e="0"+e),n.length==1&&(n="0"+n),i.length==1&&(i="0"+i),"#"+e+n+i},t.prototype.getHelpXML=function(){for(var e=[],n=0;n<this.colorDefs.length;n++)for(var i=this.colorDefs[n].example,r=0;r<i.length;r++)e[e.length]=i[r];for(var s in this.simpleColors)e[e.length]=s;var a=document.createElement("ul");for(a.setAttribute("id","rgbcolor-examples"),n=0;n<e.length;n++)try{var o=document.createElement("li"),l=new t(e[n]),c=document.createElement("div");c.style.cssText="margin: 3px; border: 1px solid black; background:"+l.toHex()+"; color:"+l.toHex(),c.appendChild(document.createTextNode("test"));var u=document.createTextNode(" "+e[n]+" -> "+l.toRGB()+" -> "+l.toHex());o.appendChild(c),o.appendChild(u),a.appendChild(o)}catch{}return a},t})(),Pr=(function(){function t(e){this.color=e}return t.prototype.getFillData=function(e,n){return ei(this,void 0,void 0,(function(){return ti(this,(function(i){return[2,void 0]}))}))},t})(),Mu=(function(){function t(){this.xmlSpace="",this.whiteSpace="",this.fill=null,this.fillOpacity=1,this.fontFamily="",this.fontSize=16,this.fontStyle="",this.fontWeight="",this.opacity=1,this.stroke=null,this.strokeDasharray=null,this.strokeDashoffset=0,this.strokeLinecap="",this.strokeLinejoin="",this.strokeMiterlimit=4,this.strokeOpacity=1,this.strokeWidth=1,this.alignmentBaseline="",this.textAnchor="",this.visibility="",this.color=null,this.contextFill=null,this.contextStroke=null,this.fillRule=null}return t.prototype.clone=function(){var e=new t;return e.xmlSpace=this.xmlSpace,e.whiteSpace=this.whiteSpace,e.fill=this.fill,e.fillOpacity=this.fillOpacity,e.fontFamily=this.fontFamily,e.fontSize=this.fontSize,e.fontStyle=this.fontStyle,e.fontWeight=this.fontWeight,e.opacity=this.opacity,e.stroke=this.stroke,e.strokeDasharray=this.strokeDasharray,e.strokeDashoffset=this.strokeDashoffset,e.strokeLinecap=this.strokeLinecap,e.strokeLinejoin=this.strokeLinejoin,e.strokeMiterlimit=this.strokeMiterlimit,e.strokeOpacity=this.strokeOpacity,e.strokeWidth=this.strokeWidth,e.textAnchor=this.textAnchor,e.alignmentBaseline=this.alignmentBaseline,e.visibility=this.visibility,e.color=this.color,e.fillRule=this.fillRule,e.contextFill=this.contextFill,e.contextStroke=this.contextStroke,e},t.default=function(){var e=new t;return e.xmlSpace="default",e.whiteSpace="normal",e.fill=new Pr(new ka("rgb(0, 0, 0)")),e.fillOpacity=1,e.fontFamily="times",e.fontSize=16,e.fontStyle="normal",e.fontWeight="normal",e.opacity=1,e.stroke=null,e.strokeDasharray=null,e.strokeDashoffset=0,e.strokeLinecap="butt",e.strokeLinejoin="miter",e.strokeMiterlimit=4,e.strokeOpacity=1,e.strokeWidth=1,e.alignmentBaseline="baseline",e.textAnchor="start",e.visibility="visible",e.color=new ka("rgb(0, 0, 0)"),e.fillRule="nonzero",e.contextFill=null,e.contextStroke=null,e},t.getContextColors=function(e,n){n===void 0&&(n=!1);var i={};return e.attributeState.contextFill&&(i.contextFill=e.attributeState.contextFill),e.attributeState.contextStroke&&(i.contextStroke=e.attributeState.contextStroke),n&&e.attributeState.color&&(i.color=e.attributeState.color),i},t})(),Ql=(function(){function t(e,n){var i,r,s;this.pdf=e,this.svg2pdfParameters=n.svg2pdfParameters,this.attributeState=n.attributeState?n.attributeState.clone():Mu.default(),this.viewport=n.viewport,this.refsHandler=n.refsHandler,this.styleSheets=n.styleSheets,this.textMeasure=n.textMeasure,this.transform=(i=n.transform)!==null&&i!==void 0?i:this.pdf.unitMatrix,this.withinClipPath=(r=n.withinClipPath)!==null&&r!==void 0&&r,this.withinUse=(s=n.withinUse)!==null&&s!==void 0&&s}return t.prototype.clone=function(e){var n,i,r,s;return e===void 0&&(e={}),new t(this.pdf,{svg2pdfParameters:this.svg2pdfParameters,attributeState:e.attributeState?e.attributeState.clone():this.attributeState.clone(),viewport:(n=e.viewport)!==null&&n!==void 0?n:this.viewport,refsHandler:this.refsHandler,styleSheets:this.styleSheets,textMeasure:this.textMeasure,transform:(i=e.transform)!==null&&i!==void 0?i:this.transform,withinClipPath:(r=e.withinClipPath)!==null&&r!==void 0?r:this.withinClipPath,withinUse:(s=e.withinUse)!==null&&s!==void 0?s:this.withinUse})},t})(),Qx=(function(){function t(e){this.renderedElements={},this.idMap=e,this.idPrefix=String(t.instanceCounter++)}return t.prototype.getRendered=function(e,n,i){return ei(this,void 0,void 0,(function(){var r,s;return ti(this,(function(a){switch(a.label){case 0:return r=this.generateKey(e,n),this.renderedElements.hasOwnProperty(r)?[2,this.renderedElements[e]]:(s=this.get(e),this.renderedElements[r]=s,[4,i(s)]);case 1:return a.sent(),[2,s]}}))}))},t.prototype.get=function(e){return this.idMap[Zx(e,{isIdentifier:!0})]},t.prototype.generateKey=function(e,n){var i="";return n&&(i=["color","contextFill","contextStroke"].map((function(r){var s,a;return(a=(s=n[r])===null||s===void 0?void 0:s.toRGBA())!==null&&a!==void 0?a:""})).join("|")),this.idPrefix+"|"+e+"|"+i},t.instanceCounter=0,t})();function By(t,e){return Math.atan2(e[1]-t[1],e[0]-t[0])}var zy=2/3;function qy(t,e){return[zy*(e[0]-t[0])+t[0],zy*(e[1]-t[1])+t[1]]}function fd(t){var e=Math.sqrt(t[0]*t[0]+t[1]*t[1]);return[t[0]/e,t[1]/e]}function eu(t,e){return fd([e[0]-t[0],e[1]-t[1]])}function Wf(t,e){return[t[0]+e[0],t[1]+e[1]]}function em(t,e){var n=t[0],i=t[1];return[e.a*n+e.c*i+e.e,e.b*n+e.d*i+e.f]}var Tu=(function(){function t(){this.segments=[]}return t.prototype.moveTo=function(e,n){return this.segments.push(new pr(e,n)),this},t.prototype.lineTo=function(e,n){return this.segments.push(new Hl(e,n)),this},t.prototype.curveTo=function(e,n,i,r,s,a){return this.segments.push(new no(e,n,i,r,s,a)),this},t.prototype.close=function(){return this.segments.push(new Qm),this},t.prototype.transform=function(e){this.segments.forEach((function(n){if(n instanceof pr||n instanceof Hl||n instanceof no){var i=em([n.x,n.y],e);n.x=i[0],n.y=i[1]}if(n instanceof no){var r=em([n.x1,n.y1],e),s=em([n.x2,n.y2],e);n.x1=r[0],n.y1=r[1],n.x2=s[0],n.y2=s[1]}}))},t.prototype.draw=function(e){var n=e.pdf;this.segments.forEach((function(i){i instanceof pr?n.moveTo(i.x,i.y):i instanceof Hl?n.lineTo(i.x,i.y):i instanceof no?n.curveTo(i.x1,i.y1,i.x2,i.y2,i.x,i.y):n.close()}))},t})(),pr=function(t,e){this.x=t,this.y=e},Hl=function(t,e){this.x=t,this.y=e},no=function(t,e,n,i,r,s){this.x1=t,this.y1=e,this.x2=n,this.y2=i,this.x=r,this.y=s},Qm=function(){};function Xl(t,e){return e.split(",").indexOf((t.nodeName||t.tagName).toLowerCase())>=0}function lt(t,e,n,i){var r;i===void 0&&(i=n);var s=(r=t.style)===null||r===void 0?void 0:r.getPropertyValue(i);if(s)return s;var a=e.getPropertyValue(t,i);return a||t.hasAttribute(n)&&t.getAttribute(n)||void 0}function ll(t,e,n){if(lt(t.element,n.styleSheets,"display")==="none")return!1;var i=e,r=lt(t.element,n.styleSheets,"visibility");return r&&(i=r!=="hidden"),i}function $l(t,e,n){var i=ll(t,e,n);return t.element.childNodes.length!==0&&(t.children.forEach((function(r){r.isVisible(i,n)&&(i=!0)})),i)}var VF=(function(){function t(){this.markers=[]}return t.prototype.addMarker=function(e){this.markers.push(e)},t.prototype.draw=function(e){return ei(this,void 0,void 0,(function(){var n,i,r,s,a,o,l,c;return ti(this,(function(u){switch(u.label){case 0:n=0,u.label=1;case 1:return n<this.markers.length?(i=this.markers[n],r=void 0,s=i.angle,a=i.anchor,o=Math.cos(s),l=Math.sin(s),r=e.pdf.Matrix(o,l,-l,o,a[0],a[1]),r=e.pdf.matrixMult(e.pdf.Matrix(e.attributeState.strokeWidth,0,0,e.attributeState.strokeWidth,0,0),r),r=e.pdf.matrixMult(r,e.transform),e.pdf.saveGraphicsState(),c=Mu.getContextColors(e),[4,e.refsHandler.getRendered(i.id,c,(function(f){return f.apply(e)}))]):[3,4];case 2:u.sent(),e.pdf.doFormObject(e.refsHandler.generateKey(i.id,c),r),e.pdf.restoreGraphicsState(),u.label=3;case 3:return n++,[3,1];case 4:return[2]}}))}))},t})(),Rl=function(t,e,n,i){i===void 0&&(i=!1),this.id=t,this.anchor=e,this.angle=n,this.isStartMarker=i},d0=/url\(["']?#([^"']+)["']?\)/,GF={bottom:"bottom","text-bottom":"bottom",top:"top","text-top":"top",hanging:"hanging",middle:"middle",central:"middle",center:"middle",mathematical:"middle",ideographic:"ideographic",alphabetic:"alphabetic",baseline:"alphabetic"},jy="http://www.w3.org/2000/svg";function Yo(t,e){var n;return(n=t&&t.toString().match(/^([\-0-9.]+)em$/))?parseFloat(n[1])*e:(n=t&&t.toString().match(/^([\-0-9.]+)(px|)$/))?parseFloat(n[1]):0}function $x(t){return GF[t]||"alphabetic"}function ia(t){for(var e,n=[],i=/[+-]?(?:(?:\d+\.?\d*)|(?:\d*\.?\d+))(?:[eE][+-]?\d+)?/g;e=i.exec(t);)n.push(parseFloat(e[0]));return n}function xu(t,e){if(t==="transparent"){var n=new ka("rgb(0,0,0)");return n.a=0,n}if(e&&t.toLowerCase()==="currentcolor")return e.color||new ka("rgb(0,0,0)");if(e&&t.toLowerCase()==="context-stroke")return e.contextStroke||new ka("rgb(0,0,0)");if(e&&t.toLowerCase()==="context-fill")return e.contextFill||new ka("rgb(0,0,0)");var i=/\s*rgba\(((?:[^,\)]*,){3}[^,\)]*)\)\s*/.exec(t);if(i){var r=ia(i[1]),s=new ka("rgb("+r.slice(0,3).join(",")+")");return s.a=r[3],s}return new ka(t)}var tl={"sans-serif":"helvetica",verdana:"helvetica",arial:"helvetica",fixed:"courier",monospace:"courier",terminal:"courier",serif:"times",cursive:"times",fantasy:"times"},tm,XF=(tm=qt.version.split("."),parseFloat(tm[0])===2&&parseFloat(tm[1])===3);function e_(t,e){return XF?e==400?t=="italic"?"italic":"normal":e==700&&t!=="italic"?"bold":t+""+e:e==400||e==="normal"?t==="italic"?"italic":"normal":e!=700&&e!=="bold"||t!=="normal"?(e==700?"bold":e)+""+t:"bold"}function f0(t,e){if(lt(e.element,t.styleSheets,"display")==="none")return[0,0,0,0];var n=[];return e.children.forEach((function(i){var r=i.getBoundingBox(t);if(r[0]!==0||r[1]!==0||r[2]!==0||r[3]!==0){var s=i.computeNodeTransform(t);r[0]=r[0]*s.sx+s.tx,r[1]=r[1]*s.sy+s.ty,r[2]=r[2]*s.sx,r[3]=r[3]*s.sy,n=n.length===0?r:[Math.min(n[0],r[0]),Math.min(n[1],r[1]),Math.max(n[0]+n[2],r[0]+r[2])-Math.min(n[0],r[0]),Math.max(n[1]+n[3],r[1]+r[3])-Math.min(n[1],r[1])]}})),n.length===0?[0,0,0,0]:n}function Xd(t,e){var n=parseFloat,i=n(t.getAttribute("x1"))||n(lt(t,e.styleSheets,"x"))||n(lt(t,e.styleSheets,"cx"))-n(lt(t,e.styleSheets,"r"))||0,r=n(t.getAttribute("x2"))||i+n(lt(t,e.styleSheets,"width"))||n(lt(t,e.styleSheets,"cx"))+n(lt(t,e.styleSheets,"r"))||0,s=n(t.getAttribute("y1"))||n(lt(t,e.styleSheets,"y"))||n(lt(t,e.styleSheets,"cy"))-n(lt(t,e.styleSheets,"r"))||0,a=n(t.getAttribute("y2"))||s+n(lt(t,e.styleSheets,"height"))||n(lt(t,e.styleSheets,"cy"))+n(lt(t,e.styleSheets,"r"))||0;return[Math.min(i,r),Math.min(s,a),Math.max(i,r)-Math.min(i,r),Math.max(s,a)-Math.min(s,a)]}function Yd(t,e,n,i,r,s,a,o){o===void 0&&(o=!1);var l,c,u=e[0],f=e[1],h=e[2],d=e[3],y=r/h,m=s/d,x=t.getAttribute("preserveAspectRatio");if(x){var w=x.split(" ");w[0]==="defer"&&(w=w.slice(1)),l=w[0],c=w[1]||"meet"}else l="xMidYMid",c="meet";if(l!=="none"&&(c==="meet"?y=m=Math.min(y,m):c==="slice"&&(y=m=Math.max(y,m))),o)return a.pdf.Matrix(y,0,0,m,0,0);var S=n-u*y,A=i-f*m;l.indexOf("xMid")>=0?S+=(r-h*y)/2:l.indexOf("xMax")>=0&&(S+=r-h*y),l.indexOf("YMid")>=0?A+=(s-d*m)/2:l.indexOf("YMax")>=0&&(A+=s-d*m);var _=a.pdf.Matrix(1,0,0,1,S,A),M=a.pdf.Matrix(y,0,0,m,0,0);return a.pdf.matrixMult(M,_)}function _p(t,e){if(!t||t==="none")return e.pdf.unitMatrix;for(var n,i,r=/^[\s,]*matrix\(([^)]+)\)\s*/,s=/^[\s,]*translate\(([^)]+)\)\s*/,a=/^[\s,]*rotate\(([^)]+)\)\s*/,o=/^[\s,]*scale\(([^)]+)\)\s*/,l=/^[\s,]*skewX\(([^)]+)\)\s*/,c=/^[\s,]*skewY\(([^)]+)\)\s*/,u=e.pdf.unitMatrix;t.length>0&&t.length!==i;){i=t.length;var f=r.exec(t);if(f&&(n=ia(f[1]),u=e.pdf.matrixMult(e.pdf.Matrix(n[0],n[1],n[2],n[3],n[4],n[5]),u),t=t.substr(f[0].length)),f=a.exec(t)){n=ia(f[1]);var h=Math.PI*n[0]/180;if(u=e.pdf.matrixMult(e.pdf.Matrix(Math.cos(h),Math.sin(h),-Math.sin(h),Math.cos(h),0,0),u),n[1]||n[2]){var d=e.pdf.Matrix(1,0,0,1,n[1],n[2]),y=e.pdf.Matrix(1,0,0,1,-n[1],-n[2]);u=e.pdf.matrixMult(y,e.pdf.matrixMult(u,d))}t=t.substr(f[0].length)}(f=s.exec(t))&&(n=ia(f[1]),u=e.pdf.matrixMult(e.pdf.Matrix(1,0,0,1,n[0],n[1]||0),u),t=t.substr(f[0].length)),(f=o.exec(t))&&((n=ia(f[1]))[1]||(n[1]=n[0]),u=e.pdf.matrixMult(e.pdf.Matrix(n[0],0,0,n[1],0,0),u),t=t.substr(f[0].length)),(f=l.exec(t))&&(n=parseFloat(f[1]),n*=Math.PI/180,u=e.pdf.matrixMult(e.pdf.Matrix(1,0,Math.tan(n),1,0,0),u),t=t.substr(f[0].length)),(f=c.exec(t))&&(n=parseFloat(f[1]),n*=Math.PI/180,u=e.pdf.matrixMult(e.pdf.Matrix(1,Math.tan(n),0,1,0,0),u),t=t.substr(f[0].length))}return u}var h0=(function(){function t(e,n){this.element=e,this.children=n,this.parent=null}return t.prototype.setParent=function(e){this.parent=e},t.prototype.getParent=function(){return this.parent},t.prototype.getBoundingBox=function(e){return lt(this.element,e.styleSheets,"display")==="none"?[0,0,0,0]:this.getBoundingBoxCore(e)},t.prototype.computeNodeTransform=function(e){var n=this.computeNodeTransformCore(e),i=lt(this.element,e.styleSheets,"transform");return i?e.pdf.matrixMult(n,_p(i,e)):n},t})(),Kd=(function(t){function e(){return t!==null&&t.apply(this,arguments)||this}return Yn(e,t),e.prototype.render=function(n){return Promise.resolve()},e.prototype.getBoundingBoxCore=function(n){return[]},e.prototype.computeNodeTransformCore=function(n){return n.pdf.unitMatrix},e})(h0),t_=(function(t){function e(n,i,r){var s=t.call(this,i,r)||this;return s.pdfGradientType=n,s.contextColor=void 0,s}return Yn(e,t),e.prototype.apply=function(n){return ei(this,void 0,void 0,(function(){var i,r,s,a,o,l;return ti(this,(function(c){return(i=this.element.getAttribute("id"))?(r=this.getStops(n.styleSheets),s=0,a=!1,r.forEach((function(u){var f=u.opacity;f&&f!==1&&(s+=f,a=!0)})),a&&(o=new Ec({opacity:s/r.length})),l=new jl(this.pdfGradientType,this.getCoordinates(),r,o),n.pdf.addShadingPattern(i,l),[2]):[2]}))}))},e.prototype.getStops=function(n){var i=this;if(this.stops)return this.stops;if(this.contextColor===void 0){this.contextColor=null;for(var r=this;r;){var s=lt(r.element,n,"color");if(s){this.contextColor=xu(s,null);break}r=r.getParent()}}var a=[];return this.children.forEach((function(o){if(o.element.tagName.toLowerCase()==="stop"){var l=lt(o.element,n,"color"),c=xu(lt(o.element,n,"stop-color")||"",l?{color:xu(l,null)}:{color:i.contextColor}),u=parseFloat(lt(o.element,n,"stop-opacity")||"1");a.push({offset:e.parseGradientOffset(o.element.getAttribute("offset")||"0"),color:[c.r,c.g,c.b],opacity:u})}})),this.stops=a},e.prototype.getBoundingBoxCore=function(n){return Xd(this.element,n)},e.prototype.computeNodeTransformCore=function(n){return n.pdf.unitMatrix},e.prototype.isVisible=function(n,i){return $l(this,n,i)},e.parseGradientOffset=function(n){var i=parseFloat(n);return!isNaN(i)&&n.indexOf("%")>=0?i/100:i},e})(Kd),n_=(function(t){function e(n,i){return t.call(this,"axial",n,i)||this}return Yn(e,t),e.prototype.getCoordinates=function(){return[parseFloat(this.element.getAttribute("x1")||"0"),parseFloat(this.element.getAttribute("y1")||"0"),parseFloat(this.element.getAttribute("x2")||"1"),parseFloat(this.element.getAttribute("y2")||"0")]},e})(t_),i_=(function(t){function e(n,i){return t.call(this,"radial",n,i)||this}return Yn(e,t),e.prototype.getCoordinates=function(){var n=this.element.getAttribute("cx"),i=this.element.getAttribute("cy"),r=this.element.getAttribute("fx"),s=this.element.getAttribute("fy");return[parseFloat(r||n||"0.5"),parseFloat(s||i||"0.5"),0,parseFloat(n||"0.5"),parseFloat(i||"0.5"),parseFloat(this.element.getAttribute("r")||"0.5")]},e})(t_),YF=(function(){function t(e,n){this.key=e,this.gradient=n}return t.prototype.getFillData=function(e,n){return ei(this,void 0,void 0,(function(){var i,r,s;return ti(this,(function(a){switch(a.label){case 0:return[4,n.refsHandler.getRendered(this.key,null,(function(o){return o.apply(new Ql(n.pdf,{refsHandler:n.refsHandler,textMeasure:n.textMeasure,styleSheets:n.styleSheets,viewport:n.viewport,svg2pdfParameters:n.svg2pdfParameters}))}))];case 1:return a.sent(),this.gradient.element.hasAttribute("gradientUnits")&&this.gradient.element.getAttribute("gradientUnits").toLowerCase()!=="objectboundingbox"?i=n.pdf.unitMatrix:(r=e.getBoundingBox(n),i=n.pdf.Matrix(r[2],0,0,r[3],r[0],r[1])),s=_p(lt(this.gradient.element,n.styleSheets,"gradientTransform","transform"),n),[2,{key:this.key,matrix:n.pdf.matrixMult(s,i)}]}}))}))},t})(),r_=(function(t){function e(){return t!==null&&t.apply(this,arguments)||this}return Yn(e,t),e.prototype.apply=function(n){return ei(this,void 0,void 0,(function(){var i,r,s,a,o;return ti(this,(function(l){switch(l.label){case 0:if(!(i=this.element.getAttribute("id")))return[2];r=this.getBoundingBox(n),s=new vc([r[0],r[1],r[0]+r[2],r[1]+r[3]],r[2],r[3]),n.pdf.beginTilingPattern(s),a=0,o=this.children,l.label=1;case 1:return a<o.length?[4,o[a].render(new Ql(n.pdf,{attributeState:n.attributeState,refsHandler:n.refsHandler,styleSheets:n.styleSheets,viewport:n.viewport,svg2pdfParameters:n.svg2pdfParameters,textMeasure:n.textMeasure}))]:[3,4];case 2:l.sent(),l.label=3;case 3:return a++,[3,1];case 4:return n.pdf.endTilingPattern(i,s),[2]}}))}))},e.prototype.getBoundingBoxCore=function(n){return Xd(this.element,n)},e.prototype.computeNodeTransformCore=function(n){return n.pdf.unitMatrix},e.prototype.isVisible=function(n,i){return $l(this,n,i)},e})(Kd),KF=(function(){function t(e,n){this.key=e,this.pattern=n}return t.prototype.getFillData=function(e,n){return ei(this,void 0,void 0,(function(){var i,r,s,a,o,l,c,u,f,h,d,y;return ti(this,(function(m){switch(m.label){case 0:return[4,n.refsHandler.getRendered(this.key,null,(function(x){return x.apply(new Ql(n.pdf,{refsHandler:n.refsHandler,textMeasure:n.textMeasure,styleSheets:n.styleSheets,viewport:n.viewport,svg2pdfParameters:n.svg2pdfParameters}))}))];case 1:return m.sent(),i={key:this.key,boundingBox:void 0,xStep:0,yStep:0,matrix:void 0},s=n.pdf.unitMatrix,this.pattern.element.hasAttribute("patternUnits")&&this.pattern.element.getAttribute("patternUnits").toLowerCase()!=="objectboundingbox"||(r=e.getBoundingBox(n),s=n.pdf.Matrix(1,0,0,1,r[0],r[1]),o=this.pattern.getBoundingBox(n),l=o[0]*r[0]||0,c=o[1]*r[1]||0,u=o[2]*r[2]||0,f=o[3]*r[3]||0,i.boundingBox=[l,c,l+u,c+f],i.xStep=u,i.yStep=f),a=n.pdf.unitMatrix,this.pattern.element.hasAttribute("patternContentUnits")&&this.pattern.element.getAttribute("patternContentUnits").toLowerCase()==="objectboundingbox"&&(r||(r=e.getBoundingBox(n)),a=n.pdf.Matrix(r[2],0,0,r[3],0,0),o=i.boundingBox||this.pattern.getBoundingBox(n),l=o[0]/r[0]||0,c=o[1]/r[1]||0,u=o[2]/r[2]||0,f=o[3]/r[3]||0,i.boundingBox=[l,c,l+u,c+f],i.xStep=u,i.yStep=f),h=n.pdf.unitMatrix,(d=lt(this.pattern.element,n.styleSheets,"patternTransform","transform"))&&(h=_p(d,n)),y=a,y=n.pdf.matrixMult(y,s),y=n.pdf.matrixMult(y,h),y=n.pdf.matrixMult(y,n.transform),i.matrix=y,[2,i]}}))}))},t})();function ZF(t,e){var n=d0.exec(t);if(n){var i=n[1],r=e.refsHandler.get(i);return r&&(r instanceof n_||r instanceof i_)?(function(a,o,l){var c=o.getStops(l.styleSheets);if(c.length===0)return null;if(c.length===1){var u=c[0].color,f=new ka;return f.ok=!0,f.r=u[0],f.g=u[1],f.b=u[2],f.a=c[0].opacity,new Pr(f)}return new YF(a,o)})(i,r,e):r&&r instanceof r_?new KF(i,r):new Pr(new ka("rgb(0, 0, 0)"))}var s=xu(t,e.attributeState);return s.ok?new Pr(s):null}function p0(t,e,n){var i=n||e.element,r=lt(i,t.styleSheets,"color");if(r){var s=xu(r,t.attributeState);s.ok?t.attributeState.color=s:t.attributeState.color=new ka("rgb(0,0,0)")}var a=lt(i,t.styleSheets,"visibility");a&&(t.attributeState.visibility=a);var o=lt(i,t.styleSheets,"fill");o&&(t.attributeState.fill=ZF(o,t));var l=lt(i,t.styleSheets,"fill-opacity");l&&(t.attributeState.fillOpacity=parseFloat(l));var c=lt(i,t.styleSheets,"stroke-opacity");c&&(t.attributeState.strokeOpacity=parseFloat(c));var u=lt(i,t.styleSheets,"opacity");u&&(t.attributeState.opacity=parseFloat(u));var f=lt(i,t.styleSheets,"stroke-width");f!==void 0&&f!==""&&(t.attributeState.strokeWidth=Math.abs(parseFloat(f)));var h=lt(i,t.styleSheets,"stroke");if(h)if(h==="none")t.attributeState.stroke=null;else{var d=xu(h,t.attributeState);d.ok&&(t.attributeState.stroke=new Pr(d))}h&&t.attributeState.stroke instanceof Pr&&(t.attributeState.contextStroke=t.attributeState.stroke.color),o&&t.attributeState.fill instanceof Pr&&(t.attributeState.contextFill=t.attributeState.fill.color);var y=lt(i,t.styleSheets,"stroke-linecap");y&&(t.attributeState.strokeLinecap=y);var m=lt(i,t.styleSheets,"stroke-linejoin");m&&(t.attributeState.strokeLinejoin=m);var x=lt(i,t.styleSheets,"stroke-dasharray");if(x){var w=parseInt(lt(i,t.styleSheets,"stroke-dashoffset")||"0");t.attributeState.strokeDasharray=ia(x),t.attributeState.strokeDashoffset=w}var S=lt(i,t.styleSheets,"stroke-miterlimit");S!==void 0&&S!==""&&(t.attributeState.strokeMiterlimit=parseFloat(S));var A=i.getAttribute("xml:space");A&&(t.attributeState.xmlSpace=A);var _=lt(i,t.styleSheets,"white-space");_&&(t.attributeState.whiteSpace=_);var M=lt(i,t.styleSheets,"font-weight");M&&(t.attributeState.fontWeight=M);var I=lt(i,t.styleSheets,"font-style");I&&(t.attributeState.fontStyle=I);var T=lt(i,t.styleSheets,"font-family");if(T){var D=OF.parse(T);t.attributeState.fontFamily=(function(R,q,Z){var U=e_(R.fontStyle,R.fontWeight),X=Z.pdf.getFontList(),de="";return q.some((function(le){var F=X[le];return F&&F.indexOf(U)>=0?(de=le,!0):(le=le.toLowerCase(),!!tl.hasOwnProperty(le)&&(de=le,!0))}))||(de="times"),de})(t.attributeState,D,t)}var O=lt(i,t.styleSheets,"font-size");if(O){var W=t.pdf.getFontSize();t.attributeState.fontSize=Yo(O,W)}var C=lt(i,t.styleSheets,"vertical-align")||lt(i,t.styleSheets,"alignment-baseline");if(C){var N=C.match(/(baseline|text-bottom|alphabetic|ideographic|middle|central|mathematical|text-top|bottom|center|top|hanging)/);N&&(t.attributeState.alignmentBaseline=N[0])}var B=lt(i,t.styleSheets,"text-anchor");B&&(t.attributeState.textAnchor=B);var E=lt(i,t.styleSheets,"fill-rule");E&&(t.attributeState.fillRule=E)}function g0(t,e,n){var i=1,r=1;i*=t.attributeState.fillOpacity,i*=t.attributeState.opacity,t.attributeState.fill instanceof Pr&&t.attributeState.fill.color.a!==void 0&&(i*=t.attributeState.fill.color.a),r*=t.attributeState.strokeOpacity,r*=t.attributeState.opacity,t.attributeState.stroke instanceof Pr&&t.attributeState.stroke.color.a!==void 0&&(r*=t.attributeState.stroke.color.a);var s,a,o=i<1,l=r<1;if(Xl(n,"use")?(o=!0,l=!0,i*=t.attributeState.fill?1:0,r*=t.attributeState.stroke?1:0):t.withinUse&&(t.attributeState.fill!==e.attributeState.fill?(o=!0,i*=t.attributeState.fill?1:0):o&&!t.attributeState.fill&&(i=0),t.attributeState.stroke!==e.attributeState.stroke?(l=!0,r*=t.attributeState.stroke?1:0):l&&!t.attributeState.stroke&&(r=0)),o||l){var c={};o&&(c.opacity=i),l&&(c["stroke-opacity"]=r),t.pdf.setGState(new Ec(c))}if(t.attributeState.fill&&t.attributeState.fill!==e.attributeState.fill&&t.attributeState.fill instanceof Pr&&t.attributeState.fill.color.ok&&!Xl(n,"text")&&t.pdf.setFillColor(t.attributeState.fill.color.r,t.attributeState.fill.color.g,t.attributeState.fill.color.b),t.attributeState.strokeWidth!==e.attributeState.strokeWidth&&t.pdf.setLineWidth(t.attributeState.strokeWidth),t.attributeState.stroke!==e.attributeState.stroke&&t.attributeState.stroke instanceof Pr&&t.pdf.setDrawColor(t.attributeState.stroke.color.r,t.attributeState.stroke.color.g,t.attributeState.stroke.color.b),t.attributeState.strokeLinecap!==e.attributeState.strokeLinecap&&t.pdf.setLineCap(t.attributeState.strokeLinecap),t.attributeState.strokeLinejoin!==e.attributeState.strokeLinejoin&&t.pdf.setLineJoin(t.attributeState.strokeLinejoin),t.attributeState.strokeDasharray===e.attributeState.strokeDasharray&&t.attributeState.strokeDashoffset===e.attributeState.strokeDashoffset||!t.attributeState.strokeDasharray||t.pdf.setLineDashPattern(t.attributeState.strokeDasharray,t.attributeState.strokeDashoffset),t.attributeState.strokeMiterlimit!==e.attributeState.strokeMiterlimit&&t.pdf.setLineMiterLimit(t.attributeState.strokeMiterlimit),t.attributeState.fontFamily!==e.attributeState.fontFamily&&(s=tl.hasOwnProperty(t.attributeState.fontFamily)?tl[t.attributeState.fontFamily]:t.attributeState.fontFamily),t.attributeState.fill&&t.attributeState.fill!==e.attributeState.fill&&t.attributeState.fill instanceof Pr&&t.attributeState.fill.color.ok){var u=t.attributeState.fill.color;t.pdf.setTextColor(u.r,u.g,u.b)}t.attributeState.fontWeight===e.attributeState.fontWeight&&t.attributeState.fontStyle===e.attributeState.fontStyle||(a=e_(t.attributeState.fontStyle,t.attributeState.fontWeight)),s===void 0&&a===void 0||(s===void 0&&(s=tl.hasOwnProperty(t.attributeState.fontFamily)?tl[t.attributeState.fontFamily]:t.attributeState.fontFamily),t.pdf.setFont(s,a)),t.attributeState.fontSize!==e.attributeState.fontSize&&t.pdf.setFontSize(t.attributeState.fontSize*t.pdf.internal.scaleFactor)}function s_(t,e,n){var i=d0.exec(t);if(i){var r=i[1];return n.refsHandler.get(r)||void 0}}function a_(t,e,n){return ei(this,void 0,void 0,(function(){var i,r;return ti(this,(function(s){switch(s.label){case 0:return i=n.clone(),e.element.hasAttribute("clipPathUnits")&&e.element.getAttribute("clipPathUnits").toLowerCase()==="objectboundingbox"&&(r=t.getBoundingBox(n),i.transform=n.pdf.matrixMult(n.pdf.Matrix(r[2],0,0,r[3],r[0],r[1]),n.transform)),[4,e.apply(i)];case 1:return s.sent(),[2]}}))}))}var o_=(function(t){function e(){return t!==null&&t.apply(this,arguments)||this}return Yn(e,t),e.prototype.render=function(n){return ei(this,void 0,void 0,(function(){var i,r,s,a;return ti(this,(function(o){switch(o.label){case 0:return this.isVisible(n.attributeState.visibility!=="hidden",n)?((i=n.clone()).transform=i.pdf.matrixMult(this.computeNodeTransform(i),n.transform),p0(i,this),r=lt(this.element,i.styleSheets,"clip-path"),(s=r&&r!=="none")?(a=s_(r,0,i))?a.isVisible(!0,i)?(i.pdf.saveGraphicsState(),[4,a_(this,a,i)]):[3,2]:[3,4]:[3,5]):[2];case 1:return o.sent(),[3,3];case 2:return[2];case 3:return[3,5];case 4:s=!1,o.label=5;case 5:return i.withinClipPath||i.pdf.saveGraphicsState(),g0(i,n,this.element),[4,this.renderCore(i)];case 6:return o.sent(),i.withinClipPath||i.pdf.restoreGraphicsState(),s&&i.pdf.restoreGraphicsState(),[2]}}))}))},e})(h0),Sp=(function(t){function e(){return t!==null&&t.apply(this,arguments)||this}return Yn(e,t),e})(o_),Zd=(function(t){function e(n,i,r){var s=t.call(this,i,r)||this;return s.cachedPath=null,s.hasMarkers=n,s}return Yn(e,t),e.prototype.renderCore=function(n){return ei(this,void 0,void 0,(function(){var i;return ti(this,(function(r){switch(r.label){case 0:return(i=this.getCachedPath(n))===null||i.segments.length===0?[2]:(n.withinClipPath?i.transform(n.transform):n.pdf.setCurrentTransformationMatrix(n.transform),i.draw(n),[4,this.fillOrStroke(n)]);case 1:return r.sent(),this.hasMarkers?[4,this.drawMarkers(n,i)]:[3,3];case 2:r.sent(),r.label=3;case 3:return[2]}}))}))},e.prototype.getCachedPath=function(n){return this.cachedPath||(this.cachedPath=this.getPath(n))},e.prototype.drawMarkers=function(n,i){return ei(this,void 0,void 0,(function(){return ti(this,(function(r){switch(r.label){case 0:return[4,this.getMarkers(i,n).draw(n.clone({transform:n.pdf.unitMatrix}))];case 1:return r.sent(),[2]}}))}))},e.prototype.fillOrStroke=function(n){return ei(this,void 0,void 0,(function(){var i,r,s,a,o;return ti(this,(function(l){switch(l.label){case 0:return n.withinClipPath?[2]:(i=n.attributeState.fill,r=n.attributeState.stroke&&n.attributeState.strokeWidth!==0,i?[4,i.getFillData(this,n)]:[3,2]);case 1:return a=l.sent(),[3,3];case 2:a=void 0,l.label=3;case 3:return s=a,o=n.attributeState.fillRule==="evenodd",i&&r||n.withinUse?o?n.pdf.fillStrokeEvenOdd(s):n.pdf.fillStroke(s):i?o?n.pdf.fillEvenOdd(s):n.pdf.fill(s):r?n.pdf.stroke():n.pdf.discardPath(),[2]}}))}))},e.prototype.getBoundingBoxCore=function(n){var i=this.getCachedPath(n);if(!i||!i.segments.length)return[0,0,0,0];for(var r=Number.POSITIVE_INFINITY,s=Number.POSITIVE_INFINITY,a=Number.NEGATIVE_INFINITY,o=Number.NEGATIVE_INFINITY,l=0,c=0,u=0;u<i.segments.length;u++){var f=i.segments[u];(f instanceof pr||f instanceof Hl||f instanceof no)&&(l=f.x,c=f.y),f instanceof no?(r=Math.min(r,l,f.x1,f.x2,f.x),a=Math.max(a,l,f.x1,f.x2,f.x),s=Math.min(s,c,f.y1,f.y2,f.y),o=Math.max(o,c,f.y1,f.y2,f.y)):(r=Math.min(r,l),a=Math.max(a,l),s=Math.min(s,c),o=Math.max(o,c))}return[r,s,a-r,o-s]},e.prototype.getMarkers=function(n,i){var r=lt(this.element,i.styleSheets,"marker-start"),s=lt(this.element,i.styleSheets,"marker-mid"),a=lt(this.element,i.styleSheets,"marker-end"),o=new VF;if(r||s||a){a&&(a=nm(a)),r&&(r=nm(r)),s&&(s=nm(s));for(var l=n.segments,c=[1,0],u=void 0,f=!1,h=[1,0],d=!1,y=function(x){var w=l[x],S=r&&(x===1||!(l[x]instanceof pr)&&l[x-1]instanceof pr);S&&l.forEach((function(D,O){if(!d&&D instanceof Qm&&O>x){var W=l[O-1];d=(W instanceof pr||W instanceof Hl||W instanceof no)&&W}}));var A=a&&(x===l.length-1||!(l[x]instanceof pr)&&l[x+1]instanceof pr),_=s&&x>0&&!(x===1&&l[x-1]instanceof pr),M=l[x-1]||null;if(M instanceof pr||M instanceof Hl||M instanceof no)if(w instanceof no)S&&o.addMarker(new Rl(r,[M.x,M.y],By(d?[d.x,d.y]:[M.x,M.y],[w.x1,w.y1]),!0)),A&&o.addMarker(new Rl(a,[w.x,w.y],By([w.x2,w.y2],[w.x,w.y]))),_&&(u=eu([M.x,M.y],[w.x1,w.y1]),u=M instanceof pr?u:fd(Wf(c,u)),o.addMarker(new Rl(s,[M.x,M.y],Math.atan2(u[1],u[0])))),c=eu([w.x2,w.y2],[w.x,w.y]);else if(w instanceof pr||w instanceof Hl){if(u=eu([M.x,M.y],[w.x,w.y]),S){var I=d?eu([d.x,d.y],[w.x,w.y]):u;o.addMarker(new Rl(r,[M.x,M.y],Math.atan2(I[1],I[0]),!0))}A&&o.addMarker(new Rl(a,[w.x,w.y],Math.atan2(u[1],u[0]))),_&&(I=w instanceof pr?c:M instanceof pr?u:fd(Wf(c,u)),o.addMarker(new Rl(s,[M.x,M.y],Math.atan2(I[1],I[0])))),c=u}else w instanceof Qm&&(u=eu([M.x,M.y],[f.x,f.y]),_&&(I=M instanceof pr?u:fd(Wf(c,u)),o.addMarker(new Rl(s,[M.x,M.y],Math.atan2(I[1],I[0])))),A&&(I=fd(Wf(u,h)),o.addMarker(new Rl(a,[f.x,f.y],Math.atan2(I[1],I[0])))),c=u);else{f=w instanceof pr&&w;var T=l[x+1];(T instanceof pr||T instanceof Hl||T instanceof no)&&(h=eu([f.x,f.y],[T.x,T.y]))}},m=0;m<l.length;m++)y(m)}return o.markers.forEach((function(x){var w=i.refsHandler.get(x.id);if(w){var S=lt(w.element,i.styleSheets,"orient");S!=null&&(x.isStartMarker&&S==="auto-start-reverse"&&(x.angle+=Math.PI),isNaN(Number(S))||(x.angle=parseFloat(S)/180*Math.PI))}})),o},e})(Sp);function nm(t){var e=d0.exec(t);return e&&e[1]||void 0}var JF=(function(t){function e(n,i){return t.call(this,!0,n,i)||this}return Yn(e,t),e.prototype.getPath=function(n){if(n.withinClipPath||n.attributeState.stroke===null)return null;var i=parseFloat(this.element.getAttribute("x1")||"0"),r=parseFloat(this.element.getAttribute("y1")||"0"),s=parseFloat(this.element.getAttribute("x2")||"0"),a=parseFloat(this.element.getAttribute("y2")||"0");return i||s||r||a?new Tu().moveTo(i,r).lineTo(s,a):null},e.prototype.computeNodeTransformCore=function(n){return n.pdf.unitMatrix},e.prototype.isVisible=function(n,i){return ll(this,n,i)},e.prototype.fillOrStroke=function(n){return ei(this,void 0,void 0,(function(){return ti(this,(function(i){switch(i.label){case 0:return n.attributeState.fill=null,[4,t.prototype.fillOrStroke.call(this,n)];case 1:return i.sent(),[2]}}))}))},e})(Zd),l_=(function(t){function e(){return t!==null&&t.apply(this,arguments)||this}return Yn(e,t),e.prototype.apply=function(n){return ei(this,void 0,void 0,(function(){var i,r,s,a,o;return ti(this,(function(l){switch(l.label){case 0:return this.isVisible(n.attributeState.visibility!=="hidden",n)?((i=n.clone()).transform=i.pdf.unitMatrix,p0(i,this),r=lt(this.element,i.styleSheets,"clip-path"),r&&r!=="none"&&(s=s_(r,0,i))?s.isVisible(!0,i)?[4,a_(this,s,i)]:[3,2]:[3,3]):[2];case 1:return l.sent(),[3,3];case 2:return[2];case 3:g0(i,n,this.element),a=0,o=this.children,l.label=4;case 4:return a<o.length?[4,o[a].render(i)]:[3,7];case 5:l.sent(),l.label=6;case 6:return a++,[3,4];case 7:return[2]}}))}))},e.prototype.getBoundingBoxCore=function(n){return f0(n,this)},e.prototype.isVisible=function(n,i){return $l(this,n,i)},e.prototype.computeNodeTransformCore=function(n){var i=parseFloat(lt(this.element,n.styleSheets,"x")||"0"),r=parseFloat(lt(this.element,n.styleSheets,"y")||"0"),s=this.element.getAttribute("viewBox");if(s){var a=ia(s),o=parseFloat(lt(this.element,n.styleSheets,"width")||lt(this.element.ownerSVGElement,n.styleSheets,"width")||s[2]),l=parseFloat(lt(this.element,n.styleSheets,"height")||lt(this.element.ownerSVGElement,n.styleSheets,"height")||s[3]);return Yd(this.element,a,i,r,o,l,n)}return n.pdf.Matrix(1,0,0,1,i,r)},e})(Kd),kp=function(t,e){this.width=t,this.height=e},QF=(function(t){function e(){return t!==null&&t.apply(this,arguments)||this}return Yn(e,t),e.prototype.renderCore=function(n){return ei(this,void 0,void 0,(function(){var i,r,s,a,o,l,c,u,f,h,d,y,m;return ti(this,(function(x){switch(x.label){case 0:return i=parseFloat,(r=this.element.getAttribute("href")||this.element.getAttribute("xlink:href"))?(s=r.substring(1),a=n.refsHandler.get(s),o=Xl(a.element,"symbol,svg")&&a.element.hasAttribute("viewBox"),l=i(lt(this.element,n.styleSheets,"x")||"0"),c=i(lt(this.element,n.styleSheets,"y")||"0"),u=void 0,f=void 0,o?(u=i(lt(this.element,n.styleSheets,"width")||lt(a.element,n.styleSheets,"width")||"0"),f=i(lt(this.element,n.styleSheets,"height")||lt(a.element,n.styleSheets,"height")||"0"),l+=i(lt(a.element,n.styleSheets,"x")||"0"),c+=i(lt(a.element,n.styleSheets,"y")||"0"),d=ia(a.element.getAttribute("viewBox")),h=Yd(a.element,d,l,c,u,f,n)):h=n.pdf.Matrix(1,0,0,1,l,c),y=Mu.getContextColors(n,!0),m=new Ql(n.pdf,{refsHandler:n.refsHandler,styleSheets:n.styleSheets,withinUse:!0,viewport:o?new kp(u,f):n.viewport,svg2pdfParameters:n.svg2pdfParameters,textMeasure:n.textMeasure,attributeState:Object.assign(Mu.default(),y)}),[4,n.refsHandler.getRendered(s,y,(function(w){return e.renderReferencedNode(w,s,m)}))]):[2];case 1:return x.sent(),n.pdf.saveGraphicsState(),n.pdf.setCurrentTransformationMatrix(n.transform),o&&lt(a.element,n.styleSheets,"overflow")!=="visible"&&(n.pdf.rect(l,c,u,f),n.pdf.clip().discardPath()),n.pdf.doFormObject(n.refsHandler.generateKey(s,y),h),n.pdf.restoreGraphicsState(),[2]}}))}))},e.renderReferencedNode=function(n,i,r){return ei(this,void 0,void 0,(function(){var s;return ti(this,(function(a){switch(a.label){case 0:return s=[(s=n.getBoundingBox(r))[0]-.5*s[2],s[1]-.5*s[3],2*s[2],2*s[3]],r.pdf.beginFormObject(s[0],s[1],s[2],s[3],r.pdf.unitMatrix),n instanceof l_?[4,n.apply(r)]:[3,2];case 1:return a.sent(),[3,4];case 2:return[4,n.render(r)];case 3:a.sent(),a.label=4;case 4:return r.pdf.endFormObject(r.refsHandler.generateKey(i,r.attributeState)),[2]}}))}))},e.prototype.getBoundingBoxCore=function(n){return Xd(this.element,n)},e.prototype.isVisible=function(n,i){return ll(this,n,i)},e.prototype.computeNodeTransformCore=function(n){return n.pdf.unitMatrix},e})(Sp),$F=(function(t){function e(n,i){return t.call(this,!1,n,i)||this}return Yn(e,t),e.prototype.getPath=function(n){var i=parseFloat(lt(this.element,n.styleSheets,"width")||"0"),r=parseFloat(lt(this.element,n.styleSheets,"height")||"0");if(!isFinite(i)||i<=0||!isFinite(r)||r<=0)return null;var s=lt(this.element,n.styleSheets,"rx"),a=lt(this.element,n.styleSheets,"ry"),o=Math.min(parseFloat(s||a||"0"),.5*i),l=Math.min(parseFloat(a||s||"0"),.5*r),c=parseFloat(lt(this.element,n.styleSheets,"x")||"0"),u=parseFloat(lt(this.element,n.styleSheets,"y")||"0"),f=4/3*(Math.SQRT2-1);return o===0&&l===0?new Tu().moveTo(c,u).lineTo(c+i,u).lineTo(c+i,u+r).lineTo(c,u+r).close():new Tu().moveTo(c+=o,u).lineTo(c+=i-2*o,u).curveTo(c+o*f,u,c+o,u+(l-l*f),c+=o,u+=l).lineTo(c,u+=r-2*l).curveTo(c,u+l*f,c-o*f,u+l,c-=o,u+=l).lineTo(c+=2*o-i,u).curveTo(c-o*f,u,c-o,u-l*f,c-=o,u-=l).lineTo(c,u+=2*l-r).curveTo(c,u-l*f,c+o*f,u-l,c+=o,u-=l).close()},e.prototype.computeNodeTransformCore=function(n){return n.pdf.unitMatrix},e.prototype.isVisible=function(n,i){return ll(this,n,i)},e})(Zd),c_=(function(t){function e(n,i){return t.call(this,!1,n,i)||this}return Yn(e,t),e.prototype.getPath=function(n){var i=this.getRx(n),r=this.getRy(n);if(!isFinite(i)||r<=0||!isFinite(r)||r<=0)return null;var s=parseFloat(lt(this.element,n.styleSheets,"cx")||"0"),a=parseFloat(lt(this.element,n.styleSheets,"cy")||"0"),o=4/3*(Math.SQRT2-1)*i,l=4/3*(Math.SQRT2-1)*r;return new Tu().moveTo(s+i,a).curveTo(s+i,a-l,s+o,a-r,s,a-r).curveTo(s-o,a-r,s-i,a-l,s-i,a).curveTo(s-i,a+l,s-o,a+r,s,a+r).curveTo(s+o,a+r,s+i,a+l,s+i,a)},e.prototype.computeNodeTransformCore=function(n){return n.pdf.unitMatrix},e.prototype.isVisible=function(n,i){return ll(this,n,i)},e})(Zd),eR=(function(t){function e(n,i){return t.call(this,n,i)||this}return Yn(e,t),e.prototype.getRx=function(n){return parseFloat(lt(this.element,n.styleSheets,"rx")||"0")},e.prototype.getRy=function(n){return parseFloat(lt(this.element,n.styleSheets,"ry")||"0")},e})(c_);function u_(t){var e="invisible",n=t.stroke&&t.strokeWidth!==0,i=t.fill;return i&&n?e="fillThenStroke":i?e="fill":n&&(e="stroke"),e}function Hy(t){return t.replace(/[\n\r]/g,"")}function Uy(t){return t.replace(/[\t]/g," ")}function Wy(t){return t.replace(/ +/g," ")}function Vy(t,e,n){switch(lt(t,n.styleSheets,"text-transform")){case"uppercase":return e.toUpperCase();case"lowercase":return e.toLowerCase();default:return e}}var im=(function(){function t(e,n,i,r){this.textNode=e,this.texts=[],this.textNodes=[],this.contexts=[],this.textAnchor=n,this.originX=i,this.originY=r,this.textMeasures=[]}return t.prototype.setX=function(e){this.originX=e},t.prototype.setY=function(e){this.originY=e},t.prototype.add=function(e,n,i){this.texts.push(n),this.textNodes.push(e),this.contexts.push(i)},t.prototype.rightTrimText=function(){for(var e=this.texts.length-1;e>=0;e--)if(this.contexts[e].attributeState.xmlSpace==="preserve"||this.contexts[e].attributeState.whiteSpace==="pre"||(this.texts[e]=this.texts[e].replace(/\s+$/,"")),this.texts[e].match(/[^\s]/))return!1;return!0},t.prototype.measureText=function(e){for(var n=0;n<this.texts.length;n++)this.textMeasures.push({width:e.textMeasure.measureTextWidth(this.texts[n],this.contexts[n].attributeState),length:this.texts[n].length})},t.prototype.put=function(e,n){var i,r,s,a,o=[],l=[],c=[],u=this.originX,f=this.originY,h=u,d=u;for(i=0;i<this.textNodes.length;i++){r=this.textNodes[i],s=this.contexts[i],a=this.textMeasures[i]||{width:e.textMeasure.measureTextWidth(this.texts[i],this.contexts[i].attributeState),length:this.texts[i].length};var y=u,m=f;if(r.nodeName!=="#text"&&!o.includes(r)){o.push(r);var x=t.resolveRelativePositionAttribute(r,"dx");x!==null&&(y+=Yo(x,s.attributeState.fontSize));var w=t.resolveRelativePositionAttribute(r,"dy");w!==null&&(m+=Yo(w,s.attributeState.fontSize))}l[i]=y,c[i]=m,u=y+a.width+a.length*n,f=m,h=Math.min(h,y),d=Math.max(d,u)}var S=0;switch(this.textAnchor){case"start":S=0;break;case"middle":S=(d-h)/2;break;case"end":S=d-h}for(i=0;i<this.textNodes.length;i++)if(r=this.textNodes[i],s=this.contexts[i],r.nodeName==="#text"||s.attributeState.visibility!=="hidden"){e.pdf.saveGraphicsState(),g0(s,e,r);var A=s.attributeState.alignmentBaseline,_=u_(s.attributeState);e.pdf.text(this.texts[i],l[i]-S,c[i],{baseline:$x(A),angle:e.transform,renderingMode:_==="fill"?void 0:_,charSpace:n===0?void 0:n}),e.pdf.restoreGraphicsState()}return[u,f]},t.resolveRelativePositionAttribute=function(e,n){for(var i,r=e;r&&Xl(r,"tspan");){if(r.hasAttribute(n))return r.getAttribute(n);if(((i=e.parentElement)===null||i===void 0?void 0:i.firstChild)!==e)break;r=r.parentElement}return null},t})(),tR=(function(t){function e(){var n=t!==null&&t.apply(this,arguments)||this;return n.boundingBox=[],n}return Yn(e,t),e.prototype.processTSpans=function(n,i,r,s,a,o){for(var l=r.pdf.getFontSize(),c=r.attributeState.xmlSpace==="preserve"||r.attributeState.whiteSpace==="pre",u=!0,f=!1,h=0;h<i.childNodes.length;h++){var d=i.childNodes[h];if(d.textContent){var y=d.textContent;if(d.nodeName==="#text"){var m=Hy(y);m=Uy(m),c||(m=Wy(m),u&&m.match(/^\s/)&&(f=!0),m.match(/[^\s]/)&&(u=!1),o.prevText.match(/\s$/)&&(m=m.replace(/^\s+/,"")));var x=Vy(i,m,r);a.add(i,x,r),o.prevText=y,o.prevContext=r}else if(!Xl(d,"title")){if(Xl(d,"tspan")){var w=d,S=w.getAttribute("x");if(S!==null){var A=Yo(S,l);a=new im(this,lt(w,r.styleSheets,"text-anchor")||r.attributeState.textAnchor,A,0),s.push({type:"y",chunk:a})}var _=w.getAttribute("y");if(_!==null){var M=Yo(_,l);a=new im(this,lt(w,r.styleSheets,"text-anchor")||r.attributeState.textAnchor,0,M),s.push({type:"x",chunk:a})}var I=r.clone();p0(I,n,w),this.processTSpans(n,w,I,s,a,o)}}}}return f},e.prototype.renderCore=function(n){return ei(this,void 0,void 0,(function(){var i,r,s,a,o,l,c,u,f,h,d,y,m,x,w,S,A,_,M,I,T,D,O;return ti(this,(function(W){if(n.pdf.saveGraphicsState(),i=0,r=0,s=1,a=n.pdf.getFontSize(),o=Yo(this.element.getAttribute("x"),a),l=Yo(this.element.getAttribute("y"),a),c=Yo(this.element.getAttribute("dx"),a),u=Yo(this.element.getAttribute("dy"),a),f=parseFloat(this.element.getAttribute("textLength")||"0"),h=n.attributeState.visibility,this.element.childElementCount===0)d=this.element.textContent||"",y=(function(C,N){return C=Uy(C=Hy(C)),N.xmlSpace==="preserve"||N.whiteSpace==="pre"||(C=Wy(C=C.trim())),C})(d,n.attributeState),m=Vy(this.element,y,n),i=n.textMeasure.getTextOffset(m,n.attributeState),f>0&&(x=n.textMeasure.measureTextWidth(m,n.attributeState),!(n.attributeState.xmlSpace==="preserve"||n.attributeState.whiteSpace==="pre")&&d.match(/^\s/)&&(s=0),r=(f-x)/(m.length-s)||0),h==="visible"&&(w=n.attributeState.alignmentBaseline,S=u_(n.attributeState),n.pdf.text(m,o+c-i,l+u,{baseline:$x(w),angle:n.transform,renderingMode:S==="fill"?void 0:S,charSpace:r===0?void 0:r}),this.boundingBox=[o+c-i,l+u+.1*a,n.textMeasure.measureTextWidth(m,n.attributeState),a]);else{for(A=[],_=new im(this,n.attributeState.textAnchor,o+c,l+u),A.push({type:"",chunk:_}),M=this.processTSpans(this,this.element,n,A,_,{prevText:" ",prevContext:n}),s=M?0:1,I=!0,T=A.length-1;T>=0;T--)I&&(I=A[T].chunk.rightTrimText());f>0&&(D=0,O=0,A.forEach((function(C){var N=C.chunk;N.measureText(n),N.textMeasures.forEach((function(B){var E=B.width,R=B.length;D+=E,O+=R}))})),r=(f-D)/(O-s)),A.reduce((function(C,N){var B=N.type,E=N.chunk;return B==="x"?E.setX(C[0]):B==="y"&&E.setY(C[1]),E.put(n,r)}),[0,0])}return n.pdf.restoreGraphicsState(),[2]}))}))},e.prototype.isVisible=function(n,i){return $l(this,n,i)},e.prototype.getBoundingBoxCore=function(n){return this.boundingBox.length>0?this.boundingBox:Xd(this.element,n)},e.prototype.computeNodeTransformCore=function(n){return n.pdf.unitMatrix},e})(Sp),nR=(function(t){function e(n,i){return t.call(this,!0,n,i)||this}return Yn(e,t),e.prototype.computeNodeTransformCore=function(n){return n.pdf.unitMatrix},e.prototype.isVisible=function(n,i){return ll(this,n,i)},e.prototype.getPath=function(n){var i,r,s=new UF(lt(this.element,n.styleSheets,"d")||"").unshort().unarc().abs(),a=new Tu;return s.iterate((function(o){switch(o[0]){case"M":a.moveTo(o[1],o[2]);break;case"L":a.lineTo(o[1],o[2]);break;case"H":a.lineTo(o[1],r);break;case"V":a.lineTo(i,o[1]);break;case"C":a.curveTo(o[1],o[2],o[3],o[4],o[5],o[6]);break;case"Q":var l=qy([i,r],[o[1],o[2]]),c=qy([o[3],o[4]],[o[1],o[2]]);a.curveTo(l[0],l[1],c[0],c[1],o[3],o[4]);break;case"Z":a.close()}switch(o[0]){case"M":case"L":i=o[1],r=o[2];break;case"H":i=o[1];break;case"V":r=o[1];break;case"C":i=o[5],r=o[6];break;case"Q":i=o[3],r=o[4]}})),a},e})(Zd),iR=/^\s*data:(([^/,;]+\/[^/,;]+)(?:;([^,;=]+=[^,;=]+))?)?(?:;(base64))?,((?:.|\s)*)$/i,rR=(function(t){function e(n,i){var r=t.call(this,n,i)||this;return r.imageLoadingPromise=null,r.imageUrl=r.element.getAttribute("xlink:href")||r.element.getAttribute("href"),r.imageUrl&&(r.imageLoadingPromise=e.fetchImageData(r.imageUrl)),r}return Yn(e,t),e.prototype.renderCore=function(n){return ei(this,void 0,void 0,(function(){var i,r,s,a,o,l,c,u,f,h,d,y,m,x,w,S,A,_;return ti(this,(function(M){switch(M.label){case 0:return this.imageLoadingPromise?(n.pdf.setCurrentTransformationMatrix(n.transform),i=parseFloat(lt(this.element,n.styleSheets,"width")||"0"),r=parseFloat(lt(this.element,n.styleSheets,"height")||"0"),s=parseFloat(lt(this.element,n.styleSheets,"x")||"0"),a=parseFloat(lt(this.element,n.styleSheets,"y")||"0"),!isFinite(i)||i<=0||!isFinite(r)||r<=0?[2]:[4,this.imageLoadingPromise]):[2];case 1:return o=M.sent(),l=o.data,(c=o.format).indexOf("svg")!==0?[3,3]:(u=new DOMParser,f=u.parseFromString(l,"image/svg+xml").firstElementChild,(!(h=this.element.getAttribute("preserveAspectRatio"))||h.indexOf("defer")<0||!f.getAttribute("preserveAspectRatio"))&&f.setAttribute("preserveAspectRatio",h||""),f.setAttribute("x",String(s)),f.setAttribute("y",String(a)),f.setAttribute("width",String(i)),f.setAttribute("height",String(r)),[4,m0(f,d={}).render(new Ql(n.pdf,{refsHandler:new Qx(d),styleSheets:n.styleSheets,viewport:new kp(i,r),svg2pdfParameters:n.svg2pdfParameters,textMeasure:n.textMeasure}))]);case 2:return M.sent(),[2];case 3:y="data:image/".concat(c,";base64,").concat(btoa(l)),M.label=4;case 4:return M.trys.push([4,6,,7]),[4,e.getImageDimensions(y)];case 5:return m=M.sent(),x=m[0],w=m[1],S=[0,0,x,w],A=Yd(this.element,S,s,a,i,r,n),n.pdf.setCurrentTransformationMatrix(A),n.pdf.addImage(y,"",0,0,x,w),[3,7];case 6:return _=M.sent(),typeof console=="object"&&console.warn&&console.warn("Could not load image ".concat(this.imageUrl,`. 
`).concat(_)),[3,7];case 7:return[2]}}))}))},e.prototype.getBoundingBoxCore=function(n){return Xd(this.element,n)},e.prototype.computeNodeTransformCore=function(n){return n.pdf.unitMatrix},e.prototype.isVisible=function(n,i){return ll(this,n,i)},e.fetchImageData=function(n){return ei(this,void 0,void 0,(function(){var i,r,s,a,o;return ti(this,(function(l){switch(l.label){case 0:if(!(s=n.match(iR)))return[3,1];if(a=s[2],(o=a.split("/"))[0]!=="image")throw new Error("Unsupported image URL: ".concat(n));return r=o[1],i=s[5],s[4]==="base64"?(i=i.replace(/\s/g,""),i=atob(i)):i=decodeURIComponent(i),[3,3];case 1:return[4,e.fetchImage(n)];case 2:i=l.sent(),r=n.substring(n.lastIndexOf(".")+1),l.label=3;case 3:return[2,{data:i,format:r}]}}))}))},e.fetchImage=function(n){return new Promise((function(i,r){var s=new XMLHttpRequest;s.open("GET",n,!0),s.responseType="arraybuffer",s.onload=function(){if(s.status!==200)throw new Error("Error ".concat(s.status,": Failed to load image '").concat(n,"'"));for(var a=new Uint8Array(s.response),o="",l=0;l<a.length;l++)o+=String.fromCharCode(a[l]);i(o)},s.onerror=r,s.onabort=r,s.send(null)}))},e.getMimeType=function(n){switch(n=n.toLowerCase()){case"jpg":case"jpeg":return"image/jpeg";default:return"image/".concat(n)}},e.getImageDimensions=function(n){return new Promise((function(i,r){var s=new Image;s.onload=function(){i([s.width,s.height])},s.onerror=r,s.src=n}))},e})(Sp),d_=(function(t){function e(n,i,r){var s=t.call(this,!0,i,r)||this;return s.closed=n,s}return Yn(e,t),e.prototype.getPath=function(n){if(!this.element.hasAttribute("points")||this.element.getAttribute("points")==="")return null;var i=e.parsePointsString(this.element.getAttribute("points")),r=new Tu;if(i.length<1)return r;r.moveTo(i[0][0],i[0][1]);for(var s=1;s<i.length;s++)r.lineTo(i[s][0],i[s][1]);return this.closed&&r.close(),r},e.prototype.isVisible=function(n,i){return ll(this,n,i)},e.prototype.computeNodeTransformCore=function(n){return n.pdf.unitMatrix},e.parsePointsString=function(n){for(var i=ia(n),r=[],s=0;s<i.length-1;s+=2){var a=i[s],o=i[s+1];r.push([a,o])}return r},e})(Zd),sR=(function(t){function e(n,i){return t.call(this,!0,n,i)||this}return Yn(e,t),e})(d_),aR=(function(t){function e(){return t!==null&&t.apply(this,arguments)||this}return Yn(e,t),e.prototype.render=function(n){return Promise.resolve()},e.prototype.getBoundingBoxCore=function(n){return[0,0,0,0]},e.prototype.computeNodeTransformCore=function(n){return n.pdf.unitMatrix},e.prototype.isVisible=function(n,i){return ll(this,n,i)},e})(h0),oR=(function(t){function e(){return t!==null&&t.apply(this,arguments)||this}return Yn(e,t),e.prototype.apply=function(n){return ei(this,void 0,void 0,(function(){var i,r,s,a,o,l;return ti(this,(function(c){switch(c.label){case 0:i=this.computeNodeTransform(n),r=this.getBoundingBox(n),n.pdf.beginFormObject(r[0],r[1],r[2],r[3],i),s=Mu.getContextColors(n),(function(u){var f=u.attributeState,h=u.pdf,d=1,y=1;d*=f.fillOpacity,d*=f.opacity,f.fill instanceof Pr&&f.fill.color.a!==void 0&&(d*=f.fill.color.a),y*=f.strokeOpacity,y*=f.opacity,f.stroke instanceof Pr&&f.stroke.color.a!==void 0&&(y*=f.stroke.color.a);var m,x={};if(x.opacity=d,x["stroke-opacity"]=y,h.setGState(new Ec(x)),f.fill&&f.fill instanceof Pr&&f.fill.color.ok?h.setFillColor(f.fill.color.r,f.fill.color.g,f.fill.color.b):h.setFillColor(0,0,0),h.setLineWidth(f.strokeWidth),f.stroke instanceof Pr?h.setDrawColor(f.stroke.color.r,f.stroke.color.g,f.stroke.color.b):h.setDrawColor(0,0,0),h.setLineCap(f.strokeLinecap),h.setLineJoin(f.strokeLinejoin),f.strokeDasharray?h.setLineDashPattern(f.strokeDasharray,f.strokeDashoffset):h.setLineDashPattern([],0),h.setLineMiterLimit(f.strokeMiterlimit),m=tl.hasOwnProperty(f.fontFamily)?tl[f.fontFamily]:f.fontFamily,f.fill&&f.fill instanceof Pr&&f.fill.color.ok){var w=f.fill.color;h.setTextColor(w.r,w.g,w.b)}else h.setTextColor(0,0,0);var S="";f.fontWeight==="bold"&&(S="bold"),f.fontStyle==="italic"&&(S+="italic"),S===""&&(S="normal"),m!==void 0||S!==void 0?(m===void 0&&(m=tl.hasOwnProperty(f.fontFamily)?tl[f.fontFamily]:f.fontFamily),h.setFont(m,S)):h.setFont("helvetica",S),h.setFontSize(f.fontSize*h.internal.scaleFactor)})(a=new Ql(n.pdf,{refsHandler:n.refsHandler,styleSheets:n.styleSheets,viewport:n.viewport,svg2pdfParameters:n.svg2pdfParameters,textMeasure:n.textMeasure,attributeState:Object.assign(Mu.default(),s)})),o=0,l=this.children,c.label=1;case 1:return o<l.length?[4,l[o].render(a)]:[3,4];case 2:c.sent(),c.label=3;case 3:return o++,[3,1];case 4:return n.pdf.endFormObject(a.refsHandler.generateKey(this.element.getAttribute("id"),s)),[2]}}))}))},e.prototype.getBoundingBoxCore=function(n){var i,r=this.element.getAttribute("viewBox");return r&&(i=ia(r)),[i&&i[0]||0,i&&i[1]||0,i&&i[2]||parseFloat(this.element.getAttribute("markerWidth")||"3"),i&&i[3]||parseFloat(this.element.getAttribute("markerHeight")||"3")]},e.prototype.computeNodeTransformCore=function(n){var i,r=parseFloat(this.element.getAttribute("refX")||"0"),s=parseFloat(this.element.getAttribute("refY")||"0"),a=this.element.getAttribute("viewBox");if(a){var o=ia(a);i=Yd(this.element,o,0,0,parseFloat(this.element.getAttribute("markerWidth")||"3"),parseFloat(this.element.getAttribute("markerHeight")||"3"),n,!0),i=n.pdf.matrixMult(n.pdf.Matrix(1,0,0,1,-r,-s),i)}else i=n.pdf.Matrix(1,0,0,1,-r,-s);return i},e.prototype.isVisible=function(n,i){return $l(this,n,i)},e})(Kd),lR=(function(t){function e(n,i){return t.call(this,n,i)||this}return Yn(e,t),e.prototype.getR=function(n){var i;return(i=this.r)!==null&&i!==void 0?i:this.r=parseFloat(lt(this.element,n.styleSheets,"r")||"0")},e.prototype.getRx=function(n){return this.getR(n)},e.prototype.getRy=function(n){return this.getR(n)},e})(c_),cR=(function(t){function e(n,i){return t.call(this,!1,n,i)||this}return Yn(e,t),e})(d_),f_=(function(t){function e(){return t!==null&&t.apply(this,arguments)||this}return Yn(e,t),e.prototype.renderCore=function(n){return ei(this,void 0,void 0,(function(){var i,r;return ti(this,(function(s){switch(s.label){case 0:i=0,r=this.children,s.label=1;case 1:return i<r.length?[4,r[i].render(n)]:[3,4];case 2:s.sent(),s.label=3;case 3:return i++,[3,1];case 4:return[2]}}))}))},e.prototype.getBoundingBoxCore=function(n){return f0(n,this)},e})(o_),uR=(function(t){function e(){return t!==null&&t.apply(this,arguments)||this}return Yn(e,t),e.prototype.isVisible=function(n,i){return $l(this,n,i)},e.prototype.render=function(n){return ei(this,void 0,void 0,(function(){var i,r,s,a,o;return ti(this,(function(l){switch(l.label){case 0:return this.isVisible(n.attributeState.visibility!=="hidden",n)?(i=this.getX(n),r=this.getY(n),s=this.getWidth(n),a=this.getHeight(n),n.pdf.saveGraphicsState(),o=n.transform,this.element.hasAttribute("transform")&&(o=n.pdf.matrixMult(_p(this.element.getAttribute("transform"),n),o)),n.pdf.setCurrentTransformationMatrix(o),n.withinUse||lt(this.element,n.styleSheets,"overflow")==="visible"||n.pdf.rect(i,r,s,a).clip().discardPath(),[4,t.prototype.render.call(this,n.clone({transform:n.pdf.unitMatrix,viewport:n.withinUse?n.viewport:new kp(s,a)}))]):[2];case 1:return l.sent(),n.pdf.restoreGraphicsState(),[2]}}))}))},e.prototype.computeNodeTransform=function(n){return this.computeNodeTransformCore(n)},e.prototype.computeNodeTransformCore=function(n){if(n.withinUse)return n.pdf.unitMatrix;var i,r=this.getX(n),s=this.getY(n),a=this.getViewBox();if(a){var o=this.getWidth(n),l=this.getHeight(n);i=Yd(this.element,a,r,s,o,l,n)}else i=n.pdf.Matrix(1,0,0,1,r,s);return i},e.prototype.getWidth=function(n){if(this.width!==void 0)return this.width;var i,r,s=n.svg2pdfParameters;if(this.isOutermostSvg(n))if(s.width!=null)i=s.width;else if(r=lt(this.element,n.styleSheets,"width"))i=parseFloat(r);else{var a=this.getViewBox();if(a&&(s.height!=null||lt(this.element,n.styleSheets,"height"))){var o=a[2]/a[3];i=this.getHeight(n)*o}else i=Math.min(300,n.viewport.width,2*n.viewport.height)}else i=(r=lt(this.element,n.styleSheets,"width"))?parseFloat(r):n.viewport.width;return this.width=i},e.prototype.getHeight=function(n){if(this.height!==void 0)return this.height;var i,r,s=n.svg2pdfParameters;if(this.isOutermostSvg(n))if(s.height!=null)i=s.height;else if(r=lt(this.element,n.styleSheets,"height"))i=parseFloat(r);else{var a=this.getViewBox();if(a){var o=a[2]/a[3];i=this.getWidth(n)/o}else i=Math.min(150,n.viewport.width/2,n.viewport.height)}else i=(r=lt(this.element,n.styleSheets,"height"))?parseFloat(r):n.viewport.height;return this.height=i},e.prototype.getX=function(n){if(this.x!==void 0)return this.x;if(this.isOutermostSvg(n))return this.x=0;var i=lt(this.element,n.styleSheets,"x");return this.x=i?parseFloat(i):0},e.prototype.getY=function(n){if(this.y!==void 0)return this.y;if(this.isOutermostSvg(n))return this.y=0;var i=lt(this.element,n.styleSheets,"y");return this.y=i?parseFloat(i):0},e.prototype.getViewBox=function(){if(this.viewBox!==void 0)return this.viewBox;var n=this.element.getAttribute("viewBox");return this.viewBox=n?ia(n):void 0},e.prototype.isOutermostSvg=function(n){return n.svg2pdfParameters.element===this.element},e})(f_),h_=(function(t){function e(){return t!==null&&t.apply(this,arguments)||this}return Yn(e,t),e.prototype.isVisible=function(n,i){return $l(this,n,i)},e.prototype.computeNodeTransformCore=function(n){return n.pdf.unitMatrix},e})(f_),dR=(function(t){function e(){return t!==null&&t.apply(this,arguments)||this}return Yn(e,t),e.prototype.renderCore=function(n){return ei(this,void 0,void 0,(function(){var i,r,s,a;return ti(this,(function(o){switch(o.label){case 0:return[4,t.prototype.renderCore.call(this,n)];case 1:return o.sent(),(i=lt(this.element,n.styleSheets,"href"))&&(r=this.getBoundingBox(n),s=n.pdf.internal.scaleFactor,a=n.pdf.internal.pageSize.getHeight(),n.pdf.link(s*(r[0]*n.transform.sx+n.transform.tx),a-s*(r[1]*n.transform.sy+n.transform.ty),s*r[2],s*r[3],{url:i})),[2]}}))}))},e})(h_),fR=(function(t){function e(){return t!==null&&t.apply(this,arguments)||this}return Yn(e,t),e.prototype.apply=function(n){return ei(this,void 0,void 0,(function(){var i,r,s,a,o;return ti(this,(function(l){switch(l.label){case 0:if(!this.isVisible(!0,n))return[2];i=n.pdf.matrixMult(this.computeNodeTransform(n),n.transform),n.pdf.setCurrentTransformationMatrix(i),r=0,s=this.children,l.label=1;case 1:return r<s.length?[4,s[r].render(new Ql(n.pdf,{refsHandler:n.refsHandler,styleSheets:n.styleSheets,viewport:n.viewport,withinClipPath:!0,svg2pdfParameters:n.svg2pdfParameters,textMeasure:n.textMeasure}))]:[3,4];case 2:l.sent(),l.label=3;case 3:return r++,[3,1];case 4:return a=this.children.length>0&&!!lt(this.children[0].element,n.styleSheets,"clip-rule"),o=a?this.getClipRuleAttr(this.children[0].element,n.styleSheets):this.getClipRuleAttr(this.element,n.styleSheets),n.pdf.clip(o).discardPath(),n.pdf.setCurrentTransformationMatrix(i.inversed()),[2]}}))}))},e.prototype.getBoundingBoxCore=function(n){return f0(n,this)},e.prototype.isVisible=function(n,i){return $l(this,n,i)},e.prototype.getClipRuleAttr=function(n,i){return lt(n,i,"clip-rule")==="evenodd"?"evenodd":void 0},e})(Kd);function m0(t,e){var n,i=[];switch((function(s,a){for(var o=[],l=0;l<s.childNodes.length;l++){var c=s.childNodes[l];c.nodeName.charAt(0)!=="#"&&o.push(c)}for(l=0;l<o.length;l++)a(l,o[l])})(t,(function(s,a){return i.push(m0(a,e))})),t.tagName.toLowerCase()){case"a":n=new dR(t,i);break;case"g":n=new h_(t,i);break;case"circle":n=new lR(t,i);break;case"clippath":n=new fR(t,i);break;case"ellipse":n=new eR(t,i);break;case"lineargradient":n=new n_(t,i);break;case"image":n=new rR(t,i);break;case"line":n=new JF(t,i);break;case"marker":n=new oR(t,i);break;case"path":n=new nR(t,i);break;case"pattern":n=new r_(t,i);break;case"polygon":n=new sR(t,i);break;case"polyline":n=new cR(t,i);break;case"radialgradient":n=new i_(t,i);break;case"rect":n=new $F(t,i);break;case"svg":n=new uR(t,i);break;case"symbol":n=new l_(t,i);break;case"text":n=new tR(t,i);break;case"use":n=new QF(t,i);break;default:n=new aR(t,i)}if(e!=null&&n.element.hasAttribute("id")){var r=Zx(n.element.id,{isIdentifier:!0});e[r]=e[r]||n}return n.children.forEach((function(s){return s.setParent(n)})),n}var hR=(function(){function t(e,n){this.rootSvg=e,this.loadExternalSheets=n,this.styleSheets=[]}return t.prototype.load=function(){return ei(this,void 0,void 0,(function(){var e;return ti(this,(function(n){switch(n.label){case 0:return[4,this.collectStyleSheetTexts()];case 1:return e=n.sent(),this.parseCssSheets(e),[2]}}))}))},t.prototype.collectStyleSheetTexts=function(){return ei(this,void 0,void 0,(function(){var e,n,i,r,s;return ti(this,(function(a){switch(a.label){case 0:if(e=[],this.loadExternalSheets&&this.rootSvg.ownerDocument)for(r=0;r<this.rootSvg.ownerDocument.childNodes.length;r++)(n=this.rootSvg.ownerDocument.childNodes[r]).nodeName==="xml-stylesheet"&&typeof n.data=="string"&&e.push(t.loadSheet(n.data.match(/href=["'].*?["']/)[0].split("=")[1].slice(1,-1)));for(i=this.rootSvg.querySelectorAll("style,link"),r=0;r<i.length;r++)Xl(s=i[r],"style")?e.push(s.textContent):this.loadExternalSheets&&Xl(s,"link")&&s.getAttribute("rel")==="stylesheet"&&s.hasAttribute("href")&&e.push(t.loadSheet(s.getAttribute("href")));return[4,Promise.all(e)];case 1:return[2,a.sent().filter((function(o){return o!==null}))]}}))}))},t.prototype.parseCssSheets=function(e){for(var n=document.implementation.createHTMLDocument(""),i=0,r=e;i<r.length;i++){var s=r[i],a=n.createElement("style");a.textContent=s,n.body.appendChild(a);var o=a.sheet;if(o instanceof CSSStyleSheet){for(var l=o.cssRules.length-1;l>=0;l--){var c=o.cssRules[l];if(c instanceof CSSStyleRule){var u=c;if(u.selectorText.indexOf(",")>=0){o.deleteRule(l);for(var f=u.cssText.substring(u.selectorText.length),h=t.splitSelectorAtCommas(u.selectorText),d=0;d<h.length;d++)o.insertRule(h[d]+f,l+d)}}else o.deleteRule(l)}this.styleSheets.push(o)}}},t.splitSelectorAtCommas=function(e){for(var n,i=/,|["']/g,r=/[^\\]["]/g,s=/[^\\][']/g,a=[],o="initial",l=-1,c=r,u=0;u<e.length;)switch(o){case"initial":i.lastIndex=u,(n=i.exec(e))?(n[0]===","?(a.push(e.substring(l+1,i.lastIndex-1).trim()),l=i.lastIndex-1):(o="withinQuotes",c=n[0]==='"'?r:s),u=i.lastIndex):(a.push(e.substring(l+1).trim()),u=e.length);break;case"withinQuotes":c.lastIndex=u,(n=c.exec(e))&&(u=c.lastIndex,o="initial")}return a},t.loadSheet=function(e){return new Promise((function(n,i){var r=new XMLHttpRequest;r.open("GET",e,!0),r.responseType="text",r.onload=function(){r.status!==200&&i(new Error("Error ".concat(r.status,": Failed to load '").concat(e,"'"))),n(r.responseText)},r.onerror=i,r.onabort=i,r.send(null)})).catch((function(){return null}))},t.prototype.getPropertyValue=function(e,n){for(var i=[],r=0,s=this.styleSheets;r<s.length;r++)for(var a=s[r],o=0;o<a.cssRules.length;o++){var l=a.cssRules[o];l.style.getPropertyValue(n)&&e.matches(l.selectorText)&&i.push(l)}if(i.length!==0)return i.reduce((function(c,u){return h=u,((d=(f=c).style.getPropertyPriority(n))!==h.style.getPropertyPriority(n)?d==="important"?1:-1:WF(f.selectorText,h.selectorText))===1?c:u;var f,h,d})).style.getPropertyValue(n)||void 0},t})(),pR=(function(){function t(){this.measureMethods={}}return t.prototype.getTextOffset=function(e,n){var i=n.textAnchor;if(i==="start")return 0;var r=this.measureTextWidth(e,n),s=0;switch(i){case"end":s=r;break;case"middle":s=r/2}return s},t.prototype.measureTextWidth=function(e,n){if(e.length===0)return 0;var i=n.fontFamily;return this.getMeasureFunction(i).call(this,e,n.fontFamily,n.fontSize+"px",n.fontStyle,n.fontWeight)},t.prototype.getMeasurementTextNode=function(){if(!this.textMeasuringTextElement){this.textMeasuringTextElement=document.createElementNS(jy,"text");var e=document.createElementNS(jy,"svg");e.appendChild(this.textMeasuringTextElement),e.style.setProperty("position","absolute"),e.style.setProperty("visibility","hidden"),document.body.appendChild(e)}return this.textMeasuringTextElement},t.prototype.canvasTextMeasure=function(e,n,i,r,s){var a=document.createElement("canvas").getContext("2d");return a!=null?(a.font=[r,s,i,n].join(" "),a.measureText(e).width):0},t.prototype.svgTextMeasure=function(e,n,i,r,s,a){a===void 0&&(a=this.getMeasurementTextNode());var o=a;return o.setAttribute("font-family",n),o.setAttribute("font-size",i),o.setAttribute("font-style",r),o.setAttribute("font-weight",s),o.setAttributeNS("http://www.w3.org/XML/1998/namespace","xml:space","preserve"),o.textContent=e,o.getBBox().width},t.prototype.getMeasureFunction=function(e){var n=this.measureMethods[e];if(!n){var i="16px",r="normal",s="normal",a=this.canvasTextMeasure(t.testString,e,i,r,s),o=this.svgTextMeasure(t.testString,e,i,r,s);n=Math.abs(a-o)<t.epsilon?this.canvasTextMeasure:this.svgTextMeasure,this.measureMethods[e]=n}return n},t.prototype.cleanupTextMeasuring=function(){if(this.textMeasuringTextElement){var e=this.textMeasuringTextElement.parentNode;e&&document.body.removeChild(e),this.textMeasuringTextElement=void 0}},t.testString=`abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ 0123456789!"$%&/()=?'\\+*-_.:,;^}][{#~|<>`,t.epsilon=.1,t})();function gR(t,e){return ei(this,arguments,void 0,(function(n,i,r){var s,a,o,l,c,u,f,h,d,y,m,x,w,S;return r===void 0&&(r={}),ti(this,(function(A){switch(A.label){case 0:return s=(x=r.x)!==null&&x!==void 0?x:0,a=(w=r.y)!==null&&w!==void 0?w:0,o=(S=r.loadExternalStyleSheets)!==null&&S!==void 0&&S,c=new Qx(l={}),[4,(u=new hR(n,o)).load()];case 1:return A.sent(),f=new kp(i.internal.pageSize.getWidth(),i.internal.pageSize.getHeight()),h=Gh(Gh({},r),{element:n}),d=new pR,y=new Ql(i,{refsHandler:c,styleSheets:u,viewport:f,svg2pdfParameters:h,textMeasure:d}),i.advancedAPI(),i.saveGraphicsState(),i.setCurrentTransformationMatrix(i.Matrix(1,0,0,1,s,a)),i.setLineWidth(y.attributeState.strokeWidth),m=y.attributeState.fill.color,i.setFillColor(m.r,m.g,m.b),i.setFont(y.attributeState.fontFamily),i.setFontSize(y.attributeState.fontSize*i.internal.scaleFactor),[4,m0(n,l).render(y)];case 2:return A.sent(),i.restoreGraphicsState(),i.compatAPI(),y.textMeasure.cleanupTextMeasuring(),[2,i]}}))}))}qt.API.svg=function(t,e){return e===void 0&&(e={}),gR(t,this,e)};var Ic="http://www.w3.org/2000/svg",Lc="http://www.w3.org/1999/xlink",mR="http://www.w3.org/2000/xmlns/";function $m(t){return t.nodeType===Node.ELEMENT_NODE}function p_(t){return t.nodeType===Node.TEXT_NODE}function vR(t){return t.namespaceURI===Ic}function yR(t){return t instanceof HTMLImageElement}function bR(t){return t instanceof HTMLCanvasElement}function wR(t){return t instanceof HTMLInputElement||t instanceof HTMLTextAreaElement||t instanceof HTMLSelectElement}function bt(t,e){return t.createElementNS(Ic,e)}function Zt(t,e){for(const[n,i]of Object.entries(e))t.setAttribute(n,String(i)),n==="href"&&t.setAttributeNS(Lc,"xlink:href",String(i))}function xR(t,e){return window.getComputedStyle(t,e)}var _R=0;function SR(){return{next(t="d2s"){return`${t}-${_R++}`}}}function kR(t){return t.display==="none"}function AR(t){return t.visibility==="hidden"}function Vf(t,e,n){return{width:parseFloat(t)||0,style:e,color:n}}function NR(t){return{top:Vf(t.borderTopWidth,t.borderTopStyle,t.borderTopColor),right:Vf(t.borderRightWidth,t.borderRightStyle,t.borderRightColor),bottom:Vf(t.borderBottomWidth,t.borderBottomStyle,t.borderBottomColor),left:Vf(t.borderLeftWidth,t.borderLeftStyle,t.borderLeftColor)}}function g_(t){return{topLeft:Gf(t.borderTopLeftRadius),topRight:Gf(t.borderTopRightRadius),bottomRight:Gf(t.borderBottomRightRadius),bottomLeft:Gf(t.borderBottomLeftRadius)}}function Gf(t){const e=t.split(/\s+/).map(n=>parseFloat(n)||0);return[e[0]??0,e[1]??e[0]??0]}function CR(t){return t.top.width>0&&t.top.style!=="none"||t.right.width>0&&t.right.style!=="none"||t.bottom.width>0&&t.bottom.style!=="none"||t.left.width>0&&t.left.style!=="none"}function Yl(t){return t.topLeft[0]>0||t.topLeft[1]>0||t.topRight[0]>0||t.topRight[1]>0||t.bottomRight[0]>0||t.bottomRight[1]>0||t.bottomLeft[0]>0||t.bottomLeft[1]>0}function Fd(t){const[e,n]=t.topLeft;return t.topRight[0]===e&&t.topRight[1]===n&&t.bottomRight[0]===e&&t.bottomRight[1]===n&&t.bottomLeft[0]===e&&t.bottomLeft[1]===n}function m_(t){const e=new Set(["hidden","clip","scroll","auto"]);return e.has(t.overflow)||e.has(t.overflowX)||e.has(t.overflowY)}function Xh(t){const e=t.backgroundColor;return!e||e==="transparent"||e==="rgba(0, 0, 0, 0)"?null:e}function v_(t){return!!t.backgroundImage&&t.backgroundImage!=="none"}function PR(t){return!!(t.position!=="static"&&t.position!==""&&t.zIndex!=="auto"||parseFloat(t.opacity)<1||t.transform&&t.transform!=="none"||t.filter&&t.filter!=="none"||t.isolation==="isolate"||t.mixBlendMode&&t.mixBlendMode!=="normal")}function ER(t){return t.zIndex==="auto"||!t.zIndex?0:parseInt(t.zIndex,10)||0}function IR(t){return t.position!=="static"&&t.position!==""}function LR(t){return t.cssFloat!=="none"&&t.cssFloat!==""}function y_(t,e,n){const i=t.topLeft[0]+t.topRight[0],r=t.bottomLeft[0]+t.bottomRight[0],s=t.topLeft[1]+t.bottomLeft[1],a=t.topRight[1]+t.bottomRight[1];let o=1;return i>0&&(o=Math.min(o,e/i)),r>0&&(o=Math.min(o,e/r)),s>0&&(o=Math.min(o,n/s)),a>0&&(o=Math.min(o,n/a)),o>=1?t:{topLeft:[t.topLeft[0]*o,t.topLeft[1]*o],topRight:[t.topRight[0]*o,t.topRight[1]*o],bottomRight:[t.bottomRight[0]*o,t.bottomRight[1]*o],bottomLeft:[t.bottomLeft[0]*o,t.bottomLeft[1]*o]}}function MR(t){const e=t.display;return e==="inline"||e==="inline-block"||e==="inline-flex"||e==="inline-grid"||e==="inline-table"}function b_(t,e){const n=t.getBoundingClientRect(),i=e.getBoundingClientRect();return{x:n.left-i.left,y:n.top-i.top,width:n.width,height:n.height}}function Jd(t,e,n,i,r){const[s,a]=r.topLeft,[o,l]=r.topRight,[c,u]=r.bottomRight,[f,h]=r.bottomLeft;return[`M ${t+s} ${e}`,`L ${t+n-o} ${e}`,o||l?`A ${o} ${l} 0 0 1 ${t+n} ${e+l}`:"",`L ${t+n} ${e+i-u}`,c||u?`A ${c} ${u} 0 0 1 ${t+n-c} ${e+i}`:"",`L ${t+f} ${e+i}`,f||h?`A ${f} ${h} 0 0 1 ${t} ${e+i-h}`:"",`L ${t} ${e+a}`,s||a?`A ${s} ${a} 0 0 1 ${t+s} ${e}`:"","Z"].filter(Boolean).join(" ")}function TR(t){const e=t.match(/linear-gradient\((.+)\)/);if(!e)return null;const n=e[1],i=y0(n);if(i.length<2)return null;let r=180,s=0;const a=i[0].trim();a.startsWith("to ")?(r=BR(a),s=1):a.match(/^-?[\d.]+(?:deg|rad|turn|grad)/)&&(r=w_(a),s=1);const o=[],l=i.slice(s);for(let c=0;c<l.length;c++){const{color:u,position:f}=v0(l[c].trim(),c,l.length);o.push({color:u,position:f})}return{angle:r,stops:o}}function DR(t,e,n){const i=n.idGenerator.next("grad"),r=bt(n.svgDocument,"linearGradient"),s=e.x+e.width/2,a=e.y+e.height/2,o=t.angle*Math.PI/180,l=Math.sin(o),c=-Math.cos(o),u=Math.abs(e.width/2*l)+Math.abs(e.height/2*c),f=s-l*u,h=a-c*u,d=s+l*u,y=a+c*u;Zt(r,{id:i,gradientUnits:"userSpaceOnUse",x1:f.toFixed(2),y1:h.toFixed(2),x2:d.toFixed(2),y2:y.toFixed(2)});for(const m of t.stops){const x=bt(n.svgDocument,"stop");Zt(x,{offset:`${(m.position*100).toFixed(1)}%`,"stop-color":m.color}),r.appendChild(x)}return n.defs.appendChild(r),r}function OR(t,e,n){return t.includes("conic-gradient")?FR(t,e,n):t.includes("radial-gradient")?RR(t,e,n):null}function FR(t,e,n){const i=t.match(/conic-gradient\((.+)\)/);if(!i)return null;const r=2,s=document.createElement("canvas");s.width=Math.ceil(e*r),s.height=Math.ceil(n*r);const a=s.getContext("2d");if(!a||!("createConicGradient"in a))return null;a.scale(r,r);const o=i[1],l=y0(o);let c=0,u=0;const h=l[0].trim().match(/^from\s+(-?[\d.]+)(deg|rad|turn|grad)/);h&&(c=w_(h[1]+h[2]),u=1);const d=e/2,y=n/2,m=(c-90)*Math.PI/180,x=a.createConicGradient(m,d,y),w=l.slice(u);for(let S=0;S<w.length;S++){const A=w[S].trim(),{color:_,position:M}=v0(A,S,w.length);try{x.addColorStop(M,_)}catch{}}return a.fillStyle=x,a.fillRect(0,0,e,n),s.toDataURL("image/png")}function RR(t,e,n){const i=t.match(/radial-gradient\((.+)\)/);if(!i)return null;const r=2,s=document.createElement("canvas");s.width=Math.ceil(e*r),s.height=Math.ceil(n*r);const a=s.getContext("2d");if(!a)return null;a.scale(r,r);const o=i[1],l=y0(o);let c=!1,u=0,f=null,h=null;const d=l[0].trim();if(d==="circle"||d.startsWith("circle ")?(c=!0,u=1):(d==="ellipse"||d.startsWith("ellipse ")||d.includes("at ")&&!d.includes("#")&&!d.match(/^(rgb|hsl)/))&&(u=1),u===1){const M=d.match(/at\s+(.+)/);if(M){const I=M[1].trim().split(/\s+/);f=Gy(I[0],e),h=Gy(I[1]??I[0],n)}}const y=f??e/2,m=h??n/2,x=e/2,w=n/2,S=c?Math.sqrt(x*x+w*w):Math.max(x,w);a.save(),!c&&x!==w&&(a.translate(y,m),a.scale(x/S,w/S),a.translate(-y,-m));const A=a.createRadialGradient(y,m,0,y,m,S),_=l.slice(u);for(let M=0;M<_.length;M++){const I=_[M].trim(),{color:T,position:D}=v0(I,M,_.length);try{A.addColorStop(D,T)}catch{}}if(a.fillStyle=A,!c&&x!==w){const M=S/x,I=S/w;a.fillRect(y*(1-M),m*(1-I),e*M,n*I)}else a.fillRect(0,0,e,n);return a.restore(),s.toDataURL("image/png")}function v0(t,e,n){const i=t.lastIndexOf(")"),s=(i>=0?t.slice(i+1):t).match(/\s+([\d.]+%)\s*$/);if(s){const a=s[1],o=t.length-s[0].length;return{color:t.slice(0,o).trim(),position:parseFloat(a)/100}}if(i<0){const a=t.lastIndexOf(" ");if(a>0&&t.slice(a).match(/[\d.]+%/))return{color:t.slice(0,a).trim(),position:parseFloat(t.slice(a))/100}}return{color:t,position:n>1?e/(n-1):0}}function y0(t){const e=[];let n=0,i="";for(const r of t)r==="("?n++:r===")"&&n--,r===","&&n===0?(e.push(i),i=""):i+=r;return i&&e.push(i),e}function BR(t){return{"to top":0,"to right":90,"to bottom":180,"to left":270,"to top right":45,"to top left":315,"to bottom right":135,"to bottom left":225}[t]??180}function w_(t){return t.endsWith("deg")?parseFloat(t):t.endsWith("rad")?parseFloat(t)*180/Math.PI:t.endsWith("turn")?parseFloat(t)*360:t.endsWith("grad")?parseFloat(t)*.9:parseFloat(t)}function Gy(t,e){if(t==="center")return e/2;if(t==="left"||t==="top")return 0;if(t==="right"||t==="bottom")return e;if(t.endsWith("%"))return parseFloat(t)/100*e;const n=parseFloat(t);return isNaN(n)?null:n}var Xy=1e4,rm=4096;async function b0(t){return t.startsWith("data:")?t:new Promise(e=>{const n=new Image;n.crossOrigin="anonymous";const i=setTimeout(()=>{console.warn(`dom2svg: Image load timed out after ${Xy}ms, using original URL: ${t}`),n.onload=null,n.onerror=null,e(t)},Xy);n.onload=()=>{clearTimeout(i);try{const r=document.createElement("canvas");let s=n.naturalWidth,a=n.naturalHeight;if(s>rm||a>rm){const l=rm/Math.max(s,a);s=Math.round(s*l),a=Math.round(a*l)}r.width=s,r.height=a;const o=r.getContext("2d");o?(o.drawImage(n,0,0,s,a),e(r.toDataURL("image/png"))):e(t)}catch{console.warn(`dom2svg: CORS prevented inlining image, external URL will remain in SVG: ${t}`),e(t)}},n.onerror=()=>{clearTimeout(i),console.warn(`dom2svg: Failed to load image, external URL will remain in SVG: ${t}`),e(t)},n.src=t})}function x_(t){return t.match(/url\(["']?([^"')]+)["']?\)/)?.[1]??null}function zR(t){try{return t.toDataURL("image/png")}catch{return""}}function qR(t){if(!t||t==="none")return[];const e=[],n=/(\w+)\(([^)]+)\)/g;let i;for(;(i=n.exec(t))!==null;){const r=i[1],s=i[2].split(",").map(a=>a.trim());switch(r){case"matrix":{const a=s.map(parseFloat);a.length===6&&e.push({type:"matrix",values:a});break}case"translate":{const a=Xf(s[0]),o=s[1]?Xf(s[1]):0;e.push({type:"translate",x:a,y:o});break}case"translateX":{e.push({type:"translate",x:Xf(s[0]),y:0});break}case"translateY":{e.push({type:"translate",x:0,y:Xf(s[0])});break}case"scale":{const a=parseFloat(s[0]),o=s[1]?parseFloat(s[1]):a;e.push({type:"scale",x:a,y:o});break}case"scaleX":{e.push({type:"scale",x:parseFloat(s[0]),y:1});break}case"scaleY":{e.push({type:"scale",x:1,y:parseFloat(s[0])});break}case"rotate":{e.push({type:"rotate",angle:sm(s[0])});break}case"skewX":{e.push({type:"skewX",angle:sm(s[0])});break}case"skewY":{e.push({type:"skewY",angle:sm(s[0])});break}}}return e}function Xf(t){return parseFloat(t)||0}function sm(t){return t=t.trim(),t.endsWith("rad")?parseFloat(t)*180/Math.PI:t.endsWith("turn")?parseFloat(t)*360:t.endsWith("grad")?parseFloat(t)*.9:parseFloat(t)||0}function jR(){return[1,0,0,1,0,0]}function am(t,e){return[t[0]*e[0]+t[2]*e[1],t[1]*e[0]+t[3]*e[1],t[0]*e[2]+t[2]*e[3],t[1]*e[2]+t[3]*e[3],t[0]*e[4]+t[2]*e[5]+t[4],t[1]*e[4]+t[3]*e[5]+t[5]]}function e1(t,e){return[1,0,0,1,t,e]}function HR(t,e){return[t,0,0,e,0,0]}function UR(t){const e=t*Math.PI/180,n=Math.cos(e),i=Math.sin(e);return[n,i,-i,n,0,0]}function WR(t){const e=t*Math.PI/180;return[1,0,Math.tan(e),1,0,0]}function VR(t){const e=t*Math.PI/180;return[1,Math.tan(e),0,1,0,0]}function GR(t){return Math.abs(t[0]-1)<1e-10&&Math.abs(t[1])<1e-10&&Math.abs(t[2])<1e-10&&Math.abs(t[3]-1)<1e-10&&Math.abs(t[4])<1e-10&&Math.abs(t[5])<1e-10}function XR(t){return`matrix(${t.map(e=>e.toFixed(6)).join(",")})`}function YR(t,e,n){const i=qR(t);if(i.length===0)return null;const[r,s]=ZR(e,n);let a=jR();a=am(a,e1(r,s));for(const o of i)a=am(a,KR(o));return a=am(a,e1(-r,-s)),GR(a)?null:XR(a)}function KR(t){switch(t.type){case"matrix":return t.values;case"translate":return e1(t.x,t.y);case"scale":return HR(t.x,t.y);case"rotate":return UR(t.angle);case"skewX":return WR(t.angle);case"skewY":return VR(t.angle)}}function ZR(t,e){const n=t.split(/\s+/),i=Yy(n[0]??"50%",e.width,e.x),r=Yy(n[1]??"50%",e.height,e.y);return[i,r]}function Yy(t,e,n){return t==="left"||t==="top"?n:t==="right"||t==="bottom"?n+e:t==="center"?n+e/2:t.endsWith("%")?n+parseFloat(t)/100*e:n+parseFloat(t)}function JR(t,e){const n=e9(t);if(n.length===0)return null;const i=e.idGenerator.next("filter"),r=bt(e.svgDocument,"filter");Zt(r,{id:i,x:"-50%",y:"-50%",width:"200%",height:"200%"});let s=!1;for(const a of n){const o=$R(a,e);for(const l of o)r.appendChild(l),s=!0}return s?(e.defs.appendChild(r),i):null}function fc(t){const e=t.trim();return e.endsWith("%")?(parseFloat(e)||0)/100:parseFloat(e)||0}function QR(t){const e=t.trim();return e.endsWith("rad")?(parseFloat(e)||0)*(180/Math.PI):e.endsWith("grad")?(parseFloat(e)||0)*.9:e.endsWith("turn")?(parseFloat(e)||0)*360:parseFloat(e)||0}function $R(t,e){switch(t.name){case"blur":{const n=parseFloat(t.args)||0,i=bt(e.svgDocument,"feGaussianBlur");return Zt(i,{stdDeviation:n}),[i]}case"brightness":{const n=fc(t.args);return[om(e,{slope:n})]}case"contrast":{const n=fc(t.args),i=.5-.5*n;return[om(e,{slope:n,intercept:i})]}case"drop-shadow":{const n=t9(`drop-shadow(${t.args})`);if(!n)return[];const i=bt(e.svgDocument,"feDropShadow");return Zt(i,{dx:n.offsetX,dy:n.offsetY,stdDeviation:n.blur/2,"flood-color":n.color,"flood-opacity":1}),[i]}case"grayscale":{const n=fc(t.args),i=Math.max(0,Math.min(1,1-n)),r=bt(e.svgDocument,"feColorMatrix");return Zt(r,{type:"saturate",values:i}),[r]}case"hue-rotate":{const n=QR(t.args),i=bt(e.svgDocument,"feColorMatrix");return Zt(i,{type:"hueRotate",values:n}),[i]}case"invert":{const n=fc(t.args),i=n,r=1-n;return[om(e,{type:"table",tableValues:`${i} ${r}`})]}case"opacity":{const n=fc(t.args),i=bt(e.svgDocument,"feComponentTransfer"),r=bt(e.svgDocument,"feFuncA");return Zt(r,{type:"linear",slope:n,intercept:0}),i.appendChild(r),[i]}case"saturate":{const n=fc(t.args),i=bt(e.svgDocument,"feColorMatrix");return Zt(i,{type:"saturate",values:n}),[i]}case"sepia":{const n=Math.max(0,Math.min(1,fc(t.args))),i=n,r=1-n,s=[r+i*.393,i*.769,i*.189,0,0,i*.349,r+i*.686,i*.168,0,0,i*.272,i*.534,r+i*.131,0,0,0,0,0,1,0].map(o=>o.toFixed(4)).join(" "),a=bt(e.svgDocument,"feColorMatrix");return Zt(a,{type:"matrix",values:s}),[a]}default:return[]}}function om(t,e){const n=bt(t.svgDocument,"feComponentTransfer");for(const i of["feFuncR","feFuncG","feFuncB"]){const r=bt(t.svgDocument,i);if(e.type==="table"&&e.tableValues)Zt(r,{type:"table",tableValues:e.tableValues});else{const s={type:"linear",slope:e.slope??1};e.intercept!==void 0&&(s.intercept=e.intercept),Zt(r,s)}n.appendChild(r)}return n}function e9(t){const e=[],n=/([a-z-]+)\(/gi;let i;for(;(i=n.exec(t))!==null;){const r=i[1],s=i.index+i[0].length;let a=1,o=s;for(;o<t.length&&a>0;o++)t[o]==="("?a++:t[o]===")"&&a--;const l=t.slice(s,o-1).trim();e.push({name:r.toLowerCase(),args:l}),n.lastIndex=o}return e}function t9(t){const e=t.indexOf("drop-shadow(");if(e===-1)return null;const n=e+12;let i=1,r=n;for(let f=n;f<t.length&&i>0;f++)t[f]==="("?i++:t[f]===")"&&i--,i>0&&(r=f+1);const s=t.slice(n,r).trim();if(!s)return null;const a=[];let o="",l=0;for(const f of s)f==="("?l++:f===")"&&l--,f===" "&&l===0&&o?(a.push(o),o=""):o+=f;if(o&&a.push(o),a.length<2)return null;const c=[];let u="rgba(0,0,0,0.3)";for(const f of a){const h=parseFloat(f);!isNaN(h)&&(f.endsWith("px")||f.match(/^-?[\d.]+$/))?c.push(h):u=f}return{offsetX:c[0]??0,offsetY:c[1]??0,blur:c[2]??0,color:u}}function n9(t){if(!t||t==="none")return[];const e=[],n=i9(t);for(const i of n){const r=r9(i.trim());r&&e.push(r)}return e}function i9(t){const e=[];let n=0,i="";for(const r of t)r==="("?n++:r===")"&&n--,r===","&&n===0?(e.push(i),i=""):i+=r;return i&&e.push(i),e}function r9(t){let e=!1,n=t;n.startsWith("inset ")?(e=!0,n=n.slice(6).trim()):n.endsWith(" inset")&&(e=!0,n=n.slice(0,-6).trim());const i=[];let r="",s=0;for(const l of n)l==="("?s++:l===")"&&s--,l===" "&&s===0&&r?(i.push(r),r=""):r+=l;r&&i.push(r);const a=[],o=[];for(const l of i){const c=parseFloat(l);!isNaN(c)&&(l.endsWith("px")||l.match(/^-?[\d.]+$/))?a.push(c):o.push(l)}return a.length<2?null:{inset:e,offsetX:a[0],offsetY:a[1],blur:a[2]??0,spread:a[3]??0,color:o.join(" ")||"rgba(0, 0, 0, 0.3)"}}function s9(t,e,n,i,r){for(let s=t.length-1;s>=0;s--){const a=t[s];a.inset?o9(a,e,n,i,r):a9(a,e,n,i,r)}}function a9(t,e,n,i,r){const s={x:e.x+t.offsetX-t.spread,y:e.y+t.offsetY-t.spread,width:e.width+t.spread*2,height:e.height+t.spread*2},a=__(n,t.spread),o=hh(s,a,i);if(o.setAttribute("fill",t.color),t.blur>0){const l=i.idGenerator.next("shadow"),c=bt(i.svgDocument,"filter"),u=t.blur*2+Math.abs(t.offsetX)+Math.abs(t.offsetY)+t.spread,f=Math.max(s.width,1),h=Math.max(s.height,1);Zt(c,{id:l,x:`-${(u/f*100+10).toFixed(0)}%`,y:`-${(u/h*100+10).toFixed(0)}%`,width:`${(200+u/f*200+20).toFixed(0)}%`,height:`${(200+u/h*200+20).toFixed(0)}%`});const d=bt(i.svgDocument,"feGaussianBlur");Zt(d,{in:"SourceGraphic",stdDeviation:t.blur/2}),c.appendChild(d),i.defs.appendChild(c),o.setAttribute("filter",`url(#${l})`)}r.insertBefore(o,r.firstChild)}function o9(t,e,n,i,r){const s=i.idGenerator.next("inset-clip"),a=bt(i.svgDocument,"clipPath");a.setAttribute("id",s);const o=hh(e,n,i);a.appendChild(o),i.defs.appendChild(a);const l={x:e.x+t.offsetX+t.spread,y:e.y+t.offsetY+t.spread,width:Math.max(0,e.width-t.spread*2),height:Math.max(0,e.height-t.spread*2)},c=__(n,-t.spread),u=bt(i.svgDocument,"g");u.setAttribute("clip-path",`url(#${s})`);const f=bt(i.svgDocument,"rect"),h=t.blur*3+Math.abs(t.offsetX)+Math.abs(t.offsetY)+100;Zt(f,{x:e.x-h,y:e.y-h,width:e.width+h*2,height:e.height+h*2,fill:t.color}),hh(l,c,i).setAttribute("fill",t.color);const y=i.idGenerator.next("inset-mask"),m=bt(i.svgDocument,"mask");m.setAttribute("id",y);const x=bt(i.svgDocument,"rect");Zt(x,{x:e.x-h,y:e.y-h,width:e.width+h*2,height:e.height+h*2,fill:"white"});const w=hh(l,c,i);if(w.setAttribute("fill","black"),m.appendChild(x),m.appendChild(w),i.defs.appendChild(m),f.setAttribute("mask",`url(#${y})`),t.blur>0){const S=i.idGenerator.next("inset-blur"),A=bt(i.svgDocument,"filter");Zt(A,{id:S,x:"-50%",y:"-50%",width:"200%",height:"200%"});const _=bt(i.svgDocument,"feGaussianBlur");Zt(_,{in:"SourceGraphic",stdDeviation:t.blur/2}),A.appendChild(_),i.defs.appendChild(A),f.setAttribute("filter",`url(#${S})`)}u.appendChild(f),r.insertBefore(u,r.firstChild)}function hh(t,e,n){if(Yl(e)&&!Fd(e)){const r=bt(n.svgDocument,"path");return r.setAttribute("d",Jd(t.x,t.y,t.width,t.height,e)),r}const i=bt(n.svgDocument,"rect");return Zt(i,{x:t.x,y:t.y,width:t.width,height:t.height}),Yl(e)&&Fd(e)&&Zt(i,{rx:e.topLeft[0],ry:e.topLeft[1]}),i}function __(t,e){return{topLeft:[Math.max(0,t.topLeft[0]+e),Math.max(0,t.topLeft[1]+e)],topRight:[Math.max(0,t.topRight[0]+e),Math.max(0,t.topRight[1]+e)],bottomRight:[Math.max(0,t.bottomRight[0]+e),Math.max(0,t.bottomRight[1]+e)],bottomLeft:[Math.max(0,t.bottomLeft[0]+e),Math.max(0,t.bottomLeft[1]+e)]}}function Yh(t){const e=t.trim();return e.endsWith("%")?{value:parseFloat(e)||0,isPct:!0}:{value:parseFloat(e)||0,isPct:!1}}function S_(t){if(!t||t==="none")return null;const e=t.match(/^inset\((.+)\)$/);if(e)return l9(e[1]);const n=t.match(/^circle\((.+)\)$/);if(n)return c9(n[1]);const i=t.match(/^ellipse\((.+)\)$/);if(i)return u9(i[1]);const r=t.match(/^polygon\((.+)\)$/);if(r)return d9(r[1]);const s=t.match(/^path\(["']?(.+?)["']?\)$/);return s?{type:"path",d:s[1]}:null}function l9(t){const e=t.indexOf(" round ");let n=t,i;e>=0&&(n=t.slice(0,e),i=t.slice(e+7).trim());const r=n.trim().split(/\s+/).map(c=>parseFloat(c)||0),s=r[0]??0,a=r[1]??s,o=r[2]??s,l=r[3]??a;return{type:"inset",top:s,right:a,bottom:o,left:l,round:i}}function c9(t){const e=t.indexOf(" at ");let n=0,i=0,r=0,s=!1,a=!1;if(e>=0){n=parseFloat(t.slice(0,e))||0;const o=t.slice(e+4).trim().split(/\s+/),l=Yh(o[0]),c=Yh(o[1]);i=l.value,s=l.isPct,r=c.value,a=c.isPct}else n=parseFloat(t)||0,i=50,r=50,s=!0,a=!0;return{type:"circle",radius:n,cx:i,cy:r,cxPct:s,cyPct:a}}function u9(t){const e=t.indexOf(" at ");let n=0,i=0,r=0,s=0,a=!1,o=!1;if(e>=0){const l=t.slice(0,e).trim().split(/\s+/);n=parseFloat(l[0])||0,i=parseFloat(l[1])||0;const c=t.slice(e+4).trim().split(/\s+/),u=Yh(c[0]),f=Yh(c[1]);r=u.value,a=u.isPct,s=f.value,o=f.isPct}else{const l=t.trim().split(/\s+/);n=parseFloat(l[0])||0,i=parseFloat(l[1])||0,r=50,s=50,a=!0,o=!0}return{type:"ellipse",rx:n,ry:i,cx:r,cy:s,cxPct:a,cyPct:o}}function d9(t){let e=t.trim();(e.startsWith("nonzero,")||e.startsWith("evenodd,"))&&(e=e.slice(e.indexOf(",")+1).trim());const n=[],i=e.split(",");for(const r of i){const s=r.trim().split(/\s+/);s.length>=2&&n.push([parseFloat(s[0])||0,parseFloat(s[1])||0])}return n.length<3?null:{type:"polygon",points:n}}function k_(t,e,n){const i=n.idGenerator.next("clip"),r=bt(n.svgDocument,"clipPath");r.setAttribute("id",i);const s=h9(t,e,n,n.compat.inlineClipPathTransforms);return s?(r.appendChild(s),n.defs.appendChild(r),i):null}function f9(t,e,n){return t.replace(/([MLHVCSQTAZmlhvcsqtaz])([^MLHVCSQTAZmlhvcsqtaz]*)/g,(i,r,s)=>{const a=s.match(/-?\d*\.?\d+(?:e[+-]?\d+)?/gi)?.map(Number)??[];if(a.length===0)return r+s;switch(r){case"M":case"L":case"T":for(let o=0;o<a.length-1;o+=2)a[o]+=e,a[o+1]+=n;break;case"H":for(let o=0;o<a.length;o++)a[o]+=e;break;case"V":for(let o=0;o<a.length;o++)a[o]+=n;break;case"C":for(let o=0;o<a.length-1;o+=2)a[o]+=e,a[o+1]+=n;break;case"S":case"Q":for(let o=0;o<a.length-1;o+=2)a[o]+=e,a[o+1]+=n;break;case"A":for(let o=0;o<a.length;o+=7)o+5<a.length&&(a[o+5]+=e),o+6<a.length&&(a[o+6]+=n);break;default:return r+s}return r+a.join(" ")})}function h9(t,e,n,i=!1){switch(t.type){case"inset":{const r=e.x+t.left,s=e.y+t.top,a=Math.max(0,e.width-t.left-t.right),o=Math.max(0,e.height-t.top-t.bottom);if(t.round){const c=t.round.split("/").map(y=>y.trim().split(/\s+/).map(m=>parseFloat(m)||0)),u=c[0]??[0],f=c[1]??u,h={topLeft:[u[0]??0,f[0]??0],topRight:[u[1]??u[0]??0,f[1]??f[0]??0],bottomRight:[u[2]??u[0]??0,f[2]??f[0]??0],bottomLeft:[u[3]??u[1]??u[0]??0,f[3]??f[1]??f[0]??0]},d=bt(n.svgDocument,"path");return d.setAttribute("d",Jd(r,s,a,o,h)),d}const l=bt(n.svgDocument,"rect");return Zt(l,{x:r,y:s,width:a,height:o}),l}case"circle":{const r=t.cxPct?t.cx/100*e.width:t.cx,s=t.cyPct?t.cy/100*e.height:t.cy,a=bt(n.svgDocument,"circle");return Zt(a,{cx:e.x+r,cy:e.y+s,r:t.radius}),a}case"ellipse":{const r=t.cxPct?t.cx/100*e.width:t.cx,s=t.cyPct?t.cy/100*e.height:t.cy,a=bt(n.svgDocument,"ellipse");return Zt(a,{cx:e.x+r,cy:e.y+s,rx:t.rx,ry:t.ry}),a}case"polygon":{const r=bt(n.svgDocument,"polygon"),s=t.points.map(([a,o])=>`${e.x+a},${e.y+o}`).join(" ");return r.setAttribute("points",s),r}case"path":{const r=bt(n.svgDocument,"path");return i&&(e.x!==0||e.y!==0)?r.setAttribute("d",f9(t.d,e.x,e.y)):(r.setAttribute("d",t.d),r.setAttribute("transform",`translate(${e.x}, ${e.y})`)),r}default:return null}}async function p9(t,e,n){const i=bt(n.svgDocument,"g"),r=window.getComputedStyle(t);let s=b_(t,e),a=null;if(n.options.flattenTransforms&&r.transform&&r.transform!=="none"){const u=I9(r.transform);if(Math.abs(u)>.5){const f=t,h=f.offsetWidth,d=f.offsetHeight;if(h>0&&d>0&&(Math.abs(h-s.width)>1||Math.abs(d-s.height)>1)){const y=s.x+s.width/2,m=s.y+s.height/2;s={x:y-h/2,y:m-d/2,width:h,height:d},a=`rotate(${u.toFixed(2)}, ${y.toFixed(2)}, ${m.toFixed(2)})`}}}const o=y_(g_(r),s.width,s.height);if(!n.options.flattenTransforms&&r.transform&&r.transform!=="none"){const u=YR(r.transform,r.transformOrigin,s);u&&i.setAttribute("transform",u)}const l=r.clipPath;if(l&&l!=="none"){const u=S_(l);if(u){const f=k_(u,s,n);f&&i.setAttribute("clip-path",`url(#${f})`)}}if(!AR(r)){if(!n.compat.stripFilters&&r.filter&&r.filter!=="none"){const h=JR(r.filter,n);h&&i.setAttribute("filter",`url(#${h})`)}if(!n.compat.stripBoxShadows){const h=r.boxShadow;if(h&&h!=="none"){const d=n9(h);d.length>0&&s9(d,s,o,n,i)}}const u=Xh(r);if(u){const h=zc(s,o,n);h.setAttribute("fill",u),i.appendChild(h)}v_(r)&&await N9(r,s,o,n,i);const f=NR(r);if(CR(f)&&y9(i,s,f,o,n),k9(r,s,o,n,i),yR(t)&&t.src){const h=await b0(t.src),d=bt(n.svgDocument,"image");Zt(d,{x:s.x,y:s.y,width:s.width,height:s.height,href:h});const y=r.objectFit||t.style.objectFit;if(y==="fill"||y===""?d.setAttribute("preserveAspectRatio","none"):y==="contain"||y==="scale-down"?d.setAttribute("preserveAspectRatio","xMidYMid meet"):y==="cover"&&d.setAttribute("preserveAspectRatio","xMidYMid slice"),Yl(o)){const m=n.idGenerator.next("clip"),x=bt(n.svgDocument,"clipPath");x.setAttribute("id",m);const w=bt(n.svgDocument,"path");w.setAttribute("d",Jd(s.x,s.y,s.width,s.height,o)),x.appendChild(w),n.defs.appendChild(x),d.setAttribute("clip-path",`url(#${m})`)}i.appendChild(d)}if(bR(t)){const h=zR(t);if(h){const d=bt(n.svgDocument,"image");Zt(d,{x:s.x,y:s.y,width:s.width,height:s.height,href:h}),i.appendChild(d)}}if(wR(t)&&S9(t,r,s,n,i),r.display==="list-item"&&_9(t,r,s,n,i),!n.compat.stripMaskImage){const h=r.webkitMaskImage||r.maskImage||r.webkitMask||r.mask;h&&h!=="none"&&await x9(h,r,s,n,i)}await A_(t,"::before",e,n,i)}if(a){const u=bt(n.svgDocument,"g");for(u.setAttribute("transform",a);i.firstChild;)u.appendChild(i.firstChild);i.appendChild(u)}if(m_(r)&&t!==e){const u=n.compat.useClipPathForOverflow?w9(s,o,n):b9(s,o,n);i.appendChild(u),i.__childTarget=u}return i}async function g9(t,e,n,i){await A_(t,"::after",e,n,i)}function m9(t){return t.__childTarget??t}function zc(t,e,n){if(Yl(e)&&!Fd(e))return v9(t,e,n);const i=bt(n.svgDocument,"rect");return Zt(i,{x:t.x,y:t.y,width:t.width,height:t.height}),Yl(e)&&Fd(e)&&Zt(i,{rx:e.topLeft[0],ry:e.topLeft[1]}),i}function v9(t,e,n){const i=bt(n.svgDocument,"path");return i.setAttribute("d",Jd(t.x,t.y,t.width,t.height,e)),i}function t1(t,e){return t==="dashed"?`${e*3} ${e*2}`:t==="dotted"?`${e} ${e}`:null}function y9(t,e,n,i,r){if(n.top.width===n.right.width&&n.right.width===n.bottom.width&&n.bottom.width===n.left.width&&n.top.color===n.right.color&&n.right.color===n.bottom.color&&n.bottom.color===n.left.color&&n.top.style===n.right.style&&n.right.style===n.bottom.style&&n.bottom.style===n.left.style&&n.top.width>0&&n.top.style!=="none"){const I=n.top.width/2,T={x:e.x+I,y:e.y+I,width:Math.max(0,e.width-n.top.width),height:Math.max(0,e.height-n.top.width)},D={topLeft:[Math.max(0,i.topLeft[0]-I),Math.max(0,i.topLeft[1]-I)],topRight:[Math.max(0,i.topRight[0]-I),Math.max(0,i.topRight[1]-I)],bottomRight:[Math.max(0,i.bottomRight[0]-I),Math.max(0,i.bottomRight[1]-I)],bottomLeft:[Math.max(0,i.bottomLeft[0]-I),Math.max(0,i.bottomLeft[1]-I)]},O=zc(T,D,r);Zt(O,{fill:"none",stroke:n.top.color,"stroke-width":n.top.width});const W=t1(n.top.style,n.top.width);W&&O.setAttribute("stroke-dasharray",W),t.appendChild(O);return}const{x:s,y:a,width:o,height:l}=e,c=n.top.width,u=n.right.width,f=n.bottom.width,h=n.left.width,d=s,y=a,m=s+o,x=a+l,w=s+h,S=a+c,A=s+o-u,_=a+l-f,M=[{w:c,side:n.top,trapD:`M ${d} ${y} L ${m} ${y} L ${A} ${S} L ${w} ${S} Z`,lineD:`M ${w} ${y+c/2} L ${A} ${y+c/2}`},{w:u,side:n.right,trapD:`M ${m} ${y} L ${m} ${x} L ${A} ${_} L ${A} ${S} Z`,lineD:`M ${m-u/2} ${S} L ${m-u/2} ${_}`},{w:f,side:n.bottom,trapD:`M ${m} ${x} L ${d} ${x} L ${w} ${_} L ${A} ${_} Z`,lineD:`M ${A} ${x-f/2} L ${w} ${x-f/2}`},{w:h,side:n.left,trapD:`M ${d} ${x} L ${d} ${y} L ${w} ${S} L ${w} ${_} Z`,lineD:`M ${d+h/2} ${_} L ${d+h/2} ${S}`}];for(const{w:I,side:T,trapD:D,lineD:O}of M){if(I<=0||T.style==="none")continue;const W=t1(T.style,I);if(W){const C=bt(r.svgDocument,"path");Zt(C,{d:O,fill:"none",stroke:T.color,"stroke-width":I}),C.setAttribute("stroke-dasharray",W),t.appendChild(C)}else{const C=bt(r.svgDocument,"path");C.setAttribute("d",D),C.setAttribute("fill",T.color),t.appendChild(C)}}}function b9(t,e,n){const i=n.idGenerator.next("mask"),r=bt(n.svgDocument,"mask");r.setAttribute("id",i);const s=zc(t,e,n);s.setAttribute("fill","white"),r.appendChild(s),n.defs.appendChild(r);const a=bt(n.svgDocument,"g");return a.setAttribute("mask",`url(#${i})`),a}function w9(t,e,n){const i=n.idGenerator.next("clip"),r=bt(n.svgDocument,"clipPath");r.setAttribute("id",i);const s=zc(t,e,n);r.appendChild(s),n.defs.appendChild(r);const a=bt(n.svgDocument,"g");return a.setAttribute("clip-path",`url(#${i})`),a}function Ky(t,e,n,i,r){const s=i.idGenerator.next("mask"),a=bt(i.svgDocument,"mask");a.setAttribute("id",s);const o=zc(e,n,i);o.setAttribute("fill","white"),a.appendChild(o),i.defs.appendChild(a);const l=bt(i.svgDocument,"g");l.setAttribute("mask",`url(#${s})`),l.appendChild(t),r.appendChild(l)}async function x9(t,e,n,i,r){const s=x_(t);if(!s)return;let a=s;if(!s.startsWith("data:"))try{a=await b0(s)}catch{return}const o=e.webkitMaskSize||e.maskSize||"auto";let l=n.width,c=n.height;if(o!=="auto"&&o!=="contain"&&o!=="cover"){const d=o.split(/\s+/),y=parseFloat(d[0]),m=parseFloat(d[1]||d[0]);isNaN(y)||(l=y),isNaN(m)||(c=m)}const u=i.idGenerator.next("mask"),f=bt(i.svgDocument,"mask");f.setAttribute("id",u),i.compat.avoidStyleAttributes||f.setAttribute("style","mask-type: alpha");const h=bt(i.svgDocument,"image");Zt(h,{x:n.x,y:n.y,width:l,height:c,href:a}),f.appendChild(h),i.defs.appendChild(f),r.setAttribute("mask",`url(#${u})`)}function _9(t,e,n,i,r){let s="";try{const y=window.getComputedStyle(t,"::marker").content;y&&y!=="none"&&y!=="normal"&&(s=y.replace(/^["']|["']$/g,""))}catch{}if(!s){const d=e.listStyleType;if(d==="none")return;if(d==="disc")s="â¢";else if(d==="circle")s="â";else if(d==="square")s="â ";else if(d==="decimal"||d===""||!d){let y=1,m=t.previousElementSibling;for(;m;)window.getComputedStyle(m).display==="list-item"&&y++,m=m.previousElementSibling;s=`${y}.`}else s="â¢"}if(!s)return;const a=parseFloat(e.fontSize)||16,o=parseFloat(e.paddingLeft)||0,l=parseFloat(e.paddingTop)||0,c=parseFloat(e.lineHeight)||a*1.2,u=n.x+o-6,f=n.y+l+(c-a)/2+a*.8,h=bt(i.svgDocument,"text");Zt(h,{x:u.toFixed(2),y:f.toFixed(2),"font-family":e.fontFamily,"font-size":e.fontSize,fill:e.color,"text-anchor":"end"}),h.textContent=s,r.appendChild(h)}function S9(t,e,n,i,r){let s="",a=!1;if(t instanceof HTMLSelectElement?s=t.selectedOptions[0]?.text??"":(s=t.value,!s&&t.placeholder&&(s=t.placeholder,a=!0)),!s)return;const o=parseFloat(e.fontSize)||16,l=parseFloat(e.paddingLeft)||0,c=parseFloat(e.paddingTop)||0,u=parseFloat(e.borderTopWidth)||0,f=parseFloat(e.lineHeight)||o*1.2,h=a?"gray":e.color,d=n.x+l;if(t instanceof HTMLTextAreaElement){const S=s.split(`
`);for(let A=0;A<S.length;A++){const _=S[A];if(!_)continue;const M=(f-o)/2,I=n.y+u+c+A*f+M+o*.8,T=bt(i.svgDocument,"text");Zt(T,{x:d.toFixed(2),y:I.toFixed(2),"font-family":e.fontFamily,"font-size":e.fontSize,"font-weight":e.fontWeight,"font-style":e.fontStyle,fill:h}),a&&T.setAttribute("opacity","0.54"),T.textContent=_,r.appendChild(T)}return}const y=parseFloat(e.borderBottomWidth)||0,m=n.height-u-y,x=n.y+u+m/2+o*.35,w=bt(i.svgDocument,"text");Zt(w,{x:d.toFixed(2),y:x.toFixed(2),"font-family":e.fontFamily,"font-size":e.fontSize,"font-weight":e.fontWeight,"font-style":e.fontStyle,fill:h}),a&&w.setAttribute("opacity","0.54"),w.textContent=s,r.appendChild(w)}function k9(t,e,n,i,r){const s=t.outlineStyle;if(!s||s==="none")return;const a=parseFloat(t.outlineWidth)||0;if(a<=0)return;const o=t.outlineColor||t.color,c=(parseFloat(t.outlineOffset)||0)+a/2,u={x:e.x-c,y:e.y-c,width:e.width+c*2,height:e.height+c*2},f={topLeft:[Math.max(0,n.topLeft[0]+c),Math.max(0,n.topLeft[1]+c)],topRight:[Math.max(0,n.topRight[0]+c),Math.max(0,n.topRight[1]+c)],bottomRight:[Math.max(0,n.bottomRight[0]+c),Math.max(0,n.bottomRight[1]+c)],bottomLeft:[Math.max(0,n.bottomLeft[0]+c),Math.max(0,n.bottomLeft[1]+c)]},h=zc(u,f,i);Zt(h,{fill:"none",stroke:o,"stroke-width":a});const d=t1(s,a);d&&h.setAttribute("stroke-dasharray",d),r.appendChild(h)}function lm(t){const e=[];let n=0,i="";for(const r of t)r==="("?n++:r===")"&&n--,r===","&&n===0?(e.push(i.trim()),i=""):i+=r;return i.trim()&&e.push(i.trim()),e}function A9(t,e,n){let i=n.width,r=n.height,s="none";if(t==="contain")s="xMidYMid meet";else if(t==="cover")s="xMidYMid slice";else if(t&&t!=="auto"){const l=t.split(/\s+/),c=Zy(l[0],n.width),u=Zy(l[1]??"auto",n.height);c!==null&&(i=c),u!==null&&(r=u)}let a=n.x,o=n.y;if(e&&e!=="0% 0%"){const l=e.split(/\s+/);a=n.x+Jy(l[0]??"0px",n.width,i),o=n.y+Jy(l[1]??"0px",n.height,r)}return{x:a,y:o,width:i,height:r,preserveAspectRatio:s}}function Zy(t,e){return t==="auto"?null:t.endsWith("%")?parseFloat(t)/100*e:parseFloat(t)||null}function Jy(t,e,n){return t.endsWith("%")?parseFloat(t)/100*(e-n):parseFloat(t)||0}async function N9(t,e,n,i,r){const s=lm(t.backgroundImage),a=lm(t.backgroundSize),o=lm(t.backgroundPosition);for(let l=s.length-1;l>=0;l--){const c=s[l];if(c==="none")continue;const u=a[l]??a[a.length-1]??"auto",f=o[l]??o[o.length-1]??"0% 0%",h=A9(u,f,e);await C9(c,h,e,n,i,r)}}async function C9(t,e,n,i,r,s){const a=TR(t);if(a){const c=DR(a,n,r),u=zc(n,i,r);u.setAttribute("fill",`url(#${c.getAttribute("id")})`),s.appendChild(u);return}const o=OR(t,e.width,e.height);if(o){const c=bt(r.svgDocument,"image");Zt(c,{x:e.x,y:e.y,width:e.width,height:e.height,href:o,preserveAspectRatio:e.preserveAspectRatio}),Yl(i)?Ky(c,n,i,r,s):s.appendChild(c);return}const l=x_(t);if(l){const c=await b0(l),u=bt(r.svgDocument,"image");Zt(u,{x:e.x,y:e.y,width:e.width,height:e.height,href:c,preserveAspectRatio:e.preserveAspectRatio}),Yl(i)?Ky(u,n,i,r,s):s.appendChild(u)}}function P9(t){if(Xh(t)||v_(t))return!0;const e=t.clipPath||t.webkitClipPath;return!!(e&&e!=="none")}function E9(t,e,n,i){const r=document.createElement("span");r.style.cssText=`
    position: ${n.position};
    display: ${n.display==="none"?"none":n.display};
    top: ${n.top}; right: ${n.right};
    bottom: ${n.bottom}; left: ${n.left};
    width: ${n.width}; height: ${n.height};
    margin: ${n.margin}; padding: ${n.padding};
    box-sizing: ${n.boxSizing};
    visibility: hidden;
    pointer-events: none;
  `,e==="::before"?t.insertBefore(r,t.firstChild):t.appendChild(r);const s=r.getBoundingClientRect();if(t.removeChild(r),s.width===0&&s.height===0)return null;const a=i.getBoundingClientRect();return{x:s.left-a.left,y:s.top-a.top,width:s.width,height:s.height}}async function A_(t,e,n,i,r){const s=xR(t,e),a=s.content;if(!a||a==="none"||a==="normal")return;const o=a.replace(/^["']|["']$/g,""),l=P9(s);if(!o&&!l)return;if(l){const A=E9(t,e,s,n);if(A){const _=Xh(s);if(_){const M=bt(i.svgDocument,"rect");Zt(M,{x:A.x,y:A.y,width:A.width,height:A.height,fill:_});const I=s.clipPath||s.webkitClipPath;if(I&&I!=="none"){const T=S_(I);if(T){const D=k_(T,A,i);D&&M.setAttribute("clip-path",`url(#${D})`)}}r.appendChild(M)}}}if(!o)return;const c=n.getBoundingClientRect(),u=parseFloat(s.fontSize)||16,f=document.createElement("span");f.style.cssText=`
    font-family: ${s.fontFamily};
    font-size: ${s.fontSize};
    font-weight: ${s.fontWeight};
    font-style: ${s.fontStyle};
    letter-spacing: ${s.letterSpacing};
    visibility: hidden;
    pointer-events: none;
  `,f.textContent=o,e==="::before"?t.insertBefore(f,t.firstChild):t.appendChild(f);const h=f.getBoundingClientRect(),d=h.left-c.left,y=h.width,m=h.height,x=(m-u)/2,w=h.top-c.top+x+u*.8;if(t.removeChild(f),!l){const A=Xh(s);if(A){const _=bt(i.svgDocument,"rect");Zt(_,{x:d,y:h.top-c.top,width:y,height:m,fill:A}),r.appendChild(_)}}const S=bt(i.svgDocument,"text");Zt(S,{"font-family":s.fontFamily,"font-size":s.fontSize,"font-weight":s.fontWeight,"font-style":s.fontStyle,fill:s.color,x:d.toFixed(2),y:w.toFixed(2)}),s.letterSpacing&&s.letterSpacing!=="normal"&&S.setAttribute("letter-spacing",s.letterSpacing),S.textContent=o,r.appendChild(S)}function I9(t){const e=t.match(/^matrix\(([^,]+),\s*([^,]+)/);if(!e)return 0;const n=parseFloat(e[1]),i=parseFloat(e[2]);return isNaN(n)||isNaN(i)?0:Math.atan2(i,n)*(180/Math.PI)}function L9(t,e){const n=window.getComputedStyle(t).color||"rgb(0, 0, 0)",i=Kh(t,e);return P_(i,n),T9(i,e),i}function Kh(t,e,n=0){if(t.localName==="use"&&n<5){const o=M9(t,e,n);if(o)return o}const i=e.compat.flattenNestedSvg&&t.localName==="svg"&&t.ownerSVGElement!==null&&!t.getAttribute("viewBox"),r=e.svgDocument.createElementNS(t.namespaceURI||Ic,i?"g":t.localName),s=e.compat.avoidStyleAttributes,a=new Set(["x","y","width","height","overflow","viewBox"]);for(const o of Array.from(t.attributes))s&&(o.localName==="style"||o.localName==="class")||i&&a.has(o.localName)||(o.namespaceURI===Lc?r.setAttributeNS(Lc,o.localName,o.value):o.namespaceURI?r.setAttributeNS(o.namespaceURI,o.localName,o.value):r.setAttribute(o.localName,o.value));if(i){const o=parseFloat(t.getAttribute("x")||"0")||0,l=parseFloat(t.getAttribute("y")||"0")||0;(o!==0||l!==0)&&r.setAttribute("transform",`translate(${o},${l})`)}N_(t,r,e);for(const o of Array.from(t.childNodes))o.nodeType===Node.ELEMENT_NODE?r.appendChild(Kh(o,e,n)):o.nodeType===Node.TEXT_NODE&&r.appendChild(e.svgDocument.createTextNode(o.textContent||""));return r}function M9(t,e,n){const i=t.getAttribute("href")||t.getAttributeNS(Lc,"href");if(!i||!i.startsWith("#"))return null;const r=i.slice(1),s=document.getElementById(r);if(!s)return null;const a=e.svgDocument.createElementNS(Ic,"g"),o=new Set(["href","xlink:href","x","y","width","height"]);for(const u of Array.from(t.attributes))o.has(u.localName)||u.namespaceURI!==Lc&&(u.namespaceURI?a.setAttributeNS(u.namespaceURI,u.localName,u.value):a.setAttribute(u.localName,u.value));const l=parseFloat(t.getAttribute("x")||"0")||0,c=parseFloat(t.getAttribute("y")||"0")||0;if(l!==0||c!==0){const u=a.getAttribute("transform")||"";a.setAttribute("transform",`translate(${l},${c}) ${u}`.trim())}if(N_(t,a,e),s.localName==="symbol"){const u=s.getAttribute("viewBox"),f=t.getAttribute("width")||s.getAttribute("width"),h=t.getAttribute("height")||s.getAttribute("height"),d=e.svgDocument.createElementNS(Ic,"svg");u&&d.setAttribute("viewBox",u),f&&d.setAttribute("width",f),h&&d.setAttribute("height",h),d.setAttribute("overflow","hidden");for(const y of Array.from(s.childNodes))y.nodeType===Node.ELEMENT_NODE&&d.appendChild(Kh(y,e,n+1));a.appendChild(d)}else a.appendChild(Kh(s,e,n+1));return a}function N_(t,e,n){const i=window.getComputedStyle(t);if(!e.hasAttribute("fill")){const r=i.fill;r&&r!=="rgb(0, 0, 0)"&&e.setAttribute("fill",r)}if(!e.hasAttribute("stroke")){const r=i.stroke;r&&r!=="none"&&e.setAttribute("stroke",r)}if(!e.hasAttribute("opacity")){const r=i.opacity;r==="0"?e.setAttribute("opacity","0"):!n.compat.stripGroupOpacity&&r&&r!=="1"&&e.setAttribute("opacity",r)}}function T9(t,e){const n=new Map,i=t.querySelectorAll("[id]");for(const r of Array.from(i)){const s=r.getAttribute("id"),a=e.idGenerator.next("svg");n.set(s,a),r.setAttribute("id",a)}if(t.hasAttribute("id")){const r=t.getAttribute("id");if(!n.has(r)){const s=e.idGenerator.next("svg");n.set(r,s),t.setAttribute("id",s)}}n.size!==0&&C_(t,n)}function C_(t,e){for(const n of Array.from(t.attributes)){if(n.value.includes("url(#")){let i=n.value;for(const[r,s]of e)i=i.replace(new RegExp(`url\\(#${D9(r)}\\)`,"g"),`url(#${s})`);i!==n.value&&t.setAttribute(n.localName,i)}if((n.localName==="href"||n.localName==="xlink:href")&&n.value.startsWith("#")){const i=n.value.slice(1);e.has(i)&&(n.namespaceURI===Lc?t.setAttributeNS(Lc,"href",`#${e.get(i)}`):t.setAttribute(n.localName,`#${e.get(i)}`))}}for(const n of Array.from(t.children))n instanceof SVGElement&&C_(n,e)}function P_(t,e){for(const n of Array.from(t.attributes))n.value==="currentColor"&&t.setAttribute(n.localName,e);for(const n of Array.from(t.children))n instanceof SVGElement&&P_(n,e)}function D9(t){return t.replace(/[.*+?^${}()|[\]\\]/g,"\\$&")}var O9=1e4;function F9(t){const e=new Map;let n=null;async function i(){return n||(n=await gs(()=>import("./BSMA75Qi.js"),[],import.meta.url),n)}function r(l,c,u){return`${l}|${c??"normal"}|${u??"normal"}`}function s(l){return l===void 0||l==="normal"?400:l==="bold"?700:typeof l=="string"?parseInt(l,10)||400:l}function a(l){return l==="italic"||l==="oblique"?"italic":"normal"}function o(l,c,u){const f=t[l];if(!f)return null;if(typeof f=="string")return{url:f};if(!Array.isArray(f))return f;const h=s(c),d=a(u);let y=null,m=-1;for(const x of f){let w=0;a(x.style)===d&&(w+=2),s(x.weight)===h&&(w+=1),w>m&&(m=w,y=x)}return y??f[0]??null}return{async getFont(l,c,u){const f=r(l,c,u);if(e.has(f))return e.get(f);const h=o(l,c,u);if(!h)return null;const d=await i();try{const y=new AbortController,m=setTimeout(()=>y.abort(),O9),x=await fetch(h.url,{signal:y.signal});clearTimeout(m);const w=await x.arrayBuffer(),S=d.parse(w);return e.set(f,S),S}catch(y){return console.warn(`dom2svg: Failed to load font "${l}" from ${h.url}:`,y),null}},has(l){return l in t}}}function R9(t,e,n,i,r){try{return t.getPath(e,n,i,r).toPathData(2)}catch{return null}}function B9(t){return(t.split(",")[0]?.trim()??t).replace(/^["']|["']$/g,"")}function z9(t){if(!t||t==="none")return[];const e=[],n=q9(t);for(const i of n){const r=j9(i.trim());r&&e.push(r)}return e}function q9(t){const e=[];let n=0,i="";for(const r of t)r==="("?n++:r===")"&&n--,r===","&&n===0?(e.push(i),i=""):i+=r;return i&&e.push(i),e}function j9(t){const e=[];let n="",i=0;for(const a of t)a==="("?i++:a===")"&&i--,a===" "&&i===0&&n?(e.push(n),n=""):n+=a;n&&e.push(n);const r=[],s=[];for(const a of e){const o=parseFloat(a);!isNaN(o)&&(a.endsWith("px")||a.match(/^-?[\d.]+$/))?r.push(o):s.push(a)}return r.length<2?null:{offsetX:r[0],offsetY:r[1],blur:r[2]??0,color:s.join(" ")||"rgba(0, 0, 0, 0.5)"}}function H9(t,e){if(t.length===0)return null;const n=e.idGenerator.next("tshadow"),i=bt(e.svgDocument,"filter");if(Zt(i,{id:n,x:"-50%",y:"-50%",width:"200%",height:"200%"}),t.length===1){const r=t[0],s=bt(e.svgDocument,"feDropShadow");Zt(s,{dx:r.offsetX,dy:r.offsetY,stdDeviation:r.blur/2,"flood-color":r.color,"flood-opacity":1}),i.appendChild(s)}else{const r=[];for(let o=0;o<t.length;o++){const l=t[o],c=String(o),u=bt(e.svgDocument,"feOffset");Zt(u,{in:"SourceAlpha",dx:l.offsetX,dy:l.offsetY,result:`off${c}`}),i.appendChild(u);const f=bt(e.svgDocument,"feGaussianBlur");Zt(f,{in:`off${c}`,stdDeviation:l.blur/2,result:`blur${c}`}),i.appendChild(f);const h=bt(e.svgDocument,"feFlood");Zt(h,{"flood-color":l.color,"flood-opacity":1,result:`color${c}`}),i.appendChild(h);const d=bt(e.svgDocument,"feComposite");Zt(d,{in:`color${c}`,in2:`blur${c}`,operator:"in",result:`shadow${c}`}),i.appendChild(d),r.push(`shadow${c}`)}const s=bt(e.svgDocument,"feMerge");for(const o of r){const l=bt(e.svgDocument,"feMergeNode");l.setAttribute("in",o),s.appendChild(l)}const a=bt(e.svgDocument,"feMergeNode");a.setAttribute("in","SourceGraphic"),s.appendChild(a),i.appendChild(s)}return e.defs.appendChild(i),n}async function U9(t,e,n){const i=t.textContent;if(!i||!i.trim())return null;const r=t.parentElement;if(!r)return null;const s=window.getComputedStyle(r);if(s.visibility==="hidden")return null;const a=s.whiteSpace,o=e.getBoundingClientRect();let l;try{const _=document.createRange();_.selectNodeContents(t),l=_.getClientRects()}catch{return null}if(l.length===0)return null;const c=bt(n.svgDocument,"g"),u=n.options.textToPath&&n.fontCache,f=B9(s.fontFamily),h=parseFloat(s.fontSize)||16,d=s.fontWeight,y=s.fontStyle;let m=null;u&&n.fontCache?.has(f)&&(m=await n.fontCache.getFont(f,d,y));let x=.8;m&&m.ascender&&m.unitsPerEm&&(x=m.ascender/m.unitsPerEm);const w=W9(t,o,x,a),S=s.textTransform,A=s.textOverflow==="ellipsis"&&s.overflow!=="visible"&&s.whiteSpace==="nowrap"&&r.scrollWidth>r.clientWidth;for(const _ of w){let M=Y9(_.text,S);if(A&&_===w[w.length-1]&&(M=M.trimEnd()+"â¦"),m){const I=R9(m,M,_.x,_.y,h);if(I){const T=bt(n.svgDocument,"path");Zt(T,{d:I,fill:s.color}),c.appendChild(T)}}else{const I=bt(n.svgDocument,"text");Zt(I,{x:_.x.toFixed(2),y:_.y.toFixed(2)}),K9(I,s,n),I.textContent=M,c.appendChild(I)}}if(c.childNodes.length===0)return null;if(!n.compat.stripTextShadows){const _=s.textShadow;if(_&&_!=="none"){const M=z9(_),I=H9(M,n);I&&c.setAttribute("filter",`url(#${I})`)}}return c}function Qy(t,e,n,i,r=.8,s){let a=t,o=e;s&&e>n*2&&s.height<e*.8&&(a=s.top,o=s.height);const l=(o-n)/2;return a-i+l+n*r}function W9(t,e,n=.8,i="normal"){const r=[],s=t.textContent||"";if(!s)return r;const a=t.parentElement;if(!a)return r;const o=window.getComputedStyle(a),l=parseFloat(o.fontSize)||16,c=a.getBoundingClientRect(),u={top:c.top,height:c.height},f=document.createRange();f.selectNodeContents(t);const h=f.getClientRects();if(h.length===0)return r;let d;if(h.length===1){const m=h[0];if(s.length>1&&G9(t,f,s.length,l))d=X9(t,f,s.length,l);else return r.push({text:$y(s,i),x:m.left-e.left,y:Qy(m.top,m.height,l,e.top,n,u)}),r}else d=Array.from(h);let y=0;for(let m=0;m<d.length;m++){const x=d[m],w=m===d.length-1;let S;if(w)S=s.length;else{const _=x.top;S=V9(t,f,y,s.length,_,l)}const A=$y(s.slice(y,S),i);A&&r.push({text:A,x:x.left-e.left,y:Qy(x.top,x.height,l,e.top,n,u)}),y=S}return r}function V9(t,e,n,i,r,s){for(;n<i;){const a=Math.floor((n+i)/2);try{e.setStart(t,a),e.setEnd(t,a+1)}catch{n=a+1;continue}const o=e.getClientRects();if(o.length===0){n=a+1;continue}Math.abs(o[0].top-r)>s*.5?i=a:n=a+1}return n}function G9(t,e,n,i){if(n<=1)return!1;try{e.setStart(t,0),e.setEnd(t,1);const r=e.getClientRects();e.setStart(t,n-1),e.setEnd(t,n);const s=e.getClientRects();if(r.length>0&&s.length>0)return Math.abs(s[0].top-r[0].top)>i*.5}catch{}return!1}function X9(t,e,n,i){const r=[];let s=-1/0;for(let a=0;a<n;a++)try{e.setStart(t,a),e.setEnd(t,a+1);const o=e.getClientRects();if(o.length===0)continue;const l=o[0];Math.abs(l.top-s)>i*.5&&(r.push(l),s=l.top)}catch{continue}return r}function $y(t,e){return e==="pre"||e==="pre-wrap"||e==="break-spaces"?t:e==="pre-line"?t.replace(/[^\S\n]+/g," "):t.replace(/\s+/g," ")}function Y9(t,e){switch(e){case"uppercase":return t.toUpperCase();case"lowercase":return t.toLowerCase();case"capitalize":return t.replace(/\b\w/g,n=>n.toUpperCase());default:return t}}function K9(t,e,n){if(Zt(t,{"font-family":e.fontFamily,"font-size":e.fontSize,"font-weight":e.fontWeight,"font-style":e.fontStyle,fill:e.color}),n.compat.stripXmlSpace||t.setAttribute("xml:space","preserve"),e.letterSpacing&&e.letterSpacing!=="normal"&&t.setAttribute("letter-spacing",e.letterSpacing),e.wordSpacing&&e.wordSpacing!=="normal"&&t.setAttribute("word-spacing",e.wordSpacing),e.textDecoration&&e.textDecoration!=="none"){const i=[];e.textDecoration.includes("underline")&&i.push("underline"),e.textDecoration.includes("line-through")&&i.push("line-through"),i.length>0&&t.setAttribute("text-decoration",i.join(" "))}}async function E_(t,e,n){const i=window.getComputedStyle(t);if(kR(i)||J9(t,n))return null;if(n.options.handler)try{const o=n.options.handler(t,n);if(o!==null)return o}catch(o){console.warn("dom2svg: Custom handler threw for element:",t,o)}if(vR(t)&&t!==e){const o=b_(t,e),l=L9(t,n);return t.tagName.toLowerCase()==="svg"&&(l.setAttribute("x",String(o.x)),l.setAttribute("y",String(o.y)),l.setAttribute("width",String(o.width)),l.setAttribute("height",String(o.height)),i.overflow==="visible"&&l.setAttribute("overflow","visible")),l}const r=await p9(t,e,n),s=m9(r);{const o=parseFloat(i.opacity);o===0?r.setAttribute("opacity","0"):!n.compat.stripGroupOpacity&&o<1&&r.setAttribute("opacity",String(o))}const a=Z9(t);for(const o of a)if(p_(o)){const l=await U9(o,e,n);l&&s.appendChild(l)}else if($m(o)){const l=await E_(o,e,n);l&&s.appendChild(l)}return await g9(t,e,n,r),r}function Z9(t){const e=Array.from(t.childNodes);if(!e.some(c=>$m(c)))return e;const n=[],i=[],r=[],s=[],a=[],o=[];for(const c of e){if(p_(c)){s.push(c);continue}if(!$m(c))continue;const u=window.getComputedStyle(c),f=ER(u),h=PR(u),d=IR(u);h&&f<0?n.push({node:c,z:f}):h&&f>0?o.push({node:c,z:f}):d||h?a.push(c):LR(u)?r.push(c):MR(u)?s.push(c):i.push(c)}n.sort((c,u)=>c.z-u.z),o.sort((c,u)=>c.z-u.z);const l=[];for(const{node:c}of n)l.push(c);for(const c of i)l.push(c);for(const c of r)l.push(c);for(const c of s)l.push(c);for(const c of a)l.push(c);for(const{node:c}of o)l.push(c);return l}function J9(t,e){const n=e.options.exclude;return n?typeof n=="string"?t.matches(n):n(t):!1}var Q9={useClipPathForOverflow:!1,stripFilters:!1,stripBoxShadows:!1,stripMaskImage:!1,stripTextShadows:!1,avoidStyleAttributes:!1,stripXmlSpace:!1,stripGroupOpacity:!1,inlineClipPathTransforms:!1,flattenNestedSvg:!1},$9={useClipPathForOverflow:!0,stripFilters:!0,stripBoxShadows:!0,stripMaskImage:!0,stripTextShadows:!0,avoidStyleAttributes:!0,stripXmlSpace:!0,stripGroupOpacity:!0,inlineClipPathTransforms:!0,flattenNestedSvg:!0};function eB(t){return!t||t==="full"?Q9:t==="inkscape"?$9:t}async function tB(t,e={}){const n=e.padding??0,i=t.getBoundingClientRect(),r=i.width+n*2,s=i.height+n*2,a=document.implementation.createDocument(Ic,"svg",null),o=a.documentElement;o.setAttribute("xmlns",Ic),o.setAttributeNS(mR,"xmlns:xlink","http://www.w3.org/1999/xlink"),Zt(o,{width:r,height:s,viewBox:`${-n} ${-n} ${r} ${s}`});const l=bt(a,"defs");if(o.appendChild(l),e.background){const f=bt(a,"rect");Zt(f,{x:-n,y:-n,width:r,height:s,fill:e.background}),o.appendChild(f)}const c={svgDocument:a,defs:l,idGenerator:SR(),options:e,compat:eB(e.compat),opacity:1};e.textToPath&&e.fonts&&(c.fontCache=F9(e.fonts));const u=await E_(t,t,c);if(u){const f=window.getComputedStyle(t),h=y_(g_(f),i.width,i.height);if(m_(f)&&Yl(h)){const d=c.idGenerator.next("clip"),y=bt(a,"clipPath");y.setAttribute("id",d);const m=nB(a,i.width,i.height,h);y.appendChild(m),l.appendChild(y),u.setAttribute("clip-path",`url(#${d})`)}o.appendChild(u)}return l.childNodes.length===0&&o.removeChild(l),iB(o)}function nB(t,e,n,i){if(Fd(i)){const s=bt(t,"rect");return Zt(s,{x:0,y:0,width:e,height:n,rx:i.topLeft[0],ry:i.topLeft[1]}),s}const r=bt(t,"path");return r.setAttribute("d",Jd(0,0,e,n,i)),r}function iB(t){return{svg:t,toString(){return`<?xml version="1.0" encoding="UTF-8"?>
${new XMLSerializer().serializeToString(t)}`},toBlob(){const e=this.toString();return new Blob([e],{type:"image/svg+xml;charset=utf-8"})},download(e="export.svg"){const n=this.toBlob(),i=URL.createObjectURL(n),r=document.createElement("a");r.href=i,r.download=e,r.click(),setTimeout(()=>URL.revokeObjectURL(i),6e4)}}}const rB={background:"transparent",padding:lE,compat:"inkscape"},sB=[".svelte-flow__background",".svelte-flow__controls",".svelte-flow__minimap",".svelte-flow__panel",".svelte-flow__edge-interaction",".svelte-flow__attribution",".drop-zone-overlay"].join(", "),Hi="https://cdn.jsdelivr.net/npm/katex@0.16.9/dist/fonts",aB={Inter:{url:"/fonts/InterVariable.ttf"},"JetBrains Mono":[{url:"/fonts/JetBrainsMono-Regular.ttf",weight:400,style:"normal"},{url:"/fonts/JetBrainsMono-Medium.ttf",weight:500,style:"normal"}],KaTeX_Main:[{url:`${Hi}/KaTeX_Main-Regular.woff2`,weight:"normal",style:"normal"},{url:`${Hi}/KaTeX_Main-Bold.woff2`,weight:"bold",style:"normal"},{url:`${Hi}/KaTeX_Main-Italic.woff2`,weight:"normal",style:"italic"},{url:`${Hi}/KaTeX_Main-BoldItalic.woff2`,weight:"bold",style:"italic"}],KaTeX_Math:[{url:`${Hi}/KaTeX_Math-Italic.woff2`,weight:"normal",style:"italic"},{url:`${Hi}/KaTeX_Math-BoldItalic.woff2`,weight:"bold",style:"italic"}],KaTeX_Size1:[{url:`${Hi}/KaTeX_Size1-Regular.woff2`,weight:"normal",style:"normal"}],KaTeX_Size2:[{url:`${Hi}/KaTeX_Size2-Regular.woff2`,weight:"normal",style:"normal"}],KaTeX_Size3:[{url:`${Hi}/KaTeX_Size3-Regular.woff2`,weight:"normal",style:"normal"}],KaTeX_Size4:[{url:`${Hi}/KaTeX_Size4-Regular.woff2`,weight:"normal",style:"normal"}],KaTeX_AMS:[{url:`${Hi}/KaTeX_AMS-Regular.woff2`,weight:"normal",style:"normal"}],KaTeX_Caligraphic:[{url:`${Hi}/KaTeX_Caligraphic-Regular.woff2`,weight:"normal",style:"normal"},{url:`${Hi}/KaTeX_Caligraphic-Bold.woff2`,weight:"bold",style:"normal"}],KaTeX_Fraktur:[{url:`${Hi}/KaTeX_Fraktur-Regular.woff2`,weight:"normal",style:"normal"},{url:`${Hi}/KaTeX_Fraktur-Bold.woff2`,weight:"bold",style:"normal"}],KaTeX_SansSerif:[{url:`${Hi}/KaTeX_SansSerif-Regular.woff2`,weight:"normal",style:"normal"},{url:`${Hi}/KaTeX_SansSerif-Bold.woff2`,weight:"bold",style:"normal"},{url:`${Hi}/KaTeX_SansSerif-Italic.woff2`,weight:"normal",style:"italic"}],KaTeX_Script:[{url:`${Hi}/KaTeX_Script-Regular.woff2`,weight:"normal",style:"normal"}],KaTeX_Typewriter:[{url:`${Hi}/KaTeX_Typewriter-Regular.woff2`,weight:"normal",style:"normal"}]};function oB(t){const e=t.style.transform,n=e.match(/translate\(([^,]+)px,\s*([^)]+)px\)/),i=e.match(/scale\(([^)]+)\)/);return{panX:n?parseFloat(n[1]):0,panY:n?parseFloat(n[2]):0,zoom:i?parseFloat(i[1]):1}}function lB(t,e){const{panX:n,panY:i,zoom:r}=oB(e),s=t.getBoundingClientRect(),a={minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0};function o(l){if(l.width===0&&l.height===0)return;const c=(l.left-s.left-n)/r,u=(l.top-s.top-i)/r,f=l.width/r,h=l.height/r;a.minX=Math.min(a.minX,c),a.minY=Math.min(a.minY,u),a.maxX=Math.max(a.maxX,c+f),a.maxY=Math.max(a.maxY,u+h)}for(const l of t.querySelectorAll(".svelte-flow__node"))o(l.getBoundingClientRect());for(const l of t.querySelectorAll(".svelte-flow__edge"))o(l.getBoundingClientRect());return isFinite(a.minX)?a:{minX:0,minY:0,maxX:200,maxY:200}}function cB(t){let e=t;for(;;){const s=Array.from(e.children).filter(a=>a.tagName==="g");if(s.length===1){e=s[0];continue}break}const n=Array.from(e.children),i=[],r=[];for(const s of n)s.querySelector('[aria-label^="Edge from"]')?i.push(s):r.push(s);if(i.length!==0)for(const s of[...i,...r])e.appendChild(s)}async function I_(t={}){const e={...rB,...t},n=e.padding,i=document.querySelector(".svelte-flow");if(!i)throw new Error("SvelteFlow element not found");const r=i.querySelector(".svelte-flow__viewport");if(!r)throw new Error("SvelteFlow viewport not found");const s=getComputedStyle(i).getPropertyValue("--surface").trim(),a=lB(i,r),o=a.maxX-a.minX,l=a.maxY-a.minY,c=o+2*n,u=l+2*n,f=i.style.backgroundColor,h=i.style.width,d=i.style.height,y=i.style.minWidth,m=i.style.minHeight,x=i.style.overflow,w=document.createElement("style");w.textContent=`.svelte-flow__viewport { transform: translate(${-a.minX+n}px, ${-a.minY+n}px) scale(1) !important; }`,document.head.appendChild(w),i.style.backgroundColor="transparent",i.style.width=`${c}px`,i.style.height=`${u}px`,i.style.minWidth=`${c}px`,i.style.minHeight=`${u}px`,i.style.overflow="visible",await new Promise(S=>requestAnimationFrame(()=>requestAnimationFrame(S)));try{const S=await tB(i,{background:e.background==="solid"?s:void 0,padding:0,exclude:sB,flattenTransforms:!0,textToPath:!0,fonts:aB,compat:e.compat});return S.svg.setAttribute("width",String(c)),S.svg.setAttribute("height",String(u)),S.svg.setAttribute("viewBox",`0 0 ${c} ${u}`),cB(S.svg),S.toString()}finally{w.remove(),i.style.backgroundColor=f,i.style.width=h,i.style.height=d,i.style.minWidth=y,i.style.minHeight=m,i.style.overflow=x}}async function uB(t={}){const e=await I_(t),r=new DOMParser().parseFromString(e,"image/svg+xml").documentElement,s=parseFloat(r.getAttribute("width")||"800"),a=parseFloat(r.getAttribute("height")||"600"),o=new qt({orientation:s>a?"landscape":"portrait",unit:"pt",format:[s,a]});await o.svg(r,{x:0,y:0,width:s,height:a}),o.save("pathview-graph.pdf")}const Wi={label:"",action:()=>{},divider:!0};function cm(t,e){const n=Ze(q1),{inputs:i,outputs:r}=fE(e,n),s=e.inputs&&e.inputs.length>0,a=e.outputs&&e.outputs.length>0;if(!s&&!a)return[];const o=[Wi];return s&&o.push({label:i?"Hide Input Labels":"Show Input Labels",icon:"tag",action:()=>It.mutate(()=>Re.updateNodeParams(t,{_showInputLabels:!i}))}),a&&o.push({label:r?"Hide Output Labels":"Show Output Labels",icon:"tag",action:()=>It.mutate(()=>Re.updateNodeParams(t,{_showOutputLabels:!r}))}),o}function um(t){const e=Re.getNode(t);if(!e)return;const n=Re.getAllNodes(),i=Re.getAllConnections().map(o=>o.connection),r=Os.getCode(),s=Zw(e,r),a=n0(e,n,i);jh.open(s+a,"Block Python Code")}function dB(t){const e=vn.getEvent(t);if(!e)return;const n=Os.getCode(),i=Jw(e,n),r=Vw(e);jh.open(i+r,"Event Python Code")}function fB(t){const e=Re.getNode(t);if(!e)return[];const n=e.type===_n.SUBSYSTEM;if(e.type===_n.INTERFACE){const o=[{label:"Properties",icon:"settings",shortcut:"Dbl-click",action:()=>th(t)},{label:"Exit Subsystem",icon:"exit",action:()=>Re.drillUp()}];return o.push(...cm(t,e)),o.push(Wi,{label:"View Code",icon:"braces",action:()=>um(t)}),o}if(n){const o=[{label:"Properties",icon:"settings",action:()=>th(t)},{label:"Enter Subsystem",icon:"enter",shortcut:"Dbl-click",action:()=>Re.drillDown(t)}];return o.push(...cm(t,e)),o.push(Wi,{label:"View Code",icon:"braces",action:()=>um(t)},{label:"Export",icon:"upload",action:()=>Bm("subsystem",t)},Wi,{label:"Duplicate",icon:"copy",shortcut:"Ctrl+D",action:()=>{Re.selectNode(t,!1),Re.duplicateSelected()}},{label:"Copy",icon:"clipboard",shortcut:"Ctrl+C",action:()=>{Re.selectNode(t,!1),co.copy()}},Wi,{label:"Delete",icon:"trash",shortcut:"Del",action:()=>It.mutate(()=>Re.removeNode(t))}),o}const r=e.type==="Scope"||e.type==="Spectrum",s=e.type==="Scope"?"scope":"spectrum",a=[{label:"Properties",icon:"settings",shortcut:"Dbl-click",action:()=>th(t)}];if(a.push(...cm(t,e)),a.push(Wi,{label:"View Code",icon:"braces",action:()=>um(t)}),r){const o=ex(t,s);a.push({label:"Export CSV",icon:"table",action:()=>r0(t,e.name,e.type),disabled:!o})}return a.push({label:"Export",icon:"upload",action:()=>Bm("block",t)},Wi,{label:"Duplicate",icon:"copy",shortcut:"Ctrl+D",action:()=>{Re.selectNode(t,!1),It.mutate(()=>Re.duplicateSelected())}},{label:"Copy",icon:"clipboard",shortcut:"Ctrl+C",action:()=>{Re.selectNode(t,!1),co.copy()}},Wi,{label:"Delete",icon:"trash",shortcut:"Del",action:()=>It.mutate(()=>Re.removeNode(t))}),a}function hB(t,e){const n=t.length;return[{label:`Duplicate ${n} nodes`,icon:"copy",shortcut:"Ctrl+D",action:()=>It.mutate(()=>Re.duplicateSelected())},{label:`Copy ${n} nodes`,icon:"clipboard",shortcut:"Ctrl+C",action:()=>co.copy()},Wi,{label:`Delete ${n} nodes`,icon:"trash",shortcut:"Del",action:()=>e(t)}]}function pB(t){return[{label:"Properties",icon:"settings",shortcut:"Dbl-click",action:()=>bw(t)},Wi,{label:"View Code",icon:"braces",action:()=>dB(t)},Wi,{label:"Duplicate",icon:"copy",shortcut:"Ctrl+D",action:()=>{vn.selectEvent(t,!1),It.mutate(()=>vn.duplicateSelected())}},{label:"Copy",icon:"clipboard",shortcut:"Ctrl+C",action:()=>{vn.selectEvent(t,!1),co.copy()}},Wi,{label:"Delete",icon:"trash",shortcut:"Del",action:()=>It.mutate(()=>vn.removeEvent(t))}]}function gB(t){return[{label:"Reset Route",icon:"rotate",action:()=>ki.resetRoute(t)},Wi,{label:"Delete",icon:"trash",shortcut:"Del",action:()=>It.mutate(()=>Re.removeConnection(t))}]}function mB(t,e){const n=co.hasContent(),i=[{label:"Add Block",icon:"grid",shortcut:"B",action:()=>e.toggleNodeLibrary()},{label:"Add Event",icon:"zap",shortcut:"N",action:()=>e.toggleEventsPanel()},{label:"Add Annotation",icon:"type",action:()=>{const r=oo(t);It.mutate(()=>Re.addAnnotation(r))}},Wi,{label:"Open/Import",icon:"download",action:()=>{const r=oo(t);qw(r)}},{label:"Export SVG",icon:"image",action:async()=>{try{const r=await I_({compat:"inkscape"});i7(r,"pathview-graph.svg")}catch(r){console.error("SVG export failed:",r)}}},{label:"Export PDF",icon:"image",action:async()=>{try{await uB()}catch(r){console.error("PDF export failed:",r)}}}];return n&&i.push(Wi,{label:"Paste",icon:"clipboard",shortcut:"Ctrl+V",action:()=>{const r=oo(t);co.paste(r)}}),i.push(Wi,{label:"Fit View",icon:"maximize",shortcut:"F",action:()=>rl()}),i}function vB(t){const n=Re.getAnnotation(t)?.fontSize||qr.DEFAULT;return[{label:"Edit",icon:"type",shortcut:"Dbl-click",action:()=>n8(t)},Wi,{label:"Increase Font Size",icon:"font-size-increase",action:()=>{n<qr.MAX&&It.mutate(()=>Re.updateAnnotation(t,{fontSize:n+qr.STEP}))},disabled:n>=qr.MAX},{label:"Decrease Font Size",icon:"font-size-decrease",action:()=>{n>qr.MIN&&It.mutate(()=>Re.updateAnnotation(t,{fontSize:n-qr.STEP}))},disabled:n<=qr.MIN},Wi,{label:"Duplicate",icon:"copy",shortcut:"Ctrl+D",action:()=>{Re.selectNode(t,!1),It.mutate(()=>Re.duplicateSelected())}},{label:"Copy",icon:"clipboard",shortcut:"Ctrl+C",action:()=>{Re.selectNode(t,!1),co.copy()}},Wi,{label:"Delete",icon:"trash",shortcut:"Del",action:()=>It.mutate(()=>Re.removeAnnotation(t))}]}function yB(t,e){const n=Re.getNode(t),i=n?.name||"Plot",r=n?.type||"Scope",a=ex(t,r==="Spectrum"?"spectrum":"scope"),c=(Ze(Cr).blocks[t]??Oh).showLegend;return[{label:"Export CSV",icon:"table",action:()=>r0(t,i,r),disabled:!a},Wi,{label:c?"Hide Legend":"Show Legend",icon:"list",action:()=>Cr.setBlockShowLegend(t,!c)},{label:"Reset View",icon:"maximize",shortcut:"Dbl-click",action:async()=>{(await gs(()=>import("./DyKbcKio.js").then(f=>f.p),[],import.meta.url)).relayout(e,{"xaxis.autorange":!0,"yaxis.autorange":!0})}}]}function bB(t,e,n){if(!t)return[];switch(t.type){case"node":return fB(t.nodeId);case"selection":return hB([...t.nodeIds],n.deleteNodes);case"event":return pB(t.eventId);case"edge":return gB(t.edgeId);case"canvas":return mB(e,n);case"annotation":return vB(t.annotationId);case"plot":return yB(t.nodeId,t.plotEl);default:return[]}}var wB=Le('<div class="loading svelte-u0xts8">Loading syntax highlighting...</div>'),xB=Le('<div class="dialog-backdrop" role="presentation"><div class="dialog glass-panel svelte-u0xts8" role="dialog" tabindex="-1" aria-labelledby="dialog-title"><div class="dialog-header"><span id="dialog-title">Export Python Code</span> <div class="header-actions svelte-u0xts8"><button aria-label="Copy to Clipboard"><!></button> <button class="icon-btn" aria-label="Download Python file"><!></button> <button class="icon-btn" aria-label="Close"><!></button></div></div> <div class="dialog-body svelte-u0xts8"><div class="code-preview svelte-u0xts8"><!></div></div></div></div>');function _B(t,e){Mt(e,!0);let n=ot(e,"open",3,!1),i=Fe(void 0),r=null,s=null,a=Fe(!0),o=Fe("dark");const l=al.subscribe(T=>{$(o,T,!0),r&&s&&p(i)&&d()});let c=Fe(""),u=Fe(!1);pn(()=>{n()?($(c,m(),!0),$(u,!1),$(a,!0),setTimeout(()=>y(),0)):h()});function f(){return s?Vd(s,p(o)==="dark",{readOnly:!0}):[]}function h(){r&&(r.destroy(),r=null)}function d(){if(!r||!p(i)||!s)return;const T=r.state.doc.toString();r.destroy(),r=new s.EditorView({doc:T,extensions:f(),parent:p(i)})}async function y(){p(i)&&(h(),s=await bp(),r=new s.EditorView({doc:p(c),extensions:f(),parent:p(i)}),$(a,!1))}function m(){const{nodes:T,connections:D}=Re.toJSON(),O=rs.get(),W=Os.getCode(),C=vn.toJSON();return K7(T,D,O,W,C)}function x(){navigator.clipboard.writeText(p(c)),$(u,!0),setTimeout(()=>$(u,!1),2e3)}function w(){r7(p(c),"pathview_simulation.py")}function S(T){T.target===T.currentTarget&&e.onClose()}function A(T){T.key==="Escape"&&e.onClose()}Ai(()=>{l(),h()});var _=Je();yn("keydown",$n,A);var M=He(_);{var I=T=>{var D=xB();D.__click=S;var O=ne(D),W=ne(O),C=we(ne(W),2),N=ne(C);let B;N.__click=x;var E=ne(N);{var R=se=>{Ot(se,{name:"check",size:16})},q=se=>{Ot(se,{name:"copy",size:16})};Se(E,se=>{p(u)?se(R):se(q,!1)})}Q(N),mt(N,(se,ae)=>Qt?.(se,ae),()=>p(u)?"Copied!":"Copy to Clipboard");var Z=we(N,2);Z.__click=w;var U=ne(Z);Ot(U,{name:"download",size:16}),Q(Z),mt(Z,(se,ae)=>Qt?.(se,ae),()=>"Download .py");var X=we(Z,2);X.__click=function(...se){e.onClose?.apply(this,se)};var de=ne(X);Ot(de,{name:"x",size:16}),Q(X),mt(X,(se,ae)=>Qt?.(se,ae),()=>({text:"Close",shortcut:"Esc"})),Q(C),Q(W);var le=we(W,2),F=ne(le),V=ne(F);{var G=se=>{var ae=wB();j(se,ae)};Se(V,se=>{p(a)&&se(G)})}Q(F),Fi(F,se=>$(i,se),()=>p(i)),Q(le),Q(O),Q(D),Ae(()=>B=Xt(N,1,"icon-btn",null,B,{success:p(u)})),On(3,O,()=>fo,()=>({start:.95,duration:150,easing:Ea})),On(3,D,()=>Nr,()=>({duration:150})),j(T,D)};Se(M,T=>{n()&&T(I)})}j(t,_),Tt()}Xn(["click"]);var SB=Le('<span class="separator svelte-idx2ha">+</span>'),kB=Le('<kbd class="svelte-idx2ha"> </kbd><!>',1),AB=Le('<div class="shortcut-row svelte-idx2ha"><span class="keys svelte-idx2ha"></span> <span class="label svelte-idx2ha"> </span></div>'),NB=Le('<div class="section svelte-idx2ha"><div class="section-header svelte-idx2ha"> </div> <div class="section-items svelte-idx2ha"></div></div>'),CB=Le('<div class="dialog-backdrop" role="presentation"><div class="dialog glass-panel svelte-idx2ha" role="dialog" tabindex="-1" aria-modal="true" aria-labelledby="shortcuts-title"><div class="dialog-header"><span id="shortcuts-title">Keyboard Shortcuts</span> <button class="icon-btn ghost" aria-label="Close"><!></button></div> <div class="dialog-body svelte-idx2ha"></div> <div class="dialog-footer svelte-idx2ha">Press <kbd class="svelte-idx2ha">?</kbd> to toggle</div></div></div>');function PB(t,e){Mt(e,!0);function n(o){o.key==="Escape"&&e.onClose()}const i=[{category:"File",items:[{keys:["Ctrl","O"],description:"Open"},{keys:["Ctrl","S"],description:"Save"},{keys:["Ctrl","Shift","S"],description:"Save as"},{keys:["Ctrl","E"],description:"Export Python"}]},{category:"Edit",items:[{keys:["Ctrl","Z"],description:"Undo"},{keys:["Ctrl","Y"],description:"Redo"},{keys:["Ctrl","A"],description:"Select all"},{keys:["Ctrl","X"],description:"Cut"},{keys:["Ctrl","C"],description:"Copy"},{keys:["Ctrl","V"],description:"Paste"},{keys:["Ctrl","D"],description:"Duplicate"},{keys:["Del"],description:"Delete"},{keys:["Ctrl","F"],description:"Find"},{keys:["Esc"],description:"Deselect"}]},{category:"Transform",items:[{keys:["R"],description:"Rotate 90Â°"},{keys:["X"],description:"Flip H"},{keys:["Y"],description:"Flip V"},{keys:["Arrows"],description:"Nudge"},{keys:["Shift","Arrows"],description:"Nudge 10px"}]},{category:"View",items:[{keys:["F"],description:"Fit view"},{keys:["H"],description:"Go to root"},{keys:["+"],description:"Zoom in"},{keys:["-"],description:"Zoom out"},{keys:["L"],description:"Port labels"},{keys:["T"],description:"Theme"}]},{category:"Panels",items:[{keys:["S"],description:"Simulation"},{keys:["B"],description:"Blocks"},{keys:["N"],description:"Events"},{keys:["E"],description:"Editor"},{keys:["V"],description:"Results"},{keys:["C"],description:"Console"},{keys:["P"],description:"Pin plots"}]},{category:"Run",items:[{keys:["Ctrl","Enter"],description:"Simulate"},{keys:["Shift","Enter"],description:"Continue"},{keys:["?"],description:"Shortcuts"}]}];var r=Je();yn("keydown",$n,n);var s=He(r);{var a=o=>{var l=CB();l.__click=function(...y){e.onClose?.apply(this,y)};var c=ne(l);c.__click=y=>y.stopPropagation();var u=ne(c),f=we(ne(u),2);f.__click=function(...y){e.onClose?.apply(this,y)};var h=ne(f);Ot(h,{name:"x",size:16}),Q(f),Q(u);var d=we(u,2);cn(d,21,()=>i,Cn,(y,m)=>{var x=NB(),w=ne(x),S=ne(w,!0);Q(w);var A=we(w,2);cn(A,21,()=>p(m).items,Cn,(_,M)=>{var I=AB(),T=ne(I);cn(T,21,()=>p(M).keys,Cn,(W,C,N)=>{var B=kB(),E=He(B),R=ne(E,!0);Q(E);var q=we(E);{var Z=U=>{var X=SB();j(U,X)};Se(q,U=>{N<p(M).keys.length-1&&U(Z)})}Ae(()=>Ht(R,p(C))),j(W,B)}),Q(T);var D=we(T,2),O=ne(D,!0);Q(D),Q(I),Ae(()=>Ht(O,p(M).description)),j(_,I)}),Q(A),Q(x),Ae(()=>Ht(S,p(m).category)),j(y,x)}),Q(d),Mi(2),Q(c),Q(l),On(3,c,()=>fo,()=>({start:.95,duration:150,easing:Ea})),On(3,l,()=>Nr,()=>({duration:150})),j(o,l)};Se(s,o=>{e.open&&o(a)})}j(t,r),Tt()}Xn(["click"]);var EB=Le('<div class="empty-state svelte-1ijrao5"><p>Run simulation to see trace options</p></div>'),IB=nt('<line x1="2" y1="8" x2="30" y2="8" stroke-width="2"></line>'),LB=nt('<circle cx="16" cy="8" r="3"></circle>'),MB=nt('<rect x="13" y="5" width="6" height="6"></rect>'),TB=nt('<polygon points="16,3 20,11 12,11"></polygon>'),DB=nt('<line x1="2" y1="8" x2="30" y2="8" stroke="var(--text-disabled)" stroke-width="1" stroke-dasharray="2,2"></line>'),OB=Le('<button><svg width="20" height="10" viewBox="0 0 20 10"><line x1="2" y1="5" x2="18" y2="5" stroke="currentColor" stroke-width="2"></line></svg></button>'),FB=nt('<circle cx="7" cy="7" r="4" fill="currentColor"></circle>'),RB=nt('<rect x="3" y="3" width="8" height="8" fill="currentColor"></rect>'),BB=nt('<polygon points="7,2 12,11 2,11" fill="currentColor"></polygon>'),zB=Le('<button><svg width="10" height="10" viewBox="0 0 14 14"><!></svg></button>'),qB=Le('<div class="trace-row svelte-1ijrao5"><div class="col-preview svelte-1ijrao5"><svg width="32" height="16" viewBox="0 0 32 16"><!><!><!></svg></div> <div class="col-name svelte-1ijrao5"><span class="signal-label svelte-1ijrao5"> </span></div> <div class="col-line svelte-1ijrao5"></div> <div></div> <div class="col-marker svelte-1ijrao5"></div></div>'),jB=Le('<div class="block-card svelte-1ijrao5"><div class="block-header svelte-1ijrao5"><div class="block-title svelte-1ijrao5"><!> <span> </span></div> <div class="block-controls svelte-1ijrao5"><button title="Show legend">Legend</button> <button> </button> <button> </button></div></div> <div class="traces-table svelte-1ijrao5"><div class="table-header svelte-1ijrao5"><div class="col-preview svelte-1ijrao5">Preview</div> <div class="col-name svelte-1ijrao5"></div> <div class="col-line svelte-1ijrao5">Line</div> <div></div> <div class="col-marker svelte-1ijrao5">Marker</div></div> <!></div></div>'),HB=Le('<div class="dialog-backdrop" role="presentation"><div class="dialog glass-panel svelte-1ijrao5" role="dialog" tabindex="-1" aria-modal="true" aria-labelledby="plot-options-title"><div class="dialog-header"><span id="plot-options-title">Plot Options</span> <button class="icon-btn ghost" aria-label="Close"><!></button></div> <div class="dialog-body svelte-1ijrao5"><!></div></div></div>');function UB(t,e){Mt(e,!0);let n=ot(e,"traces",19,()=>[]),i=Fe(Rn({traces:{},blocks:{}}));const r=Cr.subscribe(_=>{$(i,_,!0)});Ai(()=>{r()});function s(_){_.key==="Escape"&&e.onClose()}function a(_){return p(i).traces[_]??{...Mm}}function o(_){return p(i).blocks[_]??{...Oh}}const l=[{value:"solid",label:"Solid"},{value:"dash",label:"Dash"},{value:"dot",label:"Dot"}],c=[{value:"circle",label:"Circle"},{value:"square",label:"Square"},{value:"triangle-up",label:"Triangle"}];function u(_,M){a(_).lineStyle===M?Cr.setTraceLineStyle(_,null):Cr.setTraceLineStyle(_,M)}function f(_,M){a(_).markerStyle===M?Cr.setTraceMarkerStyle(_,null):Cr.setTraceMarkerStyle(_,M)}function h(_){const M=o(_);Cr.setBlockXAxisScale(_,M.xAxisScale==="linear"?"log":"linear")}function d(_){const M=o(_);Cr.setBlockYAxisScale(_,M.yAxisScale==="linear"?"log":"linear")}function y(_){const M=o(_);Cr.setBlockShowLegend(_,!M.showLegend)}const m=re(()=>()=>{const _=new Map;for(const M of n()){const I=M.nodeId;_.has(I)||_.set(I,[]),_.get(I).push(M)}return _});function x(_){return _?pw[_]:""}var w=Je();yn("keydown",$n,s);var S=He(w);{var A=_=>{var M=HB();M.__click=function(...E){e.onClose?.apply(this,E)};var I=ne(M);I.__click=E=>E.stopPropagation();var T=ne(I),D=we(ne(T),2);D.__click=function(...E){e.onClose?.apply(this,E)};var O=ne(D);Ot(O,{name:"x",size:16}),Q(D),Q(T);var W=we(T,2),C=ne(W);{var N=E=>{var R=EB();j(E,R)},B=E=>{var R=Je(),q=He(R);cn(q,17,()=>[...p(m)()],Cn,(Z,U)=>{var X=re(()=>Mc(p(U),2));let de=()=>p(X)[0],le=()=>p(X)[1];const F=re(()=>le()[0]),V=re(()=>o(de()));var G=jB(),se=ne(G),ae=ne(se),te=ne(ae);{let Ue=re(()=>p(F).nodeType==="scope"?"activity":"bar-chart-2");Ot(te,{get name(){return p(Ue)},size:14})}var ue=we(te,2),pe=ne(ue,!0);Q(ue),Q(ae);var ge=we(ae,2),me=ne(ge);let Pe;me.__click=()=>y(de());var ke=we(me,2);let Ge;ke.__click=()=>h(de());var K=ne(ke);Q(ke);var Oe=we(ke,2);let Ke;Oe.__click=()=>d(de());var Be=ne(Oe);Q(Oe),Q(ge),Q(se);var Ee=we(se,2),at=we(ne(Ee),2);cn(at,17,le,Cn,(Ue,Ye,ut,Ft)=>{const be=re(()=>Tm(p(Ye).nodeId,p(Ye).signalIndex)),ze=re(()=>a(p(be))),ve=re(()=>fw(p(Ye).signalIndex,hw()));var Ce=qB(),Ie=ne(Ce),rt=ne(Ie),et=ne(rt);{var vt=xt=>{var dt=IB();Ae(Ut=>{he(dt,"stroke",p(ve)),he(dt,"stroke-dasharray",Ut)},[()=>x(p(ze).lineStyle)]),j(xt,dt)};Se(et,xt=>{p(ze).lineStyle&&xt(vt)})}var wt=we(et);{var Nt=xt=>{var dt=Je(),Ut=He(dt);{var ai=Ln=>{var ni=LB();Ae(()=>he(ni,"fill",p(ve))),j(Ln,ni)},bn=Ln=>{var ni=Je(),Ct=He(ni);{var oi=Sn=>{var Mn=MB();Ae(()=>he(Mn,"fill",p(ve))),j(Sn,Mn)},Hn=Sn=>{var Mn=Je(),Pn=He(Mn);{var qe=$e=>{var Pt=TB();Ae(()=>he(Pt,"fill",p(ve))),j($e,Pt)};Se(Pn,$e=>{p(ze).markerStyle==="triangle-up"&&$e(qe)},!0)}j(Sn,Mn)};Se(Ct,Sn=>{p(ze).markerStyle==="square"?Sn(oi):Sn(Hn,!1)},!0)}j(Ln,ni)};Se(Ut,Ln=>{p(ze).markerStyle==="circle"?Ln(ai):Ln(bn,!1)})}j(xt,dt)};Se(wt,xt=>{p(ze).markerStyle&&xt(Nt)})}var it=we(wt);{var kt=xt=>{var dt=DB();j(xt,dt)};Se(it,xt=>{!p(ze).lineStyle&&!p(ze).markerStyle&&xt(kt)})}Q(rt),Q(Ie);var ct=we(Ie,2),yt=ne(ct),st=ne(yt,!0);Q(yt),Q(ct);var gt=we(ct,2);cn(gt,21,()=>l,Cn,(xt,dt)=>{var Ut=OB();let ai;Ut.__click=()=>u(p(be),p(dt).value);var bn=ne(Ut),Ln=ne(bn);Q(bn),Q(Ut),Ae(ni=>{ai=Xt(Ut,1,"style-pill svelte-1ijrao5",null,ai,{active:p(ze).lineStyle===p(dt).value}),he(Ut,"title",p(dt).label),he(Ln,"stroke-dasharray",ni)},[()=>x(p(dt).value)]),j(xt,Ut)}),Q(gt);var Bt=we(gt,4);cn(Bt,21,()=>c,Cn,(xt,dt)=>{var Ut=zB();let ai;Ut.__click=()=>f(p(be),p(dt).value);var bn=ne(Ut),Ln=ne(bn);{var ni=oi=>{var Hn=FB();j(oi,Hn)},Ct=oi=>{var Hn=Je(),Sn=He(Hn);{var Mn=qe=>{var $e=RB();j(qe,$e)},Pn=qe=>{var $e=Je(),Pt=He($e);{var tn=Wt=>{var Gt=BB();j(Wt,Gt)};Se(Pt,Wt=>{p(dt).value==="triangle-up"&&Wt(tn)},!0)}j(qe,$e)};Se(Sn,qe=>{p(dt).value==="square"?qe(Mn):qe(Pn,!1)},!0)}j(oi,Hn)};Se(Ln,oi=>{p(dt).value==="circle"?oi(ni):oi(Ct,!1)})}Q(bn),Q(Ut),Ae(()=>{ai=Xt(Ut,1,"style-pill marker-pill svelte-1ijrao5",null,ai,{active:p(ze).markerStyle===p(dt).value}),he(Ut,"title",p(dt).label)}),j(xt,Ut)}),Q(Bt),Q(Ce),Ae(()=>Ht(st,p(Ye).signalLabel)),j(Ue,Ce)}),Q(Ee),Q(G),Ae(()=>{Ht(pe,p(F).nodeName),Pe=Xt(me,1,"scale-btn svelte-1ijrao5",null,Pe,{active:p(V).showLegend}),Ge=Xt(ke,1,"scale-btn svelte-1ijrao5",null,Ge,{log:p(V).xAxisScale==="log"}),he(ke,"title",`X-Axis: ${p(V).xAxisScale??""}`),Ht(K,`X:${p(V).xAxisScale==="log"?"log":"lin"}`),Ke=Xt(Oe,1,"scale-btn svelte-1ijrao5",null,Ke,{log:p(V).yAxisScale==="log"}),he(Oe,"title",`Y-Axis: ${p(V).yAxisScale??""}`),Ht(Be,`Y:${p(V).yAxisScale==="log"?"log":"lin"}`)}),j(Z,G)}),j(E,R)};Se(C,E=>{n().length===0?E(N):E(B,!1)})}Q(W),Q(I),Q(M),On(3,I,()=>fo,()=>({start:.95,duration:150,easing:Ea})),On(3,M,()=>Nr,()=>({duration:150})),j(_,M)};Se(S,_=>{e.open&&_(A)})}j(t,w),Tt()}Xn(["click"]);var WB=Le('<button class="clear-btn svelte-g23ysy"><!></button>'),VB=Le('<button><div class="result-main svelte-g23ysy"><span class="node-name svelte-g23ysy"> </span> <span class="node-type svelte-g23ysy"> </span></div> <div class="result-path svelte-g23ysy"> </div></button>'),GB=Le('<div class="results svelte-g23ysy"></div>'),XB=Le('<div class="no-results svelte-g23ysy">No blocks found</div>'),YB=Le('<div class="dialog-backdrop" role="presentation"><div class="search-dialog glass-panel svelte-g23ysy" role="dialog" tabindex="-1" aria-modal="true"><div class="search-container svelte-g23ysy"><span class="search-icon svelte-g23ysy"><!></span> <input type="text" placeholder="Find block..." class="search-input svelte-g23ysy"/> <!></div> <!> <div class="footer svelte-g23ysy"><span><kbd class="svelte-g23ysy">â</kbd><kbd class="svelte-g23ysy">â</kbd> navigate</span> <span><kbd class="svelte-g23ysy">âµ</kbd> select</span> <span><kbd class="svelte-g23ysy">esc</kbd> close</span></div></div></div>');function KB(t,e){Mt(e,!0);let n=Fe(""),i=Fe(void 0),r=Fe(0),s=Fe(Rn([])),a=Fe(Rn([]));const o=Re.currentPath.subscribe(x=>{$(a,x,!0)});Ai(()=>{o()}),pn(()=>{e.open&&$(s,Re.getAllNodesWithPaths(),!0)});function l(x){return x.path.length!==p(a).length?!1:x.path.every((w,S)=>w===p(a)[S])}const c=re(()=>()=>{let x=p(s);if(p(n).trim()){const w=p(n).toLowerCase();x=x.filter(S=>S.node.name.toLowerCase().includes(w)||S.node.type.toLowerCase().includes(w))}return[...x].sort((w,S)=>{const A=l(w),_=l(S);return A&&!_?-1:!A&&_?1:w.depth-S.depth})});pn(()=>{e.open&&($(n,""),$(r,0),setTimeout(()=>p(i)?.focus(),50))}),pn(()=>{const x=p(c)();p(r)>=x.length&&$(r,Math.max(0,x.length-1),!0)});function u(x){if(!e.open)return;const w=p(c)();if(x.key==="Escape")e.onClose();else if(x.key==="ArrowDown")x.preventDefault(),$(r,Math.min(p(r)+1,w.length-1),!0);else if(x.key==="ArrowUp")x.preventDefault(),$(r,Math.max(p(r)-1,0),!0);else if(x.key==="Enter"){x.preventDefault();const S=w[p(r)];S&&f(S)}}function f(x){const w=x.path,S=Re.getCurrentPath();w.length===S.length&&w.every((_,M)=>_===S[M])||Re.navigateToPath(w),Re.selectNode(x.node.id,!1),e8(x.node.id),e.onClose()}function h(x){return x.join(" > ")}var d=Je();yn("keydown",$n,u);var y=He(d);{var m=x=>{var w=YB();w.__click=function(...N){e.onClose?.apply(this,N)},w.__keydown=N=>N.key==="Escape"&&e.onClose();var S=ne(w);S.__click=N=>N.stopPropagation();var A=ne(S),_=ne(A),M=ne(_);Ot(M,{name:"search",size:14}),Q(_);var I=we(_,2);jr(I),Fi(I,N=>$(i,N),()=>p(i));var T=we(I,2);{var D=N=>{var B=WB();B.__click=()=>$(n,"");var E=ne(B);Ot(E,{name:"x",size:12}),Q(B),j(N,B)};Se(T,N=>{p(n)&&N(D)})}Q(A);var O=we(A,2);{var W=N=>{var B=GB();cn(B,21,()=>p(c)(),Cn,(E,R,q)=>{var Z=VB();let U;Z.__click=()=>f(p(R));var X=ne(Z),de=ne(X),le=ne(de,!0);Q(de);var F=we(de,2),V=ne(F,!0);Q(F),Q(X);var G=we(X,2),se=ne(G,!0);Q(G),Q(Z),Ae(ae=>{U=Xt(Z,1,"result-item svelte-g23ysy",null,U,{selected:q===p(r)}),Ht(le,p(R).node.name),Ht(V,p(R).node.type),Ht(se,ae)},[()=>h(p(R).pathNames)]),yn("mouseenter",Z,()=>$(r,q,!0)),j(E,Z)}),Q(B),j(N,B)},C=N=>{var B=Je(),E=He(B);{var R=q=>{var Z=XB();j(q,Z)};Se(E,q=>{p(n)&&q(R)},!0)}j(N,B)};Se(O,N=>{p(c)().length>0?N(W):N(C,!1)})}Mi(2),Q(S),Q(w),xb(I,()=>p(n),N=>$(n,N)),On(3,S,()=>fo,()=>({start:.95,duration:150,easing:Ea})),On(3,w,()=>Nr,()=>({duration:100})),j(x,w)};Se(y,x=>{e.open&&x(m)})}j(t,d),Tt()}Xn(["click","keydown"]);const Bl=12,eb=52,Vo=300,L_=68;var ZB=Le('<div class="resize-handle handle-left svelte-1xkowuz"></div>'),JB=Le('<div class="resize-handle handle-right svelte-1xkowuz"></div>'),QB=Le('<div class="resize-handle handle-top svelte-1xkowuz"></div>'),$B=Le('<div class="resize-handle handle-bottom svelte-1xkowuz"></div>'),ez=Le("<span> </span>"),tz=Le('<div class="panel-toolbar svelte-1xkowuz"><!></div>'),nz=Le('<div class="panel-footer svelte-1xkowuz"><!></div>'),iz=Le('<aside><!> <!> <!> <!> <div class="panel-header svelte-1xkowuz"><!> <div class="header-actions svelte-1xkowuz"><!> <button class="icon-btn ghost" aria-label="Close"><!></button></div></div> <!> <div class="panel-content svelte-1xkowuz"><!></div> <!></aside>');function tu(t,e){Mt(e,!0);let n=ot(e,"initialWidth",3,320),i=ot(e,"initialHeight",3,280),r=ot(e,"minWidth",3,200),s=ot(e,"minHeight",3,150),a=ot(e,"maxWidth",3,800),o=ot(e,"bottomOffset",3,0),l=ot(e,"currentHeight",15,280);function c(){return e.maxHeight!==void 0?e.maxHeight:e.position.includes("bottom")?window.innerHeight-L_-Bl*2:600}let u=Fe(Rn(ea(()=>n()))),f=Fe(Rn(ea(()=>i())));function h(){return e.width??p(u)}function d(ge){e.onWidthChange?e.onWidthChange(ge):$(u,ge,!0)}pn(()=>{l(p(f))});let y=Fe(!1),m=Fe(null);const x=re(()=>e.position==="left"||e.position==="right"?`max-height: calc(100vh - 80px${o()>0?` - ${o()}px`:""});`:""),w=re(()=>()=>{switch(e.position){case"left":return{right:!0,bottom:!0};case"right":return{left:!0,bottom:!0};case"bottom":return{top:!0};case"bottom-left":return{top:!0,right:!0};case"bottom-right":return{top:!0,left:!0};default:return{}}}),S=re(()=>()=>{switch(e.position){case"left":return{x:-20};case"right":return{x:20};case"bottom":case"bottom-left":case"bottom-right":return{y:20};default:return{x:0}}});let A=null;function _(ge){return me=>{me.preventDefault(),$(y,!0),$(m,ge,!0);const Pe=me.clientX,ke=me.clientY,Ge=h(),K=p(f);function Oe(Ee){if(!p(y))return;const at=Ee.clientX-Pe,Ue=Ee.clientY-ke;if(p(m)==="right"){const Ye=Math.max(r(),Ge+at);d(e.onWidthChange?Ye:Math.min(a(),Ye))}else if(p(m)==="left"){const Ye=Math.max(r(),Ge-at);d(e.onWidthChange?Ye:Math.min(a(),Ye))}else p(m)==="bottom"?$(f,Math.min(c(),Math.max(s(),K+Ue)),!0):p(m)==="top"&&$(f,Math.min(c(),Math.max(s(),K-Ue)),!0)}function Ke(){document.removeEventListener("mousemove",Oe),document.removeEventListener("mouseup",Be),document.body.classList.remove("resizing-ew","resizing-ns"),A=null}function Be(){$(y,!1),$(m,null),Ke()}A=Ke,document.addEventListener("mousemove",Oe),document.addEventListener("mouseup",Be),document.body.classList.add(ge==="left"||ge==="right"?"resizing-ew":"resizing-ns")}}Ai(()=>{A?.()});var M=iz();let I;M.__mousedown=()=>Re.clearSelection();var T=ne(M);{var D=ge=>{var me=ZB(),Pe=re(()=>_("left"));me.__mousedown=function(...ke){p(Pe)?.apply(this,ke)},j(ge,me)};Se(T,ge=>{p(w)().left&&ge(D)})}var O=we(T,2);{var W=ge=>{var me=JB(),Pe=re(()=>_("right"));me.__mousedown=function(...ke){p(Pe)?.apply(this,ke)},j(ge,me)};Se(O,ge=>{p(w)().right&&ge(W)})}var C=we(O,2);{var N=ge=>{var me=QB(),Pe=re(()=>_("top"));me.__mousedown=function(...ke){p(Pe)?.apply(this,ke)},j(ge,me)};Se(C,ge=>{p(w)().top&&ge(N)})}var B=we(C,2);{var E=ge=>{var me=$B(),Pe=re(()=>_("bottom"));me.__mousedown=function(...ke){p(Pe)?.apply(this,ke)},j(ge,me)};Se(B,ge=>{p(w)().bottom&&ge(E)})}var R=we(B,2),q=ne(R);{var Z=ge=>{var me=Je(),Pe=He(me);vs(Pe,()=>e.header),j(ge,me)},U=ge=>{var me=ez(),Pe=ne(me,!0);Q(me),Ae(()=>Ht(Pe,e.title)),j(ge,me)};Se(q,ge=>{e.header?ge(Z):ge(U,!1)})}var X=we(q,2),de=ne(X);{var le=ge=>{var me=Je(),Pe=He(me);vs(Pe,()=>e.actions),j(ge,me)};Se(de,ge=>{e.actions&&ge(le)})}var F=we(de,2);F.__click=function(...ge){e.onClose?.apply(this,ge)};var V=ne(F);Ot(V,{name:"x",size:16}),Q(F),Q(X),Q(R);var G=we(R,2);{var se=ge=>{var me=tz(),Pe=ne(me);vs(Pe,()=>e.toolbar),Q(me),j(ge,me)};Se(G,ge=>{e.toolbar&&ge(se)})}var ae=we(G,2),te=ne(ae);vs(te,()=>e.children??Qs),Q(ae);var ue=we(ae,2);{var pe=ge=>{var me=nz(),Pe=ne(me);vs(Pe,()=>e.footer),Q(me),j(ge,me)};Se(ue,ge=>{e.footer&&ge(pe)})}Q(M),Ae((ge,me,Pe)=>{I=Xt(M,1,`resizable-panel glass-panel ${e.position??""}`,"svelte-1xkowuz",I,{resizing:p(y)}),Nn(M,`
		${ge??""}
		${me??""}
		${Pe??""}
		${p(x)??""}
	`)},[()=>e.position==="left"||e.position==="right"?`width: ${h()}px;`:"",()=>(e.position==="bottom-left"||e.position==="bottom-right")&&e.width!==void 0?`width: ${h()}px;`:"",()=>e.position.includes("bottom")?`height: ${p(f)}px;`:""]),On(3,M,()=>h1,()=>({...p(S)(),duration:200,easing:Ea})),j(t,M),Tt()}Xn(["mousedown","click"]);var rz=Le('<a class="example-card svelte-1tjvg83"><div class="example-info svelte-1tjvg83"><div class="example-name svelte-1tjvg83"> </div> <div class="example-description svelte-1tjvg83"> </div></div> <div class="example-preview svelte-1tjvg83"><img class="svelte-1tjvg83"/></div></a>'),sz=Le('<div class="dialog-backdrop" role="presentation"><div class="modal glass-panel svelte-1tjvg83" role="dialog" tabindex="-1"><div class="version-info svelte-1tjvg83"> </div> <div class="header svelte-1tjvg83"><img alt="PathView" class="logo svelte-1tjvg83"/></div> <div class="actions svelte-1tjvg83"><button class="action-card svelte-1tjvg83"><!> <span class="action-label svelte-1tjvg83">New</span></button> <a href="https://pathsim.org" target="_blank" class="action-card svelte-1tjvg83"><!> <span class="action-label svelte-1tjvg83">Home</span></a> <a href="https://docs.pathsim.org" target="_blank" class="action-card svelte-1tjvg83"><!> <span class="action-label svelte-1tjvg83">Docs</span></a> <a href="https://github.com/pathsim/pathview" target="_blank" class="action-card svelte-1tjvg83"><!> <span class="action-label svelte-1tjvg83">GitHub</span></a> <a href="https://github.com/pathsim/pathview/issues/new/choose" target="_blank" class="action-card svelte-1tjvg83"><!> <span class="action-label svelte-1tjvg83">Issue</span></a> <a href="https://milanrother.com/#services" target="_blank" class="action-card svelte-1tjvg83"><!> <span class="action-label svelte-1tjvg83">Consulting</span></a></div> <div class="separator svelte-1tjvg83"></div> <div class="examples-section svelte-1tjvg83"><div class="examples-grid svelte-1tjvg83"></div></div></div></div>');function az(t,e){Mt(e,!0);const n=[{filename:"feedback-system.json",basename:"feedback-system",name:"Feedback System",description:"Linear feedback system with delayed step excitation"},{filename:"harmonic-oscillator.json",basename:"harmonic-oscillator",name:"Harmonic Oscillator",description:"Linear spring-mass-damper system"},{filename:"squarewave-lpf.json",basename:"squarewave-lpf",name:"Squarewave LPF",description:"Low pass filtering of a square wave"},{filename:"pid-subsystem.json",basename:"pid-subsystem",name:"PID Loop",description:"Classic PID control loop as subsystem"},{filename:"thermostat.json",basename:"thermostat",name:"Thermostat",description:"Relay based thermostat heating system"},{filename:"cascade-subsystem.json",basename:"cascade-subsystem",name:"Cascade PI",description:"Cascade PI controller with subsystems"},{filename:"bouncing-ball.json",basename:"bouncing-ball",name:"Bouncing Ball",description:"Bouncing ball with event-based collision"},{filename:"fmcw-radar.json",basename:"fmcw-radar",name:"FMCW Radar",description:"Frequency-modulated continuous wave radar"},{filename:"vanderpol.json",basename:"vanderpol",name:"Van der Pol",description:"Van der Pol oscillator system"}];let i=Fe(!0);Du(()=>{const C=()=>{$(i,document.documentElement.getAttribute("data-theme")!=="light")};C();const N=new MutationObserver(C);return N.observe(document.documentElement,{attributes:!0,attributeFilter:["data-theme"]}),()=>N.disconnect()});function r(){e.onNew(),e.onClose()}function s(C){C.key==="Escape"&&e.onClose()}var a=sz();yn("keydown",$n,s),a.__click=function(...C){e.onClose?.apply(this,C)},a.__keydown=C=>C.key==="Escape"&&e.onClose();var o=ne(a);o.__click=C=>C.stopPropagation();var l=ne(o),c=ne(l);Q(l);var u=we(l,2),f=ne(u);Q(u);var h=we(u,2),d=ne(h);d.__click=r;var y=ne(d);Ot(y,{name:"new-canvas",size:20}),Mi(2),Q(d);var m=we(d,2),x=ne(m);Ot(x,{name:"home",size:20}),Mi(2),Q(m);var w=we(m,2),S=ne(w);Ot(S,{name:"book",size:20}),Mi(2),Q(w);var A=we(w,2),_=ne(A);Ot(_,{name:"github",size:20}),Mi(2),Q(A);var M=we(A,2),I=ne(M);Ot(I,{name:"alert-triangle",size:20}),Mi(2),Q(M);var T=we(M,2),D=ne(T);Ot(D,{name:"activity",size:20}),Mi(2),Q(T),Q(h);var O=we(h,4),W=ne(O);cn(W,21,()=>n,Cn,(C,N)=>{var B=rz(),E=ne(B),R=ne(E),q=ne(R,!0);Q(R);var Z=we(R,2),U=ne(Z,!0);Q(Z),Q(E);var X=we(E,2),de=ne(X);Q(X),Q(B),Ae(()=>{he(B,"href",`?model=${hd??""}/examples/${p(N).filename??""}`),Ht(q,p(N).name),Ht(U,p(N).description),he(de,"src",`${hd??""}/examples/screenshots/${p(N).basename??""}-${p(i)?"dark":"light"}.png`),he(de,"alt",`${p(N).name??""} preview`)}),yn("error",de,le=>{le.currentTarget.style.display="none"}),B3(de),j(C,B)}),Q(W),Q(O),Q(o),Q(a),Ae(C=>{Ht(c,`PathView ${AP} Â· ${C??""}`),he(f,"src",`${hd??""}/pathview_logo.png`)},[()=>Object.entries(NP).map(([C,N])=>`${C.replace("_","-")} ${N}`).join(" Â· ")]),On(3,o,()=>fo,()=>({start:.95,duration:200,easing:Ea})),On(3,a,()=>Nr,()=>({duration:150})),j(t,a),Tt()}Xn(["click","keydown"]);var oz=Le("<button><!></button>"),lz=Le('<nav class="breadcrumb glass-panel svelte-terbma"></nav>');function cz(t,e){Mt(e,!0);let n=Fe(Rn([])),i=Fe(!0);const r=Re.breadcrumbs.subscribe(u=>{$(n,u,!0),$(i,u.length<=1)});Ai(r);function s(u){Re.navigateTo(u)}function a(u,f){(u.key==="Enter"||u.key===" ")&&(u.preventDefault(),s(f))}var o=Je(),l=He(o);{var c=u=>{var f=lz();cn(f,21,()=>p(n),Cn,(h,d,y)=>{var m=oz();let x;m.__click=()=>s(y),m.__keydown=_=>a(_,y);var w=ne(m);{var S=_=>{Ot(_,{name:"home",size:14})},A=_=>{var M=tb();Ae(()=>Ht(M,p(d).name)),j(_,M)};Se(w,_=>{y===0?_(S):_(A,!1)})}Q(m),Ae(()=>{x=Xt(m,1,"crumb-pill svelte-terbma",null,x,{current:y===p(n).length-1}),m.disabled=y===p(n).length-1}),j(h,m)}),Q(f),On(3,f,()=>h1,()=>({y:-10,duration:150})),j(u,f)};Se(l,u=>{p(i)||u(c)})}j(t,o),Tt()}Xn(["click","keydown"]);var uz=Le('<div class="dialog-backdrop" role="presentation"><div class="confirmation-dialog glass-panel svelte-nz2mwq" role="alertdialog" aria-modal="true" aria-labelledby="confirmation-title" aria-describedby="confirmation-message"><div class="dialog-header"><span id="confirmation-title"> </span> <button class="icon-btn" aria-label="Close"><!></button></div> <div class="dialog-body svelte-nz2mwq"><p id="confirmation-message" class="svelte-nz2mwq"> </p></div> <div class="dialog-actions svelte-nz2mwq"><button class="ghost svelte-nz2mwq"> </button> <button class="svelte-nz2mwq"> </button></div></div></div>');function dz(t,e){Mt(e,!0);let n=Fe(Rn({open:!1,options:null}));bd.subscribe(u=>{$(n,{open:u.open,options:u.options},!0)});function i(){bd.confirm()}function r(){bd.cancel()}function s(u){u.target===u.currentTarget&&r()}function a(u){p(n).open&&(u.key==="Escape"?r():u.key==="Enter"&&i())}var o=Je();yn("keydown",$n,a);var l=He(o);{var c=u=>{var f=uz();f.__click=s;var h=ne(f),d=ne(h),y=ne(d),m=ne(y,!0);Q(y);var x=we(y,2);x.__click=r;var w=ne(x);Ot(w,{name:"x",size:16}),Q(x),Q(d);var S=we(d,2),A=ne(S),_=ne(A,!0);Q(A),Q(S);var M=we(S,2),I=ne(M);I.__click=r;var T=ne(I,!0);Q(I);var D=we(I,2);D.__click=i;var O=ne(D,!0);Q(D),Q(M),Q(h),Q(f),Ae(()=>{Ht(m,p(n).options.title),Ht(_,p(n).options.message),Ht(T,p(n).options.cancelText),Ht(O,p(n).options.confirmText)}),On(3,h,()=>fo,()=>({start:.95,duration:150,easing:Ea})),On(3,f,()=>Nr,()=>({duration:150})),j(u,f)};Se(l,u=>{p(n).open&&p(n).options&&u(c)})}j(t,o),Tt()}Xn(["click"]);var fz=Le('<link rel="icon" type="image/png"/>'),hz=Le('<button class="toolbar-btn stop svelte-1uha8ag" aria-label="Stop"><!></button>'),pz=Le('<span class="loading-status svelte-1uha8ag"> </span> <span class="spinner svelte-1uha8ag"><!></span>',1),gz=Le('<div><button aria-label="Run"><!></button></div>'),mz=Le('<span class="icon-crossfade-item svelte-1uha8ag"><!></span>'),vz=Le('<span class="icon-crossfade-item svelte-1uha8ag"><!></span>'),yz=Le('<span class="icon-crossfade-item svelte-1uha8ag"><!></span>'),bz=Le('<span class="icon-crossfade-item svelte-1uha8ag"><!></span>'),wz=Le('<div class="panel-padding svelte-1uha8ag"><!></div>'),xz=Le('<button><!> <span class="header-tab-title svelte-1uha8ag"> </span></button>'),_z=Le('<div class="header-tabs svelte-1uha8ag"></div>'),Sz=Le("<span>Results</span> <!>",1),kz=Le('<button class="icon-btn ghost"><!></button>'),Az=Le('<!> <button class="icon-btn ghost" aria-label="Plot options"><!></button>',1),Nz=Le("<span>Console</span>"),Cz=Le('<button class="icon-btn ghost" aria-label="Clear console"><!></button>'),Pz=Le('<div class="app svelte-1uha8ag"><button class="logo-overlay svelte-1uha8ag" aria-label="Welcome"><img alt="PathView" class="svelte-1uha8ag"/></button> <div class="canvas-layer svelte-1uha8ag"><!></div> <div class="subsystem-breadcrumb svelte-1uha8ag"><!></div>  <div class="toolbar-container svelte-1uha8ag"><div class="toolbar-group svelte-1uha8ag"><!> <button aria-label="Continue"><!></button></div> <div class="toolbar-group svelte-1uha8ag"><button class="toolbar-btn svelte-1uha8ag" aria-label="New"><!></button> <button class="toolbar-btn svelte-1uha8ag" aria-label="Open/Import"><!></button> <button class="toolbar-btn svelte-1uha8ag" aria-label="Save"><span class="icon-crossfade svelte-1uha8ag"><!></span></button> <button class="toolbar-btn svelte-1uha8ag" aria-label="Save As"><span class="icon-crossfade svelte-1uha8ag"><!></span></button> <button class="toolbar-btn svelte-1uha8ag" aria-label="View Python Code"><!></button></div> <div class="toolbar-group svelte-1uha8ag"><button class="toolbar-btn svelte-1uha8ag" aria-label="Keyboard shortcuts"><!></button></div></div>  <div class="panel-toggles svelte-1uha8ag"><div class="toggle-group svelte-1uha8ag"><button aria-label="Blocks"><!></button> <button aria-label="Events"><!></button> <button aria-label="Editor"><!></button></div> <div class="toggle-group svelte-1uha8ag"><button aria-label="Results"><!></button> <button aria-label="Console"><!></button></div> <div class="toggle-group svelte-1uha8ag"><button aria-label="Simulation"><!></button></div> <div class="toggle-group svelte-1uha8ag"><button aria-label="Pin Previews"><!></button> <button class="toggle-btn svelte-1uha8ag" aria-label="Toggle theme"><!></button></div></div> <!> <!> <!> <!> <!> <!> <!> <!> <!> <!> <!> <!> <!> <!> <!> <!> <!></div>');function zz(t,e){Mt(e,!0);const n=()=>O0(c7,"$currentFileName",r),i=()=>O0(jh,"$codePreviewStore",r),[r,s]=z3();let a=Fe(Rn({x:0,y:0})),o=Fe(null),l;function c(b){clearTimeout(l),$(o,b,!0),l=setTimeout(()=>{$(o,null)},1500)}async function u(){await p7()&&c("save")}async function f(){await Rw()&&c("save-as")}let h=Fe(!1),d=Fe(!1),y=Fe(!1),m=Fe(!1),x=Fe(!1),w=Fe(!1),S=Fe(280),A=Fe(280),_=Fe(.5),M=Fe(!1),I=Fe(!1),T=Fe(!1);function D(){if(typeof window>"u")return null;const b=new URLSearchParams(window.location.search),P=b.get("model"),J=b.get("modelgh");return P?{url:P,isGitHub:!1}:J?{url:J,isGitHub:!0}:null}const O=D();let W=Fe(!O),C=Fe(void 0),N=Fe(void 0),B=Fe(320),E=Fe(280),R=Fe(400);const q=310;let Z=Fe(Rn(typeof window<"u"?window.innerWidth:1920)),U=Fe(Rn(typeof window<"u"?window.innerHeight:1080));function X(){return typeof window>"u"?800:window.innerWidth-eb-Bl*3}const de=re(()=>p(x)&&p(w)?X()-Vo:void 0);pn(()=>{if(p(x)&&p(w)){if(p(C)===void 0||p(N)===void 0){const b=X(),P=Math.floor(b*p(_));$(C,P,!0),$(N,b-P)}}else $(C,void 0),$(N,void 0)});function le(b){if(!p(x)||!p(w))return;const P=X(),J=Math.max(Vo,Math.min(P-Vo,b));$(C,J,!0),$(N,P-J),$(_,J/P)}function F(b){if(!p(x)||!p(w))return;const P=X(),J=Math.max(Vo,Math.min(P-Vo,b));$(N,J,!0),$(C,P-J),$(_,(P-J)/P)}function V(){if($(Z,window.innerWidth,!0),$(U,window.innerHeight,!0),p(x)&&p(w)&&p(C)!==void 0&&p(N)!==void 0){const b=X(),P=Math.max(Vo,Math.min(b-Vo,Math.floor(b*p(_))));$(C,P,!0),$(N,b-P)}}const G=12,se=5,ae=40,te=50,ue=re(()=>()=>!p(x)&&!p(w)?0:p(x)&&p(w)?p(A)+G:(p(x)?p(S):p(A))+G);function pe(){p(d)?$(d,!1):($(y,!1),$(d,!0),setTimeout(()=>p(Ge)?.focus(),50))}function ge(){p(y)?$(y,!1):($(d,!1),$(y,!0))}function me(){p(h)?$(h,!1):($(m,!1),$(h,!0))}function Pe(){p(m)?$(m,!1):($(h,!1),$(m,!0),setTimeout(()=>p(K)?.focus(),50))}const ke=re(()=>()=>!p(x)&&!p(w)?0:p(x)&&p(w)?p(S)+G:(p(x)?p(S):p(A))+G);pn(()=>{if(typeof window>"u")return;p(Z),p(U),p(B),p(E),p(R);const b=p(d)?p(B):p(y)?p(E):0,P=eb+Bl+(b>0?b+Bl:0),J=p(m)?p(R):p(h)?q:0,fe=(J>0?J+Bl:0)+20;let ye=20;p(x)&&p(w)?ye=Math.max(p(S),p(A))+Bl+20:p(x)?ye=p(S)+Bl+20:p(w)&&(ye=p(A)+Bl+20);const Te=L_+20;ZC({top:Te,right:fe,bottom:ye,left:P})});let Ge=Fe(void 0),K=Fe(void 0),Oe=Fe(!1),Ke=Fe(!1),Be=Fe(!1),Ee=Fe(!1),at=Fe(!1),Ue=Fe(Rn({x:0,y:0})),Ye=Fe(null);const ut={toggleNodeLibrary:pe,toggleEventsPanel:ge,deleteNodes:be};function Ft(){return bB(p(Ye),p(Ue),ut)}function be(b){b.length!==0&&It.mutate(()=>{for(const P of b)Re.removeNode(P)})}let ze=Fe(0),ve=Fe(!1),Ce=Fe(!1),Ie=Fe(!1),rt=!1,et=!1,vt=Fe(!1),wt=Fe("Ready"),Nt=Fe("dark"),it=Fe(0),kt=Fe(0),ct=Fe("tabs"),yt=Fe(Rn([])),st=Fe(Rn([]));const gt={text:"Continue",shortcut:"Shift+Enter"};Du(()=>{MP().then(()=>LP());const b=ih.subscribe(_t=>{$(M,_t,!0)}),P=to.subscribe(_t=>{$(at,_t.open,!0),$(Ue,_t.position,!0),$(Ye,_t.target,!0)}),J=al.subscribe(_t=>{$(Nt,_t,!0)}),fe=Re.nodesArray.subscribe(_t=>{$(ze,_t.length,!0)}),ye=Bu.subscribe(_t=>{$(ve,_t.initialized,!0),$(Ce,_t.loading,!0),_t.loading?$(wt,_t.progress||"Loading...",!0):_t.error?$(wt,`Error: ${_t.error}`):_t.initialized&&$(wt,"Ready")}),Te=Vi.subscribe(_t=>{$(Ie,_t.phase==="running"),$(vt,_t.result!==null),_t.phase==="running"?$(wt,_t.progress||"Simulating...",!0):_t.error?$(wt,`Error: ${_t.error}`):p(ve)&&$(wt,"Ready");const hn=[],gn=[];_t.result?.scopeData&&Object.entries(_t.result.scopeData).forEach(([dn,mn],zn)=>{const Bi=_t.result?.nodeNames?.[dn]||`Scope ${zn+1}`;hn.push({id:dn,type:"scope",title:Bi});for(let Kn=0;Kn<mn.signals.length;Kn++)gn.push({nodeId:dn,nodeType:"scope",nodeName:Bi,signalIndex:Kn,signalLabel:mn.labels?.[Kn]||`port ${Kn}`})}),_t.result?.spectrumData&&Object.entries(_t.result.spectrumData).forEach(([dn,mn],zn)=>{const Bi=_t.result?.nodeNames?.[dn]||`Spectrum ${zn+1}`;hn.push({id:dn,type:"spectrum",title:Bi});for(let Kn=0;Kn<mn.magnitude.length;Kn++)gn.push({nodeId:dn,nodeType:"spectrum",nodeName:Bi,signalIndex:Kn,signalLabel:mn.labels?.[Kn]||`port ${Kn}`})}),$(yt,hn,!0),$(st,gn,!0),p(kt)>=hn.length&&hn.length>0&&$(kt,0)}),We=yi.subscribe(_t=>{$(it,_t.length,!0)});Fw();const pt=v7(3e4),ht=Re.nodesArray.subscribe(()=>{u2()}),Rt=Re.connections.subscribe(()=>{u2()}),jt=()=>dt(),Vt=()=>{p(vt)&&p(ve)&&!p(Ie)&&!et&&Ut()};return window.addEventListener("run-simulation",jt),window.addEventListener("continue-simulation",Vt),ni(),()=>{b(),P(),J(),fe(),ye(),Te(),We(),pt(),ht(),Rt(),window.removeEventListener("run-simulation",jt),window.removeEventListener("continue-simulation",Vt)}});function Bt(b){const P=E5(b);if(b.shiftKey&&b.key==="Enter"){b.preventDefault(),p(vt)&&p(ve)&&!p(Ie)&&!et&&Ut();return}if(b.metaKey||b.ctrlKey)switch(b.key.toLowerCase()){case"s":b.preventDefault(),b.shiftKey?f():u();return;case"o":b.preventDefault(),bn();return;case"e":b.preventDefault(),$(Oe,!0);return;case"f":b.preventDefault(),$(Be,!0);return;case"d":b.preventDefault(),It.mutate(()=>Re.duplicateSelected());return;case"c":P||(b.preventDefault(),co.copy());return;case"x":P||(b.preventDefault(),co.cut());return;case"v":if(!P){b.preventDefault();const J=oo(p(a));co.paste(J)}return;case"a":P||(b.preventDefault(),Re.selectAll());return;case"z":b.preventDefault(),b.shiftKey?It.redo():It.undo();return;case"y":b.preventDefault(),It.redo();return;case"enter":b.preventDefault(),dt();return}if(!P)switch(b.key){case"Escape":p(at)?to.close():p(Oe)?$(Oe,!1):p(Ke)?$(Ke,!1):Tv()?md():p(Ie)?Hv():p(w)?$(w,!1):p(x)?$(x,!1):p(m)?$(m,!1):p(d)?$(d,!1):p(y)?$(y,!1):p(h)&&$(h,!1);return;case"f":b.preventDefault(),rl();return;case"s":b.preventDefault(),me();return;case"e":b.preventDefault(),Pe();return;case"v":b.preventDefault(),$(x,!p(x));return;case"c":b.preventDefault(),$(w,!p(w));return;case"p":b.preventDefault(),ih.toggle();return;case"l":b.preventDefault(),q1.toggle();return;case"b":b.preventDefault(),pe();return;case"n":b.preventDefault(),ge();return;case"h":b.preventDefault(),Re.isAtRoot()||Re.navigateTo(0);return;case"t":b.preventDefault(),al.toggle();return;case"+":case"=":!b.ctrlKey&&!b.metaKey&&(b.preventDefault(),JC());return;case"-":!b.ctrlKey&&!b.metaKey&&(b.preventDefault(),QC());return;case"?":b.preventDefault(),$(Ke,!p(Ke));return;case"ArrowUp":case"ArrowDown":case"ArrowLeft":case"ArrowRight":b.preventDefault(),xt(b.key,b.shiftKey);return}}function xt(b,P){const J=Tv(),fe=P?Fn*5:Fn*2,ye=P?Fn*2:Fn,Te={x:0,y:0};switch(b){case"ArrowUp":Te.y=J?-ye:fe;break;case"ArrowDown":Te.y=J?ye:-fe;break;case"ArrowLeft":Te.x=J?-ye:fe;break;case"ArrowRight":Te.x=J?ye:-fe;break}J?t8(Te):$C(Te)}async function dt(){if(!(p(Ie)||rt||p(Ce))){if(rt=!0,!p(ve))try{await ow()}catch(b){console.error("Failed to initialize Pyodide:",b),rt=!1;return}try{const{nodes:b,connections:P}=Re.toJSON();if(b.length===0){$(wt,"Add nodes first");return}p(T)||($(w,!0),$(T,!0));const J=Os.getCode();try{$(wt,"Validating...");const fe=await J7(b,J);if(!fe.valid){$(w,!0),yi.error("Validation failed:");for(const ye of fe.errors)if(ye.nodeId==="__code_context__")yi.error(`  Code context: ${ye.error}`);else{const We=b.find(pt=>pt.id===ye.nodeId)?.name||ye.nodeId;yi.error(`  ${We}.${ye.param}: ${ye.error}`)}$(wt,"Validation failed");return}}catch(fe){$(w,!0),yi.error(`Validation error: ${fe}`),$(wt,"Validation error");return}try{const fe=vn.toJSON();await Y7(b,P,rs.get(),J,fe),p(I)||($(x,!0),$(I,!0))}catch(fe){$(w,!0),console.error("Simulation failed:",fe)}}finally{rt=!1}}}async function Ut(){if(!(!p(ve)||!p(vt)||p(Ie)||et)){et=!0;try{const b=rs.get().duration,P=b?.trim()?String(b):String(Go.duration);await VP(P)}catch(b){$(w,!0),console.error("Continue simulation failed:",b)}finally{et=!1}}}async function ai(){p(ze)>0&&!await bd.show({title:"Unsaved Changes",message:"Creating a new file will discard your current work. Continue?",confirmText:"Discard & Create New",cancelText:"Cancel"})||(m7(),window.location.search&&window.history.replaceState({},"",window.location.pathname))}async function bn(){const b=await qw();b.success&&b.type==="model"&&setTimeout(()=>rl(),100)}function Ln(b){const P=b.split("/");if(P.length<3)throw new Error("Invalid GitHub shorthand. Use: owner/repo/path/to/file.pvm");const J=P[0],fe=P[1],ye=P.slice(2),Te="main",We=ye.join("/");return`https://raw.githubusercontent.com/${J}/${fe}/${Te}/${We}`}async function ni(){if(!O)return;let b;try{b=O.isGitHub?Ln(O.url):O.url}catch{yi.error(`Invalid GitHub shorthand: ${O.url}`),yi.error("Expected format: owner/repo/path/to/file.pvm"),$(w,!0);return}const P=await x7(b);P.success?setTimeout(()=>rl(),100):P.error&&(yi.error(`Failed to load model from URL: ${b}`),yi.error(P.error),$(w,!0))}let Ct=0,oi=0;function Hn(b){let P=a8();const J=Date.now();J-oi>2e3&&(Ct=0);const fe=Ct%se*ae,ye=Math.floor(Ct/se)*te;P={x:P.x+fe-ae*2,y:P.y+ye-te},Ct++,oi=J;const Te=It.mutate(()=>Re.addNode(b,P));Te&&i8(Te.id,P,p(a))}var Sn=Pz();yn("keydown",$n,Bt),yn("resize",$n,V),yn("mousemove",$n,b=>$(a,{x:b.clientX,y:b.clientY},!0)),Zh("1uha8ag",b=>{var P=fz();Ae(()=>he(P,"href",`${hd??""}/favicon.png`)),Ou(()=>{L3.title="PathView"}),j(b,P)});var Mn=ne(Sn);Mn.__click=()=>$(W,!0);var Pn=ne(Mn);Q(Mn),mt(Mn,(b,P)=>Qt?.(b,P),()=>"Welcome");var qe=we(Mn,2),$e=ne(qe);F7($e,{}),Q(qe);var Pt=we(qe,2),tn=ne(Pt);cz(tn,{}),Q(Pt);var Wt=we(Pt,2);Wt.__mousedown=()=>md();var Gt=ne(Wt),Dt=ne(Gt);{var Jt=b=>{var P=hz();P.__click=function(...fe){Hv?.apply(this,fe)};var J=ne(P);Ot(J,{name:"stop-filled",size:16}),Q(P),mt(P,(fe,ye)=>Qt?.(fe,ye),()=>({text:"Stop",shortcut:"Esc"})),j(b,P)},$t=b=>{var P=gz();let J;var fe=ne(P);let ye;fe.__click=dt;var Te=ne(fe);{var We=ht=>{var Rt=pz(),jt=He(Rt),Vt=ne(jt,!0);Q(jt);var _t=we(jt,2),hn=ne(_t);Ot(hn,{name:"loader",size:16}),Q(_t),Ae(()=>Ht(Vt,p(wt))),j(ht,Rt)},pt=ht=>{Ot(ht,{name:"play-filled",size:16})};Se(Te,ht=>{p(Ce)?ht(We):ht(pt,!1)})}Q(fe),mt(fe,(ht,Rt)=>Qt?.(ht,Rt),()=>({text:p(ve)?"Run":"Initialize & Run",shortcut:"Ctrl+Enter"})),Q(P),Ae(()=>{J=Xt(P,1,"run-btn-wrapper svelte-1uha8ag",null,J,{loading:p(Ce)}),ye=Xt(fe,1,"toolbar-btn run-btn svelte-1uha8ag",null,ye,{active:!p(Ce),loading:p(Ce)}),fe.disabled=p(Ce)}),j(b,P)};Se(Dt,b=>{p(Ie)?b(Jt):b($t,!1)})}var wn=we(Dt,2);let en;wn.__click=Ut;var ii=ne(wn);Ot(ii,{name:"skip-forward-filled",size:16}),Q(wn),mt(wn,(b,P)=>Qt?.(b,P),()=>gt),Q(Gt);var kn=we(Gt,2),En=ne(kn);En.__click=ai;var Bs=ne(En);Ot(Bs,{name:"new-canvas",size:16}),Q(En),mt(En,(b,P)=>Qt?.(b,P),()=>"New");var oa=we(En,2);oa.__click=bn;var ss=ne(oa);Ot(ss,{name:"download",size:16}),Q(oa),mt(oa,(b,P)=>Qt?.(b,P),()=>({text:"Open/Import",shortcut:"Ctrl+O"}));var yr=we(oa,2);yr.__click=()=>u();var go=ne(yr),Ir=ne(go);{var mo=b=>{var P=mz(),J=ne(P);Ot(J,{name:"check",size:16}),Q(P),On(1,P,()=>Nr,()=>({duration:200})),On(2,P,()=>Nr,()=>({duration:200})),j(b,P)},xs=b=>{var P=vz(),J=ne(P);Ot(J,{name:"upload",size:16}),Q(P),On(1,P,()=>Nr,()=>({duration:200})),On(2,P,()=>Nr,()=>({duration:200})),j(b,P)};Se(Ir,b=>{p(o)==="save"?b(mo):b(xs,!1)})}Q(go),Q(yr),mt(yr,(b,P)=>Qt?.(b,P),()=>({text:n()?`Save '${n()}'`:"Save",shortcut:"Ctrl+S"}));var ir=we(yr,2);ir.__click=()=>f();var vo=ne(ir),cl=ne(vo);{var ul=b=>{var P=yz(),J=ne(P);Ot(J,{name:"check",size:16}),Q(P),On(1,P,()=>Nr,()=>({duration:200})),On(2,P,()=>Nr,()=>({duration:200})),j(b,P)},Xi=b=>{var P=bz(),J=ne(P);Ot(J,{name:"upload-plus",size:16}),Q(P),On(1,P,()=>Nr,()=>({duration:200})),On(2,P,()=>Nr,()=>({duration:200})),j(b,P)};Se(cl,b=>{p(o)==="save-as"?b(ul):b(Xi,!1)})}Q(vo),Q(ir),mt(ir,(b,P)=>Qt?.(b,P),()=>({text:"Save As",shortcut:"Ctrl+Shift+S"}));var rr=we(ir,2);rr.__click=()=>$(Oe,!0);var ec=ne(rr);Ot(ec,{name:"braces",size:16}),Q(rr),mt(rr,(b,P)=>Qt?.(b,P),()=>({text:"Python Code",shortcut:"Ctrl+E"})),Q(kn);var li=we(kn,2),la=ne(li);la.__click=()=>$(Ke,!0);var Yi=ne(la);Ot(Yi,{name:"keyboard",size:16}),Q(la),mt(la,(b,P)=>Qt?.(b,P),()=>({text:"Shortcuts",shortcut:"?"})),Q(li),Q(Wt);var sr=we(Wt,2);sr.__mousedown=()=>md();var Ta=ne(sr),Ni=ne(Ta);let ui;Ni.__click=pe;var ar=ne(Ni);Ot(ar,{name:"grid",size:18}),Q(Ni),mt(Ni,(b,P)=>Qt?.(b,P),()=>({text:"Blocks",shortcut:"B",position:"right"}));var or=we(Ni,2);let dl;or.__click=ge;var tc=ne(or);Ot(tc,{name:"zap",size:18}),Q(or),mt(or,(b,P)=>Qt?.(b,P),()=>({text:"Events",shortcut:"N",position:"right"}));var lr=we(or,2);let as;lr.__click=Pe;var _s=ne(lr);Ot(_s,{name:"code",size:18}),Q(lr),mt(lr,(b,P)=>Qt?.(b,P),()=>({text:"Editor",shortcut:"E",position:"right"})),Q(Ta);var zs=we(Ta,2),Lr=ne(zs);let fl;Lr.__click=()=>$(x,!p(x));var qs=ne(Lr);Ot(qs,{name:"bar-chart",size:18}),Q(Lr),mt(Lr,(b,P)=>Qt?.(b,P),()=>({text:"Results",shortcut:"V",position:"right"}));var Mr=we(Lr,2);let Da;Mr.__click=()=>$(w,!p(w));var hl=ne(Mr);Ot(hl,{name:"terminal",size:18}),Q(Mr),mt(Mr,(b,P)=>Qt?.(b,P),()=>({text:"Console",shortcut:"C",position:"right"})),Q(zs);var br=we(zs,2),Tr=ne(br);let wr;Tr.__click=me;var yo=ne(Tr);Ot(yo,{name:"settings",size:18}),Q(Tr),mt(Tr,(b,P)=>Qt?.(b,P),()=>({text:"Simulation",shortcut:"S",position:"right"})),Q(br);var pl=we(br,2),Yt=ne(pl);let Ss;Yt.__click=()=>ih.toggle();var js=ne(Yt);{let b=re(()=>p(M)?"pin-filled":"pin");Ot(js,{get name(){return p(b)},size:18})}Q(Yt),mt(Yt,(b,P)=>Qt?.(b,P),()=>({text:"Pin Previews",shortcut:"P",position:"right"}));var Oa=we(Yt,2);Oa.__click=()=>al.toggle();var ks=ne(Oa);{let b=re(()=>p(Nt)==="dark"?"sun":"moon");Ot(ks,{get name(){return p(b)},size:18})}Q(Oa),mt(Oa,(b,P)=>Qt?.(b,P),()=>({text:p(Nt)==="dark"?"Light mode":"Dark mode",shortcut:"T",position:"right"})),Q(pl),Q(sr);var os=we(sr,2);{var Hs=b=>{{let P=re(()=>p(ke)());tu(b,{position:"right",title:"Simulation",initialWidth:310,minWidth:310,maxWidth:310,get bottomOffset(){return p(P)},onClose:()=>$(h,!1),children:(J,fe)=>{var ye=wz(),Te=ne(ye);U7(Te,{}),Q(ye),j(J,ye)},$$slots:{default:!0}})}};Se(os,b=>{p(h)&&b(Hs)})}var As=we(os,2);{var Fa=b=>{{let P=re(()=>p(ue)());tu(b,{position:"left",get width(){return p(B)},minWidth:280,maxWidth:500,get bottomOffset(){return p(P)},title:"Blocks",onClose:()=>$(d,!1),onWidthChange:J=>$(B,Math.min(500,Math.max(280,J)),!0),children:(J,fe)=>{Fi(bT(J,{onAddNode:Hn,focusSearch:!0}),ye=>$(Ge,ye,!0),()=>p(Ge))},$$slots:{default:!0}})}};Se(As,b=>{p(d)&&b(Fa)})}var Ra=we(As,2);{var ca=b=>{{let P=re(()=>p(ue)());tu(b,{position:"left",get width(){return p(E)},minWidth:200,maxWidth:400,get bottomOffset(){return p(P)},title:"Events",onClose:()=>$(y,!1),onWidthChange:J=>$(E,Math.min(400,Math.max(200,J)),!0),children:(J,fe)=>{kT(J,{})},$$slots:{default:!0}})}};Se(Ra,b=>{p(y)&&b(ca)})}var Ns=we(Ra,2);{var cr=b=>{{let P=re(()=>p(ke)());tu(b,{position:"right",get width(){return p(R)},minWidth:300,maxWidth:700,get bottomOffset(){return p(P)},title:"Editor",onClose:()=>$(m,!1),onWidthChange:J=>$(R,Math.min(700,Math.max(300,J)),!0),children:(J,fe)=>{Fi(uT(J,{}),ye=>$(K,ye,!0),()=>p(K))},$$slots:{default:!0}})}};Se(Ns,b=>{p(m)&&b(cr)})}var gl=we(Ns,2);{var bo=b=>{{const P=ye=>{var Te=Sz(),We=we(He(Te),2);{var pt=ht=>{var Rt=_z();cn(Rt,21,()=>p(yt),Cn,(jt,Vt,_t)=>{var hn=xz();let gn;hn.__click=()=>$(kt,_t,!0);var dn=ne(hn);{var mn=ur=>{Ot(ur,{name:"activity",size:12})},zn=ur=>{Ot(ur,{name:"bar-chart-2",size:12})};Se(dn,ur=>{p(Vt).type==="scope"?ur(mn):ur(zn,!1)})}var Bi=we(dn,2),Kn=ne(Bi,!0);Q(Bi),Q(hn),Ae(()=>{gn=Xt(hn,1,"header-tab svelte-1uha8ag",null,gn,{active:p(kt)===_t}),he(hn,"title",p(Vt).title),Ht(Kn,p(Vt).title)}),j(jt,hn)}),Q(Rt),j(ht,Rt)};Se(We,ht=>{p(yt).length>0&&p(ct)==="tabs"&&ht(pt)})}j(ye,Te)},J=ye=>{var Te=Az(),We=He(Te);{var pt=jt=>{var Vt=kz();Vt.__click=()=>$(ct,p(ct)==="tabs"?"tiles":"tabs",!0);var _t=ne(Vt);{var hn=dn=>{Ot(dn,{name:"grid",size:16})},gn=dn=>{Ot(dn,{name:"square",size:16})};Se(_t,dn=>{p(ct)==="tabs"?dn(hn):dn(gn,!1)})}Q(Vt),mt(Vt,(dn,mn)=>Qt?.(dn,mn),()=>({text:p(ct)==="tabs"?"Show all plots":"Show single plot",position:"bottom"})),Ae(()=>he(Vt,"aria-label",p(ct)==="tabs"?"Show all plots":"Show single plot")),j(jt,Vt)};Se(We,jt=>{p(yt).length>1&&jt(pt)})}var ht=we(We,2);ht.__click=()=>$(Ee,!0);var Rt=ne(ht);Ot(Rt,{name:"settings",size:16}),Q(ht),mt(ht,(jt,Vt)=>Qt?.(jt,Vt),()=>({text:"Plot options",position:"bottom"})),j(ye,Te)};let fe=re(()=>p(w)?"bottom-right":"bottom");tu(b,{get position(){return p(fe)},initialHeight:280,minHeight:150,get minWidth(){return Vo},get maxWidth(){return p(de)},get width(){return p(N)},onWidthChange:F,onClose:()=>$(x,!1),get currentHeight(){return p(S)},set currentHeight(ye){$(S,ye,!0)},header:P,actions:J,children:(ye,Te)=>{tT(ye,{collapsed:!1,get viewMode(){return p(ct)},get activeTab(){return p(kt)},set activeTab(We){$(kt,We,!0)}})},$$slots:{header:!0,actions:!0,default:!0}})}};Se(gl,b=>{p(x)&&b(bo)})}var Ba=we(gl,2);{var Cs=b=>{{const P=ye=>{var Te=Nz();j(ye,Te)},J=ye=>{var Te=Cz();Te.__click=()=>yi.clear();var We=ne(Te);Ot(We,{name:"trash",size:16}),Q(Te),mt(Te,(pt,ht)=>Qt?.(pt,ht),()=>({text:"Clear console",position:"bottom"})),j(ye,Te)};let fe=re(()=>p(x)?"bottom-left":"bottom");tu(b,{get position(){return p(fe)},initialHeight:280,minHeight:150,get minWidth(){return Vo},get maxWidth(){return p(de)},get width(){return p(C)},onWidthChange:le,onClose:()=>$(w,!1),get currentHeight(){return p(A)},set currentHeight(ye){$(A,ye,!0)},header:P,actions:J,children:(ye,Te)=>{aT(ye,{})},$$slots:{header:!0,actions:!0,default:!0}})}};Se(Ba,b=>{p(w)&&b(Cs)})}var Ki=we(Ba,2);{var wo=b=>{{let P=re(Ft);IT(b,{get x(){return p(Ue).x},get y(){return p(Ue).y},get items(){return p(P)},onClose:()=>to.close()})}};Se(Ki,b=>{p(at)&&b(wo)})}var ua=we(Ki,2);_B(ua,{get open(){return p(Oe)},onClose:()=>$(Oe,!1)});var za=we(ua,2);PB(za,{get open(){return p(Ke)},onClose:()=>$(Ke,!1)});var xr=we(za,2);KB(xr,{get open(){return p(Be)},onClose:()=>$(Be,!1)});var Wr=we(xr,2);UB(Wr,{get open(){return p(Ee)},onClose:()=>$(Ee,!1),get traces(){return p(st)}});var xo=we(Wr,2);OM(xo,{});var _o=we(xo,2);WM(_o,{});var ls=we(_o,2);{let b=re(()=>i()!==null),P=re(()=>i()?.code??""),J=re(()=>i()?.title??"");i0(ls,{get open(){return p(b)},get code(){return p(P)},get title(){return p(J)},onClose:()=>jh.close()})}var Zi=we(ls,2);wP(Zi,{});var cs=we(Zi,2);dz(cs,{});var da=we(cs,2);{var ml=b=>{az(b,{onNew:ai,onClose:()=>$(W,!1)})};Se(da,b=>{p(W)&&b(ml)})}Q(Sn),Ae(()=>{he(Pn,"src",`${hd??""}/pathview_logo.png`),en=Xt(wn,1,"toolbar-btn svelte-1uha8ag",null,en,{active:p(vt)&&p(ve)&&!p(Ie)}),wn.disabled=!p(vt)||!p(ve)||p(Ie),ui=Xt(Ni,1,"toggle-btn svelte-1uha8ag",null,ui,{active:p(d)}),dl=Xt(or,1,"toggle-btn svelte-1uha8ag",null,dl,{active:p(y)}),as=Xt(lr,1,"toggle-btn svelte-1uha8ag",null,as,{active:p(m)}),fl=Xt(Lr,1,"toggle-btn svelte-1uha8ag",null,fl,{active:p(x)}),Da=Xt(Mr,1,"toggle-btn svelte-1uha8ag",null,Da,{active:p(w)}),wr=Xt(Tr,1,"toggle-btn svelte-1uha8ag",null,wr,{active:p(h)}),Ss=Xt(Yt,1,"toggle-btn svelte-1uha8ag",null,Ss,{active:p(M)})}),On(3,Wt,()=>h1,()=>({y:-20,duration:200})),j(t,Sn),Tt(),s()}Xn(["click","mousedown"]);export{jn as _,zz as a,Bz as c,u0 as g};
